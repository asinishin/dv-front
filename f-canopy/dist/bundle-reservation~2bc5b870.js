(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"5Abv":function(e,r){e.exports="<form id=bundleReservationComplete> <h1 class=page-title>{{state.getPageTitle()}}</h1> <ff-btn-group class=buttons-bottom ng-class=\"{'ff-center': !vm.purchase}\"> <ff-btn sense=home type=submit ff-click=vm.home()><span translate=GLOBAL.BTN_HOME></span></ff-btn> </ff-btn-group> </form> "},"5nZu":function(e,r,t){"use strict";t("JBxO"),t("FdtR"),angular.module("deskworks.StaffHelpCtrl",["ngRoute","deskworks.helper","deskworks.config"]).controller("StaffHelpCtrl",["$scope","$timeout","$q","$route","$window","$translate","dwAlerts","helper","state","deskworksConfig",function(e,r,t,n,s,a,o,l,i,u){this.notice=i.getParam("notice"),i.setPageTitle(a.instant("SIMPLE_RES.STAFF_HELP.PAGE_TITLE")),e.$on("$routeChangeStart",(function(e,r,t){!r.$$route||"MemberSignUpBillingCtrl"!==r.$$route.controller&&"MemberSignUpPurchaseCtrl"!==r.$$route.controller&&"SimpleReservationBillingCtrl"!==r.$$route.controller&&"SimpleReservationPurchaseCtrl"!==r.$$route.controller&&"BuyPassBillingCtrl"!==r.$$route.controller&&"BuyPassPurchaseCtrl"!==r.$$route.controller||(o.error(a.instant("SIMPLE_RES.STAFF_HELP.BACK_ERROR")),e.preventDefault())})),this.home=function(){if(i.getParam("redirect"))s.location.href=i.getParam("redirect");else{var e=i.getParam("origin"),n=i.getCurrentCenterId();(e?i.logout():t.when()).finally((function(){return i.resetParams(),e&&i.setCurrentCenterId(n),i.setPath(e||u.getDefaultRoute())}))}return r(1e4)}}])},"9QnR":function(e,r){e.exports='<div id=newBillingProfile> <h1 class="page-title flex"> <span>{{state.getPageTitle()}}</span> <need-help phone="$resolve.center.phone || vm.reg.phone"></need-help> </h1> <ff-board> <ff-panel style=max-width:450px> <ff-panel-header> <span translate=GLOBAL.STEP_X_OF_Y translate-values=vm.reg ng-if=vm.reg.stepCount></span> <span ng-if=vm.reg.stepCount>&nbsp;</span> <small translate=GLOBAL.REQUIRED_FIELDS_MARKED_WITH></small> </ff-panel-header> <div class="ff-grid gutter-v"> <up-credit-cards user-profile=vm.userProfile reg=vm.reg settings=vm.settings single=true ng-if=vm.userProfile.creditCards.length></up-credit-cards> <up-e-checks user-profile=vm.userProfile reg=vm.reg single=true ng-if="vm.settings.enableEChecks && vm.userProfile.eChecks.length"></up-e-checks> <ff-btn-group ng-if=vm.showSwitchButton()> <ff-btn sense=add size=sm ng-if=vm.userProfile.eChecks.length ff-click=vm.addCC()> <span translate=BILLING_PROFILE.CREDIT_CARDS.BTN_ADD></span> </ff-btn> <ff-btn sense=add size=sm ng-if=vm.userProfile.creditCards.length ff-click=vm.addECheck()> <span translate=BILLING_PROFILE.E_CHECKS.BTN_ADD></span> </ff-btn> </ff-btn-group> </div> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom> <ff-btn sense=help ff-click=vm.staffHelp() ng-if=vm.staffHelp><span translate=GLOBAL.BTN_STAFF_HELP></span></ff-btn> <ff-btn sense=back ff-click=vm.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next ff-click=vm.next() ng-if=vm.next><span translate=SIMPLE_RES.BILLING.BTN_PURCHASE></span></ff-btn> <ff-btn sense=next ff-click=vm.complete() ng-if=vm.complete><span translate=MEMBER_SIGN_UP.BILLING.BTN_COMPLETE></span></ff-btn> </ff-btn-group> </div> '},CMUX:function(e,r,t){"use strict";t.r(r);var n=t("Vtxe");r.default=angular.module("deskworks.bundleReservation.complete",[n.a.name]).controller("BundleReservationCompleteCtrl",["$scope","$translate","dwAlerts","state","helper","deskworksConfig","center","purchase",function(e,r,t,n,s,a,o,l){this.center=o,this.purchase=l,n.setPageTitle(r.instant("SIMPLE_RES.COMPLETE.PAGE_TITLE")),e.$on("$routeChangeStart",(function(e,n,s){!n.$$route||"BundleReservationConfirmCtrl"!==n.$$route.controller&&"BundleReservationBillingCtrl"!==n.$$route.controller||(t.error(r.instant("SIMPLE_RES.COMPLETE.BACK_ERROR")),e.preventDefault())})),this.home=function(){return n.resetParams(),n.setPath(a.getDefaultRoute())}}])},Hqwt:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.staffHelp",["ngRoute","deskworks.helper","deskworks.config"]).controller("BundleReservationStaffHelpCtrl",["$scope","$route","dwAlerts","helper","state","deskworksConfig",function(e,r,t,n,s,a){this.notice=s.getParam("notice"),s.setPageTitle("Staff Help"),e.$on("$routeChangeStart",(function(e,r,n){!r.$$route||"BundleReservationBillingCtrl"!==r.$$route.controller&&"BundleReservationPurchaseCtrl"!==r.$$route.controller||(t.error("Our staff will help you to complete the registration."),e.preventDefault())})),this.home=function(){return s.resetParams(),s.setPath(a.getDefaultRoute())}}])},OS2P:function(e,r,t){"use strict";t.r(r);var n=t("aIjk"),s=t("Vtxe");r.default=angular.module("deskworks.bundleReservation.purchase",["ngRoute","deskworks.helper","deskworks.purchase.service",n.a.name,s.a.name]).controller("BundleReservationPurchaseCtrl",["$scope","$route","$translate","dwAlerts","helper","state","reg","center","purchase","purchaseService",function(e,r,t,n,s,a,o,l,i,u){var f=this;f.reg=o,f.center=l,f.purchase=i,a.setPageTitle(t.instant("SIMPLE_RES.PURCHASE.PAGE_TITLE",{centerName:l.name})),f.next=function(){return a.setPath(a.getPath()+"/billing")},f.back=a.back,f.staffHelp=function(){return u.createStaffHelp(f.center.id,a.getCurrentUserId(),r.current.params.purchaseId).catch((function(e){return n.error(e,"Failed to create staff help.")})).then((function(e){return a.setParam("notice",e.notice),a.setPath(a.getPath()+"/staff-help")}))}}])},Obn3:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.BundleReservationPurchase",["ngResource","deskworks.config"]).factory("BundleReservationPurchase",["$resource","deskworksConfig",function(e,r){return e(r.getApiAbsUrl("/centers/:centerId/user-profiles/:userId/purchases/:purchaseId"),{centerId:"@centerId",userId:"@userId",reservationBundleId:"@reservationBundleId",reservation:!0},{save:{method:"POST"}})}])},Soaq:function(e,r,t){"use strict";t.r(r);t("Muwe"),t("y89P");r.default=angular.module("deskworks.bundleReservation.confirm",["deskworks.bundleReservation.BundleReservation"]).controller("BundleReservationConfirmCtrl",["$scope","$route","$translate","BundleReservation","helper","state","dwAlerts",function(e,r,t,n,s,a,o){a.setPageTitle(t.instant("RESERVATIONS.CONFIRM.PAGE_TITLE")),this.back=a.back,this.next=function(){if(a.isLoggedMember()||a.isLoggedAdmin()){var e={centerId:a.getCurrentCenterId(),userId:a.getCurrentUserId(),reservationBundleId:r.current.params.reservationBundleId};return n.save(e).$promise.catch((function(e){return o.error(e,"Failed to make reservation.")})).then((function(){return a.setPath(a.getPath().replace(/\/confirm$/,"/complete"))}))}return o.error("Failed to make reservation without payment for non-member.")}}])},TQqA:function(e,r,t){"use strict";t.r(r);t("Muwe"),t("y89P");var n=t("WSeP"),s=t.n(n),a=t("lRNC"),o=t.n(a),l=t("yCd9"),i=t.n(l),u=(t("5nZu"),t("l7sz")),f=t.n(u),c=t("aE5K"),d=t.n(c),p=t("9QnR"),g=t.n(p),m=["$injector",function(e){var r,n,a=(r=t("irk7"),i()(n=o()(r).call(r)).call(n,r));e.loadNewModules(i()(a).call(a,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var r,n=t("i/oZ");s()(r=o()(n).call(n)).call(r,(function(r){return e.put(r.replace(/^\.\//,""),n(r))})),e.put("staff-help/staff-help.tpl.html",f.a),e.put("templates/new-user-profile.tpl.html",d.a),e.put("templates/new-billing-profile.tpl.html",g.a)}])}];r.default=m},aE5K:function(e,r){e.exports='<div class=user-profile id=userProfile> <h1 class="page-title flex"> <span> {{state.getPageTitle()}} <span ng-if="vm.reg.member && !vm.reg.selfRegistration" ng-style="{ color: vm.center.color }">{{vm.center.name}}</span> </span> <need-help phone=vm.reg.phone></need-help> </h1> <ff-board> <ff-panel role=article aria-label="{{\'USER_PROFILE.USER_PROFILE\' | translate}}"> <ff-panel-header ng-if=vm.reg> <span translate=GLOBAL.STEP_X_OF_Y translate-values=vm.reg ng-if=vm.reg.stepCount></span> <small translate=GLOBAL.REQUIRED_FIELDS_MARKED_WITH></small> </ff-panel-header> <div class="ff-grid ff-gutter-v ff-gutter-h"> <up-personal-info user=vm.userProfile schema=vm.schema reg=vm.reg></up-personal-info> <up-addresses flex="{md: \'0 0 50%\'}" user=vm.userProfile schema=vm.schema reg=vm.reg center=vm.center single=true></up-addresses> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-login-info user=vm.userProfile schema=vm.schema reg=vm.reg member-directory-url=wlLinks.memberDirectoryUrl></up-login-info> <up-phones user=vm.userProfile schema=vm.schema reg=vm.reg single=true></up-phones> </div> </div> <up-photo flex="{md: \'0 0 50%\'}" user=vm.userProfile schema=vm.schema reg=vm.reg></up-photo> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-lead-source user=vm.userProfile schema=vm.schema reg=vm.reg></up-lead-source> <up-terms-of-service user=vm.userProfile schema=vm.schema reg=vm.reg></up-terms-of-service> </div> </div> </div> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom ng-if=vm.reg> <ff-btn sense=back ff-click=vm.back() ng-if=vm.back><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next ff-click=vm.next()><span translate=GLOBAL.BTN_NEXT></span></ff-btn> </ff-btn-group> </div> '},aIjk:function(e,r,t){"use strict";r.a=angular.module("needHelp",[]).directive("needHelp",(function(){return{restrict:"E",scope:!0,controller:function(){},controllerAs:"$ctrl",template:'<span translate="GLOBAL.NEED_HELP" class="need-help" ng-if="$ctrl.phone" translate-values="{ phone: \'<a href=&quot;tel:\' + $ctrl.phone + \'&quot;>\' + $ctrl.phone + \'</a>\' }"></span>',bindToController:{phone:"<"}}}))},aQrS:function(e,r){e.exports='<form name=formPurchase id=buyPassPurchase> <h1 class="page-title flex"> <span>{{state.getPageTitle()}}</span> <need-help phone=$ctrl.center.phone></need-help> </h1> <ff-board> <ff-panel> <ff-panel-header>Order Id: {{$ctrl.purchase.orderId}}</ff-panel-header> <dw-invoice invoice=$ctrl.purchase center=$ctrl.center allow-remove=false></dw-invoice> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom> <ff-btn sense=help ff-click=$ctrl.staffHelp()><span translate=GLOBAL.BTN_STAFF_HELP></span></ff-btn> <ff-btn sense=back ff-click=state.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next type=submit ff-click=$ctrl.next()><span translate=GLOBAL.BTN_NEXT></span></ff-btn> </ff-btn-group> </form> '},aY00:function(e,r,t){"use strict";t.r(r);t("8cZI"),t("Muwe"),t("y89P");var n=t("nbuU"),s=t.n(n),a=t("WSeP"),o=t.n(a),l=t("hsT8"),i=t.n(l);r.default=angular.module("deskworks.bundleReservation.billing",["ngRoute","deskworks.userProfile.service","deskworks.purchase.service","deskworks.bundleReservation.BundleReservation","deskworks.bundleReservation.BundleReservationPurchase","deskworks.routeHelper","deskworks.helper"]).controller("BundleReservationBillingCtrl",["$scope","$route","$translate","dwAlerts","helper","state","userProfile","reg","userProfileService","purchaseService","BundleReservation","settings",function(e,r,t,n,a,l,u,f,c,d,p,g){var m,v,h=this;if(h.userProfile=u,h.reg=f,h.settings=g,g.creditCardTypes=i()(m=g.creditCardTypes).call(m,(function(e){return e.enable})),o()(v=h.userProfile.creditCards).call(v,(function(e){e.type=s()(a).call(a,g.creditCardTypes,e.type)||e.type||{}})),l.setPageTitle(t.instant("BILLING_PROFILE.PAGE_TITLE",{userName:a.join([h.userProfile.firstName,h.userProfile.lastName]," ")})),h.userProfile.creditCards=h.userProfile.creditCards||[],!h.userProfile.creditCards.length&&!h.userProfile.eChecks.length){var P=c.creditCard.new(h.userProfile);P.type=g.creditCardTypes[0],h.userProfile.creditCards.push(P)}c.bindTestBillingGenerator(e,h.userProfile,h.reg),h.addCC=function(){var e=c.creditCard.new(h.userProfile);h.userProfile.creditCards=[e],h.userProfile.eChecks=[]},h.addECheck=function(){var e=c.eCheck.new(h.userProfile);h.userProfile.eChecks=[e],h.userProfile.creditCards=[]},h.showSwitchButton=function(){var e=!h.userProfile.creditCards[0]||c.creditCard.isNew(h.userProfile.creditCards[0]),r=!h.userProfile.eChecks[0]||c.eCheck.isNew(h.userProfile.eChecks[0]);return e&&r&&h.settings.enableEChecks},h.next=function(){if(!a.pointFirstInvalid("#simpleReservationBilling"))return c.saveBillingProfile(l.getCurrentCenterId(),h.userProfile).then((function(){var e={centerId:l.getCurrentCenterId(),userId:l.getCurrentUserId(),reservationBundleId:r.current.params.reservationBundleId};return p.save(e).$promise.catch((function(e){return n.error(e,"Failed to make reservation.")})).then((function(e){return d.createPayment(l.getCurrentCenterId(),l.getCurrentUserId(),r.current.params.purchaseId,{}).catch((function(e){return n.error(e,"Failed to make payment.")})).then((function(){return l.setPath(l.getPath()+"/complete")}))}))}))},h.staffHelp=function(){return d.createStaffHelp(l.getCurrentCenterId(),l.getCurrentUserId(),r.current.params.purchaseId).catch((function(e){return n.error(e,"Failed to create staff help.")})).then((function(e){return l.setParam("notice",e.notice),l.setPath(l.getPath().replace(/\/billing$/,"/staff-help"))}))},h.back=l.back}])},buMD:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.BundleReservation",["ngResource","deskworks.config"]).factory("BundleReservation",["$resource","deskworksConfig",function(e,r){return e(r.getApiAbsUrl("/centers/:centerId/user-profiles/:userId/reservations/:reservationId"),{centerId:"@centerId",userId:"@userId",reservationBundleId:"@reservationBundleId"},{save:{method:"POST"}})}])},gRWq:function(e,r){e.exports="<form name=formBundleReservationConfirm id=bundleReservationConfirm> <h1 class=page-title>{{state.getPageTitle()}}</h1> <ff-btn-group class=buttons-bottom> <ff-btn sense=next type=submit ff-click=vm.next()><span translate=GLOBAL.BTN_CONFIRM></span></ff-btn> <ff-btn sense=back ff-click=vm.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> </ff-btn-group> </form> "},"i/oZ":function(e,r,t){var n={"./steps/bundle-reservation-complete-member.tpl.html":"5Abv","./steps/bundle-reservation-complete.tpl.html":"lflH","./steps/bundle-reservation-confirm.tpl.html":"gRWq","./steps/bundle-reservation-purchase.tpl.html":"aQrS"};function s(e){var r=a(e);return t(r)}function a(e){if(!t.o(n,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=a,e.exports=s,s.id="i/oZ"},irk7:function(e,r,t){var n={"./services/bundle-reservation-purchase.service.js":"Obn3","./services/bundle-reservation.service.js":"buMD","./steps/bundle-reservation-billing.controller.js":"aY00","./steps/bundle-reservation-complete.controller.js":"CMUX","./steps/bundle-reservation-confirm.controller.js":"Soaq","./steps/bundle-reservation-purchase.controller.js":"OS2P","./steps/bundle-reservation-sign-in.controller.js":"u/01","./steps/bundle-reservation-staff-help.controller.js":"Hqwt","./steps/bundle-reservation-user-profile.controller.js":"rOfW"};function s(e){var r=a(e);return t(r)}function a(e){if(!t.o(n,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=a,e.exports=s,s.id="irk7"},l7sz:function(e,r){e.exports='<div id=staffHelp class=ff-tmargin> <ff-board> <ff-panel> <span ng-bind=::vm.notice></span> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom ff-center"> <ff-btn sense=home type=submit ff-click=vm.home()><span translate=GLOBAL.BTN_HOME></span></ff-btn> </ff-btn-group> </div> '},lflH:function(e,r){e.exports='<div id=bundleReservationComplete> <h1 class=page-title>{{state.getPageTitle()}}</h1> <ff-board> <ff-panel> <ff-panel-header> <span translate=SIMPLE_RES.COMPLETE.ORDER.HEADER translate-values="{ orderId: vm.purchase.orderId }"></span> </ff-panel-header> <dw-invoice invoice=vm.purchase center=vm.center allow-remove=false></dw-invoice> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom> <ff-btn sense=home type=submit ff-click=vm.home()><span translate=GLOBAL.BTN_HOME></span></ff-btn> </ff-btn-group> </div> '},rOfW:function(e,r,t){"use strict";t.r(r);t("Muwe"),t("y89P");r.default=angular.module("deskworks.bundleReservation.userProfile",["ngRoute","deskworks.helper","deskworks.userProfile.service","deskworks.bundleReservation.BundleReservationPurchase"]).controller("BundleReservationUserProfileCtrl",["$scope","$q","$route","$timeout","$translate","dwAlerts","helper","state","reg","centers","userProfile","userProfileService","setupService","BundleReservationPurchase",function(e,r,t,n,s,a,o,l,i,u,f,c,d,p){var g=this;i.new=!l.getLoggedUserId(),g.reg=i,g.userProfile=f,g.schema=f.schema,l.setPageTitle(s.instant(g.reg.new?"USER_PROFILE.NEW_USER.PAGE_TITLE":"USER_PROFILE.PAGE_TITLE",{userName:g.userProfile.firstName+" "+g.userProfile.lastName})),d.getSetupSettings().catch((function(e){return a.error(e,"Failed to get settings.")})).then((function(e){g.settings=e})),c.bindTestUserGenerator(e,g.userProfile,g.reg),g.next=function(){if(!o.pointFirstInvalid("#userProfile"))return(g.reg.new?c.registerNewUser(0,g.userProfile):r.when()).then((function(){if(g.reg.new)return l.login(g.userProfile.login,g.userProfile.password).catch((function(e){return a.error(e,"Failed to login under created user.")})).then((function(){return l.replace(),l.setCurrentCenterId(u[0].id),n()}))})).then((function(){var e={centerId:l.getCurrentCenterId(),userId:l.getCurrentUserId(),reservationBundleId:t.current.params.reservationBundleId};return p.save(e).$promise.catch((function(e){return a.error(e,"Failed to create purchase for bundle reservation.")}))})).then((function(e){return l.setPath(l.getPath()+"/purchase/"+e.id)}))},g.back=l.back}])},"u/01":function(e,r,t){"use strict";t.r(r);t("Muwe"),t("y89P");r.default=angular.module("deskworks.bundleReservation.signIn",["flexForms","deskworks.state","deskworks.config","deskworks.dwSignIn"]).controller("BundleReservationSignInCtrl",["$scope","$translate","state",function(e,r,t){t.setPageTitle(r.instant("SIGN_IN.PAGE_TITLE")),e.$on("dwSignIn:SignIn",(function(e){return e.stopPropagation(),t.replace(),t.isLoggedNonMember()?t.setPath(t.getPath()+"/user-profile"):t.setPath(t.getPath()+"/confirm")})),e.$on("dwSignIn:SignUp",(function(e){return e.stopPropagation(),t.replace(),t.setPath(t.getPath()+"/user-profile")})),this.back=t.back}])}}]);