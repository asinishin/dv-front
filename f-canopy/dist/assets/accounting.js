angular.module("deskworks.BarUploadsEditCtrl",["deskworks.accounting.barUploads.service"]).controller("BarUploadsEditCtrl",["$scope","$window","$translate","dwAlerts","state","helper","barUpload","barUploadsService",function(e,t,r,n,a,i,o,s){"use strict";var u=this;a.setPageTitle(r.instant("BAR_UPLOADS.EDIT.PAGE_TITLE")),u.barUpload=o,u.back=function(){return a.setPath("/bar-uploads")},u.save=function(){if(!i.pointFirstInvalid("#barUpload"))return s.save(a.getCurrentCenterId(),u.barUpload).catch(function(e){return n.error(e,"Failed to save bar upload.")}).then(function(){u.form.$setPristine()})},u.delete=function(){if(t.confirm(r.instant("BAR_UPLOADS.CONFIRM_DELETE")))return s.delete(a.getCurrentCenterId(),u.barUpload.id).catch(function(e){return n.error(e,"Failed to delete bar upload.")}).then(function(){return a.setPath("/bar-uploads")})},u.postCharges=function(){return s.postCharges(a.getCurrentCenterId(),u.barUpload.id).catch(function(e){return n.error(e,"Failed to post charges for bar upload.")}).then(function(){return a.setPath("/bar-uploads")})},u.sort=function(e){return u.navPage(1,e)},u.navPage=function(e,t){return t=t||u.barUpload.sort,s.get(a.getCurrentCenterId(),u.barUpload.id,e,u.barUpload.pageSize,u.barUpload.sort).catch(function(e){return n.error(e,"Failed to get bar upload.")}).then(function(e){u.barUpload=e})}}]),angular.module("deskworks.BarUploadsListCtrl",["deskworks.accounting.barUploads.service","ngFileUpload"]).controller("BarUploadsListCtrl",["$scope","$q","$translate","dwAlerts","state","helper","barUploads","barUploadsService",function(e,t,r,n,a,i,o,s){"use strict";var u=this;a.setPageTitle(r.instant("BAR_UPLOADS.PAGE_TITLE")),u.barUploads=o,u.import=function(e,i){if(i&&i.length>0)return n.error(r.instant("BAR_UPLOADS.INVALID_FORMAT"));u.spinImport=!0;var o=[];return e.forEach(function(e){o.push(s.import(a.getCurrentCenterId(),e).catch(function(t){return n.error(t,"Failed to import "+e.name)}))}),t.all(o).finally(function(){u.navPage(u.barUploads.page).finally(function(){u.spinImport=!1})})},u.edit=function(e){return a.setPath("/bar-uploads/"+e.id)},u.navPage=function(e){return s.query(a.getCurrentCenterId(),e).catch(function(e){return n.error(e,"Failed to query bar uploads.")}).then(function(e){u.barUploads=e})}}]),angular.module("deskworks.accounting.bulkCharges",["deskworks.accounting.bulkInvoicing.service"]).controller("AccountingBulkChargesCtrl",["$scope","$route","$translate","dwAlerts","state","helper","invoices","bulkInvoicingService",function(e,t,r,n,a,i,o,s){"use strict";var u=this;a.setPageTitle(r.instant("BULK_CHARGES.PAGE_TITLE")),u.invoices=o,u.invoices.forEach(function(e){e.collapsed=!0}),u.chargeCards=function(){var e={invoices:[]};return u.invoices.forEach(function(t){t.include&&e.invoices.push(t.id)}),e.invoices.length?s.billPurchases(a.getCurrentCenterId(),e).catch(function(e){return n.error(e,"Failed to charge credit cards.")}).then(function(){n.info(r.instant("BULK_CHARGES.SUCCESS")),t.reload()}):n.error(r.instant("BULK_CHARGES.NOTHING_SELECTED"))}}]),angular.module("deskworks.accounting.bulkInvoicing",["deskworks.accounting.bulkInvoicing.service"]).controller("AccountingBulkInvoicingCtrl",["$scope","$route","$translate","dwAlerts","state","helper","invoices","bulkInvoicingService",function(e,t,r,n,a,i,o,s){"use strict";var u=this;a.setPageTitle(r.instant("BULK_INVOICING.PAGE_TITLE")),u.invoices=o,u.invoices.forEach(function(e){e.collapsed=!0,angular.isArray(e.items)&&e.items.forEach(function(e){e.description=[e.name||"",e.description||""].join(" ")})}),u.sendInvoices=function(){var e={invoices:[]};return u.invoices.forEach(function(t){t.include&&e.invoices.push(t.id)}),e.invoices.length?s.sendEmails(a.getCurrentCenterId(),e).catch(function(e){return n.error(e,"Failed to send invoices.")}).then(function(){n.info(r.instant("BULK_INVOICING.SUCCESS")),t.reload()}):n.error(r.instant("BULK_INVOICING.NOTHING_SELECTED"))}}]),angular.module("deskworks.accounting.printerUsage.edit",["deskworks.accounting.printerUsage.service"]).controller("PrinterUsageEditCtrl",["$scope","$window","$translate","dwAlerts","state","helper","usage","printerUsageService",function(e,t,r,n,a,i,o,s){"use strict";var u=this;a.setPageTitle(r.instant("PRINTER_USAGE.LIST.PAGE_TITLE")),u.usage=o,u.back=function(){return a.setPath("/printer-usage")},u.save=function(e){if(!i.pointFirstInvalid("#printerUsage"))return s.save(a.getCurrentCenterId(),u.usage).catch(function(e){return n.error(e,"Failed to update printer usage.")}).then(function(){e.$setPristine()})},u.delete=function(){if(t.confirm(r.instant("PRINTER_USAGE.CONFIRM_DELETE")))return s.delete(a.getCurrentCenterId(),u.usage.id).catch(function(e){return n.error(e,"Failed to delete printer usage.")}).then(function(){return a.setPath("/printer-usage")})},u.postCharges=function(){return s.postCharges(a.getCurrentCenterId(),u.usage.id).catch(function(e){return n.error(e,"Failed to post charges for printer usage.")}).then(function(){return a.setPath("/printer-usage")})},u.sort=function(e){return u.navPage(1,e)},u.navPage=function(e,t){return t=t||u.usage.sort,s.get(a.getCurrentCenterId(),u.usage.id,e,u.usage.pageSize,t).catch(function(e){return n.error(e,"Failed to query printer usages.")}).then(function(e){u.usage=e})}}]),angular.module("deskworks.accounting.printerUsage.list",["deskworks.accounting.printerUsage.service","ngFileUpload"]).controller("PrinterUsageListCtrl",["$scope","$q","$translate","dwAlerts","state","helper","usage","printerUsageService",function(e,t,r,n,a,i,o,s){"use strict";var u=this;a.setPageTitle(r.instant("PRINTER_USAGE.LIST.PAGE_TITLE")),u.usage=o,u.import=function(e,i){if(i&&i.length>0)return n.error(r.instant("PRINTER_USAGE.INVALID_FORMAT"));if(e&&e.length){u.spinImport=!0;var o=e.map(function(e){return s.import(a.getCurrentCenterId(),e).catch(function(t){return n.error(t,"Failed to import "+e.name)})});return t.all(o).finally(function(){u.navPage(u.usage.page).finally(function(){u.spinImport=!1})})}},u.edit=function(e){return a.setPath("/printer-usage/"+e.id)},u.navPage=function(e){return s.query(a.getCurrentCenterId(),e).catch(function(e){return n.error(e,"Failed to query printer usages.")}).then(function(e){u.usage=e})}}]);