{"version":3,"sources":["webpack:///./bundles/greetly sync .*\\.tpl\\.html$","webpack:///./bundles/greetly sync \\..+\\/.+\\.js$","webpack:///./bundles/greetly/index.js","webpack:///./bundles/greetly/services/greetly-center.service.js","webpack:///./bundles/greetly/services/greetly-locations.service.js","webpack:///./bundles/greetly/services/greetly-settings.service.js","webpack:///./bundles/greetly/settings/greetly-settings.directive.js","webpack:///./bundles/greetly/settings/greetly-settings.tpl.html"],"names":["index","$injector","importAll","r","js","require","loadNewModules","m","default","name","invoke","$templateCache","ctx","forEach","key","put","replace","angular","module","factory","$resource","deskworksConfig","res","getApiAbsUrl","update","method","query","$promise","save","data","centerId","id","get","directive","templateUrl","restrict","scope","controller","$q","dwAlerts","debounce","GreetlySettings","GreetlyCenter","GreetlyLocation","$ctrl","$onInit","spin","loadSettings","then","settings","apiKey","loadGreetlyData","finally","catch","err","error","promises","centers","locations","all","saveCenter","center","form","$invalid","saveSettings"],"mappings":"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","file":"greetly~._bundles_greetly .js?_rev=83c0663cf720b20212b7","sourcesContent":["var map = {\n\t\"./settings/greetly-settings.tpl.html\": \"./bundles/greetly/settings/greetly-settings.tpl.html\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./bundles/greetly sync recursive .*\\\\.tpl\\\\.html$\";","var map = {\n\t\"./services/greetly-center.service.js\": \"./bundles/greetly/services/greetly-center.service.js\",\n\t\"./services/greetly-locations.service.js\": \"./bundles/greetly/services/greetly-locations.service.js\",\n\t\"./services/greetly-settings.service.js\": \"./bundles/greetly/services/greetly-settings.service.js\",\n\t\"./settings/greetly-settings.directive.js\": \"./bundles/greetly/settings/greetly-settings.directive.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./bundles/greetly sync recursive \\\\..+\\\\/.+\\\\.js$\";","const index = ['$injector', function index($injector) {\n  // JS\n  const importAll = r => r.keys().map(r);\n  const js = importAll(require.context('./', true, /\\..+\\/.+\\.js$/));\n  $injector.loadNewModules(js.map(m => m.default.name));\n\n  // Templates\n  $injector.invoke(['$templateCache', function($templateCache) {\n    const ctx = require.context('./', true, /.*\\.tpl\\.html$/);\n    ctx.keys().forEach(key => $templateCache.put(key.replace(/^\\.\\//, ''), ctx(key)));\n  }]);\n}];\n\nexport default index;\n","export default angular.module('deskworks.GreetlyCenter', [\n  'ngResource',\n  'deskworks.config',\n])\n\n  .factory('GreetlyCenter', function($resource, deskworksConfig) {\n\n    const res = $resource(deskworksConfig.getApiAbsUrl('/greetly/centers/:centerId'), {}, {\n      update: { method: 'PUT' },\n    });\n\n    return {\n      query: () => res.query().$promise,\n\n      save: data => res.update({ centerId: data.id }, data).$promise,\n    };\n  });\n","export default angular.module('deskworks.GreetlyLocation', [\n  'ngResource',\n  'deskworks.config',\n])\n\n  .factory('GreetlyLocation', function($resource, deskworksConfig) {\n\n    const res = $resource(deskworksConfig.getApiAbsUrl('/greetly/greetly-locations'));\n\n    return {\n      query: () => res.query().$promise,\n    };\n  });\n","export default angular.module('deskworks.GreetlySettings', [\n  'ngResource',\n  'deskworks.config',\n])\n\n  .factory('GreetlySettings', function($resource, deskworksConfig) {\n\n    const res = $resource(deskworksConfig.getApiAbsUrl('/greetly/settings'), {}, {\n      update: { method: 'PUT' },\n    });\n\n    return {\n      get: () => res.get().$promise,\n\n      save: data => res.update({}, data).$promise,\n    };\n  });\n","/**\n * Integrations Setup -> Greetly Settings directive\n */\nexport default angular.module('deskworks.greetlySettingsDirective', [\n  'debounce',\n  'deskworks.GreetlySettings',\n  'deskworks.GreetlyCenter',\n  'deskworks.GreetlyLocation',\n])\n\n  .directive('greetlySettings', function() {\n    const templateUrl = 'settings/greetly-settings.tpl.html';\n    return {\n      templateUrl,\n      restrict: 'E',\n      scope: true,\n      controller: 'GreetlySettingsCtrl as $ctrl',\n    };\n  })\n\n  .controller('GreetlySettingsCtrl', function($q, dwAlerts, debounce, GreetlySettings, GreetlyCenter, GreetlyLocation) {\n    const $ctrl = this;\n\n    /**\n     * $onInit\n     */\n    $ctrl.$onInit = () => {\n      $ctrl.spin = true;\n      $ctrl.loadSettings()\n        .then(settings => { if (settings.apiKey) return $ctrl.loadGreetlyData(); })\n        .finally(() => { $ctrl.spin = false; })\n    };\n\n    /**\n     * Load Greetly settings\n     */\n    $ctrl.loadSettings = () => GreetlySettings.get()\n      .catch(err => dwAlerts.error(err, 'Failed to load Greetly settings.'))\n      .then(settings => {\n        $ctrl.settings = settings;\n        return settings;\n      });\n\n    /**\n     * Load Greetly data: centers and locations\n     */\n    $ctrl.loadGreetlyData = () => {\n      const promises = [\n        GreetlyCenter.query()\n          .catch(err => dwAlerts.error(err, 'Failed to query Greetly centers.'))\n          .then(centers => {\n            $ctrl.centers = centers;\n          }),\n        GreetlyLocation.query()\n          .catch(err => dwAlerts.error(err, 'Failed to query Greetly locations.'))\n          .then(locations => { $ctrl.locations = locations; }),\n      ];\n\n      return $q.all(promises);\n    };\n\n    /**\n     * Save center\n     */\n    $ctrl.saveCenter = debounce(saveCenter, 1000);\n    function saveCenter(center, form) {\n      if (form.$invalid) return;\n      $ctrl.spin = true;\n      return GreetlyCenter.save(center)\n        .catch(err => dwAlerts.error(err, 'Failed to save Greetly center.'))\n        .finally(() => { $ctrl.spin = false; });\n    }\n\n    /**\n     * Save Greetly settings\n     */\n    $ctrl.saveSettings = debounce(saveSettings, 1000);\n    function saveSettings(form) {\n      if (form.$invalid) return;\n      $ctrl.spin = true;\n      return GreetlySettings.save($ctrl.settings)\n        .catch(err => dwAlerts.error(err, 'Failed to save Greetly settings.'))\n        .then(() => {\n          if ($ctrl.settings.apiKey) {\n            return $ctrl.loadGreetlyData();\n          } else {\n            $ctrl.centers = null;\n            $ctrl.locations = null;\n          }\n        })\n        .finally(() => { $ctrl.spin = false; });\n    }\n  });\n","// Module\nvar code = \"<ff-panel> <ff-panel-header ff-spin=\\\"$ctrl.spin\\\" class=\\\"ff-spin-right\\\"> <span translate=\\\"INTEGRATIONS_SETUP.GREETLY.HEADER\\\"></span> </ff-panel-header> <form name=\\\"form\\\" novalidate> <label class=\\\"ff-row\\\"> <ff-label flex=\\\"0 0 120px\\\"><span translate=\\\"INTEGRATIONS_SETUP.API_KEY\\\"></span></ff-label> <ff-text ff-model=\\\"$ctrl.settings.apiKey\\\" ff-change=\\\"$ctrl.saveSettings(form)\\\" ff-validate-alert=\\\"{{'INTEGRATIONS_SETUP.API_KEY' | translate}}\\\"></ff-text> </label> </form> <ff-header style=\\\"padding-top:.6rem\\\" ng-if=\\\"$ctrl.centers\\\"> <ff-row> <cell flex=\\\"0 0 50%\\\"><span translate=\\\"INTEGRATIONS_SETUP.GREETLY.CENTER\\\"></span></cell> <cell flex=\\\"0 0 50%\\\"><span translate=\\\"INTEGRATIONS_SETUP.GREETLY.LOCATION\\\"></span></cell> </ff-row> </ff-header> <div ng-repeat=\\\"center in $ctrl.centers\\\"> <form name=\\\"form\\\" novalidate> <ff-row> <ff-static flex=\\\"0 0 50%\\\"> <ff-row> <label> <ff-checkbox name=\\\"enabled\\\" ff-model=\\\"center.enabled\\\" ff-change=\\\"$ctrl.saveCenter(center, form)\\\"> <span style=\\\"vertical-align:initial\\\">{{center.name}}</span> </ff-checkbox> </label> </ff-row> </ff-static> <ff-select flex=\\\"0 0 50%\\\" name=\\\"greetlyLocationId\\\" ff-model=\\\"center.greetlyLocationId\\\" ff-required=\\\"true\\\" ff-options=\\\"location.id as location.name for location in $ctrl.locations\\\" ff-change=\\\"$ctrl.saveCenter(center, form)\\\" ff-validate-alert=\\\"{{'INTEGRATIONS_SETUP.GREETLY.LOCATION' | translate}}\\\"></ff-select> </ff-row> <ff-static ng-if=\\\"center.enabled\\\"> <ff-col> <label> <ff-checkbox name=\\\"notificationByEmail\\\" ff-model=\\\"center.notificationByEmail\\\" ff-change=\\\"$ctrl.saveCenter(center, form)\\\"> <span translate=\\\"INTEGRATIONS_SETUP.GREETLY.NOTIFICATION.BY_EMAIL\\\"></span> </ff-checkbox> </label> <label> <ff-checkbox name=\\\"notificationBySlack\\\" ff-model=\\\"center.notificationBySlack\\\" ff-change=\\\"$ctrl.saveCenter(center, form)\\\"> <span translate=\\\"INTEGRATIONS_SETUP.GREETLY.NOTIFICATION.BY_SLACK\\\"></span> </ff-checkbox> </label> <label> <ff-checkbox name=\\\"notificationBySms\\\" ff-model=\\\"center.notificationBySms\\\" ff-change=\\\"$ctrl.saveCenter(center, form)\\\"> <span translate=\\\"INTEGRATIONS_SETUP.GREETLY.NOTIFICATION.BY_SMS\\\"></span> </ff-checkbox> </label> <label> <ff-checkbox name=\\\"notificationByVoice\\\" ff-model=\\\"center.notificationByVoice\\\" ff-change=\\\"$ctrl.saveCenter(center, form)\\\"> <span translate=\\\"INTEGRATIONS_SETUP.GREETLY.NOTIFICATION.BY_VOICE\\\"></span> </ff-checkbox> </label> </ff-col> </ff-static> </form> </div> </ff-panel> \";\n// Exports\nmodule.exports = code;"],"sourceRoot":""}