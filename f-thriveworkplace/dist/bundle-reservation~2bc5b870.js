(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"5Abv":function(e,r){e.exports="<form id=bundleReservationComplete> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <ff-btn-group class=buttons-bottom ng-class=\"{'ff-center': !vm.purchase}\"> <ff-btn sense=home type=submit ff-click=vm.home()><span translate=GLOBAL.BTN_HOME></span></ff-btn> </ff-btn-group> </form> "},"5nZu":function(e,r,t){"use strict";t("DbwS"),t("t91x"),angular.module("deskworks.StaffHelpCtrl",["ngRoute","deskworks.helper","deskworks.config"]).controller("StaffHelpCtrl",["$scope","$timeout","$q","$route","$window","$translate","dwAlerts","helper","state","deskworksConfig",function(e,r,t,n,s,a,o,i,l,u){this.notice=l.getParam("notice"),l.setPageTitle(a.instant("SIMPLE_RES.STAFF_HELP.PAGE_TITLE")),e.$on("$routeChangeStart",function(e,r,t){!r.$$route||"MemberSignUpBillingCtrl"!==r.$$route.controller&&"MemberSignUpPurchaseCtrl"!==r.$$route.controller&&"SimpleReservationBillingCtrl"!==r.$$route.controller&&"SimpleReservationPurchaseCtrl"!==r.$$route.controller&&"BuyPassBillingCtrl"!==r.$$route.controller&&"BuyPassPurchaseCtrl"!==r.$$route.controller||(o.error(a.instant("SIMPLE_RES.STAFF_HELP.BACK_ERROR")),e.preventDefault())}),this.home=function(){if(l.getParam("redirect"))s.location.href=l.getParam("redirect");else{var e=l.getParam("origin"),n=l.getCurrentCenterId();(e?l.logout():t.when()).finally(function(){return l.resetParams(),e&&l.setCurrentCenterId(n),l.setPath(e||u.getDefaultRoute())})}return r(1e4)}}])},"9QnR":function(e,r){e.exports='<div id=newBillingProfile> <h4 class="page-title flex"> <span>{{state.getPageTitle()}}</span> <need-help phone="$resolve.center.phone || vm.reg.phone"></need-help> </h4> <ff-board> <ff-panel style=max-width:450px> <ff-panel-header> <span translate=GLOBAL.STEP_X_OF_Y translate-values=vm.reg ng-if=vm.reg.stepCount></span> <span ng-if=vm.reg.stepCount>&nbsp;</span> <small translate=GLOBAL.REQUIRED_FIELDS_MARKED_WITH></small> </ff-panel-header> <div class="ff-grid gutter-v"> <up-credit-cards user-profile=vm.userProfile reg=vm.reg settings=vm.settings single=true ng-if=vm.userProfile.creditCards.length></up-credit-cards> <up-e-checks user-profile=vm.userProfile reg=vm.reg single=true ng-if="vm.settings.enableEChecks && vm.userProfile.eChecks.length"></up-e-checks> <ff-btn-group ng-if=vm.showSwitchButton()> <ff-btn sense=add size=sm ng-if=vm.userProfile.eChecks.length ff-click=vm.addCC()> <span translate=BILLING_PROFILE.CREDIT_CARDS.BTN_ADD></span> </ff-btn> <ff-btn sense=add size=sm ng-if=vm.userProfile.creditCards.length ff-click=vm.addECheck()> <span translate=BILLING_PROFILE.E_CHECKS.BTN_ADD></span> </ff-btn> </ff-btn-group> </div> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom> <ff-btn sense=help ff-click=vm.staffHelp() ng-if=vm.staffHelp><span translate=GLOBAL.BTN_STAFF_HELP></span></ff-btn> <ff-btn sense=back ff-click=vm.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next ff-click=vm.next() ng-if=vm.next><span translate=SIMPLE_RES.BILLING.BTN_PURCHASE></span></ff-btn> <ff-btn sense=next ff-click=vm.complete() ng-if=vm.complete><span translate=MEMBER_SIGN_UP.BILLING.BTN_COMPLETE></span></ff-btn> </ff-btn-group> </div> '},CMUX:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.complete",[]).controller("BundleReservationCompleteCtrl",["$scope","$translate","dwAlerts","state","helper","deskworksConfig","center","purchase",function(e,r,t,n,s,a,o,i){this.center=o,this.purchase=i,n.setPageTitle(r.instant("SIMPLE_RES.COMPLETE.PAGE_TITLE")),e.$on("$routeChangeStart",function(e,n,s){!n.$$route||"BundleReservationConfirmCtrl"!==n.$$route.controller&&"BundleReservationBillingCtrl"!==n.$$route.controller||(t.error(r.instant("SIMPLE_RES.COMPLETE.BACK_ERROR")),e.preventDefault())}),this.home=function(){return n.resetParams(),n.setPath(a.getDefaultRoute())}}])},Hqwt:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.staffHelp",["ngRoute","deskworks.helper","deskworks.config"]).controller("BundleReservationStaffHelpCtrl",["$scope","$route","dwAlerts","helper","state","deskworksConfig",function(e,r,t,n,s,a){this.notice=s.getParam("notice"),s.setPageTitle("Staff Help"),e.$on("$routeChangeStart",function(e,r,n){!r.$$route||"BundleReservationBillingCtrl"!==r.$$route.controller&&"BundleReservationPurchaseCtrl"!==r.$$route.controller||(t.error("Our staff will help you to complete the registration."),e.preventDefault())}),this.home=function(){return s.resetParams(),s.setPath(a.getDefaultRoute())}}])},OS2P:function(e,r,t){"use strict";t.r(r);t("aIjk");r.default=angular.module("deskworks.bundleReservation.purchase",["ngRoute","deskworks.helper","deskworks.purchase.service","needHelp"]).controller("BundleReservationPurchaseCtrl",["$scope","$route","$translate","dwAlerts","helper","state","reg","center","purchase","purchaseService",function(e,r,t,n,s,a,o,i,l,u){var f=this;f.reg=o,f.center=i,f.purchase=l,a.setPageTitle(t.instant("SIMPLE_RES.PURCHASE.PAGE_TITLE",{centerName:i.name})),f.next=function(){return a.setPath(a.getPath()+"/billing")},f.back=a.back,f.staffHelp=function(){return u.createStaffHelp(f.center.id,a.getCurrentUserId(),r.current.params.purchaseId).catch(function(e){return n.error(e,"Failed to create staff help.")}).then(function(e){return a.setParam("notice",e.notice),a.setPath(a.getPath()+"/staff-help")})}}])},Obn3:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.BundleReservationPurchase",["ngResource","deskworks.config"]).factory("BundleReservationPurchase",["$resource","deskworksConfig",function(e,r){return e(r.getApiAbsUrl("/centers/:centerId/user-profiles/:userId/purchases/:purchaseId"),{centerId:"@centerId",userId:"@userId",reservationBundleId:"@reservationBundleId",reservation:!0},{save:{method:"POST"}})}])},Soaq:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.confirm",["deskworks.bundleReservation.BundleReservation"]).controller("BundleReservationConfirmCtrl",["$scope","$route","$translate","BundleReservation","helper","state","dwAlerts",function(e,r,t,n,s,a,o){a.setPageTitle(t.instant("RESERVATIONS.CONFIRM.PAGE_TITLE")),this.back=a.back,this.next=function(){if(a.isLoggedMember()||a.isLoggedAdmin()){var e={centerId:a.getCurrentCenterId(),userId:a.getCurrentUserId(),reservationBundleId:r.current.params.reservationBundleId};return n.save(e).$promise.catch(function(e){return o.error(e,"Failed to make reservation.")}).then(function(){return a.setPath(a.getPath().replace(/\/confirm$/,"/complete"))})}return o.error("Failed to make reservation without payment for non-member.")}}])},TQqA:function(e,r,t){"use strict";t.r(r);t("t91x"),t("5nZu");var n=t("l7sz"),s=t.n(n),a=t("aE5K"),o=t.n(a),i=t("9QnR"),l=t.n(i),u=["$injector",function(e){var r,n=(r=t("irk7")).keys().map(r);e.loadNewModules(n.map(function(e){return e.default.name})),e.invoke(["$templateCache",function(e){var r=t("i/oZ");r.keys().forEach(function(t){return e.put(t.replace(/^\.\//,""),r(t))}),e.put("staff-help/staff-help.tpl.html",s.a),e.put("templates/new-user-profile.tpl.html",o.a),e.put("templates/new-billing-profile.tpl.html",l.a)}])}];r.default=u},aE5K:function(e,r){e.exports='<div class=user-profile id=userProfile> <h4 class="page-title flex"> <span> {{state.getPageTitle()}} <span ng-if="vm.reg.member && !vm.reg.selfRegistration" ng-style="{ color: vm.center.color }">{{vm.center.name}}</span> </span> <need-help phone=vm.reg.phone></need-help> </h4> <ff-board> <ff-panel> <ff-panel-header ng-if=vm.reg> <span translate=GLOBAL.STEP_X_OF_Y translate-values=vm.reg ng-if=vm.reg.stepCount></span> <small translate=GLOBAL.REQUIRED_FIELDS_MARKED_WITH></small> </ff-panel-header> <div class="ff-grid ff-gutter-v ff-gutter-h"> <up-personal-info user=vm.userProfile schema=vm.schema reg=vm.reg></up-personal-info> <up-addresses flex="{md: \'0 0 50%\'}" user=vm.userProfile schema=vm.schema reg=vm.reg center=vm.center single=true></up-addresses> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-login-info user=vm.userProfile schema=vm.schema reg=vm.reg member-directory-url=wlLinks.memberDirectoryUrl></up-login-info> <up-phones user=vm.userProfile schema=vm.schema reg=vm.reg single=true></up-phones> </div> </div> <up-photo flex="{md: \'0 0 50%\'}" user=vm.userProfile schema=vm.schema reg=vm.reg></up-photo> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-lead-source user=vm.userProfile schema=vm.schema reg=vm.reg></up-lead-source> <up-terms-of-service user=vm.userProfile schema=vm.schema reg=vm.reg></up-terms-of-service> </div> </div> </div> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom ng-if=vm.reg> <ff-btn sense=back ff-click=vm.back() ng-if=vm.back><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next ff-click=vm.next()><span translate=GLOBAL.BTN_NEXT></span></ff-btn> </ff-btn-group> </div> '},aIjk:function(e,r,t){"use strict";r.a=angular.module("needHelp",[]).directive("needHelp",function(){return{restrict:"E",scope:!0,controller:function(){},controllerAs:"$ctrl",template:'<span translate="GLOBAL.NEED_HELP" class="need-help" ng-if="$ctrl.phone" '+"translate-values=\"{ phone: '<a href=&quot;tel:' + $ctrl.phone + '&quot;>' + $ctrl.phone + '</a>' }\"></span>",bindToController:{phone:"<"}}})},aQrS:function(e,r){e.exports='<form name=formPurchase id=buyPassPurchase> <h4 class="page-title flex"> <span>{{state.getPageTitle()}}</span> <need-help phone=$ctrl.center.phone></need-help> </h4> <ff-board> <ff-panel> <ff-panel-header>Order Id: {{$ctrl.purchase.orderId}}</ff-panel-header> <dw-invoice invoice=$ctrl.purchase center=$ctrl.center allow-remove=false></dw-invoice> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom> <ff-btn sense=help ff-click=$ctrl.staffHelp()><span translate=GLOBAL.BTN_STAFF_HELP></span></ff-btn> <ff-btn sense=back ff-click=state.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next type=submit ff-click=$ctrl.next()><span translate=GLOBAL.BTN_NEXT></span></ff-btn> </ff-btn-group> </form> '},aY00:function(e,r,t){"use strict";t.r(r);t("it7j");r.default=angular.module("deskworks.bundleReservation.billing",["ngRoute","deskworks.userProfile.service","deskworks.purchase.service","deskworks.bundleReservation.BundleReservation","deskworks.bundleReservation.BundleReservationPurchase","deskworks.routeHelper","deskworks.helper"]).controller("BundleReservationBillingCtrl",["$scope","$route","$translate","dwAlerts","helper","state","userProfile","reg","userProfileService","purchaseService","BundleReservation","settings",function(e,r,t,n,s,a,o,i,l,u,f,c){var d=this;if(d.userProfile=o,d.reg=i,d.settings=c,c.creditCardTypes=c.creditCardTypes.filter(function(e){return e.enable}),d.userProfile.creditCards.forEach(function(e){e.type=s.find(c.creditCardTypes,e.type)||e.type||{}}),a.setPageTitle(t.instant("BILLING_PROFILE.PAGE_TITLE",{userName:s.join([d.userProfile.firstName,d.userProfile.lastName]," ")})),d.userProfile.creditCards=d.userProfile.creditCards||[],!d.userProfile.creditCards.length){var p=l.creditCard.new(d.userProfile);p.type=c.creditCardTypes[0],d.userProfile.creditCards.push(p)}l.bindTestBillingGenerator(e,d.userProfile,d.reg),d.addCC=function(){var e=l.creditCard.new(d.userProfile);d.userProfile.creditCards=[e],d.userProfile.eChecks=[]},d.addECheck=function(){var e=l.eCheck.new(d.userProfile);d.userProfile.eChecks=[e],d.userProfile.creditCards=[]},d.showSwitchButton=function(){var e=!d.userProfile.creditCards[0]||l.creditCard.isNew(d.userProfile.creditCards[0]),r=!d.userProfile.eChecks[0]||l.eCheck.isNew(d.userProfile.eChecks[0]);return e&&r&&d.settings.enableEChecks},d.next=function(){if(!s.pointFirstInvalid("#simpleReservationBilling"))return l.saveBillingProfile(a.getCurrentCenterId(),d.userProfile).then(function(){var e={centerId:a.getCurrentCenterId(),userId:a.getCurrentUserId(),reservationBundleId:r.current.params.reservationBundleId};return f.save(e).$promise.catch(function(e){return n.error(e,"Failed to make reservation.")}).then(function(e){return u.createPayment(a.getCurrentCenterId(),a.getCurrentUserId(),r.current.params.purchaseId,{}).catch(function(e){return n.error(e,"Failed to make payment.")}).then(function(){return a.setPath(a.getPath()+"/complete")})})})},d.staffHelp=function(){return u.createStaffHelp(a.getCurrentCenterId(),a.getCurrentUserId(),r.current.params.purchaseId).catch(function(e){return n.error(e,"Failed to create staff help.")}).then(function(e){return a.setParam("notice",e.notice),a.setPath(a.getPath().replace(/\/billing$/,"/staff-help"))})},d.back=a.back}])},buMD:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.BundleReservation",["ngResource","deskworks.config"]).factory("BundleReservation",["$resource","deskworksConfig",function(e,r){return e(r.getApiAbsUrl("/centers/:centerId/user-profiles/:userId/reservations/:reservationId"),{centerId:"@centerId",userId:"@userId",reservationBundleId:"@reservationBundleId"},{save:{method:"POST"}})}])},gRWq:function(e,r){e.exports='<form name=formBundleReservationConfirm id=bundleReservationConfirm> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <ff-btn-group class="buttons-bottom text-center"> <ff-btn sense=next type=submit ff-click=vm.next()><span translate=GLOBAL.BTN_CONFIRM></span></ff-btn> <ff-btn sense=back ff-click=vm.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> </ff-btn-group> </form> '},"i/oZ":function(e,r,t){var n={"./steps/bundle-reservation-complete-member.tpl.html":"5Abv","./steps/bundle-reservation-complete.tpl.html":"lflH","./steps/bundle-reservation-confirm.tpl.html":"gRWq","./steps/bundle-reservation-purchase.tpl.html":"aQrS"};function s(e){var r=a(e);return t(r)}function a(e){if(!t.o(n,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=a,e.exports=s,s.id="i/oZ"},irk7:function(e,r,t){var n={"./services/bundle-reservation-purchase.service.js":"Obn3","./services/bundle-reservation.service.js":"buMD","./steps/bundle-reservation-billing.controller.js":"aY00","./steps/bundle-reservation-complete.controller.js":"CMUX","./steps/bundle-reservation-confirm.controller.js":"Soaq","./steps/bundle-reservation-purchase.controller.js":"OS2P","./steps/bundle-reservation-sign-in.controller.js":"u/01","./steps/bundle-reservation-staff-help.controller.js":"Hqwt","./steps/bundle-reservation-user-profile.controller.js":"rOfW"};function s(e){var r=a(e);return t(r)}function a(e){if(!t.o(n,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=a,e.exports=s,s.id="irk7"},l7sz:function(e,r){e.exports='<div id=staffHelp class=ff-tmargin> <ff-board> <ff-panel> <span ng-bind=::vm.notice></span> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom ff-center"> <ff-btn sense=home type=submit ff-click=vm.home()><span translate=GLOBAL.BTN_HOME></span></ff-btn> </ff-btn-group> </div> '},lflH:function(e,r){e.exports='<div id=bundleReservationComplete> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <ff-board> <ff-panel> <ff-panel-header> <span translate=SIMPLE_RES.COMPLETE.ORDER.HEADER translate-values="{ orderId: vm.purchase.orderId }"></span> </ff-panel-header> <dw-invoice invoice=vm.purchase center=vm.center allow-remove=false></dw-invoice> </ff-panel> </ff-board> <ff-btn-group class=buttons-bottom> <ff-btn sense=home type=submit ff-click=vm.home()><span translate=GLOBAL.BTN_HOME></span></ff-btn> </ff-btn-group> </div> '},rOfW:function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.userProfile",["ngRoute","deskworks.helper","deskworks.userProfile.service","deskworks.bundleReservation.BundleReservationPurchase"]).controller("BundleReservationUserProfileCtrl",["$scope","$q","$route","$timeout","$translate","dwAlerts","helper","state","reg","centers","userProfile","userProfileService","setupService","BundleReservationPurchase",function(e,r,t,n,s,a,o,i,l,u,f,c,d,p){var g=this;l.new=!i.getLoggedUserId(),g.reg=l,g.userProfile=f,g.schema=f.schema,i.setPageTitle(s.instant(g.reg.new?"USER_PROFILE.NEW_USER.PAGE_TITLE":"USER_PROFILE.PAGE_TITLE",{userName:g.userProfile.firstName+" "+g.userProfile.lastName})),d.getSetupSettings().catch(function(e){return a.error(e,"Failed to get settings.")}).then(function(e){g.settings=e}),c.bindTestUserGenerator(e,g.userProfile,g.reg),g.next=function(){if(!o.pointFirstInvalid("#userProfile"))return(g.reg.new?c.registerNewUser(0,g.userProfile):r.when()).then(function(){if(g.reg.new)return i.login(g.userProfile.login,g.userProfile.password).catch(function(e){return a.error(e,"Failed to login under created user.")}).then(function(){return i.replace(),i.setCurrentCenterId(u[0].id),n()})}).then(function(){var e={centerId:i.getCurrentCenterId(),userId:i.getCurrentUserId(),reservationBundleId:t.current.params.reservationBundleId};return p.save(e).$promise.catch(function(e){return a.error(e,"Failed to create purchase for bundle reservation.")})}).then(function(e){return i.setPath(i.getPath()+"/purchase/"+e.id)})},g.back=i.back}])},"u/01":function(e,r,t){"use strict";t.r(r),r.default=angular.module("deskworks.bundleReservation.signIn",["flexForms","deskworks.state","deskworks.config","deskworks.dwSignIn"]).controller("BundleReservationSignInCtrl",["$scope","$translate","state",function(e,r,t){t.setPageTitle(r.instant("SIGN_IN.PAGE_TITLE")),e.$on("dwSignIn:SignIn",function(e){return e.stopPropagation(),t.replace(),t.isLoggedNonMember()?t.setPath(t.getPath()+"/user-profile"):t.setPath(t.getPath()+"/confirm")}),e.$on("dwSignIn:SignUp",function(e){return e.stopPropagation(),t.replace(),t.setPath(t.getPath()+"/user-profile")}),this.back=t.back}])}}]);