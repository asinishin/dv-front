(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"+vx3":function(e,t,r){"use strict";r.r(t);r("it7j");t.default=angular.module("deskworks.importDetectSubgroups",["deskworks.helper"]).factory("importDetectSubgroups",["helper",function(e){return function(t,r,n){var i=n.reduce(function(e,t){var r=e.find(function(e){return e.id===(t.subgroup||"nosubgroup")});return r||(r={id:t.subgroup,fields:[]},e.push(r)),r.fields.push(t),e},[{id:"nosubgroup",fields:[]}]);r.data.forEach(function(t,o){var s=r.rowsMeta[o];if(!s.empty&&!s.headRow&&(i.forEach(function(n){n.nonEmptyCount=n.fields.reduce(function(n,i){return e.trim(t[r.mapping.indexOf(i.id)])?++n:n},0)}),!i[0].nonEmptyCount&&i.length>1)){var a=i.slice(1,i.length).reduce(function(e,t){return!e||t.nonEmptyCount>e.nonEmptyCount?t:e});s.subgroup=a.id;var c=e.findIndexByKeyValue(n,"subgroupKey",!0);c>=0&&!t[c]&&angular.isUndefined(s.ignore)&&(s.ignore=!0)}})}}])},"/Qjn":function(e,t){e.exports="<div id=setupImport> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <import-step-init ng-if=\"$ctrl.steps[$ls.step].id === 'init'\" step=$ls.step sheets=$ls.sheets purge=$ctrl.purge></import-step-init> <import-step-import ng-if=\"$ctrl.steps[$ls.step].id !== 'init' && $ctrl.steps[$ls.step].id !== 'complete'\" step=$ls.step sheets=$ls.sheets purge=$ctrl.purge></import-step-import> <import-step-complete ng-if=\"$ctrl.steps[$ls.step].id === 'complete'\" step=$ls.step sheets=$ls.sheets purge=$ctrl.purge></import-step-complete> </div> "},"2dNM":function(e,t,r){"use strict";r.r(t);r("DbwS"),r("t91x");var n=r("5xSF"),i=r.n(n);t.default=angular.module("deskworks.importStepImport",["deskworks.dwAlerts","deskworks.handsontable","deskworks.importHandsontable","deskworks.importSheetDetector","deskworks.importSteps","deskworks.importInitMetaData","deskworks.importDetectSubgroups","deskworks.importWireData","deskworks.importValidateData","deskworks.importCollectStats"]).component("importStepImport",{templateUrl:"step-components/step-import.tpl.html",controller:"ImportStepImportCtrl",bindings:{step:"=",sheets:"<",purge:"<"}}).controller("ImportStepImportCtrl",["$scope","$q","$timeout","dwAlerts","state","helper","importSheetDetector","importSteps","importInitMetaData","importDetectSubgroups","importWireData","importValidateData","importCollectStats",function(e,t,r,n,o,s,a,c,d,u,l,p,f){var m=this;m.steps=c,e.$watch("$ctrl.step",function(){if(m.step){var e=m.steps[m.step];m.fields=e.fields,m.sheet=null,t.when(e.hooks&&e.hooks.init&&e.hooks.init(m)).then(function(){m.sheet=a.detect(m.sheets,m.step)})}}),m.back=function(){m.step--},m.validateData=function(){d(m.sheet),m.fields.filter(function(e){return m.sheet.mapping.indexOf(e.id)<0}).length||(u(m,m.sheet,m.fields),l(m,m.sheet,m.fields,m.steps[m.step].hooks.wireRow),m.invalidCount=p(m.sheet,m.fields,e),m.stats=f(m.sheet.rowsMeta)),e.$broadcast("ht:render")},m.import=function(){if(m.unMappedFields.length)return n.error("Some columns unmapped. Please check red UNKNOWN markers and map them to appropriate fields.");if(m.invalidCount)return n.error(m.invalidCount+" invalid values found. Please fix them manually to proceed to the next step.");var e=m.steps[m.step],o=0,s=new i.a(function(){for(;o<m.sheet.data.length&&(m.sheet.rowsMeta[o].ignore||m.sheet.rowsMeta[o].subgroup||m.sheet.rowsMeta[o].headRow||m.sheet.rowsMeta[o].empty);)o++;if(o>=m.sheet.data.length)return null;var t=m.sheet.rowsMeta[o];return t.spin=!0,e.hooks.importRow(m,m.sheet.data[o++],t,m.sheet.mapping,m.fields).then(function(e){t.id=e.id||t.id,t.error=null}).catch(function(e){t.error=e.data&&e.data.error||e.status+" "+e.statusText}).finally(function(){t.spin=!1,t.ignore=!0})},5,{promise:t});return m.spin=!0,t.when(e.hooks&&e.hooks.preImport&&e.hooks.preImport(m,m.sheet,m.fields)).then(function(){return s.start()}).then(function(){return m.validateData(),r(function(){m.spin=!1,m.step++},1e3)})}}])},4:function(e,t){},"4D44":function(e,t,r){"use strict";r.r(t);r("it7j");t.default=angular.module("deskworks.importHandsontable",["deskworks.helper","deskworks.dwAlerts","deskworks.importStripDataComments","deskworks.importDetectHeadRowIdx","deskworks.importAutoMapColumns"]).directive("importHandsontable",function(){return{restrict:"E",scope:!0,templateUrl:"handsontable/import-handsontable.tpl.html",controller:"ImportHandsontableCtrl as $ctrl",bindToController:{step:"<",sheet:"<",fields:"<",onValidate:"&",unMappedFields:"="}}}).controller("ImportHandsontableCtrl",["$scope","$window","$timeout","dwAlerts","helper","importStripDataComments","importDetectHeadRowIdx","importAutoMapColumns",function(e,t,r,n,i,o,s,a){var c=this;function d(e){return e.map(function(e){return{cellsMeta:Array.apply(null,Array(e.length)).map(function(){return{}})}})}e.$watch("$ctrl.sheet",function(){var t;c.sheet&&(c.sheet.mappedToStep||(o(c.sheet.data),c.sheet.headRowIdx=s(c.sheet.data,c.fields),c.sheet.mapping=a(c.sheet.data,c.fields,c.sheet.headRowIdx),c.sheet.headRowIdx>=0?(c.sheet.mappedToStep=c.step,c.sheet.rowsMeta=d(c.sheet.data),(t=c.sheet).headRowIdx<0||(t.rowsMeta.slice(0,t.headRowIdx).forEach(function(e){e.ignore=!0}),t.rowsMeta[t.headRowIdx].headRow=!0)):c.sheet.rowsMeta=c.sheet.rowsMeta||d(c.sheet.data)),r(function(){e.$broadcast("ht:render")}))}),e.$watch("$ctrl.sheet.mapping",function(e){e&&(c.unMappedFields=c.fields.filter(function(t){return e.indexOf(t.id)<0}),c.availableFields=e.map(function(t){return c.fields.filter(function(r){return r.id===t||e.indexOf(r.id)<0})}),c.mappingFields=e.map(function(e){return c.fields.find(function(t){return t.id===e})}),c.onValidate())},!0),e.$on("ht:afterCreateRow",function(e,t,r){e.stopPropagation(),c.sheet.headRowIdx>=t&&(c.sheet.headRowIdx+=r);var n=c.sheet.rowsMeta.slice(0,t),i=Array.apply(null,Array(r)).map(function(){return{cellsMeta:Array.apply(null,Array(c.sheet.data[0].length)).map(function(){return{}})}}),o=c.sheet.rowsMeta.slice(t);c.sheet.rowsMeta=n.concat(i).concat(o),c.onValidate()}),e.$on("ht:afterRemoveRow",function(e,t,r){e.stopPropagation(),c.sheet.headRowIdx>=t+r?c.sheet.headRowIdx-=r:c.sheet.headRowIdx>=t&&(c.sheet.headRowIdx=-1),c.sheet.rowsMeta.splice(t,r),c.onValidate()}),e.$on("ht:afterChange",function(e){e.stopPropagation(),c.onValidate()}),c.cellRenderer=function(e,t,r,n,i,o,s){if(t.innerHTML=o,t=angular.element(t),c.sheet.rowsMeta&&c.sheet.rowsMeta[r]&&c.sheet.rowsMeta[r].cellsMeta&&c.sheet.rowsMeta[r].cellsMeta[n])return c.sheet.rowsMeta[r].cellsMeta[n].invalid&&(t.addClass("ht-invalid"),t[0].innerHTML+='<span class="fa fa-exclamation-triangle"></span>'),c.sheet.rowsMeta[r].headRow&&t.addClass("ht-head-row"),c.sheet.rowsMeta[r].ignore&&t.addClass("ht-ignore"),t.attr("rc",r+"x"+n),t[0]},c.onClickRowIcon=function(e){var t=c.sheet.rowsMeta[e];t.headRow||(t.ignore=!t.ignore,c.onValidate())},c.onSelectValidData=function(t,r,n){if(c.sheet.data.reduce(function(e,t,i){return c.sheet.rowsMeta[i].invalid&&(t[n]||"")===(c.sheet.data[r][n]||"")?++e:e},0)>1){var i='"'+c.fields.find(function(e){return e.id===c.sheet.mapping[n]}).name+'" column contains more "'+(c.sheet.data[r][n]||"empty")+'" occurrences. Fix them all to "'+t+'" automatically?';if(confirm(i))for(var o=0;o<c.sheet.data.length;o++)o!==r&&c.sheet.rowsMeta[o].invalid&&(c.sheet.data[o][n]||"")===(c.sheet.data[r][n]||"")&&(c.sheet.data[o][n]=t)}c.sheet.data[r][n]=t,e.$broadcast("ht:commitValue",t),c.onValidate()}}])},5:function(e,t){},"52bj":function(e,t,r){"use strict";r.r(t);r("t91x");t.default=angular.module("deskworks.SetupImportCtrl",["ngStorage","deskworks.state","deskworks.importSteps","deskworks.importStepInit","deskworks.importStepImport","deskworks.importStepComplete","deskworks.purge.service"]).controller("SetupImportCtrl",["$scope","$localStorage","dwAlerts","state","importSteps","purgeService",function(e,t,r,n,i,o){var s=this;t.import=t.import||{};var a=t.import;Object.keys(a).forEach(function(e){var t=e.match(/^v(\d+)$/i);(!t||t&&1!=+t[1])&&delete a[e]});var c=a.v1=a.v1||{},d=e.$ls=c[n.getCurrentCenterId()]=c[n.getCurrentCenterId()]||{};d.step=d.step||0,d.sheets=d.sheets||[],s.steps=i,e.$watch("$ls.step",function(){n.setPageTitle("Import "+s.steps[d.step].name)}),s.purge=function(){if(window.confirm("It will purge all data. Are you sure?"))return o.purgeMembers().catch(function(e){return r.error(e,"Failed to purge members.")}).then(function(){return o.purgeProducts().catch(function(e){return r.error(e,"Failed to purge products.")})}).then(function(){return o.purgePriceLists(n.getCurrentCenterId()).catch(function(e){return r.error(e,"Failed to purge price lists.")})}).then(function(){return o.purgeMembershipTypes().catch(function(e){return r.error(e,"Failed to purge membership categories.")})}).then(function(){return o.purgeReservationCategories().catch(function(e){return r.error(e,"Failed to purge reservation categories.")})}).then(function(){Object.keys(c).forEach(function(e){c[e].step=0,c[e].sheets.splice(0,c[e].sheets.length)})})}}])},6:function(e,t){},"6Efl":function(e,t,r){"use strict";r.r(t);var n=r("Ehlk"),i=r.n(n);t.default=angular.module("deskworks.handsontable",["deskworks.handsontable.htHeaderExtra","deskworks.handsontable.htRowExtra","deskworks.handsontable.htBodyExtra"]).directive("handsontable",function(){return window.Handsontable=i.a,{restrict:"E",scope:!0,controller:"HandsontableCtrl as ht",bindToController:{data:"<htData",renderer:"<htRenderer",manualColumnWidths:"<htManualColumnWidths"},compile:function(){return function(e,t,r,n){if(!window.Handsontable)return console.error("Handsontable component is not found.");e.$watch("ht.data",function(r){angular.isArray(r)&&angular.isArray(r[0])&&(n.settings.data=r,n.instance?n.instance.updateSettings(n.settings):n.instance=new i.a(t[0],n.settings),e.$broadcast("ht:dataChange",n.settings.data))}),e.$on("$destroy",function(){n.instance&&(n.instance.destroy(),delete n.instance)})}}}}).controller("HandsontableCtrl",["$scope","$element","$attrs","$timeout",function(e,t,r,n){var i=arguments,o=this,s=document.getElementById("htImport"),a=s.addEventListener;s.addEventListener=function(e){if("wheel"!==e)return a.apply(s,i)},o.settings={data:o.data,rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,autoWrapRow:!0,autoWrapCol:!0,autoInsertRow:!1,autoRowSize:!0,autoColumnSize:!0,allowInsertColumn:!1,enterBeginsEditing:!1,renderAllRows:!0,viewportColumnRenderingOffset:100,cells:function(){return{renderer:o.renderer}},contextMenu:["row_above","row_below","remove_row"],afterSelectionEnd:function(t,r){e.$apply(function(){e.$emit("ht:afterSelection",t,r)})},afterDeselect:function(){e.$apply(function(){e.$emit("ht:afterDeselect")})},afterChange:function(){e.$root.$$phase||e.$apply(function(){e.$emit("ht:afterChange")})},afterRender:function(){if(e.$root.$$phase)return n(function(){e.$emit("ht:afterRender")});e.$apply(function(){e.$emit("ht:afterRender")})},afterCreateRow:function(t,r){e.$apply(function(){e.$emit("ht:afterCreateRow",t,r)})},afterRemoveRow:function(t,r){e.$apply(function(){e.$emit("ht:afterRemoveRow",t,r)})},init:function(){this.getPlugin("manualColumnResize").manualColumnWidths=o.manualColumnWidths||[]},afterUpdateSettings:function(){this.getPlugin("manualColumnResize").manualColumnWidths=o.manualColumnWidths||[],this.getPlugin("autoRowSize").recalculateAllRowsHeight()},afterGetColHeader:function(e,t){e>=0&&t.setAttribute("htcol",e)},afterGetRowHeader:function(e,t){e>=0&&t.setAttribute("htrow",e)}},e.$on("ht:commitValue",function(e,t){var r=o.instance.getActiveEditor();r&&r._opened&&(r.setValue(t),r.focus(),r.close())}),e.$on("ht:render",function(){o.instance&&o.instance.render()})}])},"6yKF":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importDetectHeadRowIdx",[]).factory("importDetectHeadRowIdx",["helper",function(e){return function(t,r){if(angular.isArray(r)&&angular.isArray(t)){var n=r.slice(),i=t.slice(0,5).map(function(t){var r=0;return t.forEach(function(t){for(var i=0;i<n.length;i++)if(e.trim(t).match(n[i].pattern)){n.splice(i,1),r++;break}}),r}),o=i.indexOf(Math.max.apply(Math,i));return i[o]>=r.length/1.5?o:-1}}}])},"7A+6":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsMembershipProducts",[]).factory("importFieldsMembershipProducts",function(){return[{id:"name",name:"Product Name",pattern:/Product\s+Name/i,required:!0,unique:!0},{id:"membershipCategory",name:"Membership Category",pattern:/Membership\s+Category/i,required:!0},{id:"isCreditable",name:"Has Reservation Credit?",pattern:/Has\s+Reservation\s+Credit/i,type:"bool"},{id:"hasPasses",name:"Has Passes?",pattern:/Has\s+Passes/i,type:"bool"},{id:"passProduct",name:"Product to use for pass",pattern:/Product.+for.+pass/i,type:{options:"$ctrl.productsRental"}},{id:"showInSelfRegistration",name:"Show for Self-Registration",pattern:/Show.+Self.*Regis/i,type:"bool"},{id:"productCategoryCode",name:"Product Category Code",pattern:/Product\s+Category\s+Code/i,required:!0},{id:"productCategoryName",name:"Product Category Name",pattern:/Product\s+Category\s+Name/i},{id:"productNumber",name:"Part Number Code",pattern:/Part\s+Number\s+Code/i,required:!0,type:"uint"},{id:"price",name:"Price",pattern:/^Price/i,required:!0,type:"currency"},{id:"reservationCredit",name:"Reservation Credit",pattern:/^Reservation\s+Credit/i,type:"currency"},{id:"passQty",name:"Passes",pattern:/^Passes/i,type:"uint"},{id:"description",name:"Description",pattern:/Description/i}]})},"9AYr":function(e,t){e.exports='<handsontable id=htImport ht-data=$ctrl.sheet.data ht-rows-meta=$ctrl.sheet.rowsMeta ht-renderer=$ctrl.cellRenderer ht-manual-column-widths=$ctrl.sheet.manualColumnWidths> <ht-header-extra> <div class="itooltip ht-head-tooltip" ng-class="{ ok: $ctrl.sheet.mapping[$col] || !$ctrl.unMappedFields.length }"> <span ng-bind="$ctrl.mappingFields[$col].name || \'UNKNOWN\'"></span> <ff-select ff-model=$ctrl.sheet.mapping[$col] ff-options="field.id as field.name for field in $ctrl.availableFields[$col]"> <option value="">UNKNOWN</option> </ff-select> </div> </ht-header-extra> <ht-row-extra> <div class=ht-row-extra ng-init="rowMeta = $ctrl.sheet.rowsMeta[$row]" ng-show=!$ctrl.unMappedFields.length> <ff-icon sense=error ng-if="rowMeta.error && rowMeta.ignore" ng-click=$ctrl.onClickRowIcon($row) title={{rowMeta.error}}> </ff-icon> <ff-icon sense=warning ng-if="rowMeta.invalid && !rowMeta.ignore" ng-click=$ctrl.onClickRowIcon($row) title="This row contains invalid values. Fix them or click this icon to ignore this row."></ff-icon> <ff-icon sense=check ng-if="rowMeta.id && !rowMeta.invalid && rowMeta.ignore && !rowMeta.error" ng-click=$ctrl.onClickRowIcon($row) title="Existing data, this row will not be imported."></ff-icon> <ff-icon sense=refresh ng-if="rowMeta.id && !rowMeta.invalid && !rowMeta.ignore" ng-click=$ctrl.onClickRowIcon($row) ng-class="{ rotate: rowMeta.spin }" title="Existing data, this row will be updated."></ff-icon> <ff-icon sense=plus ng-if="!rowMeta.id && !rowMeta.ignore && !rowMeta.headRow && !rowMeta.empty && !rowMeta.invalid" ng-click=$ctrl.onClickRowIcon($row) ng-class="{ rotate: rowMeta.spin }" title="This row is new and will be imported."></ff-icon> <ff-icon sense=ignore ng-if="!rowMeta.id && rowMeta.ignore && !rowMeta.error" ng-click=$ctrl.onClickRowIcon($row) title="This row is ignored. Click this icon to stop ignoring this row."></ff-icon> <ff-icon sense=header ng-if=rowMeta.headRow ng-click=$ctrl.onClickRowIcon($row) title="This row is recognized as header."></ff-icon> </div> </ht-row-extra> <ht-body-extra> <div class="itooltip ht-body-tooltip" ng-show=$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid> <span ng-if="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isString" ng-bind-html=$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid></span> <ff-select ff-model=newVal ff-options="opt.name as opt.name for opt in $ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid" ff-change="$ctrl.onSelectValidData(newVal, $row, $col)" ng-if="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isArray"> <option value="">please select</option> </ff-select> </div> </ht-body-extra> </handsontable> '},BGsA:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsMembers",["deskworks.userProfile.optsCountry","deskworks.userProfile.optsState","deskworks.userProfile.optsMembershipStatus","deskworks.userProfile.optsBillingMethod"]).factory("importFieldsMembers",["optsCountry","optsState","optsMembershipStatus","optsBillingMethod",function(e,t,r,n){return[{id:"firstName",name:"First Name",pattern:/First\s+Name/i,required:!0},{id:"lastName",name:"Last Name",pattern:/Last\s+Name/i,required:!0,type:{pattern:/^[^\\<>\/&]*$/,msg:"Last Name should not contain special characters"}},{id:"email",name:"Email",pattern:/Email/i,required:!0,unique:!0,type:"email"},{id:"company",name:"Company",pattern:/Company/i},{id:"login",name:"Login",pattern:/Login/i,required:!0,unique:!0,minLength:3,type:{pattern:/^\w[\w\.\-_@]+$/,msg:"Login should have only letters, numbers, and .-_@"}},{id:"password",name:"Password",pattern:/Password/i,required:!0,minLength:6},{id:"addressStreet",name:"Street",pattern:/Street/i,required:!0},{id:"addressCity",name:"City",pattern:/City/i,required:!0},{id:"addressCountry",name:"Country",pattern:/Country/i,required:!0,type:{options:e}},{id:"addressState",name:"State/Province",pattern:/State\s*\/\s*Province/i,required:!0,type:{options:"$ctrl.optsState.$id",ref:"addressCountry"}},{id:"addressZip",name:"Zip/Postal",pattern:/Zip\s*\/\s*Post/i,required:!0},{id:"phoneNumber",name:"Phone Number",pattern:/Number/i,required:!0,type:{pattern:/^((\+\d{1,3}[-. ]?\(?\d\)?[-. ]?\d{1,5})|(\(?\d{2,6}\)?))[-. ]?(\d{3,4})[-. ]?(\d{4})$/,msg:"Phone number examples: 888-379-2865, +1-888-379-2865, 888 379 2865, 888.379.2865"}},{id:"mailboxNumber",name:"Mailbox #",pattern:/Mailbox #/i},{id:"printerCode",name:"Printer Code",pattern:/Printer\s+Code/i},{id:"accessCode",name:"Access Code",pattern:/Access\s+Code/i},{id:"leadSource",name:"Lead Source",pattern:/Lead\s+Source/i,required:!0,type:{options:"$ctrl.leadSources"}},{id:"comments",name:"Comments",pattern:/Comments/i},{id:"billingMethod",name:"Billing Method",pattern:/Bill\s+By/i,required:!0,type:{options:n}},{id:"recurringProduct",name:"Recurring Billing",pattern:/Recurring\s+Billing/i,type:{options:"$ctrl.products"},subgroup:"recurring",subgroupKey:!0},{id:"recurringQuantity",name:"Qty",pattern:/Qty/i,type:"uint",subgroup:"recurring"},{id:"recurringDiscount",name:"Discount",pattern:/^Discount/i,type:"currency",subgroup:"recurring"},{id:"recurringMonthsOfDiscount",name:"Months of Discount",pattern:/Months\s+of\s+Discount/i,type:"uint",subgroup:"recurring"},{id:"recurringAttachedReservationUnit",name:"Attached Reservation Unit",pattern:/Make\s+Matching\s+Reservation\s+Unit\s+Unavailable/i,unique:!0,type:{options:"$ctrl.reservationUnits"},subgroup:"recurring"},{id:"recurringNextBillDate",name:"Next Bill Date",pattern:/Next\s+Bill\s+Date/i,type:"date",subgroup:"recurring"}]}])},BaSU:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.handsontable.htHeaderExtra",[]).directive("htHeaderExtra",["$compile",function(e){return{restrict:"E",require:"^handsontable",compile:function(t,r){var n=t.html();return t.remove(),function(t,r,i,o){var s=r.parent()[0];t.$on("ht:afterRender",function(r){var i=angular.element(s.querySelector(".ht_master .wtSpreader"));o.headExtraScopes||angular.isArray(o.settings.data)&&angular.isArray(o.settings.data[0])&&(o.headExtraScopes=o.settings.data[0].map(function(r,o){var s=t.$new();return i.append(e(n.replace(/\$col/g,o))(s).addClass("ht-head-extra")),s})),angular.forEach(i[0].querySelectorAll(".ht-head-extra"),function(e){e.style.display="none"}),angular.forEach(s.querySelectorAll(".ht_master th[htcol]"),function(e){var t=i[0].querySelectorAll(".ht-head-extra")[e.getAttribute("htcol")];t.style.left=e.offsetLeft+Math.floor(e.offsetWidth/2)+"px",t.style.top=e.offsetTop+"px",t.style.display=""})}),t.$on("ht:dataChange",function(e,t){var r=s.querySelector(".ht_master .wtSpreader");r&&(angular.element(r.querySelectorAll(".ht-head-extra")).remove(),angular.forEach(o.headExtraScopes,function(e){e.$destroy()}),delete o.headExtraScopes)})}}}}])},Bn1Q:function(e,t,r){"use strict";r.r(t);r("it7j");t.default=angular.module("deskworks.importHooksMembershipProducts",["keese","deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.inventory.membershipCategory.service","deskworks.ProductCategory"]).factory("importHooksMembershipProducts",["$q","dwAlerts","helper","state","importParsers","keese","ProductCategory","productService","priceListService","membershipCategoryService",function(e,t,r,n,i,o,s,a,c,d){return{init:function(r){return e.all([a.getProducts().catch(function(e){return t.error(e,"Failed to get products.")}).then(function(e){r.products=e.filter(function(e){return"membership"===e.type}),r.productsRental=e.filter(function(e){return"rental"===e.type})}),function(e){var r={name:"Monthly Plans",visibleForVisitors:!0,useFor:"members"};return c.getPricelists(n.getCurrentCenterId()).catch(function(e){return t.error(e,"Failed to get price lists.")}).then(function(e){var i=e.find(function(e){return e.name===r.name});return i||c.save(n.getCurrentCenterId(),r).catch(function(e){return t.error(e,'Failed to create "'+r.name+'" price list.')}).then(function(){return r})}).then(function(e){return c.getPricelist(n.getCurrentCenterId(),e.id).catch(function(r){return t.error(r,"Failed to get price list "+e.name+".")})}).then(function(t){e.monthlyPriceList=t})}(r),d.query().catch(function(e){return t.error(e,"Failed to get membership categories.")}).then(function(e){r.membershipCategories=angular.copy(e)}),s.query().catch(function(e){return t.error(e,"Failed to query product categories.")}).then(function(e){r.productCategories=angular.copy(e)})])},preImport:function(n,a,c){var u=[];return a.data.forEach(function(e,c){var l=a.rowsMeta[c];if(!(l.ignore||l.headRow||l.empty)){var p=r.trim(e[a.mapping.indexOf("membershipCategory")]),f=i.options(p,n.membershipCategories);f||(f={name:p,order:o.generate(n.membershipCategories.length&&n.membershipCategories[n.membershipCategories.length-1].order),note:r.trim(e[a.mapping.indexOf("description")])},n.membershipCategories.push(f),u.push(d.save(f).catch(function(e){return t.error(e,"Failed to create membership category.")}))),p=r.trim(e[a.mapping.indexOf("productCategoryCode")]);var m=r.find(n.productCategories,{code:p});m||(m={code:p,name:r.trim(e[a.mapping.indexOf("productCategoryName")])},n.productCategories.push(m),u.push(s.save(m).catch(function(e){return t.error(e,"Failed to create product category.")})))}}),e.all(u)},importRow:function(e,t,n,o,s){var c=a.new();return c.id=n.id||void 0,c.name=r.trim(t[o.indexOf("name")]),c.membershipType=i.options(t[o.indexOf("membershipCategory")],e.membershipCategories),c.isCreditable=i.bool(t[o.indexOf("isCreditable")]),c.hasPasses=i.bool(t[o.indexOf("hasPasses")]),c.passProduct=i.options(t[o.indexOf("passProduct")],e.productsRental),c.hideInSelfRegistration=!i.bool(t[o.indexOf("showInSelfRegistration")]),c.productCategoryId=r.find(e.productCategories,{code:r.trim(t[o.indexOf("productCategoryCode")])}).id,c.productNumber=i.uint(t[o.indexOf("productNumber")]),c.description=r.trim(t[o.indexOf("description")]),a.save(c).then(function(t){!n.id&&t.id&&e.products.push(c)}).then(function(){var r={id:(e.monthlyPriceList.products.find(function(e){return e.productId===c.id})||{}).id,priceListId:e.monthlyPriceList.id,price:i.currency(t[o.indexOf("price")]),reservationCredit:c.isCreditable?i.currency(t[o.indexOf("reservationCredit")]):void 0,passQty:c.hasPasses?i.uint(t[o.indexOf("passQty")]):void 0};return a.savePriceItem(c.id,r).then(function(){e.monthlyPriceList.products.find(function(e){return e.productId===c.id})||e.monthlyPriceList.products.push(r)})}).then(function(){return c})},wireRow:function(e,t,r){if(r.id=(e.products.find(function(e){return e.name===t.name})||{}).id||null,r.id){var n=e.monthlyPriceList.products.find(function(e){return e.productId===r.id})||{};n.price!=i.currency(t.price)&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},DEya:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importSheetDetector",["deskworks.importSteps"]).service("importSheetDetector",["helper","importSteps",function(e,t){this.detect=function(r,n){if(angular.isArray(r)&&t[n].sheetPattern)for(var i=0;i<r.length;i++)if(e.trim(r[i].name).match(t[n].sheetPattern))return r[i];return(r||[])[0]}}])},Ec5X:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.handsontable.htBodyExtra",[]).directive("htBodyExtra",["$compile",function(e){return{restrict:"E",require:"^handsontable",compile:function(t,r){var n=t.html();return t.remove(),function(t,r,i,o){var s=r.parent()[0];o.bodyExtraElement||(o.bodyExtraElement=e(n.replace(/\$row/g,"ht.erow").replace(/\$col/g,"ht.ecol"))(t).addClass("ht-body-extra")),t.$on("ht:afterRender",function(e){e.stopPropagation();var t=angular.element(s.querySelector(".ht_master .wtSpreader"));t[0].querySelector(".ht-body-extra")||t.append(o.bodyExtraElement),o.repositionBodyExtra()}),o.repositionBodyExtra=function(){if(o.erow>=0&&o.ecol>=0){var e=s.querySelector('td[rc="'+o.erow+"x"+o.ecol+'"]');e&&(o.bodyExtraElement.css("top",e.offsetTop+"px"),o.bodyExtraElement.css("left",Math.floor(e.offsetLeft+e.offsetWidth/2)+"px"))}},t.$on("ht:afterSelection",function(e,t,r){e.stopPropagation(),o.erow=t,o.ecol=r,o.repositionBodyExtra()}),t.$on("ht:afterDeselect",function(e,t,r){e.stopPropagation(),o.erow=-1,o.ecol=-1})}}}}])},Jrqs:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importAutoMapColumns",[]).factory("importAutoMapColumns",["helper",function(e){return function(t,r,n){if(angular.isArray(r)&&angular.isArray(t)){if(n<0)return Array.apply(null,Array(t[0].length)).map(function(){return null});var i=r.slice();return t[n].map(function(t){for(var r=0;r<i.length;r++)if(e.trim(t).match(i[r].pattern))return i.splice(r,1)[0].id})}}}])},KvHs:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importWireData",["deskworks.helper","deskworks.importSteps"]).factory("importWireData",["helper",function(e){return function(e,t,r,n){t.data.forEach(function(r,i){var o=t.rowsMeta[i];if(!o.empty&&!o.headRow){var s=t.mapping.reduce(function(e,t,n){return e[t]=r[n],e},{});o.id=n(e,s,o,t.rowsMeta),o.id&&angular.isUndefined(o.ignore)&&(o.ignore=!0)}})}}])},R2MD:function(e,t){e.exports="<div> <p>Congratulations! You have completed the import. You can manage imported data through sidebar:</p> <p><a href=#/reservation-types ng-click=$ctrl.navSidebar($event)>Inventory <ff-icon sense=breadcrumb></ff-icon> Reservation Categories</a></p> <p><a href=#/reservation-units ng-click=$ctrl.navSidebar($event)>Inventory <ff-icon sense=breadcrumb></ff-icon> Reservation Units</a></p> <p><a href=#/products ng-click=$ctrl.navSidebar($event)>Inventory <ff-icon sense=breadcrumb></ff-icon> Products</a></p> <p><a href=#/user-search ng-click=$ctrl.navSidebar($event)>Members <ff-icon sense=breadcrumb></ff-icon> View/Edit Profile</a></p> </div> <ff-btn-group class=buttons-bottom> <ff-btn sense=back ff-click=$ctrl.back()>Back To Step {{$ctrl.step}}</ff-btn> <ff-btn sense=home ff-click=$ctrl.home()>Go To Dashboard</ff-btn> <ff-btn sense=remove ff-click=$ctrl.purge()>Purge & Start From Scratch</ff-btn> </ff-btn-group> "},RAZO:function(e,t,r){"use strict";r.r(t);r("t91x");var n=["$injector",function(e){var t,n=(t=r("rQ7g")).keys().map(t);e.loadNewModules(n.map(function(e){return e.default.name})),e.invoke(["$templateCache",function(e){var t=r("gnFY");t.keys().forEach(function(r){return e.put(r.replace(/^\.\//,""),t(r))})}])}];t.default=n},SXLm:function(e,t){e.exports='<div class="ff-grid gutter-h gutter-v"> <div style1="margin-bottom: .25rem" ng-if="$ctrl.steps[$ls.step].id !== \'complete\'"> <span class=em>Step {{$ls.step + 1}} of {{$ctrl.steps.length - 2}}</span> &nbsp; This step allows you to import <b ng-bind=$ctrl.steps[$ctrl.step].name></b>. Please select correct Excel sheet, check & fix columns mapping, fix invalid values, then import. </div> <div flex="{lg: \'0 0 400px\'}" class=ff-grid ng-include="\'step-components/import-sheet-selector.tpl.html\'"></div> <div flex="{lg: \'1 1 360px\'}" class=ff-grid ng-include="\'step-components/import-dashboard.tpl.html\'"></div> <ff-btn-group> <ff-btn sense=next ff-click=$ctrl.import()>Next</ff-btn> <ff-btn sense=back ff-click=$ctrl.back()>Back To Step {{$ctrl.step}}</ff-btn> <ff-btn sense=remove ff-click=$ctrl.purge()>Purge & Start From Scratch</ff-btn> </ff-btn-group> <ff-panel class=ht-panel ng-if=$ctrl.sheet ff-dim=$ctrl.spin> <import-handsontable step=$ctrl.step sheet=$ctrl.sheet fields=$ctrl.fields on-validate=$ctrl.validateData() un-mapped-fields=$ctrl.unMappedFields></import-handsontable> </ff-panel> </div> '},"V1x+":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.handsontable.htRowExtra",[]).directive("htRowExtra",["$compile",function(e){return{restrict:"E",require:"^handsontable",compile:function(t,r){var n=t.html();return t.remove(),function(t,r,i,o){var s=r.parent()[0];function a(e,t){var r=s.querySelector(".ht_clone_left .wtSpreader");o.rowExtraScopes&&(angular.element(r.querySelectorAll(".ht-row-extra")).remove(),angular.forEach(o.rowExtraScopes,function(e){e.$destroy()}),delete o.rowExtraScopes)}t.$on("ht:afterRender",function(r){var i=angular.element(s.querySelector(".ht_clone_left .wtSpreader"));o.rowExtraScopes||angular.isArray(o.settings.data)&&angular.isArray(o.settings.data[0])&&(o.rowExtraScopes=o.settings.data.map(function(r,o){var s=t.$new();return i.append(e(n.replace(/\$row/g,o))(s).addClass("ht-row-extra")),s})),angular.forEach(i[0].querySelectorAll(".ht-row-extra"),function(e){e.style.display="none"}),angular.forEach(s.querySelectorAll(".ht_clone_left th[htrow]"),function(e){var t=i[0].querySelectorAll(".ht-row-extra")[e.getAttribute("htrow")];t.style.left=e.offsetLeft+"px",t.style.top=e.offsetTop+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.display=""})}),t.$on("ht:afterCreateRow",a),t.$on("ht:afterRemoveRow",a),t.$on("ht:dataChange",a)}}}}])},VixM:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsOtherProducts",["deskworks.inventory.optsProductType"]).factory("importFieldsOtherProducts",["optsProductType",function(e){return[{id:"name",name:"Product Name",pattern:/Product\s+Name/i,required:!0,unique:!0},{id:"type",name:"Product Type",pattern:/Product\s+Type/i,required:!0,type:{options:e.filter(function(e){return"membership"!==e.id})}},{id:"allowReservationCredits",name:"Can use Reservation Credits",pattern:/Can\s+use\s+Reservation\s+Credit/i,type:"bool"},{id:"passSize",name:"Pass Size",pattern:/Pass\s+Size/i,type:"uint"},{id:"reservationCategory",name:"Reservation Category",pattern:/Reservation\s+Category/i,type:{options:"$ctrl.reservationCategories"}},{id:"productCategoryCode",name:"Product Category Code",pattern:/Product\s+Category\s+Code/i,required:!0},{id:"productCategoryName",name:"Product Category Name",pattern:/Product\s+Category\s+Name/i},{id:"productNumber",name:"Part Number Code",pattern:/Part\s+Number\s+Code/i,required:!0,type:"uint"},{id:"monthlyPrice",name:"Monthly Members Price List",pattern:/Monthly\s+Members\s+Price\s?list/i,type:"currency"},{id:"walkinPrice",name:"Walkin Price List",pattern:/Walkin\s+Price\s?list/i,type:"currency"},{id:"description",name:"Product Description",pattern:/^Product\s+Description/i}]}])},WfNc:function(e,t,r){"use strict";r.r(t);r("it7j");var n=r("2/1H");t.default=angular.module("deskworks.importHooksReservationUnits",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.reservationRules.service","deskworks.reservationCategory.service","deskworks.inventory.product.service","deskworks.reservationRules.optsWhoCanReserve",n.a.name]).factory("importHooksReservationUnits",["$q","dwAlerts","helper","state","importParsers","ReservationRules","reservationCategoryService","ReservationUnit","productService","optsWhoCanReserve",function(e,t,r,n,i,o,s,a,c,d){return{init:function(r){return e.all([s.query(n.getCurrentCenterId()).catch(function(e){return t.error(e,"Failed to load reservation categories.")}).then(function(e){r.reservationCategories=e}),a.query(n.getCurrentCenterId()).catch(function(e){return t.error(e,"Failed to load reservation units.")}).then(function(e){r.reservationUnits=e}),c.getMembershipProducts(n.getCurrentCenterId()).catch(function(e){return t.error(e,"Failed to load membership products.")}).then(function(e){r.productsMembership=e})])},importRow:function(e,t,s,c,u){var l={id:s.id||void 0,name:r.trim(t[c.indexOf("name")]),reservationTypeId:(i.options(t[c.indexOf("reservationCategory")],e.reservationCategories)||{}).id,fullTimeProductId:(i.options(t[c.indexOf("fullTimeProduct")],e.productsMembership)||{}).id};return a.save(n.getCurrentCenterId(),l).then(function(t){return!s.id&&t.id&&e.reservationUnits.push({id:t.id,name:l.name}),t}).then(function(e){return o.query({centerId:n.getCurrentCenterId(),reservationUnitId:l.id}).then(function(e){var r=e.find(function(e){return"whoCanReserve"===e.uid});return r.value=(i.options(t[c.indexOf("whoCanReserve")],d)||{}).id,o.save({centerId:n.getCurrentCenterId(),reservationUnitId:l.id},r)}).then(function(){return e})})},wireRow:function(e,t){return(e.reservationUnits.find(function(e){return e.name===t.name})||{}).id||null}}}])},Wid6:function(e,t,r){"use strict";r.r(t);var n=r("tcSx"),i=r.n(n);t.default=angular.module("deskworks.importStepInit",["ngFileUpload","deskworks.dwAlerts","deskworks.excel"]).component("importStepInit",{templateUrl:"step-components/step-init.tpl.html",controller:"ImportStepInitCtrl",bindings:{step:"=",sheets:"=",purge:"<"}}).controller("ImportStepInitCtrl",["dwAlerts","excel",function(e,t){var r=this;r.$onInit=function(){r.xlsTemplateUrl=i.a},r.upload=function(n,i){return i&&i.length>0?e.error("Please use .xls or .xlsx files."):window.FileReader?void(n&&n.length&&t.read(n[0]).then(function(e){r.sheets=e,r.step++})):e.error("FileReader is not supported by your web browser.")}}])},Y5xL:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importSteps",["deskworks.importFieldsReservationCategories","deskworks.importHooksReservationCategories","deskworks.importFieldsReservationUnits","deskworks.importHooksReservationUnits","deskworks.importFieldsOtherProducts","deskworks.importHooksOtherProducts","deskworks.importFieldsMembershipProducts","deskworks.importHooksMembershipProducts","deskworks.importFieldsMembers","deskworks.importHooksMembers"]).factory("importSteps",["importFieldsReservationCategories","importHooksReservationCategories","importFieldsReservationUnits","importHooksReservationUnits","importFieldsOtherProducts","importHooksOtherProducts","importFieldsMembershipProducts","importHooksMembershipProducts","importFieldsMembers","importHooksMembers",function(e,t,r,n,i,o,s,a,c,d){return[{id:"init",name:"Wizard"},{id:"reservationCategories",name:"Reservation Categories",sheetPattern:/Reservation\s+Categories/i,fields:e,hooks:t},{id:"otherProducts",name:"Other Products",sheetPattern:/Products.+Prices$/i,fields:i,hooks:o},{id:"membershipProducts",name:"Membership Products",sheetPattern:/Membership.+Products.+Prices/i,fields:s,hooks:a},{id:"reservationUnits",name:"Reservation Units",sheetPattern:/Reservation\s+Units/i,fields:r,hooks:n},{id:"members",name:"Members",sheetPattern:/Members.+Recurring.+Billing/i,fields:c,hooks:d},{id:"complete",name:"Complete"}]}])},Y6HC:function(e,t,r){"use strict";r.r(t);r("it7j");t.default=angular.module("deskworks.importHooksReservationCategories",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.reservationCategory.service"]).factory("importHooksReservationCategories",["dwAlerts","helper","state","reservationCategoryService",function(e,t,r,n){return{init:function(t){return n.query(r.getCurrentCenterId()).catch(function(t){return e.error(t,"Failed to load reservation categories.")}).then(function(e){t.reservationCategories=e})},importRow:function(e,i,o,s){var a={id:o.id||void 0,name:t.trim(i[s.indexOf("name")]),description:t.trim(i[s.indexOf("description")])};return n.save(r.getCurrentCenterId(),a).then(function(t){return!o.id&&t.id&&e.reservationCategories.push({id:t.id,name:a.name}),t})},wireRow:function(e,t){return(e.reservationCategories.find(function(e){return e.name===t.name})||{}).id||null}}}])},anLb:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsReservationUnits",["deskworks.reservationRules.optsWhoCanReserve"]).factory("importFieldsReservationUnits",["optsWhoCanReserve",function(e){return[{id:"name",name:"Reservation Unit",pattern:/^Reservation\s+Unit$/i,required:!0,unique:!0},{id:"reservationCategory",name:"Reservation Category",pattern:/^Reservation\s+Category$/i,required:!0,type:{options:"$ctrl.reservationCategories"}},{id:"whoCanReserve",name:"Who can reserve?",pattern:/^Who\s+can\s+reserve/i,required:!0,type:{options:e}},{id:"fullTimeProduct",name:"Full-time Product",pattern:/^Full-time\s+Product/i,type:{options:"$ctrl.productsMembership"}}]}])},atK1:function(e,t,r){"use strict";r.r(t);r("it7j");t.default=angular.module("deskworks.importValidateCell",["deskworks.helper"]).factory("importValidateCell",["helper",function(e){return function(t,r,n,i,o,s,a){var c=o.find(function(e){return e.id===s[n]});if(c){var d=e.trim(t[r][n]);if(angular.isObject(c.type)&&c.type.options&&(c.required||""!==d)){var u;if(c.type.ref){var l=t[r][s.indexOf(c.type.ref)],p=o.find(function(e){return e.id===c.type.ref});l=e.searchSoft(p.type.options,["id","name","import"],l),u=a.$eval(c.type.options.replace(/\$id/g,(l||{}).id))}else u=angular.isArray(c.type.options)?c.type.options:a.$eval(c.type.options);if(angular.isArray(u)&&!e.searchSoft(u,["name","id","import"],d))return u}if(c.required){if(""===d)return c.name+" is required."}else if(""===d)return;if("uint"===c.type&&!d.match(/^\d*,?\d+$/i))return c.name+" should be a positive integer number, e.g. 100 or 0";if("int"===c.type&&!d.match(/^-?\d*,?\d+$/i))return c.name+" should be an integer number, e.g. -10 or 50";if("ufloat"===c.type&&!d.match(/^[\d,]*\.?\d+$/i))return c.name+" should be a positive number, e.g. 10 or 10.50";if("float"===c.type&&!d.match(/^-?[\d,]*\.?\d+$/i))return c.name+" should be a number, e.g. 100 or -20 or 5.5";if("bool"===c.type&&!d.match(/^Yes|No|Y|N|true|false$/i))return c.name+" should be Yes/No, Y/N, true/false";if("currency"===c.type&&!d.match(/^\$?[\d,]*\.?\d+$/i))return c.name+" should be currency, e.g. $10 or $10.50 or 12.00";if("email"===c.type&&!d.match(/^[\w\.%\+\-]+@(?:[A-Z0-9\-]+\.)+(?:[A-Z]+)$/i))return c.name+" should be valid";if("date"===c.type){var f;if(d.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(d=d.replace(/\s|-|\.|\//g," "),f="DD MMM YYYY"):d.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(d=d.replace(/\s|-|\./g,"/"),f="MM/DD/YYYY"):d.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)&&(d=d.replace(/\s|-|\./g,"-"),f="YYYY-MM-DD"),f&&moment(d,f).isValid())return;return c.name+" format is 06/22/2015 or 22&nbsp;Jun&nbsp;2015"}if(c.minLength&&d.length<c.minLength)return c.name+" min length is "+c.minLength;if(c.unique)if(t.filter(function(e,t){return!i[t].empty&&!i[t].ignore&&!i[t].headRow}).reduce(function(t,r){return e.trim(r[n]||"").toLowerCase()===(d||"").toLowerCase()?++t:t},0)>1)return c.name+" contains duplicate values. Must be unique.";return angular.isObject(c.type)&&c.type.pattern&&!d.match(c.type.pattern)?c.type.msg:void 0}}}])},biy8:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.purge.service",["ngResource","deskworks.config"]).factory("purgeService",["$resource","deskworksConfig",function(e,t){var r=e(t.getApiAbsUrl("/purge/:entity")),n=e(t.getApiAbsUrl("/purge/centers/:centerId/:entity"));return{purgeProducts:function(e){return r.delete({entity:"products",productTypes:e}).$promise},purgePriceLists:function(e){return n.delete({centerId:e,entity:"price-lists"}).$promise},purgeMembershipTypes:function(){return r.delete({entity:"membership-types"}).$promise},purgeReservationCategories:function(){return r.delete({entity:"reservation-types"}).$promise},purgeReservationUnits:function(e){return n.delete({centerId:e,entity:"reservation-units"}).$promise},purgeMembers:function(){return r.delete({entity:"members"}).$promise}}}])},f4JS:function(e,t,r){"use strict";r.r(t);r("it7j");t.default=angular.module("deskworks.importHooksOtherProducts",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.reservationCategory.service","deskworks.ProductCategory"]).factory("importHooksOtherProducts",["$q","dwAlerts","helper","state","importParsers","ProductCategory","productService","priceListService","reservationCategoryService",function(e,t,r,n,i,o,s,a,c){return{init:function(r){return e.all([s.getProducts().catch(function(e){return t.error(e,"Failed to get products.")}).then(function(e){r.products=e.filter(function(e){return"membership"!==e.type})}),function(r){var i=[{name:"Monthly Plans",visibleForVisitors:!0,useFor:"members"},{name:"Walkin",visibleForVisitors:!0,useFor:"nonMembers"}];return a.getPricelists(n.getCurrentCenterId()).catch(function(e){return t.error(e,"Failed to get price lists.")}).then(function(r){return e.all(i.map(function(e){var i=r.find(function(t){return t.name===e.name});return i||a.save(n.getCurrentCenterId(),e).catch(function(r){return t.error(r,'Failed to create "'+e.name+'" price list.')}).then(function(){return e})}))}).then(function(r){return e.all(r.map(function(e,r){return a.getPricelist(n.getCurrentCenterId(),e.id).catch(function(r){return t.error(r,"Failed to get price list "+e.name+".")})}))}).then(function(e){r.monthlyPriceList=e[0],r.walkinPriceList=e[1]})}(r),c.query(n.getCurrentCenterId()).catch(function(e){return t.error(e,"Failed to load reservation categories.")}).then(function(e){r.reservationCategories=e}),o.query().catch(function(e){return t.error(e,"Failed to query product categories.")}).then(function(e){r.productCategories=angular.copy(e)})])},preImport:function(n,i,s){var a=[];return i.data.forEach(function(e,s){var c=i.rowsMeta[s];if(!(c.ignore||c.headRow||c.empty)){var d=r.trim(e[i.mapping.indexOf("productCategoryCode")]),u=r.find(n.productCategories,{code:d});u||(u={code:d,name:r.trim(e[i.mapping.indexOf("productCategoryName")])},n.productCategories.push(u),a.push(o.save(u).catch(function(e){return t.error(e,"Failed to create product category.")})))}}),e.all(a)},importRow:function(t,n,o,a,c){var d=s.new();return d.id=o.id||void 0,d.name=r.trim(n[a.indexOf("name")]),d.type=i.options(n[a.indexOf("type")],c.find(function(e){return"type"===e.id}).type.options),d.allowReservationCredits=i.bool(n[a.indexOf("allowReservationCredits")]),d.passSize=i.uint(n[a.indexOf("passSize")]),d.productCategoryId=r.find(t.productCategories,{code:r.trim(n[a.indexOf("productCategoryCode")])}).id,d.productNumber=i.uint(n[a.indexOf("productNumber")]),d.description=r.trim(n[a.indexOf("description")]),d.reservationTypeId=(i.options(n[a.indexOf("reservationCategory")],t.reservationCategories)||{}).id,s.save(d).then(function(e){return!o.id&&e.id&&t.products.push(d),e}).then(function(){var r={id:(t.monthlyPriceList.products.find(function(e){return e.productId===d.id})||{}).id,priceList:t.monthlyPriceList,priceListId:t.monthlyPriceList.id,price:i.currency(n[a.indexOf("monthlyPrice")])},o={id:(t.walkinPriceList.products.find(function(e){return e.productId===d.id})||{}).id,priceList:t.walkinPriceList,priceListId:t.walkinPriceList.id,price:i.currency(n[a.indexOf("walkinPrice")])};return e.all([r,o].filter(function(e){return e.price||0==e.price}).map(function(e){var t=e.priceList;return delete e.priceList,s.savePriceItem(d.id,e).then(function(){t.products.find(function(e){return e.productId===d.id})||t.products.push(e)})})).then(function(){return d})})},wireRow:function(e,t,r){if(r.id=(e.products.find(function(e){return e.name===t.name})||{}).id||null,r.id){var n=e.monthlyPriceList.products.find(function(e){return e.productId===r.id})||{};n.price!=i.currency(t.monthlyPrice)&&angular.isUndefined(r.ignore)&&(r.ignore=!1);var o=e.monthlyPriceList.products.find(function(e){return e.productId===r.id})||{};o.price!=i.currency(t.walkinPrice)&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},gSLu:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsReservationCategories",[]).factory("importFieldsReservationCategories",function(){return[{id:"name",name:"Reservation Category",pattern:/^Reservation\s+Category/i,required:!0,unique:!0},{id:"description",name:"Description",pattern:/^Description/i}]})},ghTx:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importCollectStats",[]).factory("importCollectStats",function(){return function(e){var t={create:0,update:0,existing:0,ignore:0,invalid:0,error:0};return angular.forEach(e,function(e){!e.ignore||e.headRow||e.id||t.ignore++,e.id||e.ignore||e.headRow||e.empty||e.invalid||t.create++,!e.id||e.ignore||e.invalid||t.update++,e.id&&e.ignore&&t.existing++,e.invalid&&t.invalid++,e.error&&e.ignore&&t.error++}),t}})},gnFY:function(e,t,r){var n={"./handsontable/import-handsontable.tpl.html":"9AYr","./step-components/import-dashboard.tpl.html":"iAI1","./step-components/import-sheet-selector.tpl.html":"r6Yw","./step-components/step-complete.tpl.html":"R2MD","./step-components/step-import.tpl.html":"SXLm","./step-components/step-init.tpl.html":"ojsW","./wizard/import.tpl.html":"/Qjn"};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id="gnFY"},iAI1:function(e,t){e.exports='<ff-panel ng-if="$ctrl.sheet && $ctrl.sheet.mappedToStep === $ctrl.step"> <div class="ff-grid gutter-v-half gutter-h-half import-dashboard"> <div flex="0 0 320px" class=import-stats ng-if=!$ctrl.unMappedFields.length> <div class=text-brand> <span class=counter>{{$ctrl.stats.create}}</span> <ff-icon sense=plus></ff-icon> <span class=text>Create</span> </div> <div class=text-brand> <span class=counter>{{$ctrl.stats.update}}</span> <ff-icon sense=refresh></ff-icon> <span class=text>Update</span> </div> <div class=text-text> <span class=counter>{{$ctrl.stats.existing}}</span> <ff-icon sense=check></ff-icon> <span class=text>Existing</span> </div> <div class=text-text> <span class=counter>{{$ctrl.stats.ignore}}</span> <ff-icon sense=ignore></ff-icon> <span class=text>Ignore</span> </div> <div class=text-danger ng-if=!$ctrl.stats.invalid> <span class=counter>{{$ctrl.stats.error}}</span> <ff-icon sense=error></ff-icon> <span class=text>Error</span> </div> <div class=text-danger ng-if=$ctrl.stats.invalid> <span class=counter>{{$ctrl.stats.invalid}}</span> <ff-icon sense=warning></ff-icon> <span class=text>Invalid</span> </div> </div> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && $ctrl.unMappedFields.length" class=text-danger> Some columns are unmapped. Please map them manually. Check <span class=itooltip>UNKNOWN</span> markers and select correct field mapping from the drop-down. </span> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && $ctrl.invalidCount" class=text-danger> Invalid values detected. Please fix them manually to proceed to the next step. Look for cells with <ff-icon sense=warning></ff-icon> icon and fix their values. You can also ignore some rows by clicking <ff-icon sense=warning></ff-icon> icons near the row indexes at left. </span> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && !$ctrl.invalidCount"> Click Next to proceed to the next step. </span> </div> </ff-panel> '},ojsW:function(e,t){e.exports="<div class=gutter-v> <ff-panel> <div class=em><ff-icon sense=info></ff-icon>&nbsp;&nbsp;This wizard will guide you through the following import steps:</div> <ff-label> <span>Reservation Categories</span><ff-icon sense=breadcrumb></ff-icon> <span>Other Products</span><ff-icon sense=breadcrumb></ff-icon> <span>Membership Products</span><ff-icon sense=breadcrumb></ff-icon> <span>Reservation Units</span><ff-icon sense=breadcrumb></ff-icon> <span>Members</span> </ff-label> <div class=em><ff-icon sense=info></ff-icon>&nbsp;&nbsp;The workflow for each step is:</div> <ff-label> <span>Select sheet in Excel file</span><ff-icon sense=breadcrumb></ff-icon> <span>Map fields</span><ff-icon sense=breadcrumb></ff-icon> <span>Fix invalid data</span><ff-icon sense=breadcrumb></ff-icon> <span>Import</span><ff-icon sense=breadcrumb></ff-icon> <span>Move to next step</span> </ff-label> <p><ff-icon sense=info></ff-icon>&nbsp;&nbsp;Please download import template, open it in Excel (Numbers on Mac), replace sample data with your real data, then start import by selecting the file you've made.</p> <p><ff-icon sense=warning></ff-icon>&nbsp;&nbsp;Don't add/remove columns in the template, but you may add/remove rows.</p> </ff-panel> <ff-btn-group> <ff-btn sense=upload ngf-select=\"$ctrl.upload($files, $invalidFiles)\" ngf-pattern=\"'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel'\" accept=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel> Select Excel File to Import </ff-btn> <a ng-href={{$ctrl.xlsTemplateUrl}} target=_blank rel=noopener download> <ff-btn sense=download>Download Import Template</ff-btn> </a> </ff-btn-group> </div> "},pfW1:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importStepComplete",["deskworks.state"]).component("importStepComplete",{templateUrl:"step-components/step-complete.tpl.html",controller:"ImportStepCompleteCtrl",bindings:{step:"=",purge:"<"}}).controller("ImportStepCompleteCtrl",["state",function(e){var t=this;t.navSidebar=function(t){return t.preventDefault(),t.stopPropagation(),e.setPath(t.target.hash.replace("#",""))},t.home=function(){return e.setPath("/dashboard")},t.back=function(){t.step--}}])},qJvt:function(e,t,r){"use strict";r.r(t);var n=r("Isj4"),i=r.n(n);t.default=angular.module("deskworks.excel",[]).service("excel",["$q","helper",function(e,t){this.read=function(r){return e(function(e){var n=new FileReader;n.onload=function(r){var n=[],o=i.a.read(r.target.result,{type:"binary"}),s=document.createElement("textarea");angular.forEach(o.SheetNames,function(e){for(var r=o.Sheets[e],a=function(e){for(var t=i.a.utils.decode_range(e["!ref"]||"A1:Z1000"),r=0,n=0,o=t.e.r;o>=t.s.r;o--){for(var s=-1,a=t.e.c;a>=t.s.c;a--){var c=e[i.a.utils.encode_cell({r:o,c:a})];if(c&&angular.isDefined(c.v)&&null!==c.v&&""!==c.v&&s<0){s=a;break}}r=r>s?r:s,s>=0&&!n&&(n=o)}return{s:{r:t.s.r,c:t.s.c},e:{r:n,c:r}}}(r),c=[],d=a.s.r;d<=a.e.r;d++){for(var u=[],l=a.s.c;l<=a.e.c;l++){var p=r[i.a.utils.encode_cell({r:d,c:l})];u.push(t.trim((p||{}).w||""))}s.innerHTML=e,c.push(u)}n.push({name:s.value,data:c})}),e(n)},n.readAsBinaryString(r)})}}])},r6Yw:function(e,t){e.exports='<ff-panel ff-dim="$ctrl.spin || !$ctrl.sheet"> <div class="ff-grid gutter-v-half"> <label class="ff-row ff-no-frame"> <ff-label flex="0 0 120px" ff-required=true>Select Sheet</ff-label> <ff-select ff-model=$ctrl.sheet ff-options="sheet.name for sheet in $ctrl.sheets" ff-required=true ff-valdate-alert=Sheet></ff-select> </label> <div ng-if="$ctrl.sheet && !$ctrl.sheet.mappedToStep" class=text-danger> <ff-icon sense=info></ff-icon> This sheet seems to misfit to current import step. Please select another sheet or map all columns manually. </div> <div ng-if="$ctrl.sheet && $ctrl.sheet.mappedToStep && $ctrl.sheet.mappedToStep !== $ctrl.step" class=text-danger> <ff-icon sense=info></ff-icon> This sheet is already mapped to "{{$ctrl.steps[$ctrl.sheet.mappedToStep].name}}" step, please select another sheet or <ff-btn sense=remove size=sm ff-click=$ctrl.remapFields()>Remap Fields</ff-btn> </div> </div> </ff-panel> '},rQ7g:function(e,t,r){var n={"./handsontable/handsontable.directive.js":"6Efl","./handsontable/ht-body-extra.directive.js":"Ec5X","./handsontable/ht-header-extra.directive.js":"BaSU","./handsontable/ht-row-extra.directive.js":"V1x+","./handsontable/import-handsontable.directive.js":"4D44","./services/auto-map-columns.service.js":"Jrqs","./services/collect-stats.service.js":"ghTx","./services/detect-head-row-idx.service.js":"6yKF","./services/detect-subgroups.service.js":"+vx3","./services/excel.service.js":"qJvt","./services/init-meta-data.service.js":"rwVl","./services/parsers.service.js":"z+6Y","./services/purge.service.js":"biy8","./services/sheet-detector.service.js":"DEya","./services/srip-data-comments.service.js":"zTxK","./services/validate-cell.service.js":"atK1","./services/validate-data.service.js":"sCVh","./services/wire-data.service.js":"KvHs","./step-components/step-complete.component.js":"pfW1","./step-components/step-import.component.js":"2dNM","./step-components/step-init.component.js":"Wid6","./step-fields/fields-members.service.js":"BGsA","./step-fields/fields-membership-products.service.js":"7A+6","./step-fields/fields-other-products.service.js":"VixM","./step-fields/fields-reservation-categories.service.js":"gSLu","./step-fields/fields-reservation-units.service.js":"anLb","./step-hooks/hooks-members.service.js":"z32g","./step-hooks/hooks-membership-products.service.js":"Bn1Q","./step-hooks/hooks-other-products.service.js":"f4JS","./step-hooks/hooks-reservation-categories.service.js":"Y6HC","./step-hooks/hooks-reservation-units.service.js":"WfNc","./wizard/import.controller.js":"52bj","./wizard/steps.service.js":"Y5xL"};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id="rQ7g"},rwVl:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importInitMetaData",["deskworks.helper"]).factory("importInitMetaData",["helper",function(e){return function(t){t.rowsMeta.forEach(function(r,n){r.invalid=!1,r.empty=!0,r.id=null,r.subgroup=null,r.cellsMeta.forEach(function(i,o){i.invalid=!1,r.empty=r.empty&&!e.trim(t.data[n][o])})})}}])},sCVh:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importValidateData",["deskworks.helper","deskworks.importValidateCell"]).factory("importValidateData",["helper","importValidateCell",function(e,t){return function(e,r,n){var i=0;return e.data.forEach(function(o,s){var a=e.rowsMeta[s],c=r;a.subgroup&&(c=r.filter(function(e){return e.subgroup===a.subgroup})),a.invalid=c.reduce(function(o,c){var d=e.mapping.indexOf(c.id),u=a.cellsMeta[d];return a.empty||a.headRow||a.ignore?(u.invalid=!1,o):(u.invalid=t(e.data,s,d,e.rowsMeta,r,e.mapping,n),u.invalid&&i++,o||u.invalid)},!1)}),i}}])},tcSx:function(e,t,r){e.exports=r.p+"./assets/new-center-startup-workbook.xlsx?_rev=1bea69ce7bd03206bdbd806ddcc555ba"},"z+6Y":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importParsers",["deskworks.helper"]).service("importParsers",["helper",function(e){this.options=function(t,r){return e.searchSoft(r,["name","id","import"],t)},this.bool=function(t){return!!e.trim(t).match(/^Yes|Y|true$/i)},this.int=function(t){return(t=e.trim(t).replace(/,/g,"")).length?parseInt(t):void 0},this.uint=this.int,this.float=function(t){return(t=e.trim(t).replace(/,/g,"")).length?parseFloat(t):void 0},this.currency=function(t){return(t=e.trim(t).replace(/[,\$]/g,"")).length?parseFloat(t):void 0},this.ufloat=this.float,this.date=function(t){var r;if((t=e.trim(t)).match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(t=t.replace(/\s|-|\.|\//g," "),r="DD MMM YYYY"):t.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(t=t.replace(/\s|-|\./g,"/"),r="MM/DD/YYYY"):t.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)&&(t=t.replace(/\s|-|\./g,"-"),r="YYYY-MM-DD"),r){var n=moment(t,r);if(n.isValid())return n}}}])},z32g:function(e,t,r){"use strict";r.r(t);r("it7j");var n=r("2/1H");t.default=angular.module("deskworks.importHooksMembers",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.inventory.membershipCategory.service","deskworks.system.service","deskworks.userProfile.service","deskworks.recurringCharge.service","deskworks.userProfile.optsMembershipStatus","deskworks.userProfile.optsState","deskworks.billing.optsDiscountType",n.a.name]).factory("importHooksMembers",["$q","$filter","dwAlerts","helper","state","importParsers","productService","priceListService","membershipCategoryService","systemService","userProfileService","recurringChargeService","ReservationUnit","optsMembershipStatus","optsState","optsDiscountType",function(e,t,r,n,i,o,s,a,c,d,u,l,p,f,m,h){return{init:function(t){return e.all([s.getProducts().catch(function(e){return r.error(e,"Failed to query products.")}).then(function(e){t.products=e.filter(function(e){return"membership"===e.type||"services"===e.type})}),d.getLeadSources().catch(function(e){return r.error(e,"Failed to query lead sources.")}).then(function(e){t.leadSources=e}),u.query(0,{activeMembers:!0,inactiveMembers:!0,activeCoMembers:!0,inactiveCoMembers:!0,nonMembers:!0}).catch(function(e){return r.error(e,"Failed to query all users.")}).then(function(e){t.users=e}),u.query(i.getCurrentCenterId(),{activeMembers:!0}).catch(function(e){return r.error(e,"Failed to query members.")}).then(function(e){t.members=e}),a.getPricelists(i.getCurrentCenterId()).catch(function(e){return r.error(e,"Failed to query price lists.")}).then(function(e){return t.monthlyPriceList=e.find(function(e){return"Monthly Plans"===e.name}),a.getPricelist(i.getCurrentCenterId(),t.monthlyPriceList.id).then(function(e){t.monthlyPriceList=e})}),p.query(i.getCurrentCenterId()).catch(function(e){return r.error(e,"Failed to query reservation units")}).then(function(e){t.reservationUnits=e})])},importRow:function(r,s,a,c,p){var g=p.find(function(e){return"billingMethod"===e.id}).type.options,v=p.find(function(e){return"addressCountry"===e.id}).type.options,w=c.indexOf("recurringProduct"),y={id:a.id||void 0,firstName:n.trim(s[c.indexOf("firstName")]),lastName:n.trim(s[c.indexOf("lastName")]),company:n.trim(s[c.indexOf("company")]),login:n.trim(s[c.indexOf("login")]),password:n.trim(s[c.indexOf("password")]),passwordConfirmation:n.trim(s[c.indexOf("password")]),email:n.trim(s[c.indexOf("email")]),comments:n.trim(s[c.indexOf("comments")]),leadSource:o.options(s[c.indexOf("leadSource")],r.leadSources),membershipStatus:f.find(function(e){return"nonMember"===e.id}),membershipBillingMethod:o.options(s[c.indexOf("billingMethod")],g)},b=[],k=r.sheet.data.indexOf(s),C=k;for(;C<r.sheet.data.length&&(r.sheet.rowsMeta[C].subgroup||C===k||r.sheet.rowsMeta[C].headRow||r.sheet.rowsMeta[C].empty);){var $=r.sheet.rowsMeta[C],x=r.sheet.data[C];$.ignore||$.headRow||$.empty||!n.trim(x[w])||function(){var e=l.new();e.priceListProduct={};var t=o.options(x[w],r.products)||{};e.priceListProduct.id=r.monthlyPriceList.products.find(function(e){return e.productId===t.id}).id,e.priceListProduct.productId=t.id,e.priceListProduct.priceListId=r.monthlyPriceList.id,e.name=t.name,e.nextBillDate=o.date(x[c.indexOf("recurringNextBillDate")])||moment(),e.quantity=o.uint(x[c.indexOf("recurringQuantity")])||1,e.discountValue=o.currency(x[c.indexOf("recurringDiscount")]),e.discountValue&&(e.discountType=h[1],e.discountTrialOccurrences={id:o.uint(x[c.indexOf("recurringMonthsOfDiscount")])||1}),e.attachedReservationUnitId=(o.options(x[c.indexOf("recurringAttachedReservationUnit")],r.reservationUnits)||{}).id,b.push(e)}(),C++}b.length&&(y.membershipProduct=o.options(b[0].name,r.products),y.membershipStatus=f.find(function(e){return"active"===e.id}),y.membershipType={id:y.membershipProduct.membershipTypeId},y.membershipPriceList=r.monthlyPriceList);var M=u.address.new();M.street=n.trim(s[c.indexOf("addressStreet")]),M.city=n.trim(s[c.indexOf("addressCity")]),M.country=o.options(s[c.indexOf("addressCountry")],v),M.state=m[M.country.id]?o.options(s[c.indexOf("addressState")],m[M.country.id]):n.trim(s[c.indexOf("addressState")]),M.zip=n.trim(s[c.indexOf("addressZip")]);var P=u.phone.new();P.number=n.trim(s[c.indexOf("phoneNumber")]);var S=u.printerCode.new();S.code=n.trim(s[c.indexOf("printerCode")]);var R=u.mailbox.new();R.number=n.trim(s[c.indexOf("mailboxNumber")]);var I={number:n.trim(s[c.indexOf("accessCode")]),effectiveDate:t("date")(moment(),"yyyy-MM-dd")};return u.save(i.getCurrentCenterId(),y).then(function(){if(a.id)return y.membershipProduct?l.query(i.getCurrentCenterId(),y.id).then(function(t){return e.all(b.map(function(e){return e.id=(t.find(function(t){return t.productName===e.name})||{}).id||e.id,l.save(i.getCurrentCenterId(),y.id,e)})).then(function(){return y})}):y;var t=[];return t.push(u.address.save(i.getCurrentCenterId(),y.id,M)),t.push(u.phone.save(i.getCurrentCenterId(),y.id,P)),""!==S.code&&t.push(u.printerCode.save(i.getCurrentCenterId(),y.id,S)),""!==R.number&&t.push(u.mailbox.save(i.getCurrentCenterId(),y.id,R)),""!==I.number&&(I.userId=y.id,t.push(d.createAccessCard(i.getCurrentCenterId(),I))),b.forEach(function(e){t.push(l.save(i.getCurrentCenterId(),y.id,e))}),e.all(t).then(function(){return y})})},wireRow:function(e,t,r,n){if("recurring"===r.subgroup){for(var i=n.indexOf(r)-1;i>=0&&(n[i].empty||n[i].headRow||n[i].subgroup);)i--;return r.ignore=r.ignore||n[i].ignore,r.id=n[i].id,r.id}if(r.id=(e.users.find(function(e){return e.fullName===t.firstName+" "+t.lastName})||{}).id||null,r.id){var o=!!e.members.find(function(e){return e.fullName===t.firstName+" "+t.lastName});!o&&t.recurringProduct&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},zTxK:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importStripDataComments",[]).factory("importStripDataComments",function(){return function(e){angular.isArray(e)&&e.slice(0,5).forEach(function(e){e.forEach(function(t,r){e[r]=t.replace(/\(?PLEASE CHANGE SAMPLE DATA AS NEEDED\)?/i,"")})})}})}}]);