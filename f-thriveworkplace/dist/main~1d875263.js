(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"+/c9":function(e,t,r){},"+uPA":function(e,t,r){"use strict";r.r(t);var n=r("mxFF"),a=r.n(n);angular.module("flexForms.validation.ngLt",[]).directive("ngLt",(function(){return{restrict:"A",require:"?ngModel",link:function(e,t,r,n){n.$validators.lt=function(t,n){var l=a()(n),i=e.$eval(r.ngLt);return i=angular.isDefined(i)?a()(i):a()(r.ngLt),isNaN(l)||isNaN(i)||l<i},e.$watch(r.ngLt,(function(){n.$validate()}))}}}))},"/PTN":function(e,t){angular.module("flexForms.ffBtnSectionNew",[]).directive("ffBtnSectionNew",["$translate",function(e){"use strict";return{restrict:"A",require:"^ffSection",priority:1e4,compile:function(t,r){return r.$set("ffClick","ffSection.newBlock()"),r.$set("sense","new"),r.$set("size",r.size||"sm"),r.$set("ffBtnSectionNew",null),t.html(t.html()||e.instant("GLOBAL.BTN_NEW")),this.link},link:function(e,t,r,n){}}}])},"/WbE":function(e,t){angular.module("flexForms.ffBtnBlockEdit",[]).directive("ffBtnBlockEdit",["$compile","$translate",function(e,t){"use strict";return{restrict:"A",require:"^ffBlock",priority:30,terminal:!0,compile:function(r,n){var a=this;return n.$set("ffClick","ffBlock.edit()"),n.$set("sense","edit"),n.$set("size","sm"),n.$set("ffBtnBlockEdit",null),n.$set("ngHide","ffBlock.editMode"),r.html(t.instant("GLOBAL.BTN_EDIT")),function(t,r,n){e(r,null,a.priority)(t)}}}}])},"/X/Z":function(e,t,r){"use strict";r.r(t);r("iPZ8"),r("kypl");var n=r("nbuU"),a=r.n(n),l=r("WSeP"),i=r.n(l),o=r("ipr/"),f=r.n(o),c=r("hsT8"),s=r.n(c),u=r("2/1H");t.default=angular.module("deskworks.billing.recurringCharge.edit",["deskworks.recurringCharge.service","deskworks.userProfile.service","deskworks.recurringCharge.service","deskworks.routeHelper","deskworks.recurringChargeAudit",u.a.name]).config(["$routeProvider",function(e){e.when("/recurring-charges/:recurringId/edit",{templateUrl:"billing/recurring-billing/recurring-edit.tpl.html",controller:"RecurringChargeEditCtrl as $ctrl",label:"Edit",routeBranch:"recurring-charges",translations:["recurring-billing"],resolve:{charge:["dwAlerts","$route","recurringChargeService","state","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then((function(){return a.selectUser()})).then((function(){return l()})).then((function(){return r.get(n.getCurrentCenterId(),n.getCurrentUserId(),t.current.params.recurringId).catch((function(t){return e.error(t,"Failed to get recurring charge.")}))}))}],charges:["dwAlerts","$route","recurringChargeService","state","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then((function(){return a.selectUser()})).then((function(){return l()})).then((function(){return r.query(n.getCurrentCenterId(),n.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to get recurring charge.")}))}))}],settings:["dwAlerts","setupService","state","routeHelper",function(e,t,r,n){return n.auth().then((function(){return t.getSetupSettings(r.getCurrentCenterId()).catch((function(t){return e.error(t,"Failed to get setup settings.")}))}))}],user:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then((function(){return n.selectUser()})).then((function(){return a()})).then((function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to get user profile.")}))}))}],resUnits:["dwAlerts","state","ReservationUnit",function(e,t,r){return r.query(t.getCurrentCenterId()).catch((function(t){return e.error(t,"Failed to query reservation units")}))}]}})}]).controller("RecurringChargeEditCtrl",["$scope","$route","$translate","dwAlerts","recurringChargeService","userProfileService","ReservationUnit","charge","charges","settings","user","state","helper","optsBillingFrequency","optsRecurringChargeStatus","optsNoticePeriod","optsDiscountType","optsMonthsOfDiscount","optsRecurringChargeTerminate","resUnits","optsRenewalTerm","optsRenewalNoticePeriod",function(e,t,r,n,l,o,c,u,d,p,g,m,h,b,C,v,I,y,E,$,R,T){var A,k=this;e.backPath="/recurring-charges",e.$watch("state.getCurrentCenterId()",(function(t,r){t!==r&&m.setPath(e.backPath)})),m.setPageTitle(r.instant("RECURRING_BILLING.PAGE_TITLE",{userName:g.fullName})),k.charge=u,k.initialStatus=k.charge.status,k.charge.startDate=k.charge.startDate||k.charge.entryDate,k.billingFrequencyProducts={},k.billingFrequencies=b,k.noticePeriods=v,k.discountTypes=I,k.discountTrialOccurrences=y,k.optsTerminate=E,k.optsRenewalTerm=R,k.optsRenewalNoticePeriod=T,k.chargeStatuses=s()(C).call(C,(function(e){return"deleted"!==e.id||!m.isLoggedRole("coordinator")})),"new"===t.current.params.recurringId&&(k.chargeStatuses=f()(C).call(C,0,1)),i()(A=u.options.priceListProducts).call(A,(function(e){var t=a()(h).call(h,k.billingFrequencies,e.billingFrequency);t&&(k.billingFrequencyProducts[t.id]=k.billingFrequencyProducts[t.id]||[],k.billingFrequencyProducts[t.id].push(e))})),k.reservationUnits=s()($).call($,(function(e){return!e.attachedUserId||e.id==k.charge.attachedReservationUnitId})),k.activeChargesCount=s()(d).call(d,(function(e){return"active"===e.status.id})).length,k.billingFrequencyChange=function(){k.charge.billingFrequency&&k.billingFrequencyProducts[k.charge.billingFrequency.id]&&(k.charge.priceListProduct=a()(h).call(h,k.billingFrequencyProducts[k.charge.billingFrequency.id],k.charge.priceListProductId)),k.charge.terminate="asNeeded"===k.charge.billingFrequency.id?E[0]:"",k.charge.billingFrequency.months&&moment.isMoment(k.charge.lastBillDate)&&(k.charge.nextBillDate=k.charge.lastBillDate.clone().add(k.charge.billingFrequency.months,"M"),p.prorateAtStart&&"monthly"===k.charge.billingFrequency.id&&k.charge.nextBillDate.date(1))},k.charge.id||k.billingFrequencyChange(),k.onChangeStatus=function(){"active"===k.initialStatus.id&&"active"===k.charge.status.id&&("boolean"==typeof k.charge.makeMemberInactive&&delete k.charge.makeMemberInactive,"boolean"==typeof k.charge.makeCoMembersInactive&&delete k.charge.makeCoMembersInactive)},k.calcTerminationDate=function(){"asNeeded"!==k.charge.billingFrequency.id&&k.charge.noticeDate&&k.charge.noticePeriod&&(k.charge.terminate=k.charge.noticeDate.clone().add(k.charge.noticePeriod.id,"d"))},k.isNextBillDateDisabled=function(){return null===k.charge.nextBillDate&&moment.isMoment(k.charge.terminate)||moment.isMoment(k.charge.terminate)&&moment.isMoment(k.charge.nextBillDate)&&k.charge.terminate.isSameOrBefore(k.charge.nextBillDate,"date")},k.backToList=function(){return m.setPath("/recurring-charges")},k.saveCharge=function(e){if(!h.pointFirstInvalid("#recurringCharge")){var r,a={description:k.charge.description,priceListProductId:angular.isDefined(k.charge.priceListProduct)?k.charge.priceListProduct.id:null,startDate:k.charge.startDate,nextBillDate:k.isNextBillDateDisabled()?null:k.charge.nextBillDate,lastBillDate:k.charge.lastBillDate,noticeDate:k.charge.noticeDate,terminate:"asNeeded"===k.charge.billingFrequency.id?k.charge.terminate.id:k.charge.terminate,quantity:k.charge.quantity,noticePeriod:k.charge.noticePeriod&&k.charge.noticePeriod.id,status:angular.isDefined(k.charge.status)?k.charge.status.id:void 0,notes:k.charge.notes,attachedReservationUnitId:k.charge.attachedReservationUnitId?+k.charge.attachedReservationUnitId:null};return k.charge.discountType.id?(a.discountTypeId=k.charge.discountType.id,a.discountValue=k.charge.discountValue,k.charge.discountTrialOccurrences&&(a.discountTrialOccurrences=k.charge.discountTrialOccurrences.id),a.discountStartDate=k.charge.discountStartDate):a.discountTypeId=0,"asNeeded"===k.charge.billingFrequency.id&&(a.passBalance=+k.charge.passBalance,a.refill=e),"boolean"==typeof k.charge.makeMemberInactive&&(a.makeMemberInactive=k.charge.makeMemberInactive),"boolean"==typeof k.charge.makeCoMembersInactive&&(a.makeCoMembersInactive=k.charge.makeCoMembersInactive),"new"===t.current.params.recurringId?(a.postProration=!!k.charge.postProration,r=l.createCharge(m.getCurrentCenterId(),m.getCurrentUserId(),a)):r=l.updateCharge(m.getCurrentCenterId(),m.getCurrentUserId(),t.current.params.recurringId,a),r.then((function(){if(k.charge.makeMemberInactive&&o.resetCache(),!e)return m.setPath("/recurring-charges");t.reload()})).catch((function(e){return n.error(e,"Failed to save recurring charge.")}))}}}])},"/dut":function(e,t){angular.module("flexForms.ffBlock",["flexForms.ffBtnBlockEdit","flexForms.ffBtnBlockDelete","flexForms.ffBtnBlockSave","flexForms.ffBtnBlockCancel"]).directive("ffBlock",["$compile",function(e){"use strict";return{restrict:"A",scope:!0,priority:30,terminal:!0,controllerAs:"ffBlock",require:{ffBulkReadOnly:"^^?ffBulkReadOnly"},bindToController:{},controller:["$scope",function(e){this.delete=function(){return e.$eval(e.deleteExp).then((function(t){return e.ffSection&&e.ffSection.deleteBlock(e.$index),t}))},e.$on("ffBlock::EditStart",(function(){e.ffBlock.editMode=!0,e.editExp&&e.$eval(e.editExp+"=true")})),e.$on("ffBlock::EditEnd",(function(){e.ffBlock.editMode=!1,e.editExp&&e.$eval(e.editExp+"=false")})),this.edit=function(){e.ffBlockForm.$setPristine(),e.$emit("ffBlock::EditStart")},this.save=function(){return e.$eval(e.saveExp).then((function(t){return e.$emit("ffBlock::EditEnd"),t}))},this.cancel=function(){e.$eval(e.isNewExp)&&e.ffSection?e.ffSection.deleteBlock(e.$index):(e.$broadcast("ffControl::EditCancel"),e.$emit("ffBlock::EditCancel")),e.$emit("ffBlock::EditEnd")}}],compile:function(t,r){var n=this,a=angular.element('<form name="ffBlockForm"></form>');return a.append(t.contents()),t.empty().append(a),function(t,r,a,l){e(r,null,n.priority)(t),t.saveExp=a.ffBlockSave,t.deleteExp=a.ffBlockDelete,t.isNewExp=a.ffBlockIsNew,t.ffBlock.editMode=(!l.ffBulkReadOnly||l.ffBulkReadOnly.editMode)&&!!t.$eval(a.ffBlockEditDefault),t.editExp=a.ffBlockEdit,t.editExp&&t.$eval(t.editExp+"="+t.ffBlock.editMode),t.$eval(a.ffBlockDirtyDefault)&&t.ffBlockForm.$setDirty()}}}}])},"/uFl":function(e,t){e.exports='<ff-panel style="margin:1.5rem 0"> <ff-panel-header><span translate=RECURRING_BILLING.AUDIT.HEADER></span></ff-panel-header> <div ng-if="!$ctrl.entries.length && !$ctrl.fetching" class=animate-collapse> <span translate=GLOBAL.NONE></span> </div> <ff-header ng-if=$ctrl.entries.length class=animate-collapse> <ff-row> <cell><span translate=RECURRING_BILLING.AUDIT.PROPERTY></span></cell> <cell><span translate=RECURRING_BILLING.AUDIT.OLD_VALUE></span></cell> <cell><span translate=RECURRING_BILLING.AUDIT.NEW_VALUE></span></cell> </ff-row> </ff-header> <ff-col infinite-scroll=$ctrl.fetch() infinite-scroll-distance=2 infinite-scroll-container="\'.snap-content-scroller\'"> <div ng-repeat="entry in $ctrl.entries" class=animate-collapse> <ff-row> <ff-label class=standout><span> {{entry.createdAt | date:\'mediumDate\'}} <span nice-time=entry.createdAt></span> by {{entry.createdBy}} </span></ff-label> </ff-row> <ff-row ng-repeat="prop in entry.props"> <ff-static>{{prop.name}}</ff-static> <ff-static>{{prop.old | nd}}</ff-static> <ff-static>{{prop.new | nd}}</ff-static> </ff-row> </div> </ff-col> <ff-row ff-dim=true ng-if=$ctrl.fetching class=animate-collapse><ff-static></ff-static></ff-row> </ff-panel> '},"0D+u":function(e,t){angular.module("flexForms.ffTextarea",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffTextarea",["$compile","$templateCache","ffHelper",function(e,t,r){"use strict";return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffTextarea"},controller:"ffControlController as ffControl",bindToController:{},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffTextarea")),c=e(t.get("ffTextStatic"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n);var s=n.$eval(l.rowspan);s&&a.css("min-height",30*s-s+1+"px"),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return e}})}}}])},"0UaO":function(e,t,r){"use strict";r.r(t);var n=r("uQX1"),a=r.n(n),l=r("yCd9"),i=r.n(l),o=r("WSeP"),f=r.n(o);angular.module("flexForms.ffIncludeAll",[]).directive("ffIncludeAll",(function(){return{restrict:"E",scope:!0,template:'<ff-checkbox class="ff-center ff-include-all" ff-model="inc.all" ff-click="inc.selectAll()" ff-disabled="!inc.items || !inc.items.length" title="Include All" flex="1 1 auto">{{\'GLOBAL.INCLUDE_ALL\' | translate}}</ff-checkbox>',controller:"IncludeAllCtrl as inc",bindToController:{items:"<",default:"<"}}})).controller("IncludeAllCtrl",["$scope","$timeout",function(e,t){var r=this;function n(){f()(angular).call(angular,r.items,(function(e){e.include=r.all}))}r.selectAll=function(){return t(n)};var l=e.$watchCollection("inc.items",(function(e){e&&(r.all=!!r.default,n(),l())}));e.$watchCollection((function(){var e;return r.items&&i()(e=r.items).call(e,(function(e){return e.include}))}),(function(){var e;r.all=r.items&&r.items.length&&a()(e=r.items).call(e,(function(e){return!!e.include}))||!1}))}])},"0hh5":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR"),r("qThf");angular.module("flexForms.ffPagination",[]).directive("ffPagination",(function(){return{restrict:"E",scope:{props:"=",ffClick:"&"},template:'<span ng-repeat="p in range(props.pageCount) track by $index" ff-spin="spin == $index + 1" ng-class="{ active: ($index + 1) == props.page }" ng-click="page($index + 1)">{{$index + 1}}</span>',link:function(e){e.range=function(e){return new Array(e)},e.page=function(t){e.spin||t==e.props.page||(e.spin=t,e.ffClick({$page:t}).finally((function(){e.spin=0})))}}}}))},"0wyB":function(e,t,r){"use strict";r.r(t);r("8cZI"),r("w13K"),r("y89P");var n=r("T/jV"),a=r.n(n),l=r("WSeP"),i=r.n(l),o=r("xeXu"),f=r.n(o),c=r("6RpP"),s=r.n(c);angular.module("flexForms.ffDate",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffDate",["$compile","$templateCache","$locale","$filter","$window","$timeout","ffHelper",function(e,t,r,n,l,o,c){return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffDate"},controller:"ffControlController as ffControl",bindToController:{},link:function(u,d,p,g){var m=angular.element(t.get("ffDate")),h=angular.element(m[0].querySelector("input")),b=e(t.get("ffTextStatic"))(u);p.ffDisabled&&angular.element(m[0].querySelector("button")).attr("ng-disabled",p.ffDisabled),c.copyInnerAttrs(d,p,h),d.empty().append(m),e(m)(u),g.ffControl.init({renderEdit:function(){b.detach(),d.append(m)},renderView:function(){m.detach(),d.append(b)},modelToStatic:function(e){return n("date")(e,"mediumDate")}}),u.$attrs=p;var C,v=h.controller("ngModel");function I(){u.$apply("closeDP()")}v.$formatters.push((function(e){return C?(C=!1,v.$viewValue):(C=!1,n("date")(e,"dd MMM yyyy"))})),v.$parsers.push((function(e){var t;if(!e)return e;var n,a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],l=s()(t=r.DATETIME_FORMATS.SHORTMONTH).call(t,r.DATETIME_FORMATS.MONTH),i=s()(l).call(l,a),f=i.join("|").replace(/\./g,"\\.?"),c=new RegExp("(?:^(?:\\s*)(?:\\d{1,2})(?:\\s|-|\\.|\\/)("+f+")(?:\\s|-|\\.|\\/)(?:\\d{4})(?:\\s*)$)","i"),u=e.match(c);if(u&&u[1]){for(var d=-1,p=0;p<i.length;p++)if(i[p].toLowerCase().replace(".","")===u[1].toLowerCase().replace(".","")){d=p%12;break}e=(e=e.replace(new RegExp(u[1].replace(/\./g,"\\.?"),"i"),a[d])).replace(/\s|-|\.|\//g," "),n="DD MMM YYYY"}else e.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(e=e.replace(/\s|-|\./g,"/"),n="MM/DD/YYYY"):e.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)&&(e=e.replace(/\s|-|\./g,"-"),n="YYYY-MM-DD");if(n){var g=moment(e,n);if(g.isValid())return v.$setValidity("date",!0),C=!0,o((function(){C=!1})),g;v.$setValidity("date",!1)}})),u.closeDP=function(){var e=angular.element(document.getElementById("ff-dp-popup"));e.remove(e),l.removeEventListener("click",I),angular.element(document.querySelector("main")).css("padding-bottom","")},u.openDP=function(t){t.preventDefault(),t.stopPropagation(),u.closeDP(),l.addEventListener("click",I);var r=angular.element('<ff-datepicker id="ff-dp-popup" tabindex="0" ng-click="stopPropagation($event)"></ff-datepicker>');r.attr("ff-model",p.ffModel),r.attr("date-min",p.dateMin),r.attr("date-max",p.dateMax),r.attr("date-disabled",p.dateDisabled),r=e(r)(u),d.append(r),r[0].focus(),o((function(){r[0].querySelector(".ff-dp-cal-body").addEventListener("click",(function(){for(var e in u.closeDP(),o((function(){d[0].querySelector("input").focus()})),u.ffDateForm)u.ffDateForm.hasOwnProperty(e)&&f()(e).call(e,"$")<0&&angular.isString(u.ffDateForm[e].$name)&&(u.ffDateForm[e].$setDirty(),i()(angular).call(angular,u.ffDateForm[e].$viewChangeListeners,(function(e){e()})))}));var e=document.querySelector("main"),t=a()(l.getComputedStyle(e).paddingBottom);angular.element(e).css("padding-bottom",t+e.scrollHeight-e.clientHeight+50+"px")}))},u.stopPropagation=function(e){e.preventDefault(),e.stopPropagation()},u.$on("$destroy",(function(){u.closeDP()}))}}}])},"1A1g":function(e,t){angular.module("deskworks.billing",["deskworks.billing.purchase.list","deskworks.billing.purchase.edit","deskworks.billing.recurringCharge.list","deskworks.billing.recurringCharge.edit"])},"1e4I":function(e,t){e.exports='<div class=recurring-charges ff-bulk-read-only> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <ff-panel> <ff-header> <ff-row> <cell><span translate=RECURRING_BILLING.LIST.PRODUCT></span></cell> <cell flex="0 0 25%"><span translate=RECURRING_BILLING.GENERAL.DESCRIPTION></span></cell> <cell flex="0 0 17%" class=ff-right><span translate=RECURRING_BILLING.LIST.NEXT_BILLED></span></cell> <cell flex="0 0 17%" class=ff-center><span translate=RECURRING_BILLING.LIST.STATUS></span></cell> <cell flex="{xs: \'0 0 90px\', sm: \'0 0 120px\'}" class=ff-center><span translate=RECURRING_BILLING.LIST.USE_FOR_CHECK_IN_BILLING></span></cell> <ff-btn-group flex="0 0 auto" class="buttons-row zero-height"> <ff-btn sense=edit size=xs></ff-btn> </ff-btn-group> </ff-row> </ff-header> <ff-row ng-repeat="charge in $ctrl.charges"> <ff-static ff-bind=::charge.productName></ff-static> <ff-static flex="0 0 25%" ff-bind=::charge.description></ff-static> <ff-static flex="0 0 17%" class=ff-right ff-bind="::charge.nextBilled | date:\'mediumDate\'"></ff-static> <ff-static flex="0 0 17%" class=ff-center ff-bind=::charge.status.name></ff-static> <ff-label flex="{xs: \'0 0 90px\', sm: \'0 0 120px\'}" class=ff-center ff-dim=charge.$spin> <ff-checkbox ff-model=charge.useForCheckInBilling ff-value=true ff-change=$ctrl.saveUseForCheckInBilling(charge) ng-if=::charge.productHasPasses></ff-checkbox> <span ng-if=::!charge.productHasPasses translate=RECURRING_BILLING.LIST.NOT_AVAILABLE></span> </ff-label> <ff-btn-group flex="0 0 auto" class=buttons-row> <ff-btn sense=edit size=xs ff-click=$ctrl.edit(charge) title="{{\'GLOBAL.BTN_EDIT\' | translate}}"></ff-btn> </ff-btn-group> </ff-row> </ff-panel> <ff-btn-group class=buttons-bottom> <ff-btn sense=new ff-click=$ctrl.new()><span translate=RECURRING_BILLING.LIST.BTN_NEW></span></ff-btn> </ff-btn-group> </div> '},"2NYW":function(e,t){angular.module("flexForms.ffInfo",[]).directive("ffInfo",(function(){"use strict";return{restrict:"E"}}))},"2u/K":function(e,t,r){"use strict";r.r(t);r("8cZI"),r("y89P");var n=r("WSeP"),a=r.n(n),l=r("6RpP"),i=r.n(l),o=r("yCd9"),f=r.n(o),c=r("hsT8"),s=r.n(c),u=r("a8hB"),d=r.n(u);angular.module("flexForms.flex",[]).directive("flex",["dynCss",function(e){return{restrict:"A",link:function(t,r,n){n.$observe("flex",(function(n){"{"!==(n=d()(n).call(n))[0]&&(n="{ xs: '".concat(n,"' }")),n=t.$eval(n);var a=e("flex",n).join(" ");r.addClass(a)}))}}}]).factory("dynCss",["dynCssBreakpoints",function(e){var t={};return function(r,n){var a;return s()(a=f()(e).call(e,(function(e){var a,l,o=n[e.id];if(!o)return null;var f,c,s=i()(a=i()(l="".concat(e.id,"_")).call(l,r,"_")).call(a,o.replace(/(?: |\.)/g,"_").replace(/%/g,"pct"));angular.isUndefined(t[s])&&(t[s]=e.sheet.cssRules.length,e.sheet.insertRule(i()(f=i()(c=".".concat(s," { ")).call(c,r,": ")).call(f,o," !important; }"),e.sheet.cssRules.length));return s}))).call(a,(function(e){return!!e}))}}]).factory("dynCssBreakpoints",(function(){var e=[{id:"xs",width:null},{id:"sm",width:"480px"},{id:"md",width:"640px"},{id:"lg",width:"768px"},{id:"xl",width:"1024px"}];return a()(e).call(e,(function(e){var t=document.createElement("style");e.width&&t.setAttribute("media","(min-width: ".concat(e.width,")")),document.head.appendChild(t),e.sheet=t.sheet})),e}))},"41yb":function(e,t,r){"use strict";r.r(t);var n=r("xeXu"),a=r.n(n),l=r("D4RU"),i=r.n(l);angular.module("flexForms.validation.ngNotContain",[]).directive("ngNotContain",(function(){return{restrict:"A",require:"?ngModel",link:function(e,t,r,n){if(n&&r.ngNotContain){var l=function(t){var l=e.$eval(r.ngNotContain);if(!l)return t;angular.isArray(l)||(l=[l]);var o=i()(l).call(l,(function(e){var r;return e&&a()(r=(t||"").toLowerCase()).call(r,e.toLowerCase())>=0}));return n.$setValidity("notContain",!o),t};n.$parsers.push(l),e.$watch(r.ngMatch,(function(){l(n.$viewValue)}))}}}}))},"4F+U":function(e,t){angular.module("flexForms.ffIcon",[]).directive("ffIcon",(function(){"use strict";var e={checkInStatus:"fa-check",checkOutStatus:"fa-check",checkMark:"fa-check",check:"fa-check",plus:"fa-plus",refresh:"fa-refresh",increase:"fa-caret-up",decrease:"fa-caret-down",info:"fa-info-circle",breadcrumb:"fa-arrow-circle-right",error:"fa-exclamation-triangle",warning:"fa-exclamation-triangle",ignore:"fa-minus-circle",header:"fa-header",membership:"fa-users",reservation:"fa-calendar-o",billing:"fa-usd",user:"fa-user",navigate:"fa-arrow-circle-right",accessCode:"fa-tag",message:"fa-comment",center:"fa-home",facility:"fa-home",cloud:"fa-cloud",location:"fa-map-marker",phone:"fa-phone",email:"fa-envelope",list:"fa-list",sort:"fa-sort",print:"fa-print"};return{restrict:"E",scope:!1,link:function(t,r,n){var a=t.$eval(n.sense)||n.sense;r.addClass("ff-icon fa"),r.addClass("sense-"+a),r.addClass(e[a]||"fa-bug")}}}))},"50oH":function(e,t){angular.module("flexForms.validation.ngDateDiff",[]).directive("ngDateDiff",["$parse","$timeout",function(e,t){"use strict";return{restrict:"A",require:"?ngModel",link:function(e,r,n,a){var l=e.$on("ngDateDiff:validate",(function(){a.$validate()}));e.$on("$destroy",(function(){l()})),e.$watch(n.ngModel,(function(r){t((function(){for(var t=e;t.$parent&&!t.hasOwnProperty("vm");)t=t.$parent;t.$broadcast("ngDateDiff:validate")}))})),a.$validators.dateDiff=function(t,r){var a,l=e.$eval(n.ngDateDiff);return angular.isObject(l)||(a=l,l=e.$eval(n.ngDateOrder)),Math.abs(l.late-l.early)/36e5<a}}}}])},"53Pq":function(e,t,r){},"5ar6":function(e,t){angular.module("flexForms.ffEmail",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffEmail",["$compile","$templateCache","ffHelper",function(e,t,r){"use strict";return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffEmail"},controller:"ffControlController as ffControl",bindToController:{},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffEmail")),c=e(t.get("ffTextStatic"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return e}})}}}])},"8JIs":function(e,t,r){"use strict";r.r(t);var n=r("hsT8"),a=r.n(n),l=r("WSeP"),i=r.n(l);t.default=angular.module("deskworks.billing.purchase.list",["deskworks.center.service","deskworks.purchase.service","deskworks.routeHelper"]).config(["$routeProvider",function(e){e.when("/purchases",{templateUrl:"billing/purchase/purchase-list.tpl.html",controller:"PurchaseListCtrl as $ctrl",label:"Purchases",routeBranch:"purchases",translations:["purchase"],resolve:{purchases:["dwAlerts","purchaseService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then((function(){return n.selectUser()})).then((function(){return a()})).then((function(){return t.query(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to query purchases.")}))}))}],user:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then((function(){return n.selectUser()})).then((function(){return a()})).then((function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to get user profile.")}))}))}],center:["dwAlerts","centerService","state",function(e,t,r){return t.get(r.getCurrentCenterId(r.getCurrentCenterId())).catch((function(t){return e.error(t,"Failed to get center.")}))}]}})}]).controller("PurchaseListCtrl",["$scope","$translate","dwAlerts","center","purchases","state","helper","user","purchaseService",function(e,t,r,n,l,o,f,c,s){var u,d=this;d.center=n,d.purchases=l,d.types=[{id:"deposit",name:"PURCHASE.LIST.DEPOSIT.HEADER"},{id:"credit",name:"PURCHASE.LIST.CREDIT.HEADER"},{id:"open",name:"PURCHASE.LIST.OPEN.HEADER"},{id:"paid",name:"PURCHASE.LIST.PAID.HEADER"}],i()(u=d.types).call(u,(function(e){var t;e.orders=a()(t=d.purchases).call(t,(function(t){return t.type===e.id}))})),o.setPageTitle(t.instant("PURCHASE.LIST.PAGE_TITLE",{userName:c.fullName,centerName:n.name})),d.editPurchase=function(e){return o.setPath("/purchases/"+e.id+"/edit")},d.viewPurchase=function(e){return o.setPath("/purchases/"+e.id+"/view")},d.createPurchase=function(){return s.createPurchase(o.getCurrentCenterId(),o.getCurrentUserId()).catch((function(e){return r.error(e,"Failed to create purchase")})).then((function(e){return o.setPath("/purchases/"+e.id+"/edit")}))}}])},"8PDb":function(e,t){e.exports=' <script type=text/ng-template id=ffStatic> <span class="form-control ff-control ff-static"></span> <\/script> <script type=text/ng-template id=ffText> <input type="text" class="form-control ff-control ff-text" maxlength="256"> <\/script> <script type=text/ng-template id=ffTextStatic> <span class="form-control ff-control ff-static" ng-bind="ffControl.staticValue"></span> <\/script> <script type=text/ng-template id=ffTextStaticUrl> <span class="form-control ff-control ff-static">\n\t\t<a ng-bind="ffControl.staticValue" href="{{ffControl.staticUrl}}" target="_blank" rel="noopener"></a>\n\t</span> <\/script> <script type=text/ng-template id=ffEmail> <input type="email" class="form-control ff-control ff-email" autocapitalize="off" maxlength="256"> <\/script> <script type=text/ng-template id=ffLogin> <input type="text" class="form-control ff-control ff-text" autocorrect="off" autocapitalize="off" maxlength="256"> <\/script> <script type=text/ng-template id=ffPassword> <input type="password" class="form-control ff-control ff-password" autocorrect="off" autocapitalize="off" autocomplete="new-password" maxlength="256"> <\/script> <script type=text/ng-template id=ffPasswordStatic> <span class="form-control ff-control ff-static">&bullet;&bullet;&bullet;&bullet;&bullet;&bullet;</span> <\/script> <script type=text/ng-template id=ffTextarea> <textarea class="form-control ff-control ff-textarea"></textarea> <\/script> <script type=text/ng-template id=ffTime> <input name="time" type="text" class="form-control ff-control ff-time" ng-model-options="{ allowInvalid: true }" ng-focus="onFocus()"> <\/script> <script type=text/ng-template id=ffTimeStatic> <span class="form-control ff-control ff-static"><span nice-time="ffControl.staticValue"></span></span> <\/script> <script type=text/ng-template id=ffDate> <div ng-form="ffDateForm">\n\t\t<input name="date" type="text" class="form-control ff-control ff-date" ng-model-options="{ allowInvalid: true }">\n\t\t<button type="button" class="fa fa-calendar" ng-click="openDP($event)" title="Open Date Picker"></button>\n\t</div> <\/script> <script type=text/ng-template id=ffSelect> <select class="form-control ff-control ff-select"></select> <\/script> <script type=text/ng-template id=ffCheckbox> <input type="checkbox" class="ff-checkbox"> <\/script> <script type=text/ng-template id=ffCheckboxStatic> <checked ng-if="ffControl.staticValue"></checked> <\/script> <script type=text/ng-template id=ffRadio> <input type="radio" class="ff-checkbox"> <\/script> <script type=text/ng-template id=ffRadioStatic> <span class="fa" ng-class="{ \'fa-check-circle\': ffControl.staticValue, \'fa-circle-o\': !ffControl.staticValue }"></span> <\/script> '},A5e7:function(e,t,r){"use strict";r.r(t);r("+/c9");angular.module("flexForms.ffBulkReadOnly",[]).directive("ffBulkReadOnly",["$route","UserTasks","helper",function(e,t,r){return{restrict:"A",scope:!0,controllerAs:"ffBlock",bindToController:{ffBulkReadOnly:"<"},controller:["$scope","$element",function(n,a){var l=this;function i(e){l.editMode=!!e,a.toggleClass("ff-bulk-read-only",!e)}function o(e){e.altKey&&e.shiftKey&&79===e.keyCode&&n.$apply((function(){i(!l.editMode)}))}l.$onInit=function(){angular.isUndefined(l.ffBulkReadOnly)?(n.UserTasks=t,n.$watchCollection("UserTasks.tasks",(function(t){var n=r.findByKeyValue(t,"url","/"+e.current.$$route.routeBranch);i(!!n&&!n.readOnly)}))):n.$watch("ffBlock.ffBulkReadOnly",(function(e){i(!e)})),document.addEventListener("keydown",o),n.$on("$destroy",(function(){document.removeEventListener("keydown",o)}))}}]}}])},Bf3X:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),a=r.n(n);angular.module("flexForms.ffCheckbox",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffCheckbox",["$compile","$templateCache","ffHelper",function(e,t,r){return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffCheckbox"},controller:"ffControlController as ffControl",bindToController:{},compile:function(n,l){var i=n.html();return n.empty(),function(n,l,o,f){var c=f.ffControl,s=angular.element(t.get("ffCheckbox")),u=angular.element("<i></i>"),d=e(t.get("ffCheckboxStatic"))(n),p=o.ffLabel||a()(i).call(i);p&&(p=angular.element('<span class="cb-label"></span>').append(p)),r.copyInnerAttrs(l,o,s),l.empty().append(s).append(u),e(s)(n),p&&(l.append(p),e(p)(n)),c.init({renderEdit:function(){d.detach(),l.prepend(s)},renderView:function(){s.detach(),l.prepend(d)},modelToStatic:function(e){return!(!angular.isDefined(o.ffTrueValue)||e!=o.ffTrueValue)||(!angular.isDefined(o.ffFalseValue)||e!=o.ffFalseValue)&&!!e}})}}}}])},"Bje/":function(e,t){angular.module("flexForms.ffStatic",["deskworks.ffControlController"]).directive("ffStatic",["$compile","$templateCache","ffHelper","ffControlCompileTemplates",function(e,t,r,n){"use strict";return{restrict:"E",compile:function(n,a){var l=n.html();return n.empty(),function(n,a,i,o){var f=angular.element(t.get("ffStatic"));f.append(l),r.copyInnerAttrs(a,i,f),a.empty().append(f),e(f)(n)}}}}])},BoVB:function(e,t,r){"use strict";r.r(t);r("8cZI"),r("w13K"),r("y89P");var n=r("T/jV"),a=r.n(n);angular.module("flexForms.ffTime",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffTime",["$compile","$templateCache","$locale","$filter","ffHelper",function(e,t,r,n,l){return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffTime"},controller:"ffControlController as ffControl",bindToController:{},link:function(i,o,f,c){var s=angular.element(t.get("ffTime")),u=e(t.get("ffTimeStatic"))(i);l.copyInnerAttrs(o,f,s),o.empty().append(s),e(s)(i),c.ffControl.init({renderEdit:function(){u.detach(),o.append(s)},renderView:function(){s.detach(),o.append(u)},modelToStatic:function(e){return e}}),i.onFocus=function(){return s[0].select?s[0].select():s[0].setSelectionRange?s[0].setSelectionRange(0,999):void 0};var d=s.controller("ngModel");d.$formatters.push((function(e){return n("date")(e,"shortTime")})),d.$parsers.unshift((function(e){if(!e)return e;var t,n,l,i=r.DATETIME_FORMATS.AMPMS;return(t=e.match(new RegExp("^\\s*([01]?\\d):([0-5]\\d)\\s+(am|pm|"+i.join("|").replace(/\./g,"\\.")+")\\s*$","i")))?(n=a()(t[1]),l=a()(t[2]),t[3]=t[3].toLowerCase(),(n>12||0===n)&&(n=void 0),("pm"===t[3]||t[3]===i[1].toLowerCase())&&n<12&&(n+=12),"am"!==t[3]&&t[3]!==i[0].toLowerCase()||12!==n||(n-=12)):(t=e.match(/^\s*([012]?\d):([0-5]\d)\s*$/i))&&(n=a()(t[1]),l=a()(t[2]),(n>24||24===n&&0!==l)&&(n=void 0)),l>59&&(l=void 0),angular.isDefined(n)&&angular.isDefined(l)?moment({hour:n,minute:l}):void 0}))}}}])},CTko:function(e,t,r){},D5nk:function(e,t,r){},DyWX:function(e,t,r){var n={"./billing/billing-profile/billing-profile-edit.tpl.html":"laxG","./billing/purchase/dw-add-charges.tpl.html":"G7f6","./billing/purchase/purchase-edit.tpl.html":"qoyf","./billing/purchase/purchase-list.tpl.html":"Li7w","./billing/purchase/purchase-payment.tpl.html":"uVw+","./billing/recurring-billing/recurring-charge-audit.tpl.html":"/uFl","./billing/recurring-billing/recurring-edit.tpl.html":"qPMi","./billing/recurring-billing/recurring-list.tpl.html":"1e4I","./flex-forms/controls/ff-control.tpl.html":"8PDb","./flex-forms/ff-datepicker/ff-datepicker.tpl.html":"HMLR","./members/our-members/our-member-modal.tpl.html":"gB/y","./members/our-members/our-members.tpl.html":"Ht9o","./members/user-profile/billing-sections/up-billing-method.tpl.html":"ntZG","./members/user-profile/billing-sections/up-credit-cards.tpl.html":"l7tb","./members/user-profile/billing-sections/up-e-checks.tpl.html":"Ntds","./members/user-profile/sections/up-access-codes.tpl.html":"aj6+","./members/user-profile/sections/up-addresses.tpl.html":"auvQ","./members/user-profile/sections/up-co-members.tpl.html":"Q9OX","./members/user-profile/sections/up-comments.tpl.html":"WZXA","./members/user-profile/sections/up-custom-fields.tpl.html":"jtA9","./members/user-profile/sections/up-documents.tpl.html":"SHcK","./members/user-profile/sections/up-lead-source.tpl.html":"aT6e","./members/user-profile/sections/up-login-info.tpl.html":"sLGz","./members/user-profile/sections/up-mailboxes.tpl.html":"MHBY","./members/user-profile/sections/up-membership.tpl.html":"cdCP","./members/user-profile/sections/up-personal-info.tpl.html":"80Eh","./members/user-profile/sections/up-phones.tpl.html":"zcfi","./members/user-profile/sections/up-photo.tpl.html":"FZlk","./members/user-profile/sections/up-printer-codes.tpl.html":"NQ3A","./members/user-profile/sections/up-shareable.tpl.html":"3xdx","./members/user-profile/sections/up-system-info.tpl.html":"SxCY","./members/user-profile/sections/up-terms-of-service.tpl.html":"e8sX","./members/user-profile/user-profile.tpl.html":"OdV3","./members/user-search/user-search.tpl.html":"L3g9","./sidebar/sidebar.tpl.html":"f+zm","./sign-in/dw-sign-in.tpl.html":"Mm7d","./sign-in/sign-in.tpl.html":"EyXH"};function a(e){var t=l(e);return r(t)}function l(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=l,e.exports=a,a.id="DyWX"},"E/w8":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");var n=r("KK/u"),a=r.n(n);r("wkyt");t.default=angular.module("flexForms.ffSort",[]).directive("ffSort",(function(){return{restrict:"E",scope:{colId:"<",props:"<",ffClick:"&"},template:'<span class="fa" ng-class="getClass()" ng-click="sort()" title="Click to sort"></span>',link:function(e,t){t.addClass("ff-spin-sm"),e.sort=function(){a()(e.props)===e.colId?e.props.order=-e.props.order:(e.props.sort=e.colId,e.props.order=1),e.spin||(t.addClass("ff-spin"),e.ffClick().finally((function(){t.removeClass("ff-spin")})))},e.getClass=function(){return a()(e.props)!==e.colId?"fa-sort":e.props.order<0?"fa-sort-desc":"fa-sort-asc"}}}}))},EL9o:function(e,t){angular.module("flexForms.ffUrl",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffUrl",["$compile","$templateCache","ffHelper",function(e,t,r){"use strict";return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffUrl"},controller:"ffControlController as ffControl",bindToController:{staticUrl:"<ffModel"},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffText")),c=e(t.get("ffTextStaticUrl"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return e}}),f.controller("ngModel").$validators.url=function(e,t){return!t||/^http(s)?:\/\/\w+/.test(t)}}}}])},G7f6:function(e,t){e.exports='<div> <div class="em ff-bmargin"> <span translate=PURCHASE.CHARGES.HEADER></span><span ng-if=$ctrl.userPriceList>, <span translate=PURCHASE.USER_PRICE_LIST></span>: <span ng-bind="$ctrl.userPriceList.name || \'-\'"></span> </span> </div> <div id=chargeType-{{chargeType.id}} ng-repeat="chargeType in $ctrl.purchase.options.chargeTypes"> <ff-btn sense=collapse ff-click="$ctrl.collapsed[chargeType.id] = !$ctrl.collapsed[chargeType.id]" ng-class="{ collapsed: !$ctrl.collapsed[chargeType.id] }" class=dw-add-charges-collapse-btn>{{chargeType.name}}</ff-btn> <div ng-collapse=!$ctrl.collapsed[chargeType.id]> <ff-panel class=ff-bmargin> <ng-form name=formProduct id=product{{product.id}} ng-repeat="product in chargeType.packages"> <ff-panel ff-label={{product.name}} ff-label-ext="{{product.price | ncurrency}}" class=ff-bmargin> <ff-panel-header> {{product.name}} - {{product.price | ncurrency}} </ff-panel-header> <div class="ff-grid gutter-h-half"> <label flex="{md: \'0 0 50%\'}" class=ff-row ng-if="chargeType.id === \'custom\'"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.NAME></span></ff-label> <ff-text name=name ff-model=product.name ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.NAME\' | translate}}"></ff-text> </label> <ff-row flex="{md: \'0 0 50%\'}" ng-if="chargeType.id === \'custom\'"> <label flex="0 1 160px"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.PRICE></span></ff-label> <ff-price name=price ff-model=product.price ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.PRICE\' | translate}}"></ff-price> </label> <label flex="0 0 auto"> <ff-checkbox flex="0 0 auto" name=isTaxable ff-model=product.isTaxable>Is Taxable</ff-checkbox> </label> </ff-row> <ff-row flex="{md: \'0 0 50%\'}"> <label flex="0 0 34%"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.QUANTITY></span></ff-label> <ff-number flex="1 1 1%" name=qty ff-model=product.quantity ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.QUANTITY\' | translate}}"></ff-number> </label> <label flex="0 0 66%"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.USE_DATE></span></ff-label> <ff-date flex="1 1 1%" name=chargedAt ff-model=product.chargedAt ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.USE_DATE\' | translate}}"></ff-date> </label> </ff-row> <ff-row flex="{md: \'0 0 50%\'}"> <label flex="1 1 auto"> <ff-label flex="0 0 76px"><span translate=PURCHASE.CHARGES.NOTES></span></ff-label> <ff-text flex="1 1 1%" name=notes ff-model=product.notes></ff-text> </label> <ff-btn-group flex=none> <ff-btn sense=save size=sm type=submit ff-click="$ctrl.createCharge(chargeType, product)"> <span translate=PURCHASE.CHARGES.BTN_ADD></span> </ff-btn> </ff-btn-group> </ff-row> </div> </ff-panel> </ng-form> </ff-panel> </div> </div> </div> '},HMLR:function(e,t){e.exports='<div class=ff-dp-cal-header> <button type=button ng-click=$ctrl.prevMonth()><b class="fa fa-chevron-left"></b></button> <div> <span ng-bind="$ctrl.date | date: \'LLLL\'"></span> <button type=button ng-click="$ctrl.showYears = !$ctrl.showYears">{{$ctrl.date | date: \'yyyy\'}} <span class="fa fa-caret-down"></span> </button> </div> <button type=button ng-click=$ctrl.nextMonth()><b class="fa fa-chevron-right"></b></button> </div> <div class=ff-dp-years ng-show=$ctrl.showYears> <button type=button class=ff-dp-year ng-class="{ current: year === $ctrl.date.year() }" ng-click=$ctrl.selectYear(year) ng-repeat="year in $ctrl.years" ng-disabled="year < $ctrl.dateMin.year() || year > $ctrl.dateMax.year()">{{year}}</button> </div> <div class=ff-dp-cal-week> <div ng-repeat="weekDay in $ctrl.weekDays">{{weekDay}}</div> </div> <div class=ff-dp-cal-body> <button ng-repeat="day in $ctrl.prevMonthDays" type=button class="ff-dp-day dimmed" ng-click=$ctrl.selectDay(day) ng-disabled=$ctrl.checkDateDisabled(day.date)> {{day.str}} </button> <button ng-repeat="day in $ctrl.days" type=button class=ff-dp-day ng-click=$ctrl.selectDay(day) ng-disabled=$ctrl.checkDateDisabled(day.date) ng-class="{ current: $ctrl.compareDates(day.date, $ctrl.ffModel), today: $ctrl.compareDates(day.date, $ctrl.today) }"> {{day.str}} </button> <button ng-repeat="day in $ctrl.nextMonthDays" type=button class="ff-dp-day dimmed" ng-click=$ctrl.selectDay(day) ng-disabled=$ctrl.checkDateDisabled(day.date)> {{day.str}} </button> </div> '},JH9l:function(e,t,r){},Li7w:function(e,t){e.exports='<div class="purchase-list ff-grid" ff-bulk-read-only> <h4 class=page-title>{{state.getPageTitle()}}</h4> <ff-btn-group class=buttons-top ng-if="$ctrl.purchases.length > 5"> <ff-btn sense=new ff-click=$ctrl.createPurchase()><span translate=PURCHASE.LIST.BTN_NEW></span></ff-btn> </ff-btn-group> <div class="ff-grid gutter-v"> <ff-panel ng-repeat="type in $ctrl.types" ng-if=type.orders.length> <ff-panel-header><span translate={{type.name}}></span></ff-panel-header> <ff-header> <ff-row> <cell flex="1 1 12%"><span translate=PURCHASE.LIST.ORDER_ID></span></cell> <cell flex="1 1 15%" class="ff-right show-sm"><span translate=PURCHASE.LIST.FIRST_OPENED></span></cell> <cell flex="1 1 15%" class="ff-right show-md"><span translate=PURCHASE.LIST.LAST_MODIFIED></span></cell> <cell flex="1 1 15%" class=ff-right><span translate=PURCHASE.LIST.PURCHASE_TOTAL></span></cell> <cell flex="1 1 12%" class="ff-right show-sm" ng-if=$ctrl.center.taxRates.length><span translate=PURCHASE.LIST.TAX_TOTAL></span></cell> <cell flex="1 1 15%" class="ff-right show-xs"><span translate=PURCHASE.LIST.PAYMENT_TOTAL></span></cell> <cell flex="1 1 15%" class=ff-right><span translate=PURCHASE.LIST.BALANCE_DUE></span></cell> <ff-btn-group flex="0 0 auto" class="buttons-row zero-height"> <ff-btn sense=view size=xs></ff-btn> <ff-btn sense=edit size=xs></ff-btn> </ff-btn-group> </ff-row> </ff-header> <ff-row ng-repeat="order in type.orders"> <ff-static flex="1 1 12%" ff-bind=order.id></ff-static> <ff-static flex="1 1 15%" class="ff-right show-sm" ff-bind="order.firstOpened | date:\'mediumDate\'"></ff-static> <ff-static flex="1 1 15%" class="ff-right show-md" ff-bind="order.lastModified | date:\'mediumDate\'"></ff-static> <ff-static flex="1 1 15%" class=ff-right ff-bind="order.chargesTotal | ncurrency"></ff-static> <ff-static flex="1 1 12%" class="ff-right show-sm" ff-bind="order.taxTotal | ncurrency" ng-if=$ctrl.center.taxRates.length></ff-static> <ff-static flex="1 1 15%" class="ff-right show-xs" ff-bind="order.paymentTotal | ncurrency"></ff-static> <ff-static flex="1 1 15%" class=ff-right ff-bind="order.balance | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" class=buttons-row> <ff-btn sense=view size=xs ff-click=$ctrl.viewPurchase(order) title="{{\'PURCHASE.LIST.BTN_VIEW\' | translate}}"></ff-btn> <ff-btn sense=edit size=xs ff-click=$ctrl.editPurchase(order) title="{{\'GLOBAL.BTN_EDIT\' | translate}}"></ff-btn> </ff-btn-group> </ff-row> </ff-panel> </div> <ff-btn-group class=buttons-bottom> <ff-btn sense=new ff-click=$ctrl.createPurchase()><span translate=PURCHASE.LIST.BTN_NEW></span></ff-btn> </ff-btn-group> </div> '},"M+TN":function(e,t){angular.module("flexForms.validation.ngDateOrder",[]).directive("ngDateOrder",["$parse","$timeout",function(e,t){"use strict";return{restrict:"A",require:"?ngModel",scope:!0,link:function(e,r,n,a){var l=e.$on("ngDateOrder:validate",(function(){a.$validate()}));e.$on("$destroy",(function(){l()})),e.$watch(n.ngModel,(function(n){t((function(){for(var t=e;t.$parent&&!t.hasOwnProperty("vm");)t=t.$parent;t.$broadcast("ngDateOrder:validate",r[0].name)}))})),a.$validators.dateOrder=function(t,a){var l,i,o=e.$eval(n.ngDateOrder),f=r.parent().parent()[0];return f&&f.tagName&&"ff-date"===f.tagName.toLowerCase()?(moment.isMoment(o.early)&&(l=o.early.clone()).hour(0).minute(0).second(0).millisecond(0),moment.isMoment(o.late)&&(i=o.late.clone()).hour(0).minute(0).second(0).millisecond(0),!moment.isMoment(l)||!moment.isMoment(i)||l<=i):!moment.isMoment(o.early)||!moment.isMoment(o.late)||o.early<o.late}}}}])},M6Ci:function(e,t){angular.module("flexForms.validation.ngTimeOrder",[]).directive("ngTimeOrder",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",scope:!0,link:function(e,r,n,a){var l=e.$on("ngTimeOrder:validate",(function(e){a.$validate()}));e.$on("$destroy",(function(){l()})),e.$watch(n.ngModel,(function(n){t((function(){for(var t=e;t.$parent&&!t.hasOwnProperty("vm");)t=t.$parent;t.$broadcast("ngTimeOrder:validate",r[0].name)}))})),a.$validators.timeOrder=function(t,r){var a,l,i=e.$eval(n.ngTimeOrder);return moment.isMoment(i.early)&&(a=i.early.clone().year(0).month(0).date(0)),moment.isMoment(i.late)&&(l=i.late.clone().year(0).month(0).date(0)),!moment.isMoment(a)||!moment.isMoment(l)||a<l||!l.hour()&&!l.minute()}}}}])},MJsB:function(e,t){angular.module("flexForms.ffLogin",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffLogin",["$compile","$templateCache","ffHelper",function(e,t,r){"use strict";return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffLogin"},controller:"ffControlController as ffControl",bindToController:{},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffLogin")),c=e(t.get("ffTextStatic"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return e}})}}}])},NCux:function(e,t){angular.module("flexForms.ffLabel",[]).directive("ffLabel",["ffHelper",function(e){return{restrict:"E",compile:function(e,t){return angular.isDefined(t.ffTransclude)?(e.html('<span class="ff-label" ng-transclude="'+t.ffTransclude+'"></span>'),t.$set("ffTransclude",null)):t.ffBindHtml?e.html('<span class="ff-label" ng-bind-html="'+t.ffBindHtml+'"></span>'):e.html('<span class="ff-label">'+e.html()+"</span>"),function(e,t,r){r.$observe("ffRequired",(function(e){t.toggleClass("ff-required","true"==e)}))}}}}])},OgZC:function(e,t,r){"use strict";r.r(t);r("w13K");var n=r("xeXu"),a=r.n(n);angular.module("flexForms",["mqs","flexForms.flexForm","flexForms.flexFormTitle","flexForms.ffPanel","flexForms.flex","flexForms.ffRow","flexForms.ffLabel","flexForms.ffStatic","flexForms.ffText","flexForms.ffUrl","flexForms.ffLogin","flexForms.ffPassword","flexForms.ffEmail","flexForms.ffTime","flexForms.ffDate","flexForms.ffDatepicker","flexForms.ffDatepickerPopup","flexForms.ffNumber","flexForms.ffPrice","flexForms.ffSelect","flexForms.ffTextarea","flexForms.ffCheckbox","flexForms.ffRadio","flexForms.ffBtn","flexForms.ffBtnGroup","flexForms.ngValidateAlert","flexForms.ffSpin","flexForms.ffDim","flexForms.ffImg","flexForms.ffSearch","flexForms.validation.ngTimeOrder","flexForms.validation.ngDateOrder","flexForms.validation.ngDateDiff","flexForms.validation.ngUnique","flexForms.validation.ngLte","flexForms.validation.ngLt","flexForms.validation.ngGte","flexForms.validation.ngGt","flexForms.validation.ngMatch","flexForms.validation.ngNotContain","flexForms.ngCollapse","flexForms.ffPagination","flexForms.ffIcon","flexForms.ffInfo","flexForms.ffSection","flexForms.ffTip","flexForms.ffHint","flexForms.ffCountdown","flexForms.ffIncludeAll","flexForms.ffSort","flexForms.ffCcNumber","flexForms.ffBulkReadOnly"]).factory("ffHelper",(function(){return{copyInnerAttrs:function(e,t,r){for(var n in t.$attr){var l;0===a()(l=t.$attr[n]).call(l,"ff-")&&"ff-countdown"!==t.$attr[n]&&r.attr("ng-"+t.$attr[n].substr(3),t[n])}return t.name&&(r.attr("name",t.name),t.$set("name",null)),r.attr("minlength",t.minlength),t.$set("minlength",null),r.attr("maxlength",t.maxlength),t.$set("maxlength",null),r.attr("placeholder",t.placeholder),t.$set("placeholder",null),r.attr("ff-countdown",t.ffCountdown),t.$set("ffCountdown",null),r.attr("ta-toolbar",t.taToolbar),t.$set("taToolbar",null),r},isMobile:function(){if(navigator.userAgent&&(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)))return!0}}}))},"PdZ/":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");var n=r("WSeP"),a=r.n(n);angular.module("deskworks.billing.recurringCharge.list",["deskworks.recurringCharge.service"]).config(["$routeProvider",function(e){e.when("/recurring-charges",{templateUrl:"billing/recurring-billing/recurring-list.tpl.html",controller:"RecurringChargeListCtrl as $ctrl",label:"Recurring Billing",routeBranch:"recurring-charges",translations:["recurring-billing"],resolve:{charges:["dwAlerts","recurringChargeService","state","routeHelper",function(e,t,r,n){return n.auth().then((function(){return n.selectUser().then((function(){return t.query(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to query recurring charges.")}))}))}))}],user:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then((function(){return n.selectUser()})).then((function(){return a()})).then((function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to get user profile.")}))}))}]}})}]).controller("RecurringChargeListCtrl",["$scope","$translate","dwAlerts","recurringChargeService","user","charges","state","helper",function(e,t,r,n,l,i,o,f){var c=this;c.charges=i,o.setPageTitle(t.instant("RECURRING_BILLING.LIST.PAGE_TITLE",{userName:l.fullName})),c.new=function(){return o.setPath("/recurring-charges/new/edit")},c.edit=function(e){return o.setPath("/recurring-charges/"+e.id+"/edit")},c.saveUseForCheckInBilling=function(e){var t;a()(t=c.charges).call(t,(function(t){t.useForCheckInBilling&&t!==e&&(t.useForCheckInBilling=!1)})),e.$spin=!0,n.setUseForCheckInBilling(o.getCurrentCenterId(),o.getCurrentUserId(),e.id).catch((function(e){return r.error(e,'Failed to set "Use for Check-In Billing".')})).finally((function(){e.$spin=!1}))}}])},Q4eN:function(e,t,r){"use strict";r.r(t);var n=r("mxFF"),a=r.n(n);angular.module("flexForms.validation.ngGt",[]).directive("ngGt",(function(){return{restrict:"A",require:"?ngModel",link:function(e,t,r,n){n.$validators.gt=function(t,n){var l=a()(n),i=e.$eval(r.ngGt);return i=angular.isDefined(i)?a()(i):a()(r.ngGt),isNaN(l)||isNaN(i)||l>i},e.$watch(r.ngGt,(function(){n.$validate()}))}}}))},QKBG:function(e,t,r){},QUT1:function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");angular.module("flexForms.ffBtn",[]).directive("ffBtn",["$rootScope","$q","$compile","ffHelper",function(e,t,r,n){var a={xs:"btn-xs",sm:"btn-xs",lg:""},l={edit:{color:"btn-primary",icon:"fa-pencil"},add:{color:"btn-success",icon:"fa-plus"},"add-alt":{color:"btn-primary",icon:"fa-plus"},new:{color:"btn-success",icon:"fa-plus"},view:{color:"btn-success",icon:"fa-eye"},clone:{color:"btn-success",icon:"fa-copy"},back:{color:"btn-warning",icon:"fa-chevron-left"},import:{color:"btn-success",icon:"fa-upload"},remove:{color:"btn-danger",icon:"fa-remove"},delete:{color:"btn-danger",icon:"fa-remove"},save:{color:"btn-success",icon:"fa-check"},next:{color:"btn-success",icon:"fa-chevron-right"},search:{color:"btn-primary",icon:"fa-search"},userSelect:{color:"btn-success",icon:"fa-user"},reserve:{color:"btn-success",icon:"fa-check"},ok:{color:"btn-success",icon:"fa-check"},cancel:{color:"btn-warning",icon:"fa-ban"},upload:{color:"btn-primary",icon:"fa-upload"},download:{color:"btn-primary",icon:"fa-download"},favorite:{color:"btn-success",icon:"fa-star"},makeFavorite:{color:"btn-warning",icon:"fa-star-o"},collapse:{color:"btn-primary",icon:"fa-angle-down"},collapseBtn:{color:"btn-success",icon:"fa-angle-down"},collapseBtnPriv:{color:"btn-success",icon:"fa-angle-down"},signup:{color:"btn-primary"},link:{color:"btn-link"},checkIn:{color:"btn-success",icon:"fa-check"},checkOut:{color:"btn-warning",icon:"fa-check"},home:{color:"btn-warning",icon:"fa-home"},charge:{color:"btn-primary",icon:"fa-dollar"},merge:{color:"btn-success",icon:"fa-copy"},help:{color:"btn-primary",icon:"fa-question"},reset:{color:"btn-warning",icon:"fa-undo"},calendar:{color:"btn-warning",icon:"fa-calendar"},close:{color:"btn-link",icon:"fa-close"},signOut:{color:"btn-primary",icon:"fa-sign-out"},settings:{color:"btn-primary",icon:"fa-cog"},crop:{color:"btn-primary",icon:"fa-crop"}};return{restrict:"E",scope:!0,terminal:!0,priority:1,controllerAs:"ffBtn",controller:["$scope",function(e){var r=this;r.click=function(e){return r.spin=!0,t.when(e).finally((function(){r.spin=!1}))},e.$on("ffCountdown::expiry",(function(t){t.stopPropagation(),e.$eval(r.clickExp)}))}],link:function(e,t,i,o){var f=i.ffClick;o.clickExp=i.ffClick,i.ffSpin||(o.clickExp="ffBtn.click("+i.ffClick+")",i.$set("ffClick",o.clickExp),i.$set("ffSpin","ffBtn.spin"));var c=angular.element('<button class="ff-btn btn"></button>');n.copyInnerAttrs(t,i,c),r(t,null,1)(e),c.attr("type",i.type||"button"),c.addClass(a[i.size]||"btn-sm"),"xs"!==i.size&&c.append("<span>"+t.html()+"</span>"),t.empty().append(c),r(c)(e),t.attr("ff-click",f),i.$observe("sense",(function(e){if(c.removeClass("btn-primary btn-success btn-warning btn-danger"),c.addClass(angular.isDefined(l[e])?l[e].color:"btn-primary"),!l[e]||l[e].icon){var t=c[0].querySelector(".fa");t&&t.remove(),c.append(angular.element('<span class="fa"></span>').addClass(l[e]?l[e].icon:"fa-check"))}c.attr("tabindex","favorite"===e?-1:0)})),e.$watch(i.ffSpin,(function(t){e.$emit(t?"ffBtn::spinStart":"ffBtn::spinStop")}))}}}])},Qk6A:function(e,t,r){"use strict";r.r(t);var n=r("mxFF"),a=r.n(n);angular.module("flexForms.validation.ngLte",[]).directive("ngLte",(function(){return{restrict:"A",require:"?ngModel",link:function(e,t,r,n){n.$validators.lte=function(t,n){var l=a()(n),i=e.$eval(r.ngLte);return i=angular.isDefined(i)?a()(i):a()(r.ngLte),isNaN(l)||isNaN(i)||l<=i},e.$watch(r.ngGte,(function(){n.$validate()}))}}}))},"R+bH":function(e,t){angular.module("flexForms.ffBtnGroup",[]).directive("ffBtnGroup",["$timeout","$rootScope",function(e,t){return{restrict:"E",scope:!0,compile:function(e,t){return e.addClass("input-btn-group"),e.addClass("ff-btn-group"),e.html("<fieldset"+(e.attr("ff-disabled")?' ng-disabled="'+e.attr("ff-disabled")+'"':"")+">"+e.html()+"</fieldset>"),function(e,t,r){var n=t[0].querySelector("fieldset");e.$on("ffBtn::spinStart",(function(e){e.stopPropagation(),n.disabled=!0})),e.$on("ffBtn::spinStop",(function(e){e.stopPropagation(),n.disabled=!1}))}}}}])},R2vv:function(e,t){angular.module("flexForms.flexForm",[]).directive("flexForm",["ffHelper",function(e){return{restrict:"E",compile:function(e,t){var r='<div class="panel-heading">'+(t.ffLabel?'<div class="panel-title">'+t.ffLabel+(t.ffLabelAddon?t.ffLabelAddon:"")+"</div>":"")+(t.ffLabelExt?'<div class="panel-title">'+t.ffLabelExt+"</div>":"")+'</div><div class="panel-body">'+e.html()+"</div>";return e.addClass("panel panel-default flex-form"),e.html(r),function(e,t,r){}}}}])},Sr5Z:function(e,t){angular.module("flexForms.ffRow",[]).directive("ffRow",(function(){return{restrict:"E",scope:!0,compile:function(e,t){return e.addClass("ff-row"),this.link},link:function(e,t,r){r.ffClick&&angular.element(t[0].getElementsByTagName("ff-static")).on("click",(function(){e.$apply(r.ffClick)}))}}}))},Uwr6:function(e,t){angular.module("flexForms.ffPanel",["flexForms.ffPanelHeader"]).directive("ffPanel",(function(){return{restrict:"EC",compile:function(e){var t='<div class="ff-panel-body">'+e.html()+"</div>";return e.addClass("ff-panel"),e.html(t),function(){}}}}))},WWWs:function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR"),r("X5mX");angular.module("flexForms.ffSearch",[]).directive("ffSearch",["$compile","$timeout","ffHelper",function(e,t,r){return{restrict:"E",scope:!0,priority:20,terminal:!0,controllerAs:"ffSearch",controller:["$scope","$element","$attrs",function(e,r,n){var a=this,l=n.ffSearch,i=n.ffSearchFilter,o=n.ffChange;a.search=function(t){a.curIdx=0,a.resultsFiltered=i?e.$eval(i,{$results:a.results,$search:a.val}):a.results,a.matchActive=!1,t&&l&&(a.spin=!0,e.$eval(l,{$search:t}).then((function(t){a.results=t,a.resultsFiltered=i?e.$eval(i,{$results:a.results,$search:a.val}):a.results,a.open=!0})).finally((function(){a.spin=!1})))},a.select=function(r){a.ngModel.$setViewValue(r),a.ngModel.$setTouched(),o&&e.$eval(o,{}),t((function(){a.open=!1,a.matchActive=!0,delete a.val}),310)},a.onBlur=function(){t((function(){a.matchActive=!1,a.open=!1,delete a.val}),300)},a.onKeydown=function(t){27===t.keyCode?a.open=!1:38===t.keyCode&&a.curIdx>0?(a.curIdx--,e.$broadcast("ffSearch:changeOption")):40===t.keyCode&&a.curIdx+1<a.resultsFiltered.length?(a.curIdx++,e.$broadcast("ffSearch:changeOption")):13===t.keyCode&&a.open&&(t.preventDefault(),t.stopPropagation(),a.select(a.resultsFiltered[a.curIdx]))}}],compile:function(t,r){var n=this;r.$set("ffSpin","ffSearch.spin");var a=angular.element('<input type="text" ng-blur="ffSearch.onBlur()" ng-model="ffSearch.val" class="form-control ff-control ff-text">');return a.attr("ng-change","ffSearch.search(ffSearch.val)"),a.attr("ng-keydown","ffSearch.onKeydown($event)"),a.attr("placeholder",r.placeholder),r.$set("placeholder",null),t.prepend(a),function(t,r,a,l){e(r,null,n.priority)(t),l.ngModel=r.controller("ngModel")}}}}]).directive("ffSearchOptions",["$compile","$window","ffHelper",function(e,t,r){return{restrict:"E",require:"^ffSearch",priority:20,terminal:!0,compile:function(r,n){var a=this;n.$set("ngShow","ffSearch.open");var l=angular.element('<div class="ff-search-option" ng-repeat="$search in ffSearch.resultsFiltered" ng-click="ffSearch.select($search)"></div>');return l.attr("ng-class","{active: ffSearch.curIdx === $index}"),l.append(r.html()),r.empty().append(l),r.append('<ff-info class="ff-search-option" ng-hide="ffSearch.resultsFiltered.length">search result is empty</ff-info>'),function(r,n,l,i){e(n,null,a.priority)(r),r.$watch("ffSearch.open",(function(e){if(e){var r=n[0].getBoundingClientRect();n.toggleClass("ffso-above",r.bottom>t.innerHeight&&r.top-r.height-30>0)}})),r.$watchCollection("ffSearch.resultsFiltered",(function(e){n[0].scrollTop=0})),r.$on("ffSearch:changeOption",(function(){var e=n[0].querySelectorAll(".ff-search-option")[i.curIdx],t=e.offsetTop+e.offsetHeight,r=n[0].scrollTop+n[0].clientHeight;t>r?n[0].scrollTop+=t-r:e.offsetTop<n[0].scrollTop&&(n[0].scrollTop-=n[0].scrollTop-e.offsetTop)}))}}}}]).directive("ffSearchMatch",["$compile","ffHelper",function(e,t){return{restrict:"E",require:"^ffSearch",priority:20,terminal:!0,compile:function(t,r){var n=this;return r.$set("ngShow","ffSearch.ngModel.$modelValue"),r.$set("ngClass","{active: ffSearch.matchActive}"),function(t,r,a){e(r,null,n.priority)(t)}}}}])},X0qB:function(e,t,r){"use strict";r.r(t);r("w13K"),r("y89P");angular.module("flexForms.ffNumber",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffNumber",["$compile","$templateCache","ffHelper",function(e,t,r){return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffNumber"},controller:"ffControlController as ffControl",bindToController:{},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffText")),c=e(t.get("ffTextStatic"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return e}});var s=f.controller("ngModel");s.$parsers.push((function(e){if(e){var t=e.match(/^\s*-?(\d*)([,\.]?)\d+\s*$/i);if(t){var r=t[1],n=t[2];if(s.$setValidity("number",!0),n)return""===r?e.replace(n,"0."):"."===n?e:e.replace(n,".")}else s.$setValidity("number",!1)}return e}))}}}])},XLc8:function(e,t,r){"use strict";r.r(t);r("8cZI"),r("y89P");var n=r("6RpP"),a=r.n(n),l=r("03wM"),i=r.n(l),o=r("yCd9"),f=r.n(o),c=r("hsT8"),s=r.n(c),u=r("YtL8"),d=r.n(u),p=r("WSeP"),g=r.n(p);angular.module("mqs",[]).directive("mqs",["mqsClasses","helper",function(e,t){return{restrict:"A",link:function(t,r,n){n.$observe("mqs",(function(n){n=t.$eval(n);var a=e(n).join(" ");r.addClass(a)}))}}}]).factory("mqsBreakpoints",(function(){var e=[{id:"xs",width:null},{id:"sm",width:"480px"},{id:"md",width:"640px"},{id:"lg",width:"768px"},{id:"xl",width:"1024px"}];return g()(e).call(e,(function(e){var t=document.createElement("style");e.width&&t.setAttribute("media","(min-width: ".concat(e.width,")")),document.head.appendChild(t),e.sheet=t.sheet})),e})).factory("mqsClasses",["mqsBreakpoints",function(e){var t={};return function(r){var n,l;return d()(n=s()(l=f()(e).call(e,(function(e){var n,l=r[e.id];return l?f()(n=i()(l)).call(n,(function(r){var n,i,o,f,c=""+l[r],s=a()(n=a()(i="".concat(e.id,"_")).call(i,r,"_")).call(n,c.replace(/(?: |\.)/g,"_").replace(/%/g,"pct"));angular.isUndefined(t[s])&&(t[s]=e.sheet.cssRules.length,e.sheet.insertRule(a()(o=a()(f=".".concat(s," { ")).call(f,r,": ")).call(o,c," !important; }"),e.sheet.cssRules.length));return s})):null}))).call(l,(function(e){return!!e}))).call(n,(function(e,t){return a()(e).call(e,t)}),[])}}])},Y8yu:function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR"),r("U00V");var n=r("hsT8"),a=r.n(n),l=r("yCd9"),i=r.n(l),o=r("WSeP"),f=r.n(o),c=r("aqBv"),s=r.n(c),u=r("6RpP"),d=r.n(u),p=r("+l1P");angular.module("deskworks.recurringChargeAudit",["deskworks.helper","deskworks.RecurringChargeAudit",p.a.name]).directive("recurringChargeAudit",(function(){return{restrict:"E",scope:!0,templateUrl:"billing/recurring-billing/recurring-charge-audit.tpl.html",controller:"RecurringChargeAuditCtrl as $ctrl",bindToController:{priceListProducts:"<",reservationUnits:"<",recurringChargeId:"<"}}})).controller("RecurringChargeAuditCtrl",["state","dwAlerts","RecurringChargeAudit",function(e,t,r){var n=this;n.$onInit=function(){n.props=r.getProps(),n.centerId=e.getCurrentCenterId(),n.userId=e.getCurrentUserId(),n.offset=0,n.limit=20,n.entries=[],n.fetch()},n.fetch=function(){if(n.eof||n.fetching)return n.fetching;n.fetching=r.query(n.centerId,n.userId,n.recurringChargeId,n.offset,n.limit).catch((function(e){return t.error(e,"Failed to query audit log.")})).finally((function(){n.fetching=null})).then((function(e){var t;n.entries=d()(t=s()(n)).call(t,function(e){return f()(e).call(e,(function(e){var t,r;e.props||(e.props=i()(t=a()(r=n.props).call(r,(function(t){return e[t.id]}))).call(t,(function(t){return{name:t.name,old:a()(t)?a()(t).call(t,e[t.id].old,n):e[t.id].old,new:a()(t)?a()(t).call(t,e[t.id].new,n):e[t.id].new}})))})),e}(e)),n.offset+=e.length,n.eof=e.length<n.limit}))}}])},ZScd:function(e,t,r){"use strict";r.r(t);var n=r("T/jV"),a=r.n(n);r("QKBG");t.default=angular.module("flexForms.ffTip",[]).directive("ffTip",["$window","$timeout","helper",function(e,t,r){return{restrict:"EAC",compile:function(n,l){n.addClass("ff-tip"),n.addClass(l.tipType);var i=angular.element('<div class="ff-tip-inner"></div>').append(n.html());n.empty().append(i);var o=angular.element("<i></i>");return n.append(o),function(n,l,i){var o=angular.element(l[0].querySelector("i")),f="FF-TIP"===l[0].nodeName?l.parent():l;f=r.findParentElement(l,(function(e){return e.hasClass("ff-tip-trigger")}))||f;var c=i.tipHover,s=angular.element(l[0].querySelector(".rc-tip-scroller"));function u(){c&&n.$eval(c),l.hasClass("rc-marker-info")&&(l.css("margin-left",0),o.css("margin-left",0),t((function(){var t=l[0].getBoundingClientRect(),r=o[0].getBoundingClientRect(),n=a()(e.getComputedStyle(l[0]).marginLeft);n=Math.min(n-(t.right-e.innerWidth),0),l.css("margin-left",n+"px"),o.css("margin-left",Math.min(-n,(t.width-r.width)/2)+"px")}),100)),l.hasClass("ff-tip-right")?(l.css("margin-top",0),e.requestAnimationFrame((function(){return function t(r){var n,i=l[0].getBoundingClientRect(),f=document.querySelector("rc-header").getBoundingClientRect().bottom+5,c=document.documentElement.clientHeight-5;i.top<f||i.height>c-f?(n=a()(l.css("margin-top")),n+=f-i.top,l.css("margin-top",n+"px"),o.css("margin-top",-Math.min(n,i.height/2-12)+"px")):i.bottom>c&&(n=a()(l.css("margin-top")),n+=c-i.bottom,l.css("margin-top",n+"px"),o.css("margin-top",Math.min(-n,i.height/2-12)+"px"));s.css("max-height",c-f-40+"px"),r>0&&e.requestAnimationFrame((function(){return t(r-1)}))}(10)}))):(l.toggleClass("ff-tip-bottom",f[0].getBoundingClientRect().top<a()(e.getComputedStyle(l[0]).height)),l.css("margin-left",0),o.css("margin-left",0),e.requestAnimationFrame((function(){return function t(r){var n,i=l[0].getBoundingClientRect(),f=document.querySelector("main").getBoundingClientRect(),c=f.left+5,s=f.right-5;i.left<c?(n=a()(l.css("margin-left")),n+=c-i.left,l.css("margin-left",n+"px"),o.css("margin-left",-Math.min(n,i.width/2-12)+"px")):i.right>s&&(n=a()(l.css("margin-left")),n+=s-i.right,l.css("margin-left",n+"px"),o.css("margin-left",Math.min(-n,i.width/2-12)+"px"));r>0&&e.requestAnimationFrame((function(){return t(r-1)}))}(10)})))}f.addClass("ff-tip-trigger"),f.on("mouseenter",u),n.$on("$destroy",(function(){f.off("mouseenter",u)}))}}}}])},ZTZb:function(e,t){angular.module("flexForms.ffBtnBlockCancel",[]).directive("ffBtnBlockCancel",["$compile","$translate",function(e,t){"use strict";return{restrict:"A",require:"^ffBlock",priority:30,terminal:!0,compile:function(r,n){var a=this;return n.$set("ffClick","ffBlock.cancel()"),n.$set("sense","cancel"),n.$set("size","sm"),n.$set("ffBtnBlockCancel",null),n.$set("ngShow","ffBlock.editMode"),r.html(t.instant("GLOBAL.BTN_CANCEL")),function(t,r,n){e(r,null,a.priority)(t)}}}}])},aUi0:function(e,t,r){"use strict";r.r(t);var n=r("WSeP"),a=r.n(n),l=r("nbuU"),i=r.n(l);r("w7o6");angular.module("deskworks.dwAddCharges",["ngRoute","deskworks.helper","deskworks.state","deskworks.purchase.service"]).directive("dwAddCharges",(function(){return{restrict:"EAC",scope:!0,templateUrl:"billing/purchase/dw-add-charges.tpl.html",controller:"dwAddChargesCtrl as $ctrl",bindToController:{purchase:"<",updateInvoice:"&",userPriceList:"<"}}})).controller("dwAddChargesCtrl",["$scope","$filter","$route","$translate","dwAlerts","helper","state","purchaseService",function(e,t,r,n,l,o,f,c){var s=this;s.collapsed={},s.$onInit=function(){},s.$onChanges=function(){var e;(s.purchase&&s.purchase.options&&f.isLoggedAdmin()&&!i()(o).call(o,s.purchase.options.chargeTypes,"custom")&&s.purchase.options.chargeTypes.push({id:"custom",name:n.instant("PURCHASE.CHARGES.CUSTOM"),packages:[{name:n.instant("PURCHASE.CHARGES.CUSTOM"),price:"0.0"}]}),s.purchase&&s.purchase.options)&&a()(e=s.purchase.options.chargeTypes).call(e,(function(e){var t;a()(t=e.packages).call(t,(function(e){e.chargedAt=moment(),e.quantity=1,e.notes=""}))}))},s.createCharge=function(e,n){if(!o.pointFirstInvalid("#product"+n.id)){var a={chargedAt:t("date")(n.chargedAt,"yyyy-MM-dd"),notes:n.notes,quantity:n.quantity};return"custom"===e.id?(a.packageName=n.name,a.price=n.price,a.isTaxable=n.isTaxable):a.packageId=n.id,c.createCharge(f.getCurrentCenterId(),f.getCurrentUserId(),s.purchase.id,a,"custom"===e.id,!!r.current.params.productId,r.current.params.productId).catch((function(e){return l.error(e,"Failed to add charge.")})).then((function(){return s.updateInvoice()}))}}}])},aXSU:function(e,t){angular.module("flexForms.ffBtnBlockDelete",[]).directive("ffBtnBlockDelete",["$compile","$translate",function(e,t){"use strict";return{restrict:"A",require:"^ffBlock",priority:30,terminal:!0,compile:function(r,n){var a=this;return n.$set("ffClick","ffBlock.delete()"),n.$set("sense","delete"),n.$set("size","sm"),n.$set("ngHide",n.ngHide||"ffBlock.editMode"),n.$set("ffBtnBlockDelete",null),r.html(t.instant("GLOBAL.BTN_DELETE")),function(t,r,n){e(r,null,a.priority)(t)}}}}])},ahxZ:function(e,t,r){"use strict";r.r(t);r("w13K");var n=r("0zKI"),a=r.n(n);angular.module("flexForms.ffSection",["flexForms.ffBlock","flexForms.ffBtnSectionNew"]).directive("ffSection",(function(){return{restrict:"AC",scope:!0,controllerAs:"ffSection",controller:["$scope",function(e){this.deleteBlock=function(t){var r;a()(r=e.collection).call(r,t,1)},this.newBlock=function(){var t=e.$eval(e.newExp)||{};return e.collection.push(t),t}}],compile:function(e,t){var r=(t.ffSection||"").match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);return r&&(r=r[2],angular.element(e[0].querySelector("[ff-block]")).attr("ng-repeat",t.ffSection)),function(e,t,n,a){e.collection=e.$eval(r)||[],e.newExp=n.ffSectionNew}}}}))},az2E:function(e,t,r){"use strict";r.r(t);var n=r("T/jV"),a=r.n(n);angular.module("flexForms.ffDatepickerPopup",["flexForms.ffDatepicker"]).directive("ffDatepickerPopup",["$compile","$window","$timeout",function(e,t,r){return{restrict:"E",scope:!0,compile:function(n,l){return n.addClass("ff-datepicker-popup"),function(n,i,o){function f(){n.$apply("closeDP()")}i.parent().on("click",(function(e){n.openDP(e),n.$apply()})),n.closeDP=function(){var e=angular.element(document.getElementById("ff-dp-popup"));e.remove(e),t.removeEventListener("click",f),angular.element(document.querySelector("main")).css("padding-bottom","")},n.openDP=function(o){o&&(o.preventDefault(),o.stopPropagation()),n.closeDP(),t.addEventListener("click",f);var c=angular.element('<ff-datepicker id="ff-dp-popup" tabindex="0" ng-click="$event.stopPropagation()"></ff-datepicker>');c.attr("ff-model",l.ffModel),c.attr("date-max",l.dateMax),c=e(c)(n),i.append(c),c[0].focus(),r((function(){c[0].querySelector(".ff-dp-cal-body").addEventListener("click",(function(){n.$apply("closeDP()")}));var e=document.querySelector("main"),r=a()(t.getComputedStyle(e).paddingBottom);angular.element(e).css("padding-bottom",r+e.scrollHeight-e.clientHeight+50+"px")}))},n.$on("$destroy",(function(){i.parent().off("click"),n.closeDP()}))}}}}])},bn1d:function(e,t){angular.module("flexForms.ffBtnBlockSave",[]).directive("ffBtnBlockSave",["$compile","$translate",function(e,t){"use strict";return{restrict:"A",require:"^ffBlock",priority:30,terminal:!0,compile:function(r,n){var a=this;return n.$set("ffClick","ffBlock.save()"),n.$set("sense","ok"),n.$set("size","sm"),n.$set("type","submit"),n.$set("ffBtnBlockSave",null),n.$set("ffDisabled","ffBlockForm.$invalid || ffBlockForm.$pristine"),n.$set("ngShow","ffBlock.editMode"),r.html(t.instant("GLOBAL.BTN_OK")),function(t,r,n){e(r,null,a.priority)(t)}}}}])},dLm9:function(e,t){angular.module("flexForms.flexFormTitle",[]).directive("flexFormTitle",["$compile","ffHelper",function(e,t){"use strict";return{restrict:"EAC",transclude:"element",compile:function(e,t){return function(e,t,r,n,a){a((function(e,r){for(var n,a=0,l=t[0].parentNode;a<5&&l.parentNode&&!(n=l.querySelector(".panel-heading"));a++,l=l.parentNode);angular.element(n).append(angular.element('<div class="panel-title"></div>').append(e))}))}}}}])},dtrb:function(e,t){angular.module("flexForms.ffPanelHeader",[]).directive("ffPanelHeader",["helper",function(e){"use strict";return{restrict:"E",transclude:"element",link:function(t,r,n,a,l){l((function(t){var n=e.findParentElement(r,(function(e){return e.hasClass("ff-panel")}));n&&n.prepend(t.addClass("ff-panel-header"))}))}}}])},eyDD:function(e,t){angular.module("flexForms.ffRadio",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffRadio",["$compile","$templateCache","ffHelper",function(e,t,r){"use strict";return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffRadio"},controller:"ffControlController as ffControl",bindToController:{},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffRadio")),c=angular.element("<i></i>"),s=e(t.get("ffRadioStatic"))(n),u=l.ffLabel||a.html();u&&(u=angular.element('<span class="cb-label"></span>').append(u)),r.copyInnerAttrs(a,l,f),a.empty().append(f).append(c),e(f)(n),u&&(a.append(u),e(u)(n)),o.init({renderEdit:function(){s.detach(),a.prepend(f)},renderView:function(){f.detach(),a.prepend(s)},modelToStatic:function(e){return n.$eval(l.ffValue)===e}})}}}])},heZI:function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");t.default=angular.module("flexForms.ffDim",[]).directive("ffDim",(function(){return{restrict:"AC",priority:1,scope:!0,controller:"ffDimCtrl as ffDim",bindToController:{dim:"<?ffDim",ffClick:"@",ngClick:"@"},compile:function(e,t){var r={ffClick:t.ffClick,ngClick:t.ngClick};return t.ffClick&&t.$set("ffClick","ffDim.click($event)"),t.ngClick&&t.$set("ngClick","ffDim.click($event)"),function(e,t,n,a){n.$set("ffClick",r.ffClick),n.$set("ngClick",r.ngClick)}}}})).controller("ffDimCtrl",["$scope","$element",function(e,t){var r,n=this;n.$onChanges=function(){if(n.dim&&!t.hasClass("ff-dim"))return r||(r=angular.element('<div class="ff-dimmer ff-spin"></div>')).on("click",(function(e){e.stopPropagation()})),t.append(r),void t.addClass("ff-dim");!n.dim&&r&&(r.remove(),t.removeClass("ff-dim"),r=null)},n.click=function(t){if(!(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey)){var r=e.$eval(n.ffClick||n.ngClick,{$event:t});r&&r.finally&&(n.dim=!0,r.finally((function(){n.dim=!1})))}}}])},"i37/":function(e,t,r){"use strict";r.r(t);r("w13K"),r("y89P");angular.module("flexForms.ffPrice",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffPrice",["$compile","$templateCache","ffHelper",function(e,t,r){return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffPrice"},controller:"ffControlController as ffControl",bindToController:{},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffText")),c=e(t.get("ffTextStatic"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return e}});var s=f.controller("ngModel");s.$parsers.push((function(e){if(e){var t=e.match(/^\s*-?(\d*)([,\.]?)\d+\s*$/i);if(t){var r=t[1],n=t[2];if(s.$setValidity("price",!0),n)return""===r?e.replace(n,"0."):"."===n?e:e.replace(n,".")}else s.$setValidity("price",!1)}return e}))}}}])},iDs7:function(e,t,r){"use strict";r.r(t);r("w13K"),r("y89P"),r("JH9l");t.default=angular.module("flexForms.ngValidateAlert",[]).directive("ngValidateAlert",["$timeout","$translate","$filter",function(e,t,r){return{restrict:"A",require:["ngValidateAlert","ngModel"],scope:!1,controller:function(){},link:function(n,a,l,i){var o,f=i[0],c=i[1];o=(o=a.parent().attr("ng-form")?a.parent().parent().parent()[0].querySelector("ff-label"):a.parent().parent()[0].querySelector("ff-label"))?angular.element(o):a.parent();var s=angular.element(document.createElement("div")).addClass("ng-validate-alert").toggleClass("top","checkbox"===a.attr("type")||"ff-label"!==o[0].tagName.toLowerCase());function u(){e((function(){if(!c.$invalid||!c.$touched&&!c.$dirty&&!c.$error.ext)return s.removeClass("visible").html("");var e;try{e=n.$eval(l.ngValidateAlert)}catch(e){}e||(e={field:l.ngValidateAlert});var i=function(e){if(c.$error.required)return e.required||t.instant("GLOBAL.VALIDATION.REQUIRED",e);if(c.$error.date||c.$error.parse&&a.hasClass("ff-date"))return e.date||t.instant("GLOBAL.VALIDATION.DATE",e);if(c.$error.time||c.$error.parse&&a.hasClass("ff-time"))return(e.time||t.instant("GLOBAL.VALIDATION.TIME",e)).replace("Date","Time");if(c.$error.email)return e.email||t.instant("GLOBAL.VALIDATION.EMAIL",e);if(c.$error.url)return e.url||t.instant("GLOBAL.VALIDATION.URL",e);if(c.$error.minlength)return e.minlength||t.instant("GLOBAL.VALIDATION.MIN_LENGTH",{minLength:l.ngMinlength||l.minlength,field:e.field});if(c.$error.maxlength)return e.maxlength||t.instant("GLOBAL.VALIDATION.MAX_LENGTH",{maxlength:l.ngMaxlength||l.maxlength,field:e.field});if(c.$error.number)return e.number||t.instant("GLOBAL.VALIDATION.NUMBER",e);if(c.$error.price)return e.price||t.instant("GLOBAL.VALIDATION.PRICE",e);if(c.$error.pattern)return e.pattern;if(c.$error.match)return e.match||t.instant("GLOBAL.VALIDATION.MATCH",e);if(c.$error.cctype)return e.cctype||t.instant("GLOBAL.VALIDATION.CC_TYPE",f);if(c.$error.ccnumber)return e.ccnumber||t.instant("GLOBAL.VALIDATION.CC_NUMBER",e);if(c.$error.unique)return e.unique||t.instant("GLOBAL.VALIDATION.UNIQUE",e);if(c.$error.lte){var i=n.$eval(l.ngLte);return angular.isUndefined(i)&&(i=l.ngLte),e.lte||t.instant("GLOBAL.VALIDATION.LTE",{field:e.field,value:i})}if(c.$error.lt){var o=n.$eval(l.ngLt);return angular.isUndefined(o)&&(o=l.ngLt),e.lt||t.instant("GLOBAL.VALIDATION.LT",{field:e.field,value:o})}if(c.$error.gte){var s=n.$eval(l.ngGte);return angular.isUndefined(s)&&(s=l.ngGte),e.gte||t.instant("GLOBAL.VALIDATION.GTE",{field:e.field,value:s})}if(c.$error.gt){var u=n.$eval(l.ngGt);return angular.isUndefined(u)&&(u=l.ngGt),e.gt||t.instant("GLOBAL.VALIDATION.GT",{field:e.field,value:u})}if(c.$error.dateOrder||c.$error.timeOrder){if(angular.isString(e.late))return t.instant("GLOBAL.VALIDATION.DATE_BEFORE",{field:e.field,value:e.late});if(angular.isString(e.early))return t.instant("GLOBAL.VALIDATION.DATE_AFTER",{field:e.field,value:e.early})}if(c.$error.dateDiff){if(angular.isString(e.late))return t.instant("GLOBAL.VALIDATION.DATE_DIFF",{field:e.field,refField:e.late,value:r("hours")(l.ngDateDiff)});if(angular.isString(e.early))return t.instant("GLOBAL.VALIDATION.DATE_DIFF",{field:e.field,refField:e.early,value:r("hours")(l.ngDateDiff)})}if(c.$error.notContain)return e.notContain}(e);i&&s.addClass("visible").html(i)}),200)}o.append(s),a.on("focus",(function(){a.on("checkbox"===a.attr("type")?"change":"input",u),u()})),a.on("blur",(function(){a.off("checkbox"===a.attr("type")?"change":"input",u),s.removeClass("visible").html("")}))}}}])},ixwX:function(e,t,r){"use strict";r.r(t);var n=r("nbuU"),a=r.n(n),l=r("WSeP"),i=r.n(l),o=r("hsT8"),f=r.n(o);angular.module("deskworks.members.billingProfile.edit",["ngRoute","deskworks.routeHelper","deskworks.userProfile.service","deskworks.purchase.service","deskworks.setup.service"]).config(["$routeProvider",function(e){e.when("/billing-profiles",{templateUrl:"billing/billing-profile/billing-profile-edit.tpl.html",controller:"BillingProfileEditCtrl as vm",label:"Billing Profile",routeBranch:"billing-profiles",translations:["billing-profile","user-profile"],resolve:{reg:function(){},userProfile:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then((function(){return n.selectUser()})).then((function(){return a()})).then((function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to load billing profile.")}))}))}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch((function(t){return e.error(t,"Failed to load setup settings.")}))}]}}).when("/new-user/:userId/membership/billing-profile",{templateUrl:"billing/billing-profile/billing-profile-edit.tpl.html",controller:"BillingProfileEditCtrl",controllerAs:"vm",label:"Billing Profile",routeBranch:"new-user",translations:["billing-profile","user-profile"],resolve:{reg:function(){return{member:!1,selfRegistration:!1,step:2,stepCount:2}},userProfile:["dwAlerts","$route","state","userProfileService","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then((function(){return a.selectUser()})).then((function(){return l()})).then((function(){return n.get(r.getCurrentCenterId(),t.current.params.userId).catch((function(t){return e.error(t,"Failed to get user profile.")}))}))}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch((function(t){return e.error(t,"Failed to load setup settings.")}))}]}}).when("/new-member/:userId/membership/billing-profile",{templateUrl:"billing/billing-profile/billing-profile-edit.tpl.html",controller:"BillingProfileEditCtrl",controllerAs:"vm",label:"Billing Profile",routeBranch:"new-member",translations:["billing-profile","user-profile"],resolve:{reg:function(){return{member:!0,selfRegistration:!1,step:2,stepCount:3}},userProfile:["dwAlerts","$route","state","userProfileService","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then((function(){return a.selectUser()})).then((function(){return l()})).then((function(){return n.get(r.getCurrentCenterId(),t.current.params.userId).catch((function(t){return e.error(t,"Failed to load billing profile.")}))}))}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch((function(t){return e.error(t,"Failed to load setup settings.")}))}]}})}]).controller("BillingProfileEditCtrl",["$scope","$translate","$q","dwAlerts","state","helper","reg","userProfile","settings","userProfileService","purchaseService",function(e,t,r,n,l,o,c,s,u,d,p){var g,m,h=this;if(h.reg=c,h.userProfile=s,h.settings=u,u.creditCardTypes=f()(g=u.creditCardTypes).call(g,(function(e){return e.enable})),i()(m=h.userProfile.creditCards).call(m,(function(e){e.type=a()(o).call(o,u.creditCardTypes,e.type)||e.type||{}})),h.userProfile.creditCards=h.userProfile.creditCards||[],c&&!h.userProfile.creditCards.length&&!h.userProfile.eChecks.length){var b=d.creditCard.new(h.userProfile);b.type=u.creditCardTypes[0],h.userProfile.creditCards.push(b)}l.setPageTitle(t.instant("BILLING_PROFILE.PAGE_TITLE",{userName:h.userProfile.fullName})),h.next=function(e){if((e=e||{}).skipBillingProfile||!o.pointFirstInvalid("#billingProfile")){var t=r.when();return e.skipBillingProfile?"emailInvoice"!==h.userProfile.billingMethod&&"paperInvoice"!==h.userProfile.billingMethod||(t=d.saveBillingMethod(l.getCurrentCenterId(),h.userProfile)):t=d.saveBillingProfile(l.getCurrentCenterId(),h.userProfile),t.then((function(){if(!h.reg||h.reg.member)return p.createPurchase(l.getCurrentCenterId(),h.userProfile.id,!0,+l.getParam("productId"),l.getParam("attachedReservationUnitId"),l.getParam("membershipStartDate")).catch((function(e){return n.error(e,"Failed to create purchase.")})).then((function(e){return l.setPath(l.getPath()+"/purchase/"+e.id)}));h.complete=!0}))}},h.back=l.back,d.bindTestBillingGenerator(e,h.userProfile,h.reg)}])},jtK5:function(e,t,r){"use strict";r.r(t);r("D5nk");angular.module("flexForms.ffCountdown",[]).directive("ffCountdown",["$compile",function(e){return{restrict:"A",scope:!0,controller:"ffCountdownCtrl as $cnt",bindToController:{counter:"=ffCountdown"},compile:function(t){return t.addClass("ff-countdown"),function(t,r){angular.element(r[0].querySelector(".ff-countdown-time")).remove(),r.append(e('<span class="ff-countdown-time">[{{$cnt.counter}}]</span>')(t))}}}}]).controller("ffCountdownCtrl",["$scope","$timeout",function(e,t){var r,n=this;function a(){t.cancel(r),n.counter&&(r=t((function(){--n.counter||e.$emit("ffCountdown::expiry")}),1e3))}function l(){e.$apply((function(){n.counter=n.counterInitial,a()}))}e.$watch("$cnt.counter",a),n.$onInit=function(){n.counterInitial=n.counter,window.addEventListener("click",l),window.addEventListener("keydown",l)},n.$onDestroy=function(){window.removeEventListener("click",l),window.removeEventListener("keydown",l)}}])},kL89:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.purchasePaymentTypes",["deskworks.purchase.service","deskworks.optsPaymentBillingMethod","deskworks.optsRefundBillingMethod"]).factory("purchasePaymentTypes",["dwAlerts","purchaseService","optsPaymentBillingMethod","optsRefundBillingMethod",function(e,t,r,n){return{payment:{hasProcessingFee:!0,optsBillingMethod:r,header:"PURCHASE.PAYMENT.HEADER",negativeAmount:"PURCHASE.PAYMENT.AMOUNT.NEGATIVE",btnSubmit:"PURCHASE.PAYMENT.BTN_SUBMIT",btnRecord:"PURCHASE.PAYMENT.BTN_RECORD",hintSubmit:"PURCHASE.PAYMENT.HINT_SUBMIT",hintRecord:"PURCHASE.PAYMENT.HINT_RECORD",submit:function(){return t.createPayment.apply(t,arguments).catch((function(t){return e.error(t,"Failed to make payment.")}))}},deposit:{hasProcessingFee:!0,optsBillingMethod:r,header:"PURCHASE.DEPOSIT.HEADER",negativeAmount:"PURCHASE.PAYMENT.AMOUNT.NEGATIVE",btnSubmit:"PURCHASE.DEPOSIT.BTN_SUBMIT",btnRecord:"PURCHASE.DEPOSIT.BTN_RECORD",hintSubmit:"PURCHASE.DEPOSIT.HINT_SUBMIT",hintRecord:"PURCHASE.DEPOSIT.HINT_RECORD",submit:function(){return t.createDeposit.apply(t,arguments).catch((function(t){return e.error(t,"Failed to make deposit.")}))}},discount:{hasProcessingFee:!1,header:"PURCHASE.DISCOUNT.HEADER",negativeAmount:"PURCHASE.DISCOUNT.AMOUNT.NEGATIVE",btnSubmit:"PURCHASE.DISCOUNT.BTN_SUBMIT",btnRecord:"PURCHASE.DISCOUNT.BTN_RECORD",submit:function(){return t.createDiscount.apply(t,arguments).catch((function(t){return e.error(t,"Failed to make discount.")}))}},refund:{hasProcessingFee:!1,optsBillingMethod:n,header:"PURCHASE.REFUND.HEADER",negativeAmount:"PURCHASE.REFUND.AMOUNT.NEGATIVE",btnSubmit:"PURCHASE.REFUND.BTN_SUBMIT",btnRecord:"PURCHASE.REFUND.BTN_RECORD",hintSubmit:"PURCHASE.REFUND.HINT_SUBMIT",hintRecord:"PURCHASE.REFUND.HINT_RECORD",submit:function(){return t.createRefund.apply(t,arguments).catch((function(t){return e.error(t,"Failed to make refund.")}))}}}}])},lQn7:function(e,t,r){"use strict";r.r(t);r("8cZI");var n=r("yCd9"),a=r.n(n);angular.module("flexForms.ffCcNumber",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore","ccValidator"]).directive("ffCcNumber",["$compile","$templateCache","ffHelper","ccValidator","helper",function(e,t,r,n,l){return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffCcNumber"},controller:"ffControlController as ffControl",bindToController:{ccType:"=",ccTypes:"<"},link:function(i,o,f,c){var s=c.ffControl,u=angular.element(t.get("ffText")),d=e(t.get("ffTextStatic"))(i);r.copyInnerAttrs(o,f,u),o.empty().append(u),e(u)(i),s.init({renderEdit:function(){d.detach(),o.append(u)},renderView:function(){u.detach(),o.append(d)},modelToStatic:function(e){return e}});var p=u.controller("ngModel"),g=u.controller("ngValidateAlert");p.$parsers.push((function(e){var t;if(!e)return p.$setValidity("ccnumber",!0),p.$setValidity("cctype",!0),e;var r=n(e);return s.ccType=l.findByKeyValue(s.ccTypes,"id",r.card&&r.card.type),p.$setValidity("cctype",!r.card||!!s.ccType),p.$setValidity("ccnumber",r.isValid),g.ccTypeName=r.card&&r.card.niceType,g.ccTypesSupported=a()(t=s.ccTypes).call(t,(function(e){return e.name})).join(", "),e}))}}}])},laxG:function(e,t){e.exports='<div id=billingProfile ff-bulk-read-only> <h4 class=page-title>{{state.getPageTitle()}}</h4> <div class="ff-grid gutter-v"> <ff-panel ng-if=vm.complete> <span translate=BILLING_PROFILE.REGISTRATION.COMPLETE translate-values="{ userName: vm.userProfile.fullName }"></span> </ff-panel> <up-billing-method user=vm.userProfile reg=vm.reg settings=vm.settings ng-if=!vm.complete auto-save=!vm.reg new-payment-methods=!!vm.reg></up-billing-method> <up-credit-cards user-profile=vm.userProfile reg=vm.reg settings=vm.settings ng-if=!vm.complete></up-credit-cards> <up-e-checks user-profile=vm.userProfile reg=vm.reg ng-if="!vm.complete && vm.settings.enableEChecks"></up-e-checks> </div> <ff-btn-group class=buttons-bottom ng-if="vm.reg && !vm.complete"> <ff-btn sense=next ng-if="vm.reg && !vm.reg.selfRegistration" ff-click="vm.next({ skipBillingProfile: true })"> <span translate=BILLING_PROFILE.REGISTRATION.SKIP_BILLING></span> </ff-btn> <ff-btn sense=back ff-click=vm.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next ng-if=vm.reg ff-click=vm.next()><span translate=GLOBAL.BTN_NEXT></span></ff-btn> </ff-btn-group> </div> '},ljhc:function(e,t,r){"use strict";r.r(t);r("sIUV");t.default=angular.module("flexForms.ffImg",[]).directive("ffImg",["$compile","ffHelper",function(e,t){return{restrict:"E",scope:!0,controller:function(){},bindToController:{ffImgLoaded:"=?"},link:function(r,n,a,l){l.ffImgLoaded=!1;var i=angular.element("<img>");t.copyInnerAttrs(n,a,i),i.attr("ng-src-hq",null),n.empty().append(i),e(i)(r),a.$observe("ffSrc",(function(e){n.toggleClass("ff-img-placeholder",!e),a.imgPlaceholder&&!e&&(e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAQAAADTdEb+AAACHElEQVR42u3SMQ0AAAzDsJU/6aGo+tgQouSgIBJgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsjCUBxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFjsPeVaAS0/Qs6MAAAAAElFTkSuQmCC"),i.attr("src",e),angular.element(n[0].querySelector(".img-hq")).remove(),l.ffImgLoaded=!1,i.one("load",(function(){return r.$apply((function(){l.ffImgLoaded=!0}))}))})),a.$observe("ffSrcHq",(function(l){function o(){var i=angular.element(n[0].querySelector(".img-hq")||'<img class="img-hq img-hq-loading">');t.copyInnerAttrs(n,a,i),i.attr("src",l),i.attr("ng-src-hq",null),i.attr("ng-src",null),n.append(i),e(i)(r),i[0].onload=function(){i.removeClass("img-hq-loading")},i[0].onerror=function(){return i.remove()}}l&&(i[0].onload=o,i[0].onerror=o)}))}}}])},miii:function(e,t,r){"use strict";r.r(t);var n=r("WSeP"),a=r.n(n);angular.module("flexForms.validation.ngUnique",[]).directive("ngUnique",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",compile:function(e,t){return this.link},link:function(e,r,n,l){var i=e.$on("ngUnique:validate",(function(e){l.$validate()}));e.$on("$destroy",(function(){for(var t=e;t.$parent&&!t.hasOwnProperty("vm");)t=t.$parent;t.$broadcast("ngUnique:validate",r[0].name),i()})),e.$watch(n.ngModel,(function(n){t((function(){for(var t=e;t.$parent&&!t.hasOwnProperty("vm");)t=t.$parent;t.$broadcast("ngUnique:validate",r[0].name)}))})),l.$validators.unique=function(t,r){var l,i=e.$eval(n.ngUnique),o=0;return a()(l=i.array).call(l,(function(e){r&&r===e[i.prop]&&o++})),o<=1}}}}])},"pJ/X":function(e,t,r){"use strict";r.r(t);r("QKBG");t.default=angular.module("flexForms.ffHint",[]).directive("ffHint",(function(){return{restrict:"EAC",compile:function(e,t){e.addClass("ff-hint ff-tip-trigger");var r=angular.element('<ff-icon sense="info"></ff-icon>'),n=angular.element("<ff-tip></ff-tip>");return r.addClass("text-"+t.hintType||!1),r.attr("sense","warning"===t.hintType||"danger"===t.hintType?"warning":"info"),n.attr("tip-type",t.hintType),n.append(e.html()),e.empty().append(r.append(n)),function(e,t,r){}}}}))},qKzu:function(e,t){angular.module("flexForms.validation.ngMatch",[]).directive("ngMatch",(function(){"use strict";return{restrict:"A",require:"?ngModel",link:function(e,t,r,n){if(n&&r.ngMatch){var a=function(t){var a=e.$eval(r.ngMatch);return n.$setValidity("match",!a&&!t||t===a),t};n.$parsers.push(a),e.$watch(r.ngMatch,(function(){a(n.$viewValue)}))}}}}))},qPMi:function(e,t){e.exports='<form name=chargeForm class=recurring-charges id=recurringCharge ff-bulk-read-only> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <div class="ff-grid gutter-v gutter-h"> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.GENERAL.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.GENERAL.BILLING_FREQUENCY></req></ff-label> <ff-select ff-model=$ctrl.charge.billingFrequency ff-required=true name=billingFrequency ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.BILLING_FREQUENCY\' | translate}}" ff-options="freq.name for freq in $ctrl.billingFrequencies" ff-change=$ctrl.billingFrequencyChange()> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.GENERAL.PRODUCT></req></ff-label> <ff-select ff-model=$ctrl.charge.priceListProduct ff-required=true name=priceListProduct ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.PRODUCT\' | translate}}" ff-options="priceListProduct.productName for priceListProduct in $ctrl.billingFrequencyProducts[$ctrl.charge.billingFrequency.id]"> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.PRICE_LIST></span></ff-label> <ff-static>{{$ctrl.charge.priceListProduct.priceListName | nd}}</ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.DESCRIPTION></span></ff-label> <ff-text ff-model=$ctrl.charge.description name=description ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.DESCRIPTION\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.GENERAL.QUANTITY></req></ff-label> <ff-number name=quantity ff-model=$ctrl.charge.quantity ff-required=true ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.QUANTITY\' | translate}}"></ff-number> </label> <ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.INVOICE_SENT></span></ff-label> <ff-static ff-bind="::$ctrl.charge.invoiceSent | yesno" name=invoiceSent></ff-static> </ff-row> <label class=ff-row ng-if="!$ctrl.charge.id && $resolve.settings.prorateAtStart && $ctrl.charge.billingFrequency.id === \'monthly\'"> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.POST_PRO_RATION></span></ff-label> <ff-label> <ff-checkbox name=postProration ff-model=$ctrl.charge.postProration></ff-checkbox> </ff-label> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.GENERAL.ATTACHED_RES_UNIT></span> <ff-hint><span translate=RECURRING_BILLING.GENERAL.ATTACHED_RES_UNIT.HINT></span></ff-hint> </span> </ff-label> <ff-select ff-model=$ctrl.charge.attachedReservationUnitId name=attachedReservationUnit> <option translate=GLOBAL.NONE></option> <option ng-repeat="resUnit in $ctrl.reservationUnits" ng-value=resUnit.id>{{resUnit.name}}</option> </ff-select> </label> <ff-row ng-if="$ctrl.charge.billingFrequency.id === \'asNeeded\'"> <label flex="1 1 auto"> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.DATES.PASS_BALANCE></req></ff-label> <ff-number flex="1 1 1%" name=passBalance ff-model=$ctrl.charge.passBalance ff-required=true ff-validate-alert="{{\'RECURRING_BILLING.DATES.PASS_BALANCE\' | translate}}"></ff-number> </label> <ff-btn-group flex="0 0 auto" ng-if=$ctrl.charge.id style=z-index:3> <ff-btn sense=ok size=sm ff-click=$ctrl.saveCharge(true)> <span translate=RECURRING_BILLING.DATES.BTN_REFILL></span> </ff-btn> </ff-btn-group> </ff-row> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.DATES.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px" ff-required=true> <span translate=RECURRING_BILLING.DATES.LAST_BILL_DATE></span> </ff-label> <ff-date ff-model=$ctrl.charge.lastBillDate ff-required=true name=lastBillDate ff-validate-alert="{{\'RECURRING_BILLING.DATES.LAST_BILL_DATE\' | translate}}"></ff-date> </label> <label class=ff-row ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'"> <ff-label flex="0 0 126px" ff-required={{!$ctrl.isNextBillDateDisabled()}} ng-disabled=$ctrl.isNextBillDateDisabled()> <span translate=RECURRING_BILLING.DATES.NEXT_BILL_DATE></span> </ff-label> <ff-date ff-model=$ctrl.charge.nextBillDate ff-required=true name=nextBillDate ng-if=!$ctrl.isNextBillDateDisabled() ff-validate-alert="{{\'RECURRING_BILLING.DATES.NEXT_BILL_DATE\' | translate}}"></ff-date> <ff-static ff-disabled=true ng-if=$ctrl.isNextBillDateDisabled()>-</ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.DATES.ENTRY_DATE></span></ff-label> <ff-static name=entryDate ff-bind="$ctrl.charge.entryDate | date:\'mediumDate\'"></ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <req translate=RECURRING_BILLING.DATES.START_DATE></req> <ff-hint><span translate=RECURRING_BILLING.DATES.START_DATE.HINT></span></ff-hint> </span> </ff-label> <ff-date name=startDate ff-model=$ctrl.charge.startDate ff-required=true ff-validate-alert="{{\'RECURRING_BILLING.DATES.START_DATE\' | translate}}"></ff-date> </label> <label class=ff-row ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'"> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.DATES.NOTICE_DATE></span> <ff-hint><span translate=RECURRING_BILLING.DATES.NOTICE_DATE.HINT></span></ff-hint> </span> </ff-label> <ff-date ff-model=$ctrl.charge.noticeDate name=noticeDate ff-change=$ctrl.calcTerminationDate() ff-validate-alert="{{\'RECURRING_BILLING.DATES.NOTICE_DATE\' | translate}}"></ff-date> </label> <label class=ff-row ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'" ng-show=$ctrl.charge.noticeDate> <ff-label flex="0 0 126px"><small translate=RECURRING_BILLING.DATES.NOTICE_DATE.ADDED_BY></small></ff-label> <ff-static ff-bind="$ctrl.charge.noticeDateAddedBy || (state.getLoggedUser().firstName + \' \' + state.getLoggedUser().lastName)"></ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.DATES.NOTICE_PERIOD></span> <ff-hint><span translate=RECURRING_BILLING.DATES.NOTICE_PERIOD.HINT></span></ff-hint> </span> </ff-label> <ff-select name=noticePeriod ff-model=$ctrl.charge.noticePeriod ff-options="period.name for period in $ctrl.noticePeriods" ff-change=$ctrl.calcTerminationDate() ff-validate-alert="{{\'RECURRING_BILLING.DATES.NOTICE_PERIOD\' | translate}}"> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.DATES.TERMINATE></span> <ff-hint><span translate=RECURRING_BILLING.DATES.TERMINATE.HINT></span></ff-hint> </span> </ff-label> <ff-date name=terminate ff-model=$ctrl.charge.terminate ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'" ff-validate-alert="{{\'RECURRING_BILLING.DATES.TERMINATE\' | translate}}"></ff-date> <ff-select name=terminate ff-model=$ctrl.charge.terminate ng-if="$ctrl.charge.billingFrequency.id === \'asNeeded\'" ff-options="opt.name for opt in $ctrl.optsTerminate" ff-validate-alert="{{\'RECURRING_BILLING.DATES.TERMINATE\' | translate}}"></ff-select> </label> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.DISCOUNT.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.DISCOUNT.TYPE></span></ff-label> <ff-select ff-model=$ctrl.charge.discountType ff-required=true name=discountType ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.TYPE\' | translate}}" ff-options="type.name for type in $ctrl.discountTypes"> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px" ng-disabled=!$ctrl.charge.discountType.id> <req translate=RECURRING_BILLING.DISCOUNT.VALUE></req> </ff-label> <ff-text ff-model=$ctrl.charge.discountValue name=discountValue ff-required=$ctrl.charge.discountType.id ff-disabled=!$ctrl.charge.discountType.id ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.VALUE\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 0 126px" ng-disabled=!$ctrl.charge.discountType.id> <req translate=RECURRING_BILLING.DISCOUNT.MONTHS></req> </ff-label> <ff-select ff-model=$ctrl.charge.discountTrialOccurrences name=discountTrialOccurrences ff-required=$ctrl.charge.discountType.id ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.MONTHS\' | translate}}" ff-options="trial.name for trial in $ctrl.discountTrialOccurrences" ff-disabled=!$ctrl.charge.discountType.id> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px" ng-disabled=!$ctrl.charge.discountType.id> <req translate=RECURRING_BILLING.DISCOUNT.START_DATE></req> </ff-label> <ff-date ff-model=$ctrl.charge.discountStartDate ff-required=$ctrl.charge.discountType.id name=discountStartDate ff-disabled=!$ctrl.charge.discountType.id ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.START_DATE\' | translate}}"></ff-date> </label> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.STATUS_NOTES.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <req translate=RECURRING_BILLING.STATUS_NOTES.STATUS></req> <ff-hint ng-if="$ctrl.charge.status.id === \'active\'"> <span translate=RECURRING_BILLING.STATUS_NOTES.STATUS.HINT></span> </ff-hint> <ff-hint hint-type=warning ng-if="$ctrl.charge.existOutstandingUsages && ($ctrl.charge.status.id === \'deleted\' || $ctrl.charge.status.id === \'inactive\')"> <span translate=RECURRING_BILLING.STATUS_NOTES.STATUS.WARNING></span> </ff-hint> </span> </ff-label> <ff-select ff-model=$ctrl.charge.status ff-required=true name=status ff-options="status.name for status in $ctrl.chargeStatuses" ff-validate-alert="{{\'RECURRING_BILLING.STATUS_NOTES.STATUS\' | translate}}" ff-change=$ctrl.onChangeStatus()> </ff-select> </label> <ff-static ng-if="$ctrl.activeChargesCount < 2 && $ctrl.initialStatus.id === \'active\' && ($ctrl.charge.status.id === \'inactive\' || $ctrl.charge.status.id === \'deleted\')"> <ff-col> <label> <ff-checkbox name=makeMemberInactive ff-model=$ctrl.charge.makeMemberInactive> <span translate=RECURRING_BILLING.STATUS_NOTES.INACTIVATE_MEMBER></span> </ff-checkbox> </label> <label> <ff-checkbox name=makeCoMembersInactive ff-model=$ctrl.charge.makeCoMembersInactive> <span translate=RECURRING_BILLING.STATUS_NOTES.INACTIVATE_CO_MEMBERS></span> </ff-checkbox> </label> </ff-col> </ff-static> <label class=ff-row> <ff-label flex="{xs: \'0 0 60px\', lg: \'0 0 126px\'}"> <span translate=RECURRING_BILLING.STATUS_NOTES.NOTES class=ff-flex-start style=padding-top:.5rem></span> </ff-label> <ff-textarea style=min-height:108px ff-model=$ctrl.charge.notes name=notes></ff-textarea> </label> </ff-panel> <ff-btn-group> <ff-btn sense=save ff-click=$ctrl.saveCharge() ff-disabled=chargeForm.$pristine> <span translate=GLOBAL.BTN_SAVE></span> </ff-btn> <ff-btn sense=back ff-click=$ctrl.backToList()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=collapseBtn ng-if=$ctrl.charge.id ff-click="$ctrl.showAudit = !$ctrl.showAudit" ng-class="{ collapsed: !$ctrl.showAudit }"> <span translate=RECURRING_BILLING.AUDIT.BTN_COLLAPSE></span> </ff-btn> </ff-btn-group> </div> </form> <div ng-if=$ctrl.showAudit class=animate-collapse> <recurring-charge-audit price-list-products=$ctrl.charge.options.priceListProducts recurring-charge-id=$ctrl.charge.id reservation-units=$resolve.resUnits></recurring-charge-audit> </div> '},qThf:function(e,t,r){},qoyf:function(e,t){e.exports='<div class=purchase ff-bulk-read-only> <h4 class=page-title>{{state.getPageTitle()}}</h4> <div class=gutter-v> <ff-panel> <ff-panel-header ng-if=$ctrl.reg><span translate=GLOBAL.STEP_X_OF_Y translate-values=$ctrl.reg></span></ff-panel-header> <ff-header style=margin-bottom:.5rem><span translate=PURCHASE.LIST.ORDER_ID></span>: {{$ctrl.purchase.orderId}}</ff-header> <dw-invoice invoice=$ctrl.purchase center=$ctrl.center update-invoice=$ctrl.updateInvoice()></dw-invoice> </ff-panel> <form name=formConsolidate ng-if="$ctrl.consolidatePurchases.length > 0"> <ff-panel> <ff-header><span translate=PURCHASE.CONSOLIDATE></span></ff-header> <ff-row class=gutter-h-half> <ff-select flex="0 0 120px" name=purchaseToConsolidate ff-model=$ctrl.purchaseToConsolidate ff-options="purchase.name for purchase in $ctrl.consolidatePurchases"></ff-select> <ff-btn flex=none type=submit sense=merge size=sm ff-click=$ctrl.consolidatePurchase($ctrl.purchaseToConsolidate)> <span translate=PURCHASE.BTN_COMBINE></span> </ff-btn> </ff-row> </ff-panel> </form> <div ng-if=$ctrl.reg> <purchase-payment type=payment settings=$resolve.settings user=$resolve.user purchase-id=$ctrl.purchase.id update-invoice=$ctrl.updateInvoice() default-amount=$ctrl.purchase.balance></purchase-payment> </div> <div ng-if=!$ctrl.reg style=margin-bottom:.5rem> <div> <ff-btn sense=collapse ff-click="$ctrl.paymentCollapsed = !$ctrl.paymentCollapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !$ctrl.paymentCollapsed }"> <span translate=PURCHASE.PAYMENT.BTN_ADD></span> </ff-btn> <div ng-collapse=!$ctrl.paymentCollapsed> <purchase-payment type=payment settings=$resolve.settings user=$resolve.user purchase-id=$ctrl.purchase.id update-invoice=$ctrl.updateInvoice() default-amount=$ctrl.purchase.balance></purchase-payment> </div> </div> <div> <ff-btn sense=collapse ff-click="$ctrl.depositCollapsed = !$ctrl.depositCollapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !$ctrl.depositCollapsed }"> <span translate=PURCHASE.DEPOSIT.BTN_ADD></span> </ff-btn> <div ng-collapse=!$ctrl.depositCollapsed> <purchase-payment type=deposit settings=$resolve.settings user=$resolve.user purchase-id=$ctrl.purchase.id update-invoice=$ctrl.updateInvoice()></purchase-payment> </div> </div> <div> <ff-btn sense=collapse ff-click="$ctrl.discountCollapsed = !$ctrl.discountCollapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !$ctrl.discountCollapsed }"> <span translate=PURCHASE.DISCOUNT.BTN_ADD></span> </ff-btn> <div ng-collapse=!$ctrl.discountCollapsed> <purchase-payment type=discount settings=$resolve.settings user=$resolve.user purchase-id=$ctrl.purchase.id update-invoice=$ctrl.updateInvoice()></purchase-payment> </div> </div> <div> <ff-btn sense=collapse ff-click="$ctrl.refundCollapsed = !$ctrl.refundCollapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !$ctrl.refund.collapsed }"> <span translate=PURCHASE.REFUND.BTN_ADD></span> </ff-btn> <div ng-collapse=!$ctrl.refundCollapsed> <purchase-payment type=refund settings=$resolve.settings user=$resolve.user purchase-id=$ctrl.purchase.id update-invoice=$ctrl.updateInvoice()></purchase-payment> </div> </div> </div> <dw-add-charges purchase=$ctrl.purchase update-invoice=$ctrl.updateInvoice() user-price-list=$ctrl.userPriceList></dw-add-charges> <ff-btn-group class=buttons-bottom ng-if=!$ctrl.reg> <ff-btn sense=back ff-click=$ctrl.backToPurchases()><span translate=GLOBAL.BTN_BACK></span></ff-btn> </ff-btn-group> </div> </div> '},sIUV:function(e,t,r){},tQqS:function(e,t){angular.module("flexForms.ffPassword",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffPassword",["$compile","$templateCache","ffHelper",function(e,t,r){"use strict";return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffPassword"},controller:"ffControlController as ffControl",bindToController:{},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffPassword")),c=e(t.get("ffPasswordStatic"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return null}})}}}])},"u+IT":function(e,t,r){"use strict";r.r(t);var n=r("mxFF"),a=r.n(n);angular.module("flexForms.validation.ngGte",[]).directive("ngGte",(function(){return{restrict:"A",require:"?ngModel",link:function(e,t,r,n){n.$validators.gte=function(t,n){var l=a()(n),i=e.$eval(r.ngGte);return i=angular.isDefined(i)?a()(i):a()(r.ngGte),isNaN(l)||isNaN(i)||l>=i},e.$watch(r.ngGte,(function(){n.$validate()}))}}}))},"uVw+":function(e,t){e.exports='<form name=$ctrl.form novalidate> <ff-panel class=ff-bmargin> <ff-header><span translate={{$ctrl.types[$ctrl.type].header}}></span></ff-header> <div class="ff-grid gutter-h-half"> <label flex="{md: \'0 0 50%\'}" class=ff-row> <ff-label flex="0 0 104px"><span translate=PURCHASE.PAYMENT.POST_DATE></span></ff-label> <ff-static>{{$ctrl.postDate | date}}</ff-static> </label> <label flex="{md: \'0 0 50%\'}" class=ff-row> <ff-label flex="0 0 104px"><req translate=PURCHASE.PAYMENT.RECEIVED_DATE></req></ff-label> <ff-date name=receivedAt ff-model=$ctrl.payment.receivedAt ff-required=true ff-validate-alert="{{\'PURCHASE.PAYMENT.RECEIVED_DATE\' | translate}}" ff-disabled="$ctrl.billingMethod.id === \'cc\' || $ctrl.billingMethod.paymentMethodKey"></ff-date> </label> <label flex="{md: \'0 0 50%\'}" class=ff-row> <ff-label flex="0 0 104px"><req translate=PURCHASE.PAYMENT.AMOUNT></req></ff-label> <ff-price flex="0 0 70px" name=amount ff-model=$ctrl.payment.amount ff-required=true ff-gt=0 ff-validate-alert="{ field: (\'PURCHASE.PAYMENT.AMOUNT\' | translate), gt: ($ctrl.types[$ctrl.type].negativeAmount | translate) }"></ff-price> <ff-label> <span ng-if=$ctrl.getAmountWithFee()> + {{$ctrl.settings.paymentProcessingRates[$ctrl.billingMethod.id]}}% <span translate=PURCHASE.PAYMENT_PROCESSING_FEE></span> = <strong>{{$ctrl.getAmountWithFee() | ncurrency}}</strong> </span> </ff-label> </label> <label flex="{md: \'0 0 50%\'}" class=ff-row> <ff-label flex="0 0 104px"><span translate=PURCHASE.PAYMENT.NOTES></span></ff-label> <ff-text name=notes ff-model=$ctrl.payment.notes ff-maxlength=256></ff-text> </label> <div class=payment-submit flex="{md: \'0 0 50%\'}"> <div class=ff-grid> <ff-btn flex="{sm: \'none\'}" sense=save size=sm type=submit ff-click=$ctrl.createPayment() ng-if="$ctrl.billingMethod.paymentMethodKey || $ctrl.billingMethod.forceSubmit"> <span translate={{$ctrl.types[$ctrl.type].btnSubmit}}></span> </ff-btn> <ff-btn flex="{sm: \'none\'}" sense=save size=sm type=submit ff-click=$ctrl.createPayment() ng-if="!$ctrl.billingMethod.paymentMethodKey && !$ctrl.billingMethod.forceSubmit"> <span translate={{$ctrl.types[$ctrl.type].btnRecord}}></span> </ff-btn> <div class=ff-grid flex=auto ng-if=$ctrl.types[$ctrl.type].optsBillingMethod> <label flex="{sm: \'1 0 70%\'}" class=ff-row> <span flex=none translate=PURCHASE.PAYMENT.USING></span> <ff-select flex="1 1 auto" name=billingMethod ff-model=$ctrl.billingMethod ff-options="method.name for method in $ctrl.types[$ctrl.type].optsBillingMethod" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.BILLING_METHOD\' | translate}}"></ff-select> </label> <ff-select flex="{sm: \'0 0 30%\'}" name=paymentMethod ng-if=$ctrl.billingMethod.paymentMethodKey ff-model=$ctrl.payment.paymentMethodId ff-options="m.id as (m.number.replace(\'XXXX-XXXX-XXXX\', \'*\') || [m.bankRoutingNumber, m.bankAccountNumber].join(\' / \')) for m in $ctrl.user[$ctrl.billingMethod.paymentMethodKey]" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.PAYMENT_METHOD\' | translate}}"> </ff-select> </div> </div> </div> <div flex="{md: \'0 0 50%\'}" class=payment-hint ng-if="$ctrl.types[$ctrl.type].hintSubmit || $ctrl.types[$ctrl.type].hintRecord"> <ff-static> <span> <ff-icon sense=info></ff-icon> <span translate="{{$ctrl.types[$ctrl.type][$ctrl.billingMethod.paymentMethodKey || $ctrl.billingMethod.forceSubmit ? \'hintSubmit\' : \'hintRecord\']}}"></span> </span> </ff-static> </div> </div> </ff-panel> </form> '},uiPC:function(e,t,r){"use strict";r.r(t);var n=r("WSeP"),a=r.n(n),l=r("nbuU"),i=r.n(l);angular.module("deskworks.RecurringChargeAudit",["ngResource","datesDeserializer","deskworks.config","deskworks.billing.optsBillingFrequency","deskworks.billing.optsRecurringChargeStatus","deskworks.billing.optsNoticePeriod","deskworks.billing.optsDiscountType","deskworks.userProfile.optsMonthsOfDiscount","deskworks.billing.optsRecurringChargeTerminate","deskworks.billing.optsRenewalTerm","deskworks.billing.optsRenewalNoticePeriod"]).factory("RecurringChargeAudit",["$resource","$q","$timeout","$filter","$rootScope","$translate","deskworksConfig","helper","datesDeserializer","optsBillingFrequency","optsRecurringChargeStatus","optsNoticePeriod","optsDiscountType","optsMonthsOfDiscount","optsRecurringChargeTerminate","optsRenewalTerm","optsRenewalNoticePeriod",function(e,t,r,n,l,o,f,c,s,u,d,p,g,m,h,b,C){var v=function(e){return n("date")(e,"mediumDate")},I=function(e,t){return t=t||"name",angular.isString(e)?function(r,n){return(i()(c).call(c,n[e],r)||{})[t]||"-"}:function(r,n){return(i()(c).call(c,e,r)||{})[t]||"-"}},y=[{id:"priceListProductId",_name:"RECURRING_BILLING.GENERAL.PRODUCT",filter:I("priceListProducts","productName")},{id:"description",_name:"RECURRING_BILLING.GENERAL.DESCRIPTION"},{id:"quantity",_name:"RECURRING_BILLING.GENERAL.QUANTITY"},{id:"attachedReservationUnitId",_name:"RECURRING_BILLING.GENERAL.ATTACHED_RES_UNIT",filter:I("reservationUnits")},{id:"passBalance",_name:"RECURRING_BILLING.GENERAL.PASS_BALANCE"},{id:"invoiceSent",_name:"RECURRING_BILLING.GENERAL.INVOICE_SENT",filter:function(e){return n("yesno")(e)}},{id:"lastBillDate",_name:"RECURRING_BILLING.DATES.LAST_BILL_DATE",filter:v},{id:"nextBillDate",_name:"RECURRING_BILLING.DATES.NEXT_BILL_DATE",filter:v},{id:"startDate",_name:"RECURRING_BILLING.DATES.START_DATE",filter:v},{id:"noticeDate",_name:"RECURRING_BILLING.DATES.NOTICE_DATE",filter:v},{id:"noticePeriod",_name:"RECURRING_BILLING.DATES.NOTICE_PERIOD",filter:I(p)},{id:"terminate",_name:"RECURRING_BILLING.DATES.TERMINATE",filter:function(e,t){return(i()(c).call(c,h,e)||{}).name||v(e)||"-"}},{id:"renewalDate",_name:"RECURRING_BILLING.RENEWAL_DATE",filter:v},{id:"renewalTerm",_name:"RECURRING_BILLING.RENEWAL_TERM",filter:I(b)},{id:"renewalNoticePeriod",_name:"RECURRING_BILLING.RENEWAL_NOTICE_PERIOD",filter:I(C)},{id:"discountTypeId",_name:"RECURRING_BILLING.DISCOUNT.TYPE",filter:I(g)},{id:"discountValue",_name:"RECURRING_BILLING.DISCOUNT.VALUE"},{id:"discountTrialOccurrences",_name:"RECURRING_BILLING.DISCOUNT.MONTHS",filter:I(m)},{id:"discountStartDate",_name:"RECURRING_BILLING.DISCOUNT.START_DATE",filter:v},{id:"status",_name:"RECURRING_BILLING.STATUS_NOTES.STATUS",filter:I(d)},{id:"notes",_name:"RECURRING_BILLING.STATUS_NOTES.NOTES"}];function E(){a()(y).call(y,(function(e){e.name=o.instant(e._name)}))}E(),l.$on("$setTranslationsSuccess",E);var $=s(["createdAt","lastBillDate.old","lastBillDate.new","nextBillDate.old","nextBillDate.new","startDate.old","startDate.new","noticeDate.old","noticeDate.new","renewalDate.old","renewalDate.new","discountStartDate.old","discountStartDate.new","terminate.old","terminate.new"]),R=e(f.getApiAbsUrl("/centers/:centerId/user-profiles/:userId/recurring-charges/:recurringId/audit"),{},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,$]}});return{query:function(e,t,r,n,a){return R.query({centerId:e,userId:t,recurringId:r,offset:n,limit:a}).$promise},getProps:function(){return y}}}])},vjYL:function(e,t,r){"use strict";r.r(t),t.default=angular.module("flexForms.ffSpin",[]).directive("ffSpin",(function(){return{restrict:"A",priority:-1,link:function(e,t,r){e.$watch(r.ffSpin,(function(e){var r=t[0].querySelector("button");t.toggleClass("ff-spin",!!e),r&&angular.element(r).toggleClass("disabled",!!e)}))}}}))},vw9M:function(e,t,r){"use strict";r.r(t);var n=r("NOor"),a=r.n(n),l=r("0zKI"),i=r.n(l),o=r("WSeP"),f=r.n(o),c=(r("53Pq"),r("2/1H")),s=r("yjMN"),u=r("Vtxe");t.default=angular.module("deskworks.billing.purchase.edit",["ngRoute","deskworks.center.service","deskworks.purchase.service","deskworks.userProfile.service","deskworks.inventory.priceList.service","deskworks.routeHelper","deskworks.helper","deskworks.dwAddCharges",c.a.name,s.default.name,u.a.name]).config(["$routeProvider",function(e){e.when("/purchases/:purchaseId/edit",{templateUrl:"billing/purchase/purchase-edit.tpl.html",controller:"PurchaseEditCtrl as $ctrl",label:"Edit",routeBranch:"purchases",translations:["purchase","billing-profile"],resolve:{reg:function(){},purchase:["$route","dwAlerts","state","purchaseService","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then((function(){return a.selectUser()})).then((function(){return l()})).then((function(){return n.get(r.getCurrentCenterId(),r.getCurrentUserId(),e.current.params.purchaseId).catch((function(e){return t.error(e,"Failed to get purchase.")}))}))}],user:["dwAlerts","routeHelper","state","userProfileService","resolveTimezone",function(e,t,r,n,a){return t.auth().then((function(){return t.selectUser()})).then((function(){return a()})).then((function(){return n.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to get user profile.")}))}))}],center:["dwAlerts","centerService","state",function(e,t,r){return t.get(r.getCurrentCenterId(r.getCurrentCenterId())).catch((function(t){return e.error(t,"Failed to get center.")}))}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch((function(t){return e.error(t,"Failed to load setup settings.")}))}]}}),e.when("/new-member/:userId/membership/billing-profile/purchase/:purchaseId",{templateUrl:"billing/purchase/purchase-edit.tpl.html",controller:"PurchaseEditCtrl as $ctrl",label:"Purchase",routeBranch:"new-member",translations:["purchase","billing-profile"],resolve:{reg:function(){return{member:!0,selfRegistration:!1,step:3,stepCount:3}},purchase:["$route","dwAlerts","state","purchaseService","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then((function(){return a.selectUser()})).then((function(){return l()})).then((function(){return n.get(r.getCurrentCenterId(),e.current.params.userId,e.current.params.purchaseId).catch((function(e){return t.error(e,"Failed to get purchase.")}))}))}],user:["dwAlerts","routeHelper","state","userProfileService",function(e,t,r,n){return t.auth().then((function(){return t.selectUser()})).then((function(){return n.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch((function(t){return e.error(t,"Failed to get user profile.")}))}))}],center:["dwAlerts","centerService","state",function(e,t,r){return t.get(r.getCurrentCenterId(r.getCurrentCenterId())).catch((function(t){return e.error(t,"Failed to get center.")}))}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch((function(t){return e.error(t,"Failed to load setup settings.")}))}]}})}]).controller("PurchaseEditCtrl",["$scope","$filter","$translate","dwAlerts","state","center","purchase","helper","reg","user","settings","purchaseService","priceListService",function(e,t,r,n,l,o,c,s,u,d,p,g,m){var h=this;e.backPath="/purchases",e.$watch("state.getCurrentCenterId()",(function(t,r){t!==r&&l.setPath(e.backPath)})),h.center=o,h.reg=u,h.user=d,h.purchase=c,angular.isDefined(l.getParam("redirect"))&&(h.redirect=l.getParam("redirect")),l.setPageTitle(r.instant("PURCHASE.PAGE_TITLE",{userName:d.fullName,centerName:o.name})),d.membershipPriceListId&&m.getPricelist(l.getCurrentCenterId(),d.membershipPriceListId).then((function(e){h.userPriceList=e})),h.reg||g.getPurchases(l.getCurrentCenterId(),h.user.id).then((function(e){var t,r,n;(h.consolidatePurchases=[],f()(t=e.open).call(t,(function(e){e.id==h.purchase.id?r="open":h.consolidatePurchases.push({id:+e.id,name:e.id})})),"open"!==r)&&f()(n=e.credit).call(n,(function(e){e.id==h.purchase.id?r="credit":h.consolidatePurchases.push({id:+e.id,name:e.id})}));r||(h.consolidatePurchases=[]),h.consolidatePurchases.length>0&&(h.purchaseToConsolidate=h.consolidatePurchases[0])})),h.backToPurchases=function(){return l.setPath("/purchases")},h.consolidatePurchase=function(e){return g.consolidate(l.getCurrentCenterId(),l.getCurrentUserId(),h.purchase.id,e).catch((function(e){return n.error(e,"Failed to consolidate order with purchase.")})).then((function(){var t;return i()(t=h.consolidatePurchases).call(t,a()(s).call(s,h.consolidatePurchases,e.id),1),h.purchaseToConsolidate=h.consolidatePurchases[0],h.updateInvoice()}))},h.updateInvoice=function(){return g.get(l.getCurrentCenterId(),l.getCurrentUserId(),h.purchase.id).catch((function(e){return n.error(e,"Failed to update invoice.")})).then((function(e){h.purchase=e}))}}])},w7o6:function(e,t,r){},wLl8:function(e,t){angular.module("flexForms.ffText",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffText",["$compile","$templateCache","ffHelper",function(e,t,r){"use strict";return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffText"},controller:"ffControlController as ffControl",bindToController:{staticUrl:"<?ffStaticUrl"},link:function(n,a,l,i){var o=i.ffControl,f=angular.element(t.get("ffText")),c=e(t.get(angular.isDefined(o.staticUrl)?"ffTextStaticUrl":"ffTextStatic"))(n);r.copyInnerAttrs(a,l,f),a.empty().append(f),e(f)(n),o.init({renderEdit:function(){c.detach(),a.append(f)},renderView:function(){f.detach(),a.append(c)},modelToStatic:function(e){return e}})}}}])},wkyt:function(e,t,r){},xZAF:function(e,t,r){"use strict";r.r(t);r("CTko");angular.module("flexForms.ngCollapse",[]).directive("ngCollapse",["$compile","ffHelper",function(e,t){return{restrict:"A",compile:function(t,r){var n;return"false"!=r.lazyRendering&&(n=t.html(),t.empty()),t.addClass("ng-collapse ng-collapsed"),function(t,r,a,l){a.ngCollapse&&t.$watch((function(){return t.$eval(a.ngCollapse)}),(function(l){angular.isUndefined(l)&&(l=!1),"false"==a.lazyRendering||l||r.html()||(console.log("lazy"),r.append(e(n)(t))),r.toggleClass("ng-collapsed",l)}))}}}}])},xh25:function(e,t,r){"use strict";r.r(t);var n=r("+l1P");t.default=angular.module("deskworks.ffControlController",[n.a.name]).controller("ffControlController",["$scope","$element","$attrs","$timeout","ffControlCompileTemplates",function(e,t,r,n,a){var l,i,o,f,c=this;function s(){return!(c.ffBulkReadOnly&&!c.ffBulkReadOnly.editMode)&&(!c.ffBlock||c.ffBlock.editMode)}c.init=function(n){if(r.ffModel&&!c.ffReadOnlyIgnore){if(i=n.renderEdit,o=n.renderView,f=n.modelToStatic,!i||!o||!f)return console.error("ffControl.init: renderEdit/renderView/modelToStatic is not defined");l=e.$eval(r.ffModel),e.$on("ffControl::EditCancel",(function(){s()&&e.$eval(r.ffModel+" = initialValue",{initialValue:l})})),e.$watch(s,(function(n){angular.isUndefined(n)||(t.toggleClass("ff-read-only",!n),n?(l=e.$eval(r.ffModel),i()):o())})),e.$watch(r.ffModel,(function(e){c.staticValue=f(e)}))}},c.updateStatic=function(){c.staticValue=f(e.$eval(r.ffModel))}}]).factory("ffControlCompileTemplates",["$compile","$templateCache",function(e,t){return t.get("ffTextStatic")||e(t.get("flex-forms/controls/ff-control.tpl.html")),{}}])},xhVh:function(e,t){angular.module("flexForms.ffDatepicker",[]).directive("ffDatepicker",(function(){"use strict";return{restrict:"EAC",scope:!0,templateUrl:"flex-forms/ff-datepicker/ff-datepicker.tpl.html",controller:"ffDatepickerCtrl as $ctrl",bindToController:{ffModel:"=",dateMin:"<?",dateMax:"<?",dateDisabled:"&"},compile:function(e,t){return e.addClass("ff-datepicker"),function(e,t,r,n){}}}})).controller("ffDatepickerCtrl",["$scope","$filter","$locale",function(e,t,r){"use strict";var n=this;function a(e){var t=moment([e.year(),e.month(),1]),r=t.clone().endOf("month");n.days=[];for(var a=1,l=r.date();a<=l;a++)n.days.push({str:a,date:moment([t.year(),t.month(),a])});n.prevMonthDays=[],(l=moment([e.year(),e.month(),1]).subtract(1,"M").endOf("month").date())-(a=l-(t.day()-1))<0&&(a=l-6);for(var i=t.clone().subtract(1,"M");a<=l;a++)n.prevMonthDays.push({str:a,date:moment([i.year(),i.month(),a])});for(n.nextMonthDays=[],l=6-r.day(),n.days.length+n.prevMonthDays.length+l<42&&(l+=7),a=1;a<=l;a++)n.nextMonthDays.push({str:a,date:moment([t.year(),t.month(),a]).add(1,"M")});for(l=e.year(),n.years=[],a=0;a<5;a++)n.years.push(a-2+l)}n.$onInit=function(){n.today=moment(),n.weekDays=r.DATETIME_FORMATS.SHORTDAY,n.date=moment.isMoment(n.ffModel)?n.ffModel.clone():moment(),n.date.date(1),a(n.date),e.$watch("$ctrl.date",(function(e,t){moment.isMoment(e)&&(moment.isMoment(t)&&e.month()===t.month()&&e.year()===t.year()||a(n.date))}),!0)},n.checkDateDisabled=function(e){return e<n.dateMin||e>n.dateMax||n.dateDisabled({$date:e})},n.prevMonth=function(){n.date.subtract(1,"M")},n.nextMonth=function(){n.date.add(1,"M")},n.compareDates=function(e,t){return moment.isMoment(e)&&moment.isMoment(t)&&e.year()===t.year()&&e.month()===t.month()&&e.date()===t.date()},n.selectDay=function(e){n.ffModel=e.date.clone(),n.date=e.date.clone()},n.selectYear=function(e){n.date.year(e)}}])},ySf1:function(e,t,r){"use strict";r.r(t);r("w13K"),r("aZFp");var n=r("yCd9"),a=r.n(n),l=r("ipr/"),i=r.n(l);angular.module("flexForms.ffSelect",["deskworks.ffControlController","deskworks.ffReadOnlyIgnore"]).directive("ffSelect",["$compile","$templateCache","$timeout","ffHelper","helper",function(e,t,r,n,l){return{restrict:"E",scope:!0,require:{ffBulkReadOnly:"^?ffBulkReadOnly",ffReadOnlyIgnore:"^?ffReadOnlyIgnore",ffBlock:"^^?ffBlock",ffControl:"ffSelect"},controller:"ffControlController as ffControl",bindToController:{},compile:function(r,o){var f=r.html();return r.empty(),function(r,o,c,s){var u=angular.element(t.get("ffSelect")),d=e(t.get("ffTextStatic"))(r);u.append(f),n.copyInnerAttrs(o,c,u),o.empty().append(u),e(u)(r);var p=s.ffControl;if(p.init({renderEdit:function(){d.detach(),o.append(u)},renderView:function(){u.detach(),o.append(d)},modelToStatic:function(e){if(c.ffOptions){var t=c.ffOptions.match(/\S+(?=\s+as\s+)/i),n=c.ffOptions.match(/\S+(?=\s+for\s+)/i),a=c.ffOptions.match(/in\s+(\S+)/i);if(t&&t.length&&(t=(t=t[0].split("."))[t.length-1]),n&&n.length&&(n=(n=n[0].split("."))[n.length-1]),a&&a.length&&(a=a[1]),n&&a){t=t||"id",n=n||"id",a=r.$eval(a)||[];var o=l.findByKeyValue(a,t,angular.isObject(e)?e[t]:e);if(o)return o[n]}}var f=i()(Array.prototype).call(u[0].querySelectorAll("option"));if(f.length){var s=e;(angular.isUndefined(e)||null===e)&&(s=""),"boolean"==typeof e&&(s=""+s);var d=l.findByKeyValue(f,"value",s);if(d)return d.innerHTML}return e}}),c.ffOptions||p.ffReadOnlyIgnore||r.$watchCollection((function(){var e;return a()(e=i()(Array.prototype).call(u[0].querySelectorAll("option"))).call(e,(function(e){return e.value}))}),p.updateStatic),c.ffOptions&&!p.ffReadOnlyIgnore){var g=c.ffOptions.match(/in\s+(\S+)/i);g&&g.length&&(g=g[1]),r.$watchCollection(g,p.updateStatic)}}}}}])},yb0s:function(e,t){angular.module("deskworks.ffReadOnlyIgnore",[]).directive("ffReadOnlyIgnore",(function(){"use strict";return{restrict:"C",controller:function(){}}}))},yjMN:function(e,t,r){"use strict";r.r(t);var n=r("nbuU"),a=r.n(n),l=r("uVw+"),i=r.n(l),o=r("kL89");t.default=angular.module("deskworks.purchasePaymentDirective",[o.default.name]).directive("purchasePayment",(function(){return{template:i.a,restrict:"E",scope:!0,controller:"PurchasePaymentDirectiveCtrl as $ctrl",bindToController:{type:"@",settings:"<",user:"<",purchaseId:"<",defaultAmount:"<",updateInvoice:"&"}}})).controller("PurchasePaymentDirectiveCtrl",["$scope","state","helper","purchasePaymentTypes",function(e,t,r,n){var l=this;l.$onInit=function(){l.types=n,l.postDate=moment(),l.payment=l.payment||{},l.payment.receivedAt=moment(),l.types[l.type].optsBillingMethod&&e.$watch("$ctrl.billingMethod",(function(){var e;l.billingMethod||(l.billingMethod=a()(e=l.types[l.type].optsBillingMethod).call(e,(function(e){return e.id===l.user.billingMethod})),l.billingMethod=l.billingMethod||l.types[l.type].optsBillingMethod[0]);l.billingMethod.paymentMethodKey?(l.payment.receivedAt=moment(),l.user.billingMethod===l.billingMethod.id?l.payment.paymentMethodId=l.user.paymentMethodId:1===l.user[l.billingMethod.paymentMethodKey].length?l.payment.paymentMethodId=l.user[l.billingMethod.paymentMethodKey][0].id:delete l.payment.paymentMethodId):delete l.payment.paymentMethodId}))},l.$onChanges=function(){l.payment=l.payment||{},l.defaultAmount&&(l.payment.amount=l.defaultAmount)},l.createPayment=function(){if(!r.pointFirstInvalid("purchase-payment[type=".concat(l.type,"]")))return l.types[l.type].optsBillingMethod?l.payment.billingMethod=l.billingMethod.id:(delete l.payment.billingMethod,delete l.payment.paymentMethodId),l.types[l.type].submit(t.getCurrentCenterId(),t.getCurrentUserId(),l.purchaseId,l.payment).then((function(){return l.updateInvoice()}))},l.getAmountWithFee=function(){var e=l.settings.paymentProcessingRates[l.billingMethod&&l.billingMethod.id];if(!l.settings.enablePaymentProcessingCharges||!e||!l.types[l.type].hasProcessingFee)return 0;var t=r.round(e*+l.payment.amount/100);return+l.payment.amount+t}}])}}]);