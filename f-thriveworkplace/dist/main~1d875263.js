(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"/PF1":function(e,t,r){},"/X/Z":function(e,t,r){"use strict";r.r(t);r("it7j");var n=r("2/1H");t.default=angular.module("deskworks.billing.recurringCharge.edit",["deskworks.recurringCharge.service","deskworks.userProfile.service","deskworks.recurringCharge.service","deskworks.routeHelper","deskworks.recurringChargeAudit",n.a.name]).config(["$routeProvider",function(e){e.when("/recurring-charges/:recurringId/edit",{templateUrl:"billing/recurring-billing/recurring-edit.tpl.html",controller:"RecurringChargeEditCtrl as $ctrl",label:"Edit",routeBranch:"recurring-charges",translations:["recurring-billing"],resolve:{charge:["dwAlerts","$route","recurringChargeService","state","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then(function(){return a.selectUser()}).then(function(){return l()}).then(function(){return r.get(n.getCurrentCenterId(),n.getCurrentUserId(),t.current.params.recurringId).catch(function(t){return e.error(t,"Failed to get recurring charge.")})})}],charges:["dwAlerts","$route","recurringChargeService","state","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then(function(){return a.selectUser()}).then(function(){return l()}).then(function(){return r.query(n.getCurrentCenterId(),n.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to get recurring charge.")})})}],settings:["dwAlerts","setupService","state","routeHelper",function(e,t,r,n){return n.auth().then(function(){return t.getSetupSettings(r.getCurrentCenterId()).catch(function(t){return e.error(t,"Failed to get setup settings.")})})}],user:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then(function(){return n.selectUser()}).then(function(){return a()}).then(function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to get user profile.")})})}],resUnits:["dwAlerts","state","ReservationUnit",function(e,t,r){return r.query(t.getCurrentCenterId()).catch(function(t){return e.error(t,"Failed to query reservation units")})}]}})}]).controller("RecurringChargeEditCtrl",["$scope","$route","$translate","dwAlerts","recurringChargeService","userProfileService","ReservationUnit","charge","charges","settings","user","state","helper","optsBillingFrequency","optsRecurringChargeStatus","optsNoticePeriod","optsDiscountType","optsMonthsOfDiscount","optsRecurringChargeTerminate","resUnits","optsRenewalTerm","optsRenewalNoticePeriod",function(e,t,r,n,a,l,s,i,f,c,o,d,u,p,m,h,g,b,I,C,E,v){var A=this;e.backPath="/recurring-charges",e.$watch("state.getCurrentCenterId()",function(t,r){t!==r&&d.setPath(e.backPath)}),d.setPageTitle(r.instant("RECURRING_BILLING.PAGE_TITLE",{userName:o.fullName})),A.charge=i,A.initialStatus=A.charge.status,A.charge.startDate=A.charge.startDate||A.charge.entryDate,A.billingFrequencyProducts={},A.billingFrequencies=p,A.noticePeriods=h,A.discountTypes=g,A.discountTrialOccurrences=b,A.optsTerminate=I,A.optsRenewalTerm=E,A.optsRenewalNoticePeriod=v,A.chargeStatuses=m.filter(function(e){return"deleted"!==e.id||!d.isLoggedRole("coordinator")}),"new"===t.current.params.recurringId&&(A.chargeStatuses=m.slice(0,1)),i.options.priceListProducts.forEach(function(e){var t=u.find(A.billingFrequencies,e.billingFrequency);t&&(A.billingFrequencyProducts[t.id]=A.billingFrequencyProducts[t.id]||[],A.billingFrequencyProducts[t.id].push(e))}),A.reservationUnits=C.filter(function(e){return!e.attachedUserId||e.id==A.charge.attachedReservationUnitId}),A.activeChargesCount=f.filter(function(e){return"active"===e.status.id}).length,A.billingFrequencyChange=function(){A.charge.billingFrequency&&A.billingFrequencyProducts[A.charge.billingFrequency.id]&&(A.charge.priceListProduct=u.find(A.billingFrequencyProducts[A.charge.billingFrequency.id],A.charge.priceListProductId)),A.charge.terminate="asNeeded"===A.charge.billingFrequency.id?I[0]:"",A.charge.billingFrequency.months&&moment.isMoment(A.charge.lastBillDate)&&(A.charge.nextBillDate=A.charge.lastBillDate.clone().add(A.charge.billingFrequency.months,"M"),c.prorateAtStart&&"monthly"===A.charge.billingFrequency.id&&A.charge.nextBillDate.date(1))},A.charge.id||A.billingFrequencyChange(),A.onChangeStatus=function(){"active"===A.initialStatus.id&&"active"===A.charge.status.id&&("boolean"==typeof A.charge.makeMemberInactive&&delete A.charge.makeMemberInactive,"boolean"==typeof A.charge.makeCoMembersInactive&&delete A.charge.makeCoMembersInactive)},A.calcTerminationDate=function(){"asNeeded"!==A.charge.billingFrequency.id&&A.charge.noticeDate&&A.charge.noticePeriod&&(A.charge.terminate=A.charge.noticeDate.clone().add(A.charge.noticePeriod.id,"d"))},A.isNextBillDateDisabled=function(){return null===A.charge.nextBillDate&&moment.isMoment(A.charge.terminate)||moment.isMoment(A.charge.terminate)&&moment.isMoment(A.charge.nextBillDate)&&A.charge.terminate.isSameOrBefore(A.charge.nextBillDate,"date")},A.backToList=function(){return d.setPath("/recurring-charges")},A.saveCharge=function(e){if(!u.pointFirstInvalid("#recurringCharge")){var r,s={description:A.charge.description,priceListProductId:angular.isDefined(A.charge.priceListProduct)?A.charge.priceListProduct.id:null,startDate:A.charge.startDate,nextBillDate:A.isNextBillDateDisabled()?null:A.charge.nextBillDate,lastBillDate:A.charge.lastBillDate,noticeDate:A.charge.noticeDate,terminate:"asNeeded"===A.charge.billingFrequency.id?A.charge.terminate.id:A.charge.terminate,quantity:A.charge.quantity,noticePeriod:A.charge.noticePeriod&&A.charge.noticePeriod.id,status:angular.isDefined(A.charge.status)?A.charge.status.id:void 0,notes:A.charge.notes,attachedReservationUnitId:A.charge.attachedReservationUnitId?+A.charge.attachedReservationUnitId:null};return A.charge.discountType.id?(s.discountTypeId=A.charge.discountType.id,s.discountValue=A.charge.discountValue,A.charge.discountTrialOccurrences&&(s.discountTrialOccurrences=A.charge.discountTrialOccurrences.id),s.discountStartDate=A.charge.discountStartDate):s.discountTypeId=0,"asNeeded"===A.charge.billingFrequency.id&&(s.passBalance=+A.charge.passBalance,s.refill=e),"boolean"==typeof A.charge.makeMemberInactive&&(s.makeMemberInactive=A.charge.makeMemberInactive),"boolean"==typeof A.charge.makeCoMembersInactive&&(s.makeCoMembersInactive=A.charge.makeCoMembersInactive),"new"===t.current.params.recurringId?(s.postProration=!!A.charge.postProration,r=a.createCharge(d.getCurrentCenterId(),d.getCurrentUserId(),s)):r=a.updateCharge(d.getCurrentCenterId(),d.getCurrentUserId(),t.current.params.recurringId,s),r.then(function(){if(A.charge.makeMemberInactive&&l.resetCache(),!e)return d.setPath("/recurring-charges");t.reload()}).catch(function(e){return n.error(e,"Failed to save recurring charge.")})}}}])},"/uFl":function(e,t){e.exports='<ff-panel style="margin:1.5rem 0"> <ff-panel-header><span translate=RECURRING_BILLING.AUDIT.HEADER></span></ff-panel-header> <div ng-if="!$ctrl.entries.length && !$ctrl.fetching" class=animate-collapse> <span translate=GLOBAL.NONE></span> </div> <ff-header ng-if=$ctrl.entries.length class=animate-collapse> <ff-row> <cell><span translate=RECURRING_BILLING.AUDIT.PROPERTY></span></cell> <cell><span translate=RECURRING_BILLING.AUDIT.OLD_VALUE></span></cell> <cell><span translate=RECURRING_BILLING.AUDIT.NEW_VALUE></span></cell> </ff-row> </ff-header> <ff-col infinite-scroll=$ctrl.fetch() infinite-scroll-distance=2 infinite-scroll-container="\'.snap-content-scroller\'"> <div ng-repeat="entry in $ctrl.entries" class=animate-collapse> <ff-row> <ff-label class=standout><span> {{entry.createdAt | date:\'mediumDate\'}} <span nice-time=entry.createdAt></span> by {{entry.createdBy}} </span></ff-label> </ff-row> <ff-row ng-repeat="prop in entry.props"> <ff-static>{{prop.name}}</ff-static> <ff-static>{{prop.old | nd}}</ff-static> <ff-static>{{prop.new | nd}}</ff-static> </ff-row> </div> </ff-col> <ff-row ff-dim=true ng-if=$ctrl.fetching class=animate-collapse><ff-static></ff-static></ff-row> </ff-panel> '},"0+5B":function(e,t){angular.module("deskworks.formDesign.fdFieldTemplates",[]).factory("fdFieldTemplates",function(){"use strict";var e='ff-attr-id="fd-{{field.id}}" name="fd-{{field.id}}" ff-model="field.value"',t='<label class="ff-row"><ff-label class="ff-small-padding" flex="0 1 160px">{{field.name}}</ff-label>',r="</label>";return{text:t+"<ff-text "+e+' ff-validate-alert="{{field.name}}"></ff-text>'+r,textarea:t+"<ff-textarea "+e+' rowspan="2"></ff-textarea>'+r,date:t+"<ff-date "+e+' ff-validate-alert="{{field.name}}"></ff-date>'+r,url:t+"<ff-url "+e+' ff-validate-alert="{{field.name}}"></ff-url>'+r,email:t+"<ff-text "+e+" dw-email></ff-text>"+r,phone:t+"<ff-text "+e+" dw-phone></ff-text>"+r,number:t+"<ff-number "+e+' ff-validate-alert="{{field.name}}"></ff-number>'+r}})},"1A1g":function(e,t){angular.module("deskworks.billing",["deskworks.billing.purchase.list","deskworks.billing.purchase.edit","deskworks.billing.recurringCharge.list","deskworks.billing.recurringCharge.edit"])},"1XQE":function(e,t){angular.module("deskworks.dwControls").directive("dwSearchUser",["$compile","$q","$filter","ffHelper","state","userProfileService",function(e,t,r,n,a,l){"use strict";return{restrict:"A",priority:30,terminal:!0,template:'<ff-search-options><h6><span ng-bind-html="$search.highlighted.fullName"></span>{{$search.highlighted.company ? \',\' : \'\'}} <span ng-bind-html="$search.highlighted.company"></span> &lt;<span ng-bind-html="$search.highlighted.email"></span>&gt;</h6><div><span ng-repeat="match in $search.matches" class="match">{{match.name}}: <span ng-bind-html="(match.value || \'-\') + ($last ? \'\' : \', \')"></span></span></div></ff-search-options><ff-search-match ng-if="dwSearchUser.options !== \'activeNameOnly\'"><h6><span ng-bind="ffSearch.ngModel.$modelValue.fullName"></span>{{ffSearch.ngModel.$modelValue.company ? \',\' : \'\'}} <span ng-bind="ffSearch.ngModel.$modelValue.company"></span> &lt;<span ng-bind="ffSearch.ngModel.$modelValue.email"></span>&gt;</h6></ff-search-match><ff-search-match ng-if="dwSearchUser.options === \'activeNameOnly\'"><h6><span ng-bind="ffSearch.ngModel.$modelValue.fullName"></span></h6></ff-search-match>',controllerAs:"dwSearchUser",bindToController:{options:"@dwSearchUser"},controller:function(){this.filterUsers=function(e,t){return(e=e||[]).forEach(function(e){for(var n in e.weight=0,e.matches=[{name:"login",value:r("highlight")(e.login,t)}],e.highlighted={fullName:r("highlight")(e.fullName,t),company:r("highlight")(e.company,t),email:r("highlight")(e.email,t)},e){if(e.hasOwnProperty(n)&&angular.isString(e[n])&&0!==n.indexOf("$$"))if(e[n].toLowerCase().indexOf(t.toLowerCase())>=0&&(e.weight++,"fullName"!==n&&"company"!==n&&"email"!==n&&"login"!==n)){var a=n.split(/(?=[A-Z])/).join(" ").toLowerCase();e.matches.push({name:a,value:r("highlight")(e[n],t)})}}}),e.filter(function(e){return e.weight>0}).sort(function(e,t){return e.weight<t.weight?1:e.weight>t.weight?-1:0})},this.searchUser=function(e){return l.quickSearch(a.getCurrentCenterId(),e).catch(function(e){return $scope.showError(e,"Failed to quick search users.")})}},compile:function(t,r){var n=this;return r.$set("ffSearch","dwSearchUser.searchUser($search)"),r.$set("ffSearchFilter","dwSearchUser.filterUsers($results, $search)"),r.$set("placeholder","start typing to search users"),function(t,r,a){e(r,null,n.priority)(t)}}}}])},"1Xmc":function(e,t){angular.module("deskworks.dwControls").directive("dwLogin",["$compile","$translate",function(e,t){"use strict";return{restrict:"AC",priority:30,terminal:!0,compile:function(r,n){var a=this;n.$set("minlength",n.minlength||4),n.$set("maxlength",n.maxlength||256),n.$set("ffPattern",n.ffPattern||/^\w[\w\.\-_@]+$/),n.$set("placeholder",n.placeholder||"jdoe");var l=t.instant("GLOBAL.LOGIN"),s=t.instant("GLOBAL.LOGIN.INVALID_CHARS");return n.$set("ffValidateAlert",n.ffValidateAlert||"{ field: '"+l+"', pattern: '"+s+"' }"),function(t,r,n){e(r,null,a.priority)(t)}}}}])},"1e4I":function(e,t){e.exports='<div class=recurring-charges ff-bulk-read-only> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <ff-panel> <ff-header> <ff-row> <cell><span translate=RECURRING_BILLING.LIST.PRODUCT></span></cell> <cell flex="0 0 25%"><span translate=RECURRING_BILLING.GENERAL.DESCRIPTION></span></cell> <cell flex="0 0 17%" class=ff-right><span translate=RECURRING_BILLING.LIST.NEXT_BILLED></span></cell> <cell flex="0 0 17%" class=ff-center><span translate=RECURRING_BILLING.LIST.STATUS></span></cell> <cell flex="{xs: \'0 0 90px\', sm: \'0 0 120px\'}" class=ff-center><span translate=RECURRING_BILLING.LIST.USE_FOR_CHECK_IN_BILLING></span></cell> <ff-btn-group flex="0 0 auto" class="buttons-row zero-height"> <ff-btn sense=edit size=xs></ff-btn> </ff-btn-group> </ff-row> </ff-header> <ff-row ng-repeat="charge in $ctrl.charges"> <ff-static ff-bind=::charge.productName></ff-static> <ff-static flex="0 0 25%" ff-bind=::charge.description></ff-static> <ff-static flex="0 0 17%" class=ff-right ff-bind="::charge.nextBilled | date:\'mediumDate\'"></ff-static> <ff-static flex="0 0 17%" class=ff-center ff-bind=::charge.status.name></ff-static> <ff-label flex="{xs: \'0 0 90px\', sm: \'0 0 120px\'}" class=ff-center ff-dim=charge.$spin> <ff-checkbox ff-model=charge.useForCheckInBilling ff-value=true ff-change=$ctrl.saveUseForCheckInBilling(charge) ng-if=::charge.productHasPasses></ff-checkbox> <span ng-if=::!charge.productHasPasses translate=RECURRING_BILLING.LIST.NOT_AVAILABLE></span> </ff-label> <ff-btn-group flex="0 0 auto" class=buttons-row> <ff-btn sense=edit size=xs ff-click=$ctrl.edit(charge) title="{{\'GLOBAL.BTN_EDIT\' | translate}}"></ff-btn> </ff-btn-group> </ff-row> </ff-panel> <ff-btn-group class=buttons-bottom> <ff-btn sense=new ff-click=$ctrl.new()><span translate=RECURRING_BILLING.LIST.BTN_NEW></span></ff-btn> </ff-btn-group> </div> '},"1jxk":function(e,t){angular.module("deskworks.niceTime",[]).directive("niceTime",["$compile","$locale",function(e,t){"use strict";return{restrict:"A",compile:function(r,n){return function(r,a,l){var s;s=24===t.timeFormat?'<span ng-bind="'+n.niceTime+" | date: 'HH:mm'\"></span>":'<span ng-bind="'+n.niceTime+" | date: 'hh:mm'\"></span><sup ng-bind=\""+n.niceTime+" | date: 'a'\"></sup>",a.empty().append(e(s)(r))}}}}])},"4wUt":function(e,t){e.exports=' <label class=ff-row> <ff-label flex="0 0 116px"><req translate=BILLING_PROFILE.CREDIT_CARDS.NUMBER></req></ff-label> <ff-cc-number name=number ff-model=$ctrl.cc.number placeholder="4111 1111 1111 1111" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.CREDIT_CARDS.NUMBER\' | translate}}" cc-type=$ctrl.ccType cc-types=$ctrl.ccTypes></ff-cc-number> </label> <ff-row> <label flex="0 0 60%"> <ff-label flex="0 0 116px"><req translate=BILLING_PROFILE.CREDIT_CARDS.EXPIRY></req></ff-label> <ff-select name=expiryMonth ff-model=$ctrl.cc.expiryMonth ff-options="opt.name for opt in $ctrl.optsCCExpiryMonth" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.CREDIT_CARDS.EXPIRY.MONTH\' | translate}}"></ff-select> </label> <label flex="1 1 auto"> <ff-select name=expiryYear ff-model=$ctrl.cc.expiryYear ff-options="opt.name for opt in $ctrl.optsCCExpiryYear" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.CREDIT_CARDS.EXPIRY.YEAR\' | translate}}"></ff-select> </label> <label flex="0 0 76px" title="Security Code"> <ff-label flex="0 1 40px" class=ff-small><req translate=BILLING_PROFILE.CREDIT_CARDS.CVV></req></ff-label> <ff-text name=cvv ff-model=$ctrl.cc.ccv placeholder=123 ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.CREDIT_CARDS.CVV\' | translate}}"></ff-text> </label> </ff-row> <ff-row> <label flex="0 0 60%"> <ff-label flex="0 0 116px" class=nowrap><req translate=BILLING_PROFILE.CREDIT_CARDS.NAME_ON_CARD></req></ff-label> <ff-text name=firstName ff-model=$ctrl.cc.firstName placeholder=John ff-required=true ff-validate-alert="{{\'USER_PROFILE.PERSONAL_INFO.FIRST_NAME\' | translate}}"></ff-text> </label> <label flex="1 1 auto"> <ff-text name=lastName ff-model=$ctrl.cc.lastName placeholder=Doe ff-required=true ff-validate-alert="{{\'USER_PROFILE.PERSONAL_INFO.LAST_NAME\' | translate}}"></ff-text> </label> </ff-row> '},"53Pq":function(e,t,r){},"7RP1":function(e,t){angular.module("deskworks.centerSelector",["deskworks.state"]).directive("centerSelector",["$rootScope","state",function(e,t){"use strict";return{link:function(e,r,n){e.state=t},template:'<div class="center-selector" ng-if="state.getLoggedUserId()" ng-show="state.getUserCenters().length > 1"><label>Current Center<select class="form-control" ng-model="state.currentCenterId" ng-model-options="{getterSetter: true}" ng-options="center.id as center.name for center in state.getUserCenters()"></select></label></div>',restrict:"E"}}])},"8JIs":function(e,t){angular.module("deskworks.billing.purchase.list",["deskworks.center.service","deskworks.purchase.service","deskworks.routeHelper"]).config(["$routeProvider",function(e){"use strict";e.when("/purchases",{templateUrl:"billing/purchase/purchase-list.tpl.html",controller:"PurchaseListCtrl as vm",label:"Purchases",routeBranch:"purchases",translations:["purchase"],resolve:{purchases:["dwAlerts","purchaseService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then(function(){return n.selectUser()}).then(function(){return a()}).then(function(){return t.query(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to query purchases.")})})}],user:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then(function(){return n.selectUser()}).then(function(){return a()}).then(function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to get user profile.")})})}],center:["dwAlerts","centerService","state",function(e,t,r){return t.get(r.getCurrentCenterId(r.getCurrentCenterId())).catch(function(t){return e.error(t,"Failed to get center.")})}]}})}]).controller("PurchaseListCtrl",["$scope","$translate","dwAlerts","center","purchases","state","helper","user","purchaseService",function(e,t,r,n,a,l,s,i,f){"use strict";var c=this;c.center=n,c.purchases=a,c.types=[{id:"deposit",name:"PURCHASE.LIST.DEPOSIT.HEADER"},{id:"credit",name:"PURCHASE.LIST.CREDIT.HEADER"},{id:"open",name:"PURCHASE.LIST.OPEN.HEADER"},{id:"paid",name:"PURCHASE.LIST.PAID.HEADER"}],c.types.forEach(function(e){e.orders=c.purchases.filter(function(t){return t.type===e.id})}),l.setPageTitle(t.instant("PURCHASE.LIST.PAGE_TITLE",{userName:i.fullName,centerName:n.name})),c.editPurchase=function(e){return l.setPath("/purchases/"+e.id+"/edit")},c.viewPurchase=function(e){return l.setPath("/purchases/"+e.id+"/view")},c.createPurchase=function(){return f.createPurchase(l.getCurrentCenterId(),l.getCurrentUserId()).catch(function(e){return r.error(e,"Failed to create purchase")}).then(function(e){return l.setPath("/purchases/"+e.id+"/edit")})}}])},"9Jpt":function(e,t){angular.module("autoCacheFactory",[]).provider("autoCacheFactory",function(){"use strict";var e=this;return e.disableCache=!1,e.$get=function(){var t={};function r(r,n){var a=0,l={},s={id:r,expiryTime:n||0};return r in t||(t[r]={put:function(t,r){if(!angular.isUndefined(r)&&!e.disableCache&&s.expiryTime)return t in l||a++,l[t]={value:r,time:Date.now()},r},get:function(e){if(e in l&&Date.now()-l[e].time>1e3*s.expiryTime&&this.remove(e),e in l)return l[e].value},remove:function(e){e in l&&a--,delete l[e]},removeAll:function(){l={},a=0},destroy:function(){l=null,s=null,delete t[r]},info:function(){return angular.extend({},s,{size:a})}}),t[r]}return r.info=function(){var e={};return angular.forEach(t,function(t,r){e[r]=t.info()}),e},r.get=function(e){return t[e]},r.emptyAll=function(){angular.forEach(t,function(e){e.removeAll()})},r},e})},"9n+y":function(e,t){angular.module("deskworks.dwInvoice",["flexForms","deskworks.state","deskworks.helper","deskworks.dwInvoice.small"]).directive("dwInvoice",function(){"use strict";return{restrict:"E",scope:!0,templateUrl:"components/dw-invoice/dw-invoice.tpl.html",controller:"dwInvoiceCtrl as dwInvoice",bindToController:{center:"=*?",invoice:"=*",allowRemove:"@",updateInvoice:"&"},compile:function(e,t){return e.addClass("dw-invoice"),function(){}}}}).controller("dwInvoiceCtrl",["$scope","$element","$attrs","dwAlerts","state","purchaseService",function(e,t,r,n,a,l){"use strict";var s=this;s.removeItem=function(e){return l.deletePurchaseItem(a.getCurrentCenterId(),a.getCurrentUserId(),s.invoice.id,e.id).catch(function(e){return n.error(e,"Failed to remove purchase item.")}).then(function(e){return s.updateInvoice()})}}])},"A/9E":function(e,t){angular.module("deskworks.dwAlerts",["ngAnimate","ui.bootstrap.alert","deskworks.dwAlerts.service"]).component("dwAlerts",{template:'<uib-alert ng-repeat="alert in $ctrl.alerts" type="{{alert.type}}" class="dw-alert" close="$ctrl.close(alert)"><span ng-bind-html="alert.message"></span><span class="dw-alert-progress" ng-if="alert.timeout" ng-class="{ start: alert.start }"'+" ng-style=\"{ transition: 'all ' + alert.timeout / 1000 + 's linear', '-webkit-transition': 'all ' + alert.timeout / 1000 + 's linear' }\"></span></uib-alert>",controller:"dwAlertsController"}).controller("dwAlertsController",["$scope","$timeout","dwAlerts",function(e,t,r){"use strict";var n=this;n.alerts=r.$alerts,n.close=function(e){r.close(e)},e.$watchCollection("$ctrl.alerts",function(){n.alerts.forEach(function(e){e.timeout&&!e.start&&t(function(){e.start=!0})})})}])},BOw6:function(e,t){angular.module("deskworks.dwECheck",["flexForms","deskworks.helper"]).directive("dwECheck",["$compile","$templateCache","$timeout","helper","optsBankAccountHolderType","optsBankAccountType",function(e,t,r,n,a,l){"use strict";return{restrict:"A",scope:!0,templateUrl:"components/dw-e-check/dw-e-check.tpl.html",controllerAs:"dwEC",controller:["$scope","$element","$attrs",function(e,t,r){this.optsBankAccountHolderType=a,this.optsBankAccountType=l,this.check=e.$eval(r.dwECheck)}],compile:function(e,t){return function(e,t,r,n,a){}}}}])},Bvcx:function(e,t){angular.module("deskworks.checkIn.kbwAccessCard",[]).directive("kbwAccessCard",["$timeout",function(e){"use strict";var t,r,n="PACS"+String.fromCharCode(186),a=0;return{restrict:"EAC",scope:!0,compile:function(l,s){return function(l,s,i,f,c){function o(s){16!==s.which&&(e.cancel(r),r=e(function(){t=null,a=0},1e3),angular.isString(t)?13===s.which?(l.$emit("kbw::accessCard",t),l.$apply(),t=null):t+=String.fromCharCode(s.which):String.fromCharCode(s.which)===n.charAt(a)?++a===n.length&&(t="",a=0):a=0)}document.addEventListener("keydown",o),l.$on("$destroy",function(){document.removeEventListener("keydown",o)})}}}}])},DyWX:function(e,t,r){var n={"./billing/billing-profile/billing-profile-edit.tpl.html":"laxG","./billing/purchase/dw-add-charges.tpl.html":"G7f6","./billing/purchase/purchase-edit.tpl.html":"qoyf","./billing/purchase/purchase-list.tpl.html":"Li7w","./billing/recurring-billing/recurring-charge-audit.tpl.html":"/uFl","./billing/recurring-billing/recurring-edit.tpl.html":"qPMi","./billing/recurring-billing/recurring-list.tpl.html":"1e4I","./check-in/check-in.tpl.html":"u/SX","./components/dw-address/dw-address.tpl.html":"YOQ5","./components/dw-credit-card/dw-credit-card.tpl.html":"4wUt","./components/dw-e-check/dw-e-check.tpl.html":"vt7a","./components/dw-invoice/dw-invoice-small.tpl.html":"dUjI","./components/dw-invoice/dw-invoice.tpl.html":"Yi3N","./components/dw-modal/dw-modal.tpl.html":"wnB+","./components/forbid-staff/forbid-staff.tpl.html":"fdHq","./components/membership-filter/membership-filter.tpl.html":"KeGr","./flex-forms/controls/ff-control.tpl.html":"8PDb","./flex-forms/ff-datepicker/ff-datepicker.tpl.html":"HMLR","./members/our-members/our-member-modal.tpl.html":"gB/y","./members/our-members/our-members.tpl.html":"Ht9o","./members/user-profile/billing-sections/up-credit-cards.tpl.html":"l7tb","./members/user-profile/billing-sections/up-e-checks.tpl.html":"Ntds","./members/user-profile/sections/up-access-codes.tpl.html":"aj6+","./members/user-profile/sections/up-addresses.tpl.html":"auvQ","./members/user-profile/sections/up-co-members.tpl.html":"Q9OX","./members/user-profile/sections/up-comments.tpl.html":"WZXA","./members/user-profile/sections/up-custom-fields.tpl.html":"jtA9","./members/user-profile/sections/up-documents.tpl.html":"SHcK","./members/user-profile/sections/up-lead-source.tpl.html":"aT6e","./members/user-profile/sections/up-login-info.tpl.html":"sLGz","./members/user-profile/sections/up-mailboxes.tpl.html":"MHBY","./members/user-profile/sections/up-membership.tpl.html":"cdCP","./members/user-profile/sections/up-personal-info.tpl.html":"80Eh","./members/user-profile/sections/up-phones.tpl.html":"zcfi","./members/user-profile/sections/up-photo.tpl.html":"FZlk","./members/user-profile/sections/up-printer-codes.tpl.html":"NQ3A","./members/user-profile/sections/up-shareable.tpl.html":"3xdx","./members/user-profile/sections/up-system-info.tpl.html":"SxCY","./members/user-profile/sections/up-terms-of-service.tpl.html":"e8sX","./members/user-profile/user-profile.tpl.html":"OdV3","./members/user-search/user-search.tpl.html":"L3g9","./sidebar/sidebar.tpl.html":"f+zm","./sign-in/dw-sign-in.tpl.html":"Mm7d","./sign-in/sign-in.tpl.html":"EyXH"};function a(e){var t=l(e);return r(t)}function l(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=l,e.exports=a,a.id="DyWX"},EcSL:function(e,t){angular.module("deskworks.dwAlerts.service",[]).factory("dwAlerts",["$rootScope","$timeout","$q",function(e,t,r){"use strict";var n={$alerts:[],error:function(e,t){t||(t=e,e=null),e&&e.data&&(e.data.error||e.data.message)&&(t=e.data.error||e.data.message);var n={id:Date.now(),type:"danger",message:t||"Sorry, error occurred. Please try again a bit later.",timeout:1e4};return this.showAlert(n),r.reject(e||t)},info:function(e){var t={id:Date.now(),type:"info",message:e,timeout:6e3};this.showAlert(t)},close:function(e){var t=this.$alerts.indexOf(e);t>=0&&this.$alerts.splice(t,1)},showAlert:function(e){var r=this;r.$alerts.unshift(e),e.timeout&&t(function(){r.close(e)},e.timeout)}};return e.showError=function(e,t){return n.error(e,t)},e.closeError=function(e){n.$alerts.splice(e,1)},e.closeAllErrors=function(){n.$alerts.splice(0,n.$alerts.length)},n}])},G7f6:function(e,t){e.exports='<div> <div class="em ff-bmargin"> <span translate=PURCHASE.CHARGES.HEADER></span><span ng-if=$ctrl.userPriceList>, <span translate=PURCHASE.USER_PRICE_LIST></span>: <span ng-bind="$ctrl.userPriceList.name || \'-\'"></span> </span> </div> <div id=chargeType-{{chargeType.id}} ng-repeat="chargeType in $ctrl.purchase.options.chargeTypes"> <ff-btn sense=collapse ff-click="$ctrl.collapsed[chargeType.id] = !$ctrl.collapsed[chargeType.id]" ng-class="{ collapsed: !$ctrl.collapsed[chargeType.id] }" class=dw-add-charges-collapse-btn>{{chargeType.name}}</ff-btn> <div ng-collapse=!$ctrl.collapsed[chargeType.id]> <ff-panel class=ff-bmargin> <ng-form name=formProduct id=product{{product.id}} ng-repeat="product in chargeType.packages"> <ff-panel ff-label={{product.name}} ff-label-ext="{{product.price | ncurrency}}" class=ff-bmargin> <ff-panel-header> {{product.name}} - {{product.price | ncurrency}} </ff-panel-header> <div class="ff-grid gutter-h-half"> <label flex="{md: \'0 0 50%\'}" class=ff-row ng-if="chargeType.id === \'custom\'"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.NAME></span></ff-label> <ff-text name=name ff-model=product.name ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.NAME\' | translate}}"></ff-text> </label> <ff-row flex="{md: \'0 0 50%\'}" ng-if="chargeType.id === \'custom\'"> <label flex="0 1 160px"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.PRICE></span></ff-label> <ff-price name=price ff-model=product.price ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.PRICE\' | translate}}"></ff-price> </label> <label flex="0 0 auto"> <ff-checkbox flex="0 0 auto" name=isTaxable ff-model=product.isTaxable>Is Taxable</ff-checkbox> </label> </ff-row> <ff-row flex="{md: \'0 0 50%\'}"> <label flex="0 0 34%"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.QUANTITY></span></ff-label> <ff-number name=qty ff-model=product.quantity ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.QUANTITY\' | translate}}"></ff-number> </label> <label flex="0 0 66%"> <ff-label flex="0 0 76px" ff-required=true><span translate=PURCHASE.CHARGES.USE_DATE></span></ff-label> <ff-date name=chargedAt ff-model=product.chargedAt ff-required=true ff-validate-alert="{{\'PURCHASE.CHARGES.USE_DATE\' | translate}}"></ff-date> </label> </ff-row> <ff-row flex="{md: \'0 0 50%\'}"> <label flex="1 1 auto"> <ff-label flex="0 0 76px"><span translate=PURCHASE.CHARGES.NOTES></span></ff-label> <ff-text name=notes ff-model=product.notes></ff-text> </label> <ff-btn-group flex=none> <ff-btn sense=save size=sm type=submit ff-click="$ctrl.createCharge(chargeType, product)"> <span translate=PURCHASE.CHARGES.BTN_ADD></span> </ff-btn> </ff-btn-group> </ff-row> </div> </ff-panel> </ng-form> </ff-panel> </div> </div> </div> '},IILE:function(e,t){angular.module("keese",[]).factory("keese",function(){"use strict";var e="0123456789?@ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t=e.length,r="~",n=function(){for(var t={},r=0;r<e.length;r++)t[e[r]]=r;return t}();return{generate:function(e,t,r){return r?l(e,t,r):a(e,t)}};function a(e,t){return e?t?s(e,t):((r=f(e)).digits=r.digits.substr(0,r.order_length+1),i(r,f("1"))):t?s("0",t):"1";var r}function l(e,t,r){var n=new Array(r);if(r>0)if(t)!function e(t,r,l,s){var i=Math.floor((l+s)/2);var f=a(t,r);n[i]=f;l<i&&e(t,f,l,i);i+1<s&&e(f,r,i+1,s)}(e,t,0,r);else for(var l=0;l<r;l++){var s=keese(e,null);n[l]=s,e=s}return n}function s(r,a){if(r>a)throw new Error("assertion failed: "+JSON.stringify(r)+" < "+JSON.stringify(a));var l=f(r),s=f(a);o(l,s);for(var d=0,u=Math.max(l.digits.length,s.digits.length),p=0;p<u||d>0;p++){var m=n[l.digits[p]]||0,h=d+(n[s.digits[p]]||0);if(m!==h){if(m!==h-1){for(var g=Math.floor((h-m)/2),b="",I=0;I<p;I++)b+="0";b+=e[g];var C=f(c(l.order_length,b));return l.digits=l.digits.substr(0,p+1),i(l,C)}d=t}}throw new Error}function i(r,a){o(r,a);for(var l="",s=r.order_length,i=0,f=Math.max(r.digits.length,a.digits.length)-1;f>=0;f--)i+=n[r.digits[f]]||0,i+=n[a.digits[f]]||0,l=e[i%t]+l,i=Math.floor(i/t);for(;i>0;)l=e[i%t]+l,i=Math.floor(i/t),s++;return c(s,l)}function f(e){var t=e.lastIndexOf(r)+1;return{order_length:t,digits:e.substr(t)}}function c(e,t){for(;e>0&&"0"==t.charAt(0);)t=t.substr(1),e--;for(var n="",a=0;a<e;a++)n+=r;return n+t}function o(e,t){d(e,t.order_length),d(t,e.order_length)}function d(e,t){for(;e.order_length<t;)e.digits="0"+e.digits,e.order_length++}})},JqLc:function(e,t){angular.module("deskworks.dwDateTime",["flexForms"]).directive("dwDateTime",function(){"use strict";return{restrict:"E",scope:!0,compile:function(e,t){var r=t.ngDisabled?' ng-disabled="'+t.ngDisabled+'"':"",n=t.ngDisabled?' ff-disabled="'+t.ngDisabled+'"':"",a=t.ffRequired?' ff-required="'+t.ffRequired+'"':"",l=t.ffDateOrder?' ff-date-order="'+t.ffDateOrder+'"':"",s=t.ffDateDiff?' ff-date-diff="'+t.ffDateDiff+'"':"",i=t.ffValidateAlert?' ff-validate-alert="'+t.ffValidateAlert+'"':"",f=t.labelClass?' class="'+t.labelClass+'"':"",c='<ff-row><label flex="1 1 auto"><ff-label flex="'+t.labelFlex+'"'+a+r+f+">"+t.ffLabel+"</ff-label><ff-row><ff-date name=\"{{'"+(t.name||t.ffModel)+'date\'}}" flex="1 2 150px" ff-model="inner.date"'+a+n+l+s+i+"></ff-date><ff-time name=\"{{'"+(t.name||t.ffModel)+'time\'}}" flex="'+(e.hasClass("ff-small")?"0 0 90px":"1 3 150px")+'" ff-model="inner.time"'+a+n+l+s+i+"></ff-time></ff-row></label></ff-row>";return e.append(c),this.link},link:function(e,t,r){e.inner={};var n=e.$eval(r.ffModel);function a(t,r){!moment.isMoment(t)||moment.isMoment(r)&&t.isSame(r)||(e.inner.date=t.clone().second(0).millisecond(0),e.inner.time=t.clone().second(0).millisecond(0))}n instanceof moment&&a(n),e.$watch(r.ffModel,a),e.$watch("inner.date",function(t,n){var a=e.$eval(r.ffModel);moment.isMoment(t)&&moment.isMoment(a)&&(moment.isMoment(n)&&t.isSame(n)||(e.newDate=t.clone().hour(a.hour()).minute(a.minute()),e.$eval(r.ffModel+" = newDate")))}),e.$watch("inner.time",function(t,n){var a=e.$eval(r.ffModel);moment.isMoment(t)&&moment.isMoment(a)&&(moment.isMoment(n)&&t.isSame(n)||(e.newDate=a.clone().hour(t.hour()).minute(t.minute()),e.$eval(r.ffModel+" = newDate")))})}}})},JvnO:function(e,t,r){"use strict";r.r(t);r("RF9M");angular.module("dnd",["dndLists","keese"]).factory("dnd",["keese",function(e){return{move:function(t,r,n,a){var l=t[r];n&&n.splice(a,0,l);t===n&&a<=r&&r++;if(t.splice(r,1),n){var s=n.indexOf(l);l.order=e.generate(n[s-1]&&n[s-1].order,n[s+1]&&n[s+1].order)}return l}}}])},KTKU:function(e,t){angular.module("deskworks.resClock",["deskworks.rcHelper"]).component("resClock",{template:'<svg class="res-clock" viewBox="-102 -102 204 204"><circle cx="0" cy="0" r="100"></circle><path ng-repeat="path in $ctrl.availabilities track by $index" svg-d="path" class="available"></path><path ng-repeat="path in $ctrl.reservations track by $index" svg-d="path" class="reserved"></path><path ng-repeat="path in $ctrl.hours track by $index" svg-d="path" class="hour"></path><path ng-repeat="path in $ctrl.quarters track by $index" svg-d="path" class="quarter"></path><text text-anchor="middle" alignment-baseline="middle" ng-bind="$ctrl.am ? $ctrl.AMPMS[0] : $ctrl.AMPMS[1]"></text></svg>',controller:"ResClockCtrl",bindings:{resUnit:"<",am:"<"}}).controller("ResClockCtrl",["$locale","$filter","rcHelper",function(e,t,r){"use strict";var n=this,a=100,l=10,s=25;function i(e){var t=4*Math.PI/1440,l=[];return e.forEach(function(e){var s=e.from.clone().hour(n.am?0:12).minute(0).second(0),i=e.from.clone().hour(n.am?12:24).minute(0).second(0);if(r.checkIntersection(e.from,e.to,s,i)){var o=e.from<s?s:e.from,d=e.to>i?i:e.to;l.push(function(e,t){if(t-e>=2*Math.PI)return t-=.001,"M "+c(a,e)+","+f(a,e)+"  A100,100 1 "+(t-e>Math.PI?"1":"0")+",1 "+c(a,t)+","+f(a,t)+" z";return"M0,0 L"+c(a,e)+","+f(a,e)+"  A100,100 1 "+(t-e>Math.PI?"1":"0")+",1 "+c(a,t)+","+f(a,t)+" z"}(Math.PI+(60*o.hour()+o.minute())*t,Math.PI+(60*o.hour()+o.minute()+(d-o)/6e4)*t))}}),l}function f(e,t){return+(e*Math.cos(-t)).toFixed(3)}function c(e,t){return+(e*Math.sin(-t)).toFixed(3)}n.$onInit=function(){!function(){var e,t,r;for(n.hours=[],n.quarters=[],e=0;e<12;e++)t=e*(Math.PI/6),r="M"+c(a-l,t)+","+f(a-l,t)+"  L"+c(a,t)+","+f(a,t)+"  z",n.hours.push(r);for(e=0;e<4;e++)t=e*(Math.PI/2),r="M"+c(a-s,t)+","+f(a-s,t)+"  L"+c(a,t)+","+f(a,t)+"  z",n.quarters.push(r)}(),n.AMPMS=e.DATETIME_FORMATS.AMPMS},n.$onChanges=function(){n.availabilities=i(n.resUnit.availabilities),n.reservations=i(n.resUnit.reservations)}}]).directive("svgD",function(){"use strict";return{restrict:"A",scope:!0,link:function(e,t,r){e.$watch(r.svgD,function(e){t.attr("d",e)})}}})},KeGr:function(e,t){e.exports='<label ng-if=$ctrl.layout class=ff-grid flex="1 0 180px" ng-repeat="filter in $ctrl.filterData" ng-class="\'mf-\' + filter.type"> <ff-label> <ff-checkbox name=role ff-model=filter.value ff-change=$ctrl.onChange(filter)>{{filter.name}}</ff-checkbox> </ff-label> </label> <label ng-if=!$ctrl.layout ng-repeat="filter in $ctrl.filterData" ng-class="\'mf-\' + filter.type"> <ff-checkbox name=role ff-model=filter.value ff-change=$ctrl.onChange(filter)>{{filter.name}}</ff-checkbox> </label> '},Li7w:function(e,t){e.exports='<div class="purchase-list ff-grid" ff-bulk-read-only> <h4 class=page-title>{{state.getPageTitle()}}</h4> <ff-btn-group class=buttons-top ng-if="vm.purchases.length > 5"> <ff-btn sense=new ff-click=vm.createPurchase()><span translate=PURCHASE.LIST.BTN_NEW></span></ff-btn> </ff-btn-group> <div class="ff-grid gutter-v"> <ff-panel ng-repeat="type in vm.types" ng-if=type.orders.length> <ff-panel-header><span translate={{type.name}}></span></ff-panel-header> <ff-header> <ff-row> <cell flex="1 1 12%"><span translate=PURCHASE.LIST.ORDER_ID></span></cell> <cell flex="1 1 15%" class="ff-right show-sm"><span translate=PURCHASE.LIST.FIRST_OPENED></span></cell> <cell flex="1 1 15%" class="ff-right show-md"><span translate=PURCHASE.LIST.LAST_MODIFIED></span></cell> <cell flex="1 1 15%" class=ff-right><span translate=PURCHASE.LIST.PURCHASE_TOTAL></span></cell> <cell flex="1 1 12%" class="ff-right show-sm" ng-if=vm.center.taxRates.length><span translate=PURCHASE.LIST.TAX_TOTAL></span></cell> <cell flex="1 1 15%" class="ff-right show-xs"><span translate=PURCHASE.LIST.PAYMENT_TOTAL></span></cell> <cell flex="1 1 15%" class=ff-right><span translate=PURCHASE.LIST.BALANCE_DUE></span></cell> <ff-btn-group flex="0 0 auto" class="buttons-row zero-height"> <ff-btn sense=view size=xs></ff-btn> <ff-btn sense=edit size=xs></ff-btn> </ff-btn-group> </ff-row> </ff-header> <ff-row ng-repeat="order in type.orders"> <ff-static flex="1 1 12%" ff-bind=order.id></ff-static> <ff-static flex="1 1 15%" class="ff-right show-sm" ff-bind="order.firstOpened | date:\'mediumDate\'"></ff-static> <ff-static flex="1 1 15%" class="ff-right show-md" ff-bind="order.lastModified | date:\'mediumDate\'"></ff-static> <ff-static flex="1 1 15%" class=ff-right ff-bind="order.chargesTotal | ncurrency"></ff-static> <ff-static flex="1 1 12%" class="ff-right show-sm" ff-bind="order.taxTotal | ncurrency" ng-if=vm.center.taxRates.length></ff-static> <ff-static flex="1 1 15%" class="ff-right show-xs" ff-bind="order.paymentTotal | ncurrency"></ff-static> <ff-static flex="1 1 15%" class=ff-right ff-bind="order.balance | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" class=buttons-row> <ff-btn sense=view size=xs ff-click=vm.viewPurchase(order) title="{{\'PURCHASE.LIST.BTN_VIEW\' | translate}}"></ff-btn> <ff-btn sense=edit size=xs ff-click=vm.editPurchase(order) title="{{\'GLOBAL.BTN_EDIT\' | translate}}"></ff-btn> </ff-btn-group> </ff-row> </ff-panel> </div> <ff-btn-group class=buttons-bottom> <ff-btn sense=new ff-click=vm.createPurchase()><span translate=PURCHASE.LIST.BTN_NEW></span></ff-btn> </ff-btn-group> </div> '},M9vU:function(e,t){angular.module("scrollbarSize",[]).factory("scrollbarSize",function(){"use strict";var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t})},"N+10":function(e,t,r){"use strict";r.r(t);r("YHtt");t.default=angular.module("dwModal",["angularModalService"]).factory("dwModal",["ModalService",function(e){return{show:function(t){var r={bodyClass:"dw-modal-open",appendElement:angular.element(document.querySelector(".snap-content"))};return e.showModal(angular.extend({},r,t)).then(function(e){var t=e.element[0].querySelector(".dw-modal-cross");return t&&t.focus(),e})}}}])},NT3V:function(e,t,r){"use strict";r.r(t);r("/PF1");angular.module("deskworks.dwSelectUser",["deskworks.state","flexForms","deskworks.helper"]).directive("dwSelectUser",["$route","state","helper",function(e,t,r){return{restrict:"E",scope:!0,compile:function(e,t){var r=angular.element('<ff-static snap-close ng-click="searchUser()" ng-class="{ ava: state.isUserSelected() && state.getCurrentUser().photo.indexOf(\'missing.png\') < 0 }"></ff-static>'),n=angular.element('<span class="placeholder" ng-hide="state.isUserSelected()" translate="SIDEBAR.CURRENT_USER.LABEL"></span>'),a=angular.element('<span class="company" ng-show="state.isUserSelected() && state.getCurrentUser().company" ng-bind="state.getCurrentUser().company"></span>'),l=angular.element('<span class="member" ng-show="state.isUserSelected()" ng-bind="state.getCurrentUser().firstName + \' \' + state.getCurrentUser().lastName"></span>'),s=angular.element('<img class="avatar" ng-src="{{state.getCurrentUser().photo}}" ng-if="state.isUserSelected() && state.getCurrentUser().photo.indexOf(\'missing.png\') < 0">');return r.append(n).append(a).append(l).append(s),e.append(r).append(s),this.link},link:function(n,a,l,s,i){n.state=t,n.helper=r,n.searchUser=function(){t.setParam("redirect",e.current&&e.current.scope&&e.current.scope.backPath?e.current.scope.backPath:t.getPath()),t.setPath("/user-search")}}}}])},Nue1:function(e,t){angular.module("deskworks.dwCreditCard",["flexForms","deskworks.helper","deskworks.userProfile.optsCCExpiryMonth","deskworks.userProfile.optsCCExpiryYear"]).directive("dwCreditCard",function(){"use strict";return{restrict:"A",scope:!0,templateUrl:"components/dw-credit-card/dw-credit-card.tpl.html",controller:"dwCreditCardCtrl as $ctrl",bindToController:{cc:"<dwCreditCard",ccTypes:"<dwCreditCardTypes"}}}).controller("dwCreditCardCtrl",["$scope","optsCCExpiryMonth","optsCCExpiryYear",function(e,t,r){"use strict";var n=this;n.optsCCExpiryMonth=t,n.optsCCExpiryYear=r,e.$watch("$ctrl.ccType",function(){n.cc.type=n.ccType||n.cc.type})}])},OXIe:function(e,t,r){"use strict";r.r(t);var n=r("wnB+"),a=r.n(n);r("YHtt");angular.module("dwModal.directive",[]).directive("dwModal",function(){return{template:a.a,restrict:"EA",transclude:!0,compile:function(e){return e.addClass("dw-modal"),function(){}}}})},"PdZ/":function(e,t,r){"use strict";r.r(t);r("DbwS"),r("t91x");angular.module("deskworks.billing.recurringCharge.list",["deskworks.recurringCharge.service"]).config(["$routeProvider",function(e){e.when("/recurring-charges",{templateUrl:"billing/recurring-billing/recurring-list.tpl.html",controller:"RecurringChargeListCtrl as $ctrl",label:"Recurring Billing",routeBranch:"recurring-charges",translations:["recurring-billing"],resolve:{charges:["dwAlerts","recurringChargeService","state","routeHelper",function(e,t,r,n){return n.auth().then(function(){return n.selectUser().then(function(){return t.query(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to query recurring charges.")})})})}],user:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then(function(){return n.selectUser()}).then(function(){return a()}).then(function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to get user profile.")})})}]}})}]).controller("RecurringChargeListCtrl",["$scope","$translate","dwAlerts","recurringChargeService","user","charges","state","helper",function(e,t,r,n,a,l,s,i){var f=this;f.charges=l,s.setPageTitle(t.instant("RECURRING_BILLING.LIST.PAGE_TITLE",{userName:a.fullName})),f.new=function(){return s.setPath("/recurring-charges/new/edit")},f.edit=function(e){return s.setPath("/recurring-charges/"+e.id+"/edit")},f.saveUseForCheckInBilling=function(e){f.charges.forEach(function(t){t.useForCheckInBilling&&t!==e&&(t.useForCheckInBilling=!1)}),e.$spin=!0,n.setUseForCheckInBilling(s.getCurrentCenterId(),s.getCurrentUserId(),e.id).catch(function(e){return r.error(e,'Failed to set "Use for Check-In Billing".')}).finally(function(){e.$spin=!1})}}])},Q6H5:function(e,t,r){"use strict";r.r(t);r("ieHP");angular.module("deskworks.membershipFilter",["flexForms","deskworks.state","deskworks.helper","deskworks.optsMembershipFilter"]).directive("membershipFilter",function(){return{restrict:"E",scope:!0,templateUrl:"components/membership-filter/membership-filter.tpl.html",controller:"MembershipFilterCtrl as $ctrl",bindToController:{ffModel:"=?",filterData:"=?",layout:"@?"}}}).controller("MembershipFilterCtrl",["$scope","$element","$attrs","state","helper","optsMembershipFilter",function(e,t,r,n,a,l){var s=this;function i(){s.ffModel=s.filterData.filter(function(e){return"all"!==e.id}).reduce(function(e,t){return t.value&&(e[t.id]=t.value),e},{})}s.$onInit=function(){s.filterData=s.filterData||angular.copy(l),i()},s.onChange=function(e){if("all"===e.id){var t=a.findByKeyValue(s.filterData,"id","all").value;s.filterData.forEach(function(e){"all"!==e.id&&(e.value=t)}),t||(a.findByKeyValue(s.filterData,"id","activeMembers").value=!0)}else a.findByKeyValue(s.filterData,"id","all").value=s.filterData.filter(function(e){return"all"!==e.id}).every(function(e){return e.value});i()}}])},TAgq:function(e,t){angular.module("deskworks.dwInvoice.small",["deskworks.state","flexForms","deskworks.helper"]).directive("dwInvoiceSmall",function(){"use strict";return{restrict:"E",scope:!0,templateUrl:"components/dw-invoice/dw-invoice-small.tpl.html",controller:"dwInvoiceSmallCtrl as dwInvoice",bindToController:{invoice:"=*"},compile:function(e,t){return e.addClass("dw-invoice"),function(e,t,r,n,a){}}}}).controller("dwInvoiceSmallCtrl",function(){})},USOb:function(e,t){angular.module("deskworks.dwControls").directive("dwPhone",["$compile","$translate",function(e,t){"use strict";return{restrict:"AC",priority:30,terminal:!0,compile:function(r,n){var a=this;n.$set("maxlength",n.maxlength||64),n.$set("ffPattern",n.ffPattern||/^(?:\+\d[-. ]?)?(?:\(?\d\)?[-. ]?){5,13}\d$/),n.$set("placeholder",n.placeholder||"888-379-2865");var l=t.instant("USER_PROFILE.PHONES.NUMBER"),s=t.instant("GLOBAL.VALIDATION.PHONE");return n.$set("ffValidateAlert",n.ffValidateAlert||"{ field: '"+l+"', pattern: '"+s+"' }"),function(t,r,n){e(r,null,a.priority)(t)}}}}])},Y80j:function(e,t){angular.module("deskworks.dwSelectCenter",["deskworks.state","flexForms","deskworks.helper","deskworks.center.service","deskworks.Admin"]).directive("dwSelectCenter",["$q","$rootScope","$timeout","$compile","dwAlerts","ffHelper","state","helper","centerService","Admin",function(e,t,r,n,a,l,s,i,f,c){"use strict";return{restrict:"E",scope:!0,controller:function(){},controllerAs:"dwSelectCenter",compile:function(r,n){var l=angular.element('<ff-select name="center" flex="auto"></ff-select>'),o=angular.element('<option ng-repeat="center in dwSelectCenter.centers" ng-value="center.id" label="{{center.name}}">{{center.name}}</option>');return o.attr("ng-style","center.color ? { color: center.color } : {}"),l.attr("ff-style","dwSelectCenter.curCenter.color ? {color: dwSelectCenter.curCenter.color} : {}"),l.attr("ff-model",n.ffModel||"dwSelectCenter.curCenterId"),l.attr("ff-change","dwSelectCenter.onCenterChange()"),l.append(o),r.append(l),function(r,l,o,d){function u(){var t={centers:f.getCenters().catch(function(e){return a.error(e,"dwSelectCenter: failed to query centers.")})};return s.isLoggedAdmin()&&(t.admin=c.get(s.getLoggedUserId()).catch(function(e){return a.error(e,"dwSelectCenter: failed to get admin.")})),e.all(t).then(function(e){if(d.centers=e.centers.filter(function(t){return!e.admin||!!(i.findByKeyValue(e.admin.centers,"id",t.id)||{}).permission}),o.ffOptionAll&&"false"!==o.ffOptionAll&&d.centers.length>1&&d.centers.unshift({id:0,name:"All Centers"}),n.ffModel){var t=r.$eval(n.ffModel);angular.isUndefined(t)?(d.curCenterId=d.centers[0].id,r.$eval(n.ffModel+" = dwSelectCenter.curCenterId")):d.curCenterId=t}else d.curCenterId=s.getCurrentCenterId()||d.centers[0]&&d.centers[0].id;d.curCenter=i.findByKeyValue(d.centers,"id",d.curCenterId)})}n.ffModel||r.$watch(function(){return s.getCurrentCenterId()},function(e){d.curCenterId=e,d.curCenter=i.findByKeyValue(d.centers,"id",d.curCenterId)}),d.onCenterChange=function(){d.curCenter=i.findByKeyValue(d.centers,"id",d.curCenterId),n.ffModel?d.curCenter=i.findByKeyValue(d.centers,"id",r.$eval(n.ffModel)):(d.curCenter=i.findByKeyValue(d.centers,"id",d.curCenterId),s.setCurrentCenterId(d.curCenterId))},t.$on("CENTERS:REFRESH",function(){u()}),u()}}}}])},Y8yu:function(e,t,r){"use strict";r.r(t);r("DbwS"),r("t91x");angular.module("deskworks.recurringChargeAudit",["deskworks.helper","deskworks.RecurringChargeAudit"]).directive("recurringChargeAudit",function(){return{restrict:"E",scope:!0,templateUrl:"billing/recurring-billing/recurring-charge-audit.tpl.html",controller:"RecurringChargeAuditCtrl as $ctrl",bindToController:{priceListProducts:"<",reservationUnits:"<",recurringChargeId:"<"}}}).controller("RecurringChargeAuditCtrl",["state","dwAlerts","RecurringChargeAudit",function(e,t,r){var n=this;n.$onInit=function(){n.props=r.getProps(),n.centerId=e.getCurrentCenterId(),n.userId=e.getCurrentUserId(),n.offset=0,n.limit=20,n.entries=[],n.fetch()},n.fetch=function(){if(n.eof||n.fetching)return n.fetching;n.fetching=r.query(n.centerId,n.userId,n.recurringChargeId,n.offset,n.limit).catch(function(e){return t.error(e,"Failed to query audit log.")}).finally(function(){n.fetching=null}).then(function(e){n.entries=n.entries.concat(function(e){return e.forEach(function(e){e.props||(e.props=n.props.filter(function(t){return e[t.id]}).map(function(t){return{name:t.name,old:t.filter?t.filter(e[t.id].old,n):e[t.id].old,new:t.filter?t.filter(e[t.id].new,n):e[t.id].new}}))}),e}(e)),n.offset+=e.length,n.eof=e.length<n.limit})}}])},YHtt:function(e,t,r){},YOQ5:function(e,t){e.exports='<label class=ff-row ng-if=dwAddress.hasType> <ff-label flex="0 1 116px" ff-required={{!dwAddress.notRequired}}> <span translate=GLOBAL.ADDRESS.TYPE></span> </ff-label> <ff-select name=type ff-model=dwAddress.address.type ff-options="type.name for type in dwAddress.types" ff-required=!dwAddress.notRequired ff-validate-alert="{{\'GLOBAL.ADDRESS.TYPE\' | translate}}"></ff-select> </label> <label class=ff-row ng-if=!dwAddress.secondStreet> <ff-label flex="0 1 116px" ff-required={{!dwAddress.notRequired}}> <span translate=GLOBAL.ADDRESS.STREET></span> </ff-label> <ff-text name=street ff-model=dwAddress.address.street placeholder="6265 Highway 9" ff-required=!dwAddress.notRequired ff-validate-alert="{{\'GLOBAL.ADDRESS.STREET\' | translate}}"></ff-text> </label> <label class=ff-row ng-if=dwAddress.secondStreet> <ff-label flex="0 1 116px" ff-required={{!dwAddress.notRequired}}> <span translate=GLOBAL.ADDRESS.STREET></span>&nbsp;1 </ff-label> <ff-text name=street1 ff-model=dwAddress.address.street1 placeholder="6265 Highway 9" ff-required=!dwAddress.notRequired ff-validate-alert="{{\'GLOBAL.ADDRESS.STREET\' | translate}} 1"> </ff-text> </label> <label class=ff-row ng-if=dwAddress.secondStreet> <ff-label flex="0 1 116px"><span translate=GLOBAL.ADDRESS.STREET></span>&nbsp;2</ff-label> <ff-text name=street2 ff-model=dwAddress.address.street2></ff-text> </label> <label class=ff-row> <ff-label flex="0 1 116px" ff-required={{!dwAddress.notRequired}}> <span translate=GLOBAL.ADDRESS.CITY></span> </ff-label> <ff-text name=city ff-model=dwAddress.address.city placeholder=Felton ff-required=!dwAddress.notRequired ff-validate-alert="{{\'GLOBAL.ADDRESS.CITY\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 1 116px" ff-required={{!dwAddress.notRequired}}> <span translate=GLOBAL.ADDRESS.COUNTRY></span> </ff-label> <ff-select name=country ff-model=dwAddress.address.country ff-options="country.name for country in dwAddress.countries" ff-required=!dwAddress.notRequired ff-validate-alert="{{\'GLOBAL.ADDRESS.COUNTRY\' | translate}}" ff-change=dwAddress.onChangeCountry()></ff-select> </label> <label class=ff-row> <ff-label flex="0 1 116px" ff-required={{!dwAddress.notRequired}}> <span translate=GLOBAL.ADDRESS.STATE></span> </ff-label> <ff-select name=state ff-model=dwAddress.address.state ng-if=dwAddress.states[dwAddress.address.country.id] ff-options="state.name for state in dwAddress.states[dwAddress.address.country.id]" ff-required=!dwAddress.notRequired ff-validate-alert=State/Province></ff-select> <ff-text name=state ff-model=dwAddress.address.state ng-if=!dwAddress.states[dwAddress.address.country.id] ff-required=!dwAddress.notRequired ff-validate-alert="{{\'GLOBAL.ADDRESS.STATE\' | translate}}" placeholder=Ontario></ff-text> </label> <label class=ff-row> <ff-label flex="0 1 116px" ff-required={{!dwAddress.notRequired}}> <span translate=GLOBAL.ADDRESS.ZIP></span> </ff-label> <ff-text name=zip ff-model=dwAddress.address.zip placeholder=95018 ff-required=!dwAddress.notRequired ff-validate-alert="{{\'GLOBAL.ADDRESS.ZIP\' | translate}}"></ff-text> </label> '},Yi3N:function(e,t){e.exports='<ff-header> <ff-row> <cell flex="4 0 40px" class="invoice-date ff-center"><span translate=PURCHASE.INVOICE.DATE></span></cell> <cell flex="4 1 40px" class="invoice-date-created ff-center show-lg"><span translate=PURCHASE.INVOICE.DATE_CREATED></span></cell> <cell flex="4 1 40px" class="invoice-added-by ff-center show-lg"><span translate=PURCHASE.INVOICE.ADDED_BY></span></cell> <cell flex="4 0 70px" class=invoice-product><span translate=PURCHASE.INVOICE.PRODUCT></span></cell> <cell flex="10 1 100px" class="invoice-description show-md"><span translate=PURCHASE.INVOICE.DESCRIPTION></span></cell> <cell flex="0 0 32px" class="invoice-quantity ff-center show-sm"><span translate=PURCHASE.INVOICE.QUANTITY></span></cell> <cell flex="0 0 80px" class="invoice-price ff-right show-sm"><span translate=PURCHASE.INVOICE.PRICE></span></cell> <cell flex="0 0 80px" class="invoice-amount ff-right"><span translate=PURCHASE.INVOICE.AMOUNT></span></cell> <ff-btn-group flex="0 0 auto" ng-if="::dwInvoice.allowRemove !== \'false\'" class="buttons-row zero-height"> <ff-btn sense=remove size=xs></ff-btn> </ff-btn-group> </ff-row> </ff-header> <ff-row ng-repeat="item in dwInvoice.invoice.items"> <ff-static flex="4 0 40px" class="invoice-date ff-center" ff-bind="::item.billedAt | date:\'mediumDate\'"></ff-static> <ff-static flex="4 1 40px" class="invoice-date-created ff-center show-lg" ff-bind="::item.createdAt | date:\'mediumDate\'"></ff-static> <ff-static flex="4 1 40px" class="invoice-added-by ff-center show-lg" ff-bind=::item.addedBy></ff-static> <ff-static flex="4 0 70px" class=invoice-product ff-bind=::item.name></ff-static> <ff-static flex="10 1 100px" class="invoice-description show-md" ff-bind=::item.description></ff-static> <ff-static flex="0 0 32px" class="invoice-quantity ff-center show-sm" ff-bind="::item.quantity | round"></ff-static> <ff-static flex="0 0 80px" class="invoice-price ff-right show-sm" ff-bind="::item.price | ncurrency"></ff-static> <ff-static flex="0 0 80px" class="invoice-amount ff-right" ff-bind="::item.amount | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" ng-if="::dwInvoice.allowRemove !== \'false\'" class=buttons-row> <ff-col> <ff-btn sense=remove size=xs title="{{\'GLOBAL.BTN_DELETE\' | translate}}" ng-if="dwInvoice.invoice.accessRights.items[$index].canDelete || !dwInvoice.invoice.accessRights.items[$index].canVoid" ng-class="{ \'zero-height\': !dwInvoice.invoice.accessRights.items[$index].canDelete }" ff-click=dwInvoice.removeItem(item)></ff-btn> <ff-btn sense=remove size=xs title="{{\'PURCHASE.INVOICE.BTN_VOID\' | translate}}" ng-if="dwInvoice.invoice.accessRights.items[$index].canVoid || !dwInvoice.invoice.accessRights.items[$index].canDelete" ng-class="{ \'zero-height\': !dwInvoice.invoice.accessRights.items[$index].canVoid }" ff-click=dwInvoice.removeItem(item)></ff-btn> </ff-col> </ff-btn-group> </ff-row> <ff-row class=invoice-charges> <ff-label><span translate=PURCHASE.INVOICE.CHARGES></span></ff-label> <ff-static flex="0 0 80px" class=ff-right ff-bind="dwInvoice.invoice.chargesTotal | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" ng-if="::dwInvoice.allowRemove !== \'false\'" class="buttons-row zero-height"> <ff-btn sense=remove size=xs></ff-btn> </ff-btn-group> </ff-row> <ff-row class=invoice-tax ng-repeat="tax in dwInvoice.invoice.taxes"> <ff-label>{{tax.taxName}}</ff-label> <ff-static flex="0 0 80px" class=ff-right ff-bind="tax.taxAmount | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" ng-if="::dwInvoice.allowRemove !== \'false\'" class="buttons-row zero-height"> <ff-btn sense=remove size=xs></ff-btn> </ff-btn-group> </ff-row> <ff-row class=invoice-payment> <ff-label><span translate=PURCHASE.INVOICE.PAYMENT></span></ff-label> <ff-static flex="0 0 80px" class=ff-right ff-bind="dwInvoice.invoice.paymentTotal | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" ng-if="::dwInvoice.allowRemove !== \'false\'" class="buttons-row zero-height"> <ff-btn sense=remove size=xs></ff-btn> </ff-btn-group> </ff-row> <ff-row class=invoice-balance> <ff-label><span translate=PURCHASE.INVOICE.BALANCE></span></ff-label> <ff-static flex="0 0 80px" class=ff-right ff-bind="dwInvoice.invoice.balance | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" ng-if="::dwInvoice.allowRemove !== \'false\'" class="buttons-row zero-height"> <ff-btn sense=remove size=xs></ff-btn> </ff-btn-group> </ff-row> '},"Z3/d":function(e,t,r){"use strict";r.r(t);r("DbwS"),r("t91x");angular.module("forbidStaff",[]).directive("forbidStaff",["$compile","$templateCache","session","state",function(e,t,r,n){return{restrict:"EA",scope:!0,controller:"forbidStaffCtrl as $forbidStaff",link:function(a,l){var s=l.children().css({display:"none"});r.wait().finally(function(){if(!n.isLoggedAdmin())return s.css({display:""});var r=t.get("components/forbid-staff/forbid-staff.tpl.html");l.append(e(r)(a))})}}}]).controller("forbidStaffCtrl",["$scope","$route","$timeout","state",function(e,t,r,n){this.signOut=function(){return n.logout({skipResetParams:!0}).finally(function(){return t.reload(),r(2e3)})},this.home=function(){return n.resetParams(),n.setPath("/")}}])},ZgRP:function(e,t){angular.module("deskworks.optsMembershipFilter",[]).factory("optsMembershipFilter",["$rootScope","$translate",function(e,t){"use strict";var r=[{id:"all",_name:"USER_SEARCH.FILTERS.ALL",value:!1,type:"all"},{id:"activeMembers",_name:"USER_SEARCH.FILTERS.ACTIVE_MEMBERS",value:!0,type:"role"},{id:"inactiveMembers",_name:"USER_SEARCH.FILTERS.INACTIVE_MEMBERS",value:!1,type:"role"},{id:"activeCoMembers",_name:"USER_SEARCH.FILTERS.ACTIVE_CO_MEMBERS",value:!1,type:"role"},{id:"inactiveCoMembers",_name:"USER_SEARCH.FILTERS.INACTIVE_CO_MEMBERS",value:!1,type:"role"},{id:"nonMembers",_name:"USER_SEARCH.FILTERS.NON_MEMBERS",value:!1,type:"role"}];function n(){r.forEach(function(e){e.name=t.instant(e._name)})}return n(),e.$on("$setTranslationsSuccess",n),r}])},aUi0:function(e,t,r){"use strict";r.r(t);r("it7j"),r("w7o6");angular.module("deskworks.dwAddCharges",["ngRoute","deskworks.helper","deskworks.state","deskworks.purchase.service"]).directive("dwAddCharges",function(){return{restrict:"EAC",scope:!0,templateUrl:"billing/purchase/dw-add-charges.tpl.html",controller:"dwAddChargesCtrl as $ctrl",bindToController:{purchase:"<",updateInvoice:"&",userPriceList:"<"}}}).controller("dwAddChargesCtrl",["$scope","$filter","$route","$translate","dwAlerts","helper","state","purchaseService",function(e,t,r,n,a,l,s,i){var f=this;f.collapsed={},f.$onInit=function(){},f.$onChanges=function(){f.purchase&&f.purchase.options&&s.isLoggedAdmin()&&!l.find(f.purchase.options.chargeTypes,"custom")&&f.purchase.options.chargeTypes.push({id:"custom",name:n.instant("PURCHASE.CHARGES.CUSTOM"),packages:[{name:n.instant("PURCHASE.CHARGES.CUSTOM"),price:"0.0"}]}),f.purchase&&f.purchase.options&&f.purchase.options.chargeTypes.forEach(function(e){e.packages.forEach(function(e){e.chargedAt=moment(),e.quantity=1,e.notes=""})})},f.createCharge=function(e,n){if(!l.pointFirstInvalid("#product"+n.id)){var c={chargedAt:t("date")(n.chargedAt,"yyyy-MM-dd"),notes:n.notes,quantity:n.quantity};return"custom"===e.id?(c.packageName=n.name,c.price=n.price,c.isTaxable=n.isTaxable):c.packageId=n.id,i.createCharge(s.getCurrentCenterId(),s.getCurrentUserId(),f.purchase.id,c,"custom"===e.id,!!r.current.params.productId,r.current.params.productId).catch(function(e){return a.error(e,"Failed to add charge.")}).then(function(){return f.updateInvoice()})}}}])},bWHa:function(e,t){angular.module("deskworks.components",["deskworks.dwControls","deskworks.dwSelectCenter","deskworks.dwSelectUser","deskworks.dwAddress","deskworks.dwCreditCard","deskworks.dwDateTime","deskworks.dwInvoice","deskworks.resClock","deskworks.dwAlerts","deskworks.dwCheckInWidget","deskworks.dwSelectProfile","deskworks.niceTime","scrollbarSize","deskworks.membershipFilter","deskworks.formDesign.fdField"])},c4ZB:function(e,t){angular.module("ui.bootstrap.alert",[]).controller("UibAlertController",["$scope","$attrs","$interpolate","$timeout",function(e,t,r,n){e.closeable=!!t.close;var a=angular.isDefined(t.dismissOnTimeout)?r(t.dismissOnTimeout)(e.$parent):null;a&&n(function(){e.close()},parseInt(a,10))}]).directive("uibAlert",function(){return{controller:"UibAlertController",controllerAs:"alert",template:'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissible\' : null]" role="alert"><button ng-show="closeable" type="button" class="close" ng-click="close({$event: $event})"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><div ng-transclude></div></div>',transclude:!0,replace:!0,scope:{type:"@",close:"&"}}})},dUjI:function(e,t){e.exports='<ff-header> <ff-row> <cell flex="10 0 50%"><span translate=PURCHASE.INVOICE.DESCRIPTION></span></cell> <cell flex="3 0 45px" class="ff-center show-sm"><span translate=PURCHASE.INVOICE.DATE></span></cell> <cell flex="1 0 64px" class="ff-right show-md"><span translate=PURCHASE.INVOICE.PRICE></span></cell> <cell flex="1 0 36px" class=ff-center><span translate=PURCHASE.INVOICE.QUANTITY></span></cell> <cell flex="0 0 94px" class=ff-right><span translate=PURCHASE.INVOICE.AMOUNT></span></cell> </ff-row> </ff-header> <ff-row ng-repeat="item in ::dwInvoice.invoice.items"> <ff-static flex="10 0 50%" ff-bind=::item.description></ff-static> <ff-static flex="3 0 45px" class="ff-center show-sm" ff-bind="::item.date | date:\'mediumDate\'"></ff-static> <ff-static flex="1 0 64px" class="ff-right show-md" ff-bind="::item.price | ncurrency"></ff-static> <ff-static flex="1 0 36px" class=ff-center ff-bind=::item.quantity></ff-static> <ff-static flex="0 0 94px" class=ff-right ff-bind="::item.amount | ncurrency"></ff-static> </ff-row> <ff-row class=invoice-charges> <ff-label><span translate=PURCHASE.INVOICE.CHARGES></span></ff-label> <ff-static flex="0 0 94px" class=ff-right ff-bind="::dwInvoice.invoice.total | ncurrency"></ff-static> </ff-row> <ff-row class=invoice-tax ng-repeat="tax in dwInvoice.invoice.taxes"> <ff-label>{{tax.taxName}}</ff-label> <ff-static flex="0 0 94px" class=ff-right ff-bind="tax.taxAmount | ncurrency"></ff-static> </ff-row> <ff-row class=invoice-payment> <ff-label><span translate=PURCHASE.INVOICE.PAYMENT></span></ff-label> <ff-static flex="0 0 94px" class=ff-right ff-bind="::dwInvoice.invoice.payment | ncurrency"></ff-static> </ff-row> <ff-row class=invoice-balance> <ff-label><span translate=PURCHASE.INVOICE.BALANCE></span></ff-label> <ff-static flex="0 0 94px" class=ff-right ff-bind="::dwInvoice.invoice.balance | ncurrency"></ff-static> </ff-row> '},eU88:function(e,t){angular.module("deskworks.dwControls").directive("dwLastName",["$compile","$translate",function(e,t){"use strict";return{restrict:"AC",priority:30,terminal:!0,compile:function(r,n){var a=this;n.$set("maxlength",n.maxlength||256),n.$set("ffPattern",n.ffPattern||/^[^\\<>\/&]*$/),n.$set("placeholder",n.placeholder||"Doe");var l=t.instant("USER_PROFILE.PERSONAL_INFO.LAST_NAME"),s=t.instant("USER_PROFILE.PERSONAL_INFO.LAST_NAME_INVALID_CHARS");return n.$set("ffValidateAlert",n.ffValidateAlert||"{ field: '"+l+"', pattern: '"+s+"' }"),function(t,r,n){e(r,null,a.priority)(t)}}}}])},fdHq:function(e,t){e.exports="<div class=forbid-staff> <h4 class=page-title translate=GLOBAL.FORBID_STAFF.HEADER></h4> <ff-panel> <span translate=GLOBAL.FORBID_STAFF.TEXT></span> </ff-panel> <ff-btn-group class=buttons-bottom> <ff-btn sense=signOut ff-click=$forbidStaff.signOut()><span translate=GLOBAL.BTN_SIGN_OUT></span></ff-btn> <ff-btn sense=home ff-click=$forbidStaff.home()><span translate=GLOBAL.BTN_HOME></span></ff-btn> </ff-btn-group> </div> "},iPki:function(e,t){angular.module("deskworks.dwSelectProfile",["ngRoute","deskworks.state","flexForms","deskworks.helper","deskworks.userProfile.service"]).directive("dwSelectProfile",["$route","state","helper","userProfileService","resolveTimezone",function(e,t,r,n,a){"use strict";return{restrict:"AC",scope:!0,template:'<span>Current Profile</span><ff-select name="currentProfile" ff-model="currentProfile" ff-options="profile.name for profile in profiles" ff-change="selectProfile(currentProfile)"></ff-select>',compile:function(l,s){return l.css("display","none"),function(l,s,i){l.profiles=[],l.$watch(function(){return t.getLoggedUserId()},function(e){t.isLoggedAdmin()?s.css("display","none"):e?a().then(function(){return n.get(t.getCurrentCenterId(),t.getLoggedUserId())}).then(function(n){l.profiles=[{id:n.id,name:n.firstName+" "+n.lastName}],n.masterMembers.forEach(function(r){r.id!==e&&(l.profiles.push({id:r.id,name:r.company||r.fullName}),t.setCurrentUserId(r.id))}),l.currentProfile=r.findByKeyValue(l.profiles,"id",t.getCurrentUserId())||l.profiles[0],l.profiles.length>1&&s.css("display","")}):(l.profiles=[],l.currentProfile=null,s.css("display","none"))}),l.$watch(function(){return t.getCurrentUserId()},function(e){l.currentProfile=r.findByKeyValue(l.profiles,"id",e)||l.profiles[0]}),l.selectProfile=function(r){t.setCurrentUserId(r.id===t.getLoggedUserId()?null:r.id),e.current&&e.current.$$route&&!e.current.$$route.reloadOnSearch&&e.reload()}}}}}])},ieHP:function(e,t,r){},ixwX:function(e,t,r){"use strict";r.r(t);r("it7j");angular.module("deskworks.members.billingProfile.edit",["ngRoute","deskworks.routeHelper","deskworks.userProfile.service","deskworks.purchase.service","deskworks.setup.service"]).config(["$routeProvider",function(e){e.when("/billing-profiles",{templateUrl:"billing/billing-profile/billing-profile-edit.tpl.html",controller:"BillingProfileEditCtrl as vm",label:"Billing Profile",routeBranch:"billing-profiles",translations:["billing-profile","user-profile"],resolve:{reg:function(){},userProfile:["dwAlerts","userProfileService","state","routeHelper","resolveTimezone",function(e,t,r,n,a){return n.auth().then(function(){return n.selectUser()}).then(function(){return a()}).then(function(){return t.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to load billing profile.")})})}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch(function(t){return e.error(t,"Failed to load setup settings.")})}]}}).when("/new-user/:userId/membership/billing-profile",{templateUrl:"billing/billing-profile/billing-profile-edit.tpl.html",controller:"BillingProfileEditCtrl",controllerAs:"vm",label:"Billing Profile",routeBranch:"new-user",translations:["billing-profile","user-profile"],resolve:{reg:function(){return{member:!1,selfRegistration:!1,step:2,stepCount:2}},userProfile:["dwAlerts","$route","state","userProfileService","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then(function(){return a.selectUser()}).then(function(){return l()}).then(function(){return n.get(r.getCurrentCenterId(),t.current.params.userId).catch(function(t){return e.error(t,"Failed to get user profile.")})})}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch(function(t){return e.error(t,"Failed to load setup settings.")})}]}}).when("/new-member/:userId/membership/billing-profile",{templateUrl:"billing/billing-profile/billing-profile-edit.tpl.html",controller:"BillingProfileEditCtrl",controllerAs:"vm",label:"Billing Profile",routeBranch:"new-member",translations:["billing-profile","user-profile"],resolve:{reg:function(){return{member:!0,selfRegistration:!1,step:2,stepCount:3}},userProfile:["dwAlerts","$route","state","userProfileService","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then(function(){return a.selectUser()}).then(function(){return l()}).then(function(){return n.get(r.getCurrentCenterId(),t.current.params.userId).catch(function(t){return e.error(t,"Failed to load billing profile.")})})}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch(function(t){return e.error(t,"Failed to load setup settings.")})}]}})}]).controller("BillingProfileEditCtrl",["$scope","$translate","$q","dwAlerts","state","helper","reg","userProfile","settings","userProfileService","purchaseService",function(e,t,r,n,a,l,s,i,f,c,o){var d=this;if(d.reg=s,d.userProfile=i,d.settings=f,f.creditCardTypes=f.creditCardTypes.filter(function(e){return e.enable}),d.userProfile.creditCards.forEach(function(e){e.type=l.find(f.creditCardTypes,e.type)||e.type||{}}),d.userProfile.creditCards=d.userProfile.creditCards||[],s&&0===d.userProfile.creditCards.length){var u=c.creditCard.new(d.userProfile);u.type=f.creditCardTypes[0],d.userProfile.creditCards.push(u)}a.setPageTitle(t.instant("BILLING_PROFILE.PAGE_TITLE",{userName:d.userProfile.fullName})),d.next=function(e){if((e=e||{}).skipBillingProfile||!l.pointFirstInvalid("#billingProfile"))return r.when(e.skipBillingProfile?{}:c.saveBillingProfile(a.getCurrentCenterId(),d.userProfile)).then(function(){if(!d.reg||d.reg.member)return o.createPurchase(a.getCurrentCenterId(),d.userProfile.id,!0,+a.getParam("productId"),a.getParam("attachedReservationUnitId"),a.getParam("membershipStartDate")).catch(function(e){return n.error(e,"Failed to create purchase.")}).then(function(e){return a.setPath(a.getPath()+"/purchase/"+e.id)});d.complete=!0})},d.back=a.back,c.bindTestBillingGenerator(e,d.userProfile,d.reg)}])},jFKD:function(e,t){angular.module("deskworks.formDesign.fdField",["deskworks.formDesign.fdFieldTemplates"]).directive("fdField",["$compile","fdFieldTemplates",function(e,t){"use strict";return{scope:!0,require:"^^?form",link:function(r,n,a,l){r.field=r.$eval(a.field);var s=angular.element(t[r.field.type]);n.append(s),e(s)(r)}}}])},jzs2:function(e,t){angular.module("deskworks.dwControls",[])},"kyB+":function(e,t){angular.module("deskworks.dwControls").directive("dwPassword",["$compile","$translate",function(e,t){"use strict";return{restrict:"AC",priority:30,terminal:!0,compile:function(r,n){var a,l=this;n.$set("minlength",n.minlength||n.ffMinlength||8),n.$set("maxlength",n.maxlength||n.ffMaxlength||20),n.$set("ffPattern",n.ffPattern||/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)\S{8,}$/),n.$set("placeholder","password");var s=t.instant("GLOBAL.PASSWORD.INVALID_CHARS");try{a=angular.fromJson(n.ffValidateAlert)}catch(e){a={}}return a=angular.extend({field:t.instant("GLOBAL.PASSWORD"),pattern:s,minlength:s},a),n.$set("ffValidateAlert",angular.toJson(a)),function(t,r,n){e(r,null,l.priority)(t)}}}}])},laxG:function(e,t){e.exports='<div id=billingProfile ff-bulk-read-only> <h4 class=page-title>{{state.getPageTitle()}}</h4> <div class="ff-grid gutter-v"> <ff-panel ng-if=vm.complete> <span translate=BILLING_PROFILE.REGISTRATION.COMPLETE translate-values="{ userName: vm.userProfile.fullName }"></span> </ff-panel> <up-credit-cards user-profile=vm.userProfile reg=vm.reg settings=vm.settings ng-if=!vm.complete></up-credit-cards> <up-e-checks user-profile=vm.userProfile reg=vm.reg ng-if="!vm.complete && vm.settings.enableEChecks"></up-e-checks> </div> <ff-btn-group class=buttons-bottom ng-if="vm.reg && !vm.complete"> <ff-btn sense=next ng-if="vm.reg && !vm.reg.selfRegistration" ff-click="vm.next({ skipBillingProfile: true })"> <span translate=BILLING_PROFILE.REGISTRATION.SKIP_BILLING></span> </ff-btn> <ff-btn sense=back ff-click=vm.back()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=next ng-if=vm.reg ff-click=vm.next()><span translate=GLOBAL.BTN_NEXT></span></ff-btn> </ff-btn-group> </div> '},mDxW:function(e,t){angular.module("deskworks.dwCheckInWidget",["flexForms","deskworks.helper","deskworks.checkInLog.service"]).directive("dwCheckInWidget",function(){"use strict";return{restrict:"E",scope:!0,controller:"dwCheckInWidgetCtrl as $ctrl",template:'<span>Check In / Out</span><ff-btn-group><ff-btn sense="checkIn" size="sm" ng-hide="$ctrl.log.checkInTime" ff-click="$ctrl.checkInOut(\'checkIn\')">Check In</ff-btn><ff-btn sense="checkOut" size="sm" ng-show="$ctrl.log.checkInTime" ff-click="$ctrl.checkInOut(\'checkOut\')">Check Out</ff-btn></ff-btn-group>',compile:function(e,t){return e.addClass("sidebar-item keep-sm-btn-size").css("display","none"),function(e,t,r,n){}}}}).controller("dwCheckInWidgetCtrl",["$scope","$element","$interval","state","dwAlerts","checkInLogService",function(e,t,r,n,a,l){"use strict";var s=this;s.checkInOut=function(e){return r.cancel(s.updateTimer),l.checkInOut(n.getCurrentCenterId(),n.getCurrentUserId(),e).then(function(){s.log.checkInTime="checkIn"===e?moment():void 0,r.cancel(s.updateTimer),s.updateTimer=r(s.updateMemberLog,6e3),ga("send","event","merged",e)}).catch(function(t){return a.error(t,"Failed to "+e)})},s.updateMemberLog=function(){if(r.cancel(s.updateTimer),(!n.isLoggedAdmin()||n.isUserSelected())&&n.getCurrentCenterId())return l.getLog(n.getCurrentCenterId(),n.getCurrentUserId(),0,0).then(function(e){t.css("display",e.allowCheckIn?null:"none"),s.log=e,e.allowCheckIn&&(r.cancel(s.updateTimer),s.updateTimer=r(s.updateMemberLog,6e4))}).catch(function(e){return a.error(e,"Failed to update check-in widget")});t.css("display","none")},e.$watchGroup([n.getCurrentUserId,n.getCurrentCenterId],s.updateMemberLog)}])},nOQH:function(e,t,r){"use strict";r.r(t);r("DbwS"),r("t91x");angular.module("deskworks.checkIn",["deskworks.center.service","deskworks.checkIn.service","deskworks.checkIn.kbwAccessCard"]).config(["$routeProvider",function(e){e.when("/check-in",{templateUrl:"check-in/check-in.tpl.html",controller:"CheckInCtrl",controllerAs:"vm",hideSidebar:!0,userTasksPolicy:!1,landing:!0,resolve:{center:["$rootScope","state","helper","centerService",function(e,t,r,n){return n.getCenters().then(function(e){return r.findByKeyValue(e,"id",t.getCurrentCenterId())||e[0]||{}},function(t){return e.showError(t,"Failed to load centers list.")})}]}})}]).controller("CheckInCtrl",["$scope","$q","state","helper","center","checkInService",function(e,t,r,n,a,l){var s=this;r.setPageTitle("Check-In"),s.center=a,s.auth=function(e){if(!s.busy){if(delete s.error,n.pointFirstInvalid("#checkIn"))return;return s.accessCardNumber||s.login||s.password?(s.busy=!0,(e?l.checkOut(s.center.id,s):l.checkIn(s.center.id,s)).then(function(){s.countdown=3},function(t){s.error=t.data.error||(e?"Failed to check out.":"Failed to check in.")}).finally(function(){s.busy=!1})):void(s.error="Please use access number or login/password")}},s.init=function(){delete s.accessCardNumber,delete s.login,delete s.password,delete s.error,delete s.countdown},e.$on("kbw::accessCard",function(e,t){e.stopPropagation(),s.busy||(s.accessCardNumber=t,delete s.login,delete s.password,delete s.error,delete s.countdown,s.auth())}),s.signUpNonMember=function(){return r.setCurrentCenterId(s.center.id),r.setParam("origin","/check-in"),r.setPath("/simple-reservation/centers/"+s.center.id+"/types")},s.signUpMember=function(){return r.setCurrentCenterId(s.center.id),r.setParam("origin","/check-in"),r.setPath("/member-sign-up")}}])},pMiU:function(e,t){angular.module("deskworks.dwAddress",["flexForms","deskworks.helper"]).directive("dwAddress",["$compile","$templateCache","$timeout","$translate","helper","optsAddressType","optsCountry","optsState",function(e,t,r,n,a,l,s,i){"use strict";return{restrict:"A",scope:!0,templateUrl:"components/dw-address/dw-address.tpl.html",controllerAs:"dwAddress",bindToController:{secondStreet:"<",notRequired:"<"},controller:["$scope","$element","$attrs",function(e,t,f){var c=this;c.types=l.map(function(e){return angular.extend(e,{name:n.instant(e.name)})}),c.countries=s,c.states=i,c.address=e.$eval(f.dwAddress),c.hasType=e.$eval(f.dwAddressType),c.onChangeCountry=function(){r(function(){"US"===c.address.country.id?c.address.state=a.findByKeyValue(i.US,"id","CA"):angular.isObject(c.address.state)&&delete c.address.state})}}]}}])},qPMi:function(e,t){e.exports='<form name=chargeForm class=recurring-charges id=recurringCharge ff-bulk-read-only> <h4 class=page-title ng-bind=state.getPageTitle()></h4> <div class="ff-grid gutter-v gutter-h"> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.GENERAL.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.GENERAL.BILLING_FREQUENCY></req></ff-label> <ff-select ff-model=$ctrl.charge.billingFrequency ff-required=true name=billingFrequency ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.BILLING_FREQUENCY\' | translate}}" ff-options="freq.name for freq in $ctrl.billingFrequencies" ff-change=$ctrl.billingFrequencyChange()> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.GENERAL.PRODUCT></req></ff-label> <ff-select ff-model=$ctrl.charge.priceListProduct ff-required=true name=priceListProduct ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.PRODUCT\' | translate}}" ff-options="priceListProduct.productName for priceListProduct in $ctrl.billingFrequencyProducts[$ctrl.charge.billingFrequency.id]"> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.PRICE_LIST></span></ff-label> <ff-static>{{$ctrl.charge.priceListProduct.priceListName | nd}}</ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.DESCRIPTION></span></ff-label> <ff-text ff-model=$ctrl.charge.description name=description ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.DESCRIPTION\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.GENERAL.QUANTITY></req></ff-label> <ff-number name=quantity ff-model=$ctrl.charge.quantity ff-required=true ff-validate-alert="{{\'RECURRING_BILLING.GENERAL.QUANTITY\' | translate}}"></ff-number> </label> <ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.INVOICE_SENT></span></ff-label> <ff-static ff-bind="::$ctrl.charge.invoiceSent | yesno" name=invoiceSent></ff-static> </ff-row> <label class=ff-row ng-if="!$ctrl.charge.id && $resolve.settings.prorateAtStart && $ctrl.charge.billingFrequency.id === \'monthly\'"> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.GENERAL.POST_PRO_RATION></span></ff-label> <ff-label> <ff-checkbox name=postProration ff-model=$ctrl.charge.postProration></ff-checkbox> </ff-label> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.GENERAL.ATTACHED_RES_UNIT></span> <ff-hint><span translate=RECURRING_BILLING.GENERAL.ATTACHED_RES_UNIT.HINT></span></ff-hint> </span> </ff-label> <ff-select ff-model=$ctrl.charge.attachedReservationUnitId name=attachedReservationUnit> <option translate=GLOBAL.NONE></option> <option ng-repeat="resUnit in $ctrl.reservationUnits" ng-value=resUnit.id>{{resUnit.name}}</option> </ff-select> </label> <ff-row ng-if="$ctrl.charge.billingFrequency.id === \'asNeeded\'"> <label flex="1 1 auto"> <ff-label flex="0 0 126px"><req translate=RECURRING_BILLING.DATES.PASS_BALANCE></req></ff-label> <ff-number name=passBalance ff-model=$ctrl.charge.passBalance ff-required=true ff-validate-alert="{{\'RECURRING_BILLING.DATES.PASS_BALANCE\' | translate}}"></ff-number> </label> <ff-btn-group flex="0 0 auto" ng-if=$ctrl.charge.id style=z-index:3> <ff-btn sense=ok size=sm ff-click=$ctrl.saveCharge(true)> <span translate=RECURRING_BILLING.DATES.BTN_REFILL></span> </ff-btn> </ff-btn-group> </ff-row> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.DATES.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px" ff-required=true> <span translate=RECURRING_BILLING.DATES.LAST_BILL_DATE></span> </ff-label> <ff-date ff-model=$ctrl.charge.lastBillDate ff-required=true name=lastBillDate ff-validate-alert="{{\'RECURRING_BILLING.DATES.LAST_BILL_DATE\' | translate}}"></ff-date> </label> <label class=ff-row ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'"> <ff-label flex="0 0 126px" ff-required={{!$ctrl.isNextBillDateDisabled()}} ng-disabled=$ctrl.isNextBillDateDisabled()> <span translate=RECURRING_BILLING.DATES.NEXT_BILL_DATE></span> </ff-label> <ff-date ff-model=$ctrl.charge.nextBillDate ff-required=true name=nextBillDate ng-if=!$ctrl.isNextBillDateDisabled() ff-validate-alert="{{\'RECURRING_BILLING.DATES.NEXT_BILL_DATE\' | translate}}"></ff-date> <ff-static ff-disabled=true ng-if=$ctrl.isNextBillDateDisabled()>-</ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.DATES.ENTRY_DATE></span></ff-label> <ff-static name=entryDate ff-bind="$ctrl.charge.entryDate | date:\'mediumDate\'"></ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <req translate=RECURRING_BILLING.DATES.START_DATE></req> <ff-hint><span translate=RECURRING_BILLING.DATES.START_DATE.HINT></span></ff-hint> </span> </ff-label> <ff-date name=startDate ff-model=$ctrl.charge.startDate ff-required=true ff-validate-alert="{{\'RECURRING_BILLING.DATES.START_DATE\' | translate}}"></ff-date> </label> <label class=ff-row ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'"> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.DATES.NOTICE_DATE></span> <ff-hint><span translate=RECURRING_BILLING.DATES.NOTICE_DATE.HINT></span></ff-hint> </span> </ff-label> <ff-date ff-model=$ctrl.charge.noticeDate name=noticeDate ff-change=$ctrl.calcTerminationDate() ff-validate-alert="{{\'RECURRING_BILLING.DATES.NOTICE_DATE\' | translate}}"></ff-date> </label> <label class=ff-row ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'" ng-show=$ctrl.charge.noticeDate> <ff-label flex="0 0 126px"><small translate=RECURRING_BILLING.DATES.NOTICE_DATE.ADDED_BY></small></ff-label> <ff-static ff-bind="$ctrl.charge.noticeDateAddedBy || (state.getLoggedUser().firstName + \' \' + state.getLoggedUser().lastName)"></ff-static> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.DATES.NOTICE_PERIOD></span> <ff-hint><span translate=RECURRING_BILLING.DATES.NOTICE_PERIOD.HINT></span></ff-hint> </span> </ff-label> <ff-select name=noticePeriod ff-model=$ctrl.charge.noticePeriod ff-options="period.name for period in $ctrl.noticePeriods" ff-change=$ctrl.calcTerminationDate() ff-validate-alert="{{\'RECURRING_BILLING.DATES.NOTICE_PERIOD\' | translate}}"> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <span translate=RECURRING_BILLING.DATES.TERMINATE></span> <ff-hint><span translate=RECURRING_BILLING.DATES.TERMINATE.HINT></span></ff-hint> </span> </ff-label> <ff-date name=terminate ff-model=$ctrl.charge.terminate ng-if="$ctrl.charge.billingFrequency.id !== \'asNeeded\'" ff-validate-alert="{{\'RECURRING_BILLING.DATES.TERMINATE\' | translate}}"></ff-date> <ff-select name=terminate ff-model=$ctrl.charge.terminate ng-if="$ctrl.charge.billingFrequency.id === \'asNeeded\'" ff-options="opt.name for opt in $ctrl.optsTerminate" ff-validate-alert="{{\'RECURRING_BILLING.DATES.TERMINATE\' | translate}}"></ff-select> </label> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.DISCOUNT.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px"><span translate=RECURRING_BILLING.DISCOUNT.TYPE></span></ff-label> <ff-select ff-model=$ctrl.charge.discountType ff-required=true name=discountType ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.TYPE\' | translate}}" ff-options="type.name for type in $ctrl.discountTypes"> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px" ng-disabled=!$ctrl.charge.discountType.id> <req translate=RECURRING_BILLING.DISCOUNT.VALUE></req> </ff-label> <ff-text ff-model=$ctrl.charge.discountValue name=discountValue ff-required=$ctrl.charge.discountType.id ff-disabled=!$ctrl.charge.discountType.id ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.VALUE\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 0 126px" ng-disabled=!$ctrl.charge.discountType.id> <req translate=RECURRING_BILLING.DISCOUNT.MONTHS></req> </ff-label> <ff-select ff-model=$ctrl.charge.discountTrialOccurrences name=discountTrialOccurrences ff-required=$ctrl.charge.discountType.id ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.MONTHS\' | translate}}" ff-options="trial.name for trial in $ctrl.discountTrialOccurrences" ff-disabled=!$ctrl.charge.discountType.id> </ff-select> </label> <label class=ff-row> <ff-label flex="0 0 126px" ng-disabled=!$ctrl.charge.discountType.id> <req translate=RECURRING_BILLING.DISCOUNT.START_DATE></req> </ff-label> <ff-date ff-model=$ctrl.charge.discountStartDate ff-required=$ctrl.charge.discountType.id name=discountStartDate ff-disabled=!$ctrl.charge.discountType.id ff-validate-alert="{{\'RECURRING_BILLING.DISCOUNT.START_DATE\' | translate}}"></ff-date> </label> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-panel-header><span translate=RECURRING_BILLING.STATUS_NOTES.HEADER></span></ff-panel-header> <label class=ff-row> <ff-label flex="0 0 126px"> <span> <req translate=RECURRING_BILLING.STATUS_NOTES.STATUS></req> <ff-hint ng-if="$ctrl.charge.status.id === \'active\'"> <span translate=RECURRING_BILLING.STATUS_NOTES.STATUS.HINT></span> </ff-hint> <ff-hint hint-type=warning ng-if="$ctrl.charge.existOutstandingUsages && ($ctrl.charge.status.id === \'deleted\' || $ctrl.charge.status.id === \'inactive\')"> <span translate=RECURRING_BILLING.STATUS_NOTES.STATUS.WARNING></span> </ff-hint> </span> </ff-label> <ff-select ff-model=$ctrl.charge.status ff-required=true name=status ff-options="status.name for status in $ctrl.chargeStatuses" ff-validate-alert="{{\'RECURRING_BILLING.STATUS_NOTES.STATUS\' | translate}}" ff-change=$ctrl.onChangeStatus()> </ff-select> </label> <ff-static ng-if="$ctrl.activeChargesCount < 2 && $ctrl.initialStatus.id === \'active\' && ($ctrl.charge.status.id === \'inactive\' || $ctrl.charge.status.id === \'deleted\')"> <ff-col> <label> <ff-checkbox name=makeMemberInactive ff-model=$ctrl.charge.makeMemberInactive> <span translate=RECURRING_BILLING.STATUS_NOTES.INACTIVATE_MEMBER></span> </ff-checkbox> </label> <label> <ff-checkbox name=makeCoMembersInactive ff-model=$ctrl.charge.makeCoMembersInactive> <span translate=RECURRING_BILLING.STATUS_NOTES.INACTIVATE_CO_MEMBERS></span> </ff-checkbox> </label> </ff-col> </ff-static> <label class=ff-row> <ff-label flex="{xs: \'0 0 60px\', lg: \'0 0 126px\'}"> <span translate=RECURRING_BILLING.STATUS_NOTES.NOTES class=ff-flex-start style=padding-top:.5rem></span> </ff-label> <ff-textarea style=min-height:108px ff-model=$ctrl.charge.notes name=notes></ff-textarea> </label> </ff-panel> <ff-btn-group> <ff-btn sense=save ff-click=$ctrl.saveCharge() ff-disabled=chargeForm.$pristine> <span translate=GLOBAL.BTN_SAVE></span> </ff-btn> <ff-btn sense=back ff-click=$ctrl.backToList()><span translate=GLOBAL.BTN_BACK></span></ff-btn> <ff-btn sense=collapseBtn ng-if=$ctrl.charge.id ff-click="$ctrl.showAudit = !$ctrl.showAudit" ng-class="{ collapsed: !$ctrl.showAudit }"> <span translate=RECURRING_BILLING.AUDIT.BTN_COLLAPSE></span> </ff-btn> </ff-btn-group> </div> </form> <div ng-if=$ctrl.showAudit class=animate-collapse> <recurring-charge-audit price-list-products=$ctrl.charge.options.priceListProducts recurring-charge-id=$ctrl.charge.id reservation-units=$resolve.resUnits></recurring-charge-audit> </div> '},qiKn:function(e,t,r){"use strict";r.r(t);r("2UZ+");t.default=angular.module("deskworks.dwInvoicePaymentProcessingFee",["deskworks.state","deskworks.helper"]).directive("dwInvoicePaymentProcessingFee",function(){return{restrict:"A",scope:!0,controller:"DwInvoicePaymentProcessingFeeCtrl as $ctrl",bindToController:{invoice:"<",settings:"<",creditCards:"<",eChecks:"<"}}}).controller("DwInvoicePaymentProcessingFeeCtrl",["$scope","state","helper",function(e,t,r){var n=this;n.$onChanges=function(){if(n.invoice&&n.settings&&n.creditCards&&n.eChecks&&n.settings.enablePaymentProcessingCharges){var e=0;n.creditCards.length?e=n.settings.paymentProcessingRates.cc||0:n.eChecks.length&&(e=n.settings.paymentProcessingRates.ach||0);var t=n.invoice.items.findIndex(function(e){return"fake-payment-processing-fee"===e.id});if(t>=0&&n.invoice.items.splice(t,1),e&&+n.invoice.balance){var a=r.round(e*+n.invoice.balance/100),l={addedBy:"system",amount:a,billedAt:moment(),createdAt:moment(),description:"Payment processing fee",id:"fake-payment-processing-fee",name:"Payment Fee",price:a,quantity:1};n.invoice.items.push(l),angular.isUndefined(n.invoice.chargesTotalInitial)&&(n.invoice.chargesTotalInitial=+n.invoice.chargesTotal),angular.isUndefined(n.invoice.balanceInitial)&&(n.invoice.balanceInitial=+n.invoice.balance),n.invoice.chargesTotal=r.round(n.invoice.chargesTotalInitial+a),n.invoice.balance=r.round(n.invoice.balanceInitial+a)}}}}])},qoyf:function(e,t){e.exports='<div class=purchase ff-bulk-read-only> <h4 class=page-title>{{state.getPageTitle()}}</h4> <div class=gutter-v> <ff-panel> <ff-panel-header ng-if=vm.reg><span translate=GLOBAL.STEP_X_OF_Y translate-values=vm.reg></span></ff-panel-header> <ff-header style=margin-bottom:.5rem><span translate=PURCHASE.LIST.ORDER_ID></span>: {{vm.purchase.orderId}}</ff-header> <dw-invoice invoice=vm.purchase center=vm.center update-invoice=vm.updateInvoice()></dw-invoice> </ff-panel> <form name=formConsolidate ng-if="vm.consolidatePurchases.length > 0"> <ff-panel> <ff-header><span translate=PURCHASE.CONSOLIDATE></span></ff-header> <ff-row class=gutter-h-half> <ff-select flex="0 0 120px" name=purchaseToConsolidate ff-model=vm.purchaseToConsolidate ff-options="purchase.name for purchase in vm.consolidatePurchases"></ff-select> <ff-btn flex=none type=submit sense=merge size=sm ff-click=vm.consolidatePurchase(vm.purchaseToConsolidate)> <span translate=PURCHASE.BTN_COMBINE></span> </ff-btn> </ff-row> </ff-panel> </form> <div ng-if=vm.reg> <ng-include src="\'purchasePaymentTpl\'"></ng-include> </div> <div ng-if=!vm.reg style=margin-bottom:.5rem> <div> <ff-btn sense=collapse ff-click="vm.payment.collapsed = !vm.payment.collapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !vm.payment.collapsed }"> <span translate=PURCHASE.PAYMENT.BTN_ADD></span> </ff-btn> <div ng-collapse=!vm.payment.collapsed><ng-include src="\'purchasePaymentTpl\'"></ng-include></div> </div> <div> <ff-btn sense=collapse ff-click="vm.deposit.collapsed = !vm.deposit.collapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !vm.deposit.collapsed }"> <span translate=PURCHASE.DEPOSIT.BTN_ADD></span> </ff-btn> <div ng-collapse=!vm.deposit.collapsed><ng-include src="\'purchaseDepositTpl\'"></ng-include></div> </div> <div> <ff-btn sense=collapse ff-click="vm.discount.collapsed = !vm.discount.collapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !vm.discount.collapsed }"> <span translate=PURCHASE.DISCOUNT.BTN_ADD></span> </ff-btn> <div ng-collapse=!vm.discount.collapsed><ng-include src="\'purchaseDiscountTpl\'"></ng-include></div> </div> <div> <ff-btn sense=collapse ff-click="vm.refund.collapsed = !vm.refund.collapsed" class=dw-add-charges-collapse-btn ng-class="{ collapsed: !vm.refund.collapsed }"> <span translate=PURCHASE.REFUND.BTN_ADD></span> </ff-btn> <div ng-collapse=!vm.refund.collapsed><ng-include src="\'purchaseRefundTpl\'"></ng-include></div> </div> </div> <dw-add-charges purchase=vm.purchase update-invoice=vm.updateInvoice() user-price-list=vm.userPriceList></dw-add-charges> <ff-btn-group class=buttons-bottom ng-if=!vm.reg> <ff-btn sense=back ff-click=vm.backToPurchases()><span translate=GLOBAL.BTN_BACK></span></ff-btn> </ff-btn-group> </div> </div> <script type=text/ng-template id=purchasePaymentTpl> <form name="formPayment">\n    <ff-panel class="ff-bmargin">\n      <ff-header><span translate="PURCHASE.PAYMENT.HEADER"></span></ff-header>\n\n      <div class="ff-grid gutter-h-half">\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.POST_DATE"></span></ff-label>\n          <ff-static ff-bind="vm.postDate | date:\'mediumDate\'"></ff-static>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.RECEIVED_DATE"></req></ff-label>\n          <ff-date name="receivedAt" ff-model="vm.payment.receivedAt" ff-required="true"\n                   ff-validate-alert="{{\'PURCHASE.PAYMENT.RECEIVED_DATE\' | translate}}"></ff-date>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row" ng-if="!vm.plusPaymentProcessingFee(vm.payment)">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.AMOUNT"></req></ff-label>\n          <ff-price name="amount" ff-model="vm.payment.amount" ff-required="true" ff-gte="0"\n                    ff-validate-alert="{ field: (\'PURCHASE.PAYMENT.AMOUNT\' | translate), gte: (\'PURCHASE.PAYMENT.AMOUNT.NEGATIVE\' | translate) }"></ff-price>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row" ng-if="vm.plusPaymentProcessingFee(vm.payment)">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.AMOUNT"></req></ff-label>\n          <ff-price flex="0 0 70px" name="amount" ff-model="vm.payment.amount" ff-required="true" ff-gte="0"\n                    ff-validate-alert="{ field: (\'PURCHASE.PAYMENT.AMOUNT\' | translate), gte: (\'PURCHASE.PAYMENT.AMOUNT.NEGATIVE\' | translate) }"></ff-price>\n          <ff-label>\n            <span>\n              + {{$resolve.settings.paymentProcessingRates[vm.payment.method.id]}}%\n              <span translate="PURCHASE.PAYMENT_PROCESSING_FEE"></span> =\n              <strong>{{vm.plusPaymentProcessingFee(vm.payment) | ncurrency}}</strong>\n            </span>\n          </ff-label>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.NOTES"></span></ff-label>\n          <ff-text name="notes" ff-model="vm.payment.notes" ff-maxlength="256"></ff-text>\n        </label>\n\n        <div class="payment-submit" flex="{md: \'0 0 50%\'}">\n          <div class="ff-grid">\n            <ff-btn flex="{sm: \'none\'}" sense="save" size="sm" type="submit" ff-click="vm.createPayment()">\n              <span translate="PURCHASE.PAYMENT.BTN_SUBMIT"></span>\n            </ff-btn>\n\n            <label flex="auto" class="ff-row">\n              <span flex="none" translate="PURCHASE.PAYMENT.USING"></span>\n              <ff-select flex="auto" name="paymentMethod" ff-model="vm.payment.method"\n                         ff-options="paymentMethod.name for paymentMethod in vm.paymentMethods"></ff-select>\n            </label>\n          </div>\n        </div>\n      </div>\n\n    </ff-panel>\n  </form> <\/script> <script type=text/ng-template id=purchaseDepositTpl> <form name="formDeposit">\n    <ff-panel class="ff-bmargin">\n      <ff-header><span translate="PURCHASE.DEPOSIT.HEADER"></span></ff-header>\n\n      <div class="ff-grid gutter-h-half">\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.POST_DATE"></span></ff-label>\n          <ff-static ff-bind="vm.postDate | date:\'mediumDate\'"></ff-static>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.RECEIVED_DATE"></req></ff-label>\n          <ff-date name="receivedAt" ff-model="vm.deposit.receivedAt" ff-required="true"\n                   ff-validate-alert="{{\'PURCHASE.PAYMENT.RECEIVED_DATE\' | translate}}"></ff-date>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row" ng-if="!vm.plusPaymentProcessingFee(vm.deposit)">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.AMOUNT"></req></ff-label>\n          <ff-price name="amount" ff-model="vm.deposit.amount" ff-required="true" ff-gte="0"\n                    ff-validate-alert="{ field: (\'PURCHASE.PAYMENT.AMOUNT\' | translate), gte: (\'PURCHASE.PAYMENT.AMOUNT.NEGATIVE\' | translate) }"></ff-price>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row" ng-if="vm.plusPaymentProcessingFee(vm.deposit)">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.AMOUNT"></req></ff-label>\n          <ff-price flex="0 0 70px" name="amount" ff-model="vm.deposit.amount" ff-required="true" ff-gte="0"\n                    ff-validate-alert="{ field: (\'PURCHASE.PAYMENT.AMOUNT\' | translate), gte: (\'PURCHASE.PAYMENT.AMOUNT.NEGATIVE\' | translate) }"></ff-price>\n          <ff-label>\n            <span>\n              + {{$resolve.settings.paymentProcessingRates[vm.deposit.method.id]}}%\n              <span translate="PURCHASE.PAYMENT.PROCESSING_FEE"></span> =\n              <strong>{{vm.plusPaymentProcessingFee(vm.deposit) | ncurrency}}</strong>\n            </span>\n          </ff-label>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.NOTES"></span></ff-label>\n          <ff-text name="notes" ff-model="vm.deposit.notes" ff-maxlength="256"></ff-text>\n        </label>\n\n        <div class="payment-submit" flex="{md: \'0 0 50%\'}">\n          <div class="ff-grid">\n            <ff-btn flex="{sm: \'none\'}" sense="save" type="submit" ff-click="vm.createDeposit()" size="sm">\n              <span translate="PURCHASE.DEPOSIT.BTN_SUBMIT"></span>\n            </ff-btn>\n\n            <label flex="auto" class="ff-row">\n              <span flex="none" class="ff-center" translate="PURCHASE.PAYMENT.USING"></span>\n              <ff-select flex="auto" name="paymentMethod" ff-model="vm.deposit.method"\n                         ff-options="paymentMethod.name for paymentMethod in vm.paymentMethods"></ff-select>\n            </label>\n          </div>\n        </div>\n      </div>\n\n    </ff-panel>\n  </form> <\/script> <script type=text/ng-template id=purchaseDiscountTpl> <form name="formDiscount">\n    <ff-panel class="ff-bmargin">\n      <ff-header><span translate="PURCHASE.DISCOUNT.HEADER"></span></ff-header>\n\n      <div class="ff-grid gutter-h-half">\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.POST_DATE"></span></ff-label>\n          <ff-static ff-bind="vm.postDate | date:\'mediumDate\'"></ff-static>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.RECEIVED_DATE"></req></ff-label>\n          <ff-date name="receivedAt" ff-model="vm.discount.receivedAt" ff-required="true"\n                   ff-validate-alert="{{\'PURCHASE.PAYMENT.RECEIVED_DATE\' | translate}}"></ff-date>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.NOTES"></span></ff-label>\n          <ff-text ff-model="vm.discount.notes"></ff-text>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px" ff-required="true">Amount</ff-label>\n          <ff-price name="amount" ff-model="vm.discount.amount" ff-required="true" ff-gt="0"\n                    ff-validate-alert="{ field: (\'PURCHASE.PAYMENT.AMOUNT\' | translate), gt: (\'PURCHASE.DISCOUNT.AMOUNT.NEGATIVE\' | translate) }"></ff-price>\n        </label>\n      </div>\n\n      <div class="payment-submit">\n        <ff-btn flex="none" sense="save" type="submit" ff-click="vm.createDiscount()" size="sm">\n          <span translate="PURCHASE.DISCOUNT.BTN_SUBMIT"></span>\n        </ff-btn>\n      </div>\n    </ff-panel>\n  </form> <\/script> <script type=text/ng-template id=purchaseRefundTpl> <form name="formRefund">\n    <ff-panel class="ff-bmargin">\n      <ff-header><span translate="PURCHASE.REFUND.HEADER"></span></ff-header>\n\n      <div class="ff-grid gutter-h-half">\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.POST_DATE"></span></ff-label>\n          <ff-static ff-bind="vm.postDate | date:\'mediumDate\'"></ff-static>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><span translate="PURCHASE.PAYMENT.NOTES"></span></ff-label>\n          <ff-text ff-model="vm.refund.notes"></ff-text>\n        </label>\n\n        <label flex="{md: \'0 0 50%\'}" class="ff-row">\n          <ff-label flex="0 0 104px"><req translate="PURCHASE.PAYMENT.AMOUNT"></req></ff-label>\n          <ff-price name="amount" ff-model="vm.refund.amount" ff-required="true" ff-gt="0"\n                    ff-validate-alert="{ field: (\'PURCHASE.PAYMENT.AMOUNT\' | translate), gt: (\'PURCHASE.REFUND.AMOUNT.NEGATIVE\' | translate) }"></ff-price>\n        </label>\n\n        <span>\x3c!-- flexbox empty cell --\x3e</span>\n\n        <div class="payment-submit" flex="{md: \'0 0 50%\'}">\n          <div class="ff-grid">\n            <ff-btn flex="{sm: \'none\'}" sense="save" type="submit" ff-click="vm.createRefund()" size="sm">\n              <span translate="PURCHASE.REFUND.BTN_SUBMIT"></span>\n            </ff-btn>\n\n            <label flex="auto" class="ff-row">\n              <span flex="none" class="ff-center" translate="PURCHASE.PAYMENT.USING"></span>\n              <ff-select flex="auto" name="refundMethod" ff-model="vm.refund.method"\n                         ff-options="refundMethod.name for refundMethod in vm.refundMethods"></ff-select>\n            </label>\n          </div>\n        </div>\n      </div>\n\n    </ff-panel>\n  </form> <\/script> '},"u/SX":function(e,t){e.exports='<div id=checkIn ng-if=!vm.countdown> <h4 class=page-title>Welcome to {{vm.center.name}}!</h4> <form name=formCheckIn class=check-in novalidate ff-dim=vm.busy> <ff-info ng-if=!vm.error class=text-primary style=font-size:16px;font-weight:300>Please Check In / Out</ff-info> <ff-info ng-if=vm.error ng-bind=vm.error class=text-danger style=font-size:16px;font-weight:300></ff-info> <ff-row> <label> <ff-label flex="0 0 116px">Access Number</ff-label> <ff-text name=accessCardNumber ff-model=vm.accessCardNumber></ff-text> </label> </ff-row> <ff-row> <ff-info flex="0 0 116px" class="ff-center text-primary" style=font-weight:300>&mdash; or &mdash;</ff-info> </ff-row> <ff-row> <label> <ff-label flex="0 0 116px">Login</ff-label> <ff-login name=login ff-model=vm.login ff-required=vm.password ff-maxlength=256 ff-validate-alert="{{\'GLOBAL.LOGIN\' | translate}}"></ff-login> </label> </ff-row> <ff-row> <label> <ff-label flex="0 0 116px">Password</ff-label> <ff-password name=password ff-model=vm.password ff-required=vm.login ff-maxlength=256 ff-validate-alert="{{\'GLOBAL.PASSWORD\' | translate}}"></ff-password> </label> </ff-row> <ff-btn-group class=buttons-bottom> <ff-btn flex="0 0 auto" type=submit sense=checkIn ff-click=vm.auth()>Check In</ff-btn> <ff-btn flex="0 0 auto" sense=checkOut ff-click=vm.auth(true)>Check Out</ff-btn> </ff-btn-group> </form> <kbw-access-card></kbw-access-card> </div> <div id=checkInSuccess ng-if=vm.countdown class=check-in> <h4 class=page-title>Thank You!</h4> <ff-btn-group class=ff-center> <ff-btn sense=ok ff-click=vm.init() ff-countdown=vm.countdown>OK</ff-btn> </ff-btn-group> </div>'},uiPC:function(e,t,r){"use strict";r.r(t);r("it7j");angular.module("deskworks.RecurringChargeAudit",["ngResource","datesDeserializer","deskworks.config","deskworks.billing.optsBillingFrequency","deskworks.billing.optsRecurringChargeStatus","deskworks.billing.optsNoticePeriod","deskworks.billing.optsDiscountType","deskworks.userProfile.optsMonthsOfDiscount","deskworks.billing.optsRecurringChargeTerminate","deskworks.billing.optsRenewalTerm","deskworks.billing.optsRenewalNoticePeriod"]).factory("RecurringChargeAudit",["$resource","$q","$timeout","$filter","$rootScope","$translate","deskworksConfig","helper","datesDeserializer","optsBillingFrequency","optsRecurringChargeStatus","optsNoticePeriod","optsDiscountType","optsMonthsOfDiscount","optsRecurringChargeTerminate","optsRenewalTerm","optsRenewalNoticePeriod",function(e,t,r,n,a,l,s,i,f,c,o,d,u,p,m,h,g){var b=function(e){return n("date")(e,"mediumDate")},I=function(e,t){return t=t||"name",angular.isString(e)?function(r,n){return(i.find(n[e],r)||{})[t]||"-"}:function(r,n){return(i.find(e,r)||{})[t]||"-"}},C=[{id:"priceListProductId",_name:"RECURRING_BILLING.GENERAL.PRODUCT",filter:I("priceListProducts","productName")},{id:"description",_name:"RECURRING_BILLING.GENERAL.DESCRIPTION"},{id:"quantity",_name:"RECURRING_BILLING.GENERAL.QUANTITY"},{id:"attachedReservationUnitId",_name:"RECURRING_BILLING.GENERAL.ATTACHED_RES_UNIT",filter:I("reservationUnits")},{id:"passBalance",_name:"RECURRING_BILLING.GENERAL.PASS_BALANCE"},{id:"invoiceSent",_name:"RECURRING_BILLING.GENERAL.INVOICE_SENT",filter:function(e){return n("yesno")(e)}},{id:"lastBillDate",_name:"RECURRING_BILLING.DATES.LAST_BILL_DATE",filter:b},{id:"nextBillDate",_name:"RECURRING_BILLING.DATES.NEXT_BILL_DATE",filter:b},{id:"startDate",_name:"RECURRING_BILLING.DATES.START_DATE",filter:b},{id:"noticeDate",_name:"RECURRING_BILLING.DATES.NOTICE_DATE",filter:b},{id:"noticePeriod",_name:"RECURRING_BILLING.DATES.NOTICE_PERIOD",filter:I(d)},{id:"terminate",_name:"RECURRING_BILLING.DATES.TERMINATE",filter:function(e,t){return(i.find(m,e)||{}).name||b(e)||"-"}},{id:"renewalDate",_name:"RECURRING_BILLING.RENEWAL_DATE",filter:b},{id:"renewalTerm",_name:"RECURRING_BILLING.RENEWAL_TERM",filter:I(h)},{id:"renewalNoticePeriod",_name:"RECURRING_BILLING.RENEWAL_NOTICE_PERIOD",filter:I(g)},{id:"discountTypeId",_name:"RECURRING_BILLING.DISCOUNT.TYPE",filter:I(u)},{id:"discountValue",_name:"RECURRING_BILLING.DISCOUNT.VALUE"},{id:"discountTrialOccurrences",_name:"RECURRING_BILLING.DISCOUNT.MONTHS",filter:I(p)},{id:"discountStartDate",_name:"RECURRING_BILLING.DISCOUNT.START_DATE",filter:b},{id:"status",_name:"RECURRING_BILLING.STATUS_NOTES.STATUS",filter:I(o)},{id:"notes",_name:"RECURRING_BILLING.STATUS_NOTES.NOTES"}];function E(){C.forEach(function(e){e.name=l.instant(e._name)})}E(),a.$on("$setTranslationsSuccess",E);var v=f(["createdAt","lastBillDate.old","lastBillDate.new","nextBillDate.old","nextBillDate.new","startDate.old","startDate.new","noticeDate.old","noticeDate.new","renewalDate.old","renewalDate.new","discountStartDate.old","discountStartDate.new","terminate.old","terminate.new"]),A=e(s.getApiAbsUrl("/centers/:centerId/user-profiles/:userId/recurring-charges/:recurringId/audit"),{},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,v]}});return{query:function(e,t,r,n,a){return A.query({centerId:e,userId:t,recurringId:r,offset:n,limit:a}).$promise},getProps:function(){return C}}}])},vt7a:function(e,t){e.exports='<label class=ff-row> <ff-label flex="0 0 132px" class=ff-small> <req translate=BILLING_PROFILE.E_CHECKS.ACCOUNT_HOLDER_TYPE></req> </ff-label> <ff-select name=bankAccountHolderType ff-model=dwEC.check.bankAccountHolderType ff-options="type.name for type in dwEC.optsBankAccountHolderType" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.E_CHECKS.ACCOUNT_HOLDER_TYPE\' | translate}}"></ff-select> </label> <label class=ff-row> <ff-label flex="0 0 132px"> <req translate=BILLING_PROFILE.E_CHECKS.ACCOUNT_TYPE></req> </ff-label> <ff-select name=bankAccountType ff-model=dwEC.check.bankAccountType ff-options="type.name for type in dwEC.optsBankAccountType" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.E_CHECKS.ACCOUNT_TYPE\' | translate}}"></ff-select> </label> <label class=ff-row> <ff-label flex="0 0 132px"> <req translate=BILLING_PROFILE.E_CHECKS.BANK_NAME></req> </ff-label> <ff-text name=bankName ff-model=dwEC.check.bankName placeholder="Bank of America" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.E_CHECKS.BANK_NAME\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 0 132px"> <req translate=BILLING_PROFILE.E_CHECKS.ROUTING_NUMBER></req> </ff-label> <ff-text name=bankRoutingNumber ff-model=dwEC.check.bankRoutingNumber ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.E_CHECKS.ROUTING_NUMBER\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 0 132px"> <req translate=BILLING_PROFILE.E_CHECKS.ACCOUNT_NUMBER></req> </ff-label> <ff-text name=bankAccountNumber ff-model=dwEC.check.bankAccountNumber ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.E_CHECKS.ACCOUNT_NUMBER\' | translate}}"></ff-text> </label> <label class=ff-row> <ff-label flex="0 0 132px"> <req translate=BILLING_PROFILE.E_CHECKS.ACCOUNT_NAME></req> </ff-label> <ff-text name=fullName ff-model=dwEC.check.fullName placeholder="John Doe" ff-required=true ff-validate-alert="{{\'BILLING_PROFILE.E_CHECKS.ACCOUNT_NAME\' | translate}}"></ff-text> </label> '},vw9M:function(e,t,r){"use strict";r.r(t);r("it7j"),r("53Pq");var n=r("2/1H");t.default=angular.module("deskworks.billing.purchase.edit",["ngRoute","deskworks.center.service","deskworks.purchase.service","deskworks.userProfile.service","deskworks.inventory.priceList.service","deskworks.routeHelper","deskworks.helper","deskworks.billing.optsPaymentMethod","deskworks.billing.optsRefundMethod","deskworks.dwAddCharges",n.a.name]).config(["$routeProvider",function(e){e.when("/purchases/:purchaseId/edit",{templateUrl:"billing/purchase/purchase-edit.tpl.html",controller:"PurchaseEditCtrl as vm",label:"Edit",routeBranch:"purchases",translations:["purchase"],resolve:{reg:function(){},purchase:["$route","dwAlerts","state","purchaseService","routeHelper","resolveTimezone",function(e,t,r,n,a,l){return a.auth().then(function(){return a.selectUser()}).then(function(){return l()}).then(function(){return n.get(r.getCurrentCenterId(),r.getCurrentUserId(),e.current.params.purchaseId).catch(function(e){return t.error(e,"Failed to get purchase.")})})}],user:["dwAlerts","routeHelper","state","userProfileService","resolveTimezone",function(e,t,r,n,a){return t.auth().then(function(){return t.selectUser()}).then(function(){return a()}).then(function(){return n.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to get user profile.")})})}],center:["dwAlerts","centerService","state",function(e,t,r){return t.get(r.getCurrentCenterId(r.getCurrentCenterId())).catch(function(t){return e.error(t,"Failed to get center.")})}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch(function(t){return e.error(t,"Failed to load setup settings.")})}]}}),e.when("/new-member/:userId/membership/billing-profile/purchase/:purchaseId",{templateUrl:"billing/purchase/purchase-edit.tpl.html",controller:"PurchaseEditCtrl as vm",label:"Purchase",routeBranch:"new-member",translations:["purchase"],resolve:{reg:function(){return{member:!0,selfRegistration:!1,step:3,stepCount:3}},purchase:["$route","dwAlerts","state","purchaseService","routeHelper",function(e,t,r,n,a){return a.auth().then(function(){return a.selectUser()}).then(function(){return n.get(r.getCurrentCenterId(),e.current.params.userId,e.current.params.purchaseId).catch(function(e){return t.error(e,"Failed to get purchase.")})})}],user:["dwAlerts","routeHelper","state","userProfileService",function(e,t,r,n){return t.auth().then(function(){return t.selectUser()}).then(function(){return n.get(r.getCurrentCenterId(),r.getCurrentUserId()).catch(function(t){return e.error(t,"Failed to get user profile.")})})}],center:["dwAlerts","centerService","state",function(e,t,r){return t.get(r.getCurrentCenterId(r.getCurrentCenterId())).catch(function(t){return e.error(t,"Failed to get center.")})}],settings:["dwAlerts","setupService",function(e,t){return t.getSetupSettings().catch(function(t){return e.error(t,"Failed to load setup settings.")})}]}})}]).controller("PurchaseEditCtrl",["$scope","$filter","$translate","dwAlerts","state","center","purchase","helper","reg","user","settings","purchaseService","priceListService","optsPaymentMethod","optsRefundMethod",function(e,t,r,n,a,l,s,i,f,c,o,d,u,p,m){var h=this;e.backPath="/purchases",e.$watch("state.getCurrentCenterId()",function(t,r){t!==r&&a.setPath(e.backPath)}),h.paymentMethods=p,h.refundMethods=m,h.center=l,h.reg=f,h.userId=a.getCurrentUserId(),h.purchaseId=s.id,h.purchase=s,h.postDate=moment();var g=c.membershipBillingMethod&&c.membershipBillingMethod.id&&h.paymentMethods.find(function(e){return e.id===c.membershipBillingMethod.id})||h.paymentMethods[0],b=c.membershipBillingMethod&&c.membershipBillingMethod.id&&h.refundMethods.find(function(e){return e.id===c.membershipBillingMethod.id})||h.refundMethods[0];h.payment={receivedAt:moment(),amount:h.purchase.balance,notes:"",method:g},h.deposit={receivedAt:moment(),notes:"",method:g},h.discount={receivedAt:moment(),amount:"0.00"},h.refund={amount:"0.00",method:b},angular.isDefined(a.getParam("redirect"))&&(h.redirect=a.getParam("redirect")),a.setPageTitle(r.instant("PURCHASE.PAGE_TITLE",{userName:c.fullName,centerName:l.name})),c.membershipPriceListId&&u.getPricelist(a.getCurrentCenterId(),c.membershipPriceListId).then(function(e){h.userPriceList=e}),h.reg||d.getPurchases(a.getCurrentCenterId(),h.userId).then(function(e){var t;h.consolidatePurchases=[],e.open.forEach(function(e){e.id==h.purchaseId?t="open":h.consolidatePurchases.push({id:+e.id,name:e.id})}),"open"!==t&&e.credit.forEach(function(e){e.id==h.purchaseId?t="credit":h.consolidatePurchases.push({id:+e.id,name:e.id})}),t||(h.consolidatePurchases=[]),h.consolidatePurchases.length>0&&(h.purchaseToConsolidate=h.consolidatePurchases[0])}),h.backToPurchases=function(){return a.setPath("/purchases")},h.createPayment=function(){if(!i.pointFirstInvalid("form[name=formPayment]")){var e={receivedAt:t("date")(h.payment.receivedAt,"yyyy-MM-dd"),amount:h.payment.amount,notes:h.payment.notes,method:h.payment.method.id};return d.createPayment(a.getCurrentCenterId(),a.getCurrentUserId(),h.purchaseId,e).catch(function(e){return n.error(e,"Failed to make payment.")}).then(function(){return h.updateInvoice()})}},h.createDeposit=function(){if(!i.pointFirstInvalid("form[name=formDeposit]")){var e={receivedAt:t("date")(h.deposit.receivedAt,"yyyy-MM-dd"),amount:h.deposit.amount,notes:h.deposit.notes,method:h.deposit.method.id};return d.createDeposit(a.getCurrentCenterId(),a.getCurrentUserId(),h.purchaseId,e).catch(function(e){return n.error(e,"Failed to make deposit.")}).then(function(){return h.updateInvoice()})}},h.createDiscount=function(){if(!i.pointFirstInvalid("form[name=formDiscount]")){var e={amount:h.discount.amount,notes:h.discount.notes,receivedAt:h.discount.receivedAt};return d.createDiscount(a.getCurrentCenterId(),a.getCurrentUserId(),h.purchaseId,e).catch(function(e){return n.error(e,"Failed to add discount.")}).then(function(){return h.updateInvoice()})}},h.createRefund=function(){if(!i.pointFirstInvalid("form[name=formRefund]")){var e={amount:h.refund.amount,method:h.refund.method.id,notes:h.refund.notes};return d.createRefund(a.getCurrentCenterId(),a.getCurrentUserId(),h.purchaseId,e).catch(function(e){return n.error(e,"Failed to add refund.")}).then(function(){return h.updateInvoice()})}},h.consolidatePurchase=function(e){return d.consolidate(a.getCurrentCenterId(),a.getCurrentUserId(),h.purchaseId,e).catch(function(e){return n.error(e,"Failed to consolidate order with purchase.")}).then(function(){return h.consolidatePurchases.splice(i.findIndexByKeyValue(h.consolidatePurchases,"id",e.id),1),h.purchaseToConsolidate=h.consolidatePurchases[0],h.updateInvoice()})},h.updateInvoice=function(){return d.get(a.getCurrentCenterId(),a.getCurrentUserId(),h.purchaseId).catch(function(e){return n.error(e,"Failed to update invoice.")}).then(function(e){h.purchase=e,h.payment.amount=e.balance})},h.plusPaymentProcessingFee=function(e){var t=o.paymentProcessingRates[e.method.id];if(!o.enablePaymentProcessingCharges||!t)return 0;var r=i.round(t*+e.amount/100);return+e.amount+r}}])},w7o6:function(e,t,r){},wNfv:function(e,t){angular.module("deskworks.dwControls").directive("dwEmail",["$compile",function(e){"use strict";return{restrict:"AC",priority:30,terminal:!0,compile:function(t,r){var n=this;return r.$set("maxlength",r.maxlength||256),r.$set("ffPattern",r.ffPattern||/^[\w\.%\+\-]+@(?:[A-Z0-9\-]+\.)+(?:[A-Z]+)$/i),r.$set("ffValidateAlert",r.ffValidateAlert||"{field: 'Email', pattern: 'Email should be valid'}"),r.$set("placeholder",r.placeholder||"example@mail.com"),function(t,r,a){e(r,null,n.priority)(t)}}}}])},"wnB+":function(e,t){e.exports="<div class=dw-modal-fade ng-click=close()></div> <div class=dw-modal-dialog> <div class=dw-modal-scroll ng-transclude></div> <button class=dw-modal-cross ng-click=close()></button> </div> "}}]);