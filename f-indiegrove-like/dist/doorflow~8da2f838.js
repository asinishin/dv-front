(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"1Gax":function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowCenter",["ngResource","deskworks.config"]).factory("DoorflowCenter",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId"),{},{update:{method:"PUT"}});return{query:function(){return o.query().$promise},save:function(e){return o.update({centerId:e.id},e).$promise}}}])},"2l71":function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowAccessGroup",["ngResource","deskworks.config"]).factory("DoorflowAccessGroup",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId/doorflow-groups"));return{query:function(e){return o.query({centerId:e}).$promise}}}])},"4YMj":function(e,r){e.exports='<label class="ff-row animate-collapse" ng-if="$ctrl.doorflowCenter.enabled"> <ff-label flex="0 1 116px"><span translate="USER_PROFILE.MEMBERSHIP.DOORFLOW_ACCESS"></span></ff-label> <ff-checkbox name="doorflowEnabled" ff-model="$ctrl.doorflowUser.doorflowEnabled"> <span translate="USER_PROFILE.MEMBERSHIP.DOORFLOW_ACCESS_DESCRIPTION"></span> </ff-checkbox> </label> '},GzqZ:function(e,r,o){"use strict";o.r(r);var t=o("nbuU"),n=o.n(t);r.default=angular.module("deskworks.doorflowAccessGroupDirective",["deskworks.DoorflowAccessGroup","deskworks.DoorflowCenter","deskworks.DoorflowProduct"]).directive("doorflowAccessGroup",["$compile","$templateCache",function(e,r){return{templateUrl:"doorflow/doorflow-access-group.tpl.html",restrict:"E",scope:!0,controller:"DoorflowAccessGroupCtrl as $ctrl",bindToController:{save:"=",productId:"<"}}}]).controller("DoorflowAccessGroupCtrl",["$q","dwAlerts","helper","state","DoorflowAccessGroup","DoorflowCenter","DoorflowProduct",function(e,r,o,t,s,l,c){var f=this;function u(){return c.save(t.getCurrentCenterId(),f.productId,f.product).catch((function(e){return r.error(e,"Failed to save Doorflow product.")}))}f.$onInit=function(){f.load()},f.load=function(){var a={centers:l.query().catch((function(e){return r.error(e,"Failed to query Doorflow centers.")})),product:c.get(t.getCurrentCenterId(),f.productId).catch((function(e){return r.error(e,"Failed to load Doorflow product.")}))};return e.all(a).then((function(e){f.product=e.product;var l=n()(o).call(o,e.centers,t.getCurrentCenterId());if(l&&l.enabled)return s.query(t.getCurrentCenterId()).catch((function(e){return r.error(e,"Failed to query QuickBooks income accounts.")})).then((function(e){f.groups=e,f.groups&&f.groups.length&&(f.save=u)}))}))}}])},Jl5Q:function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowUser",["ngResource","deskworks.config"]).factory("DoorflowUser",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId/users/:userId"),{},{update:{method:"PUT"}});return{get:function(e,r){return o.get({centerId:e,userId:r}).$promise},save:function(e,r){return o.update({centerId:e,userId:r.id},r).$promise}}}])},TiEo:function(e,r,o){"use strict";o.r(r);o("3dw1"),o("Muwe"),o("y89P");var t=o("yCd9"),n=o.n(t),s=o("lRNC"),l=o.n(s),c=["$injector",function(e){var r,t,s=(r=o("fVSe"),n()(t=l()(r).call(r)).call(t,r));e.loadNewModules(n()(s).call(s,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var r=o("mMLT");l()(r).call(r).forEach((function(o){return e.put(o.replace(/^\.\//,""),r(o))}))}])}];r.default=c},"V8+7":function(e,r){e.exports='<label class="ff-row animate-collapse" ng-if="$ctrl.groups.length"> <ff-label flex="0 0 102px" class="ff-small"><span translate="PRODUCTS.DOORFLOW_GROUP"></span></ff-label> <ff-select name="doorflowAccessGroup" ff-model="$ctrl.product.doorflowGroupId" ff-options="opt.id as opt.name for opt in $ctrl.groups"> <option value="">-</option> </ff-select> </label> '},WA0m:function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowSite",["ngResource","deskworks.config"]).factory("DoorflowSite",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/doorflow-sites"),{},{update:{method:"PUT"}});return{query:function(){return o.query().$promise}}}])},XMGG:function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowSettings",["ngResource","deskworks.config"]).factory("DoorflowSettings",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/settings"),{},{update:{method:"PUT"}});return{get:function(){return o.get().$promise},save:function(e){return o.update({},e).$promise}}}])},fVSe:function(e,r,o){var t={"./access-group/doorflow-access-group.directive.js":"GzqZ","./services/doorflow-access-group.service.js":"2l71","./services/doorflow-center.service.js":"1Gax","./services/doorflow-product.service.js":"m72S","./services/doorflow-settings.service.js":"XMGG","./services/doorflow-site.service.js":"WA0m","./services/doorflow-user.service.js":"Jl5Q","./settings/doorflow-settings.directive.js":"gmNY","./user-access/doorflow-user-access.directive.js":"tMLQ"};function n(e){var r=s(e);return o(r)}function s(e){if(!o.o(t,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t[e]}n.keys=function(){return Object.keys(t)},n.resolve=s,e.exports=n,n.id="fVSe"},gmNY:function(e,r,o){"use strict";o.r(r);o("JBxO"),o("FdtR");r.default=angular.module("deskworks.doorflowSettingsDirective",["debounce","deskworks.DoorflowSettings","deskworks.DoorflowCenter","deskworks.DoorflowSite","deskworks.DoorflowAccessGroup","deskworks.center.service"]).directive("doorflowSettings",(function(){return{templateUrl:"settings/doorflow-settings.tpl.html",restrict:"E",scope:!0,controller:"DoorflowSettingsCtrl as $ctrl"}})).controller("DoorflowSettingsCtrl",["dwAlerts","$q","debounce","helper","centerService","DoorflowSettings","DoorflowCenter","DoorflowAccessGroup","DoorflowSite",function(e,r,o,t,n,s,l,c,f){var u=this;u.$onInit=function(){u.load()},u.load=function(){var o={doorflowSettings:s.get().catch((function(r){return e.error(r,"Failed to load DoorFlow settings.")})),centers:n.getCenters().catch((function(r){return e.error(r,"Failed to query centers.")})),doorflowCenters:l.query().catch((function(r){return e.error(r,"Failed to query DoorFlow centers.")})),doorflowSites:f.query().catch((function(r){return e.error(r,"Failed to query DoorFlow sites.")}))};return u.spin=!0,r.all(o).then((function(e){return u.doorflowSettings=e.doorflowSettings,u.doorflowCenters=e.doorflowCenters,u.doorflowSites=e.doorflowSites,e})).finally((function(){u.spin=!1}))},u.saveSettings=o((function(r){if(r&&r.$invalid)return;return u.spin=!0,s.save(u.doorflowSettings).catch((function(r){return e.error(r,"Failed to save DoorFlow settings.")})).finally((function(){u.spin=!1})).then((function(){return delete u.doorflowCenters,u.load()}))}),1e3),u.saveCenter=o((function(r,o){if(o&&o.$invalid)return;return r.$$spin=!0,l.save(r).finally((function(){r.$$spin=!1})).catch((function(r){return e.error(r,"Failed to save DoorFlow center.")}))}),500),u.changeSite=function(e,r){return u.saveCenter(e,r)}}])},jdTA:function(e,r){e.exports='<ff-panel> <ff-panel-header ff-spin="$ctrl.spin" class="ff-spin-right"> <span translate="INTEGRATIONS_SETUP.DOORFLOW.HEADER"></span> </ff-panel-header> <form name="form" novalidate ff-dim="$ctrl.spin"> <label class="ff-row"> <ff-label flex="0 0 120px"><req translate="INTEGRATIONS_SETUP.API_KEY"></req></ff-label> <ff-text ff-model="$ctrl.doorflowSettings.apiKey" ff-change="$ctrl.saveSettings(form)" ff-required="true" ff-validate-alert="{{\'INTEGRATIONS_SETUP.API_KEY\' | translate}}"></ff-text> </label> </form> <form name="form" novalidate ng-repeat="center in $ctrl.doorflowCenters" class="animate-collapse"> <ff-header ff-dim="center.$$spin" style="padding-top:.6rem"><cell>{{center.$$name}}</cell></ff-header> <label class="ff-row"> <ff-label flex="1 1 270px"><span translate="INTEGRATIONS_SETUP.ENABLED"></span></ff-label> <ff-static flex="1 1 305px"> <ff-checkbox name="enabled" ff-model="center.enabled" ff-change="$ctrl.saveCenter(center, form)"></ff-checkbox> </ff-static> </label> <label class="ff-row"> <ff-label flex="1 1 270px"><req translate="INTEGRATIONS_SETUP.DOORFLOW.SITE"></req></ff-label> <ff-select flex="1 1 305px" name="doorflowSiteId" ff-model="center.doorflowSiteId" ff-required="true" ff-options="site.id as site.name for site in $ctrl.doorflowSites" ff-change="$ctrl.changeSite(center, form)" ff-validate-alert="{{\'INTEGRATIONS_SETUP.DOORFLOW.SITE\' | translate}}"></ff-select> </label> </form> </ff-panel> '},m72S:function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowProduct",["ngResource","deskworks.config"]).factory("DoorflowProduct",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId/products/:productId"),{},{get:{method:"GET"},update:{method:"PUT"}});return{get:function(e,r){return o.get({centerId:e,productId:r}).$promise},save:function(e,r,t){return o.update({centerId:e,productId:r},t).$promise}}}])},mMLT:function(e,r,o){var t={"./access-group/doorflow-access-group.tpl.html":"V8+7","./settings/doorflow-settings.tpl.html":"jdTA","./user-access/doorflow-user-access.tpl.html":"4YMj"};function n(e){var r=s(e);return o(r)}function s(e){if(!o.o(t,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t[e]}n.keys=function(){return Object.keys(t)},n.resolve=s,e.exports=n,n.id="mMLT"},tMLQ:function(e,r,o){"use strict";o.r(r);var t=o("nbuU"),n=o.n(t);r.default=angular.module("deskworks.doorflowUserAccessDirective",["deskworks.DoorflowCenter","deskworks.DoorflowUser"]).directive("doorflowUserAccess",(function(){return{templateUrl:"user-access/doorflow-user-access.tpl.html",restrict:"E",scope:!0,controller:"DoorflowUserAccessCtrl as $ctrl",bindToController:{userId:"<",save:"="}}})).controller("DoorflowUserAccessCtrl",["$q","dwAlerts","helper","state","DoorflowCenter","DoorflowUser",function(e,r,o,t,s,l){var c=this;function f(){if(c.doorflowCenter.enabled)return c.doorflowUser.id=c.userId,l.save(t.getCurrentCenterId(),c.doorflowUser).catch((function(e){return r.error(e,"Failed to save DoorFlow user.")}))}c.$onInit=function(){c.load()},c.load=function(){return s.query().catch((function(e){return r.error(e,"Failed to query DoorFlow centers.")})).then((function(s){if(c.doorflowCenter=n()(o).call(o,s,t.getCurrentCenterId()),c.doorflowCenter&&c.doorflowCenter.enabled){var u={};return c.userId&&"new"!==c.userId&&!o.isUid(c.userId)&&(u.doorflowUser=l.get(t.getCurrentCenterId(),c.userId).catch((function(e){return r.error(e,"Failed to get DoorFlow user.")}))),e.all(u).then((function(e){e.doorflowUser?c.doorflowUser=e.doorflowUser:c.doorflowUser={doorflowEnabled:!1},c.save=f}))}}))}}])}}]);