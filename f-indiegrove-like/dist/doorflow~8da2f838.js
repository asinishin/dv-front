(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"1Gax":function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowCenter",["ngResource","deskworks.config"]).factory("DoorflowCenter",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId"),{},{update:{method:"PUT"}});return{query:function(){return o.query().$promise},save:function(e){return o.update({centerId:e.id},e).$promise}}}])},"2l71":function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowAccessGroup",["ngResource","deskworks.config"]).factory("DoorflowAccessGroup",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId/doorflow-groups"));return{query:function(e){return o.query({centerId:e}).$promise}}}])},TiEo:function(e,r,o){"use strict";o.r(r);o("3dw1"),o("Muwe"),o("y89P");var t=o("yCd9"),n=o.n(t),s=o("lRNC"),c=o.n(s),l=["$injector",function(e){var r,t,s=(r=o("fVSe"),n()(t=c()(r).call(r)).call(t,r));e.loadNewModules(n()(s).call(s,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var r=o("mMLT");c()(r).call(r).forEach((function(o){return e.put(o.replace(/^\.\//,""),r(o))}))}])}];r.default=l},VMqr:function(e,r){e.exports='<label class="ff-row animate-collapse" ng-if="$ctrl.groups.length"> <ff-label flex="0 1 170px"><span translate="DOORFLOW.GROUP"></span></ff-label> <ff-select flex="1 1 300px" name="doorflowGroup" ff-model="$ctrl.reservationUnit.doorflowGroupId" ff-options="opt.id as opt.name for opt in $ctrl.groups"> <option value="">-</option> </ff-select> </label> '},WA0m:function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowSite",["ngResource","deskworks.config"]).factory("DoorflowSite",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/doorflow-sites"),{},{});return{query:function(){return o.query().$promise}}}])},XMGG:function(e,r,o){"use strict";o.r(r);o("8cZI");r.default=angular.module("deskworks.DoorflowSettings",["ngResource","deskworks.config"]).factory("DoorflowSettings",["$resource","$location","deskworksConfig",function(e,r,o){var t=e(o.getApiAbsUrl("/doorflow/settings"),{},{update:{method:"PUT"}});return{get:function(){return t.get().$promise},save:function(e){return t.update({},e).$promise},getConnectUrl:function(e){return o.getApiAbsUrl(["/doorflow/oauth2?nonce=".concat(e),"redirectUri="+encodeURIComponent(r.absUrl())].join("&"))}}}])},e2MY:function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowReservationUnit",["ngResource","deskworks.config"]).factory("DoorflowReservationUnit",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId/reservation-units/:reservationUnitId"),{},{get:{method:"GET"},update:{method:"PUT"}});return{get:function(e,r){return o.get({centerId:e,reservationUnitId:r}).$promise},save:function(e,r,t){return o.update({centerId:e,reservationUnitId:r},t).$promise}}}])},fVSe:function(e,r,o){var t={"./access-group/doorflow-product-access-group.directive.js":"gOSU","./access-group/doorflow-reservation-unit-access-group.directive.js":"jN5m","./services/doorflow-access-group.service.js":"2l71","./services/doorflow-center.service.js":"1Gax","./services/doorflow-product.service.js":"m72S","./services/doorflow-reservation-unit.service.js":"e2MY","./services/doorflow-settings.service.js":"XMGG","./services/doorflow-site.service.js":"WA0m","./settings/doorflow-settings.directive.js":"gmNY"};function n(e){var r=s(e);return o(r)}function s(e){if(!o.o(t,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t[e]}n.keys=function(){return Object.keys(t)},n.resolve=s,e.exports=n,n.id="fVSe"},ftMp:function(e,r){e.exports='<label class="ff-row animate-collapse" ng-if="$ctrl.groups.length"> <ff-label flex="0 0 102px" class="ff-small"><span translate="PRODUCTS.DOORFLOW_GROUP"></span></ff-label> <ff-select name="doorflowGroup" ff-model="$ctrl.product.doorflowGroupId" ff-options="opt.id as opt.name for opt in $ctrl.groups"> <option value="">-</option> </ff-select> </label> '},gOSU:function(e,r,o){"use strict";o.r(r);var t=o("nbuU"),n=o.n(t);r.default=angular.module("deskworks.doorflowProductAccessGroupDirective",["deskworks.DoorflowAccessGroup","deskworks.DoorflowCenter","deskworks.DoorflowProduct"]).directive("doorflowProductAccessGroup",(function(){return{templateUrl:"access-group/doorflow-product-access-group.tpl.html",restrict:"E",scope:!0,controller:"DoorflowProductAccessGroupCtrl as $ctrl",bindToController:{save:"=",productId:"<"}}})).controller("DoorflowProductAccessGroupCtrl",["$q","dwAlerts","helper","state","DoorflowAccessGroup","DoorflowCenter","DoorflowProduct",function(e,r,o,t,s,c,l){var f=this;function i(){return l.save(t.getCurrentCenterId(),f.productId,f.product).catch((function(e){return r.error(e,"Failed to save Doorflow product.")}))}f.$onInit=function(){f.load()},f.load=function(){var o={centers:c.query().catch((function(e){return r.error(e,"Failed to query Doorflow centers.")})),product:l.get(t.getCurrentCenterId(),f.productId).catch((function(e){return r.error(e,"Failed to load Doorflow product.")}))};return e.all(o).then((function(e){var o;f.product=e.product;var c=n()(o=e.centers).call(o,(function(e){return e.id===t.getCurrentCenterId()}));if(c&&c.enabled)return s.query(t.getCurrentCenterId()).catch((function(e){return r.error(e,"Failed to query DoorFlow groups.")})).then((function(e){f.groups=e,f.groups&&f.groups.length&&(f.save=i)}))}))}}])},gmNY:function(e,r,o){"use strict";o.r(r);var t=o("nbuU"),n=o.n(t);o("JBxO"),o("FdtR"),o("3dw1");r.default=angular.module("deskworks.doorflowSettingsDirective",["debounce","deskworks.DoorflowSettings","deskworks.DoorflowCenter","deskworks.DoorflowSite","deskworks.DoorflowAccessGroup","deskworks.center.service"]).directive("doorflowSettings",(function(){return{templateUrl:"settings/doorflow-settings.tpl.html",restrict:"E",scope:!0,controller:"DoorflowSettingsCtrl as $ctrl"}})).controller("DoorflowSettingsCtrl",["dwAlerts","$q","debounce","helper","centerService","DoorflowSettings","DoorflowCenter","DoorflowAccessGroup","DoorflowSite",function(e,r,o,t,s,c,l,f,i){var a=this;a.$onInit=function(){a.load()},a.getConnectUrl=function(){return c.getConnectUrl(a.doorflowSettings?a.doorflowSettings.nonce:"")},a.load=function(){var o={doorflowSettings:c.get().catch((function(r){return e.error(r,"Failed to load DoorFlow settings.")})),centers:s.getCenters().catch((function(r){return e.error(r,"Failed to query centers.")})),doorflowCenters:l.query().catch((function(r){return e.error(r,"Failed to query DoorFlow centers.")})),doorflowSites:i.query().catch((function(r){return e.error(r,"Failed to query DoorFlow sites.")}))};return a.spin=!0,r.all(o).then((function(e){return a.doorflowSettings=e.doorflowSettings,a.doorflowCenters=e.doorflowCenters,a.doorflowSites=e.doorflowSites,a.doorflowCenters.forEach((function(r){var o;r.$$name=n()(o=e.centers).call(o,(function(e){return e.id===r.id})).name})),e})).finally((function(){a.spin=!1}))},a.saveCenter=o((function(r,o){if(o&&o.$invalid)return;return r.$$spin=!0,l.save(r).finally((function(){r.$$spin=!1})).catch((function(r){return e.error(r,"Failed to save DoorFlow center.")}))}),500),a.changeSite=function(e,r){return a.saveCenter(e,r)}}])},jN5m:function(e,r,o){"use strict";o.r(r);var t=o("nbuU"),n=o.n(t);r.default=angular.module("deskworks.doorflowReservationUnitAccessGroupDirective",["deskworks.DoorflowAccessGroup","deskworks.DoorflowCenter","deskworks.DoorflowReservationUnit"]).directive("doorflowReservationUnitAccessGroup",(function(){return{templateUrl:"access-group/doorflow-reservation-unit-access-group.tpl.html",restrict:"E",scope:!0,controller:"DoorflowReservationUnitAccessGroupCtrl as $ctrl",bindToController:{save:"=",reservationUnitId:"<"}}})).controller("DoorflowReservationUnitAccessGroupCtrl",["$q","dwAlerts","helper","state","DoorflowAccessGroup","DoorflowCenter","DoorflowReservationUnit",function(e,r,o,t,s,c,l){var f=this;function i(){return l.save(t.getCurrentCenterId(),f.reservationUnitId,f.reservationUnit).catch((function(e){return r.error(e,"Failed to save DoorFlow reservation unit.")}))}f.$onInit=function(){f.load()},f.load=function(){var o={centers:c.query().catch((function(e){return r.error(e,"Failed to query DoorFlow centers.")})),reservationUnit:l.get(t.getCurrentCenterId(),f.reservationUnitId).catch((function(e){return r.error(e,"Failed to load DoorFlow reservation unit.")}))};return e.all(o).then((function(e){var o;f.reservationUnit=e.reservationUnit;var c=n()(o=e.centers).call(o,(function(e){return e.id===t.getCurrentCenterId()}));if(c&&c.enabled)return s.query(t.getCurrentCenterId()).catch((function(e){return r.error(e,"Failed to query DoorFlow groups.")})).then((function(e){f.groups=e,f.groups&&f.groups.length&&(f.save=i)}))}))}}])},jdTA:function(e,r){e.exports='<ff-panel> <ff-panel-header class="ff-spin-right"> <span translate="INTEGRATIONS_SETUP.DOORFLOW.HEADER"></span> </ff-panel-header> <form name="form" novalidate ff-dim="$ctrl.spin"> <label class="ff-row"> <ff-label flex="1 1 270px"><span translate="INTEGRATIONS_SETUP.DOORFLOW.CONNECTION"></span></ff-label> <ff-static flex="1 1 305px" ng-if="!$ctrl.doorflowSettings.connected"> <a class="qb-connect" href="{{$ctrl.getConnectUrl()}}" target="_self" rel="noopener"> <ff-btn sense="ok" size="sm"><span translate="INTEGRATIONS_SETUP.CONNECT"></span></ff-btn> </a> </ff-static> <ff-static flex="1 1 305px" ng-if="$ctrl.doorflowSettings.connected"> <ff-icon sense="check"></ff-icon>&nbsp;<span translate="INTEGRATIONS_SETUP.CONNECTED"></span> </ff-static> </label> </form> <form name="form" novalidate ng-repeat="center in $ctrl.doorflowCenters" ng-if="$ctrl.doorflowSettings.connected" class="animate-collapse"> <ff-header ff-dim="center.$$spin" style="padding-top:.6rem"><cell>{{center.$$name}}</cell></ff-header> <label class="ff-row"> <ff-label flex="1 1 270px"><span translate="INTEGRATIONS_SETUP.ENABLED"></span></ff-label> <ff-static flex="1 1 305px"> <ff-checkbox name="enabled" ff-model="center.enabled" ff-change="$ctrl.saveCenter(center, form)"></ff-checkbox> </ff-static> </label> <label class="ff-row"> <ff-label flex="1 1 270px"><req translate="INTEGRATIONS_SETUP.DOORFLOW.SITE"></req></ff-label> <ff-select flex="1 1 305px" name="doorflowSiteId" ff-model="center.doorflowSiteId" ff-required="true" ff-options="site.id as site.name for site in $ctrl.doorflowSites" ff-change="$ctrl.changeSite(center, form)" ff-validate-alert="{{\'INTEGRATIONS_SETUP.DOORFLOW.SITE\' | translate}}"></ff-select> </label> </form> </ff-panel> '},m72S:function(e,r,o){"use strict";o.r(r),r.default=angular.module("deskworks.DoorflowProduct",["ngResource","deskworks.config"]).factory("DoorflowProduct",["$resource","deskworksConfig",function(e,r){var o=e(r.getApiAbsUrl("/doorflow/centers/:centerId/products/:productId"),{},{get:{method:"GET"},update:{method:"PUT"}});return{get:function(e,r){return o.get({centerId:e,productId:r}).$promise},save:function(e,r,t){return o.update({centerId:e,productId:r},t).$promise}}}])},mMLT:function(e,r,o){var t={"./access-group/doorflow-product-access-group.tpl.html":"ftMp","./access-group/doorflow-reservation-unit-access-group.tpl.html":"VMqr","./settings/doorflow-settings.tpl.html":"jdTA"};function n(e){var r=s(e);return o(r)}function s(e){if(!o.o(t,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t[e]}n.keys=function(){return Object.keys(t)},n.resolve=s,e.exports=n,n.id="mMLT"}}]);