(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"1/Md":function(e,t,r){"use strict";var n=r("NOor"),a=r.n(n),s=r("0zKI"),i=r.n(s);t.a=angular.module("deskworks.dwInvoicePaymentProcessingFee",["deskworks.state","deskworks.helper"]).directive("dwInvoicePaymentProcessingFee",(function(){return{restrict:"A",scope:!0,controller:"DwInvoicePaymentProcessingFeeCtrl as $ctrl",bindToController:{invoice:"<",settings:"<",creditCards:"<",eChecks:"<"}}})).controller("DwInvoicePaymentProcessingFeeCtrl",["$scope","$timeout","state","helper",function(e,t,r,n){var s=this;s.$onChanges=function(){return t((function(){var e,t;if(s.invoice&&s.settings&&s.creditCards&&s.eChecks&&s.settings.enablePaymentProcessingCharges){var r=0;s.creditCards.length?r=s.settings.paymentProcessingRates.cc||0:s.eChecks.length&&(r=s.settings.paymentProcessingRates.ach||0);var l=a()(e=s.invoice.items).call(e,(function(e){return"fake-payment-processing-fee"===e.id}));if(l>=0&&i()(t=s.invoice.items).call(t,l,1),r&&+s.invoice.balance){var o=n.round(r*+s.invoice.balance/100),f={addedBy:"system",amount:o,billedAt:moment(),createdAt:moment(),description:"Payment processing fee",id:"fake-payment-processing-fee",name:"Payment Fee",price:o,quantity:1};s.invoice.items.push(f),angular.isUndefined(s.invoice.chargesTotalInitial)&&(s.invoice.chargesTotalInitial=+s.invoice.chargesTotal),angular.isUndefined(s.invoice.balanceInitial)&&(s.invoice.balanceInitial=+s.invoice.balance),s.invoice.chargesTotal=n.round(s.invoice.chargesTotalInitial+o),s.invoice.balance=n.round(s.invoice.balanceInitial+o)}}}))}}])},"1IPd":function(e,t,r){"use strict";r.r(t);var n=r("03wM"),a=r.n(n),s=r("gQJ2"),i=r.n(s),l=(r("3dw1"),r("Muwe"),r("y89P"),r("ee+B"));t.default=angular.module("deskworks.BayReservationUserTypesDialogCtrl",[l.a.name]).controller("BayReservationUserTypesDialogCtrl",["$scope","state","helper","close","types",function(e,t,r,n,s){var l=this;l.onInit=function(){l.nip=+t.getParam("nip");var e=t.getParam("nipByType")?JSON.parse(t.getParam("nipByType")):{};l.types=angular.copy(s),l.types.forEach((function(t){t.$$count=e[t.id]?e[t.id]:0})),a()(e).length||(l.types[0].$$count=l.nip)},l.next=function(){if(!r.pointFirstInvalid("#bayReservation")){var e=l.types.reduce((function(e,t){return e[t.id]=t.$$count,e}),{});t.replace().setParam("nipByType",i()(e)),n(!0)}},l.cancel=function(){n()},l.validate=function(e){return l.total=l.types.reduce((function(e,t){return e+(t.$$count||0)}),0),l.total===l.nip},l.onInit()}])},"1OaI":function(e,t,r){},"1Od8":function(e,t,r){},"2JTx":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");var n=r("ee+B");t.default=angular.module("deskworks.BayReservationNipDialogCtrl",[n.a.name]).controller("BayReservationNipDialogCtrl",["$scope","state","helper","close","capacity","settings",function(e,t,r,n,a,s){var i=this;i.capacity=a,isNaN(+t.getParam("nip"))||(i.nip=t.getParam("nip")),i.next=function(){r.pointFirstInvalid("#bayReservation")||(n(),t.replace().setParam("nip",i.nip),s.enableReservationPaymentForOnePerson||t.setParam("npf",i.nip))}}])},"2z2x":function(e,t){e.exports='<dw-sign-in id="signIn" show-sign-up="false"> <extra-buttons> <ff-btn sense="ok" class="guest-button" ff-click="$ctrl.checkOutAsGuest()"><span translate="SIGN_IN.BTN_CHECKOUT_GUEST"></span></ff-btn> </extra-buttons> </dw-sign-in> '},"5Rx4":function(e,t,r){var n={"./11-centers/centers.controller.js":"ZVvm","./12-reservation-units/reservation-units.controller.js":"Atk4","./13-date/date.controller.js":"YXJK","./13-time/time.controller.js":"kF3z","./14-sign-in/sign-in.controller.js":"XGZC","./15-sign-up/sign-up.controller.js":"lYGL","./16-confirm/confirm.controller.js":"qVaH","./17-complete/complete.controller.js":"mWGk","./18-purchase/purchase.controller.js":"y+2o","./90-dialogs/bay-reservation-dialogs.service.js":"MQNn","./90-dialogs/bay-reservation-login-password-dialog.controller.js":"SAD6","./90-dialogs/bay-reservation-nip-dialog.controller.js":"2JTx","./90-dialogs/bay-reservation-user-types-dialog.controller.js":"1IPd"};function a(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="5Rx4"},"99Su":function(e,t){e.exports='<div class="bay-reservation"> <h1 class="page-title"> <span>{{state.getPageTitle()}}</span> <need-help phone="$ctrl.center.phone" style="float:right"></need-help> <div style="clear:both"></div> </h1> <form name="$ctrl.form" id="bayReservationPurchase" class="ff-grid gutter-v gutter-h" novalidate ff-dim="$ctrl.spin"> <ff-panel> <ff-panel-header> <span translate="SIMPLE_RES.PURCHASE.RESERVATION.HEADER"></span> </ff-panel-header> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.LOCATION"></span></ff-label> <ff-static>{{::$ctrl.center.name}}</ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.SPACE"></span></ff-label> <ff-static>{{::$ctrl.unit.reservationTypeName}}</ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.DATE"></span></ff-label> <ff-static>{{::$ctrl.timeStart | date:\'longDate\'}}</ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.TIME"></span></ff-label> <ff-static> <span><span nice-time="::$ctrl.timeStart"></span> - <span nice-time="::$ctrl.timeEnd"></span></span> </ff-static> </ff-row> <ff-row ng-if="$ctrl.hasRecurring()"> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.REPEAT_FREQUENCY"></span></ff-label> <ff-static>{{::$ctrl.repeatFrequency.name}}</ff-static> </ff-row> <ff-row ng-if="$ctrl.hasRecurring() && $ctrl.repeatFrequency.repeatDurationOptions"> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.REPEAT_DURATION"></span></ff-label> <ff-static>{{::$ctrl.repeatFrequency.repeatDurationFilter($ctrl.repeatDuration)}}</ff-static> </ff-row> </ff-panel> <ff-panel ng-if="$ctrl.settings.enableReservationPaymentForOnePerson && $ctrl.unit.capacity && $ctrl.nip > 1"> <span style="display:inline-block;margin:0 .5rem .5rem 0"> Charges below are for <b>{{$ctrl.npf}}</b> person{{$ctrl.npf > 1 ? \'s\': \'\'}}. </span> <ff-select ff-model="$ctrl.typeToPay" style="display:inline-block;min-width:100px;margin-right:.5rem" ff-options="type.id as type.name for type in $ctrl.userTypes" ng-if="$ctrl.settings.enableReservationPaymentForOnePerson && $ctrl.unit.capacity && $ctrl.nip > 1 && $ctrl.npf === 1 && $ctrl.nipByType" ff-change="$ctrl.payForType()"></ff-select> <ff-btn-group style="display:inline-block;vertical-align:middle"> <ff-btn sense="add" ff-click="$ctrl.payFor($ctrl.nip)" ng-if="$ctrl.nip !== $ctrl.npf">Pay for all in party</ff-btn> <ff-btn sense="add" ff-click="$ctrl.payFor(1)" ng-if="$ctrl.npf > 1">Pay for one person</ff-btn> </ff-btn-group> </ff-panel> <ff-panel> <ff-panel-header> <span translate="SIMPLE_RES.PURCHASE.ORDER.HEADER" translate-values="{ orderId: $ctrl.purchase.orderId }"></span> </ff-panel-header> <dw-invoice invoice="$ctrl.purchase" center="$ctrl.center" allow-remove="false" simple="true" dw-invoice-payment-processing-fee update-invoice="$ctrl.updatePurchase()" settings="$resolve.settings" credit-cards="$resolve.user.creditCards" e-checks="$resolve.user.eChecks"></dw-invoice> </ff-panel> <dw-add-charges-br purchase="$ctrl.purchase" update-invoice="$ctrl.updatePurchase()" no-collapse="true" ng-if="$resolve.settings.enableAddOnProductsAtRegistration"></dw-add-charges-br> <ff-panel flex="{md: \'0 0 50%\'}"> <ff-header>Contact</ff-header> <label class="ff-row"> <ff-label flex="0 1 135px"><req>Full name</req></ff-label> <ff-text ff-model="$ctrl.contact.fullName" ff-change="$ctrl.onNameChange()" ff-required="true" ff-validate-alert="Full name" placeholder="John Doe"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 1 135px"><req>Phone number</req></ff-label> <ff-text ff-model="$ctrl.contact.phone" dw-phone ff-required="true" placeholder="888-123-1234"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 1 135px"><req>Email address</req></ff-label> <ff-email ff-model="$ctrl.contact.email" ff-required="true" ff-validate-alert="Email address"></ff-email> </label> <ff-header class="ff-tmargin">Cancellations</ff-header> <div> Customers will receive full store credit with 24 hours notice of cancellation. Customers will also receive a full refund of credit in case of operator cancellation due to weather or other unforeseen circumstances. Contact us by phone to cancel or inquire about a cancellation. </div> </ff-panel> <new-billing-profile flex="{md: \'0 0 50%\'}" user="$ctrl.user" settings="$ctrl.settings" id="newBillingProfile" hide-fields="{ addrType: true, addrStreet: true, addrCity: true, addrState: true }"></new-billing-profile> <ff-col> <div class="ff-grid gutter-h gutter-v" style="justify-content:flex-end"> <reservation-agreement flex="0 0 300px" ng-if="wlLinks.reservationAgreementLinkUrl"></reservation-agreement> </div> </ff-col> <ff-btn-group> <ff-btn sense="help" ff-click="$ctrl.staffHelp()"><span translate="GLOBAL.BTN_STAFF_HELP"></span></ff-btn> <ff-btn sense="back" ff-click="$ctrl.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="next" type="submit" ff-click="$ctrl.next()"><span translate="GLOBAL.BTN_NEXT"></span></ff-btn> </ff-btn-group> </form> </div> '},Atk4:function(e,t,r){"use strict";r.r(t);var n=r("nbuU"),a=r.n(n);r("3dw1"),r("iPZ8"),r("kypl"),r("Muwe"),r("y89P"),r("VHWN");t.default=angular.module("deskworks.BayReservationUnitsCtrl",[]).controller("BayReservationUnitsCtrl",["$scope","$route","$translate","$filter","state","units","categories",function(e,t,r,n,s,i,l){var o=this;o.select=function(e){return s.setParam("unit",e.id),s.setPath("/bay-reservation/date")},o.back=function(){return s.setPath("/bay-reservation")},s.setPageTitle(r.instant("BAY_RESERVATION.UNITS.PAGE_TITLE")),o.units=angular.copy(i),o.units.forEach((function(e){var t=a()(l).call(l,(function(t){return t.id===e.reservationTypeId}));t&&(e.thumbnail=e.thumbnail||t.thumbnail,e.photo=e.photo||t.photo,e.description=e.description||t.description)})),(s.getParam("nipByType")||s.getParam("npf"))&&(s.replace(),s.setParam("nipByType",null),s.setParam("npf",null))}])},C0qL:function(e,t){e.exports='<h1 class="page-title flex"> <span>{{state.getPageTitle()}}</span> <need-help phone="$resolve.center.phone"></need-help> </h1> <div class="ff-grid gutter-v"> <new-user-profile id="user" user="$resolve.user" reg="$resolve.reg" center="$resolve.center"></new-user-profile> <ff-btn-group> <ff-btn sense="back" ff-click="$ctrl.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="next" ff-click="$ctrl.next()"><span translate="GLOBAL.BTN_NEXT"></span></ff-btn> </ff-btn-group> </div> '},Caj8:function(e,t,r){"use strict";var n=r("YwtS"),a=r.n(n);t.a=angular.module("newUserProfileDirective",[]).directive("newUserProfile",(function(){return{template:a.a,restrict:"E",scope:!0,controller:"NewUserProfileCtrl as $ctrl",bindToController:{reg:"<",user:"<",center:"<"}}})).controller("NewUserProfileCtrl",["$scope","userProfileService",function(e,t){var r=this;r.$onInit=function(){t.bindTestUserGenerator(e,r.user,r.reg)}}])},"DVO+":function(e,t,r){},EYrU:function(e,t){e.exports='<div class="bay-reservation"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <simple-select-time center="$resolve.center" cal-data="$ctrl.calData" hide-recurring-reservations="true" reservation-fields="$ctrl.reservationFields" back="$ctrl.back()" next="$ctrl.next()" cal-data-pre-process="$ctrl.calDataPreProcess($params)"> </simple-select-time> </div> '},G5Je:function(e,t,r){"use strict";var n=r("IOh7"),a=r.n(n);angular.module("deskworks.StaffHelpCtrl",["ngRoute","deskworks.helper","deskworks.config"]).directive("staffHelp",(function(){return{template:a.a,restrict:"E",scope:!0,controller:"StaffHelpDirectiveCtrl as $ctrl"}})).controller("StaffHelpDirectiveCtrl",["$scope","$translate","dwAlerts","helper","state","deskworksConfig",function(e,t,r,n,a,s){this.notice=a.getParam("notice"),a.setPageTitle(t.instant("SIMPLE_RES.STAFF_HELP.PAGE_TITLE")),e.$on("$routeChangeStart",(function(e,n,a){!n.$$route||"MemberSignUpBillingCtrl"!==n.$$route.controller&&"MemberSignUpPurchaseCtrl"!==n.$$route.controller&&"SimpleReservationBillingCtrl"!==n.$$route.controller&&"SimpleReservationPurchaseCtrl"!==n.$$route.controller&&"BuyPassBillingCtrl"!==n.$$route.controller&&"BuyPassPurchaseCtrl"!==n.$$route.controller||(r.error(t.instant("SIMPLE_RES.STAFF_HELP.BACK_ERROR")),e.preventDefault())})),this.home=function(){return a.resetParams(),a.setPath(s.getDefaultRoute())}}])},IJqC:function(e,t){e.exports='<ff-panel id="reservationAgreement" class="ff-no-frame"> <label> <ff-checkbox ff-model="reservationAgreement" ff-required="true" ff-validate-alert="{ required: (\'RESERVATIONS.RESERVATION_AGREEMENT.REQUIRED\' | translate) }" title="{{\'RESERVATIONS.RESERVATION_AGREEMENT.REQUIRED\' | translate}}"> <div translate="RESERVATIONS.RESERVATION_AGREEMENT.LABEL"></div> <a ng-href="{{::wlLinks.reservationAgreementLinkUrl}}" ng-bind="::wlLinks.reservationAgreementLinkText" target="_blank" rel="noopener"></a> </ff-checkbox> </label> </ff-panel> '},IOh7:function(e,t){e.exports='<h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="gutter-v"> <ff-panel> <span ng-bind="::$ctrl.notice"></span> </ff-panel> <ff-btn-group> <ff-btn sense="home" type="submit" ff-click="$ctrl.home()"><span translate="GLOBAL.BTN_HOME"></span></ff-btn> </ff-btn-group> </div> '},"J/A3":function(e,t,r){var n={"./11-centers/centers.tpl.html":"rIyG","./12-reservation-units/reservation-units.tpl.html":"bL2j","./13-date/date.tpl.html":"epG3","./13-time/time.tpl.html":"EYrU","./14-sign-in/sign-in.tpl.html":"2z2x","./15-sign-up/sign-up.tpl.html":"C0qL","./16-confirm/confirm.tpl.html":"THID","./17-complete/complete.tpl.html":"lrIJ","./18-purchase/purchase.tpl.html":"99Su","./90-dialogs/bay-reservation-login-password-dialog.tpl.html":"kzRc","./90-dialogs/bay-reservation-nip-dialog.tpl.html":"S0SQ","./90-dialogs/bay-reservation-user-types-dialog.tpl.html":"P6Ar"};function a(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="J/A3"},MQNn:function(e,t,r){"use strict";r.r(t);r("3dw1");var n=r("03wM"),a=r.n(n),s=r("Ekwr"),i=r.n(s),l=r("hsT8"),o=r.n(l),f=r("lvz6"),c=r.n(f),u=r("yKah"),p=r.n(u),d=r("fzuT"),m=r.n(d),g=r("S0SQ"),v=r.n(g),h=r("P6Ar"),y=r.n(h),b=r("kzRc"),$=r.n(b),P=r("iAzO"),E=r("2JTx"),T=r("1IPd"),R=r("SAD6");function w(e,t){var r=a()(e);if(i.a){var n=i()(e);t&&(n=o()(n).call(n,(function(t){return c()(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):p.a?Object.defineProperties(e,p()(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,c()(r,t))}))}return e}t.default=angular.module("deskworks.bayReservationDialogs",[P.a.name,E.default.name,T.default.name,R.default.name]).factory("bayReservationDialogs",["dwModal",function(e){return{showNipDialog:function(t){return e.show(C({template:v.a,controller:"BayReservationNipDialogCtrl as $ctrl",inputs:{}},t))},showUserTypesDialog:function(t){return e.show(C({template:y.a,controller:"BayReservationUserTypesDialogCtrl as $ctrl",inputs:{}},t))},showLoginPassword:function(t){return e.show(C({template:$.a,controller:"BayReservationLoginPasswordDialogCtrl as $ctrl",inputs:{}},t))}}}])},P6Ar:function(e,t){e.exports='<div class="dw-modal"> <div class="dw-modal-fade" ng-click="$ctrl.cancel()"></div> <form name="form" class="dw-modal-dialog ff-col" novalidate id="bayReservation" style="max-width:500px"> <ff-header><span translate="BAY_RESERVATION.HEADER"></span></ff-header> <div class="ff-row" ng-repeat="type in $ctrl.types"> <ff-static flex="0 0 30px" class="ff-center" ff-style="{ padding: 0 }"> <ff-btn sense="minus" size="xs" class="ff-btn-icon" flex="auto" style="align-self:stretch" ff-style="{ width: \'100%\', height: \'100%\' }" ff-disabled="type.$$count <= 0" ff-click="type.$$count = +type.$$count - 1"></ff-btn> </ff-static> <ff-number flex="0 0 36px" ff-model="type.$$count" class="ff-center" ff-required="true" ff-gte="0" ff-custom="$ctrl.validate($value)" ff-validate-alert="{ field: \'Count\', custom: \'Total number of guests is \' + $ctrl.total + \', must be \' + $ctrl.nip + \'.\' }"></ff-number> <ff-static flex="0 0 30px" class="ff-center" ff-style="{ padding: 0 }"> <ff-btn sense="plus" size="xs" class="ff-btn-icon" flex="auto" style="align-self:stretch" ff-style="{ width: \'100%\', height: \'100%\' }" ff-click="type.$$count = +type.$$count + 1"></ff-btn> </ff-static> <label class="ff-row"> <ff-static> <div>{{type.name}} <small ng-if="type.description">({{type.description}})</small></div> </ff-static> </label> </div> <ff-btn-group class="ff-tmargin"> <ff-btn sense="back" ff-click="$ctrl.cancel()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="next" type="submit" ff-click="$ctrl.next()"><span translate="BAY_RESERVATION.BTN_CONTINUE"></span></ff-btn> </ff-btn-group> </form> </div> '},QEpw:function(e,t){e.exports='<span translate="BILLING_PROFILE.PAYMENT_METHOD.EMPTY" ng-if="$ctrl.showSwitchCC() && $ctrl.showSwitchACH()"></span> <up-billing-method user="$ctrl.user" settings="$ctrl.settings" ng-if="!$ctrl.isSingleMode()"></up-billing-method> <up-credit-cards user-profile="$ctrl.user" settings="$ctrl.settings" single="$ctrl.isSingleMode()" ng-if="$ctrl.user.creditCards.length || !$ctrl.isSingleMode()" hide-fields="$ctrl.hideFields"></up-credit-cards> <up-e-checks user-profile="$ctrl.user" single="$ctrl.isSingleMode()" ng-if="$ctrl.settings.enableEChecks && ($ctrl.user.eChecks.length || !$ctrl.isSingleMode())"></up-e-checks> '},S0SQ:function(e,t){e.exports='<div class="dw-modal"> <div class="dw-modal-fade"></div> <form name="form" class="dw-modal-dialog ff-col" novalidate id="bayReservation" style="max-width:500px"> <ff-header><span translate="BAY_RESERVATION.HEADER"></span></ff-header> <label class="ff-row"> <ff-label flex="0 0 140px"><span translate="BAY_RESERVATION.NUMBER_IN_PARTY"></span></ff-label> <ff-number flex="0 0 50px" class="ff-center" autofocus ff-model="$ctrl.nip" ff-required="true" ff-gt="0" ff-lte="$ctrl.capacity" ff-validate-alert="{ field: (\'BAY_RESERVATION.NUMBER_IN_PARTY\' | translate), lte: (\'BAY_RESERVATION.NIP_OVERFLOW\' | translate) }"></ff-number> <ff-label></ff-label> </label> <ff-btn-group class="ff-tmargin"> <ff-btn sense="next" type="submit" ff-click="$ctrl.next()"><span translate="BAY_RESERVATION.BTN_CONTINUE"></span></ff-btn> </ff-btn-group> </form> </div> '},SAD6:function(e,t,r){"use strict";r.r(t);r("3dw1");var n=r("03wM"),a=r.n(n),s=r("Ekwr"),i=r.n(s),l=r("hsT8"),o=r.n(l),f=r("lvz6"),c=r.n(f),u=r("yKah"),p=r.n(u),d=r("fzuT"),m=r.n(d),g=(r("Muwe"),r("aZFp"),r("ee+B"));function v(e,t){var r=a()(e);if(i.a){var n=i()(e);t&&(n=o()(n).call(n,(function(t){return c()(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):p.a?Object.defineProperties(e,p()(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,c()(r,t))}))}return e}t.default=angular.module("deskworks.BayReservationLoginPasswordDialogCtrl",[g.a.name]).controller("BayReservationLoginPasswordDialogCtrl",["$scope","state","dwAlerts","helper","close","center","user","email","userProfileService",function(e,t,r,n,a,s,i,l,o){var f=this;function c(e){var t={};if(e.creditCards[0])t.firstName=e.creditCards[0].firstName,t.lastName=e.creditCards[0].lastName;else if(e.eChecks[0]){var r=e.eChecks[0].fullName.split(" ");t.firstName=r[0],t.lastName=r[1]||r[0]}return t}f.centerName=s.name,f.email=l,f.next=function(){if(!n.pointFirstInvalid("#bayReservation")){var e=h({login:l,password:f.password,passwordConfirmation:f.password,email:l},c(i));return o.updateRaw(s.id,i,e).catch((function(e){return r.error(e,"Failed to update user.")})).then((function(){return a()}))}},f.skip=function(){var e=h({},c(i));return o.updateRaw(s.id,i,e).catch((function(e){return r.error(e,"Failed to update user.")})).then((function(){return a()}))}}])},SxvJ:function(e,t,r){"use strict";r.r(t);r("3dw1"),r("Muwe"),r("y89P");var n=r("yCd9"),a=r.n(n),s=r("lRNC"),i=r.n(s),l=r("hsT8"),o=r.n(l),f=(r("1OaI"),r("G5Je"),["$injector",function(e){var t,n,s,l=(n=r("5Rx4"),a()(s=i()(n).call(n)).call(s,n));e.loadNewModules(a()(t=o()(l).call(l,(function(e){return e.default}))).call(t,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var t=r("J/A3");i()(t).call(t).forEach((function(r){return e.put(r.replace(/^\.\//,""),t(r))}))}])}]);t.default=f},THID:function(e,t){e.exports='<h1 class="page-title">{{state.getPageTitle()}}</h1> <form class="ff-grid gutter-v" style="max-width:480px"> <ff-panel> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.LOCATION"></span></ff-label> <ff-static>{{::$resolve.center.name}}</ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.SPACE"></span></ff-label> <ff-static>{{::$ctrl.unit.name}}</ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.DATE"></span></ff-label> <ff-static>{{::$ctrl.timeStart | date:\'longDate\'}}</ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.TIME"></span></ff-label> <ff-static> <span><span nice-time="::$ctrl.timeStart"></span> - <span nice-time="::$ctrl.timeEnd"></span></span> </ff-static> </ff-row> <label class="ff-row" style="margin-left:.5rem;margin-top:.5rem"> <ff-checkbox name="emailConfirmation" ff-model="$ctrl.emailConfirmation"> <span translate="RESERVATIONS.EMAIL_CONFIRMATION"></span> </ff-checkbox> </label> </ff-panel> <ff-btn-group> <ff-btn sense="back" ff-click="$ctrl.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="ok" type="submit" ff-click="$ctrl.next()"><span translate="GLOBAL.BTN_CONFIRM"></span></ff-btn> </ff-btn-group> </form> '},VHWN:function(e,t,r){},XGZC:function(e,t,r){"use strict";r.r(t);var n=r("6RpP"),a=r.n(n),s=r("03wM"),i=r.n(s),l=r("hsT8"),o=r.n(l),f=r("yCd9"),c=r.n(f);r("Muwe"),r("y89P"),r("8cZI");t.default=angular.module("deskworks.BayReservationSignInCtrl",["session","deskworks.ReservationCost","deskworks.purchase.service"]).controller("BayReservationSignInCtrl",["$scope","$filter","$translate","dwAlerts","state","bayReservationRedirect","bayReservationRegisterGuest","settings",function(e,t,r,n,a,s,i,l){a.setPageTitle(r.instant("SIGN_IN.PAGE_TITLE",{company:e.wlLinks.companyName})),e.$on("dwSignIn:SignIn",(function(e){e.stopPropagation(),s({replace:!0,settings:l})})),e.$on("dwSignIn:SignUp",(function(e){return e.stopPropagation(),a.replace().setPath("/bay-reservation/sign-up")})),this.back=function(){return a.setPath("/bay-reservation/time")},this.checkOutAsGuest=function(){return i().then((function(){return s({replace:!0,settings:l})}))}}]).factory("bayReservationRegisterGuest",["state","dwAlerts","centerService","userProfileService",function(e,t,r,n){return function(){return r.get(e.getCurrentCenterId()).then((function(e){return n.new(e,"nonMember","signUp").catch((function(e){return t.error(e,"Failed to get new user profile template.")}))})).then((function(r){var s,i;r.addresses=[],r.phones=[];var l="guest"+moment().unix();return r.firstName=l,r.lastName=l,r.email=a()(s="".concat(l,"@")).call(s,l,".com"),r.login=a()(i="".concat(l,"-")).call(i,moment().valueOf()),r.password="#pTzK".concat(moment().valueOf()+Math.floor(1e4*Math.random())),r.passwordConfirmation=r.password,n.save(e.getCurrentCenterId(),r).catch((function(e){return t.error(e,"Failed to create user profile.")})).then((function(){return e.login(r.login,r.password).catch((function(e){return t.error(e,"Failed to login under created user.")}))}))}))}}]).factory("bayReservationRedirect",["$route","$timeout","session","state","purchaseService","ReservationCost","dwAlerts",function(e,t,r,n,a,s,l){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=r.replace,f=void 0!==s&&s,u=r.quantity,p=void 0===u?null:u,d=r.settings,m=void 0===d?{}:d;if(!p){var g=n.getParam("nipByType")?JSON.parse(n.getParam("nipByType")):{},v=i()(g).reduce((function(e,t){return e+g[t]}),0);(p=n.getParam("npf")?+n.getParam("npf"):m.enableReservationPaymentForOnePerson?1:v)>1&&p!==v&&(p=v)}var h=n.getCurrentCenterId(),y=n.getCurrentUserId(),b={reservationUnitIds:[+n.getParam("unit")],reservationUnitId:+n.getParam("unit"),reservationFrom:n.getParam("start"),reservationTo:n.getParam("end"),reservationRepeatFrequency:n.getParam("freq"),reservationRepeatDuration:n.getParam("duration"),quantity:p};if(n.getParam("nipByType")){var $,P,E=JSON.parse(n.getParam("nipByType")),T=!isNaN(+n.getParam("typeToPay"))&&E[+n.getParam("typeToPay")]>0?+n.getParam("typeToPay"):o()($=i()(E)).call($,(function(e){return E[e]>0}))[0];if(1===p)b.quantityByUserType=[{id:T,quantity:p}],n.replace().setParam("typeToPay",T);else b.quantityByUserType=c()(P=i()(E)).call(P,(function(e){return{id:+e,quantity:E[e]}}))}return a.createPurchaseForReservation(h,y,b).catch((function(e){return l.error(e,"Failed to create purchase for reservation.")})).then((function(r){return r.purchasePackageIds&&n.setParam("packages",r.purchasePackageIds.join(",")),n.setParam("purchaseId",r.id),n.getParam("nipByType")&&n.setParam("npf",p),f&&n.replace(),"/bay-reservation/purchase"===n.getPath()?(e.reload(),t(1e4)):n.setPath("/bay-reservation/purchase")}))}}])},YXJK:function(e,t,r){"use strict";r.r(t);var n=r("gQJ2"),a=r.n(n);r("3dw1"),r("Muwe"),r("y89P"),r("DVO+");t.default=angular.module("deskworks.BayReservationDateCtrl",[]).controller("BayReservationDateCtrl",["$scope","$route","$filter","$translate","$timeout","state","helper","userTypes","unit",function(e,t,r,n,s,i,l,o,f){var c=this;c.validate=function(e){return c.types.reduce((function(e,t){return e+(t.$$count||0)}),0)>0},c.next=function(){if(!l.pointFirstInvalid(".br-date")&&c.selectedDate){if(f.capacity){var e=c.types.reduce((function(e,t){return e[t.id]=t.$$count,e}),{});i.replace().setParam("nipByType",a()(e))}return i.replace().setParam("date",r("date")(c.selectedDate,"yyyy-MM-dd")),s((function(){return i.setPath("/bay-reservation/time")}))}},c.back=function(){return i.setPath("/bay-reservation/units")},function(){i.setPageTitle(n.instant("BAY_RESERVATION.DATE.PAGE_TITLE")),c.dateMin=moment().startOf("day"),c.selectedDate=r("toDate")(i.getParam("date"));var e=i.getParam("nipByType")?JSON.parse(i.getParam("nipByType")):{};c.types=angular.copy(o),c.types.forEach((function(t){t.$$count=e[t.id]?e[t.id]:0}))}()}])},YwtS:function(e,t){e.exports='<ff-panel> <ff-panel-header><small translate="GLOBAL.REQUIRED_FIELDS_MARKED_WITH"></small></ff-panel-header> <div class="ff-grid ff-gutter-v ff-gutter-h"> <up-personal-info user="$ctrl.user" schema="$ctrl.user.schema" reg="$ctrl.reg"></up-personal-info> <up-addresses flex="{md: \'0 0 50%\'}" user="$ctrl.user" schema="$ctrl.user.schema" reg="$ctrl.reg" center="$ctrl.center" single="true"></up-addresses> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-login-info user="$ctrl.user" schema="$ctrl.user.schema" reg="$ctrl.reg"></up-login-info> <up-phones user="$ctrl.user" schema="$ctrl.user.schema" reg="$ctrl.reg" single="true"></up-phones> </div> </div> <up-photo flex="{md: \'0 0 50%\'}" user="$ctrl.user" schema="$ctrl.user.schema" reg="$ctrl.reg"></up-photo> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-lead-source user="$ctrl.user" schema="$ctrl.user.schema" reg="$ctrl.reg"></up-lead-source> <up-terms-of-service user="$ctrl.user" schema="$ctrl.user.schema" reg="$ctrl.reg"></up-terms-of-service> </div> </div> </div> </ff-panel> '},ZVvm:function(e,t,r){"use strict";r.r(t);var n=r("6RpP"),a=r.n(n);r("Muwe"),r("y89P"),r("VHWN"),r("oaJc");t.default=angular.module("deskworks.BayReservationCentersCtrl",[]).controller("BayReservationCentersCtrl",["$scope","$translate","centers","state",function(e,t,r,n){var s=this;s.getMapUrl=function(e){var t,r;return"https://maps.google.com?q="+encodeURIComponent(a()(t=a()(r="".concat(e.street1,", ")).call(r,e.city,", ")).call(t,e.state))},s.select=function(e){return n.getCurrentCenterId()!==e.id&&n.setCurrentCenterId(e.id),n.setPath("".concat(n.getPath(),"/units"))},n.setPageTitle(t.instant("BAY_RESERVATION.CENTERS.PAGE_TITLE")),1===r.length&&(n.replace(),s.select(r[0])),s.centers=r}])},aDfn:function(e,t,r){},aIjk:function(e,t,r){"use strict";t.a=angular.module("needHelp",[]).directive("needHelp",(function(){return{restrict:"E",scope:!0,controller:function(){},controllerAs:"$ctrl",template:'<span translate="GLOBAL.NEED_HELP" class="need-help" ng-if="$ctrl.phone" translate-values="{ phone: \'<a href=&quot;tel:\' + $ctrl.phone + \'&quot;>\' + $ctrl.phone + \'</a>\' }"></span>',bindToController:{phone:"<"}}}))},bL2j:function(e,t){e.exports='<div class="bay-reservation sr-units"> <h1 class="page-title ff-grid"> <span flex="none">{{state.getPageTitle()}}</span> </h1> <ff-board> <ff-panel ng-if="!$ctrl.units.length"><span translate="BAY_RESERVATION.UNITS.EMPTY"></span></ff-panel> <div class="em ff-grid" style="margin:0 0 .5rem 1rem"> <span flex="none">{{$ctrl.date | date:\'longDate\'}}</span> </div> <div class="ff-grid ff-gutter-h ff-gutter-v"> <ff-panel class="ff-panel-card" flex="{md: \'0 0 50%\'}" ng-repeat="unit in $ctrl.units"> <div class="ff-col" style="height:100%"> <ff-img ff-src="{{::unit.thumbnail}}" ff-src-hq="{{::unit.photo}}" ff-alt="{{::unit.name}}" img-placeholder="{{\'GLOBAL.NO_PHOTO\' | translate}}"></ff-img> <ff-header flex="none" style="margin-bottom:.5rem">{{::unit.name}}</ff-header> <div ng-if="unit.description" style="line-height:1.4" ng-bind-html="::unit.description"></div> <div flex="1 1 auto" ng-if="::unit.whoCanReserve === \'staffOnly\'"> <span translate="RESERVATIONS.STAFF_ONLY" translate-values="{ centerName: $resolve.center.name, centerPhone: $resolve.center.phone, centerEmail: $resolve.center.email }"> </span> </div> <ff-btn-group class="ff-tmargin ff-right" ng-if="::unit.whoCanReserve !== \'staffOnly\'" style="flex:auto;display:flex;align-items:flex-end"> <ff-btn sense="ok" ff-click="$ctrl.select(unit)" aria-label="{{(\'BAY_RESERVATION.BTN_SELECT\' | translate) + \' \' + unit.name}}"> <span translate="BAY_RESERVATION.BTN_SELECT"></span></ff-btn> </ff-btn-group> </div> </ff-panel> </div> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="$ctrl.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> </div> '},dLOS:function(e,t,r){"use strict";r("3dw1");var n=r("hsT8"),a=r.n(n),s=r("nbuU"),i=r.n(s),l=r("6RpP"),o=r.n(l),f=r("QEpw"),c=r.n(f);t.a=angular.module("newBillingProfile",[]).directive("newBillingProfile",(function(){return{template:c.a,restrict:"E",scope:!0,controller:"NewBillingProfileCtrl as $ctrl",bindToController:{settings:"<",user:"<",hideFields:"<?"}}})).controller("NewBillingProfileCtrl",["$scope","userProfileService",function(e,t){var r=this;r.$onInit=function(){var n;if(r.settings.creditCardTypes=a()(n=r.settings.creditCardTypes).call(n,(function(e){return e.enable})),r.user.creditCards.forEach((function(e){var t;e.type=i()(t=r.settings.creditCardTypes).call(t,(function(t){return t.id===e.type}))||e.type||{}})),r.user.creditCards=r.user.creditCards||[],!r.user.creditCards.length&&!r.user.eChecks.length){var s=t.creditCard.new(r.user);s.type=r.settings.creditCardTypes[0],r.user.creditCards.push(s)}e.$watchCollection((function(e){var t;return o()(t=r.user.creditCards).call(t,r.user.eChecks)}),(function(e){e&&r.user.paymentMethodId&&!i()(e).call(e,(function(e){return e.id===r.user.paymentMethodId}))&&(r.user.billingMethod=null,r.user.paymentMethodId=null)})),t.bindTestBillingGenerator(e,r.user)},r.isSingleMode=function(){var e=r.user,n=e.creditCards,a=e.eChecks;return!n.length&&(!a.length||t.eCheck.isNew(a[0]))||!a.length&&(!n.length||t.creditCard.isNew(n[0]))}}])},"ee+B":function(e,t,r){"use strict";t.a=angular.module("autofocusDirective",[]).directive("autofocus",["$timeout",function(e){return{restrict:"A",link:function(t,r,n){if("false"!==n.autofocus){var a=r[0].parentNode.querySelector("input")||r[0].parentNode.querySelector("select")||r[0].parentNode.querySelector("button");a&&e((function(){return a.focus()}))}}}}])},epG3:function(e,t){e.exports='<div class="bay-reservation br-date"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <div class="ff-grid gutter-v"> <ff-panel class="br-date-panel"> <ff-datepicker ff-model="$ctrl.selectedDate" date-min="$ctrl.dateMin"></ff-datepicker> </ff-panel> <ff-panel class="br-user-types-panel" ng-if="$resolve.unit.capacity"> <form class="ff-col" novalidate> <div class="ff-row" ng-repeat="type in $ctrl.types"> <ff-static flex="0 0 30px" class="ff-center" ff-style="{ padding: 0 }"> <ff-btn sense="minus" size="xs" class="ff-btn-icon" flex="auto" style="align-self:stretch" ff-style="{ width: \'100%\', height: \'100%\' }" ff-disabled="type.$$count <= 0" ff-click="type.$$count = +type.$$count - 1"></ff-btn> </ff-static> <ff-number flex="0 0 36px" ff-model="type.$$count" class="ff-center" ff-required="true" ff-gte="0" ff-custom="$ctrl.validate($value)" ff-validate-alert="{ field: \'Count\', custom: \'Total number of guests must be greater than 0.\' }"></ff-number> <ff-static flex="0 0 30px" class="ff-center" ff-style="{ padding: 0 }"> <ff-btn sense="plus" size="xs" class="ff-btn-icon" flex="auto" style="align-self:stretch" ff-style="{ width: \'100%\', height: \'100%\' }" ff-click="type.$$count = +type.$$count + 1"></ff-btn> </ff-static> <label class="ff-row"> <ff-static> <div>{{type.name}} <small ng-if="type.description">({{type.description}})</small></div> </ff-static> <ff-static flex="none">{{type.price | currency}}</ff-static> </label> </div> </form> </ff-panel> </div> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="$ctrl.back()"> <span translate="GLOBAL.BTN_BACK"></span> </ff-btn> <ff-btn sense="next" type="submit" ff-disabled="!$ctrl.selectedDate" ff-click="$ctrl.next()"> <span translate="GLOBAL.BTN_NEXT"></span> </ff-btn> </ff-btn-group> </div> '},kF3z:function(e,t,r){"use strict";r.r(t);r("3dw1"),r("Muwe"),r("y89P");var n=r("RJUJ"),a=r.n(n),s=r("nbuU"),i=r.n(s),l=(r("1Od8"),r("03gP")),o=r("3IU7");t.default=angular.module("deskworks.BayReservationTimeCtrl",[l.a.name,o.a.name]).controller("BayReservationTimeCtrl",["$scope","$translate","$timeout","$filter","$q","dwAlerts","state","session","calData","reservationFields","settings","ReservationUserType","bayCalDataPreProcess","bayReservationRedirect",function(e,t,r,n,s,l,o,f,c,u,p,d,m,g){var v=this;v.calDataPreProcess=m,v.next=function(){return f.isAnonymous()?o.setPath("/bay-reservation/sign-in"):g({settings:p})},v.back=function(){return o.setPath("/bay-reservation/date")},o.setPageTitle(t.instant("SIMPLE_RES.TIME.PAGE_TITLE")),v.reservationFields=u,v.unit=function(e){var t,r=+o.getParam("unit");return e.some((function(e){var n,a=i()(n=e.reservationUnits).call(n,(function(e){return e.id===r}));if(a)return t=a,!0})),t}(c),r((function(){a()(document.querySelectorAll("simple-select-time fd-field")).forEach((function(e){return e.style.display="none"}))})),v.calData=c,o.getParam("npf")&&(o.replace(),o.setParam("npf",null))}])},kzRc:function(e,t){e.exports='<div class="dw-modal"> <div class="dw-modal-fade"></div> <form name="form" class="dw-modal-dialog ff-col" novalidate id="bayReservation" style="max-width:360px"> <ff-header><span translate="BAY_RESERVATION.LOGIN_PASSWORD.HEADER" translate-values="{ center: $ctrl.centerName }"></span></ff-header> <label class="ff-row"> <ff-label flex="0 0 100px"><span translate="GLOBAL.EMAIL"></span></ff-label> <ff-email flex="auto" placeholder="jdoe@hotmail.com" ff-model="$ctrl.email" ff-required="true" ff-validate-alert="{{\'GLOBAL.EMAIL\' | translate}}"></ff-email> </label> <label class="ff-row"> <ff-label flex="0 0 100px"><span translate="GLOBAL.PASSWORD"></span></ff-label> <ff-password flex="auto" dw-password autofocus ff-model="$ctrl.password" ff-required="true" ff-validate-alert="{{\'GLOBAL.PASSWORD\' | translate}}"></ff-password> </label> <ff-btn-group class="ff-tmargin"> <ff-btn sense="checkOut" ff-click="$ctrl.skip()"><span translate="BAY_RESERVATION.BTN_SKIP"></span></ff-btn> <ff-btn sense="next" type="submit" ff-click="$ctrl.next()"><span translate="BAY_RESERVATION.BTN_CONTINUE"></span></ff-btn> </ff-btn-group> </form> </div> '},lYGL:function(e,t,r){"use strict";r.r(t);var n=r("Caj8"),a=r("aIjk");t.default=angular.module("deskworks.BayReservationSignUpCtrl",["ngRoute","deskworks.userProfile.service","deskworks.routeHelper","deskworks.helper",n.a.name,a.a.name]).controller("BayReservationSignUpCtrl",["$scope","$filter","$timeout","$q","$route","$translate","dwAlerts","helper","state","user","center","reg","userProfileService","bayReservationRedirect",function(e,t,r,n,a,s,i,l,o,f,c,u,p,d){o.setPageTitle(s.instant("USER_PROFILE.NEW_USER.PAGE_TITLE")),this.next=function(){if(!l.pointFirstInvalid("#user"))return(u.new?p.registerNewUser(0,f):n.when()).then((function(){if(u.new)return o.login(f.login,f.password).catch((function(e){return i.error(e,"Failed to login under created user.")}))})).then((function(){return d({replace:!0})}))},this.back=function(){return o.setPath("/bay-reservation/sign-in")}}])},lrIJ:function(e,t){e.exports='<div class="bay-reservation"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="ff-grid gutter-v"> <ff-panel ng-if="$ctrl.accessCode && $resolve.settings.enableAccessCodes"> <span class="ff-center ff-bmargin" translate="BOOK_IT_NOW.COMPLETE.ACCESS_CODE" translate-values="{ accessCode: $ctrl.accessCode }"></span> </ff-panel> <ff-btn-group> <ff-btn sense="home" type="submit" ff-click="$ctrl.home()"><span translate="GLOBAL.BTN_HOME"></span></ff-btn> </ff-btn-group> </div> </div> '},mWGk:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.BayReservationCompleteCtrl",[]).controller("BayReservationCompleteCtrl",["$scope","$translate","dwAlerts","state","deskworksConfig","session",function(e,t,r,n,a,s){n.setPageTitle(t.instant("BOOK_IT_NOW.COMPLETE.PAGE_TITLE")),this.accessCode=n.getParam("accessCode"),e.$on("$locationChangeStart",(function(e,n){n&&n.indexOf("/bay-reservation")>=0&&!s.isAdmin()&&(e.preventDefault(),r.error(t.instant("SIMPLE_RES.COMPLETE.BACK_ERROR")))})),this.home=function(){return n.resetParams(),n.setPath(a.getDefaultRoute())}}])},oaJc:function(e,t,r){},qVaH:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P"),r("3dw1");var n=r("nbuU"),a=r.n(n),s=r("NOor"),i=r.n(s),l=r("03wM"),o=r.n(l),f=r("yCd9"),c=r.n(f),u=r("hsT8"),p=r.n(u),d=r("+l1P");t.default=angular.module("deskworks.BayReservationConfirmCtrl",["deskworks.reservationService","deskworks.reservationUnit.optsRepeatFrequency",d.a.name]).controller("BayReservationConfirmCtrl",["$scope","$q","$filter","$translate","settings","dwAlerts","session","state","reservationService","reservationFields","optsRepeatFrequency","unit",function(e,t,r,n,s,l,f,u,d,m,g,v){var h,y=this;u.setPageTitle(n.instant("RESERVATIONS.CONFIRM.PAGE_TITLE")),y.timeStart=r("toDate")(u.getParam("start")),y.timeEnd=r("toDate")(u.getParam("end")),y.reservationNote=u.getParam("note")||"",y.emailConfirmation=!!u.getParam("confirm"),y.reservationTitle=u.getParam("title"),y.reservationNote=u.getParam("note"),y.unit=v,y.optsRepeatFrequency=g,y.repeatFrequency=a()(h=y.optsRepeatFrequency).call(h,(function(e){return e.id===u.getParam("freq")}))||y.optsRepeatFrequency[0],y.repeatDuration=u.getParam("duration")&&+u.getParam("duration")||y.repeatFrequency.repeatDurationOptions&&y.repeatFrequency.repeatDurationOptions[0],e.$watch("$ctrl.emailConfirmation",(function(e){u.setParam("confirm",e||null).replace()})),y.next=function(){var e,r=JSON.parse(u.getParam("fields")||"{}"),n=i()(m).call(m,(function(e){return"number"===e.type})),s=m[n].id,f=a()(m).call(m,(function(e,t){return t>n&&"number"===e.type})).id,g=u.getParam("nipByType")?JSON.parse(u.getParam("nipByType")):null;r[s]=g?o()(g).reduce((function(e,t){return e+(g[t]||0)}),0):null,r[f]=g?isNaN(+u.getParam("npf"))?null:+u.getParam("npf"):null,o()(r).forEach((function(e){var t=a()(m).call(m,(function(t){return t.id===+e}));r[e]=t.$$serialize(t,r[e])}));var v=c()(e=[y.unit]).call(e,(function(e){return{from:y.timeStart,to:y.timeEnd,title:y.reservationTitle,reservationNote:y.reservationNote,centerId:u.getCurrentCenterId(),reservationUnitId:e.id,emailConfirmation:y.emailConfirmation,repeatFrequency:y.repeatFrequency.id,repeatDuration:angular.isDefined(y.repeatFrequency.repeatDurationOptions)?y.repeatDuration:"",fields:r}})),h=c()(v).call(v,(function(e){return d.save(u.getCurrentCenterId(),u.getCurrentUserId(),e).catch((function(e){return l.error(e,"Failed to save reservation.")}))}));return t.all(h).then((function(e){return u.setParam("accessCode",e[0].accessCode),u.setPath("/bay-reservation/complete")})).catch((function(e){var r;return t.all(c()(r=p()(v).call(v,(function(e){return!!e.id}))).call(r,(function(e){return d.delete(u.getCurrentCenterId(),u.getCurrentUserId(),e.id)})))}))},y.back=function(){return u.setPath("/bay-reservation/reservation")},y.hasRecurring=function(){return f.isAdmin()||!s.hideRecurringReservations}}])},rIyG:function(e,t){e.exports='<div class="bay-reservation br-centers ff-bmargin"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <div class="ff-grid ff-gutter-h ff-gutter-v"> <ff-panel class="ff-panel-card" flex="{md: \'0 0 50%\'}" ng-repeat="center in $ctrl.centers"> <ff-img ff-src="{{::center.thumbnail}}" ff-src-hq="{{::center.photo}}" ff-alt="{{::center.name}}" img-placeholder="{{\'GLOBAL.NO_PHOTO\' | translate}}"></ff-img> <div flex="1 1 auto"> <ff-header style="margin-bottom:.5rem">{{::center.name}}</ff-header> <div class="ff-grid gutter-v-half" flex="1 1 auto"> <div flex="1 1 auto"> <div class="br-center-address"> <ff-icon sense="location"></ff-icon> <a href="{{::$ctrl.getMapUrl(center)}}" target="_blank" rel="noopener"> {{::center.street2 ? center.street1 + \', \' + center.street2 : center.street1}} </a> </div> <div class="br-center-phone"> <ff-icon sense="phone"></ff-icon> <a href="tel:{{::center.phone}}">{{::center.phone}}</a> </div> <div class="br-center-email"> <ff-icon sense="email"></ff-icon> <a href="mailto:{{::center.email}}" target="_blank" rel="noopener">{{::center.email}}</a> </div> </div> <ff-btn-group flex="0 0 auto"> <ff-btn sense="ok" ff-click="$ctrl.select(center)" aria-label="{{(\'BAY_RESERVATION.BTN_SELECT\' | translate) + \' \' + center.name}}"> <span translate="BAY_RESERVATION.BTN_SELECT"></span> </ff-btn> </ff-btn-group> </div> </div> </ff-panel> </div> </ff-board> </div> '},tzPS:function(e,t,r){"use strict";var n=r("IJqC"),a=r.n(n);t.a=angular.module("deskworks.reservationAgreement",["deskworks.helper","deskworks.state"]).directive("reservationAgreement",(function(){return{restrict:"E",scope:!0,template:a.a,translations:["reservations"]}}))},"y+2o":function(e,t,r){"use strict";r.r(t);var n=r("yCd9"),a=r.n(n),s=r("03wM"),i=r.n(s),l=r("hsT8"),o=r.n(l),f=r("nbuU"),c=r.n(f),u=r("NOor"),p=r.n(u),d=r("a8hB"),m=r.n(d),g=r("ipr/"),v=r.n(g),h=(r("Muwe"),r("w13K"),r("aZFp"),r("y89P"),r("JBxO"),r("FdtR"),r("3dw1"),r("aDfn"),r("dLOS")),y=r("aIjk"),b=r("tzPS"),$=r("Vtxe"),P=r("1/Md"),E=r("+l1P");t.default=angular.module("deskworks.BayReservationPurchaseCtrl",["ngRoute","deskworks.helper","deskworks.StaffHelpCtrl","deskworks.purchase.service","deskworks.reservationService","deskworks.userProfile.service","deskworks.reservationUnit.optsRepeatFrequency","deskworks.dwAddChargesBr",h.a.name,y.a.name,b.a.name,$.a.name,P.a.name,E.a.name]).controller("BayReservationPurchaseCtrl",["$scope","$filter","$q","$route","$translate","$timeout","dwAlerts","helper","session","state","center","purchase","user","unit","settings","reservationFields","userTypes","purchaseService","reservationService","userProfileService","optsRepeatFrequency","bayReservationRedirect",function(e,t,r,n,s,l,f,u,d,g,h,y,b,$,P,E,T,R,w,C,k,N){var A,S=this;g.setPageTitle(s.instant("SIMPLE_RES.PURCHASE.PAGE_TITLE",{centerName:h.name})),S.center=h,S.user=b,S.isGuest=S.user.email&&S.user.email.match(/guest\d+@guest\d+\.com/),S.isGuest&&(S.user.firstName="",S.user.lastName=""),S.contact={fullName:S.isGuest?"":S.user.fullName,phone:S.user.phones[0]&&S.user.phones[0].number||"",email:S.isGuest?"":S.user.email},S.settings=P,S.purchase=y,S.packages=a()(A=g.getParam("packages").split(",")).call(A,(function(e){return+e})),S.unit=$,S.nipByType=g.getParam("nipByType")?JSON.parse(g.getParam("nipByType")):null,S.nipByType&&(S.nip=i()(S.nipByType).reduce((function(e,t){return e+(S.nipByType[t]||0)}),0),S.npf=isNaN(+g.getParam("npf"))?null:+g.getParam("npf")),S.userTypes=o()(T).call(T,(function(e){return!S.nipByType||S.nipByType[e.id]>0})),S.typeToPay=isNaN(+g.getParam("typeToPay"))?S.userTypes[0]&&S.userTypes[0].id:+g.getParam("typeToPay"),S.timeStart=t("toDate")(g.getParam("start")),S.timeEnd=t("toDate")(g.getParam("end")),S.reservationTitle=g.getParam("title")||"",S.reservationNote=g.getParam("note")||"",S.emailConfirmation=!!g.getParam("confirm"),e.$watch("$ctrl.emailConfirmation",(function(e){g.setParam("confirm",e||null).replace()})),S.repeatFrequency=k[0],g.getParam("freq")&&(S.repeatFrequency=c()(k).call(k,(function(e){return e.id===g.getParam("freq")})),S.repeatFrequency&&S.repeatFrequency.repeatDurationOptions&&g.getParam("duration")-1<S.repeatFrequency.repeatDurationOptions.length&&(S.repeatDuration=+g.getParam("duration"))),S.next=function(){if(!u.pointFirstInvalid("#bayReservationPurchase"))return S.user.phones[0]||S.user.phones.push(C.phone.new()),S.user.phones[0].number=S.contact.phone,S.spin=!0,C.updateRaw(g.getCurrentCenterId(),S.user,{firstName:S.user.firstName,lastName:S.user.lastName,email:S.contact.email}).catch((function(e){return f.error(e,"Failed to update user.")})).then((function(){return C.phone.save(g.getCurrentCenterId(),S.user.id,S.user.phones[0]).catch((function(e){return f.error(e,"Failed to save phone.")}))})).then((function(){return C.saveBillingProfile(g.getCurrentCenterId(),b).then((function(){return+S.purchase.balance<=0?g.setPath("/bay-reservation/complete"):S.createReservationWithPayment().then((function(e){return S.updatePurchase().then((function(t){return e}))})).then((function(e){return g.replace().setParam("accessCode",e.accessCode),l((function(e){return g.setPath("/bay-reservation/complete")}))}))}))})).finally((function(){S.spin=!1}))},S.payFor=function(e){return N({quantity:e})},S.payForType=function(){return g.replace().setParam("typeToPay",S.typeToPay),l((function(){return N({quantity:1})}))},S.createReservationWithPayment=function(e){var t=JSON.parse(g.getParam("fields")||"{}"),r=p()(E).call(E,(function(e){return"number"===e.type})),n=E[r].id,a=c()(E).call(E,(function(e,t){return t>r&&"number"===e.type})).id;t[n]=S.nip,t[a]=S.npf,i()(t).forEach((function(e){var r=c()(E).call(E,(function(t){return t.id===+e}));t[e]=r.$$serialize(r,t[e])}));var s={from:S.timeStart,to:S.timeEnd,reservationNote:S.reservationNote,title:S.reservationTitle,reservationUnitIds:[S.unit.id],reservationUnitId:S.unit.id,purchasePackageIds:S.packages,purchasePackageId:S.packages[0],emailConfirmation:!0,repeatFrequency:S.repeatFrequency.id,repeatDuration:S.repeatDuration,fields:t};return w.saveWithPayment(S.center.id,S.user.id,s).catch((function(e){return f.error(e,"Failed to make reservation and payment.")}))},S.updatePurchase=function(e){return R.get(S.center.id,S.user.id,S.purchase.id).catch((function(e){return f.error(e,"Failed to get purchase.")})).then((function(e){S.purchase=e}))},S.back=function(){return g.setPath("/bay-reservation/time")},S.staffHelp=function(){return R.createStaffHelp(S.center.id,S.user.id,S.purchase.id).catch((function(e){return f.error(e,"Failed to create staff help.")})).then((function(e){return g.setParam("notice",e.notice),g.setPath("/bay-reservation/staff-help")}))},S.hasRecurring=function(){return d.isAdmin()||!P.hideRecurringReservations},S.onNameChange=function(){var e,t=m()(e=S.contact.fullName||"").call(e),r=t.indexOf(" ");if(S.user.firstName=r>=0?v()(t).call(t,0,r):t,S.user.lastName=r>=0?v()(t).call(t,r):"",S.form.firstName.$pristine&&S.form.lastName.$pristine){var n=S.user.creditCards[0]||{};n.firstName=S.user.firstName,n.lastName=S.user.lastName}}}])}}]);