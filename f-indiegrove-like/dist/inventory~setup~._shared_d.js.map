{"version":3,"sources":["webpack:///./shared/drag-n-drop/dnd.service.js","webpack:///./shared/drag-n-drop/drag-n-drop.scss?4a61","webpack:///./shared/drag-n-drop/keese.service.js","webpack:///./shared/reservation-rules/reservation-rules.component.js","webpack:///./shared/reservation-rules/reservation-rules.scss?3e59","webpack:///./shared/reservation-rules/reservation-rules.tpl.html","webpack:///./shared/reservation-rules/rr-checklist.component.js","webpack:///./shared/reservation-rules/rr-checklist.tpl.html","webpack:///./shared/reservation-rules/rr-date-limit.component.js","webpack:///./shared/reservation-rules/rr-date-limit.tpl.html","webpack:///./shared/reservation-rules/rr-limit.component.js","webpack:///./shared/reservation-rules/rr-limit.tpl.html","webpack:///./shared/reservation-rules/rr-rule.component.js","webpack:///./shared/reservation-rules/rr-rule.tpl.html","webpack:///./shared/reservation-rules/rr-static.component.js","webpack:///./shared/reservation-rules/rr-static.tpl.html","webpack:///./shared/reservation-rules/rr-weekday-limit.component.js","webpack:///./shared/reservation-rules/rr-weekday-limit.tpl.html","webpack:///./shared/services/reservation-rules/opts-reservation-buffer.service.js","webpack:///./shared/services/reservation-rules/opts-reservation-scale.service.js"],"names":["angular","module","keese","name","factory","move","srcList","srcIndex","targetList","targetIndex","item","index","indexOf","order","generate","alphabet","radix","length","order_specifier","values","i","low","high","count","multi_keese","single_keese","average","increment","result","Array","value","recurse","low_value","high_value","low_index","high_index","mid_index","Math","floor","mid_value","n","parse","digits","substr","order_length","add","Error","a","b","pad_to_equal_order","b_carry","max_digit_length","max","a_value","b_value","half_distance_value","half_distance_digits","j","half_distance","construct","result_digits","lastIndexOf","charAt","pad_in_place","optsReservationScale","optsReservationBuffer","rrChecklist","directive","scope","template","controller","bindToController","centerId","reservationUnitId","$scope","$q","$filter","$timeout","$translate","helper","dwAlerts","ReservationRules","productService","ReservationUnit","optsWhoCanReserve","optsReservationLimitMin","optsReservationLimitMax","optsDaysInAdvance","optsTimeInAdvance","$ctrl","conf","whoCanReserve","instant","opts","scale","buffer","fullTimeProduct","attachedUser","limitMin","limitMax","daysInAdvance","timeInAdvance","nestedUnits","$onInit","form","formReservationRules","$onChanges","query","catch","err","error","then","rules","uid","units","unit","u","id","type","fullTimeProductId","attachedUserName","getMembershipProducts","products","forEach","product","price","unshift","$watch","val","roles","role","$visible","$isVisible","hideRules","addDate","push","member","available","intervals","nonMember","resetRules","window","confirm","copyRules","all","rule","src","dst","interval","from","to","$as","saveFullTimeProduct","save","options","$element","addClass","require","link","$attrs","$controllers","rrCtrl","updateGhosts","addInterval","$$autoSaving","$ghosts","pop","deleteInterval","group","reduce","prev","curr","transclude","ruleSave","autoSave","saveFunc","wrap","rrForm","deleteRule","delete","ruleId","onInit","$locale","weekdayIds","onChangeAvailable","isString","wd","clone","weekday","toUpperCase","$watchCollection","$rootScope","_name","translate","$on","opt"],"mappings":"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","file":"inventory~setup~._shared_d.js?_rev=1c1f7c25959513772da3","sourcesContent":["import 'angular-drag-and-drop-lists';\nimport './drag-n-drop.scss';\nimport keese from './keese.service';\n\n/**\n * Drag'n'Drop helper service\n */\nexport default angular.module('dnd', [\n  'dndLists',\n  keese.name,\n])\n\n  .factory('dnd', function(keese) {\n    return {\n      move: move,\n    };\n\n    /**\n     * Move item from srcList[srcIndex] to targetList[targetIndex], auto-generates new order. Returns moved item.\n     */\n    function move(srcList, srcIndex, targetList, targetIndex) {\n      const item = srcList[srcIndex];\n\n      if (targetList) targetList.splice(targetIndex, 0, item); // copy item from source to target\n      // remove source item, possibly correcting index. We must do this immediately, otherwise ng-repeat complains about duplicates\n      if (srcList === targetList && targetIndex <= srcIndex) srcIndex++;\n      srcList.splice(srcIndex, 1); // remove source item\n\n      if (targetList) {\n        const index = targetList.indexOf(item); // find new index of item\n        item.order = keese.generate(targetList[index - 1] && targetList[index - 1].order, targetList[index + 1] && targetList[index + 1].order);\n      }\n\n      return item;\n    }\n  });\n","// extracted by extract-css-chunks-webpack-plugin","/**\n * Sort keys generator. Based on node-keese v1.1.1: https://github.com/thejoshwolfe/node-keese\n */\nexport default angular.module('keese', [])\n  .factory('keese', function() {\n\n    const alphabet = \"0123456789?@ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n    const radix = alphabet.length;\n    const order_specifier = '~'; // bigger than any from the alphabet\n\n    /**\n     * Character to numerical value aka index of the character: \"0\": 0, \"z\": 63, etc.\n     */\n    const values = (function() {\n      const values = {};\n      for (let i = 0; i < alphabet.length; i++) values[alphabet[i]] = i;\n      return values;\n    })();\n\n    return {\n      /**\n       * Main exported function. Generates new sort key.\n       * @param low - previous sort key or null/undefined\n       * @param high - next sort key or null/undefined\n       * @param count - if defined - the result is an Array of size count values\n       * @returns {*} - single key or array of keys, depending on count\n       */\n      generate: function keese(low, high, count) {\n        if (count) {\n          return multi_keese(low, high, count);\n        } else {\n          return single_keese(low, high);\n        }\n      }\n    };\n\n    function single_keese(low, high) {\n      if (!low) {\n        if (!high) {\n          return '1'; // return anything above 0\n        } else {\n          return average('0', high); // go smaller\n        }\n      } else {\n        if (!high) {\n          return increment(low); // go bigger\n        } else {\n          return average(low, high); // go in between\n        }\n      }\n    }\n    function multi_keese(low, high, count) {\n      let result = new Array(count);\n      if (count > 0) {\n        if (!high) {\n          for (let i = 0; i < count; i++) { // just allocate straight forward\n            const value = keese(low, null);\n            result[i] = value;\n            low = value;\n          }\n        } else {\n          recurse(low, high, 0, count); // binary tree descent\n        }\n      }\n      return result;\n      function recurse(low_value, high_value, low_index, high_index) {\n        const mid_index = Math.floor((low_index + high_index) / 2);\n        const mid_value = single_keese(low_value, high_value);\n        result[mid_index] = mid_value;\n        if (low_index < mid_index) recurse(low_value, mid_value, low_index, mid_index);\n        if (mid_index + 1 < high_index) recurse(mid_value, high_value, mid_index + 1, high_index);\n      }\n    }\n\n    function increment(value) {\n      const n = parse(value);\n      n.digits = n.digits.substr(0, n.order_length + 1); // drop the fraction\n      return add(n, parse(\"1\"));\n    }\n\n    function average(low, high) {\n      if (low > high) {\n        throw new Error('assertion failed: ' + JSON.stringify(low) + \" < \" + JSON.stringify(high));\n      }\n      const a = parse(low);\n      const b = parse(high);\n      pad_to_equal_order(a, b);\n      let b_carry = 0;\n      const max_digit_length = Math.max(a.digits.length, b.digits.length);\n      for (let i = 0; i < max_digit_length || b_carry > 0; i++) {\n        const a_value =            values[a.digits[i]] || 0;\n        const b_value = b_carry + (values[b.digits[i]] || 0);\n        if (a_value === b_value) continue;\n        if (a_value === b_value - 1) {\n          b_carry = radix; // we need more digits, but remember that b is ahead\n          continue;\n        }\n        // we have a distance of at least 2 between the values.\n        // half the distance floored is sure to be a positive single digit.\n        let half_distance_value = Math.floor((b_value - a_value) / 2);\n        let half_distance_digits = '';\n        for (let j = 0; j < i; j++)\n          half_distance_digits += '0';\n        half_distance_digits += alphabet[half_distance_value];\n        const half_distance = parse(construct(a.order_length, half_distance_digits));\n        // truncate insignificant digits of a\n        a.digits = a.digits.substr(0, i + 1);\n        return add(a, half_distance);\n      }\n      throw new Error(); // unreachable\n    }\n\n    function add(a, b) {\n      pad_to_equal_order(a, b);\n      let result_digits = \"\";\n      let order_length = a.order_length;\n      let value = 0;\n      for (let i = Math.max(a.digits.length, b.digits.length) - 1; i >= 0; i--) {\n        value += values[a.digits[i]] || 0;\n        value += values[b.digits[i]] || 0;\n        result_digits = alphabet[value % radix] + result_digits;\n        value = Math.floor(value / radix);\n      }\n      // overflow up to moar digits\n      while (value > 0) {\n        result_digits = alphabet[value % radix] + result_digits;\n        value = Math.floor(value / radix);\n        order_length++;\n      }\n      return construct(order_length, result_digits);\n    }\n\n    function parse(value) {\n      const order_length = value.lastIndexOf(order_specifier) + 1;\n      return {\n        order_length: order_length,\n        digits: value.substr(order_length)\n      };\n    }\n    function construct(order_length, digits) {\n      while (order_length > 0 && digits.charAt(0) == '0') { // strip unnecessary leading zeros\n        digits = digits.substr(1);\n        order_length--;\n      }\n      let result = \"\";\n      for (let i = 0; i < order_length; i++)\n        result += order_specifier;\n      return result + digits;\n    }\n\n    function pad_to_equal_order(a, b) {\n      pad_in_place(a, b.order_length);\n      pad_in_place(b, a.order_length);\n    }\n    function pad_in_place(n, order_length) {\n      while (n.order_length < order_length) {\n        n.digits = \"0\" + n.digits;\n        n.order_length++;\n      }\n    }\n  });\n","import template from './reservation-rules.tpl.html';\nimport './reservation-rules.scss';\nimport './rr-rule.component';\nimport './rr-limit.component';\nimport './rr-date-limit.component';\nimport './rr-static.component';\nimport './rr-weekday-limit.component';\nimport rrChecklist from './rr-checklist.component';\nimport optsReservationScale from 'shared/services/reservation-rules/opts-reservation-scale.service';\nimport optsReservationBuffer from 'shared/services/reservation-rules/opts-reservation-buffer.service';\n\n/**\n * reservationRules component - reservation rules widget for center / reservation category / reservation unit\n */\nexport default angular.module('deskworks.reservationRules', [\n  'deskworks.reservationRules.service',\n  'deskworks.inventory.product.service',\n  'deskworks.reservationRules.rrRule',\n  'deskworks.reservationRules.rrLimit',\n  'deskworks.reservationRules.rrWeekdayLimit',\n  'deskworks.reservationRules.rrDateLimit',\n  'deskworks.reservationRules.rrStatic',\n  'deskworks.reservationRules.optsWhoCanReserve',\n  'deskworks.reservationRules.optsReservationLimitMin',\n  'deskworks.reservationRules.optsReservationLimitMax',\n  'deskworks.reservationRules.optsDaysInAdvance',\n  'deskworks.reservationRules.optsTimeInAdvance',\n  optsReservationScale.name,\n  optsReservationBuffer.name,\n  rrChecklist.name,\n])\n\n  .directive('reservationRules', function() {\n    return {\n      scope: true,\n      template: template,\n      controller: 'ReservationRulesCtrl as $ctrl',\n      bindToController: {\n        centerId: '<',\n        reservationUnitId: '<',\n      },\n    };\n  })\n\n  .controller('ReservationRulesCtrl', function($scope, $q, $filter, $timeout, $translate, helper, dwAlerts,\n                                               ReservationRules, productService, ReservationUnit,\n                                               optsWhoCanReserve, optsReservationLimitMin, optsReservationLimitMax,\n                                               optsDaysInAdvance, optsTimeInAdvance,\n                                               optsReservationScale, optsReservationBuffer) {\n    const $ctrl = this;\n\n    $ctrl.conf = {\n      whoCanReserve: { name: $translate.instant('RESERVATION_RULES.WHO_CAN_RESERVE'), opts: optsWhoCanReserve },\n      scale: { name: $translate.instant('RESERVATION_RULES.RESERVATION_SCALE'), opts: optsReservationScale },\n      buffer: { name: $translate.instant('RESERVATION_RULES.RESERVATION_BUFFER'), opts: optsReservationBuffer },\n      fullTimeProduct: { name: $translate.instant('RESERVATION_RULES.FULL_TIME_PRODUCT') }, // deferred opts\n      attachedUser: { name: $translate.instant('RESERVATION_RULES.ATTACHED_USER') }, // no opts\n      limitMin: { name: $translate.instant('RESERVATION_RULES.MIN_LIMIT'), opts: optsReservationLimitMin },\n      limitMax: { name: $translate.instant('RESERVATION_RULES.MAX_LIMIT'), opts: optsReservationLimitMax },\n      daysInAdvance: { name: $translate.instant('RESERVATION_RULES.DAYS_IN_ADVANCE'), opts: optsDaysInAdvance },\n      timeInAdvance: { name: $translate.instant('RESERVATION_RULES.TIME_IN_ADVANCE'), opts: optsTimeInAdvance },\n      nestedUnits: { name: $translate.instant('RESERVATION_RULES.NESTED_UNITS') }, // deferred opts\n    };\n\n    /**\n     * Component $onInit\n     */\n    $ctrl.$onInit = () => {\n      $ctrl.form = $scope.formReservationRules;\n    };\n\n    /**\n     * Component $onChanges\n     */\n    $ctrl.$onChanges = () => {\n      ReservationRules.query({ centerId: $ctrl.centerId, reservationUnitId: $ctrl.reservationUnitId })\n        .catch(err => dwAlerts.error(err, 'Failed to load reservation rules.'))\n        .then(result => {\n          $ctrl.rules = result;\n          $ctrl.whoCanReserve = $ctrl.rules.find(i => i.uid === 'whoCanReserve');\n          $ctrl.scale = $ctrl.rules.find(i => i.uid === 'scale');\n          $ctrl.buffer = $ctrl.rules.find(i => i.uid === 'buffer');\n        });\n\n      if ($ctrl.reservationUnitId) {\n        ReservationUnit.query($ctrl.centerId)\n          .catch(err => dwAlerts.error(err, 'Reservation Rules failed to query reservation units.'))\n          .then(units => {\n            const unit = units.find(u => u.id === $ctrl.reservationUnitId) || {};\n            $ctrl.fullTimeProduct = { uid: 'fullTimeProduct', type: 'value', value: unit.fullTimeProductId };\n            $ctrl.attachedUser = { uid: 'attachedUser', type: 'static', value: unit.attachedUserName };\n            // $ctrl.conf.nestedUnits.opts = units.filter(u => u.reservationTypeId === unit.reservationTypeId && u.id !== unit.id);\n            $ctrl.conf.nestedUnits.opts = units.filter(u => u.whoCanReserve !== 'notAvailable' && u.id !== unit.id);\n          });\n\n        productService.getMembershipProducts($ctrl.centerId)\n          .catch(err => dwAlerts.error(err, 'Reservation Rules failed to query membership products.'))\n          .then(products => {\n            angular.forEach(products, product => { product.name += ' (' + $filter('ncurrency')(product.price) + ')'; });\n            $ctrl.conf.fullTimeProduct.opts = products;\n            $ctrl.conf.fullTimeProduct.opts.unshift({ id: null, name: $translate.instant('GLOBAL.NONE') });\n          });\n      }\n    };\n\n    /**\n     * Control roles visibility\n     */\n    $scope.$watch('$ctrl.whoCanReserve.value', val => {\n      if (!val) return;\n      ReservationRules.roles.forEach(role => { role.$visible = role.$isVisible(val); });\n\n      $ctrl.hideRules = val === 'staffOnly' || val === 'notAvailable';\n    });\n\n    /**\n     * Add date to Annual Holiday Calendar\n     */\n    $ctrl.addDate = () => {\n      $ctrl.rules.push({\n        type: 'date',\n        member: { available: false, intervals: [] },\n        nonMember: { available: false, intervals: [] },\n      });\n    };\n\n    /**\n     * Reset rules - copy from center defaults\n     */\n    $ctrl.resetRules = () => {\n      if (!window.confirm($translate.instant('RESERVATION_RULES.ACTIVE.BTN_RESET.CONFIRM'))) return;\n\n      return ReservationRules.query({ centerId: $ctrl.centerId })\n        .catch(err => dwAlerts.error(err, 'Failed to load reservation rules defaults from center.'))\n        .then(result => $ctrl.copyRules(result));\n    };\n\n    /**\n     * Copy values of all passed rules to $ctrl.rules and trigger auto-save\n     */\n    $ctrl.copyRules = rules => {\n      return $q.all(rules\n        .filter(rule => rule.type === 'value' || rule.type === 'roles' || rule.type === 'weekday')\n        .map(src => {\n          const dst = helper.find($ctrl.rules, { uid: src.uid });\n          if (!dst) return;\n          switch (src.type) {\n            case 'value':\n              dst.value = src.value;\n              break;\n            case 'roles':\n              ReservationRules.roles.forEach(role => { dst[role.id] = src[role.id]; });\n              break;\n            case 'weekday':\n              ReservationRules.roles.forEach(role => {\n                dst[role.id].available = src[role.id].available;\n                dst[role.id].intervals = src[role.id].intervals.map(interval => { return { from: interval.from, to: interval.to }; });\n              });\n          }\n          return $timeout(() => dst.$as(), 100);\n        })\n      );\n    };\n\n    /**\n     * Save Full Time Product callback\n     */\n    $ctrl.saveFullTimeProduct = () => {\n      return ReservationUnit.save($ctrl.centerId, { id: $ctrl.reservationUnitId, fullTimeProductId: $ctrl.fullTimeProduct.value && +$ctrl.fullTimeProduct.value || null })\n        .catch(err => dwAlerts.error(err, 'Failed to save full time product.'));\n    };\n  });\n","// extracted by extract-css-chunks-webpack-plugin","// Module\nvar code = \"<form name=\\\"formReservationRules\\\" novalidate> <div class=\\\"gutter-v\\\"> <ff-panel> <ff-panel-header ng-if=\\\"$ctrl.reservationUnitId\\\"> <div class=\\\"ff-grid gutter-v-half gutter-h-half\\\"> <div flex=\\\"auto\\\"> <span translate=\\\"RESERVATION_RULES.ACTIVE.HEADER\\\"></span> <ff-hint><span translate=\\\"RESERVATION_RULES.ACTIVE.HINT\\\"></span></ff-hint> </div> <ff-btn flex=\\\"none\\\" sense=\\\"clone\\\" size=\\\"sm\\\" ff-click=\\\"$ctrl.resetRules()\\\" style=\\\"margin:-.5rem 0 .5rem 0\\\"> <span translate=\\\"RESERVATION_RULES.ACTIVE.BTN_RESET\\\"></span> </ff-btn> </div> </ff-panel-header> <ff-panel-header ng-if=\\\"!$ctrl.reservationUnitId\\\"> <span translate=\\\"RESERVATION_RULES.DEFAULT.HEADER\\\"></span> <ff-hint><span translate=\\\"RESERVATION_RULES.DEFAULT.HINT\\\"></span></ff-hint> </ff-panel-header> <ff-col ff-dim=\\\"!$ctrl.rules\\\" class=\\\"gutter-v\\\"> <ff-col> <div class=\\\"rr-container gutter-v-half\\\"> <rr-rule rule=\\\"$ctrl.whoCanReserve\\\" options=\\\"$ctrl.conf.whoCanReserve.opts\\\" flex=\\\"{sm: '1 1 137px', md: '0 0 180px'}\\\">{{$ctrl.conf.whoCanReserve.name}}</rr-rule> <rr-rule rule=\\\"$ctrl.fullTimeProduct\\\" options=\\\"$ctrl.conf.fullTimeProduct.opts\\\" ng-if=\\\"$ctrl.reservationUnitId && $ctrl.conf.fullTimeProduct.opts\\\" rule-save=\\\"$ctrl.saveFullTimeProduct()\\\" flex=\\\"{sm: '1 1 176px', md: '0 0 350px'}\\\">{{$ctrl.conf.fullTimeProduct.name}}</rr-rule> <rr-rule rule=\\\"$ctrl.attachedUser\\\" ng-if=\\\"$ctrl.reservationUnitId && $ctrl.whoCanReserve.value === 'notAvailable'\\\" flex=\\\"{sm: '1 1 313px', md: '0 0 250px'}\\\">{{$ctrl.conf.attachedUser.name}}</rr-rule> </div> </ff-col> <ff-col ng-if=\\\"$ctrl.rules\\\"> <div class=\\\"rr-container gutter-v-half\\\"> <rr-rule rule=\\\"$ctrl.scale\\\" options=\\\"$ctrl.conf.scale.opts\\\" flex=\\\"{sm: '1 1 176px', md: '0 0 200px'}\\\"> {{$ctrl.conf.scale.name}} <ff-hint><span translate=\\\"RESERVATION_RULES.RESERVATION_SCALE.HINT\\\"></span></ff-hint> </rr-rule> <rr-rule rule=\\\"$ctrl.buffer\\\" options=\\\"$ctrl.conf.buffer.opts\\\" flex=\\\"{sm: '1 1 176px', md: '0 0 200px'}\\\"> {{$ctrl.conf.buffer.name}} <ff-hint><span translate=\\\"RESERVATION_RULES.RESERVATION_BUFFER.HINT\\\"></span></ff-hint> </rr-rule> </div> </ff-col> <ff-col ng-if=\\\"!$ctrl.hideRules\\\"> <div class=\\\"rr-container gutter-v-half\\\"> <rr-rule rule=\\\"rule\\\" options=\\\"$ctrl.conf[rule.uid].opts\\\" ng-repeat=\\\"rule in $ctrl.rules | filter:{ type: 'roles' }\\\" flex=\\\"{sm: '0 0 50%', md: '0 0 200px'}\\\"> <span ng-bind-html=\\\"$ctrl.conf[rule.uid].name\\\"></span> </rr-rule> </div> </ff-col> <ff-col ng-if=\\\"!$ctrl.hideRules\\\"> <div class=\\\"rr-container gutter-v-half\\\"> <rr-rule rule=\\\"rule\\\" ng-repeat=\\\"rule in $ctrl.rules | filter:{ type: 'weekday' }\\\" flex=\\\"{sm: '0 0 50%', md: '0 0 200px'}\\\">{{rule.name.toUpperCase()}}</rr-rule> </div> </ff-col> <ff-col ng-if=\\\"!$ctrl.hideRules\\\"> <div class=\\\"rr-container gutter-v-half\\\"> <rr-rule rule=\\\"rule\\\" ng-repeat=\\\"rule in $ctrl.rules | filter:{ type: 'checklist' }\\\" options=\\\"$ctrl.conf[rule.uid].opts\\\" flex=\\\"auto\\\" class=\\\"animate-collapse\\\" ng-if=\\\"$ctrl.conf[rule.uid].opts.length\\\">{{$ctrl.conf[rule.uid].name}}</rr-rule> </div> </ff-col> </ff-col> </ff-panel> <ff-panel class=\\\"rr-calendar\\\" ng-if=\\\"!$ctrl.reservationUnitId\\\"> <ff-panel-header> <span translate=\\\"RESERVATION_RULES.ANNUAL.HEADER\\\"></span> <ff-hint><span translate=\\\"RESERVATION_RULES.ANNUAL.HINT\\\"></span></ff-hint> </ff-panel-header> <ff-col ff-dim=\\\"!$ctrl.rules\\\"> <div class=\\\"rr-container gutter-v-half\\\"> <rr-rule rule=\\\"rule\\\" ng-repeat=\\\"rule in $ctrl.rules | filter:{ type: 'date' }\\\" flex=\\\"{sm: '0 0 50%', md: '0 0 200px'}\\\"></rr-rule> </div> <ff-btn-group class=\\\"ff-section-buttons\\\"> <ff-btn sense=\\\"add\\\" size=\\\"sm\\\" ff-click=\\\"$ctrl.addDate()\\\"><span translate=\\\"RESERVATION_RULES.BTN_ADD_DATE\\\"></span></ff-btn> </ff-btn-group> </ff-col> </ff-panel> </div> </form> \";\n// Exports\nmodule.exports = code;","import template from './rr-checklist.tpl.html';\n\n/**\n * rrChecklist component - checkbox list component for reservation rules\n */\nexport default angular.module('deskworks.reservationRules.rrChecklist', [])\n\n  .directive('rrChecklist', () => {\n    return {\n      scope: true,\n      template: template,\n      controller: 'RrChecklistCtrl as $ctrl',\n      bindToController: {\n        rule: '<',\n        role: '<',\n        options: '<',\n      },\n    };\n  })\n\n  .controller('RrChecklistCtrl', function($scope, $element) {\n    const $ctrl = this;\n\n    /**\n     * $onInit\n     */\n    $ctrl.$onInit = () => $element.addClass('ff-col');\n  });\n","// Module\nvar code = \"<div class=\\\"ff-grid gutter-h-half\\\" style=\\\"justify-content:flex-start\\\"> <label flex=\\\"none\\\" ng-repeat=\\\"opt in $ctrl.options\\\"> <ff-checkbox ff-model=\\\"$ctrl.rule.value[opt.id]\\\" ff-change=\\\"$ctrl.rule.$as()\\\">{{::opt.name}}</ff-checkbox> </label> </div> \";\n// Exports\nmodule.exports = code;","import template from './rr-date-limit.tpl.html';\n\n/**\n * rrDateLimit component - date intervals limit component for reservation rules / annual holiday calendar\n */\nexport default angular.module('deskworks.reservationRules.rrDateLimit', [\n  'deskworks.reservationRules.service',\n])\n\n  .directive('rrDateLimit', () => {\n    return {\n      scope: true,\n      require: ['rrDateLimit', '^^reservationRules'],\n      template: template,\n      controller: 'RrDateLimitCtrl as $ctrl',\n      bindToController: {\n        rule: '<',\n        role: '<',\n      },\n      link: ($scope, $element, $attrs, $controllers) => {\n        $controllers[0].rrCtrl = $controllers[1];\n      },\n    };\n  })\n\n  .controller('RrDateLimitCtrl', function($scope, $element, $timeout, $translate, helper, ReservationRules) { 'use strict';\n    const $ctrl = this;\n\n    $ctrl.options = [\n      { id: true, name: $translate.instant('RESERVATION_RULES.AVAILABLE') },\n      { id: false, name: $translate.instant('RESERVATION_RULES.NOT_AVAILABLE') },\n    ];\n\n    /**\n     * $onInit\n     */\n    $ctrl.$onInit = () => {\n      $element.addClass('ff-col');\n      $scope.$watch('$ctrl.rrCtrl.rules', $ctrl.updateGhosts);\n    };\n\n    /**\n     * $onChanges\n     */\n    // $ctrl.$onChanges = function(z) {\n    //   // $ctrl.updateGhosts();\n    // };\n\n    /**\n     * Add Interval\n     */\n    $ctrl.addInterval = () => {\n      if ($ctrl.rule.$$autoSaving) return;\n      if ($ctrl.rule[$ctrl.role].$ghosts) $ctrl.rule[$ctrl.role].$ghosts.pop();\n      $timeout(() => {\n        $ctrl.rule[$ctrl.role].intervals.push({ from: null, to: null });\n        $ctrl.updateGhosts();\n      });\n    };\n\n    /**\n     * Delete Interval\n     */\n    $ctrl.deleteInterval = interval => {\n      if ($ctrl.rule.$$autoSaving) return;\n      $ctrl.rule[$ctrl.role].intervals.splice($ctrl.rule[$ctrl.role].intervals.indexOf(interval), 1);\n      $timeout($ctrl.updateGhosts);\n      return interval.id ? $ctrl.rule.$as() : null;\n    };\n\n    /**\n     * Update ghost items to sync rrRule items height\n     */\n    $ctrl.updateGhosts = () => {\n      if (!$ctrl.rrCtrl) return;\n\n      const group = $ctrl.rrCtrl.rules.filter(rule => rule.type === 'date');\n\n      ReservationRules.roles.forEach(role => {\n        const max = group.reduce((prev, curr) => curr[role.id].available && curr[role.id].intervals.length > prev ? curr[role.id].intervals.length : prev, 0);\n\n        group.forEach(rule => {\n          rule[role.id].$ghosts = new Array(max - (rule[role.id].available ? rule[role.id].intervals.length : 0));\n        });\n      });\n    };\n  });\n","// Module\nvar code = \"<ff-row> <ff-select ff-model=\\\"$ctrl.rule[$ctrl.role].available\\\" ff-options=\\\"opt.id as opt.name for opt in $ctrl.options\\\" ff-change=\\\"$ctrl.updateGhosts() + $ctrl.rule.$as()\\\"></ff-select> <ff-btn flex=\\\"none\\\" sense=\\\"add\\\" size=\\\"xs\\\" ng-class=\\\"{ invisible: !$ctrl.rule[$ctrl.role].available }\\\" title=\\\"{{'RESERVATION_RULES.BTN_ADD_INTERVAL.HINT' | translate}}\\\" ff-click=\\\"$ctrl.addInterval()\\\"></ff-btn> </ff-row> <ff-row ng-repeat=\\\"interval in $ctrl.rule[$ctrl.role].intervals\\\" ng-if=\\\"$ctrl.rule[$ctrl.role].available\\\"> <ff-time ff-model=\\\"interval.from\\\" ff-change=\\\"$ctrl.rule.$as()\\\" ff-required=\\\"true\\\" ff-time-order=\\\"{ early: interval.from, late: interval.to }\\\" ff-validate-alert=\\\"{ field: ('RESERVATION_RULES.TIME_FROM' | translate), late: ('RESERVATION_RULES.TIME_TO' | translate) }\\\" placeholder=\\\"09:00 AM\\\"></ff-time> <ff-time ff-model=\\\"interval.to\\\" ff-change=\\\"$ctrl.rule.$as()\\\" ff-required=\\\"true\\\" ff-time-order=\\\"{ early: interval.from, late: interval.to }\\\" ff-validate-alert=\\\"{ field: ('RESERVATION_RULES.TIME_TO' | translate), early: ('RESERVATION_RULES.TIME_FROM' | translate) }\\\" placeholder=\\\"05:00 PM\\\"></ff-time> <ff-btn flex=\\\"none\\\" sense=\\\"delete\\\" size=\\\"xs\\\" ff-click=\\\"$ctrl.deleteInterval(interval)\\\" title=\\\"{{'RESERVATION_RULES.BTN_DELETE_INTERVAL.HINT' | translate}}\\\"></ff-btn> </ff-row> <ff-row ng-repeat=\\\"item in $ctrl.rule[$ctrl.role].$ghosts track by $index\\\"> <ff-static></ff-static> </ff-row> \";\n// Exports\nmodule.exports = code;","import template from './rr-limit.tpl.html';\n\n/**\n * rrLimit component - limit component for reservation rules\n */\nexport default angular.module('deskworks.reservationRules.rrLimit', [])\n\n  .directive('rrLimit', () => {\n    return {\n      scope: true,\n      template: template,\n      controller: 'RrLimitCtrl as $ctrl',\n      bindToController: {\n        rule: '<',\n        role: '<',\n        options: '<',\n      },\n    };\n  })\n\n  .controller('RrLimitCtrl', function($scope, $element) { 'use strict';\n    const $ctrl = this;\n\n    /**\n     * $onInit\n     */\n    $ctrl.$onInit = () => $element.addClass('ff-col');\n\n    // /**\n    //  * $onChanges\n    //  */\n    // $ctrl.$onChanges = function() {\n    // };\n  });\n","// Module\nvar code = \"<div> <ff-select ff-model=\\\"$ctrl.rule[$ctrl.role]\\\" ff-options=\\\"opt.id as opt.name for opt in $ctrl.options\\\" ng-if=\\\"$ctrl.rule.type === 'roles'\\\" ff-change=\\\"$ctrl.rule.$as()\\\"></ff-select> <ff-select ff-model=\\\"$ctrl.rule.value\\\" ff-options=\\\"opt.id as opt.name for opt in $ctrl.options\\\" ng-if=\\\"$ctrl.rule.type === 'value'\\\" ff-change=\\\"$ctrl.rule.$as()\\\"></ff-select> </div> \";\n// Exports\nmodule.exports = code;","import template from './rr-rule.tpl.html';\n\n/**\n * rrRule component - rule component for reservation rules\n */\nexport default angular.module('deskworks.reservationRules.rrRule', [\n  'autoSave',\n  'deskworks.reservationRules.service',\n])\n\n  .directive('rrRule', () => {\n    return {\n      scope: true,\n      require: { rrCtrl: '^^reservationRules' },\n      transclude: true,\n      template: template,\n      controller: 'RrRuleCtrl as $ctrl',\n      bindToController: {\n        rule: '<',\n        options: '<',\n        ruleSave: '&?',\n      },\n    };\n  })\n\n  .controller('RrRuleCtrl', function($scope, $element, $timeout, helper, dwAlerts, ReservationRules, autoSave) {\n    const $ctrl = this;\n\n    /**\n     * $onInit\n     */\n    $ctrl.$onInit = () => {\n      $element.addClass('ff-col');\n      $ctrl.roles = ReservationRules.roles;\n    };\n\n    /**\n     * $onChanges\n     */\n    $ctrl.$onChanges = () => {\n      if (!$ctrl.rule) return;\n\n      $timeout(() => { // timeout to complete linking and make $scope.rrForm available\n        const saveFunc = $ctrl.ruleSave || function() {\n          return ReservationRules.save({ centerId: $ctrl.rrCtrl.centerId, reservationUnitId: $ctrl.rrCtrl.reservationUnitId }, this)\n            .catch(err => dwAlerts.error(err, 'Failed to save rule.'));\n        };\n        $ctrl.rule.$as = autoSave.wrap(saveFunc, $scope.rrForm);\n      });\n    };\n\n    /**\n     * Delete rule\n     */\n    $ctrl.deleteRule = () => {\n      return ($ctrl.rule.id ? ReservationRules.delete({ centerId: $ctrl.rrCtrl.centerId, ruleId: $ctrl.rule.id }) : $timeout())\n        .then(() => $ctrl.rrCtrl.rules.splice($ctrl.rrCtrl.rules.indexOf($ctrl.rule), 1))\n        .catch(err => dwAlerts.error(err, 'Failed to delete rule'));\n    };\n  });\n","// Module\nvar code = \"<ng-form name=\\\"rrForm\\\"> <ff-header ff-spin=\\\"$ctrl.rule.$$autoSaving\\\" class=\\\"ff-relative ff-spin-sm\\\"> <ff-header class=\\\"rr-role\\\"></ff-header> <cell ng-transclude flex=\\\"auto\\\"> <ff-row> <ff-col> <ff-date ff-model=\\\"$ctrl.rule.date\\\" ff-required=\\\"true\\\" ff-validate-alert=\\\"Date\\\" ff-change=\\\"$ctrl.rule.$as()\\\"></ff-date> <ff-text ff-model=\\\"$ctrl.rule.name\\\" ff-change=\\\"$ctrl.rule.$as()\\\"></ff-text> </ff-col> <ff-btn flex=\\\"none\\\" sense=\\\"delete\\\" size=\\\"xs\\\" ff-click=\\\"$ctrl.deleteRule()\\\" title=\\\"{{'RESERVATION_RULES.BTN_DELETE_DATE' | translate}}\\\"></ff-btn> </ff-row> </cell> </ff-header> <ff-row ng-repeat=\\\"role in $ctrl.roles\\\" ng-if=\\\"(role.$visible || $ctrl.rule.type === 'date') && $ctrl.rule.type !== 'value' && $ctrl.rule.type !== 'static' && $ctrl.rule.type !== 'checklist'\\\"> <ff-label class=\\\"rr-role\\\">{{role.name}}</ff-label> <rr-limit rule=\\\"$ctrl.rule\\\" role=\\\"role.id\\\" options=\\\"$ctrl.options\\\" ng-if=\\\"$ctrl.rule.type === 'roles'\\\"></rr-limit> <rr-weekday-limit rule=\\\"$ctrl.rule\\\" role=\\\"role.id\\\" ng-if=\\\"$ctrl.rule.type === 'weekday'\\\"></rr-weekday-limit> <rr-date-limit rule=\\\"$ctrl.rule\\\" role=\\\"role.id\\\" ng-if=\\\"$ctrl.rule.type === 'date'\\\"></rr-date-limit> </ff-row> <ff-row ng-if=\\\"$ctrl.rule.type === 'value'\\\"> <rr-limit rule=\\\"$ctrl.rule\\\" options=\\\"$ctrl.options\\\"></rr-limit> </ff-row> <ff-row ng-if=\\\"$ctrl.rule.type === 'static'\\\"> <rr-static rule=\\\"$ctrl.rule\\\"></rr-static> </ff-row> <ff-row ng-if=\\\"$ctrl.rule.type === 'checklist'\\\"> <rr-checklist rule=\\\"$ctrl.rule\\\" options=\\\"$ctrl.options\\\"></rr-checklist> </ff-row> </ng-form> \";\n// Exports\nmodule.exports = code;","import template from './rr-static.tpl.html';\n\n/**\n * rrStatic component - static (read-only) component for reservation rules\n */\nexport default angular.module('deskworks.reservationRules.rrStatic', [\n])\n\n  .directive('rrStatic', () => {\n    return {\n      scope: true,\n      require: ['rrWeekdayLimit', '^^reservationRules'],\n      template: template,\n      controller: 'RrStaticCtrl as $ctrl',\n      bindToController: {\n        rule: '<',\n      },\n    };\n  })\n\n  .controller('RrStaticCtrl', function ($scope, $element, helper) { 'use strict';\n    const $ctrl = this;\n\n    /**\n     * $onInit\n     */\n    $ctrl.$onInit = () => $element.addClass('ff-col');\n\n    // /**\n    //  * $onChanges\n    //  */\n    // $ctrl.$onChanges = function() {\n    // };\n  });\n","// Module\nvar code = \"<ff-static ff-bind=\\\"$ctrl.rule.value | nd\\\"></ff-static> \";\n// Exports\nmodule.exports = code;","import template from './rr-weekday-limit.tpl.html';\n\n/**\n * rrWeekdayLimit component - weekday intervals limit component for reservation rules\n */\nexport default angular.module('deskworks.reservationRules.rrWeekdayLimit', [\n  'deskworks.reservationRules.service',\n])\n\n  .directive('rrWeekdayLimit', () => {\n    return {\n      scope: true,\n      require: ['rrWeekdayLimit', '^^reservationRules'],\n      template: template,\n      controller: 'RrWeekdayLimitCtrl as $ctrl',\n      bindToController: {\n        rule: '<',\n        role: '<',\n      },\n      link: ($scope, $element, $attrs, $controllers) => {\n        $controllers[0].rrCtrl = $controllers[1];\n        $controllers[0].onInit();\n      },\n    };\n  })\n\n  .controller('RrWeekdayLimitCtrl', function($scope, $element, $timeout, $translate, $locale, helper,\n                                             ReservationRules) { 'use strict';\n    const $ctrl = this;\n\n    $ctrl.weekdayIds = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\n    $ctrl.options = [\n      { id: true, name: $translate.instant('RESERVATION_RULES.AVAILABLE') },\n      { id: false, name: $translate.instant('RESERVATION_RULES.NOT_AVAILABLE') },\n    ];\n\n    /**\n     * On change rule availability handler. If day of week selected, clones itself from rule of that day of week.\n     */\n    $ctrl.onChangeAvailable = () => {\n      if (angular.isString($ctrl.rule[$ctrl.role].available)) {\n        const wd = helper.find($ctrl.rrCtrl.rules, { uid: $ctrl.rule[$ctrl.role].available });\n        $ctrl.rule[$ctrl.role].intervals = wd[$ctrl.role].intervals\n          .map(interval => { return { from: interval.from.clone(), to: interval.to.clone() }; });\n        $ctrl.rule[$ctrl.role].available = wd[$ctrl.role].available;\n      }\n      $ctrl.updateGhosts();\n      $ctrl.rule.$as();\n    };\n\n    /**\n     * $onInit\n     */\n    $ctrl.onInit = () => {\n      $element.addClass('ff-col');\n      $ctrl.weekdayIds.forEach(weekday => {\n        if (weekday !== $ctrl.rule.uid) { // skip ourselves\n          $ctrl.options.push({ id: weekday, name: $translate.instant('RESERVATION_RULES.COPY_FROM', {\n            weekday: helper.find($ctrl.rrCtrl.rules, { uid: weekday }).name.toUpperCase(),\n          }) });\n        }\n      });\n\n      /**\n       * Watch for intervals and update ghosts\n       */\n      $scope.$watchCollection('$ctrl.rule[$ctrl.role].intervals', () => $ctrl.updateGhosts());\n    };\n\n    /**\n     * $onChanges\n     */\n    // $ctrl.$onChanges = function() {\n    // };\n\n    /**\n     * Add Interval\n     */\n    $ctrl.addInterval = () => {\n      if ($ctrl.rule.$$autoSaving) return;\n      $ctrl.rule[$ctrl.role].$ghosts.pop();\n      $timeout( () => $ctrl.rule[$ctrl.role].intervals.push({ from: null, to: null }) );\n    };\n\n    /**\n     * Delete Interval\n     */\n    $ctrl.deleteInterval = interval => {\n      if ($ctrl.rule.$$autoSaving) return;\n      $ctrl.rule[$ctrl.role].intervals.splice($ctrl.rule[$ctrl.role].intervals.indexOf(interval), 1);\n      return interval.id ? $ctrl.rule.$as() : null;\n    };\n\n    /**\n     * Update ghost items to sync rrRule items height\n     */\n    $ctrl.updateGhosts = () => {\n      const group = $ctrl.rrCtrl.rules.filter(rule => rule.type === 'weekday');\n\n      ReservationRules.roles.forEach(role => {\n        const max = group\n          .reduce((prev, curr) => curr[role.id].available && curr[role.id].intervals.length > prev ? curr[role.id].intervals.length : prev, 0);\n\n        group.forEach(rule => {\n          rule[role.id].$ghosts = new Array(max - (rule[role.id].available ? rule[role.id].intervals.length : 0));\n        });\n      });\n    };\n  });\n","// Module\nvar code = \"<ff-row> <ff-select ff-model=\\\"$ctrl.rule[$ctrl.role].available\\\" ff-options=\\\"opt.id as opt.name for opt in $ctrl.options\\\" ff-change=\\\"$ctrl.onChangeAvailable()\\\"></ff-select> <ff-btn flex=\\\"none\\\" sense=\\\"add\\\" size=\\\"xs\\\" ng-class=\\\"{ invisible: !$ctrl.rule[$ctrl.role].available }\\\" title=\\\"{{'RESERVATION_RULES.BTN_ADD_INTERVAL.HINT' | translate}}\\\" ff-click=\\\"$ctrl.addInterval()\\\"></ff-btn> </ff-row> <ff-row ng-repeat=\\\"interval in $ctrl.rule[$ctrl.role].intervals track by $index\\\" ng-if=\\\"$ctrl.rule[$ctrl.role].available\\\"> <ff-time ff-model=\\\"interval.from\\\" ff-change=\\\"$ctrl.rule.$as()\\\" ff-required=\\\"true\\\" ff-time-order=\\\"{ early: interval.from, late: interval.to }\\\" ff-validate-alert=\\\"{ field: ('RESERVATION_RULES.TIME_FROM' | translate), late: ('RESERVATION_RULES.TIME_TO' | translate) }\\\" placeholder=\\\"09:00 AM\\\"></ff-time> <ff-time ff-model=\\\"interval.to\\\" ff-change=\\\"$ctrl.rule.$as()\\\" ff-required=\\\"true\\\" ff-time-order=\\\"{ early: interval.from, late: interval.to }\\\" ff-validate-alert=\\\"{ field: ('RESERVATION_RULES.TIME_TO' | translate), early: ('RESERVATION_RULES.TIME_FROM' | translate) }\\\" placeholder=\\\"05:00 PM\\\"></ff-time> <ff-btn flex=\\\"none\\\" sense=\\\"delete\\\" size=\\\"xs\\\" ff-click=\\\"$ctrl.deleteInterval(interval)\\\" title=\\\"{{'RESERVATION_RULES.BTN_DELETE_INTERVAL.HINT' | translate}}\\\"></ff-btn> </ff-row> <ff-row ng-repeat=\\\"ghost in $ctrl.rule[$ctrl.role].$ghosts track by $index\\\"> <ff-static></ff-static> </ff-row> \";\n// Exports\nmodule.exports = code;","/**\n * Options for Reservation Rules / Reservation Buffer\n */\nexport default angular.module('deskworks.optsReservationBuffer', [])\n  .factory('optsReservationBuffer', function($rootScope, $translate, $filter) {\n    const opts = [\n      { id: 0, _name: 'GLOBAL.NONE' },  // minutes\n      { id: 15 },\n      { id: 30 },\n    ];\n\n    translate();\n    $rootScope.$on('$setTranslationsSuccess', translate);\n    function translate() { opts.forEach(opt => { opt.name = opt._name ? $translate.instant(opt._name) : $filter('minutes')(opt.id); }); }\n\n    return opts;\n  });\n","/**\n * Options for Reservation Rules / Reservation Scale\n */\nexport default angular.module('deskworks.optsReservationScale', [])\n  .factory('optsReservationScale', function($rootScope, $filter) {\n    const opts = [\n      { id: 15 }, // minutes\n      { id: 30 },\n    ];\n\n    translate();\n    $rootScope.$on('$setTranslationsSuccess', translate);\n    function translate() { opts.forEach(opt => { opt.name = $filter('minutes')(opt.id); }); }\n\n    return opts;\n  });\n"],"sourceRoot":""}