(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"/l8F":function(e,t){e.exports='<ff-panel> <ff-panel-header><span> <span translate="SH_CODES.HEADER"></span> <ff-hint><span translate="SH_CODES.HINT"></span></ff-hint> </span></ff-panel-header> <ff-row ng-repeat="code in $ctrl.shortCodes"> <ff-label flex="1 0 140px" ff-bind-html="code.id"></ff-label> <ff-static flex="1 1 350px">{{code._name | translate}}</ff-static> </ff-row> </ff-panel> '},"7GGv":function(e,t,a){"use strict";a.r(t);a("JBxO"),a("FdtR"),a("3dw1"),a("8cZI");var n=a("aJ1N"),s=a("NhWh"),r=a("lV2o"),l=a("GPfp");t.default=angular.module("deskworks.communications.emailAllMembers",[n.a.name,s.a.name,l.a.name,r.a.name,"deskworks.emailAllMembers.service"]).controller("EmailAllMembersCtrl",["$translate","dwAlerts","state","helper","emailAllMembers","taToolbarEmail",function(e,t,a,n,s,r){var l=this;a.setPageTitle(e.instant("EMAIL_MEMBERS.ALL.PAGE_TITLE")),l.toolbar=r,l.attachments=[],l.shortCodes=[{id:"{{member-name}}",_name:"SH_CODES.MEMBER_NAME"},{id:"{{first-name}}",_name:"SH_CODES.FIRST_NAME"},{id:"{{last-name}}",_name:"SH_CODES.LAST_NAME"},{id:"{{login}}",_name:"SH_CODES.LOGIN"},{id:"{{company-name}}",_name:"SH_CODES.COMPANY_NAME"}],l.fetchingTpl=!0,s.getTpl().catch((function(e){return t.error(e,"Failed to get template.")})).then((function(t){"Default subject"!==t.subject&&(l.subject=t.subject),l.body="Default body"===t.content?e.instant("EMAIL_MEMBERS.MESSAGE.ALL.DEFAULT"):t.content})).finally((function(){return l.fetchingTpl=!1})),l.send=function(a){if(!n.pointFirstInvalid("#emailAllMembers")){var r={includeNonMembers:l.includeNonMembers,subject:l.subject,body:l.body,attachments:l.attachments};return s.send(r,a).catch((function(e){return t.error(e,"Failed to email all members.")})).then((function(){t.info(a?e.instant("EMAIL_MEMBERS.TEST_SUCCESS"):e.instant("EMAIL_MEMBERS.SUCCESS"))}))}},l.viewRecipients=function(){return s.query(l.includeNonMembers).catch((function(e){return t.error(e,"Failed to query recipients.")})).then((function(e){l.recipients=e,l.recipients.forEach((function(e){e.fullName=n.join([e.firstName,e.lastName]," ")}))}))},l.save=function(){if(!n.pointFirstInvalid("#emailAllMembers")){var e={subject:l.subject,content:l.body};return s.saveTpl(e).catch((function(e){return t.error(e,"Failed to save template.")})).then((function(){return l.form.$setPristine()}))}}}])},"8/89":function(e,t){e.exports='<ff-panel ngf-drop="$ctrl.attach($files)" ngf-multiple="true" ngf-drag-over-class="dragover"> <ff-panel-header><span translate="ATTACHMENTS.HEADER"></span></ff-panel-header> <ff-row ng-repeat="att in $ctrl.attachments" ff-dim="att.$$spin"> <ff-static name="attachment"><a href="{{att.url || att.$$url}}" target="_blank" rel="noopener">{{att.fileName}}</a></ff-static> <ff-btn sense="delete" size="xs" class="buttons-row" ff-click="$ctrl.detach($index)" flex="none" title="{{\'ATTACHMENTS.BTN_DELETE.HINT\' | translate}}"></ff-btn> </ff-row> <ff-btn-group class="ff-section-buttons"> <ff-btn sense="new" size="sm" ngf-select="$ctrl.attach($files)" ngf-multiple="true"> <span translate="ATTACHMENTS.BTN_ADD"></span> </ff-btn> </ff-btn-group> </ff-panel> '},C0gS:function(e,t){e.exports='<form name="$ctrl.form" id="emailAllMembers" ng-hide="$ctrl.recipients" ff-bulk-read-only> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="gutter-v"> <ff-panel style="max-width:654px"> <ff-panel-header><span translate="EMAIL_MEMBERS.OPTIONS.HEADER"></span></ff-panel-header> <label> <ff-checkbox ff-model="$ctrl.includeNonMembers"> <span translate="EMAIL_MEMBERS.OPTIONS.INCLUDE_NON_MEMBERS"></span> </ff-checkbox> </label> </ff-panel> <ff-panel class="email-template-panel"> <ff-spin ng-if="$ctrl.fetchingTpl"></ff-spin> <ff-panel-header><span translate="EMAIL_MEMBERS.MESSAGE.HEADER"></span></ff-panel-header> <label class="ff-row"> <ff-label flex="0 0 100px"><req translate="EMAIL_MEMBERS.MESSAGE.SUBJECT"></req></ff-label> <ff-text ff-model="$ctrl.subject" ff-required="true" ff-validate-alert="{{\'EMAIL_MEMBERS.MESSAGE.SUBJECT\' | translate}}"></ff-text> </label> <ff-row> <ff-richtext ff-model="$ctrl.body" ta-toolbar="{{$ctrl.toolbar}}" class="ta-email"></ff-richtext> </ff-row> </ff-panel> <ff-btn-group> <ff-btn sense="send" ff-click="$ctrl.send(true)" title="{{\'EMAIL_MEMBERS.BTN_TEST.HINT\' | translate}}"> <span translate="EMAIL_MEMBERS.BTN_TEST"></span> </ff-btn> <ff-btn sense="send" ff-click="$ctrl.send()" title="{{\'EMAIL_MEMBERS.BTN_SEND.HINT\' | translate}}"> <span translate="EMAIL_MEMBERS.BTN_SEND"></span> </ff-btn> <ff-btn sense="search" ff-click="$ctrl.viewRecipients()"><span translate="EMAIL_MEMBERS.BTN_VIEW_RECIPIENTS"></span></ff-btn> <ff-btn sense="save" ff-click="$ctrl.save()" ff-disabled="$ctrl.form.$pristine"><span translate="EMAIL_MEMBERS.BTN_SAVE_TEMPLATE"></span></ff-btn> </ff-btn-group> <div class="ff-grid gutter-v gutter-h" style="margin-bottom:0"> <div flex="{md: \'0 0 50%\'}" short-codes="$ctrl.shortCodes"></div> <div flex="{md: \'0 0 50%\'}" attachments="$ctrl.attachments" form="$ctrl.form"></div> </div> </div> </form> <div ng-if="$ctrl.recipients"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="gutter-v"> <ff-btn-group ng-if="$ctrl.recipients.length > 10"> <ff-btn sense="back" ff-click="$ctrl.recipients = null"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> <ff-panel> <ff-panel-header> <span translate="EMAIL_MEMBERS.RECIPIENTS.HEADER" translate-values="{ count: $ctrl.recipients.length }"></span> </ff-panel-header> <ff-header ng-show="$ctrl.recipients.length > 0"> <ff-row> <cell><span translate="EMAIL_MEMBERS.RECIPIENTS.COMPANY"></span></cell> <cell><span translate="EMAIL_MEMBERS.RECIPIENTS.NAME"></span></cell> <cell><span translate="EMAIL_MEMBERS.RECIPIENTS.EMAIL"></span></cell> </ff-row> </ff-header> <ff-row ng-repeat="rcpt in $ctrl.recipients"> <ff-static ff-bind="::rcpt.company"></ff-static> <ff-static ff-bind="::rcpt.fullName"></ff-static> <ff-static><a href="mailto:{{::rcpt.email}}" target="_blank" rel="noopener" ng-bind="::rcpt.email"></a></ff-static> </ff-row> </ff-panel> <ff-btn-group> <ff-btn sense="back" ff-click="$ctrl.recipients = null"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> </div> </div> '},CRxJ:function(e,t){e.exports='<form name="$ctrl.form" id="emailSiteMembers" ng-hide="$ctrl.recipients" ff-bulk-read-only> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="gutter-v"> <ff-panel style="max-width:654px"> <ff-panel-header><span translate="EMAIL_MEMBERS.OPTIONS.HEADER"></span></ff-panel-header> <div class="ff-grid gutter-v-half"> <div> <ff-row> <label flex="none"><ff-include-all flex="0 0 30px" items="$ctrl.membershipCategories" default="true"></ff-include-all></label> </ff-row> <ff-header> <ff-row> <span flex="0 0 32px" class="ff-center" title="{{\'GLOBAL.INCLUDE\' | translate}}"><ff-icon sense="check"></ff-icon></span> <cell><span translate="EMAIL_MEMBERS.OPTIONS.MEMBERSHIP_CATEGORY"></span></cell> </ff-row> </ff-header> <label class="ff-row" ng-repeat="membType in $ctrl.membershipCategories"> <ff-static flex="0 0 32px" class="ff-center"><ff-checkbox ff-model="membType.include"></ff-checkbox></ff-static> <ff-static>{{::membType.name}}</ff-static> </label> </div> <ff-static class="ff-no-frame"><ff-static> <label> <ff-checkbox ff-model="$ctrl.checkedInOnly"> <span translate="EMAIL_MEMBERS.OPTIONS.ONLY_CHECKED_IN"></span> </ff-checkbox> </label> </ff-static></ff-static> </div> </ff-panel> <ff-panel class="email-template-panel"> <ff-spin ng-if="$ctrl.fetchingTpl"></ff-spin> <ff-panel-header><span translate="EMAIL_MEMBERS.MESSAGE.HEADER"></span></ff-panel-header> <label class="ff-row"> <ff-label flex="0 0 100px"><req translate="EMAIL_MEMBERS.MESSAGE.SUBJECT"></req></ff-label> <ff-text ff-model="$ctrl.subject" ff-required="true" ff-validate-alert="{{\'EMAIL_MEMBERS.MESSAGE.SUBJECT\' | translate}}"></ff-text> </label> <ff-row> <ff-richtext ff-model="$ctrl.body" ta-toolbar="{{$ctrl.toolbar}}" class="ta-email"></ff-richtext> </ff-row> </ff-panel> <ff-btn-group> <ff-btn sense="send" ff-click="$ctrl.send(true)" title="{{\'EMAIL_MEMBERS.BTN_TEST.HINT\' | translate}}"> <span translate="EMAIL_MEMBERS.BTN_TEST"></span> </ff-btn> <ff-btn sense="send" ff-click="$ctrl.send()" title="{{\'EMAIL_MEMBERS.BTN_SEND.HINT\' | translate}}"> <span translate="EMAIL_MEMBERS.BTN_SEND"></span> </ff-btn> <ff-btn sense="search" ff-click="$ctrl.viewRecipients()"><span translate="EMAIL_MEMBERS.BTN_VIEW_RECIPIENTS"></span></ff-btn> <ff-btn sense="save" ff-click="$ctrl.save()" ff-disabled="$ctrl.form.$pristine"><span translate="EMAIL_MEMBERS.BTN_SAVE_TEMPLATE"></span></ff-btn> </ff-btn-group> <div class="ff-grid gutter-v gutter-h" style="margin-bottom:0"> <div flex="{md: \'0 0 50%\'}" short-codes="$ctrl.shortCodes"></div> <div flex="{md: \'0 0 50%\'}" attachments="$ctrl.attachments" form="$ctrl.form"></div> </div> </div> </form> <div ng-if="$ctrl.recipients"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="gutter-v"> <ff-btn-group ng-if="$ctrl.recipients.length > 10"> <ff-btn sense="back" ff-click="$ctrl.recipients = null"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> <ff-panel> <ff-panel-header> <span translate="EMAIL_MEMBERS.RECIPIENTS.HEADER" translate-values="{ count: $ctrl.recipients.length }"></span> </ff-panel-header> <ff-header ng-show="$ctrl.recipients.length > 0"> <ff-row> <cell><span translate="EMAIL_MEMBERS.RECIPIENTS.COMPANY"></span></cell> <cell><span translate="EMAIL_MEMBERS.RECIPIENTS.NAME"></span></cell> <cell><span translate="EMAIL_MEMBERS.RECIPIENTS.EMAIL"></span></cell> </ff-row> </ff-header> <ff-row ng-repeat="rcpt in $ctrl.recipients"> <ff-static ff-bind="::rcpt.company"></ff-static> <ff-static ff-bind="::rcpt.fullName"></ff-static> <ff-static><a href="mailto:{{::rcpt.email}}" target="_blank" rel="noopener" ng-bind="::rcpt.email"></a></ff-static> </ff-row> </ff-panel> <ff-btn-group> <ff-btn sense="back" ff-click="$ctrl.recipients = null"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> </div> </div> '},CZgw:function(e,t,a){"use strict";a.r(t);a("3dw1"),a("Muwe"),a("y89P");var n=a("yCd9"),s=a.n(n),r=a("lRNC"),l=a.n(r),f=["$injector",function(e){var t,n,r=(t=a("XDdL"),s()(n=l()(t).call(t)).call(n,t));e.loadNewModules(s()(r).call(r,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var t=a("gZPn");l()(t).call(t).forEach((function(a){return e.put(a.replace(/^\.\//,""),t(a))}))}])}];t.default=f},GPfp:function(e,t,a){"use strict";a("3dw1");var n=a("6RpP"),s=a.n(n),r=a("0zKI"),l=a.n(r),f=a("8/89"),i=a.n(f),c=a("yCd9"),o=a.n(c),m=angular.module("deskworks.getAttachments.service",[]).factory("getAttachments",["$q","$timeout",function(e,t){return function(a){return e.all(o()(a).call(a,(function(a){return e((function(e){var n=new FileReader;n.onload=function(n){return t((function(){return e({fileName:a.name,fileData:n.target.result})}))},n.readAsDataURL(a)}))})))}}]);t.a=angular.module("deskworks.attachments",[m.name]).directive("attachments",(function(){return{template:i.a,restrict:"EAC",scope:!0,controller:"AttachmentsCtrl as $ctrl",bindToController:{attachments:"=",form:"<?",attacher:"<?",detacher:"<?"}}})).controller("AttachmentsCtrl",["$window","dwAlerts","getAttachments",function(e,t,a){var n=this;n.attach=function(r){return a(r).then((function(a){var f;n.attachments=s()(f=n.attachments).call(f,a),n.attacher?a.forEach((function(e,a){e.$$spin=!0,n.attacher(e).then((function(t){e.$$spin=!1,e.id=t.id,e.url=t.url,delete e.fileData})).catch((function(a){var s;return l()(s=n.attachments).call(s,n.attachments.indexOf(e),1),t.error(a,"Failed to attach file.")}))})):(a.forEach((function(t,a){t.$$url=e.URL.createObjectURL(r[a])})),n.form&&n.form.$setDirty())}))},n.detach=function(a){if(n.detacher){var s=n.attachments[a];return n.detacher(s).then((function(){var e;l()(e=n.attachments).call(e,n.attachments.indexOf(s),1)})).catch((function(e){return t.error(e,"Failed to detach file.")}))}var r;e.URL.revokeObjectURL(n.attachments[a].$$url),l()(r=n.attachments).call(r,a,1),n.form&&n.form.$setDirty()},n.$onDestroy=function(){n.attachments.forEach((function(t){return e.URL.revokeObjectURL(t.$$url)}))}}])},GwHj:function(e,t){e.exports='<div class="message-board" ff-bulk-read-only> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-panel class="ff-bmargin"> <ff-col class="msg-sticky"> <ff-header class="msg-post-header"> <span translate="MESSAGE_BOARD.POST_MESSAGE.HEADER" ng-if="!$ctrl.message.id"></span> <span ng-if="$ctrl.message.id"> <span translate="MESSAGE_BOARD.EDIT_MESSAGE.HEADER"></span> <strong>{{$ctrl.message.author.fullName || \'anonymous\'}}</strong> at <span nice-time="$ctrl.message.createdAt"></span> on <span>{{$ctrl.message.createdAt | date: \'mediumDate\'}}</span> </span> </ff-header> <form name="$ctrl.form" class="ff-row msg-post"> <ff-textarea name="text" ff-model="$ctrl.message.text" placeholder="{{\'MESSAGE_BOARD.POST_MESSAGE.PLACEHOLDER\' | translate}}" counter="{{$ctrl.message.text.length}}/{{::$ctrl.messageMaxLength}}" ng-keypress="$ctrl.keypress($event)"></ff-textarea> <div ff-dim="$ctrl.posting" class="msg-buttons" flex="none"> <ff-btn type="submit" sense="ok" size="xs" ff-click="$ctrl.post()" title="{{\'MESSAGE_BOARD.POST_MESSAGE.BTN_POST\' | translate}}" ff-disabled="!$ctrl.message.text"></ff-btn> <ff-btn sense="cancel" size="xs" title="{{\'GLOBAL.BTN_CANCEL\' | translate}}" ff-click="$ctrl.message = {}" ng-if="$ctrl.message.id"></ff-btn> </div> </form> <ff-header class="msg-messages-header" translate="MESSAGE_BOARD.MESSAGES.HEADER"></ff-header> </ff-col> <div class="msg-scroller" infinite-scroll="$ctrl.fetch()" infinite-scroll-distance="2" infinite-scroll-container="\'.snap-content-scroller\'"> <ff-row ng-repeat="msg in $ctrl.messages" class="msg-container animate-collapse" ng-class="{ active: msg.id === $ctrl.message.id }"> <div class="msg-ava"> <ff-img ff-src="{{::msg.author.photo}}" ng-if="::msg.author.photo" ff-alt="{{::msg.author.fullName || \'anonymous\'}}"></ff-img> <i class="fa fa-user" ng-if="::!msg.author.photo"></i> </div> <div> <div> <div class="msg-meta"> <span class="msg-name">{{::msg.author.fullName || \'anonymous\'}}</span> <span class="msg-time" nice-time="::msg.createdAt"></span> <span class="msg-date">{{::msg.createdAt | date: \'mediumDate\'}}</span> </div> <div class="msg-body">{{msg.text}}</div> </div> </div> <ff-btn-group class="floating-toolbar" ng-if="::state.isLoggedAdmin()"> <ff-row> <ff-btn sense="edit" size="xs" class="ff-btn-icon" ff-click="$ctrl.edit(msg)" title="{{\'GLOBAL.BTN_EDIT\' | translate}}"></ff-btn> <ff-btn sense="delete" size="xs" class="ff-btn-icon" ff-click="$ctrl.delete(msg)" title="{{\'GLOBAL.BTN_DELETE\' | translate}}"></ff-btn> </ff-row> </ff-btn-group> </ff-row> <div class="ff-spin ff-spin-placeholder" ng-if="$ctrl.fetching"></div> </div> <ff-label ng-if="!$ctrl.messages.length && !$ctrl.fetching" class="ff-no-frame"> <span translate="GLOBAL.NONE"></span> </ff-label> </ff-panel> </div> '},LIyd:function(e,t,a){"use strict";a.r(t);var n=a("aJ1N"),s=a("lV2o");t.default=angular.module("deskworks.SplashPageCtrl",[n.a.name,s.a.name,"deskworks.SplashPage"]).controller("SplashPageCtrl",["$translate","dwAlerts","state","helper","center","splashPage","SplashPage","taToolbarEmail",function(e,t,a,n,s,r,l,f){var i=this;a.setPageTitle(e.instant("SPLASH_PAGE.PAGE_TITLE",{centerName:s.name})),i.sp=r,i.toolbar=f,i.save=function(){if(!n.pointFirstInvalid("#splashPage"))return l.save(a.getCurrentCenterId(),i.sp).catch((function(e){return t.error(e,"Failed to save splash page settings.")})).then((function(){i.form.$setPristine()}))}}])},NhWh:function(e,t,a){"use strict";a("z6HB");var n=a("/l8F"),s=a.n(n);t.a=angular.module("deskworks.shortCodes",[]).directive("shortCodes",(function(){return{template:s.a,restrict:"EAC",scope:!0,controller:"ShortCodesCtrl as $ctrl",bindToController:{shortCodes:"<"}}})).controller("ShortCodesCtrl",(function(){}))},PVke:function(e,t,a){},Vzov:function(e,t,a){},XDdL:function(e,t,a){var n={"./email-all-members/email-all-members.controller.js":"7GGv","./email-site-members/email-site-members.controller.js":"lT5k","./message-board/message-board.controller.js":"Xwkr","./splash-page/splash-page.controller.js":"LIyd"};function s(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=r,e.exports=s,s.id="XDdL"},Xwkr:function(e,t,a){"use strict";a.r(t);a("JBxO"),a("FdtR");var n=a("nbuU"),s=a.n(n),r=a("NOor"),l=a.n(r),f=a("0zKI"),i=a.n(f),c=a("6RpP"),o=a.n(c),m=(a("PVke"),a("+l1P"));t.default=angular.module("deskworks.MessageBoardCtrl",["NATS","infinite-scroll","deskworks.MessageBoard",m.a.name]).controller("MessageBoardCtrl",["$scope","$translate","$window","$timeout","dwAlerts","state","helper","MessageBoard","NATS",function(e,t,a,n,r,f,c,m,d){var u=this;f.setPageTitle(t.instant("MESSAGE_BOARD.PAGE_TITLE")),u.messageMaxLength=1e3,u.message={},u.messages=[],u.params={centerId:f.getCurrentCenterId(),offset:0,limit:100};var p=[];function E(e){e=m.deserialize(e);var t=s()(c).call(c,u.messages,e.id);if(t)return angular.extend(t,e);u.messages.unshift(e)}function g(e){var t=s()(c).call(c,u.messages,e.id);if(t)return angular.extend(t,e)}function h(e){var t,a=l()(c).call(c,u.messages,e.id);a>=0&&i()(t=u.messages).call(t,a,1)}n((function(){u.nats=d.connect(),u.nats.on("error",(function(e){console.warn("NATS error:",e)})),e.$on("$destroy",(function(){p.forEach((function(e){u.nats.unsubscribe(e)})),u.nats.close()})),c.focus(".message-board .msg-post textarea"),u.fetch()})),u.fetch=function(){if(u.eof||u.fetching)return u.fetching;u.fetching=m.query(u.params).catch((function(e){return r.error(e,"Failed to query messages.")})).finally((function(){u.fetching=null})).then((function(e){var t;u.messages=o()(t=u.messages).call(t,e),u.params.offset=u.messages.length,u.eof=e.length<u.params.limit,p.length||(p.push(u.nats.subscribe("API.:siteId.centers.:centerId.message-board.messages.create",E)),p.push(u.nats.subscribe("API.:siteId.centers.:centerId.message-board.messages.update",g)),p.push(u.nats.subscribe("API.:siteId.centers.:centerId.message-board.messages.delete",h)))}))},u.post=function(){!u.posting&&u.message.text&&(u.message.centerId=u.message.centerId||f.getCurrentCenterId(),u.posting=!0,m.save(u.message).catch((function(e){return r.error(e,"Failed to save message.")})).then((function(){u.message={}})).finally((function(){u.posting=!1})))},u.keypress=function(e){13!==e.which||e.shiftKey||(e.preventDefault(),u.post())},u.edit=function(e){u.message=angular.copy(e),c.focus(".msg-post textarea")},u.delete=function(e){if(a.confirm(t.instant("MESSAGE_BOARD.MESSAGES.CONFIRM_DELETE")))return u.message.id===e.id&&(u.message={}),m.delete(e.id).catch((function(e){return r.error(e,"Failed to delete message.")}))}}])},aJ1N:function(e,t,a){"use strict";a("T7M0"),a("0rqx"),a("Vzov");t.a=angular.module("ffRichtext",["textAngular"]).directive("ffRichtext",["ffHelper",function(e){return{restrict:"E",scope:!0,compile:function(t,a){var n=angular.element("<text-angular></text-angular>");return e.copyInnerAttrs(t,a,n),t.append(n),this.link},link:function(e,t,a){var n=angular.element(t[0].querySelector("[contenteditable]"));e.$watch("ffBlock.editMode",(function(e){angular.isUndefined(e)||(t.toggleClass("ff-read-only",!e),n.attr("contenteditable",e))}))}}}])},gZPn:function(e,t,a){var n={"./email-all-members/email-all-members.tpl.html":"C0gS","./email-site-members/email-site-members.tpl.html":"CRxJ","./message-board/message-board.tpl.html":"GwHj","./splash-page/splash-page.tpl.html":"h8Oe"};function s(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=r,e.exports=s,s.id="gZPn"},h8Oe:function(e,t){e.exports='<form name="$ctrl.form" id="splashPage" ff-bulk-read-only> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="gutter-v"> <ff-panel style="max-width:654px"> <ff-row style="margin-bottom:1rem"> <label flex="none"> <ff-checkbox name="enabled" ff-model="$ctrl.sp.enabled"> <span translate="SPLASH_PAGE.ENABLED"></span> </ff-checkbox> </label> <ff-hint flex="0 0 15px" style="align-self:center;margin-left:auto"> <span translate="SPLASH_PAGE.HINT"></span> </ff-hint> </ff-row> <ff-row> <ff-richtext ff-model="$ctrl.sp.body" ta-toolbar="{{$ctrl.toolbar}}" class="ta-html"></ff-richtext> </ff-row> </ff-panel> <ff-btn-group> <ff-btn sense="save" ff-click="$ctrl.save()" ff-disabled="$ctrl.form.$pristine"> <span translate="GLOBAL.BTN_SAVE"></span> </ff-btn> </ff-btn-group> </div> </form> '},lT5k:function(e,t,a){"use strict";a.r(t);var n=a("yCd9"),s=a.n(n),r=a("hsT8"),l=a.n(r),f=(a("JBxO"),a("FdtR"),a("3dw1"),a("8cZI"),a("aJ1N")),i=a("NhWh"),c=a("lV2o"),o=a("GPfp");t.default=angular.module("deskworks.communications.emailSiteMembers",[f.a.name,i.a.name,o.a.name,c.a.name,"deskworks.emailSiteMembers.service"]).controller("EmailSiteMembersCtrl",["$translate","dwAlerts","state","helper","emailSiteMembers","membershipCategories","center","taToolbarEmail",function(e,t,a,n,r,f,i,c){var o=this;a.setPageTitle(e.instant("EMAIL_MEMBERS.SITE.PAGE_TITLE",{centerName:i.name})),o.toolbar=c,o.membershipCategories=f,o.membershipCategory=o.membershipCategories[0],o.attachments=[],o.shortCodes=[{id:"{{center-name}}",_name:"SH_CODES.CENTER_NAME"},{id:"{{member-name}}",_name:"SH_CODES.MEMBER_NAME"},{id:"{{first-name}}",_name:"SH_CODES.FIRST_NAME"},{id:"{{last-name}}",_name:"SH_CODES.LAST_NAME"},{id:"{{login}}",_name:"SH_CODES.LOGIN"},{id:"{{company-name}}",_name:"SH_CODES.COMPANY_NAME"}],o.fetchingTpl=!0,r.getTpl().catch((function(e){return t.error(e,"Failed to get template.")})).then((function(t){"Default subject"!==t.subject&&(o.subject=t.subject),"Default body"!==t.content&&(o.body=t.content),o.body="Default body"===t.content?e.instant("EMAIL_MEMBERS.MESSAGE.SITE.DEFAULT"):t.content})).finally((function(){return o.fetchingTpl=!1})),o.send=function(s){if(!n.pointFirstInvalid("#emailSiteMembers")){var l={membershipTypeIds:o.getSelectedMembershipIds(),subject:o.subject,body:o.body,attachments:o.attachments,checkedInOnly:o.checkedInOnly};return r.send(a.getCurrentCenterId(),l,s).catch((function(e){return t.error(e,"Failed to email site members.")})).then((function(){t.info(s?e.instant("EMAIL_MEMBERS.TEST_SUCCESS"):e.instant("EMAIL_MEMBERS.SUCCESS"))}))}},o.viewRecipients=function(){return r.query(a.getCurrentCenterId(),o.getSelectedMembershipIds(),o.checkedInOnly).catch((function(e){return t.error(e,"Failed to query recipients.")})).then((function(e){o.recipients=e,o.recipients.forEach((function(e){e.fullName=n.join([e.firstName,e.lastName]," ")}))}))},o.save=function(){if(!n.pointFirstInvalid("#emailSiteMembers")){var e={subject:o.subject,content:o.body};return r.saveTpl(e).catch((function(e){return t.error(e,"Failed to save template.")})).then((function(){return o.form.$setPristine()}))}},o.getSelectedMembershipIds=function(){var e,t;return s()(e=l()(t=o.membershipCategories).call(t,(function(e){return e.include}))).call(e,(function(e){return e.id}))}}])},lV2o:function(e,t,a){"use strict";t.a=angular.module("deskworks.taToolbarEmail",[]).factory("taToolbarEmail",(function(){return[["h1","h2","h3","h4","p","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],["justifyLeft","justifyCenter","justifyRight"],["html","insertImage","insertLink","wordcount","charcount"]]}))},z6HB:function(e,t,a){}}]);