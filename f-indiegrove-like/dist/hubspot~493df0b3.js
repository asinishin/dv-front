(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"+pZ8":function(e,t,r){"use strict";r.r(t);var n=r("03wM"),o=r.n(n),s=r("Ekwr"),a=r.n(s),l=r("hsT8"),i=r.n(l),c=r("lvz6"),f=r.n(c),p=r("yKah"),u=r.n(p),d=r("fzuT"),g=r.n(d),m=r("NOor"),b=r.n(m),h=r("nbuU"),S=r.n(h),v=r("Z9wY"),E=r.n(v),T=r("0zKI"),A=r.n(T),P=(r("3dw1"),r("9l1V"));function I(e,t){var r=o()(e);if(a.a){var n=a()(e);t&&(n=i()(n).call(n,(function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){g()(e,t,r[t])})):u.a?Object.defineProperties(e,u()(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,f()(r,t))}))}return e}t.default=angular.module("deskworks.hubspotDocumentsDirective",["debounce","deskworks.upDocuments",P.default.name]).controller("upDocumentsCtrl",["$scope","$element","$q","$translate","dwAlerts","helper","state","session","userProfileService","HubSpotDocument",function(e,t,r,n,o,s,a,l,i,c){var f=this;f.$onInit=function(){l.isAdmin()&&(f.showUserAccess=!0),e.$on("ffBlock::EditStart",(function(){f.docsRollback=angular.copy(f.user.documents)})),e.$on("ffBlock::EditCancel",(function(){f.user.documents=f.docsRollback})),s.isUid(f.user.id)||c.query({userId:f.user.id}).catch((function(e){return o.error(e,"Failed to query HubSpot documents")})).then((function(e){e.forEach((function(e){var t;e.userAccess=!0,e.id+="-hs";var r=b()(t=f.user.documents).call(t,(function(t){return t.id===e.id}));r>0?f.user.documents[r]=e:f.user.documents.push(e)}))}))},f.add=function(r,s){if(s&&s.length>0)return o.error(n.instant("USER_PROFILE.DOCUMENTS.INVALID_FORMAT"));r&&r.length>0&&(f.editMode||e.$broadcast("ffBlock::EditStart"),r.forEach((function(e){return f.user.documents.push(i.document.new(e))})),angular.element(t[0].querySelector('form[name="ffBlockForm"]')).scope().ffBlockForm.$setDirty())},f.save=function(){var e=[];return f.user.documents.forEach((function(t){var r,n=S()(s).call(s,f.docsRollback,t.id);n&&n.name===t.name&&n.userAccess===t.userAccess||(E()(r=""+t.id).call(r,"-hs")?(t=$($({},t),{},{id:parseInt(t.id)}),e.push(c.update({id:t.id,userId:f.user.id},t).catch((function(e){return o.error(e,"Failed to save HubSpot document.")})))):e.push(i.document.save(a.getCurrentCenterId(),f.user.id,t).catch((function(e){return o.error(e,"Failed to save document.")}))))})),f.docsRollback.forEach((function(t){var r;S()(s).call(s,f.user.documents,t.id)||(E()(r=""+t.id).call(r,"-hs")?e.push(c.delete({id:parseInt(t.id),userId:f.user.id}).catch((function(e){return o.error(e,"Failed to delete HubSpot document.")}))):e.push(i.document.delete(a.getCurrentCenterId(),f.user.id,t).catch((function(e){return o.error(e,"Failed to delete document.")}))))})),r.all(e)},f.delete=function(e){var r,n=b()(s).call(s,f.user.documents,e.id);n>=0&&(A()(r=f.user.documents).call(r,n,1),angular.element(t[0].querySelector('form[name="ffBlockForm"]')).scope().ffBlockForm.$setDirty())}}])},"/o5W":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.HubSpotProposalItem",["ngResource","deskworks.config"]).factory("HubSpotProposalItem",["$resource","$location","deskworksConfig",function(e,t,r){var n=e(r.getApiAbsUrl("/hubspot/proposals/:proposalId/items/:id"));return{query:function(e){return n.query(e).$promise},save:function(e,t){return n.save(e,t).$promise},delete:function(e){return n.delete(e).$promise}}}])},"2PlZ":function(e,t){e.exports='<h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-panel> <div class="ff-grid"> <ff-spin class="ff-spin-placeholder" ng-if="$ctrl.spin"></ff-spin> <span ng-if="!$ctrl.spin && !$ctrl.proposals.length" translate="GLOBAL.NONE"></span> <ff-header ng-if="$ctrl.proposals.length"> <ff-row> <cell flex="0 0 105px"><span translate="GLOBAL.DATE"></span></cell> <cell flex="1 1 200px"><span translate="PROPOSALS.STAGE"></span></cell> <cell flex="1 1 400px"><span translate="GLOBAL.NAME"></span></cell> <ff-btn sense="edit" size="xs" flex="none" class="buttons-row zero-height" title="{{\'GLOBAL.BTN_EDIT\' | translate }}"></ff-btn> </ff-row> </ff-header> <ff-row ng-repeat="p in $ctrl.proposals"> <ff-static flex="0 0 105px">{{::p.createdAt | date:\'mediumDate\'}}</ff-static> <ff-static flex="1 1 200px">{{::p.stage}}</ff-static> <ff-static flex="1 1 400px">{{::p.name}}</ff-static> <ff-btn sense="edit" size="xs" flex="none" class="buttons-row" title="{{\'GLOBAL.BTN_EDIT\' | translate}}" ff-click="$ctrl.edit(p)"></ff-btn> </ff-row> </div> </ff-panel> '},"7pZ+":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.ProposalItemCatalog",["ngResource","deskworks.config"]).factory("ProposalItemCatalog",["$resource","$location","deskworksConfig",function(e,t,r){var n=e(r.getApiAbsUrl("/hubspot/item-catalog"));return{query:function(e){return n.query(e).$promise}}}])},"9l1V":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.HubSpotDocument",["ngResource","deskworks.config"]).factory("HubSpotDocument",["$resource","deskworksConfig",function(e,t){var r=e(t.getApiAbsUrl("/hubspot/documents/:id"),{},{update:{method:"PUT"}});return{query:function(e){var t=e.userId;return r.query({userId:t}).$promise},update:function(e,t){var n=e.id,o=e.userId;return r.update({id:n,userId:o},t).$promise},delete:function(e){var t=e.id,n=e.userId;return r.delete({id:t,userId:n}).$promise}}}])},E9Xa:function(e,t){e.exports='<h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-panel> <ff-spin class="ff-spin-placeholder" ng-if="$ctrl.spin"></ff-spin> <div class="ff-grid dw-invoice" ng-if="$ctrl.proposal"> <ff-header> <ff-row> <cell flex="0 0 105px"><span translate="GLOBAL.DATE"></span></cell> <cell flex="1 1 100px"><span translate="PROPOSALS.STAGE"></span></cell> <cell flex="5 1 200px"><span translate="GLOBAL.NAME"></span></cell> </ff-row> </ff-header> <ff-row> <ff-static flex="0 0 105px">{{::$ctrl.proposal.createdAt | date:\'mediumDate\'}}</ff-static> <ff-static flex="1 1 100px">{{::$ctrl.proposal.stage}}</ff-static> <ff-static flex="5 1 200px">{{::$ctrl.proposal.name}}</ff-static> </ff-row> <ff-header style="margin-top:.5rem"> <ff-row> <cell flex="4 0 70px" class="invoice-product"><span translate="PURCHASE.INVOICE.PRODUCT"></span></cell> <cell flex="8 1 100px" class="invoice-description show-md"><span translate="PURCHASE.INVOICE.DESCRIPTION"></span></cell> <cell flex="0 0 46px" class="invoice-quantity ff-center show-sm"><span translate="PURCHASE.INVOICE.QUANTITY"></span></cell> <cell flex="0 0 90px" class="invoice-price ff-right show-sm"><span translate="PURCHASE.INVOICE.PRICE"></span></cell> <cell flex="0 0 90px" class="invoice-amount ff-right"><span translate="PURCHASE.INVOICE.AMOUNT"></span></cell> <ff-btn-group flex="0 0 auto" class="buttons-row zero-height"> <ff-btn sense="remove" size="xs"></ff-btn> </ff-btn-group> </ff-row> </ff-header> <ff-static ng-if="!$ctrl.items.length"><span translate="GLOBAL.NONE"></span></ff-static> <ff-row ng-repeat="item in $ctrl.items"> <ff-static flex="4 0 70px" class="invoice-product" ff-bind="::item.productName"></ff-static> <ff-static flex="8 1 100px" class="invoice-description show-md" ff-bind="::item.description"></ff-static> <ff-static flex="0 0 46px" class="invoice-quantity ff-center show-sm" ff-bind="::item.quantity | round"></ff-static> <ff-static flex="0 0 90px" class="invoice-price ff-right show-sm" ff-bind="::item.price | ncurrency"></ff-static> <ff-static flex="0 0 90px" class="invoice-amount ff-right" ff-bind="::item.amount | ncurrency"></ff-static> <ff-btn-group flex="0 0 auto" class="buttons-row"> <ff-btn sense="remove" size="xs" title="{{\'GLOBAL.BTN_DELETE\' | translate}}" ff-click="$ctrl.deleteItem(item)"></ff-btn> </ff-btn-group> </ff-row> <ff-row class="invoice-charges" ng-if="$ctrl.items.length"> <ff-label class="ff-right"><span translate="GLOBAL.TOTAL"></span></ff-label> <ff-static flex="0 0 90px" class="ff-right">{{$ctrl.getTotal() | ncurrency}}</ff-static> <ff-btn-group flex="0 0 auto" class="buttons-row zero-height"> <ff-btn sense="remove" size="xs"></ff-btn> </ff-btn-group> </ff-row> </div> </ff-panel> <hubspot-proposal-add-items proposal="$ctrl.proposal" items="$ctrl.items" catalog="$ctrl.catalog"></hubspot-proposal-add-items> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="$ctrl.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> '},HAlh:function(e,t,r){"use strict";r.r(t);r("8cZI");t.default=angular.module("deskworks.HubSpotSettings",["ngResource","deskworks.config"]).factory("HubSpotSettings",["$resource","$location","deskworksConfig",function(e,t,r){var n=e(r.getApiAbsUrl("/hubspot/settings"),{},{update:{method:"PUT"}}),o=e(r.getApiAbsUrl("/hubspot/oauth2"));return{get:function(){return n.get().$promise},save:function(e){return n.update({},e).$promise},getConnectUrl:function(e){return r.getApiAbsUrl(["/hubspot/oauth2?nonce=".concat(e),"redirectUri="+encodeURIComponent(t.absUrl())].join("&"))},disconnect:function(){return o.delete().$promise}}}])},JAQx:function(e,t,r){var n=r("xmAi");e.exports=n},Jou3:function(e,t){e.exports='<ff-panel> <ff-panel-header class="ff-spin-right"> <span translate="INTEGRATIONS_SETUP.HUBSPOT.HEADER"></span> </ff-panel-header> <form name="form" novalidate ff-dim="$ctrl.spin"> <label class="ff-row"> <ff-label flex="0 1 160px"><span translate="INTEGRATIONS_SETUP.HUBSPOT.CONNECTION"></span></ff-label> <ff-static ng-if="!$ctrl.hubspotSettings.connected"> <a href="{{$ctrl.getConnectUrl()}}" target="_self" rel="noopener" ng-if="$ctrl.hubspotSettings"> <ff-btn sense="ok" size="sm"><span translate="INTEGRATIONS_SETUP.CONNECT"></span></ff-btn> </a> </ff-static> <ff-static ng-if="$ctrl.hubspotSettings.connected"> <ff-icon sense="check"></ff-icon>&nbsp;<span translate="INTEGRATIONS_SETUP.CONNECTED"></span> </ff-static> <ff-btn-group flex="none" class="buttons-row" ng-if="$ctrl.hubspotSettings.connected"> <ff-btn sense="delete" size="xs" ff-click="$ctrl.disconnect()" title="{{\'INTEGRATIONS_SETUP.DISCONNECT\' | translate}}"></ff-btn> </ff-btn-group> </label> <div ng-if="$ctrl.hubspotSettings.connected"> <ff-header style="margin-top:.5rem"><span translate="INTEGRATIONS_SETUP.HUBSPOT.GENERAL.HEADER"></span></ff-header> <label class="ff-row"> <ff-label flex="0 1 160px"><req translate="INTEGRATIONS_SETUP.HUBSPOT.GENERAL.LOCATION"></req></ff-label> <ff-select name="location" ff-model="$ctrl.hubspotSettings.mapping.location" ff-change="$ctrl.saveSettings(form)" ff-required="true" ff-validate-alert="{{\'INTEGRATIONS_SETUP.HUBSPOT.GENERAL.LOCATION\' | translate}}"> <option ng-repeat="prop in $ctrl.contactProps" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 160px"><req translate="INTEGRATIONS_SETUP.HUBSPOT.GENERAL.DEAL_STAGE_PROPOSAL"></req></ff-label> <ff-select name="dealStageProposal" ff-model="$ctrl.hubspotSettings.mapping.dealStageProposal" ff-change="$ctrl.saveSettings(form)" ff-required="true" ff-validate-alert="{{\'INTEGRATIONS_SETUP.HUBSPOT.GENERAL.DEAL_STAGE_PROPOSAL\' | translate}}"> <option ng-repeat="prop in $ctrl.dealStages" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 160px"><req translate="INTEGRATIONS_SETUP.HUBSPOT.GENERAL.DEAL_STAGE_WON"></req></ff-label> <ff-select name="dealStageWon" ff-model="$ctrl.hubspotSettings.mapping.dealStageWon" ff-change="$ctrl.saveSettings(form)" ff-required="true" ff-validate-alert="{{\'INTEGRATIONS_SETUP.HUBSPOT.GENERAL.DEAL_STAGE_WON\' | translate}}"> <option ng-repeat="prop in $ctrl.dealStages" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> <ff-header style="margin-top:.5rem"><span translate="INTEGRATIONS_SETUP.HUBSPOT.RB.HEADER"></span></ff-header> <label class="ff-row"> <ff-label flex="0 1 160px"><span translate="INTEGRATIONS_SETUP.HUBSPOT.RB.START_DATE"></span></ff-label> <ff-select name="startDate" ff-model="$ctrl.hubspotSettings.mapping.startDate" ff-change="$ctrl.saveSettings(form)"> <option ng-value="null">-</option> <option ng-repeat="prop in $ctrl.dealProps" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 160px"><span translate="INTEGRATIONS_SETUP.HUBSPOT.RB.RENEWAL_DATE"></span></ff-label> <ff-select name="renewalDate" ff-model="$ctrl.hubspotSettings.mapping.renewalDate" ff-change="$ctrl.saveSettings(form)"> <option ng-value="null">-</option> <option ng-repeat="prop in $ctrl.dealProps" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 160px"><span translate="INTEGRATIONS_SETUP.HUBSPOT.RB.RENEWAL_TERM"></span></ff-label> <ff-select name="renewalTerm" ff-model="$ctrl.hubspotSettings.mapping.renewalTerm" ff-change="$ctrl.saveSettings(form)"> <option ng-value="null">-</option> <option ng-repeat="prop in $ctrl.dealProps" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 160px"><span translate="INTEGRATIONS_SETUP.HUBSPOT.RB.NOTICE_PERIOD"></span></ff-label> <ff-select name="noticePeriod" ff-model="$ctrl.hubspotSettings.mapping.noticePeriod" ff-change="$ctrl.saveSettings(form)"> <option ng-value="null">-</option> <option ng-repeat="prop in $ctrl.dealProps" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 160px"><span translate="INTEGRATIONS_SETUP.HUBSPOT.RB.DISCOUNT"></span></ff-label> <ff-select name="discountAmount" ff-model="$ctrl.hubspotSettings.mapping.discountAmount" ff-change="$ctrl.saveSettings(form)"> <option ng-value="null">-</option> <option ng-repeat="prop in $ctrl.dealProps" ng-value="::prop.id">{{::prop.name}}</option> </ff-select> </label> </div> </form> </ff-panel> '},OQxB:function(e,t,r){"use strict";r.r(t);var n=r("03wM"),o=r.n(n),s=r("Ekwr"),a=r.n(s),l=r("hsT8"),i=r.n(l),c=r("lvz6"),f=r.n(c),p=r("yKah"),u=r.n(p),d=r("fzuT"),g=r.n(d),m=(r("3dw1"),r("oWcb"),r("Ztxg")),b=r.n(m),h=r("/o5W");function S(e,t){var r=o()(e);if(a.a){var n=a()(e);t&&(n=i()(n).call(n,(function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){g()(e,t,r[t])})):u.a?Object.defineProperties(e,u()(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,f()(r,t))}))}return e}t.default=angular.module("deskworks.hubspotProposalAddItemsDirective",["ngRoute","deskworks.helper","deskworks.state","deskworks.purchase.service",h.default.name]).directive("hubspotProposalAddItems",(function(){return{restrict:"EAC",scope:!0,template:b.a,controller:"HubsSpotProposalAddItemsCtrl as $ctrl",bindToController:{proposal:"<",items:"<",catalog:"<"}}})).controller("HubsSpotProposalAddItemsCtrl",["$scope","$filter","$route","$translate","dwAlerts","helper","state","HubSpotProposalItem",function(e,t,r,n,o,s,a,l){var i=this;i.collapsed={},i.$onInit=function(){},i.$onChanges=function(){i.catalog&&i.catalog.forEach((function(e){return e.priceListProducts.forEach((function(e){e.quantity=1}))}))},i.add=function(e,t){if(!s.pointFirstInvalid("#plp".concat(t.id))){var r={priceListProductId:t.id,quantity:t.quantity};return l.save({proposalId:i.proposal.id},r).catch((function(e){return o.error(e,"Failed to add proposal item.")})).then((function(e){i.items.push(v(v({},s.pick(t,["productName","description","price","quantity"])),s.pick(e,["id","priceListProductId"])))}))}}}])},P7Ul:function(e,t,r){var n=r("1AXu"),o=r("GD63"),s=r("GYUf")("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==o(e))}},PBfH:function(e,t,r){var n={"./documents/hubspot-documents.directive.js":"+pZ8","./proposals/hubspot-proposal-add-items.directive.js":"OQxB","./proposals/hubspot-proposal-edit.directive.js":"rOhi","./proposals/hubspot-proposals.directive.js":"gN8W","./services/hubspot-deal-stage.service.js":"Vg9s","./services/hubspot-document.service.js":"9l1V","./services/hubspot-monkey-patching.service.js":"eJbi","./services/hubspot-property.service.js":"SU7K","./services/hubspot-proposal-item.service.js":"/o5W","./services/hubspot-proposal.service.js":"sTyO","./services/hubspot-settings.service.js":"HAlh","./services/proposal-item-catalog.service.js":"7pZ+","./settings/hubspot-settings.directive.js":"zo8+"};function o(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=s,e.exports=o,o.id="PBfH"},SU7K:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.HubSpotProperty",["ngResource","deskworks.config"]).factory("HubSpotProperty",["$resource","$location","deskworksConfig",function(e,t,r){var n=e(r.getApiAbsUrl("/hubspot/hubspot-properties/:objectType"));return{query:function(e){return n.query({objectType:e}).$promise}}}])},Vg9s:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.HubSpotDealStage",["ngResource","deskworks.config"]).factory("HubSpotDealStage",["$resource","$location","deskworksConfig",function(e,t,r){var n=e(r.getApiAbsUrl("/hubspot/hubspot-deal-stages"));return{query:function(){return n.query().$promise}}}])},Z9wY:function(e,t,r){e.exports=r("JAQx")},Ztxg:function(e,t){e.exports='<div ng-if="$ctrl.items && $ctrl.catalog"> <div class="em ff-bmargin ff-tmargin" ng-if="!$ctrl.noCollapse"> <span translate="PROPOSALS.ADD_LINE_ITEMS"></span> <span ng-if="$ctrl.userPriceList">, <span translate="PURCHASE.USER_PRICE_LIST"></span>: <span ng-bind="$ctrl.userPriceList.name || \'-\'"></span> </span> </div> <div id="group-{{group.productTypeId}}" ng-repeat="group in $ctrl.catalog"> <ff-btn sense="collapse" ff-click="$ctrl.collapsed[group.productTypeId] = !$ctrl.collapsed[group.productTypeId]" ng-class="{ collapsed: !$ctrl.collapsed[group.productTypeId] }" class="hs-add-items-collapse-btn">{{group.productTypeName}}</ff-btn> <div ng-collapse="!$ctrl.collapsed[group.productTypeId]"> <ff-panel class="ff-bmargin" role="article" aria-label="{{\'PURCHASE.CHARGES.ADD_CHARGES\' | translate: { chargeType: group.productTypeName } }}"> <ff-header> <ff-row> <cell flex="4 0 70px"><span translate="PURCHASE.INVOICE.PRODUCT"></span></cell> <cell flex="0 0 90px" class="ff-right"><span translate="PURCHASE.INVOICE.PRICE"></span></cell> <cell flex="0 0 46px" class="ff-right"><span translate="PURCHASE.INVOICE.QUANTITY"></span></cell> <ff-btn-group flex="0 0 auto" class="buttons-row zero-height"> <ff-btn sense="add" size="sm"><span translate="GLOBAL.BTN_NEW"></span></ff-btn> </ff-btn-group> </ff-row> </ff-header> <form name="formProduct" id="plp{{plp.id}}" ng-repeat="plp in group.priceListProducts"> <div class="ff-row"> <ff-static flex="4 0 70px">{{::plp.productName}}</ff-static> <ff-static flex="0 0 90px" class="ff-right">{{::plp.price | currency}}</ff-static> <ff-number flex="0 0 46px" ff-model="plp.quantity" class="ff-right" ff-required="true" ff-gt="0" ff-validate-alert="{{\'PURCHASE.CHARGES.QUANTITY\' | translate}}"></ff-number> <ff-btn-group flex="none" class="buttons-row"> <ff-btn sense="save" size="sm" type="submit" ff-click="$ctrl.add(group, plp)"> <span translate="GLOBAL.BTN_NEW"></span> </ff-btn> </ff-btn-group> </div> </form> </ff-panel> </div> </div> </div> '},eJbi:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.HubSpotMonkeyPatching",["deskworks.userProfile.optsMembershipStatus","deskworks.userSearchState"]).factory("HubSpotMonkeyPatching",["optsMembershipStatus","userSearchState",function(e,t){return e.push({id:"prospect",name:"Prospect",_name:"Prospect",import:"Prospect"}),t.filters.push({id:"prospects",name:"Prospects",_name:"Prospects",value:!1,type:"role"}),{}}])},gN8W:function(e,t,r){"use strict";r.r(t);var n=r("4BZO"),o=r.n(n),s=r("nbuU"),a=r.n(s),l=(r("JBxO"),r("FdtR"),r("3dw1"),r("2PlZ")),i=r.n(l),c=r("sTyO"),f=r("Vg9s");t.default=angular.module("deskworks.hubspotProposalsDirective",[c.default.name,f.default.name]).directive("hubspotProposals",(function(){return{template:i.a,restrict:"E",scope:!0,controller:"HubSpotProposalCtrl as $ctrl"}})).controller("HubSpotProposalCtrl",["$q","$timeout","$translate","dwAlerts","helper","state","HubSpotProposal","HubSpotDealStage",function(e,t,r,n,s,l,i,c){var f=this;f.$onInit=function(){l.setPageTitle(r.instant("PROPOSALS.PAGE_TITLE")),f.load()},f.load=function(){return f.spin=!0,e.all([i.query({centerId:l.getCurrentCenterId(),userId:l.getCurrentUserId()}).catch((function(e){return n.error(e,"Failed to load proposals.")})),c.query().catch((function(e){return n.error(e,"Failed to load deal stages.")})).catch((function(){return[]}))]).then((function(e){var t=o()(e,2),r=t[0],n=t[1];f.proposals=r,f.stages=n,f.proposals.forEach((function(e){var t;e.stage=(a()(t=f.stages).call(t,(function(t){return t.id===e.stage}))||{}).name||e.stage}))})).finally((function(){f.spin=!1}))},f.edit=function(e){return l.setPath("/proposals/"+e.id)}}])},hNZK:function(e,t,r){r("v+jG");var n=r("hCM1");e.exports=n("String").endsWith},oWcb:function(e,t,r){},rOhi:function(e,t,r){"use strict";r.r(t);var n=r("4BZO"),o=r.n(n),s=r("nbuU"),a=r.n(s),l=r("0zKI"),i=r.n(l),c=(r("JBxO"),r("FdtR"),r("E9Xa")),f=r.n(c),p=r("sTyO"),u=r("/o5W"),d=r("Vg9s"),g=r("7pZ+"),m=r("OQxB");t.default=angular.module("deskworks.hubspotProposalEditDirective",[p.default.name,u.default.name,d.default.name,m.default.name,g.default.name]).directive("hubspotProposalEdit",(function(){return{template:f.a,restrict:"E",scope:!0,controller:"HubSpotProposalEditCtrl as $ctrl"}})).controller("HubSpotProposalEditCtrl",["$q","$route","$translate","dwAlerts","helper","state","HubSpotProposal","HubSpotProposalItem","HubSpotDealStage","ProposalItemCatalog",function(e,t,r,n,s,l,c,f,p,u){var d=this;d.$onInit=function(){l.setPageTitle(r.instant("PROPOSALS.EDIT.PAGE_TITLE")),d.load()},d.load=function(){return d.spin=!0,e.all([c.get({id:t.current.params.id}).catch((function(e){return n.error(e,"Failed to load proposal.")})),f.query({proposalId:t.current.params.id}).catch((function(e){return n.error(e,"Failed to load proposal items.")})),p.query().catch((function(e){return n.error(e,"Failed to load deal stages.")})).catch((function(){return[]})),u.query({centerId:l.getCurrentCenterId(),userId:l.getCurrentUserId()}).catch((function(e){return n.error(e,"Failed to load item catalog.")})).catch((function(){return[]}))]).then((function(e){var t,r=o()(e,4),n=r[0],s=r[1],l=r[2],i=r[3];d.proposal=n,d.items=s,d.stages=l,d.catalog=i,d.proposal.stage=(a()(t=d.stages).call(t,(function(e){return e.id===d.proposal.stage}))||{}).name||d.proposal.stage})).finally((function(){d.spin=!1}))},d.back=function(){return l.setPath("/proposals")},d.getTotal=function(){var e;return(null===(e=d.items)||void 0===e?void 0:e.reduce((function(e,t){return t.amount=t.price*t.quantity,e+t.amount}),0))||0},d.deleteItem=function(e){return f.delete({proposalId:d.proposal.id,id:e.id}).catch((function(e){return n.error(e,"Failed to delete proposal item.")})).then((function(){var t;i()(t=d.items).call(t,d.items.indexOf(e),1)}))}}])},rpNr:function(e,t,r){var n=r("P7Ul");e.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},sTyO:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.HubSpotProposal",["ngResource","deskworks.config","datesDeserializer"]).factory("HubSpotProposal",["$resource","$location","deskworksConfig","datesDeserializer",function(e,t,r,n){var o=n(["createdAt"]),s=e(r.getApiAbsUrl("/hubspot/proposals/:id"),{},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,o]},get:{method:"GET",isArray:!1,transformResponse:[angular.fromJson,o]}});return{query:function(e){return s.query(e).$promise},get:function(e){return s.get(e).$promise}}}])},tHz0:function(e,t,r){"use strict";r.r(t);var n=r("yCd9"),o=r.n(n),s=r("lRNC"),a=r.n(s),l=["$injector",function(e){var t,n,s=(t=r("PBfH"),o()(n=a()(t).call(t)).call(n,t));e.loadNewModules(o()(s).call(s,(function(e){return e.default.name}))),e.get("HubSpotMonkeyPatching")}];t.default=l},"v+jG":function(e,t,r){"use strict";var n,o=r("iddO"),s=r("3tq3").f,a=r("BSLa"),l=r("rpNr"),i=r("zP3F"),c=r("y3LD"),f=r("jHGu"),p="".endsWith,u=Math.min,d=c("endsWith");o({target:"String",proto:!0,forced:!!(f||d||(n=s(String.prototype,"endsWith"),!n||n.writable))&&!d},{endsWith:function(e){var t=String(i(this));l(e);var r=arguments.length>1?arguments[1]:void 0,n=a(t.length),o=void 0===r?n:u(a(r),n),s=String(e);return p?p.call(t,s,o):t.slice(o-s.length,o)===s}})},xmAi:function(e,t,r){var n=r("hNZK"),o=String.prototype;e.exports=function(e){var t=e.endsWith;return"string"==typeof e||e===o||e instanceof String&&t===o.endsWith?n:t}},y3LD:function(e,t,r){var n=r("GYUf")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}},"zo8+":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");var n=r("Jou3"),o=r.n(n),s=r("HAlh"),a=r("SU7K"),l=r("Vg9s");t.default=angular.module("deskworks.hubspotSettingsDirective",["debounce",s.default.name,a.default.name,l.default.name]).directive("hubspotSettings",(function(){return{template:o.a,restrict:"E",scope:!0,controller:"HubSpotSettingsCtrl as $ctrl"}})).controller("HubSpotSettingsCtrl",["$q","dwAlerts","debounce","helper","HubSpotSettings","HubSpotProperty","HubSpotDealStage",function(e,t,r,n,o,s,a){var l=this;l.$onInit=function(){l.load()},l.getConnectUrl=function(){return o.getConnectUrl(l.hubspotSettings?l.hubspotSettings.nonce:"")},l.disconnect=function(){return o.disconnect().catch((function(e){return t.error(e,"Failed to disconnect from HubSpot.")})).then((function(){l.hubspotSettings.connected=!1}))},l.load=function(){return l.spin=!0,o.get().catch((function(e){return t.error(e,"Failed to load HubSpot settings.")})).then((function(r){if(l.hubspotSettings=r,l.hubspotSettings.connected)return e.all([s.query("deal").catch((function(e){return t.error(e,"Failed to load HubSpot deal properties.")})).then((function(e){l.dealProps=e})),s.query("contact").catch((function(e){return t.error(e,"Failed to load HubSpot contact properties.")})).then((function(e){l.contactProps=e})),a.query().catch((function(e){return t.error(e,"Failed to load HubSpot deal stages.")})).then((function(e){l.dealStages=e}))])})).finally((function(){l.spin=!1}))},l.saveSettings=r((function(e){if(e&&e.$invalid)return;return l.spin=!0,o.save(l.hubspotSettings).catch((function(e){return t.error(e,"Failed to save HubSpot settings.")})).finally((function(){l.spin=!1}))}),1e3)}])}}]);