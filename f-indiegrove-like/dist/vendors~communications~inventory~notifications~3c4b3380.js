(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{T7M0:function(e,t,n){var a,o,r;r=this,a=[n("diuS"),n("pqgc")],void 0===(o=function(e,t){return r["textAngular.name"]=function(e){var t={};angular.module("textAngularSetup",[]).constant("taRegisterTool",(function(e,n){if(!e||""===e||t.hasOwnProperty(e))throw"textAngular Error: A unique name is required for a Tool Definition";if(n.display&&(""===n.display||!function(e){try{return 0!==angular.element(e).length}catch(e){return!1}}(n.display))||!n.display&&!n.buttontext&&!n.iconclass)throw'textAngular Error: Tool Definition for "'+e+'" does not have a valid display/iconclass/buttontext value';t[e]=n})).value("taTools",t).value("taOptions",{forceTextAngularSanitize:!0,keyMappings:[],toolbar:[["h1","h2","h3","h4","h5","h6","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],["justifyLeft","justifyCenter","justifyRight","justifyFull","indent","outdent"],["html","insertImage","insertLink","insertVideo","wordcount","charcount"]],classes:{focussed:"focussed",toolbar:"btn-toolbar",toolbarGroup:"btn-group",toolbarButton:"btn btn-default",toolbarButtonActive:"active",disabled:"disabled",textEditor:"form-control",htmlEditor:"form-control"},defaultTagAttributes:{a:{target:""}},setup:{textEditorSetup:function(e){},htmlEditorSetup:function(e){}},defaultFileDropHandler:function(e,t){var n=new FileReader;return"image"===e.type.substring(0,5)&&(n.onload=function(){""!==n.result&&t("insertImage",n.result,!0)},n.readAsDataURL(e),!0)}}).value("taSelectableElements",["a","img"]).value("taCustomRenderers",[{selector:"img",customAttribute:"ta-insert-video",renderLogic:function(e){var t=angular.element("<iframe></iframe>"),n=e.prop("attributes");angular.forEach(n,(function(e){t.attr(e.name,e.value)})),t.attr("src",t.attr("ta-insert-video")),e.replaceWith(t)}}]).value("taTranslations",{html:{tooltip:"Toggle html / Rich Text"},heading:{tooltip:"Heading "},p:{tooltip:"Paragraph"},pre:{tooltip:"Preformatted text"},ul:{tooltip:"Unordered List"},ol:{tooltip:"Ordered List"},quote:{tooltip:"Quote/unquote selection or paragraph"},undo:{tooltip:"Undo"},redo:{tooltip:"Redo"},bold:{tooltip:"Bold"},italic:{tooltip:"Italic"},underline:{tooltip:"Underline"},strikeThrough:{tooltip:"Strikethrough"},justifyLeft:{tooltip:"Align text left"},justifyRight:{tooltip:"Align text right"},justifyFull:{tooltip:"Justify text"},justifyCenter:{tooltip:"Center"},indent:{tooltip:"Increase indent"},outdent:{tooltip:"Decrease indent"},clear:{tooltip:"Clear formatting"},insertImage:{dialogPrompt:"Please enter an image URL to insert",tooltip:"Insert image",hotkey:"the - possibly language dependent hotkey ... for some future implementation"},insertVideo:{tooltip:"Insert video",dialogPrompt:"Please enter a youtube URL to embed"},insertLink:{tooltip:"Insert / edit link",dialogPrompt:"Please enter a URL to insert"},editLink:{reLinkButton:{tooltip:"Relink"},unLinkButton:{tooltip:"Unlink"},targetToggle:{buttontext:"Open in New Window"}},wordcount:{tooltip:"Display words Count"},charcount:{tooltip:"Display characters Count"}}).factory("taToolFunctions",["$window","taTranslations",function(e,t){return{imgOnSelectAction:function(e,t,n){var a=function(){n.updateTaBindtaTextElement(),n.hidePopover()};e.preventDefault(),n.displayElements.popover.css("width","375px");var o=n.displayElements.popoverContainer;o.empty();var r=angular.element('<div class="btn-group" style="padding-right: 6px;">'),l=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">100% </button>');l.on("click",(function(e){e.preventDefault(),t.css({width:"100%",height:""}),a()}));var i=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">50% </button>');i.on("click",(function(e){e.preventDefault(),t.css({width:"50%",height:""}),a()}));var s=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">25% </button>');s.on("click",(function(e){e.preventDefault(),t.css({width:"25%",height:""}),a()}));var d=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">Reset</button>');d.on("click",(function(e){e.preventDefault(),t.css({width:"",height:""}),a()})),r.append(l),r.append(i),r.append(s),r.append(d),o.append(r),r=angular.element('<div class="btn-group" style="padding-right: 6px;">');var u=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-left"></i></button>');u.on("click",(function(e){e.preventDefault(),t.css("float","left"),t.css("cssFloat","left"),t.css("styleFloat","left"),a()}));var c=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-right"></i></button>');c.on("click",(function(e){e.preventDefault(),t.css("float","right"),t.css("cssFloat","right"),t.css("styleFloat","right"),a()}));var p=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-justify"></i></button>');p.on("click",(function(e){e.preventDefault(),t.css("float",""),t.css("cssFloat",""),t.css("styleFloat",""),a()})),r.append(u),r.append(p),r.append(c),o.append(r),r=angular.element('<div class="btn-group">');var f=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-trash-o"></i></button>');f.on("click",(function(e){e.preventDefault(),t.remove(),a()})),r.append(f),o.append(r),n.showPopover(t),n.showResizeOverlay(t)},aOnSelectAction:function(n,a,o){n.preventDefault(),o.displayElements.popover.css("width","436px");var r=o.displayElements.popoverContainer;r.empty(),r.css("line-height","28px");var l=angular.element('<a href="'+a.attr("href")+'" target="_blank">'+a.attr("href")+"</a>");l.css({display:"inline-block","max-width":"200px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","vertical-align":"middle"}),r.append(l);var i=angular.element('<div class="btn-group pull-right">'),s=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+t.editLink.reLinkButton.tooltip+'"><i class="fa fa-edit icon-edit"></i></button>');s.on("click",(function(n){n.preventDefault();var r=e.prompt(t.insertLink.dialogPrompt,a.attr("href"));r&&""!==r&&"http://"!==r&&(a.attr("href",r),o.updateTaBindtaTextElement()),o.hidePopover()})),i.append(s);var d=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+t.editLink.unLinkButton.tooltip+'"><i class="fa fa-unlink icon-unlink"></i></button>');d.on("click",(function(e){e.preventDefault(),a.replaceWith(a.contents()),o.updateTaBindtaTextElement(),o.hidePopover()})),i.append(d);var u=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on">'+t.editLink.targetToggle.buttontext+"</button>");"_blank"===a.attr("target")&&u.addClass("active"),u.on("click",(function(e){e.preventDefault(),a.attr("target","_blank"===a.attr("target")?"":"_blank"),u.toggleClass("active"),o.updateTaBindtaTextElement()})),i.append(u),r.append(i),o.showPopover(a)},extractYoutubeVideoId:function(e){var t=e.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/i);return t&&t[1]||null}}}]).run(["taRegisterTool","$window","taTranslations","taSelection","taToolFunctions","$sanitize","taOptions","$log",function(e,t,n,a,o,r,l,i){var s={};if(r("",s),!0===l.forceTextAngularSanitize&&"taSanitize"!==s.version)throw angular.$$minErr("textAngular")("textAngularSetup","The textAngular-sanitize provider has been replaced by another -- have you included angular-sanitize by mistake?");e("html",{iconclass:"fa fa-code",tooltiptext:n.html.tooltip,action:function(){this.$editor().switchView()},activeState:function(){return this.$editor().showHtml}});var d=function(){return this.$editor().wrapSelection("formatBlock","<"+this.name.toUpperCase()+">")};angular.forEach(["h1","h2","h3","h4","h5","h6"],(function(t){var a;e(t.toLowerCase(),{buttontext:t.toUpperCase(),tooltiptext:n.heading.tooltip+t.charAt(1),action:d,activeState:(a=t.toLowerCase(),function(){return this.$editor().queryFormatBlockState(a)})})})),e("p",{buttontext:"P",tooltiptext:n.p.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<P>")},activeState:function(){return this.$editor().queryFormatBlockState("p")}}),e("pre",{buttontext:"pre",tooltiptext:n.pre.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<PRE>")},activeState:function(){return this.$editor().queryFormatBlockState("pre")}}),e("ul",{iconclass:"fa fa-list-ul",tooltiptext:n.ul.tooltip,action:function(){return this.$editor().wrapSelection("insertUnorderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertUnorderedList")}}),e("ol",{iconclass:"fa fa-list-ol",tooltiptext:n.ol.tooltip,action:function(){return this.$editor().wrapSelection("insertOrderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertOrderedList")}}),e("quote",{iconclass:"fa fa-quote-right",tooltiptext:n.quote.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<BLOCKQUOTE>")},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")}}),e("undo",{iconclass:"fa fa-undo",tooltiptext:n.undo.tooltip,action:function(){return this.$editor().wrapSelection("undo",null)}}),e("redo",{iconclass:"fa fa-repeat",tooltiptext:n.redo.tooltip,action:function(){return this.$editor().wrapSelection("redo",null)}}),e("bold",{iconclass:"fa fa-bold",tooltiptext:n.bold.tooltip,action:function(){return this.$editor().wrapSelection("bold",null)},activeState:function(){return this.$editor().queryCommandState("bold")},commandKeyCode:98}),e("justifyLeft",{iconclass:"fa fa-align-left",tooltiptext:n.justifyLeft.tooltip,action:function(){return this.$editor().wrapSelection("justifyLeft",null)},activeState:function(e){if(e&&"#document"===e.nodeName)return!1;var t=!1;if(e)try{t="left"===e.css("text-align")||"left"===e.attr("align")||"right"!==e.css("text-align")&&"center"!==e.css("text-align")&&"justify"!==e.css("text-align")&&!this.$editor().queryCommandState("justifyRight")&&!this.$editor().queryCommandState("justifyCenter")&&!this.$editor().queryCommandState("justifyFull")}catch(e){t=!1}return t=t||this.$editor().queryCommandState("justifyLeft")}}),e("justifyRight",{iconclass:"fa fa-align-right",tooltiptext:n.justifyRight.tooltip,action:function(){return this.$editor().wrapSelection("justifyRight",null)},activeState:function(e){if(e&&"#document"===e.nodeName)return!1;var t=!1;if(e)try{t="right"===e.css("text-align")}catch(e){t=!1}return t=t||this.$editor().queryCommandState("justifyRight")}}),e("justifyFull",{iconclass:"fa fa-align-justify",tooltiptext:n.justifyFull.tooltip,action:function(){return this.$editor().wrapSelection("justifyFull",null)},activeState:function(e){var t=!1;if(e)try{t="justify"===e.css("text-align")}catch(e){t=!1}return t=t||this.$editor().queryCommandState("justifyFull")}}),e("justifyCenter",{iconclass:"fa fa-align-center",tooltiptext:n.justifyCenter.tooltip,action:function(){return this.$editor().wrapSelection("justifyCenter",null)},activeState:function(e){if(e&&"#document"===e.nodeName)return!1;var t=!1;if(e)try{t="center"===e.css("text-align")}catch(e){t=!1}return t=t||this.$editor().queryCommandState("justifyCenter")}}),e("indent",{iconclass:"fa fa-indent",tooltiptext:n.indent.tooltip,action:function(){return this.$editor().wrapSelection("indent",null)},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")},commandKeyCode:"TabKey"}),e("outdent",{iconclass:"fa fa-outdent",tooltiptext:n.outdent.tooltip,action:function(){return this.$editor().wrapSelection("outdent",null)},activeState:function(){return!1},commandKeyCode:"ShiftTabKey"}),e("italics",{iconclass:"fa fa-italic",tooltiptext:n.italic.tooltip,action:function(){return this.$editor().wrapSelection("italic",null)},activeState:function(){return this.$editor().queryCommandState("italic")},commandKeyCode:105}),e("underline",{iconclass:"fa fa-underline",tooltiptext:n.underline.tooltip,action:function(){return this.$editor().wrapSelection("underline",null)},activeState:function(){return this.$editor().queryCommandState("underline")},commandKeyCode:117}),e("strikeThrough",{iconclass:"fa fa-strikethrough",tooltiptext:n.strikeThrough.tooltip,action:function(){return this.$editor().wrapSelection("strikeThrough",null)},activeState:function(){return document.queryCommandState("strikeThrough")}}),e("clear",{iconclass:"fa fa-ban",tooltiptext:n.clear.tooltip,action:function(e,t){var n;this.$editor().wrapSelection("removeFormat",null);var o=angular.element(a.getSelectionElement());n=a.getAllSelectedElements();var r=function(e,t){e=angular.element(e);var n=t;return t||(n=e),angular.forEach(e.children(),(function(e){if("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase())n=r(e,n);else{var t=angular.element("<p></p>");t.html(angular.element(e).html()),n.after(t),n=t}})),e.remove(),n};angular.forEach(n,(function(e){"ul"!==e.nodeName.toLowerCase()&&"ol"!==e.nodeName.toLowerCase()||r(e)})),angular.forEach(o.find("ul"),r),angular.forEach(o.find("ol"),r);var l=this.$editor(),i=function(e){(e=angular.element(e))[0]!==l.displayElements.text[0]&&e.removeAttr("class"),angular.forEach(e.children(),i)};angular.forEach(o,i),o[0]&&"li"!==o[0].tagName.toLowerCase()&&"ol"!==o[0].tagName.toLowerCase()&&"ul"!==o[0].tagName.toLowerCase()&&"true"!==o[0].getAttribute("contenteditable")&&this.$editor().wrapSelection("formatBlock","default"),t()}});var u=function(e){return-1!==e.toLowerCase().indexOf("javascript")};e("insertImage",{iconclass:"fa fa-picture-o",tooltiptext:n.insertImage.tooltip,action:function(){var e;if((e=t.prompt(n.insertImage.dialogPrompt,"http://"))&&""!==e&&"http://"!==e&&!u(e)){a.getSelectionElement().tagName&&"a"===a.getSelectionElement().tagName.toLowerCase()&&a.setSelectionAfterElement(a.getSelectionElement());var o='<img src="'+e+'">';return this.$editor().wrapSelection("insertHTML",o,!0)}},onElementSelect:{element:"img",action:o.imgOnSelectAction}}),e("insertVideo",{iconclass:"fa fa-youtube-play",tooltiptext:n.insertVideo.tooltip,action:function(){var e;if(e=t.prompt(n.insertVideo.dialogPrompt,"https://"),!u(e)&&e&&""!==e&&"https://"!==e&&(videoId=o.extractYoutubeVideoId(e),videoId)){var r="https://www.youtube.com/embed/"+videoId,l='<img class="ta-insert-video" src="https://img.youtube.com/vi/'+videoId+'/hqdefault.jpg" ta-insert-video="'+r+'" contenteditable="false" allowfullscreen="true" frameborder="0" />';return a.getSelectionElement().tagName&&"a"===a.getSelectionElement().tagName.toLowerCase()&&a.setSelectionAfterElement(a.getSelectionElement()),this.$editor().wrapSelection("insertHTML",l,!0)}},onElementSelect:{element:"img",onlyWithAttrs:["ta-insert-video"],action:o.imgOnSelectAction}}),e("insertLink",{tooltiptext:n.insertLink.tooltip,iconclass:"fa fa-link",action:function(){var e;if((e=a.getSelectionElement().tagName&&"a"===a.getSelectionElement().tagName.toLowerCase()?t.prompt(n.insertLink.dialogPrompt,a.getSelectionElement().href):t.prompt(n.insertLink.dialogPrompt,"http://"))&&""!==e&&"http://"!==e&&!u(e))return this.$editor().wrapSelection("createLink",e,!0)},activeState:function(e){return!!e&&"A"===e[0].tagName},onElementSelect:{element:"a",action:o.aOnSelectAction}}),e("wordcount",{display:'<div id="toolbarWC" style="display:block; min-width:100px;">Words: <span ng-bind="wordcount"></span></div>',disabled:!0,wordcount:0,activeState:function(){var e=this.$editor().displayElements.text[0].innerHTML||"",t=0;return""!==e.replace(/\s*<[^>]*?>\s*/g,"")&&""!==e.trim()&&(t=e.replace(/<\/?(b|i|em|strong|span|u|strikethrough|a|img|small|sub|sup|label)( [^>*?])?>/gi,"").replace(/(<[^>]*?>\s*<[^>]*?>)/gi," ").replace(/(<[^>]*?>)/gi,"").replace(/\s+/gi," ").match(/\S+/g).length),this.wordcount=t,this.$editor().wordcount=t,!1}}),e("charcount",{display:'<div id="toolbarCC" style="display:block; min-width:120px;">Characters: <span ng-bind="charcount"></span></div>',disabled:!0,charcount:0,activeState:function(){var e=this.$editor().displayElements.text,t=(e[0].innerText||e[0].textContent).replace(/(\r\n|\n|\r)/gm,"").replace(/^\s+/g," ").replace(/\s+$/g," ").length;return this.charcount=t,this.$editor().charcount=t,!1}})}]);var n=function(){for(var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return e>4?e:void 0}(),a=/AppleWebKit\/([\d.]+)/i.test(navigator.userAgent),o=(navigator.userAgent.toLowerCase().indexOf("firefox"),o||{});o.now=o.now||o.mozNow||o.msNow||o.oNow||o.webkitNow||function(){return(new Date).getTime()};var r,l,i,s,d,u,c,p=/^(address|article|aside|audio|blockquote|canvas|center|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video)$/i,f=/^(ul|li|ol)$/i,m=/^(#text|span|address|article|aside|audio|blockquote|canvas|center|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video|li)$/i;if(String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),n>8||void 0===n){for(var g=document.styleSheets,h=0;h<g.length;h++)if((0===g[h].media.length||g[h].media.mediaText.match(/(all|screen)/gi))&&g[h].href&&g[h].href.match(/textangular\.(min\.|)css/gi)){r=g[h];break}r||(c=document.createElement("style"),a&&c.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(c),r=c.sheet),l=function(e,t){return s(r,e,t)},s=function(e,t,n){var a,o;return e.cssRules?a=Math.max(e.cssRules.length-1,0):e.rules&&(a=Math.max(e.rules.length-1,0)),e.insertRule?e.insertRule(t+"{"+n+"}",a):e.addRule(t,n,a),r.rules?o=r.rules[a]:r.cssRules&&(o=r.cssRules[a]),o},u=function(e,t){var n,a;for(n=0;n<t.length;n++)if(t[n].cssText===e.cssText){a=n;break}return a},i=function(e){d(r,e)},d=function(e,t){var n=e.cssRules||e.rules;if(n&&0!==n.length){var a=u(t,n);e.removeRule?e.removeRule(a):e.deleteRule(a)}}}angular.module("textAngular.factories",[]).factory("taBrowserTag",[function(){return function(e){return e?""===e?void 0===n?"div":n<=8?"P":"p":n<=8?e.toUpperCase():e:n<=8?"P":"p"}}]).factory("taApplyCustomRenderers",["taCustomRenderers","taDOM",function(e,t){return function(n){var a=angular.element("<div></div>");return a[0].innerHTML=n,angular.forEach(e,(function(e){var n=[];e.selector&&""!==e.selector?n=a.find(e.selector):e.customAttribute&&""!==e.customAttribute&&(n=t.getByAttribute(a,e.customAttribute)),angular.forEach(n,(function(t){t=angular.element(t),e.selector&&""!==e.selector&&e.customAttribute&&""!==e.customAttribute?void 0!==t.attr(e.customAttribute)&&e.renderLogic(t):e.renderLogic(t)}))})),a[0].innerHTML}}]).factory("taFixChrome",(function(){return function(e,t){if(!e||!angular.isString(e)||e.length<=0)return e;for(var n,a,o,r=/style\s?=\s?(["'])(?:(?=(\\?))\2.)*?\1/gi,l=/<span class="Apple-converted-space">([^<]+)<\/span>/gi,i="",s=0;n=l.exec(e);)o=(o=n[1]).replace(/&nbsp;/gi," "),i+=e.substring(s,n.index)+o,s=n.index+n[0].length;if(s&&(i+=e.substring(s),e=i,i="",s=0),!t){for(;n=r.exec(e);)i+=e.substring(s,n.index-1),a=n[0],(n=/font-family: inherit;|line-height: 1.[0-9]{3,12};|color: inherit; line-height: 1.1;|color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);|background-color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);/gi.exec(a))?(a=a.replace(/( |)font-family: inherit;|( |)line-height: 1.[0-9]{3,12};|( |)color: inherit;|( |)color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);|( |)background-color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);/gi,"")).length>8&&(i+=" "+a):i+=" "+a,s=r.lastIndex;i+=e.substring(s)}return s>0?i.replace(/<span\s?>(.*?)<\/span>(<br(\/|)>|)/gi,"$1"):e}})).factory("taSanitize",["$sanitize",function(e){for(var t=[{property:"font-weight",values:["bold"],tag:"b"},{property:"font-style",values:["italic"],tag:"i"}],n=[],a=0;a<t.length;a++){for(var o="("+t[a].property+":\\s*(",r=0;r<t[a].values.length;r++)r>0&&(o+="|"),o+=t[a].values[r];o+=");)",n.push(o)}var l="("+n.join("|")+")";function i(e,t){for(var n,a=0,o=0,r=/<[^>]*>/gi;n=r.exec(e);)if(o=n.index,"/"===n[0].substr(1,1)){if(0===a)break;a--}else a++;return t+e.substring(0,o)+angular.element(t)[0].outerHTML.substring(t.length)+e.substring(o)}var s=new RegExp(/<span id="selectionBoundary_\d+_\d+" class="rangySelectionBoundary">[^<>]+?<\/span>/gi),d=new RegExp(/<span class="rangySelectionBoundary" id="selectionBoundary_\d+_\d+">[^<>]+?<\/span>/gi),u=new RegExp(/<span id="selectionBoundary_\d+_\d+" class="rangySelectionBoundary">[^<>]+?<\/span>/gi);return function(n,a,o){if(!o)try{n=function e(n){if(!n||!angular.isString(n)||n.length<=0)return n;for(var a,o,r,s,d,u,c=/<([^>\/]+?)style=("([^"]+)"|'([^']+)')([^>]*)>/gi,p="",f="",m=0;o=c.exec(n);){s=o[3]||o[4];var g=new RegExp(l,"i");if(angular.isString(s)&&g.test(s)){d="";for(var h=new RegExp(l,"ig");r=h.exec(s);)for(a=0;a<t.length;a++)r[2*a+2]&&(d+="<"+t[a].tag+">");u=e(n.substring(m,o.index)),p.length>0?f+=i(u,p):f+=u,s=s.replace(new RegExp(l,"ig"),""),f+="<"+o[1].trim(),s.length>0&&(f+=' style="'+s+'"'),f+=o[5]+">",m=o.index+o[0].length,p=d}}return p.length>0?f+=i(n.substring(m),p):f+=n.substring(m),f}(n)}catch(e){}if(n=function(e){if(!e||!angular.isString(e)||e.length<=0)return e;for(var t,n=/<([^>\/]+?)align=("([^"]+)"|'([^']+)')([^>]*)>/gi,a="",o=0;t=n.exec(e);){a+=e.substring(o,t.index),o=t.index+t[0].length;var r="<"+t[1]+t[5];/style=("([^"]+)"|'([^']+)')/gi.test(r)?r=r.replace(/style=("([^"]+)"|'([^']+)')/i,'style="$2$3 text-align:'+(t[3]||t[4])+';"'):r+=' style="text-align:'+(t[3]||t[4])+';"',a+=r+=">"}return a+e.substring(o)}(n))try{n=(n=(n=(n=n.replace(s,"")).replace(d,"")).replace(s,"")).replace(u,"")}catch(e){}var r;try{r=e(n),o&&(r=n)}catch(e){r=a||""}var c,p=r.match(/(<pre[^>]*>.*?<\/pre[^>]*>)/gi),f=r.replace(/(&#(9|10);)*/gi,""),m=/<pre[^>]*>.*?<\/pre[^>]*>/gi,g=0,h=0;for(r="";null!==(c=m.exec(f))&&g<p.length;)r+=f.substring(h,c.index)+p[g],h=c.index+c[0].length,g++;return r+f.substring(h)}}]).factory("taToolExecuteAction",["$q","$log",function(e,t){return function(n){void 0!==n&&(this.$editor=function(){return n});var a,o=e.defer(),r=o.promise,l=this.$editor();try{a=this.action(o,l.startAction()),r.finally((function(){l.endAction.call(l)}))}catch(e){t.error(e)}(a||void 0===a)&&o.resolve()}}]),angular.module("textAngular.DOM",["textAngular.factories"]).factory("taExecCommand",["taSelection","taBrowserTag","$document",function(t,n,a){var o=function(e,n){var a,o,r=e.find("li");for(o=r.length-1;o>=0;o--)a=angular.element("<"+n+">"+r[o].innerHTML+"</"+n+">"),e.after(a);e.remove(),t.setSelectionToElementEnd(a[0])},r=function(e,a,o,r,l){var i,s,d,u,c,p=e.find("li");for(s=0;s<p.length;s++)if(p[s].outerHTML===a[0].outerHTML){c=s,s>0&&(d=p[s-1]),s+1<p.length&&(u=p[s+1]);break}var f="";if(r?f+="<"+l+">"+a[0].innerHTML+"</"+l+">":(f+="<"+n(o)+">",f+="<li>"+a[0].innerHTML+"</li>",f+="</"+n(o)+">"),i=angular.element(f),!d)return a.remove(),e.after(angular.element(e[0].outerHTML)),e.after(i),e.remove(),void t.setSelectionToElementEnd(i[0]);if(u){e.parent();var m="",g=e[0].nodeName.toLowerCase();for(m+="<"+g+">",s=0;s<c;s++)m+="<li>"+p[s].innerHTML+"</li>";m+="</"+g+">";var h="";for(h+="<"+g+">",s=c+1;s<p.length;s++)h+="<li>"+p[s].innerHTML+"</li>";h+="</"+g+">",e.after(angular.element(h)),e.after(i),e.after(angular.element(m)),e.remove(),t.setSelectionToElementEnd(i[0])}else a.remove(),e.after(i),t.setSelectionToElementEnd(i[0])},l=function(e){/(<br(|\/)>)$/i.test(e.innerHTML.trim())?t.setSelectionBeforeElement(angular.element(e).find("br")[0]):t.setSelectionToElementEnd(e)},i=function(e,t){var n=angular.element("<"+t+">"+e[0].innerHTML+"</"+t+">");e.after(n),e.remove(),l(n.find("li")[0])},s=function(e,t,a){for(var o="",r=0;r<e.length;r++)o+="<"+n("li")+">"+e[r].innerHTML+"</"+n("li")+">";var i=angular.element("<"+a+">"+o+"</"+a+">");t.after(i),t.remove(),l(i.find("li")[0])},d=function(e,t){for(var n=0;n<e.childNodes.length;n++){var a=e.childNodes[n];a.tagName&&a.tagName.match(p)&&d(a,t)}if(null===e.parentNode)return e;if("<br>"===t)return e;var o=angular.element(t);return o[0].innerHTML=e.innerHTML,e.parentNode.insertBefore(o[0],e),e.parentNode.removeChild(e),o};return function(l,u){return l=n(l),function(c,m,g,h){var v,y,b,x,E,S,w,T,C=angular.element("<"+l+">");try{var N,L;t.getSelection&&(T=t.getSelection()),void 0!==(w=t.getSelectionElement()).tagName&&("div"===w.tagName.toLowerCase()&&/taTextElement.+/.test(w.id)&&T&&T.start&&1===T.start.offset&&1===T.end.offset||"span"===w.tagName.toLowerCase()&&T&&T.start&&1===T.start.offset&&1===T.end.offset?(N=w.innerHTML,/<br>/i.test(N)&&(N=N.replace(/<br>/i,"&#8203;")),/<br\/>/i.test(N)&&(N=N.replace(/<br\/>/i,"&#8203;")),/<span>(<span>)+/i.test(N)&&(N=__.replace(/<span>(<span>)+/i,"<span>")),/<\/span>(<\/span>)+/i.test(N)&&(N=__.replace(/<\/span>(<\/span>)+/i,"</span>")),/<span><\/span>/i.test(N)&&(N=N.replace(/<span><\/span>/i,"")),L="<div>"+N+"</div>",w.innerHTML=L,t.setSelectionToElementEnd(w.childNodes[0]),w=t.getSelectionElement()):"p"===w.tagName.toLowerCase()&&T&&T.start&&1===T.start.offset&&1===T.end.offset?(N=w.innerHTML,/<br>/i.test(N)&&(N=N.replace(/<br>/i,"&#8203;"),w.innerHTML=N)):"li"===w.tagName.toLowerCase()&&T&&T.start&&T.start.offset===T.end.offset&&(N=w.innerHTML,/<br>/i.test(N)&&(N=N.replace(/<br>/i,""),w.innerHTML=N)))}catch(e){}if(w){var $=angular.element(w),k=w&&w.tagName&&w.tagName.toLowerCase()||"";if("insertorderedlist"===c.toLowerCase()||"insertunorderedlist"===c.toLowerCase()){var A=n("insertorderedlist"===c.toLowerCase()?"ol":"ul"),M=t.getOnlySelectedElements();if(M.length>1&&("ol"===k||"ul"===k))return function(e,a,o,r,l){var i,s,d,u,c,p=e.find("li"),f=[];for(s=0;s<p.length;s++)for(d=0;d<a.length;d++)p[s].isEqualNode(a[d])&&(f[d]=s);f[0]>0&&(u=p[f[0]-1]),f[a.length-1]+1<p.length&&(c=p[f[a.length-1]+1]);var m="";if(r)for(d=0;d<a.length;d++)m+="<"+l+">"+a[d].innerHTML+"</"+l+">",a[d].remove();else{for(m+="<"+n(o)+">",d=0;d<a.length;d++)m+=a[d].outerHTML,a[d].remove();m+="</"+n(o)+">"}if(i=angular.element(m),!u)return e.after(angular.element(e[0].outerHTML)),e.after(i),e.remove(),void t.setSelectionToElementEnd(i[0]);if(!c)return e.after(i),void t.setSelectionToElementEnd(i[0]);var g="",h=e[0].nodeName.toLowerCase();for(g+="<"+h+">",s=0;s<f[0];s++)g+="<li>"+p[s].innerHTML+"</li>";g+="</"+h+">";var v="";for(v+="<"+h+">",s=f[a.length-1]+1;s<p.length;s++)v+="<li>"+p[s].innerHTML+"</li>";v+="</"+h+">",e.after(angular.element(v)),e.after(i),e.after(angular.element(g)),e.remove(),t.setSelectionToElementEnd(i[0])}($,M,A,A===k,l);if(k===A)return $[0].childNodes.length!==M.length&&1===M.length?($=angular.element(M[0]),r($.parent(),$,A,!0,l)):o($,l);if("li"===k&&$.parent()[0].tagName.toLowerCase()===A&&1===$.parent().children().length)return o($.parent(),l);if("li"===k&&$.parent()[0].tagName.toLowerCase()!==A&&1===$.parent().children().length)return i($.parent(),A);if(k.match(p)&&!$.hasClass("ta-bind")){if(M.length&&$[0].childNodes.length!==M.length&&1===M.length)return $=angular.element(M[0]),r($.parent(),$,A,A===k,l);if("ol"===k||"ul"===k)return i($,A);var H=!1;return angular.forEach($.children(),(function(e){e.tagName.match(p)&&(H=!0)})),s(H?$.children():[angular.element("<div>"+w.innerHTML+"</div>")[0]],$,A)}if(k.match(p)){if(0===(x=t.getOnlySelectedElements()).length)y=angular.element("<"+A+"><li>"+w.innerHTML+"</li></"+A+">"),$.html(""),$.append(y);else{if(1===x.length&&("ol"===x[0].tagName.toLowerCase()||"ul"===x[0].tagName.toLowerCase()))return x[0].tagName.toLowerCase()===A?o(angular.element(x[0]),l):i(angular.element(x[0]),A);b="";var D=[];for(v=0;v<x.length;v++)if(3!==x[v].nodeType){var B=angular.element(x[v]);if("li"===x[v].tagName.toLowerCase())continue;"ol"===x[v].tagName.toLowerCase()||"ul"===x[v].tagName.toLowerCase()?b+=B[0].innerHTML:"span"!==x[v].tagName.toLowerCase()||"ol"!==x[v].childNodes[0].tagName.toLowerCase()&&"ul"!==x[v].childNodes[0].tagName.toLowerCase()?b+="<"+n("li")+">"+B[0].innerHTML+"</"+n("li")+">":b+=B[0].childNodes[0].innerHTML,D.unshift(B)}y=angular.element("<"+A+">"+b+"</"+A+">"),D.pop().replaceWith(y),angular.forEach(D,(function(e){e.remove()}))}return void t.setSelectionToElementEnd(y[0])}}else{if("formatblock"===c.toLowerCase()){for("default"===(S=g.toLowerCase().replace(/[<>]/gi,"")).trim()&&(S=l,g="<"+l+">"),y="li"===k?$.parent():$;!y[0].tagName||!y[0].tagName.match(p)&&!y.parent().attr("contenteditable");)k=((y=y.parent())[0].tagName||"").toLowerCase();if(k===S){x=y.children();var R=!1;for(v=0;v<x.length;v++)R=R||x[v].tagName.match(p);R?(y.after(x),E=y.next(),y.remove(),y=E):(C.append(y[0].childNodes),y.after(C),y.remove(),y=C)}else if(y.parent()[0].tagName.toLowerCase()!==S||y.parent().hasClass("ta-bind"))if(k.match(f))y.wrap(g);else{for(0===(x=t.getOnlySelectedElements()).length&&(x=[y[0]]),v=0;v<x.length;v++)if(3===x[v].nodeType||!x[v].tagName.match(p))for(;3===x[v].nodeType||!x[v].tagName||!x[v].tagName.match(p);)x[v]=x[v].parentNode;if((x=x.filter((function(e,t,n){return n.indexOf(e)===t}))).length>1&&(x=x.filter((function(e,t,n){return!("div"===e.nodeName.toLowerCase()&&/^taTextElement/.test(e.id))}))),angular.element(x[0]).hasClass("ta-bind"))(y=angular.element(g))[0].innerHTML=x[0].innerHTML,x[0].innerHTML=y[0].outerHTML;else if("blockquote"===S){for(b="",v=0;v<x.length;v++)b+=x[v].outerHTML;for((y=angular.element(g))[0].innerHTML=b,x[0].parentNode.insertBefore(y[0],x[0]),v=x.length-1;v>=0;v--)x[v].parentNode&&x[v].parentNode.removeChild(x[v])}else if("pre"===S&&t.getStateShiftKey()){for(b="",v=0;v<x.length;v++)b+=x[v].outerHTML;for((y=angular.element(g))[0].innerHTML=b,x[0].parentNode.insertBefore(y[0],x[0]),v=x.length-1;v>=0;v--)x[v].parentNode&&x[v].parentNode.removeChild(x[v])}else for(v=0;v<x.length;v++){var K=d(x[v],g);x[v]===y[0]&&(y=angular.element(K))}}else{var _=y.parent(),W=_.contents();for(v=0;v<W.length;v++)_.parent().hasClass("ta-bind")&&3===W[v].nodeType&&((C=angular.element("<"+l+">"))[0].innerHTML=W[v].outerHTML,W[v]=C[0]),_.parent()[0].insertBefore(W[v],_[0]);_.remove()}return t.setSelectionToElementEnd(y[0]),void y[0].focus()}if("createlink"===c.toLowerCase()){if("a"===k)return void(t.getSelectionElement().href=g);var z='<a href="'+g+'" target="'+(h.a.target?h.a.target:"")+'">';if(t.getSelection().collapsed)t.insertHtml(z+g+"</a>",u);else if(e.getSelection().getRangeAt(0).canSurroundContents()){var q=angular.element(z+"</a>")[0];e.getSelection().getRangeAt(0).surroundContents(q)}return}if("inserthtml"===c.toLowerCase())return void t.insertHtml(g,u)}try{a[0].execCommand(c,m,g)}catch(e){}}}}}]).service("taSelection",["$document","taDOM","$log",function(t,n,a){var o,r=t[0],l=function(e,t){return e.tagName&&e.tagName.match(/^br$/i)&&0===t&&!e.previousSibling?{element:e.parentNode,offset:0}:{element:e,offset:t}},i={getSelection:function(){var t;try{t=e.getSelection().getRangeAt(0)}catch(e){return}var n=t.commonAncestorContainer,a={start:l(t.startContainer,t.startOffset),end:l(t.endContainer,t.endOffset),collapsed:t.collapsed};return 3===n.nodeType&&("div"===n.parentNode.nodeName.toLowerCase()&&/^taTextElement/.test(n.parentNode.id)||(n=n.parentNode)),"div"===n.nodeName.toLowerCase()&&/^taTextElement/.test(n.id)?(a.start.element=n.childNodes[a.start.offset],a.end.element=n.childNodes[a.end.offset],a.container=n):n.parentNode===a.start.element||n.parentNode===a.end.element?a.container=n.parentNode:a.container=n,a},updateLeftArrowKey:function(t){var n=e.getSelection().getRangeAt(0);if(n&&n.collapsed){var a=i.getFlattenedDom(n);if(!a.findIndex)return;var o,r,l=n.startContainer,s=a.findIndex((function(e,t){return e.node===l||-1!==e.parents.indexOf(l)}));if(a.forEach((function(e,t){e.parents.forEach((function(e,t){}))})),s+1<a.length&&(o=a[s+1].node),o&&o.textContent&&/^\ufeff([^\ufeff]*)$/.exec(o.textContent))return;if(s>0&&(r=a[s-1].node),0===n.startOffset&&r&&/^\ufeff([^\ufeff]*)$/.exec(r.textContent))return void i.setSelectionToElementEnd(r)}},updateRightArrowKey:function(e){},getFlattenedDom:function(e){var t=e.commonAncestorContainer.parentNode;if(!t)return e.commonAncestorContainer.childNodes;var n=Array.prototype.slice.call(t.childNodes),a=n.indexOf(e.startContainer);return a+1<n.length&&a>0||t.parentNode&&(t=t.parentNode),n=[],function e(t){t.node.childNodes.length?Array.prototype.slice.call(t.node.childNodes).forEach((function(n){var a=t.parents.slice();a.slice(-1)[0]!==t.node&&a.push(t.node),e({parents:a,node:n})})):n.push({parents:t.parents,node:t.node})}({parents:[t],node:t}),n},getOnlySelectedElements:function(){var t=e.getSelection().getRangeAt(0),n=t.commonAncestorContainer;return n=3===n.nodeType?n.parentNode:n,t.getNodes([1],(function(e){return e.parentNode===n}))},getAllSelectedElements:function(){var t=e.getSelection().getRangeAt(0),n=t.commonAncestorContainer;n=3===n.nodeType?n.parentNode:n;var a=t.getNodes([1],(function(e){return e.parentNode===n})),o=n.innerHTML;if((o=o.replace(/<span id=.selectionBoundary[^>]+>\ufeff?<\/span>/gi,""))===t.toHtml()&&("div"!==n.nodeName.toLowerCase()||!/^taTextElement/.test(n.id))){for(var r=[],l=a.length;l--;r.unshift(a[l]));(a=r).push(n)}return a},getSelectionElement:function(){return i.getSelection()?i.getSelection().container:void 0},setSelection:function(t,n,a,o){var r=e.createRange();r.setStart(t,a),r.setEnd(n,o),e.getSelection().setSingleRange(r)},setSelectionBeforeElement:function(t){var n=e.createRange();n.selectNode(t),n.collapse(!0),e.getSelection().setSingleRange(n)},setSelectionAfterElement:function(t){var n=e.createRange();n.selectNode(t),n.collapse(!1),e.getSelection().setSingleRange(n)},setSelectionToElementStart:function(t){var n=e.createRange();n.selectNodeContents(t),n.collapse(!0),e.getSelection().setSingleRange(n)},setSelectionToElementEnd:function(t){var n=e.createRange();n.selectNodeContents(t),n.collapse(!1),t.childNodes&&t.childNodes[t.childNodes.length-1]&&"br"===t.childNodes[t.childNodes.length-1].nodeName&&(n.startOffset=n.endOffset=n.startOffset-1),e.getSelection().setSingleRange(n)},setStateShiftKey:function(e){o=e},getStateShiftKey:function(){return o},insertHtml:function(t,a){var o,l,s,d,u,c,f,g=angular.element("<div>"+t+"</div>"),h=e.getSelection().getRangeAt(0),v=r.createDocumentFragment(),y=g[0].childNodes,b=!0;if(y.length>0){for(d=[],s=0;s<y.length;s++){var x=y[s];"p"===x.nodeName.toLowerCase()&&""===x.innerHTML.trim()||(b=b&&!p.test(x.nodeName),d.push(x))}for(var E=0;E<d.length;E++)c=v.appendChild(d[E]);!b&&h.collapsed&&/^(|<br(|\/)>)$/i.test(h.startContainer.innerHTML)&&h.selectNode(h.startContainer)}else b=!0,c=v=r.createTextNode(t);if(b)h.deleteContents();else if(h.collapsed&&h.startContainer!==a)if(h.startContainer.innerHTML&&h.startContainer.innerHTML.match(/^<[^>]*>$/i))o=h.startContainer,1===h.startOffset?(h.setStartAfter(o),h.setEndAfter(o)):(h.setStartBefore(o),h.setEndBefore(o));else{if(3===h.startContainer.nodeType&&h.startContainer.parentNode!==a)for(l=(o=h.startContainer.parentNode).cloneNode(),n.splitNodes(o.childNodes,o,l,h.startContainer,h.startOffset);!m.test(o.nodeName);){angular.element(o).after(l);var S=l;l=(o=o.parentNode).cloneNode(),n.splitNodes(o.childNodes,o,l,S)}else l=(o=h.startContainer).cloneNode(),n.splitNodes(o.childNodes,o,l,void 0,void 0,h.startOffset);if(angular.element(o).after(l),h.setStartAfter(o),h.setEndAfter(o),/^(|<br(|\/)>)$/i.test(o.innerHTML.trim())&&(h.setStartBefore(o),h.setEndBefore(o),angular.element(o).remove()),/^(|<br(|\/)>)$/i.test(l.innerHTML.trim())&&angular.element(l).remove(),"li"===o.nodeName.toLowerCase()){for(f=r.createDocumentFragment(),u=0;u<v.childNodes.length;u++)g=angular.element("<li>"),n.transferChildNodes(v.childNodes[u],g[0]),n.transferNodeAttributes(v.childNodes[u],g[0]),f.appendChild(g[0]);v=f,c&&(c=(c=v.childNodes[v.childNodes.length-1]).childNodes[c.childNodes.length-1])}}else h.deleteContents();h.insertNode(v),c&&i.setSelectionToElementEnd(c)}};return i}]).service("taDOM",(function(){var e={getByAttribute:function(t,n){var a=[],o=t.children();return o.length&&angular.forEach(o,(function(t){a=a.concat(e.getByAttribute(angular.element(t),n))})),void 0!==t.attr(n)&&a.push(t),a},transferChildNodes:function(e,t){for(t.innerHTML="";e.childNodes.length>0;)t.appendChild(e.childNodes[0]);return t},splitNodes:function(t,n,a,o,r,l){if(!o&&isNaN(l))throw new Error("taDOM.splitNodes requires a splitNode or splitIndex");for(var i=document.createDocumentFragment(),s=document.createDocumentFragment(),d=0;t.length>0&&(isNaN(l)||l!==d)&&t[0]!==o;)i.appendChild(t[0]),d++;for(!isNaN(r)&&r>=0&&t[0]&&(i.appendChild(document.createTextNode(t[0].nodeValue.substring(0,r))),t[0].nodeValue=t[0].nodeValue.substring(r));t.length>0;)s.appendChild(t[0]);e.transferChildNodes(i,n),e.transferChildNodes(s,a)},transferNodeAttributes:function(e,t){for(var n=0;n<e.attributes.length;n++)t.setAttribute(e.attributes[n].name,e.attributes[n].value);return t}};return e})),angular.module("textAngular.validators",[]).directive("taMaxText",(function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){var o=parseInt(e.$eval(n.taMaxText));if(isNaN(o))throw"Max text must be an integer";n.$observe("taMaxText",(function(e){if(o=parseInt(e),isNaN(o))throw"Max text must be an integer";a.$dirty&&a.$validate()})),a.$validators.taMaxText=function(e){var t=angular.element("<div/>");return t.html(e),t.text().length<=o}}}})).directive("taMinText",(function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){var o=parseInt(e.$eval(n.taMinText));if(isNaN(o))throw"Min text must be an integer";n.$observe("taMinText",(function(e){if(o=parseInt(e),isNaN(o))throw"Min text must be an integer";a.$dirty&&a.$validate()})),a.$validators.taMinText=function(e){var t=angular.element("<div/>");return t.html(e),!t.text().length||t.text().length>=o}}}})),angular.module("textAngular.taBind",["textAngular.factories","textAngular.DOM"]).service("_taBlankTest",[function(){return function(e){return!e||""===function(e){var t=document.createElement("DIV");t.innerHTML=e;var n=t.textContent||t.innerText||"";return n.replace("​",""),n=n.trim()}(e)&&!/<img[^>]+>/.test(e)}}]).directive("taButton",[function(){return{link:function(e,t,n){t.attr("unselectable","on"),t.on("mousedown",(function(e,t){return t&&angular.extend(e,t),e.preventDefault(),!1}))}}}]).directive("taBind",["taSanitize","$timeout","$document","taFixChrome","taBrowserTag","taSelection","taSelectableElements","taApplyCustomRenderers","taOptions","_taBlankTest","$parse","taDOM","textAngularManager",function(t,a,o,r,s,d,u,c,f,g,h,y,b){return{priority:2,require:["ngModel","?ngModelOptions"],link:function(s,y,x,E){var S,w,T,C=E[0],N=E[1]||{},L=void 0!==y.attr("contenteditable")&&y.attr("contenteditable"),$=L||"textarea"===y[0].tagName.toLowerCase()||"input"===y[0].tagName.toLowerCase(),k=!1,A=!1,M=!1,H=x.taUnsafeSanitizer||f.disableSanitizer,D=x.taKeepStyles||f.keepStyles,B=/^(9|19|20|27|33|34|35|36|37|38|39|40|45|112|113|114|115|116|117|118|119|120|121|122|123|144|145)$/i,R=/^(8|13|32|46|59|61|107|109|173|186|187|188|189|190|191|192|219|220|221|222)$/i,K=[{specialKey:"UndoKey",forbiddenModifiers:12,mustHaveModifiers:[3],keyCode:90},{specialKey:"RedoKey",forbiddenModifiers:4,mustHaveModifiers:[3,8],keyCode:90},{specialKey:"RedoKey",forbiddenModifiers:12,mustHaveModifiers:[3],keyCode:89},{specialKey:"TabKey",forbiddenModifiers:15,mustHaveModifiers:[],keyCode:9},{specialKey:"ShiftTabKey",forbiddenModifiers:7,mustHaveModifiers:[8],keyCode:9}];void 0===x.taDefaultWrap&&(x.taDefaultWrap="p"),""===x.taDefaultWrap?T="":(T=void 0===n||n>=11?"br"===x.taDefaultWrap.toLowerCase()?"<BR><BR>":"<"+x.taDefaultWrap+"><br></"+x.taDefaultWrap+">":n<=8?"<"+x.taDefaultWrap.toUpperCase()+"></"+x.taDefaultWrap.toUpperCase()+">":"<"+x.taDefaultWrap+"></"+x.taDefaultWrap+">",void 0===n||n>=11?"br"===x.taDefaultWrap.toLowerCase()||(x.taDefaultWrap,x.taDefaultWrap):n<=8?(x.taDefaultWrap.toUpperCase(),x.taDefaultWrap.toUpperCase()):(x.taDefaultWrap,x.taDefaultWrap)),N.$options||(N.$options={});var _,W=function(e){if(g(e))return e;var t=angular.element("<div>"+e+"</div>");if(0===t.children().length)e="<"+x.taDefaultWrap+">"+e+"</"+x.taDefaultWrap+">";else{var n,a=t[0].childNodes,o=!1;for(n=0;n<a.length&&!(o=a[n].nodeName.toLowerCase().match(p));n++);if(o)for(e="",n=0;n<a.length;n++){var r=a[n],l=r.nodeName.toLowerCase();if("#comment"===l)e+="\x3c!--"+r.nodeValue+"--\x3e";else if("#text"===l){var i=r.textContent;i.trim()?e+="<"+x.taDefaultWrap+">"+i+"</"+x.taDefaultWrap+">":e+=i}else if(l.match(p))e+=r.outerHTML;else{var s=r.outerHTML||r.nodeValue;""!==s.trim()?e+="<"+x.taDefaultWrap+">"+s+"</"+x.taDefaultWrap+">":e+=s}}else e="<"+x.taDefaultWrap+">"+e+"</"+x.taDefaultWrap+">"}return e};x.taPaste&&(w=h(x.taPaste)),y.addClass("ta-bind"),s["$undoManager"+(x.id||"")]=C.$undoManager={_stack:[],_index:0,_max:1e3,push:function(e){return null==e||void 0!==this.current()&&null!==this.current()&&e===this.current()||(this._index<this._stack.length-1&&(this._stack=this._stack.slice(0,this._index+1)),this._stack.push(e),_&&a.cancel(_),this._stack.length>this._max&&this._stack.shift(),this._index=this._stack.length-1),e},undo:function(){return this.setToIndex(this._index-1)},redo:function(){return this.setToIndex(this._index+1)},setToIndex:function(e){if(!(e<0||e>this._stack.length-1))return this._index=e,this.current()},current:function(){return this._stack[this._index]}};var z,q=function(){if(L)return y[0].innerHTML;if($)return y.val();throw"textAngular Error: attempting to update non-editable taBind"},O=function(e){return s.$emit("ta-element-select",this),e.preventDefault(),!1},F=s["reApplyOnSelectorHandlers"+(x.id||"")]=function(){k||angular.forEach(u,(function(e){y.find(e).off("click",O).on("click",O)}))},I=function(e,t,n){M=n||!1,null==t&&(t=L),null==e&&(e=q()),g(e)?(""!==C.$viewValue&&C.$setViewValue(""),t&&""!==C.$undoManager.current()&&C.$undoManager.push("")):(F(),C.$viewValue!==e&&(C.$setViewValue(e),t&&C.$undoManager.push(e))),C.$render()},P=function(e){y[0].innerHTML=e},V=s["$undoTaBind"+(x.id||"")]=function(){if(!k&&L){var e=C.$undoManager.undo();null!=e&&(P(e),I(e,!1),z&&a.cancel(z),z=a((function(){y[0].focus(),d.setSelectionToElementEnd(y[0])}),1))}},U=s["$redoTaBind"+(x.id||"")]=function(){if(!k&&L){var e=C.$undoManager.redo();null!=e&&(P(e),I(e,!1),z&&a.cancel(z),z=a((function(){y[0].focus(),d.setSelectionToElementEnd(y[0])}),1))}};s["updateTaBind"+(x.id||"")]=function(){k||I(void 0,void 0,!0)};var j=function(e){return C.$oldViewValue=t(r(e,D),C.$oldViewValue,H)};if(y.attr("required")&&(C.$validators.required=function(e,t){return!g(e||t)}),C.$parsers.push(j),C.$parsers.unshift(W),C.$formatters.push(j),C.$formatters.unshift(W),C.$formatters.unshift((function(e){return C.$undoManager.push(e||"")})),$)if(s.events={},L){var G,J,X=!1,Y=function(e){var n=void 0!==e&&e.match(/content=["']*OneNote.File/i);if(e&&e.trim().length){if(e.match(/class=["']*Mso(Normal|List)/i)||e.match(/content=["']*Word.Document/i)||e.match(/content=["']*OneNote.File/i)){var o=e.match(/<!--StartFragment-->([\s\S]*?)<!--EndFragment-->/i);o=(o=o?o[1]:e).replace(/<o:p>[\s\S]*?<\/o:p>/gi,"").replace(/class=(["']|)MsoNormal(["']|)/gi,"");var r=angular.element("<div>"+o+"</div>"),l=angular.element("<div></div>"),i={element:null,lastIndent:[],lastLi:null,isUl:!1};i.lastIndent.peek=function(){var e=this.length;if(e>0)return this[e-1]};for(var u=function(e){i.isUl=e,i.element=angular.element(e?"<ul>":"<ol>"),i.lastIndent=[],i.lastIndent.peek=function(){var e=this.length;if(e>0)return this[e-1]},i.lastLevelMatch=null},c=0;c<=r[0].childNodes.length;c++)if(r[0].childNodes[c]&&"#text"!==r[0].childNodes[c].nodeName){var p=r[0].childNodes[c].tagName.toLowerCase();if("p"===p||"ul"===p||"h1"===p||"h2"===p||"h3"===p||"h4"===p||"h5"===p||"h6"===p||"table"===p){var f=angular.element(r[0].childNodes[c]),m=(f.attr("class")||"").match(/MsoList(Bullet|Number|Paragraph)(CxSp(First|Middle|Last)|)/i);if(m){if(f[0].childNodes.length<2||f[0].childNodes[1].childNodes.length<1)continue;var g="bullet"===m[1].toLowerCase()||"number"!==m[1].toLowerCase()&&!(/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(f[0].childNodes[1].innerHTML)||/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(f[0].childNodes[1].childNodes[0].innerHTML)),h=(f.attr("style")||"").match(/margin-left:([\-\.0-9]*)/i),v=parseFloat(h?h[1]:0),b=(f.attr("style")||"").match(/mso-list:l([0-9]+) level([0-9]+) lfo[0-9+]($|;)/i);if(b&&b[2]&&(v=parseInt(b[2])),b&&(!i.lastLevelMatch||b[1]!==i.lastLevelMatch[1])||!m[3]||"first"===m[3].toLowerCase()||null===i.lastIndent.peek()||i.isUl!==g&&i.lastIndent.peek()===v)u(g),l.append(i.element);else if(null!=i.lastIndent.peek()&&i.lastIndent.peek()<v)i.element=angular.element(g?"<ul>":"<ol>"),i.lastLi.append(i.element);else if(null!=i.lastIndent.peek()&&i.lastIndent.peek()>v){for(;null!=i.lastIndent.peek()&&i.lastIndent.peek()>v;)if("li"!==i.element.parent()[0].tagName.toLowerCase()){if(!/[uo]l/i.test(i.element.parent()[0].tagName.toLowerCase()))break;i.element=i.element.parent(),i.lastIndent.pop()}else i.element=i.element.parent();i.isUl="ul"===i.element[0].tagName.toLowerCase(),g!==i.isUl&&(u(g),l.append(i.element))}i.lastLevelMatch=b,v!==i.lastIndent.peek()&&i.lastIndent.push(v),i.lastLi=angular.element("<li>"),i.element.append(i.lastLi),i.lastLi.html(f.html().replace(/<!(--|)\[if !supportLists\](--|)>[\s\S]*?<!(--|)\[endif\](--|)>/gi,"")),f.remove()}else u(!1),l.append(f)}}var x=function(e){for(var t=(e=angular.element(e))[0].childNodes.length-1;t>=0;t--)e.after(e[0].childNodes[t]);e.remove()};angular.forEach(l.find("span"),(function(e){e.removeAttribute("lang"),e.attributes.length<=0&&x(e)})),angular.forEach(l.find("font"),x),e=l.html(),n&&(e=l.html()||r.html()),e=e.replace(/\n/g," ")}else{if((e=e.replace(/<(|\/)meta[^>]*?>/gi,"")).match(/<[^>]*?(ta-bind)[^>]*?>/)){if(e.match(/<[^>]*?(text-angular)[^>]*?>/)){var E=angular.element("<div>"+e+"</div>");E.find("textarea").remove();for(var S=0;S<binds.length;S++){for(var T=binds[S][0].parentNode.parentNode,N=0;N<binds[S][0].childNodes.length;N++)T.parentNode.insertBefore(binds[S][0].childNodes[N],T);T.parentNode.removeChild(T)}e=E.html().replace('<br class="Apple-interchange-newline">',"")}}else e.match(/^<span/)&&(e.match(/<span class=(\"Apple-converted-space\"|\'Apple-converted-space\')>.<\/span>/gi)||(e=e.replace(/<(|\/)span[^>]*?>/gi,"")));e=e.replace(/<br class="Apple-interchange-newline"[^>]*?>/gi,"").replace(/<span class="Apple-converted-space">( |&nbsp;)<\/span>/gi,"&nbsp;")}/<li(\s.*)?>/i.test(e)&&!1===/(<ul(\s.*)?>|<ol(\s.*)?>).*<li(\s.*)?>/i.test(e)&&(e=e.replace(/<li(\s.*)?>.*<\/li(\s.*)?>/i,"<ul>$&</ul>")),e=e.replace(/^[ |\u00A0]+/gm,(function(e){for(var t="",n=0;n<e.length;n++)t+="&nbsp;";return t})).replace(/\n|\r\n|\r/g,"<br />").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;"),w&&(e=w(s,{$html:e})||e),e=e.replace(/<span style=("|')([^<]*?)vertical-align\s*:\s*super;?([^>]*?)("|')>([^<]+?)<\/span>/g,"<sup style='$2$3'>$5</sup>"),e=t(e,"",H),d.insertHtml(e,y[0]),a((function(){C.$setViewValue(q()),X=!1,y.removeClass("processing-paste")}),0)}else X=!1,y.removeClass("processing-paste")};if(y.on("paste",s.events.paste=function(t,n){if(n&&angular.extend(t,n),k||X)return t.stopPropagation(),t.preventDefault(),!1;var r;X=!0,y.addClass("processing-paste");var l=(t.originalEvent||t).clipboardData;if(!l&&window.clipboardData&&window.clipboardData.getData)return r=window.clipboardData.getData("Text"),Y(r),t.stopPropagation(),t.preventDefault(),!1;if(l&&l.getData&&l.types.length>0){for(var i="",s=0;s<l.types.length;s++)i+=" "+l.types[s];return/text\/html/i.test(i)?r=l.getData("text/html"):/text\/plain/i.test(i)&&(r=l.getData("text/plain")),Y(r),t.stopPropagation(),t.preventDefault(),!1}var d=e.saveSelection(),u=angular.element('<div class="ta-hidden-input" contenteditable="true"></div>');o.find("body").append(u),u[0].focus(),a((function(){e.restoreSelection(d),Y(u[0].innerHTML),y[0].focus(),u.remove()}),0)}),y.on("cut",s.events.cut=function(e){k?e.preventDefault():a((function(){C.$setViewValue(q())}),0)}),y.on("keydown",s.events.keydown=function(e,t){var n;if(t&&angular.extend(e,t),16===e.keyCode?d.setStateShiftKey(!0):d.setStateShiftKey(!1),e.specialKey=function(e){var t;return K.forEach((function(n){if(n.keyCode===e.keyCode){var a=(e.metaKey?2:0)+(e.ctrlKey?1:0)+(e.shiftKey?8:0)+(e.altKey?4:0);if(n.forbiddenModifiers&a)return;n.mustHaveModifiers.every((function(e){return a&e}))&&(t=n.specialKey)}})),t}(e),f.keyMappings.forEach((function(t){e.specialKey===t.commandKeyCode&&(e.specialKey=void 0),t.testForKey(e)&&(n=t.commandKeyCode),"UndoKey"!==t.commandKeyCode&&"RedoKey"!==t.commandKeyCode||t.enablePropagation||e.preventDefault()})),void 0!==n&&(e.specialKey=n),void 0===e.specialKey||"UndoKey"===e.specialKey&&"RedoKey"===e.specialKey||(e.preventDefault(),b.sendKeyCommand(s,e)),!(k||("UndoKey"===e.specialKey&&(V(),e.preventDefault()),"RedoKey"===e.specialKey&&(U(),e.preventDefault()),13!==e.keyCode||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey))){var a,o=d.getSelectionElement();if(!o.nodeName.match(m))return;var r=angular.element(T);if(function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}(["blockquote","ul","ol"],o.parentNode.tagName.toLowerCase())){if(/^<br(|\/)>$/i.test(o.innerHTML.trim())&&!o.nextSibling){var l=(a=angular.element(o)).parent();l.after(r),a.remove(),0===l.children().length&&l.remove(),d.setSelectionToElementStart(r[0]),e.preventDefault()}/^<[^>]+><br(|\/)><\/[^>]+>$/i.test(o.innerHTML.trim())&&((a=angular.element(o)).after(r),a.remove(),d.setSelectionToElementStart(r[0]),e.preventDefault())}}}),y.on("keyup",s.events.keyup=function(e,t){if(t&&angular.extend(e,t),d.setStateShiftKey(!1),9!==e.keyCode){if(37!==e.keyCode||e.shiftKey||d.updateLeftArrowKey(y),39!==e.keyCode||e.shiftKey||d.updateRightArrowKey(y),_&&a.cancel(_),!k&&!B.test(e.keyCode))if(13===e.keyCode&&(e.ctrlKey||e.metaKey||e.altKey));else{if(""!==T&&"<BR><BR>"!==T&&13===e.keyCode&&!e.ctrlKey&&!e.metaKey&&!e.altKey){for(var n=d.getSelectionElement();!n.nodeName.match(m)&&n!==y[0];)n=n.parentNode;if(e.shiftKey){var o=n.tagName.toLowerCase();if((o===x.taDefaultWrap||"li"===o||"pre"===o||"div"===o)&&!/.+<br><br>/.test(n.innerHTML.trim())){var r=n.previousSibling;r&&(r.innerHTML=r.innerHTML+"<br><br>",angular.element(n).remove(),d.setSelectionToElementEnd(r))}}else if(n.tagName.toLowerCase()!==x.taDefaultWrap&&"li"!==n.nodeName.toLowerCase()&&(""===n.innerHTML.trim()||"<br>"===n.innerHTML.trim())){var l=angular.element(T);angular.element(n).replaceWith(l),d.setSelectionToElementStart(l[0])}}var i=q();""===T||""!==i.trim()&&"<br>"!==i.trim()?"<"!==i.substring(0,1)&&x.taDefaultWrap:(P(T),d.setSelectionToElementStart(y.children()[0]));var s=S!==e.keyCode&&R.test(e.keyCode);G&&a.cancel(G),G=a((function(){I(i,s,!0)}),N.$options.debounce||400),s||(_=a((function(){C.$undoManager.push(i)}),250)),S=e.keyCode}}else d.getSelection().start.element===y[0]&&y.children().length&&d.setSelectionToElementStart(y.children()[0])}),y.on("input",(function(){q()!==C.$viewValue&&(J&&a.cancel(J),J=a((function(){var t=e.saveSelection(),n=q();n!==C.$viewValue&&I(n,!0),0!==C.$viewValue.length&&e.restoreSelection(t)}),1e3))})),y.on("blur",s.events.blur=function(){A=!1,k?(M=!0,C.$render()):I(void 0,void 0,!0)}),x.placeholder&&(n>8||void 0===n)){var Q;if(!x.id)throw"textAngular Error: An unique ID is required for placeholders to work";Q=l("#"+x.id+".placeholder-text:before",'content: "'+x.placeholder+'"'),s.$on("$destroy",(function(){i(Q)}))}y.on("focus",s.events.focus=function(){A=!0,y.removeClass("placeholder-text"),F()}),y.on("mouseup",s.events.mouseup=function(){var e=d.getSelection();e&&e.start.element===y[0]&&y.children().length&&d.setSelectionToElementStart(y.children()[0])}),y.on("mousedown",s.events.mousedown=function(e,t){t&&angular.extend(e,t),e.stopPropagation()})}else{y.on("change blur",s.events.change=s.events.blur=function(){k||C.$setViewValue(q())}),y.on("keydown",s.events.keydown=function(e,t){if(t&&angular.extend(e,t),9===e.keyCode){var n=this.selectionStart,a=this.selectionEnd,o=y.val();if(e.shiftKey){var r=o.lastIndexOf("\n",n),l=o.lastIndexOf("\t",n);-1!==l&&l>=r&&(y.val(o.substring(0,l)+o.substring(l+1)),this.selectionStart=this.selectionEnd=n-1)}else y.val(o.substring(0,n)+"\t"+o.substring(a)),this.selectionStart=this.selectionEnd=n+1;e.preventDefault()}});var Z=function(e,t){for(var n="",a=0;a<t;a++)n+=e;return n},ee=function(e,t,n){for(var a=0;a<e.length;a++)t.call(n,a,e[a])},te=function(e,t){var n="",a=e.childNodes;return t++,n+=Z("\t",t-1)+e.outerHTML.substring(0,4),ee(a,(function(e,a){var o=a.nodeName.toLowerCase();"#comment"!==o?"#text"!==o?a.outerHTML&&(n+="ul"===o||"ol"===o?"\n"+te(a,t):"\n"+Z("\t",t)+a.outerHTML):n+=a.textContent:n+="\x3c!--"+a.nodeValue+"--\x3e"})),n+="\n"+Z("\t",t-1)+e.outerHTML.substring(e.outerHTML.lastIndexOf("<"))};C.$formatters.unshift((function(e){var t=angular.element("<div>"+e+"</div>")[0].childNodes;return t.length>0&&(e="",ee(t,(function(t,n){var a=n.nodeName.toLowerCase();"#comment"!==a?"#text"!==a?n.outerHTML&&(e.length>0&&(e+="\n"),e+="ul"===a||"ol"===a?""+te(n,0):""+n.outerHTML):e+=n.textContent:e+="\x3c!--"+n.nodeValue+"--\x3e"}))),e}))}var ne,ae=function(e,t){var n;t&&angular.extend(e,t),v||k||(v=!0,n=e.originalEvent?e.originalEvent.dataTransfer:e.dataTransfer,s.$emit("ta-drop-event",this,e,n),a((function(){v=!1,I(void 0,void 0,!0)}),100))},oe=!1;C.$render=function(){if(!oe){oe=!0;var e=C.$viewValue||"";M||(L&&A&&(y.removeClass("placeholder-text"),ne&&a.cancel(ne),ne=a((function(){A||(y[0].focus(),d.setSelectionToElementEnd(y.children()[y.children().length-1])),ne=void 0}),1)),L?(x.placeholder,P(""===e?T:e),k?y.off("drop",ae):(F(),y.on("drop",ae))):"textarea"!==y[0].tagName.toLowerCase()&&"input"!==y[0].tagName.toLowerCase()?P(c(e)):y.val(e)),L&&x.placeholder&&(""===e?A?y.removeClass("placeholder-text"):y.addClass("placeholder-text"):y.removeClass("placeholder-text")),oe=M=!1}},x.taReadonly&&((k=s.$eval(x.taReadonly))?(y.addClass("ta-readonly"),"textarea"!==y[0].tagName.toLowerCase()&&"input"!==y[0].tagName.toLowerCase()||y.attr("disabled","disabled"),void 0!==y.attr("contenteditable")&&y.attr("contenteditable")&&y.removeAttr("contenteditable")):(y.removeClass("ta-readonly"),"textarea"===y[0].tagName.toLowerCase()||"input"===y[0].tagName.toLowerCase()?y.removeAttr("disabled"):L&&y.attr("contenteditable","true")),s.$watch(x.taReadonly,(function(e,t){t!==e&&(e?(y.addClass("ta-readonly"),"textarea"!==y[0].tagName.toLowerCase()&&"input"!==y[0].tagName.toLowerCase()||y.attr("disabled","disabled"),void 0!==y.attr("contenteditable")&&y.attr("contenteditable")&&y.removeAttr("contenteditable"),angular.forEach(u,(function(e){y.find(e).on("click",O)})),y.off("drop",ae)):(y.removeClass("ta-readonly"),"textarea"===y[0].tagName.toLowerCase()||"input"===y[0].tagName.toLowerCase()?y.removeAttr("disabled"):L&&y.attr("contenteditable","true"),angular.forEach(u,(function(e){y.find(e).off("click",O)})),y.on("drop",ae)),k=e)}))),L&&!k&&(angular.forEach(u,(function(e){y.find(e).on("click",O)})),y.on("drop",ae))}}}]);var v=!1,y=angular.module("textAngular",["ngSanitize","textAngularSetup","textAngular.factories","textAngular.DOM","textAngular.validators","textAngular.taBind"]);return y.config([function(){angular.forEach(t,(function(e,n){delete t[n]}))}]),y.directive("textAngular",["$compile","$timeout","taOptions","taSelection","taExecCommand","textAngularManager","$document","$animate","$log","$q","$parse",function(t,n,a,o,r,l,i,s,d,u,c){return{require:"?ngModel",scope:{},restrict:"EA",priority:2,link:function(p,f,m,g){var h,v,y,b,x,E,S,w,T,C,N,L,$=m.serial?m.serial:Math.floor(1e16*Math.random());p._name=m.name?m.name:"textAngularEditor"+$;var k=function(e,t,a){n((function(){e.one(t,a)}),100)};if(T=r(m.taDefaultWrap),angular.extend(p,angular.copy(a),{wrapSelection:function(e,t,n){"undo"===e.toLowerCase()?p["$undoTaBindtaTextElement"+$]():"redo"===e.toLowerCase()?p["$redoTaBindtaTextElement"+$]():(T(e,!1,t,p.defaultTagAttributes),n&&p["reApplyOnSelectorHandlerstaTextElement"+$](),p.displayElements.text[0].focus())},showHtml:p.$eval(m.taShowHtml)||!1}),m.taFocussedClass&&(p.classes.focussed=m.taFocussedClass),m.taTextEditorClass&&(p.classes.textEditor=m.taTextEditorClass),m.taHtmlEditorClass&&(p.classes.htmlEditor=m.taHtmlEditorClass),m.taDefaultTagAttributes)try{angular.extend(p.defaultTagAttributes,angular.fromJson(m.taDefaultTagAttributes))}catch(e){d.error(e)}m.taTextEditorSetup&&(p.setup.textEditorSetup=p.$parent.$eval(m.taTextEditorSetup)),m.taHtmlEditorSetup&&(p.setup.htmlEditorSetup=p.$parent.$eval(m.taHtmlEditorSetup)),m.taFileDrop?p.fileDropHandler=p.$parent.$eval(m.taFileDrop):p.fileDropHandler=p.defaultFileDropHandler,S=f[0].innerHTML,f[0].innerHTML="",p.displayElements={forminput:angular.element("<input type='hidden' tabindex='-1' style='display: none;'>"),html:angular.element("<textarea></textarea>"),text:angular.element("<div></div>"),scrollWindow:angular.element("<div class='ta-scroll-window'></div>"),popover:angular.element('<div class="popover fade bottom" style="max-width: none; width: 305px;"></div>'),popoverArrow:angular.element('<div class="arrow"></div>'),popoverContainer:angular.element('<div class="popover-content"></div>'),resize:{overlay:angular.element('<div class="ta-resizer-handle-overlay"></div>'),background:angular.element('<div class="ta-resizer-handle-background"></div>'),anchors:[angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tr"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-bl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-br"></div>')],info:angular.element('<div class="ta-resizer-handle-info"></div>')}},p.displayElements.popover.append(p.displayElements.popoverArrow),p.displayElements.popover.append(p.displayElements.popoverContainer),p.displayElements.scrollWindow.append(p.displayElements.popover),p.displayElements.popover.on("mousedown",(function(e,t){return t&&angular.extend(e,t),e.preventDefault(),!1})),p.handlePopoverEvents=function(){"block"===p.displayElements.popover.css("display")&&(L&&n.cancel(L),L=n((function(){p.reflowPopover(p.resizeElement),p.reflowResizeOverlay(p.resizeElement)}),100))},angular.element(window).on("resize",p.handlePopoverEvents),angular.element(window).on("scroll",p.handlePopoverEvents),p.getScrollTop=function(e,t){var n=e.scrollTop;return void 0===n&&(n=0),t&&function(e){var t,n={vertical:!1,horizontal:!1};try{if(null===(t=window.getComputedStyle(e)))return n}catch(e){return n}var a=t["overflow-y"],o=t["overflow-x"];return{vertical:("scroll"===a||"auto"===a)&&e.scrollHeight>e.clientHeight,horizontal:("scroll"===o||"auto"===o)&&e.scrollWidth>e.clientWidth}}(e).vertical&&(e.removeEventListener("scroll",p._scrollListener,!1),e.addEventListener("scroll",p._scrollListener,!1)),0!==n?{node:e.nodeName,top:n}:e.parentNode?p.getScrollTop(e.parentNode,t):{node:"<none>",top:0}},p.showPopover=function(e){p.getScrollTop(p.displayElements.scrollWindow[0],!0),p.displayElements.popover.css("display","block"),n((function(){p.displayElements.resize.overlay.css("display","block")})),p.resizeElement=e,p.reflowPopover(e),s.addClass(p.displayElements.popover,"in"),k(i.find("body"),"click keyup",(function(){p.hidePopover()}))},p._scrollListener=function(e,t){p.handlePopoverEvents()},p.reflowPopover=function(e){var t=p.getScrollTop(p.displayElements.scrollWindow[0],!1);e[0].offsetTop-t.top<51?(p.displayElements.popover.css("top",e[0].offsetTop+e[0].offsetHeight+p.displayElements.scrollWindow[0].scrollTop+"px"),p.displayElements.popover.removeClass("top").addClass("bottom")):(p.displayElements.popover.css("top",e[0].offsetTop-54+p.displayElements.scrollWindow[0].scrollTop+"px"),p.displayElements.popover.removeClass("bottom").addClass("top"));var n=p.displayElements.text[0].offsetWidth-p.displayElements.popover[0].offsetWidth,a=e[0].offsetLeft+e[0].offsetWidth/2-p.displayElements.popover[0].offsetWidth/2,o=Math.max(0,Math.min(n,a)),r=Math.min(a,Math.max(0,a-n))-11;o+=window.scrollX,r-=window.scrollX,p.displayElements.popover.css("left",o+"px"),p.displayElements.popoverArrow.css("margin-left",r+"px")},p.hidePopover=function(){p.displayElements.popover.css("display","none"),p.displayElements.popoverContainer.attr("style",""),p.displayElements.popoverContainer.attr("class","popover-content"),p.displayElements.popover.removeClass("in"),p.displayElements.resize.overlay.css("display","none")},p.displayElements.resize.overlay.append(p.displayElements.resize.background),angular.forEach(p.displayElements.resize.anchors,(function(e){p.displayElements.resize.overlay.append(e)})),p.displayElements.resize.overlay.append(p.displayElements.resize.info),p.displayElements.scrollWindow.append(p.displayElements.resize.overlay),p.displayElements.resize.background.on("click",(function(e){p.displayElements.text[0].focus()})),p.reflowResizeOverlay=function(e){e=angular.element(e)[0],p.displayElements.resize.overlay.css({display:"block",left:e.offsetLeft-5+"px",top:e.offsetTop-5+"px",width:e.offsetWidth+10+"px",height:e.offsetHeight+10+"px"}),p.displayElements.resize.info.text(e.offsetWidth+" x "+e.offsetHeight)},p.showResizeOverlay=function(e){var t=i.find("body");C=function(n){var a={width:parseInt(e.attr("width")),height:parseInt(e.attr("height")),x:n.clientX,y:n.clientY};(void 0===a.width||isNaN(a.width))&&(a.width=e[0].offsetWidth),(void 0===a.height||isNaN(a.height))&&(a.height=e[0].offsetHeight),p.hidePopover();var o=a.height/a.width,r=function(t){var n={x:Math.max(0,a.width+(t.clientX-a.x)),y:Math.max(0,a.height+(t.clientY-a.y))},r=void 0!==m.taResizeForceAspectRatio,l=m.taResizeMaintainAspectRatio;if(r||l&&!t.shiftKey){var i=n.y/n.x;n.x=o>i?n.x:n.y/o,n.y=o>i?n.x*o:n.y}var s=angular.element(e);function d(e){return Math.round(Math.max(0,e))}s.css("height",d(n.y)+"px"),s.css("width",d(n.x)+"px"),p.reflowResizeOverlay(e)};t.on("mousemove",r),k(t,"mouseup",(function(e){e.preventDefault(),e.stopPropagation(),t.off("mousemove",r),p.$apply((function(){p.hidePopover(),p.updateTaBindtaTextElement()}),100)})),n.stopPropagation(),n.preventDefault()},p.displayElements.resize.anchors[3].off("mousedown"),p.displayElements.resize.anchors[3].on("mousedown",C),p.reflowResizeOverlay(e),k(t,"click",(function(){p.hideResizeOverlay()}))},p.hideResizeOverlay=function(){p.displayElements.resize.anchors[3].off("mousedown",C),p.displayElements.resize.overlay.css("display","none")},p.setup.htmlEditorSetup(p.displayElements.html),p.setup.textEditorSetup(p.displayElements.text),p.displayElements.html.attr({id:"taHtmlElement"+$,"ng-show":"showHtml","ta-bind":"ta-bind","ng-model":"html","ng-model-options":f.attr("ng-model-options")}),p.displayElements.text.attr({id:"taTextElement"+$,contentEditable:"true","ta-bind":"ta-bind","ng-model":"html","ng-model-options":f.attr("ng-model-options")}),p.displayElements.scrollWindow.attr({"ng-hide":"showHtml"}),m.taDefaultWrap&&p.displayElements.text.attr("ta-default-wrap",m.taDefaultWrap),m.taUnsafeSanitizer&&(p.displayElements.text.attr("ta-unsafe-sanitizer",m.taUnsafeSanitizer),p.displayElements.html.attr("ta-unsafe-sanitizer",m.taUnsafeSanitizer)),m.taKeepStyles&&(p.displayElements.text.attr("ta-keep-styles",m.taKeepStyles),p.displayElements.html.attr("ta-keep-styles",m.taKeepStyles)),p.displayElements.scrollWindow.append(p.displayElements.text),f.append(p.displayElements.scrollWindow),f.append(p.displayElements.html),p.displayElements.forminput.attr("name",p._name),f.append(p.displayElements.forminput),m.tabindex&&(f.removeAttr("tabindex"),p.displayElements.text.attr("tabindex",m.tabindex),p.displayElements.html.attr("tabindex",m.tabindex)),m.placeholder&&(p.displayElements.text.attr("placeholder",m.placeholder),p.displayElements.html.attr("placeholder",m.placeholder)),m.taDisabled&&(p.displayElements.text.attr("ta-readonly","disabled"),p.displayElements.html.attr("ta-readonly","disabled"),p.disabled=p.$parent.$eval(m.taDisabled),p.$parent.$watch(m.taDisabled,(function(e){p.disabled=e,p.disabled?f.addClass(p.classes.disabled):f.removeClass(p.classes.disabled)}))),m.taPaste&&(p._pasteHandler=function(e){return c(m.taPaste)(p.$parent,{$html:e})},p.displayElements.text.attr("ta-paste","_pasteHandler($html)")),t(p.displayElements.scrollWindow)(p),t(p.displayElements.html)(p),p.updateTaBindtaTextElement=p["updateTaBindtaTextElement"+$],p.updateTaBindtaHtmlElement=p["updateTaBindtaHtmlElement"+$],f.addClass("ta-root"),p.displayElements.scrollWindow.addClass("ta-text ta-editor "+p.classes.textEditor),p.displayElements.html.addClass("ta-html ta-editor "+p.classes.htmlEditor);var A=function(e,t){t!==i[0].queryCommandState(e)&&i[0].execCommand(e,!1,null)};p._actionRunning=!1;var M=!1;if(p.startAction=function(){var t,n,a,o;return p._actionRunning=!0,t=i[0].queryCommandState("bold"),n=i[0].queryCommandState("italic"),a=i[0].queryCommandState("underline"),o=i[0].queryCommandState("strikeThrough"),M=e.saveSelection(),A("bold",t),A("italic",n),A("underline",a),A("strikeThrough",o),function(){M&&e.restoreSelection(M)}},p.endAction=function(){p._actionRunning=!1,M&&(p.showHtml?p.displayElements.html[0].focus():p.displayElements.text[0].focus(),e.removeMarkers(M)),M=!1,p.updateSelectedStyles(),p.showHtml||p["updateTaBindtaTextElement"+$]()},x=function(e){p.focussed=!0,f.addClass(p.classes.focussed),w.focus(),f.triggerHandler("focus"),p.updateSelectedStyles&&!p._bUpdateSelectedStyles&&n((function(){p.updateSelectedStyles()}),0)},p.displayElements.html.on("focus",x),p.displayElements.text.on("focus",x),E=function(e){return p._actionRunning||i[0].activeElement===p.displayElements.html[0]||i[0].activeElement===p.displayElements.text[0]||(f.removeClass(p.classes.focussed),w.unfocus(),n((function(){p._bUpdateSelectedStyles=!1,f.triggerHandler("blur"),p.focussed=!1}),0)),e.preventDefault(),!1},p.displayElements.html.on("blur",E),p.displayElements.text.on("blur",E),p.displayElements.text.on("paste",(function(e){f.triggerHandler("paste",e)})),p.queryFormatBlockState=function(e){return!p.showHtml&&e.toLowerCase()===i[0].queryCommandValue("formatBlock").toLowerCase()},p.queryCommandState=function(e){return p.showHtml?"":i[0].queryCommandState(e)},p.switchView=function(){p.showHtml=!p.showHtml,s.enabled(!1,p.displayElements.html),s.enabled(!1,p.displayElements.text),p.showHtml?n((function(){return s.enabled(!0,p.displayElements.html),s.enabled(!0,p.displayElements.text),p.displayElements.html[0].focus()}),100):n((function(){return s.enabled(!0,p.displayElements.html),s.enabled(!0,p.displayElements.text),p.displayElements.text[0].focus()}),100)},m.ngModel){var H=!0;g.$render=function(){if(H){H=!1;var e=p.$parent.$eval(m.ngModel);null==e&&S&&""!==S&&g.$setViewValue(S)}p.displayElements.forminput.val(g.$viewValue),p.html=g.$viewValue||""},f.attr("required")&&(g.$validators.required=function(e,t){var n=e||t;return!(!n||""===n.trim())})}else p.displayElements.forminput.val(S),p.html=S;if(p.$watch("html",(function(e,t){e!==t&&(m.ngModel&&g.$viewValue!==e&&g.$setViewValue(e),p.displayElements.forminput.val(e))})),m.taTargetToolbars)w=l.registerEditor(p._name,p,m.taTargetToolbars.split(","));else{var D=angular.element('<div text-angular-toolbar name="textAngularToolbar'+$+'">');m.taToolbar&&D.attr("ta-toolbar",m.taToolbar),m.taToolbarClass&&D.attr("ta-toolbar-class",m.taToolbarClass),m.taToolbarGroupClass&&D.attr("ta-toolbar-group-class",m.taToolbarGroupClass),m.taToolbarButtonClass&&D.attr("ta-toolbar-button-class",m.taToolbarButtonClass),m.taToolbarActiveButtonClass&&D.attr("ta-toolbar-active-button-class",m.taToolbarActiveButtonClass),m.taFocussedClass&&D.attr("ta-focussed-class",m.taFocussedClass),f.prepend(D),t(D)(p.$parent),w=l.registerEditor(p._name,p,["textAngularToolbar"+$])}p.$on("$destroy",(function(){l.unregisterEditor(p._name),angular.element(window).off("blur"),angular.element(window).off("resize",p.handlePopoverEvents),angular.element(window).off("scroll",p.handlePopoverEvents)})),p.$on("ta-element-select",(function(e,t){w.triggerElementSelect(e,t)&&p["reApplyOnSelectorHandlerstaTextElement"+$]()})),p.$on("ta-drop-event",(function(e,t,a,r){r&&r.files&&r.files.length>0?(p.displayElements.text[0].focus(),o.setSelectionToElementEnd(a.target),angular.forEach(r.files,(function(e){try{u.when(p.fileDropHandler(e,p.wrapSelection)||p.fileDropHandler!==p.defaultFileDropHandler&&u.when(p.defaultFileDropHandler(e,p.wrapSelection))).then((function(){p["updateTaBindtaTextElement"+$]()}))}catch(e){d.error(e)}})),a.preventDefault(),a.stopPropagation()):n((function(){p["updateTaBindtaTextElement"+$]()}),0)})),p._bUpdateSelectedStyles=!1,angular.element(window).on("blur",(function(){p._bUpdateSelectedStyles=!1,p.focussed=!1})),p.updateSelectedStyles=function(){var e;N&&n.cancel(N),void 0!==(e=o.getSelectionElement())&&e.parentNode!==p.displayElements.text[0]?w.updateSelectedStyles(angular.element(e)):w.updateSelectedStyles(),p._bUpdateSelectedStyles&&(N=n(p.updateSelectedStyles,200))},h=function(){p.focussed?p._bUpdateSelectedStyles||(p._bUpdateSelectedStyles=!0,p.$apply((function(){p.updateSelectedStyles()}))):p._bUpdateSelectedStyles=!1},p.displayElements.html.on("keydown",h),p.displayElements.text.on("keydown",h),v=function(){p._bUpdateSelectedStyles=!1},p.displayElements.html.on("keyup",v),p.displayElements.text.on("keyup",v),y=function(e,t){if(o.getSelection){var n=o.getSelection();o.getSelectionElement()&&"a"===o.getSelectionElement().nodeName.toLowerCase()&&(3===n.start.element.nodeType&&n.start.element.textContent.length===n.end.offset&&o.setSelectionAfterElement(o.getSelectionElement()),3===n.start.element.nodeType&&0===n.start.offset&&o.setSelectionBeforeElement(o.getSelectionElement()))}t&&angular.extend(e,t),p.$apply((function(){if(w.sendKeyCommand(e))return p._bUpdateSelectedStyles||p.updateSelectedStyles(),e.preventDefault(),!1}))},p.displayElements.html.on("keypress",y),p.displayElements.text.on("keypress",y),b=function(){p._bUpdateSelectedStyles=!1,n((function(){p.updateSelectedStyles()}),0)},p.displayElements.html.on("mouseup",b),p.displayElements.text.on("mouseup",b)}}}]),y.service("textAngularManager",["taToolExecuteAction","taTools","taRegisterTool","$interval","$rootScope","$log",function(e,t,n,a,o,r){var l,i={},s={},d=0,u=function(e){angular.forEach(s,(function(t){t.editorFunctions.updateSelectedStyles(e)}))};o.$on("destroy",(function(){l&&(a.cancel(l),l=void 0)}));var c=function(){Math.abs(Date.now()-d)>50&&(d=Date.now(),l=a((function(){u(),l=void 0}),50,1))};return{registerEditor:function(n,a,o){if(!n||""===n)throw"textAngular Error: An editor requires a name";if(!a)throw"textAngular Error: An editor requires a scope";if(s[n])throw'textAngular Error: An Editor with name "'+n+'" already exists';return s[n]={scope:a,toolbars:o,toolbarScopes:[],_registerToolbarScope:function(e){this.toolbars.indexOf(e.name)>=0&&this.toolbarScopes.push(e)},editorFunctions:{disable:function(){angular.forEach(s[n].toolbarScopes,(function(e){e.disabled=!0}))},enable:function(){angular.forEach(s[n].toolbarScopes,(function(e){e.disabled=!1}))},focus:function(){angular.forEach(s[n].toolbarScopes,(function(e){e._parent=a,e.disabled=!1,e.focussed=!0})),a.focussed=!0},unfocus:function(){angular.forEach(s[n].toolbarScopes,(function(e){e.disabled=!0,e.focussed=!1})),a.focussed=!1},updateSelectedStyles:function(e){angular.forEach(s[n].toolbarScopes,(function(t){angular.forEach(t.tools,(function(n){n.activeState&&(t._parent=a,n.active=n.activeState(e))}))}))},sendKeyCommand:function(o){var r=!1;return(o.ctrlKey||o.metaKey||o.specialKey)&&angular.forEach(t,(function(t,l){if(t.commandKeyCode&&(t.commandKeyCode===o.which||t.commandKeyCode===o.specialKey))for(var i=0;i<s[n].toolbarScopes.length;i++)if(void 0!==s[n].toolbarScopes[i].tools[l]){e.call(s[n].toolbarScopes[i].tools[l],a),r=!0;break}})),r},triggerElementSelect:function(e,o){var r=function(e,t){for(var n=!0,a=0;a<t.length;a++)n=n&&e.attr(t[a]);return n},l=[],i={},d=!1;o=angular.element(o);var u=!1;if(angular.forEach(t,(function(e,t){e.onElementSelect&&e.onElementSelect.element&&e.onElementSelect.element.toLowerCase()===o[0].tagName.toLowerCase()&&(!e.onElementSelect.filter||e.onElementSelect.filter(o))&&(u=u||angular.isArray(e.onElementSelect.onlyWithAttrs)&&r(o,e.onElementSelect.onlyWithAttrs),e.onElementSelect.onlyWithAttrs&&!r(o,e.onElementSelect.onlyWithAttrs)||(i[t]=e))})),u?(angular.forEach(i,(function(e,t){e.onElementSelect.onlyWithAttrs&&r(o,e.onElementSelect.onlyWithAttrs)&&l.push({name:t,tool:e})})),l.sort((function(e,t){return t.tool.onElementSelect.onlyWithAttrs.length-e.tool.onElementSelect.onlyWithAttrs.length}))):angular.forEach(i,(function(e,t){l.push({name:t,tool:e})})),l.length>0)for(var c=0;c<l.length;c++){for(var p=l[c].tool,f=l[c].name,m=0;m<s[n].toolbarScopes.length;m++)if(void 0!==s[n].toolbarScopes[m].tools[f]){p.onElementSelect.action.call(s[n].toolbarScopes[m].tools[f],e,o,a),d=!0;break}if(d)break}return d}}},angular.forEach(o,(function(e){i[e]&&s[n].toolbarScopes.push(i[e])})),c(),s[n].editorFunctions},retrieveEditor:function(e){return s[e]},unregisterEditor:function(e){delete s[e],c()},registerToolbar:function(e){if(!e)throw"textAngular Error: A toolbar requires a scope";if(!e.name||""===e.name)throw"textAngular Error: A toolbar requires a name";if(i[e.name])throw'textAngular Error: A toolbar with name "'+e.name+'" already exists';i[e.name]=e,angular.forEach(s,(function(t){t._registerToolbarScope(e)})),c()},retrieveToolbar:function(e){return i[e]},retrieveToolbarsViaEditor:function(e){var t=[],n=this;return angular.forEach(this.retrieveEditor(e).toolbars,(function(e){t.push(n.retrieveToolbar(e))})),t},unregisterToolbar:function(e){delete i[e],c()},updateToolsDisplay:function(e){var t=this;angular.forEach(e,(function(e,n){t.updateToolDisplay(n,e)}))},resetToolsDisplay:function(){var e=this;angular.forEach(t,(function(t,n){e.resetToolDisplay(n)})),c()},updateToolDisplay:function(e,t){var n=this;angular.forEach(i,(function(a,o){n.updateToolbarToolDisplay(o,e,t)})),c()},resetToolDisplay:function(e){var t=this;angular.forEach(i,(function(n,a){t.resetToolbarToolDisplay(a,e)})),c()},updateToolbarToolDisplay:function(e,t,n){if(!i[e])throw'textAngular Error: No Toolbar with name "'+e+'" exists';i[e].updateToolDisplay(t,n)},resetToolbarToolDisplay:function(e,n){if(!i[e])throw'textAngular Error: No Toolbar with name "'+e+'" exists';i[e].updateToolDisplay(n,t[n],!0)},removeTool:function(e){delete t[e],angular.forEach(i,(function(t){delete t.tools[e];for(var n=0;n<t.toolbar.length;n++){for(var a,o=0;o<t.toolbar[n].length;o++){if(t.toolbar[n][o]===e){a={group:n,index:o};break}if(void 0!==a)break}void 0!==a&&(t.toolbar[a.group].slice(a.index,1),t._$element.children().eq(a.group).children().eq(a.index).remove())}})),c()},addTool:function(e,t,a,o){n(e,t),angular.forEach(i,(function(n){n.addTool(e,t,a,o)})),c()},addToolToToolbar:function(e,t,a,o,r){n(e,t),i[a].addTool(e,t,o,r),c()},refreshEditor:function(e){if(!s[e])throw'textAngular Error: No Editor with name "'+e+'" exists';s[e].scope.updateTaBindtaTextElement(),s[e].scope.$$phase||s[e].scope.$digest(),c()},sendKeyCommand:function(e,t){var n=s[e._name];if(n&&n.editorFunctions.sendKeyCommand(t))return e._bUpdateSelectedStyles||e.updateSelectedStyles(),t.preventDefault(),!1},updateStyles:u,getVersion:function(){return"v1.5.16"},getToolbarScopes:function(){var e=[];return angular.forEach(s,(function(t){e=e.concat(t.toolbarScopes)})),e}}}]),y.directive("textAngularToolbar",["$compile","textAngularManager","taOptions","taTools","taToolExecuteAction","$window",function(e,t,n,a,o,r){return{scope:{name:"@"},restrict:"EA",link:function(l,i,s){if(!l.name||""===l.name)throw"textAngular Error: A toolbar requires a name";angular.extend(l,angular.copy(n)),s.taToolbar&&(l.toolbar=l.$parent.$eval(s.taToolbar)),s.taToolbarClass&&(l.classes.toolbar=s.taToolbarClass),s.taToolbarGroupClass&&(l.classes.toolbarGroup=s.taToolbarGroupClass),s.taToolbarButtonClass&&(l.classes.toolbarButton=s.taToolbarButtonClass),s.taToolbarActiveButtonClass&&(l.classes.toolbarButtonActive=s.taToolbarActiveButtonClass),s.taFocussedClass&&(l.classes.focussed=s.taFocussedClass),l.disabled=!0,l.focussed=!1,l._$element=i,i[0].innerHTML="",i.addClass("ta-toolbar "+l.classes.toolbar),l.$watch("focussed",(function(){l.focussed?i.addClass(l.classes.focussed):i.removeClass(l.classes.focussed)}));var d=function(t,n){var a;if(a=t&&t.display?angular.element(t.display):angular.element("<button type='button'>"),t&&t.class?a.addClass(t.class):a.addClass(l.classes.toolbarButton),a.attr("name",n.name),a.attr("ta-button","ta-button"),a.attr("ng-disabled","isDisabled()"),a.attr("tabindex","-1"),a.attr("ng-click","executeAction()"),a.attr("ng-class","displayActiveToolClass(active)"),t&&t.tooltiptext&&a.attr("title",t.tooltiptext),t&&!t.display&&!n._display&&(a[0].innerHTML="",t.buttontext&&(a[0].innerHTML=t.buttontext),t.iconclass)){var o=angular.element("<i>"),r=a[0].innerHTML;o.addClass(t.iconclass),a[0].innerHTML="",a.append(o),r&&""!==r&&a.append("&nbsp;"+r)}return n._lastToolDefinition=angular.copy(t),e(a)(n)};l.tools={},l._parent={disabled:!0,showHtml:!1,queryFormatBlockState:function(){return!1},queryCommandState:function(){return!1}};var u={$window:r,$editor:function(){return l._parent},isDisabled:function(){return("html"!==this.name||!l._parent.startAction)&&("function"!=typeof this.$eval("disabled")&&this.$eval("disabled")||this.$eval("disabled()")||"html"!==this.name&&this.$editor().showHtml||this.$parent.disabled||this.$editor().disabled)},displayActiveToolClass:function(e){return e?l.classes.toolbarButtonActive:""},executeAction:o};angular.forEach(l.toolbar,(function(e){var t=angular.element("<div>");t.addClass(l.classes.toolbarGroup),angular.forEach(e,(function(e){l.tools[e]=angular.extend(l.$new(!0),a[e],u,{name:e}),l.tools[e].$element=d(a[e],l.tools[e]),t.append(l.tools[e].$element)})),i.append(t)})),l.updateToolDisplay=function(e,t,n){var a=l.tools[e];if(a){if(a._lastToolDefinition&&!n&&(t=angular.extend({},a._lastToolDefinition,t)),null===t.buttontext&&null===t.iconclass&&null===t.display)throw'textAngular Error: Tool Definition for updating "'+e+'" does not have a valid display/iconclass/buttontext value';null===t.buttontext&&delete t.buttontext,null===t.iconclass&&delete t.iconclass,null===t.display&&delete t.display;var o=d(t,a);a.$element.replaceWith(o),a.$element=o}},l.addTool=function(e,t,n,o){var r;l.tools[e]=angular.extend(l.$new(!0),a[e],u,{name:e}),l.tools[e].$element=d(a[e],l.tools[e]),void 0===n&&(n=l.toolbar.length-1),r=angular.element(i.children()[n]),void 0===o?(r.append(l.tools[e].$element),l.toolbar[n][l.toolbar[n].length-1]=e):(r.children().eq(o).after(l.tools[e].$element),l.toolbar[n][o]=e)},t.registerToolbar(l),l.$on("$destroy",(function(){t.unregisterToolbar(l.name)}))}}}]),y.directive("textAngularVersion",["textAngularManager",function(e){var t=e.getVersion();return{restrict:"EA",link:function(e,n,a){n.html(t)}}}]),y.name}(e)}.apply(t,a))||(e.exports=o)}}]);