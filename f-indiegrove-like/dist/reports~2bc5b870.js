(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{"/1cb":function(e,t,r){"use strict";r.r(t);var n=r("WSeP"),o=r.n(n);t.default=angular.module("deskworks.reports.optsReportByPeriod",[]).factory("optsReportByPeriod",["$rootScope","$translate","$filter",function(e,t,r){var n=r("date"),a=[{id:"week",_name:"REPORTS.BY_PERIOD.WEEK",format:function(e,t){return n(e,"MMM d")+" - "+n(t,"MMM d")}},{id:"month",_name:"REPORTS.BY_PERIOD.MONTH",format:function(e,t){return n(e,"MMM")}},{id:"quarter",_name:"REPORTS.BY_PERIOD.QUARTER",format:function(e,t){return n(e,"MMM")+" - "+n(t,"MMM")}},{id:"year",_name:"REPORTS.BY_PERIOD.YEAR",format:function(e,t){return n(e,"yyyy")}}];function l(){o()(a).call(a,(function(e){e.name=t.instant(e._name)}))}return l(),e.$on("$setTranslationsSuccess",l),a}])},"5+k5":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");var n=r("yCd9"),o=r.n(n),a=r("WSeP"),l=r.n(a),s=r("29E8"),i=r("IE1r"),f=r("UDUI"),c=r("5bca"),d=r("5/DJ"),p=r("81mT"),u=r("Xjih");t.default=angular.module("deskworks.reports.ReportBuilder",[s.a.name,i.a.name,f.a.name,c.a.name,d.a.name,p.a.name,u.a.name,"deskworks.center.service"]).factory("ReportBuilder",["$rootScope","$q","$timeout","$window","$filter","$http","state","logo","jsPDF","csvMake","centerService","reportStyles","reportHeader","reportFooter","reportSort",function(e,t,r,n,a,s,i,f,c,d,p,u,m,g,y){return function(r){var n=this;e.$watch((function(){return r.reportOptions.centerId}),(function(e,t){e!==t&&(r.reportData=null,r.center=null)})),n.resolve=function(){return t.all({reportData:r.reportData||r.getReportData().catch((function(t){return e.showError(t,"Failed to load report data.")})),center:r.center||p.get(+r.reportOptions.centerId||i.getCurrentCenterId()).catch((function(t){return e.showError(t,"Failed to load center data.")})),logo:r.logo||f.getSiteLogo()}).then((function(e){return r.reportData=e.reportData,r.center=e.center,r.logo=e.logo,r}))},n.buildPdf=function(e,t){return n.generatePdf(e,t).then((function(e){return e.output("blob")}))},n.generatePdf=function(e,t,a){return n.resolve().then((function(n){var s,i,f=a||new c(r.reportOptions.paperLayout,"pt",r.reportOptions.paperSize),d=e(r);l()(s=d.rows).call(s,(function(e){var t;l()(t=d.columns).call(t,(function(t,r){e[r]&&!angular.isUndefined(e[r].content)||(e[r]={content:e[r]});var n=e[r];!1===n.content?n.content="":(t.pdf&&(n.content=t.pdf(n.content)),n.content=angular.isUndefined(n.content)||null===n.content||""===n.content?"-":n.content)}))}));var p={columns:o()(i=d.columns).call(i,(function(e){return e.title.toUpperCase()})),body:d.rows,headStyles:(t||u).headStyles,bodyStyles:(t||u).bodyStyles,columnStyles:(t||u).columnStyles,tableMargin:t&&t.tableMargin||(t||u).pageMargins,startY:r.startY||(t||u).startY||!1,didParseCell:function(e){var t=e.row,r=e.cell,n=e.column;if("body"===e.section){angular.extend(r.styles,{minCellWidth:50,fillColor:!1},d.styles[t.index],d.columns[n.index].styles)}else angular.extend(r.styles,d.columns[n.index].styles)},didDrawCell:function(e){return function(e,t){var r=e.cell,n=e.doc;return 0===e.column.index&&r.styles.borderColor&&r.styles.borderWidth&&(n.setLineWidth(r.styles.borderWidth),n.setDrawColor(r.styles.borderColor[0],r.styles.borderColor[1],r.styles.borderColor[2]),n.rect(e.settings.margin.left+r.styles.borderWidth/2,r.y+r.styles.borderWidth/2,e.table.getWidth(n.internal.pageSize.width)-r.styles.borderWidth,e.row.height-2*r.styles.borderWidth,"S")),!1}(e,d.columns)},didDrawPage:function(e){(r.reportHeader||m)(e.table,f,r),(r.reportFooter||g)(e.table,f,r)}};return p.margin=p.tableMargin||(t||u).pageMargins,f.autoTable(p),f}))},n.buildCsv=function(e){var t,n,a={charset:"utf-8"},s=e(r);return l()(t=s.rows).call(t,(function(e){var t;l()(t=s.columns).call(t,(function(t,r){e[r]&&angular.isDefined(e[r].content)&&(e[r]=e[r].content),t.csv&&(e[r]=t.csv(e[r])),e[r]=angular.isUndefined(e[r])||null===e[r]||!1===e[r]||""===e[r]?"":e[r]}))})),s.rows.unshift(o()(n=s.columns).call(n,(function(e){return e.title.toUpperCase()}))),new Blob([d.generate(s.rows,a)],{type:"text/csv;charset="+a.charset+";"})},n.getReportFileName=function(e,t){var n=!1===r.reportOptions.centerId||+r.reportOptions.centerId?r.center.shortName:"all-centers",o=r.reportName;return n=(n||"").toLowerCase().replace(/\s+/g,"-"),o=(o||"").toLowerCase().replace(/\s+/g,"-"),e=(e||"pdf").toLowerCase(),o+"-"+n+"-"+a("date")(moment(),"yyyyMMdd-HHmmss")+(t||"")+"."+e},n.sortData=y}}])},"5ual":function(e,t,r){"use strict";r.r(t);var n=r("6RpP"),o=r.n(n),a=r("KK/u"),l=r.n(a),s=r("yCd9"),i=r.n(s),f=r("WgSX"),c=r("G6E5"),d=r("5/DJ"),p=r("LTMe");t.default=angular.module("deskworks.WriteOffReportCtrl",[f.a.name,c.a.name,d.a.name,p.a.name,"deskworks.state","deskworks.reports.ReportBuilder","deskworks.reports.reportDates","deskworks.WriteOffReport","deskworks.writeOffReportColumns","deskworks.reportOrderBy"]).controller("WriteOffReportCtrl",["$scope","$timeout","$translate","$filter","$location","helper","state","reportHelper","reportStyles","ReportBuilder","WriteOffReport","writeOffReportColumns",function(e,t,r,n,a,s,f,c,d,p,u,m){var g,y=this;function h(e){var t,n,a,f={columns:e.reportColumns,rows:[],styles:[]},p=0;return f.rows=i()(t=l()(c).call(c,e.reportData,e.orderBy)).call(t,(function(e,t){var r;return f.styles.push(t%2?null:d.rowOdd),p+=e.amount,i()(r=f.columns).call(r,(function(t){return e[t.dataKey]}))})),f.rows.push(o()(n=i()(a=Array.apply(null,Array(f.columns.length-2))).call(a,Boolean.prototype.valueOf,!1)).call(n,[r.instant("REPORTS.TOTAL")+":",s.round(p)])),f.styles.push(d.h3),f}y.config={reportName:r.instant("WRITE_OFF_REPORT.REPORT_NAME"),reportOptions:{},reportColumns:m,reportDates:{fromDate:moment().date(1),toDate:moment()},getReportData:function(){return u.query({centerId:y.config.reportOptions.centerId||null,fromDate:n("date")(y.config.reportDates.fromDate,"yyyy-MM-dd"),toDate:n("date")(y.config.reportDates.toDate,"yyyy-MM-dd")})}},f.setPageTitle(y.config.reportName),y.reportBuilder=new p(y.config),e.$watch((function(){return{reportOptions:y.config.reportOptions,reportDates:y.config.reportDates,orderBy:y.config.orderBy,orderSort:y.config.orderSort}}),(function(e,r){g&&(t.cancel(g),g=null),g=t((function(){if(y.pdf=null,!angular.isUndefined(y.config.reportOptions.centerId)&&y.config.reportDates.fromDate&&y.config.reportDates.toDate){var t=e.reportDates.fromDate,n=r.reportDates.fromDate;!moment.isMoment(t)||moment.isMoment(n)&&t.isSame(n)||(y.config.reportData=null),t=e.reportDates.toDate,n=r.reportDates.toDate,!moment.isMoment(t)||moment.isMoment(n)&&t.isSame(n)||(y.config.reportData=null),y.reportBuilder.buildPdf(h).then((function(e){y.pdf=e}))}}),100)}),!0),y.downloadPdf=function(){y.pdf&&c.download({blob:y.pdf,fileName:y.reportBuilder.getReportFileName("pdf")})},y.downloadCsv=function(){y.pdf&&c.download({blob:y.reportBuilder.buildCsv(h),fileName:y.reportBuilder.getReportFileName("csv")})}}])},"92Gs":function(e,t,r){"use strict";r.r(t);var n=r("YtL8"),o=r.n(n),a=r("29E8");t.default=angular.module("deskworks.reportGroupBy",[a.a.name]).factory("reportGroupBy",["reportSort",function(e){return function(t,r){var n;return o()(n=e(t,r)).call(n,(function(e,t){var n=e[e.length-1]||[],o=n[0]||{};return o[r]===t[r]||moment.isMoment(o[r])&&moment.isMoment(t[r])&&o[r].isSame(t[r],"day")||(n=[],e.push(n)),n.push(t),e}),[])}}])},Kh2r:function(e,t,r){},Krgv:function(e,t){e.exports='<ff-panel> <ff-panel-header><span translate=REPORTS.OPTIONS.HEADER></span></ff-panel-header> <label class=ff-row ng-if=$ctrl.banks> <ff-label flex="0 0 100px"><span translate=REPORTS.OPTIONS.BANK></span></ff-label> <ff-select ff-model=$ctrl.model.bankId ff-options="bank.id as bank.name for bank in $ctrl.banks"></ff-select> </label> <label class=ff-row ng-if="$ctrl.model.centerId !== false && !$ctrl.noCenters && !$ctrl.centers" ng-show="state.getUserCenters().length > 1"> <ff-label flex="0 0 100px"><span translate=REPORTS.OPTIONS.CENTER></span></ff-label> <dw-select-center ff-model=$ctrl.model.centerId ff-option-all="{{$ctrl.allCenters !== false}}"></dw-select-center> </label> <label class=ff-row ng-if="$ctrl.model.centerId !== false && !$ctrl.noCenters && $ctrl.centers" ng-show="state.getUserCenters().length > 1"> <ff-label flex="0 0 100px"><span translate=REPORTS.OPTIONS.CENTER></span></ff-label> <ff-select ff-model=$ctrl.model.centerId ff-options="center.id as center.name for center in $ctrl.centers"></ff-select> </label> <label class=ff-row> <ff-label flex="0 0 100px"><span translate=REPORTS.OPTIONS.SIZE></span></ff-label> <ff-select ff-model=$ctrl.model.paperSize> <option ng-repeat="size in $ctrl.optsPaperSize" value={{size.id}}>{{size.name}}</option> </ff-select> </label> <ff-row> <ff-label flex="0 0 100px"><span translate=REPORTS.OPTIONS.LAYOUT></span></ff-label> <ff-static> <div class="ff-grid gutter-h-half" role=radiogroup aria-label="{{\'REPORTS.OPTIONS.LAYOUT\' | translate}}"> <label flex="0 0 auto"> <ff-radio name=paperLayout ff-model=$ctrl.model.paperLayout ff-value="\'p\'"> <span translate=REPORTS.OPTIONS.LAYOUT.PORTRAIT></span> </ff-radio> </label> <label flex="0 0 auto"> <ff-radio name=paperLayout ff-model=$ctrl.model.paperLayout ff-value="\'l\'"> <span translate=REPORTS.OPTIONS.LAYOUT.LANDSCAPE></span> </ff-radio> </label> </div> </ff-static> </ff-row> </ff-panel> '},LTMe:function(e,t,r){"use strict";r("Muwe"),r("y89P"),r("X5mX");var n=r("nbuU"),o=r.n(n),a=r("9HME"),l=angular.module("deskworks.reports.optsPaperSize",[]).factory("optsPaperSize",(function(){return[{id:"letter",name:"Letter"},{id:"A4",name:"A4"},{id:"A3",name:"A3"},{id:"A2",name:"A2"},{id:"A1",name:"A1"},{id:"A0",name:"A0"}]})),s=r("Krgv"),i=r.n(s);t.a=angular.module("deskworks.reportOptions",["deskworks.helper",l.name,a.a.name]).directive("reportOptions",["$compile",function(e){return{restrict:"EAC",scope:!0,transclude:"element",priority:2,controller:"ReportOptionsCtrl as $ctrl",bindToController:{model:"<",centers:"<",allCenters:"<",banks:"<",noCenters:"<"},link:function(t,r,n,o,a){a((function(n,o){var a=e(i.a)(t);angular.element(a[0].querySelector?a[0].querySelector(".ff-panel-body"):a).append(n),r.after(a)}))}}}]).controller("ReportOptionsCtrl",["$scope","$location","state","helper","optsPaperSize",function(e,t,r,n,a){var l=this;l.optsPaperSize=a,l.$onInit=function(){!1===l.model.centerId||l.noCenters||(e.$watch((function(){return t.search().centerId}),(function(e){l.model.centerId=e||0===e?+e:r.getCurrentCenterId()})),e.$watch("$ctrl.model.centerId",(function(r){r&&e.vm&&e.vm.config&&e.vm.config.reportOwnerRegion&&(e.vm.config.reportOwnerRegion.ownerId=e.vm.config.reportOwnerRegion.regionId=void 0),t.search("centerId",r).replace()}))),l.banks&&(e.$watch((function(){return t.search().bankId}),(function(e){l.model.bankId=e||0===e?+e:l.banks&&l.banks[0]&&l.banks[0].id})),e.$watch("$ctrl.model.bankId",(function(e){t.search("bankId",e).replace()}))),e.$watch((function(){return t.search().paperSize}),(function(e){var t;l.model.paperSize=(o()(t=l.optsPaperSize).call(t,(function(t){return t.id===e}))||l.optsPaperSize[0]).id})),e.$watch("$ctrl.model.paperSize",(function(e){t.search("paperSize",e).replace()})),e.$watch((function(){return t.search().paperLayout}),(function(e){l.model.paperLayout=e||l.model.paperLayout||"l"})),e.$watch("$ctrl.model.paperLayout",(function(e){t.search("paperLayout",e).replace()}))}}])},WgSX:function(e,t,r){"use strict";r("Kh2r");t.a=angular.module("pdfPreview",["deskworks.helper"]).directive("pdfPreview",["$window","helper",function(e,t){return{restrict:"A",scope:!0,template:'<iframe ng-hide="ie" title="{{\'REPORTS.PREVIEW.HEADER\' | translate}}"></iframe><ff-info class="text-danger" ng-if="ie"><ff-icon sense="warning"></ff-icon> Microsoft Edge & Internet Explorer don\'t support live PDF preview. You can download the PDF or use another browser to have live preview, e.g. Chrome/Firefox/Opera/Safari.</ff-info>',compile:function(r,n){var o=r.parent().parent();return t.isMobile()&&o.hasClass("flex-form")?(r.parent().parent().css("display","none"),function(){}):t.isIE()?function(e,t,r){e.ie=!0}:(r.addClass("pdf-preview"),function(t,r,n){var o,a=r.children(),l=angular.element('<div class="ff-dimmer ff-spin"></div>');l.on("click",(function(e){e.stopPropagation()})),a.on("load",(function(){angular.element(l).remove(),r.removeClass("ff-dim")})),t.$watch(n.pdfPreview,(function(t){r.append(l),r.addClass("ff-dim"),o&&(e.URL.revokeObjectURL(o),o=null),t&&(o=e.URL.createObjectURL(t),a[0].src=o)})),t.$on("$destroy",(function(){o&&(e.URL.revokeObjectURL(o),o=null)}))})}}}])},Yes4:function(e,t,r){"use strict";r.r(t),t.default=angular.module("systemColors",["deskworks.helper"]).factory("systemColors",["$window","helper",function(e,t){var r={},n=angular.element('<div style="display: none"></div>');return n.append('<div class="text-text"></div>'),n.append('<div class="text-brand"></div>'),n.append('<div class="text-brand"></div>'),n.append('<div class="text-danger"></div>'),n.append("<div></div>"),n.append('<div class="sidebar-group-header"></div>'),document.body.appendChild(n[0]),r.text=t.rgb2hex(e.getComputedStyle(n.children()[0]).getPropertyValue("color"))||"#444",r.info=t.rgb2hex(e.getComputedStyle(n.children()[4]).getPropertyValue("color"))||"#4d4e4c",r.primary=t.rgb2hex(e.getComputedStyle(n.children()[5]).getPropertyValue("background-color"))||"#949594",r.warning=t.rgb2hex(e.getComputedStyle(n.children()[3]).getPropertyValue("color"))||"#ff9b00",n.remove(),r}])},aHVT:function(e,t){e.exports="<div id=writeOffReport class=gutter-v> <form name=formWriteOffReport> <h1 class=page-title>{{state.getPageTitle()}}</h1> <div class=\"ff-grid gutter-v gutter-h\"> <div flex=\"{lg: '0 0 61%', md: '0 0 50%'}\"> <report-dates model=$ctrl.config.reportDates></report-dates> </div> <div flex=\"{lg: '0 0 39%', md: '0 0 50%'}\"> <report-options model=$ctrl.config.reportOptions> <report-order-by model=$ctrl.config.orderBy report-columns=$ctrl.config.reportColumns></report-order-by> </report-options> </div> </div> <ff-btn-group class=buttons-bottom> <ff-btn sense=download ff-click=$ctrl.downloadPdf() ff-disabled=!$ctrl.pdf> <span translate=REPORTS.BTN_PDF></span> </ff-btn> <ff-btn sense=download ff-click=$ctrl.downloadCsv() ff-disabled=!$ctrl.pdf> <span translate=REPORTS.BTN_CSV></span> </ff-btn> </ff-btn-group> </form> <ff-panel> <ff-panel-header><span translate=REPORTS.PREVIEW.HEADER></span></ff-panel-header> <div pdf-preview=$ctrl.pdf></div> </ff-panel> </div> "},fKuI:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.WriteOffReport",["ngResource","datesDeserializer","deserializeNumbers","deskworks.config"]).factory("WriteOffReport",["$resource","datesDeserializer","deserializeNumbers","deskworksConfig",function(e,t,r,n){var o=t(["date"]),a=r(["amount"]),l=e(n.getApiAbsUrl("/write-off-report"),{centerId:"@centerId",fromDate:"@fromDate",toDate:"@toDate"},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,o,a]}});return{query:function(e){return l.query(e).$promise}}}])},h0ZB:function(e,t,r){"use strict";r.r(t);var n=r("WSeP"),o=r.n(n);t.default=angular.module("deskworks.writeOffReportColumns",[]).factory("writeOffReportColumns",["$rootScope","$filter","$translate",function(e,t,r){var n=[{dataKey:"userCompany",_title:"WRITE_OFF_REPORT.COLUMNS.COMPANY"},{dataKey:"userName",_title:"WRITE_OFF_REPORT.COLUMNS.NAME",defaultOrder:!0},{dataKey:"orderId",_title:"WRITE_OFF_REPORT.COLUMNS.ORDER_ID",styles:{halign:"right"}},{dataKey:"date",_title:"WRITE_OFF_REPORT.COLUMNS.DATE",styles:{halign:"right"},pdf:function(e){return t("date")(e,"mediumDate")},csv:function(e){return t("date")(e,"shortDate")}},{dataKey:"amount",_title:"WRITE_OFF_REPORT.COLUMNS.AMOUNT",styles:{halign:"right"},pdf:function(e){return t("ncurrency")(e)},csv:function(e){return t("ncurrency")(e)}}];function a(){o()(n).call(n,(function(e){e.title=r.instant(e._title)}))}return a(),e.$on("$setTranslationsSuccess",a),n}])},zvMh:function(e,t,r){"use strict";r.r(t);r("8cZI"),r("JBxO"),r("kPpV"),r("/usm"),r("HJh7"),r("BqNe"),r("HKDy"),r("OgzJ"),r("lCat"),r("EApN"),r("MFGm"),r("lZgT"),r("JzGb"),r("WH+p"),r("xg3p"),r("soU3"),r("ajWl"),r("s5En"),r("EjQN"),r("36lJ"),r("fD/E"),r("LWud"),r("AxL9"),r("HztR"),r("xmYR"),r("cF0Y");t.default=angular.module("b64",[]).factory("b64",["$window",function(e){var t=[],r=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array;return function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=e.length;n<o;++n)t[n]=e[n],r[e.charCodeAt(n)]=n;r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63}(),{toByteArray:function(e){var t,o,a,l,s,i,f=e.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===e[f-2]?2:"="===e[f-1]?1:0,i=new n(3*f/4-s),a=s>0?f-4:f;var c=0;for(t=0,o=0;t<a;t+=4,o+=3)l=r[e.charCodeAt(t)]<<18|r[e.charCodeAt(t+1)]<<12|r[e.charCodeAt(t+2)]<<6|r[e.charCodeAt(t+3)],i[c++]=l>>16&255,i[c++]=l>>8&255,i[c++]=255&l;2===s?(l=r[e.charCodeAt(t)]<<2|r[e.charCodeAt(t+1)]>>4,i[c++]=255&l):1===s&&(l=r[e.charCodeAt(t)]<<10|r[e.charCodeAt(t+1)]<<4|r[e.charCodeAt(t+2)]>>2,i[c++]=l>>8&255,i[c++]=255&l);return i},fromByteArray:function(e){for(var r,n=e.length,a=n%3,l="",s=[],i=0,f=n-a;i<f;i+=16383)s.push(o(e,i,i+16383>f?f:i+16383));1===a?(r=e[n-1],l+=t[r>>2],l+=t[r<<4&63],l+="=="):2===a&&(r=(e[n-2]<<8)+e[n-1],l+=t[r>>10],l+=t[r>>4&63],l+=t[r<<2&63],l+="=");return s.push(l),s.join("")}};function o(e,r,n){for(var o,a,l=[],s=r;s<n;s+=3)o=(e[s]<<16)+(e[s+1]<<8)+e[s+2],l.push(t[(a=o)>>18&63]+t[a>>12&63]+t[a>>6&63]+t[63&a]);return l.join("")}}])}}]);