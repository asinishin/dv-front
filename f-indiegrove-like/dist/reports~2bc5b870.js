(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{"5ual":function(e,t,r){"use strict";r.r(t);var o=r("yCd9"),n=r.n(o),a=r("KK/u"),l=r.n(a),s=r("6RpP"),i=r.n(s),f=r("WgSX"),d=r("G6E5"),c=r("5/DJ"),p=r("LTMe");t.default=angular.module("deskworks.WriteOffReportCtrl",[f.a.name,d.a.name,c.a.name,p.a.name,"deskworks.state","deskworks.reports.ReportBuilder","deskworks.reports.reportDates","deskworks.WriteOffReport","deskworks.writeOffReportColumns","deskworks.reportOrderBy"]).controller("WriteOffReportCtrl",["$scope","$timeout","$translate","$filter","$location","helper","state","reportHelper","reportStyles","ReportBuilder","WriteOffReport","writeOffReportColumns",function(e,t,r,o,a,s,f,d,c,p,u,m){var g,y=this;function h(e){var t,o,a,f={columns:e.reportColumns,rows:[],styles:[]},p=0;return f.rows=n()(t=l()(d).call(d,e.reportData,e.orderBy)).call(t,(function(e,t){var r;return f.styles.push(t%2?null:c.rowOdd),p+=e.amount,n()(r=f.columns).call(r,(function(t){return e[t.dataKey]}))})),f.rows.push(i()(o=n()(a=Array.apply(null,Array(f.columns.length-2))).call(a,Boolean.prototype.valueOf,!1)).call(o,[r.instant("REPORTS.TOTAL")+":",s.round(p)])),f.styles.push(c.h3),f}y.config={reportName:r.instant("WRITE_OFF_REPORT.REPORT_NAME"),reportOptions:{},reportColumns:m,reportDates:{fromDate:moment().date(1),toDate:moment()},getReportData:function(){return u.query({centerId:y.config.reportOptions.centerId||null,fromDate:o("date")(y.config.reportDates.fromDate,"yyyy-MM-dd"),toDate:o("date")(y.config.reportDates.toDate,"yyyy-MM-dd")})}},f.setPageTitle(y.config.reportName),y.reportBuilder=new p(y.config),e.$watch((function(){return{reportOptions:y.config.reportOptions,reportDates:y.config.reportDates,orderBy:y.config.orderBy,orderSort:y.config.orderSort}}),(function(e,r){g&&(t.cancel(g),g=null),g=t((function(){if(y.pdf=null,!angular.isUndefined(y.config.reportOptions.centerId)&&y.config.reportDates.fromDate&&y.config.reportDates.toDate){var t=e.reportDates.fromDate,o=r.reportDates.fromDate;!moment.isMoment(t)||moment.isMoment(o)&&t.isSame(o)||(y.config.reportData=null),t=e.reportDates.toDate,o=r.reportDates.toDate,!moment.isMoment(t)||moment.isMoment(o)&&t.isSame(o)||(y.config.reportData=null),y.reportBuilder.buildPdf(h).then((function(e){y.pdf=e}))}}),100)}),!0),y.downloadPdf=function(){y.pdf&&d.download({blob:y.pdf,fileName:y.reportBuilder.getReportFileName("pdf")})},y.downloadCsv=function(){y.pdf&&d.download({blob:y.reportBuilder.buildCsv(h),fileName:y.reportBuilder.getReportFileName("csv")})}}])},"8Xq/":function(e,t,r){"use strict";r("3dw1");t.a=angular.module("deskworks.reports.optsReportByPeriod",[]).factory("optsReportByPeriod",["$rootScope","$translate","$filter",function(e,t,r){var o=r("date"),n=[{id:"week",_name:"REPORTS.BY_PERIOD.WEEK",format:function(e,t){return o(e,"MMM d")+" - "+o(t,"MMM d")}},{id:"month",_name:"REPORTS.BY_PERIOD.MONTH",format:function(e,t){return o(e,"MMM")}},{id:"quarter",_name:"REPORTS.BY_PERIOD.QUARTER",format:function(e,t){return o(e,"MMM")+" - "+o(t,"MMM")}},{id:"year",_name:"REPORTS.BY_PERIOD.YEAR",format:function(e,t){return o(e,"yyyy")}}];function a(){n.forEach((function(e){e.name=t.instant(e._name)}))}return a(),e.$on("$setTranslationsSuccess",a),n}])},CLLE:function(e,t,r){"use strict";r("3dw1");var o=r("03wM"),n=r.n(o),a=r("Ekwr"),l=r.n(a),s=r("hsT8"),i=r.n(s),f=r("lvz6"),d=r.n(f),c=r("yKah"),p=r.n(c),u=r("fzuT"),m=r.n(u),g=r("yCd9"),y=r.n(g),h=r("ipr/"),b=r.n(h),R=(r("S2gh"),r("bG+q"),r("pl6f")),O=r("aGVL"),v=r("bU+R"),w=r.n(v);function $(e,t){var r=n()(e);if(l.a){var o=l()(e);t&&(o=i()(o).call(o,(function(t){return d()(e,t).enumerable}))),r.push.apply(r,o)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):p.a?Object.defineProperties(e,p()(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,d()(r,t))}))}return e}t.a=angular.module("chartDirective",["deskworks.helper",R.a.name,O.a.name]).directive("chart",["$window","systemColors",function(e,t){return e.Chart.defaults.global.legend.labels.boxWidth=12,e.Chart.defaults.global.tooltips.cornerRadius=3,e.Chart.defaults.global.tooltips.displayColors=!1,e.Chart.defaults.global.tooltips.backgroundColor="rgba(0,0,0,0.65)",e.Chart.defaults.global.elements.rectangle.borderWidth=1,e.Chart.defaults.global.elements.rectangle.backgroundColor=t.primary,e.Chart.defaults.global.elements.arc.borderWidth=1,e.Chart.plugins.unregister(w.a),{restrict:"E",scope:!0,controller:"ChartCtrl as $ctrl",bindToController:{type:"@chartType",labels:"<chartLabels",data:"<chartData",options:"<chartOptions",config:"<"},template:"<canvas></canvas>"}}]).controller("ChartCtrl",["$scope","$element","$window","chartColors",function(e,t,r,o){var n,a=this,l={maintainAspectRatio:!1},s={backgroundColor:o,hoverBorderWidth:2,hoverBorderColor:"#fff"};a.$onDestroy=function(){n&&n.destroy()},a.$onChanges=function(e){var o;if(a.config){var i;n&&n.destroy();var f=C({},a.config);return f.options=C(C({},f.options),l),f.data=C({},f.data),f.data.datasets=y()(i=f.data.datasets).call(i,(function(e){return C(C({},s),e)})),void(n=new r.Chart(t.children(),f))}if(a.options){var d={labels:a.labels,datasets:b()(o=a.data).call(o)};d.datasets[0]=angular.extend({},s,d.datasets[0]),!n||e.type&&e.type.currentValue!==e.type.previousValue?(n&&n.destroy(),n=new r.Chart(t.children(),{type:a.type,data:d,options:angular.extend({},l,a.options)})):(angular.extend(n.data,d),angular.extend(n.options,l,a.options),n.update())}}}])},Kh2r:function(e,t,r){},Krgv:function(e,t){e.exports='<ff-panel> <ff-panel-header><span translate="REPORTS.OPTIONS.HEADER"></span></ff-panel-header> <label class="ff-row" ng-if="$ctrl.banks"> <ff-label flex="0 0 100px"><span translate="REPORTS.OPTIONS.BANK"></span></ff-label> <ff-select ff-model="$ctrl.model.bankId" ff-options="bank.id as bank.name for bank in $ctrl.banks"></ff-select> </label> <label class="ff-row" ng-if="$ctrl.model.centerId !== false && !$ctrl.noCenters && !$ctrl.centers" ng-show="state.getUserCenters().length > 1"> <ff-label flex="0 0 100px"><span translate="REPORTS.OPTIONS.CENTER"></span></ff-label> <dw-select-center ff-model="$ctrl.model.centerId" ff-option-all="{{$ctrl.allCenters !== false}}"></dw-select-center> </label> <label class="ff-row" ng-if="$ctrl.model.centerId !== false && !$ctrl.noCenters && $ctrl.centers" ng-show="state.getUserCenters().length > 1"> <ff-label flex="0 0 100px"><span translate="REPORTS.OPTIONS.CENTER"></span></ff-label> <ff-select ff-model="$ctrl.model.centerId" ff-options="center.id as center.name for center in $ctrl.centers"></ff-select> </label> <label class="ff-row"> <ff-label flex="0 0 100px"><span translate="REPORTS.OPTIONS.SIZE"></span></ff-label> <ff-select ff-model="$ctrl.model.paperSize"> <option ng-repeat="size in $ctrl.optsPaperSize" value="{{size.id}}">{{size.name}}</option> </ff-select> </label> <ff-row> <ff-label flex="0 0 100px"><span translate="REPORTS.OPTIONS.LAYOUT"></span></ff-label> <ff-static> <div class="ff-grid gutter-h-half" role="radiogroup" aria-label="{{\'REPORTS.OPTIONS.LAYOUT\' | translate}}"> <label flex="0 0 auto"> <ff-radio name="paperLayout" ff-model="$ctrl.model.paperLayout" ff-value="\'p\'"> <span translate="REPORTS.OPTIONS.LAYOUT.PORTRAIT"></span> </ff-radio> </label> <label flex="0 0 auto"> <ff-radio name="paperLayout" ff-model="$ctrl.model.paperLayout" ff-value="\'l\'"> <span translate="REPORTS.OPTIONS.LAYOUT.LANDSCAPE"></span> </ff-radio> </label> </div> </ff-static> </ff-row> </ff-panel> '},LTMe:function(e,t,r){"use strict";var o=r("nbuU"),n=r.n(o),a=(r("Muwe"),r("X5mX"),r("y89P"),r("9HME")),l=angular.module("deskworks.reports.optsPaperSize",[]).factory("optsPaperSize",(function(){return[{id:"letter",name:"Letter"},{id:"A4",name:"A4"},{id:"A3",name:"A3"},{id:"A2",name:"A2"},{id:"A1",name:"A1"},{id:"A0",name:"A0"}]})),s=r("Krgv"),i=r.n(s);t.a=angular.module("deskworks.reportOptions",["deskworks.helper",l.name,a.a.name]).directive("reportOptions",["$compile",function(e){return{restrict:"EAC",scope:!0,transclude:"element",priority:2,controller:"ReportOptionsCtrl as $ctrl",bindToController:{model:"<",centers:"<",allCenters:"<",banks:"<",noCenters:"<"},link:function(t,r,o,n,a){a((function(o,n){var a=e(i.a)(t);angular.element(a[0].querySelector?a[0].querySelector(".ff-panel-body"):a).append(o),r.after(a)}))}}}]).controller("ReportOptionsCtrl",["$scope","$location","state","helper","optsPaperSize",function(e,t,r,o,a){var l=this;l.optsPaperSize=a,l.$onInit=function(){!1===l.model.centerId||l.noCenters||(e.$watch((function(){return t.search().centerId}),(function(e){l.model.centerId=e||0===e?+e:r.getCurrentCenterId()})),e.$watch("$ctrl.model.centerId",(function(r){r&&e.vm&&e.vm.config&&e.vm.config.reportOwnerRegion&&(e.vm.config.reportOwnerRegion.ownerId=e.vm.config.reportOwnerRegion.regionId=void 0),t.search("centerId",r).replace()}))),l.banks&&(e.$watch((function(){return t.search().bankId}),(function(e){l.model.bankId=e||0===e?+e:l.banks&&l.banks[0]&&l.banks[0].id})),e.$watch("$ctrl.model.bankId",(function(e){t.search("bankId",e).replace()}))),e.$watch((function(){return t.search().paperSize}),(function(e){var t,r;l.model.paperSize=(n()(t=l.optsPaperSize).call(t,(function(t){return t.id===e}))||n()(r=l.optsPaperSize).call(r,(function(e){return e.id===l.model.paperSize}))||l.optsPaperSize[0]).id})),e.$watch("$ctrl.model.paperSize",(function(e){t.search("paperSize",e).replace()})),e.$watch((function(){return t.search().paperLayout}),(function(e){l.model.paperLayout=e||l.model.paperLayout||"l"})),e.$watch("$ctrl.model.paperLayout",(function(e){t.search("paperLayout",e).replace()}))}}])},Tqzu:function(e,t,r){"use strict";r("Muwe"),r("X5mX"),r("y89P");var o=r("8Xq/");t.a=angular.module("deskworks.reportByPeriodDirective",["deskworks.helper",o.a.name]).directive("reportByPeriod",["$compile","$templateCache",function(e,t){return{restrict:"EAC",scope:!0,transclude:"element",priority:2,controller:"ReportByPeriodCtrl as $ctrl",bindToController:{model:"=",opts:"<"},link:function(r,o,n,a,l){l((function(n,a){var l=e(t.get("directives/report-by-period.tpl.html"))(r);angular.element(l[0]&&l[0].querySelector?l[0].querySelector(".ff-panel-body"):l).append(n),o.after(l)}))}}}]).controller("ReportByPeriodCtrl",["$scope","$location","$filter","$translate","state","helper","optsReportByPeriod",function(e,t,r,o,n,a,l){var s=this;s.$onInit=function(){s.optsPeriod=s.opts||l,e.$watch((function(){return t.search().byPeriod}),(function(e){s.model=e||s.model||s.optsPeriod[0].id})),e.$watch("$ctrl.model",(function(e){t.search("byPeriod",e).replace()}))}}])},Vl1O:function(e,t,r){"use strict";t.a=angular.module("deskworks.IncomeByItemReport",["ngResource","datesDeserializer","deskworks.config"]).factory("IncomeByItemReport",["$resource","$filter","datesDeserializer","deskworksConfig",function(e,t,r,o){var n=r(["productCategories.products.date"]),a=e(o.getApiAbsUrl("/centers/:centerId/income-by-item-reports"),{centerId:"@centerId",fromDate:"@fromDate",toDate:"@toDate"},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,n]}});return{query:function(e){return a.query({centerId:e.centerId||0,fromDate:t("date")(e.fromDate,"yyyy-MM-dd"),toDate:t("date")(e.toDate,"yyyy-MM-dd")}).$promise}}}])},WgSX:function(e,t,r){"use strict";r("Kh2r");t.a=angular.module("pdfPreview",["deskworks.helper"]).directive("pdfPreview",["$window","helper",function(e,t){return{restrict:"A",scope:!0,template:'<iframe ng-hide="ie" title="{{\'REPORTS.PREVIEW.HEADER\' | translate}}"></iframe><ff-info class="text-danger" ng-if="ie"><ff-icon sense="warning"></ff-icon> Microsoft Edge & Internet Explorer don\'t support live PDF preview. You can download the PDF or use another browser to have live preview, e.g. Chrome/Firefox/Opera/Safari.</ff-info>',compile:function(r,o){var n=r.parent().parent();return t.isMobile()&&n.hasClass("flex-form")?(r.parent().parent().css("display","none"),function(){}):t.isIE()?function(e,t,r){e.ie=!0}:(r.addClass("pdf-preview"),function(t,r,o){var n,a=r.children(),l=angular.element('<div class="ff-dimmer ff-spin"></div>');l.on("click",(function(e){e.stopPropagation()})),a.on("load",(function(){angular.element(l).remove(),r.removeClass("ff-dim")})),t.$watch(o.pdfPreview,(function(t){r.append(l),r.addClass("ff-dim"),n&&(e.URL.revokeObjectURL(n),n=null),t&&(n=e.URL.createObjectURL(t),a[0].src=n)})),t.$on("$destroy",(function(){n&&(e.URL.revokeObjectURL(n),n=null)}))})}}}])},aGVL:function(e,t,r){"use strict";t.a=angular.module("chartColors",[]).factory("chartColors",(function(){return["#317da3","#e6194b","#3cb44b","#ffe119","#f58231","#911eb4","#aa6e28","#008080","#808080","#800000","#3244a1","#e64c19","#3db372","#d1ff1a","#f5c131","#b31e81","#a89728","#005580","#806659","#804000"]}))},aHVT:function(e,t){e.exports='<div id="writeOffReport" class="gutter-v"> <form name="formWriteOffReport"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="ff-grid gutter-v gutter-h"> <div flex="{lg: \'0 0 61%\', md: \'0 0 50%\'}"> <report-dates model="$ctrl.config.reportDates"></report-dates> </div> <div flex="{lg: \'0 0 39%\', md: \'0 0 50%\'}"> <report-options model="$ctrl.config.reportOptions"> <report-order-by model="$ctrl.config.orderBy" report-columns="$ctrl.config.reportColumns"></report-order-by> </report-options> </div> </div> <ff-btn-group class="buttons-bottom"> <ff-btn sense="download" ff-click="$ctrl.downloadPdf()" ff-disabled="!$ctrl.pdf"> <span translate="REPORTS.BTN_PDF"></span> </ff-btn> <ff-btn sense="download" ff-click="$ctrl.downloadCsv()" ff-disabled="!$ctrl.pdf"> <span translate="REPORTS.BTN_CSV"></span> </ff-btn> </ff-btn-group> </form> <ff-panel> <ff-panel-header><span translate="REPORTS.PREVIEW.HEADER"></span></ff-panel-header> <div pdf-preview="$ctrl.pdf"></div> </ff-panel> </div> '},"bG+q":function(e,t,r){},fKuI:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.WriteOffReport",["ngResource","datesDeserializer","deserializeNumbers","deskworks.config"]).factory("WriteOffReport",["$resource","$filter","datesDeserializer","deserializeNumbers","deskworksConfig",function(e,t,r,o,n){var a=r(["date"]),l=o(["amount"]),s=e(n.getApiAbsUrl("/write-off-report"),{centerId:"@centerId",fromDate:"@fromDate",toDate:"@toDate"},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,a,l]}});return{query:function(e){return s.query({centerId:e.centerId||null,fromDate:t("date")(e.fromDate,"yyyy-MM-dd"),toDate:t("date")(e.toDate,"yyyy-MM-dd")}).$promise}}}])},h0ZB:function(e,t,r){"use strict";r.r(t);r("3dw1");t.default=angular.module("deskworks.writeOffReportColumns",[]).factory("writeOffReportColumns",["$rootScope","$filter","$translate",function(e,t,r){var o=[{dataKey:"userCompany",_title:"WRITE_OFF_REPORT.COLUMNS.COMPANY"},{dataKey:"userName",_title:"WRITE_OFF_REPORT.COLUMNS.NAME",defaultOrder:!0},{dataKey:"orderId",_title:"WRITE_OFF_REPORT.COLUMNS.ORDER_ID",styles:{halign:"right"}},{dataKey:"date",_title:"WRITE_OFF_REPORT.COLUMNS.DATE",styles:{halign:"right"},pdf:function(e){return t("date")(e,"mediumDate")},csv:function(e){return t("date")(e,"shortDate")}},{dataKey:"amount",_title:"WRITE_OFF_REPORT.COLUMNS.AMOUNT",styles:{halign:"right"},pdf:function(e){return t("ncurrency")(e)},csv:function(e){return t("ncurrency")(e)}}];function n(){o.forEach((function(e){e.title=r.instant(e._title)}))}return n(),e.$on("$setTranslationsSuccess",n),o}])},pl6f:function(e,t,r){"use strict";t.a=angular.module("systemColors",["deskworks.helper"]).factory("systemColors",["$window","helper",function(e,t){var r={},o=angular.element('<div style="display: none"></div>');return o.append('<div class="text-text"></div>'),o.append('<div class="text-brand"></div>'),o.append('<div class="text-brand"></div>'),o.append('<div class="text-danger"></div>'),o.append("<div></div>"),o.append('<div class="sidebar-group-header"></div>'),document.body.appendChild(o[0]),r.text=t.rgb2hex(e.getComputedStyle(o.children()[0]).getPropertyValue("color"))||"#444",r.info=t.rgb2hex(e.getComputedStyle(o.children()[4]).getPropertyValue("color"))||"#4d4e4c",r.primary=t.rgb2hex(e.getComputedStyle(o.children()[5]).getPropertyValue("background-color"))||"#949594",r.warning=t.rgb2hex(e.getComputedStyle(o.children()[3]).getPropertyValue("color"))||"#ff9b00",o.remove(),r}])}}]);