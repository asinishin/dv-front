(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["import~._a"],{

/***/ "./assets/new-center-startup-workbook.xlsx":
/*!*************************************************!*\
  !*** ./assets/new-center-startup-workbook.xlsx ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (__webpack_require__.p + "./assets/new-center-startup-workbook.xlsx?_rev=8c5caafdc20958c74eedc8dc5b3f74d7");

/***/ }),

/***/ "./bundles/import sync recursive .*\\.tpl\\.html$":
/*!********************************************!*\
  !*** ./bundles/import sync .*\.tpl\.html$ ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./handsontable/import-handsontable.tpl.html": "./bundles/import/handsontable/import-handsontable.tpl.html",
	"./step-components/import-dashboard.tpl.html": "./bundles/import/step-components/import-dashboard.tpl.html",
	"./step-components/import-sheet-selector.tpl.html": "./bundles/import/step-components/import-sheet-selector.tpl.html",
	"./step-components/step-complete.tpl.html": "./bundles/import/step-components/step-complete.tpl.html",
	"./step-components/step-import.tpl.html": "./bundles/import/step-components/step-import.tpl.html",
	"./step-components/step-init.tpl.html": "./bundles/import/step-components/step-init.tpl.html",
	"./wizard/import.tpl.html": "./bundles/import/wizard/import.tpl.html"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./bundles/import sync recursive .*\\.tpl\\.html$";

/***/ }),

/***/ "./bundles/import sync recursive \\..+\\/.+\\.js$":
/*!*******************************************!*\
  !*** ./bundles/import sync \..+\/.+\.js$ ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./handsontable/handsontable.directive.js": "./bundles/import/handsontable/handsontable.directive.js",
	"./handsontable/ht-body-extra.directive.js": "./bundles/import/handsontable/ht-body-extra.directive.js",
	"./handsontable/ht-header-extra.directive.js": "./bundles/import/handsontable/ht-header-extra.directive.js",
	"./handsontable/ht-row-extra.directive.js": "./bundles/import/handsontable/ht-row-extra.directive.js",
	"./handsontable/import-handsontable.directive.js": "./bundles/import/handsontable/import-handsontable.directive.js",
	"./services/auto-map-columns.service.js": "./bundles/import/services/auto-map-columns.service.js",
	"./services/collect-stats.service.js": "./bundles/import/services/collect-stats.service.js",
	"./services/detect-head-row-idx.service.js": "./bundles/import/services/detect-head-row-idx.service.js",
	"./services/detect-subgroups.service.js": "./bundles/import/services/detect-subgroups.service.js",
	"./services/excel.service.js": "./bundles/import/services/excel.service.js",
	"./services/init-meta-data.service.js": "./bundles/import/services/init-meta-data.service.js",
	"./services/parsers.service.js": "./bundles/import/services/parsers.service.js",
	"./services/purge.service.js": "./bundles/import/services/purge.service.js",
	"./services/sheet-detector.service.js": "./bundles/import/services/sheet-detector.service.js",
	"./services/srip-data-comments.service.js": "./bundles/import/services/srip-data-comments.service.js",
	"./services/validate-cell.service.js": "./bundles/import/services/validate-cell.service.js",
	"./services/validate-data.service.js": "./bundles/import/services/validate-data.service.js",
	"./services/wire-data.service.js": "./bundles/import/services/wire-data.service.js",
	"./step-components/step-complete.component.js": "./bundles/import/step-components/step-complete.component.js",
	"./step-components/step-import.component.js": "./bundles/import/step-components/step-import.component.js",
	"./step-components/step-init.component.js": "./bundles/import/step-components/step-init.component.js",
	"./step-fields/fields-members.service.js": "./bundles/import/step-fields/fields-members.service.js",
	"./step-fields/fields-membership-products.service.js": "./bundles/import/step-fields/fields-membership-products.service.js",
	"./step-fields/fields-other-products.service.js": "./bundles/import/step-fields/fields-other-products.service.js",
	"./step-fields/fields-reservation-categories.service.js": "./bundles/import/step-fields/fields-reservation-categories.service.js",
	"./step-fields/fields-reservation-units.service.js": "./bundles/import/step-fields/fields-reservation-units.service.js",
	"./step-hooks/hooks-members.service.js": "./bundles/import/step-hooks/hooks-members.service.js",
	"./step-hooks/hooks-membership-products.service.js": "./bundles/import/step-hooks/hooks-membership-products.service.js",
	"./step-hooks/hooks-other-products.service.js": "./bundles/import/step-hooks/hooks-other-products.service.js",
	"./step-hooks/hooks-reservation-categories.service.js": "./bundles/import/step-hooks/hooks-reservation-categories.service.js",
	"./step-hooks/hooks-reservation-units.service.js": "./bundles/import/step-hooks/hooks-reservation-units.service.js",
	"./wizard/import.controller.js": "./bundles/import/wizard/import.controller.js",
	"./wizard/steps.service.js": "./bundles/import/wizard/steps.service.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./bundles/import sync recursive \\..+\\/.+\\.js$";

/***/ }),

/***/ "./bundles/import/handsontable/handsontable.directive.js":
/*!***************************************************************!*\
  !*** ./bundles/import/handsontable/handsontable.directive.js ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var handsontable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! handsontable */ "../node_modules/handsontable/dist/handsontable.js");
/* harmony import */ var handsontable__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(handsontable__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _handsontable_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./handsontable.scss */ "./bundles/import/handsontable/handsontable.scss");
/* harmony import */ var _handsontable_scss__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_handsontable_scss__WEBPACK_IMPORTED_MODULE_1__);


/**
 * handsontable directive - wrapper for Handsontable component (Excel-like grid)
 *
 * Example of manual col-headers generation:
    colHeaders: function(col) {
      var charHi = Math.floor(col / 26);
      var charLo = col % 26;
      var code = charHi ? String.fromCharCode(65 + charHi - 1, 65 + charLo) : String.fromCharCode(65 + charLo);
      return '<span ht-col="' + col + '">' + code + '</span>';
    }
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.handsontable', ['deskworks.handsontable.htHeaderExtra', 'deskworks.handsontable.htRowExtra', 'deskworks.handsontable.htBodyExtra']).directive('handsontable', function () {
  window.Handsontable = handsontable__WEBPACK_IMPORTED_MODULE_0___default.a;
  return {
    restrict: 'E',
    scope: true,
    controller: 'HandsontableCtrl as ht',
    bindToController: {
      data: '<htData',
      renderer: '<htRenderer',
      manualColumnWidths: '<htManualColumnWidths'
    },
    compile: function compile() {
      return function link($scope, $element, $attrs, ht) {
        if (!window.Handsontable) return console.error('Handsontable component is not found.'); // ht.instance = new Handsontable($element[0], ht.settings);

        /**
         * Watch for handsontable data and update settings
         */

        $scope.$watch('ht.data', function (val) {
          if (!angular.isArray(val) || !angular.isArray(val[0])) return;
          ht.settings.data = val;

          if (ht.instance) {
            ht.instance.updateSettings(ht.settings);
          } else {
            ht.instance = new handsontable__WEBPACK_IMPORTED_MODULE_0___default.a($element[0], ht.settings);
          }

          $scope.$broadcast('ht:dataChange', ht.settings.data);
        });
        /**
         * Destroy event handler
         */

        $scope.$on('$destroy', function () {
          if (ht.instance) {
            ht.instance.destroy();
            delete ht.instance;
          }
        });
      };
    }
  };
}).controller('HandsontableCtrl', ["$scope", "$element", "$attrs", "$timeout", function ($scope, $element, $attrs, $timeout) {
  var _arguments = arguments;
  var ht = this; // Hack for fixing vertical scrolling with cursor over handsontable

  var hti = document.getElementById('htImport');
  var origAddEventListener = hti.addEventListener;

  hti.addEventListener = function (eventName) {
    if (eventName === 'wheel') return; // don't allow to bind to wheel event as it breaks vertical scrolling

    return origAddEventListener.apply(hti, _arguments);
  };

  ht.settings = {
    data: ht.data,
    rowHeaders: true,
    colHeaders: true,
    manualColumnResize: true,
    autoWrapRow: true,
    autoWrapCol: true,
    autoInsertRow: false,
    autoRowSize: true,
    autoColumnSize: true,
    allowInsertColumn: false,
    enterBeginsEditing: false,
    // renderAllRows: true,
    // viewportColumnRenderingOffset: 100, // prevent disappearing columns on horizontal scroll
    cells: function cells() {
      return {
        renderer: ht.renderer
      };
    },
    contextMenu: ['row_above', 'row_below', 'remove_row'],
    afterSelectionEnd: function afterSelectionEnd(row, col) {
      $scope.$apply(function () {
        $scope.$emit('ht:afterSelection', row, col);
      });
    },
    afterDeselect: function afterDeselect() {
      $scope.$apply(function () {
        $scope.$emit('ht:afterDeselect');
      });
    },
    afterChange: function afterChange() {
      // if($scope.$root.$$phase) return $scope.$emit('ht:afterChange');
      if ($scope.$root.$$phase) return;
      $scope.$apply(function () {
        $scope.$emit('ht:afterChange');
      });
    },
    afterRender: function afterRender() {
      // if($scope.$root.$$phase) return $scope.$emit('ht:afterRender');
      if ($scope.$root.$$phase) return $timeout(function () {
        $scope.$emit('ht:afterRender');
      });
      $scope.$apply(function () {
        $scope.$emit('ht:afterRender');
      });
    },
    afterCreateRow: function afterCreateRow(index, count) {
      $scope.$apply(function () {
        $scope.$emit('ht:afterCreateRow', index, count);
      });
    },
    afterRemoveRow: function afterRemoveRow(index, count) {
      $scope.$apply(function () {
        $scope.$emit('ht:afterRemoveRow', index, count);
      });
    },

    /**
     * Init. Wires widths of manualColumnResize plugin to sheet
     */
    init: function init() {
      var self = this;
      self.getPlugin('manualColumnResize').manualColumnWidths = ht.manualColumnWidths || [];
    },

    /**
     * Re-init. Wires widths of manualColumnResize plugin to sheet and re-calculates row heights
     */
    afterUpdateSettings: function afterUpdateSettings() {
      var self = this;
      self.getPlugin('manualColumnResize').manualColumnWidths = ht.manualColumnWidths || [];
      self.getPlugin('autoRowSize').recalculateAllRowsHeight();
    },

    /**
     * afterGetColHeader marks col-headers with its index to let col-extras know which col their bound to
     */
    afterGetColHeader: function afterGetColHeader(col, th) {
      if (col >= 0) th.setAttribute('htcol', col);
    },

    /**
     * afterGetRowHeader marks row-headers with its index to let row-extras know which row their bound to
     */
    afterGetRowHeader: function afterGetRowHeader(row, th) {
      if (row >= 0) th.setAttribute('htrow', row);
    }
  };
  /**
   * Commits value selected in cell extra drop-down to active editor
   */

  $scope.$on('ht:commitValue', function ($event, value) {
    var editor = ht.instance.getActiveEditor();

    if (editor && editor._opened) {
      editor.setValue(value);
      editor.focus();
      editor.close();
    }
  });
  /**
   * Force rendering handsontable
   */

  $scope.$on('ht:render', function () {
    if (ht.instance) ht.instance.render();
  });
}]));

/***/ }),

/***/ "./bundles/import/handsontable/handsontable.scss":
/*!*******************************************************!*\
  !*** ./bundles/import/handsontable/handsontable.scss ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by extract-css-chunks-webpack-plugin

/***/ }),

/***/ "./bundles/import/handsontable/ht-body-extra.directive.js":
/*!****************************************************************!*\
  !*** ./bundles/import/handsontable/ht-body-extra.directive.js ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.string.replace.js */ "../node_modules/core-js/modules/es.string.replace.js");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__);



/**
 * Defines body cell extra for Handsontable. For example, tooltips.
 * Template code is compiled automatically and child scope auto-managed.
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.handsontable.htBodyExtra', []).directive('htBodyExtra', ["$compile", function ($compile) {
  return {
    restrict: 'E',
    require: '^handsontable',
    compile: function compile(tElement, tAttrs) {
      var bodyExtraTpl = tElement.html(); // store ht-extra template

      tElement.remove(); // remove itself from dom, the template is already stored

      return function link($scope, $element, $attrs, ht) {
        var htElem = $element.parent()[0]; // parent Handsontable element

        if (!ht.bodyExtraElement) {
          // create extra body element
          ht.bodyExtraElement = $compile(bodyExtraTpl.replace(/\$row/g, 'ht.erow').replace(/\$col/g, 'ht.ecol'))($scope).addClass('ht-body-extra');
        }
        /**
         * Handsontable:afterRender event handler.
         * Creates extras, shows/hides/positions them on rendered grid.
         */


        $scope.$on('ht:afterRender', function ($event) {
          $event.stopPropagation();
          var extrasContainer = angular.element(htElem.querySelector('.ht_master .wtSpreader'));

          if (!extrasContainer[0].querySelector('.ht-body-extra')) {
            extrasContainer.append(ht.bodyExtraElement);
          }

          ht.repositionBodyExtra();
        });
        /**
         * Repositions body extra element according to ht.erow and ht.ecol
         */

        ht.repositionBodyExtra = function () {
          if (ht.erow >= 0 && ht.ecol >= 0) {
            var td = htElem.querySelector('td[rc="' + ht.erow + 'x' + ht.ecol + '"]');

            if (td) {
              ht.bodyExtraElement.css('top', td.offsetTop + 'px');
              ht.bodyExtraElement.css('left', Math.floor(td.offsetLeft + td.offsetWidth / 2) + 'px');
            }
          }
        };
        /**
         * Handsontable:afterSelection event handler, watches for selected cell and repositions body extra element
         */


        $scope.$on('ht:afterSelection', function ($event, row, col) {
          $event.stopPropagation();
          ht.erow = row;
          ht.ecol = col;
          ht.repositionBodyExtra();
        });
        /**
         * Handsontable:afterDeselect event handler, resets selected cell for body extra
         */

        $scope.$on('ht:afterDeselect', function ($event, row, col) {
          $event.stopPropagation();
          ht.erow = -1;
          ht.ecol = -1;
        });
      };
    }
  };
}]));

/***/ }),

/***/ "./bundles/import/handsontable/ht-header-extra.directive.js":
/*!******************************************************************!*\
  !*** ./bundles/import/handsontable/ht-header-extra.directive.js ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/helpers/slicedToArray */ "../node_modules/@babel/runtime-corejs3/helpers/slicedToArray.js");
/* harmony import */ var _babel_runtime_corejs3_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/concat */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/concat.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var handsontable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! handsontable */ "../node_modules/handsontable/dist/handsontable.js");
/* harmony import */ var handsontable__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(handsontable__WEBPACK_IMPORTED_MODULE_4__);





/**
 * Defines column header extra for Handsontable. For example, tooltips.
 * Template code is compiled automatically and child scopes auto-managed.
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.handsontable.htHeaderExtra', []).directive('htHeaderExtra', ["$timeout", function ($timeout) {
  return {
    scope: true,
    restrict: 'E',
    require: ['htHeaderExtra', '^handsontable'],
    controller: function controller() {},
    bindToController: {
      fields: '<htFields',
      availableFields: '<htAvailableFields',
      mapping: '<htMapping'
    },
    compile: function compile(tElement, tAttrs) {
      tElement.remove(); // remove itself from dom, the template is already stored

      return function link($scope, $element, $attrs, controllers) {
        var _controllers = _babel_runtime_corejs3_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(controllers, 2),
            $ctrl = _controllers[0],
            ht = _controllers[1];

        var container = $element.parent();

        ht.settings.colHeaders = function (colIdx) {
          var _context, _context2, _context5, _context6;

          var options = _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default()(_context = _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_2___default()(_context2 = [{
            name: 'UNKNOWN'
          }]).call(_context2, $ctrl.availableFields[colIdx])).call(_context, function (field) {
            var _context3, _context4;

            return _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_2___default()(_context3 = _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_2___default()(_context4 = "<option value=\"".concat(field.id || '', "\" ")).call(_context4, $ctrl.mapping[colIdx] === field.id ? 'selected' : '', ">")).call(_context3, field.name, "</option>");
          });

          var unmappedFieldsLength = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default()(_context5 = $ctrl.fields).call(_context5, function (field) {
            return $ctrl.mapping.indexOf(field.id) < 0;
          }).length;

          var ngInvalid = !$ctrl.mapping[colIdx] && !!unmappedFieldsLength ? 'ng-invalid' : '';
          return _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_2___default()(_context6 = "<select class=\"ht-mapping-select form-control ff-select ff-control ".concat(ngInvalid, "\">")).call(_context6, options, "</select>");
        };

        $timeout(function () {
          var eventInterceptor = container[0].querySelector('.ht_clone_top .htCore');
          eventInterceptor.addEventListener('mousedown', function (event) {
            if (event.target.nodeName !== 'SELECT' || event.target.className.indexOf('ht-mapping-select') < 0) return;
            event.stopPropagation();
          });
          eventInterceptor.addEventListener('mouseup', function (event) {
            if (event.target.nodeName !== 'SELECT' || event.target.className.indexOf('ht-mapping-select') < 0) return;
            event.stopPropagation();
          });
          eventInterceptor.addEventListener('change', function (event) {
            if (event.target.nodeName !== 'SELECT' || event.target.className.indexOf('ht-mapping-select') < 0) return;
            event.stopPropagation();
            $scope.$apply(function () {
              var select = event.target;
              var colIdx = +select.parentNode.parentNode.parentNode.getAttribute('htcol');
              $ctrl.mapping[colIdx] = select.value;
            });
          });
        });
      };
    }
  };
}]));

/***/ }),

/***/ "./bundles/import/handsontable/ht-row-extra.directive.js":
/*!***************************************************************!*\
  !*** ./bundles/import/handsontable/ht-row-extra.directive.js ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.string.replace.js */ "../node_modules/core-js/modules/es.string.replace.js");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3__);





/**
 * Defines row header extra for Handsontable. For example, tooltips.
 * Template code is compiled automatically and child scopes auto-managed.
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.handsontable.htRowExtra', []).directive('htRowExtra', ["$compile", function ($compile) {
  return {
    restrict: 'E',
    require: '^handsontable',
    compile: function compile(tElement, tAttrs) {
      // Store ht-extra template
      var rowExtraTpl = tElement.html(); // Remove itself from dom, the template is already stored

      tElement.remove();
      return function link($scope, $element, $attrs, ht) {
        var htElem = $element.parent()[0]; // Parent Handsontable element

        /**
         * Handsontable:afterRender event handler.
         * Creates extras, shows/hides/positions them on rendered grid.
         */

        $scope.$on('ht:afterRender', function ($event) {
          //$event.stopPropagation();
          var extrasContainer = angular.element(htElem.querySelector('.ht_clone_left .wtSpreader')); // First rendering, create row extras

          if (!ht.rowExtraScopes) {
            if (angular.isArray(ht.settings.data) && angular.isArray(ht.settings.data[0])) {
              var _context;

              ht.rowExtraScopes = _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3___default()(_context = ht.settings.data).call(_context, function (fm, index) {
                var scope = $scope.$new();
                extrasContainer.append($compile(rowExtraTpl.replace(/\$row/g, index))(scope).addClass('ht-row-extra'));
                return scope;
              });
            }
          } // Hide all extras to show only necessary ones later


          angular.forEach(extrasContainer[0].querySelectorAll('.ht-row-extra'), function (tt) {
            tt.style.display = 'none';
          }); // Show and position extras for rendered THs

          angular.forEach(htElem.querySelectorAll('.ht_clone_left th[htrow]'), function (th) {
            var extra = extrasContainer[0].querySelectorAll('.ht-row-extra')[th.getAttribute('htrow')];
            extra.style.left = th.offsetLeft + 'px';
            extra.style.top = th.offsetTop + 'px';
            extra.style.width = th.offsetWidth + 'px';
            extra.style.height = th.offsetHeight + 'px';
            extra.style.display = '';
          });
        });
        /**
         * Destroys all extras to get new ones created on next rendering
         */

        function destroyExtras($event, data) {
          var extrasContainer = htElem.querySelector('.ht_clone_left .wtSpreader');

          if (ht.rowExtraScopes) {
            angular.element(extrasContainer.querySelectorAll('.ht-row-extra')).remove();
            angular.forEach(ht.rowExtraScopes, function (scope) {
              scope.$destroy();
            });
            delete ht.rowExtraScopes;
          }
        }

        $scope.$on('ht:afterCreateRow', destroyExtras);
        $scope.$on('ht:afterRemoveRow', destroyExtras);
        $scope.$on('ht:dataChange', destroyExtras);
      };
    }
  };
}]));

/***/ }),

/***/ "./bundles/import/handsontable/import-handsontable.directive.js":
/*!**********************************************************************!*\
  !*** ./bundles/import/handsontable/import-handsontable.directive.js ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/slice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/slice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/concat */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/concat.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/splice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/splice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _import_handsontable_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./import-handsontable.scss */ "./bundles/import/handsontable/import-handsontable.scss");
/* harmony import */ var _import_handsontable_scss__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_import_handsontable_scss__WEBPACK_IMPORTED_MODULE_7__);








/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importHandsontable', ['deskworks.helper', 'deskworks.dwAlerts', 'deskworks.importStripDataComments', 'deskworks.importDetectHeadRowIdx', 'deskworks.importAutoMapColumns']).directive('importHandsontable', function () {
  return {
    restrict: 'E',
    scope: true,
    templateUrl: 'handsontable/import-handsontable.tpl.html',
    controller: 'ImportHandsontableCtrl as $ctrl',
    bindToController: {
      step: '<',
      sheet: '<',
      fields: '<',
      onValidate: '&',
      unMappedFields: '='
    }
  };
}).controller('ImportHandsontableCtrl', ["$scope", "$window", "$timeout", "dwAlerts", "helper", "importStripDataComments", "importDetectHeadRowIdx", "importAutoMapColumns", function ($scope, $window, $timeout, dwAlerts, helper, importStripDataComments, importDetectHeadRowIdx, importAutoMapColumns) {
  var $ctrl = this;
  $scope.$watch('$ctrl.sheet', function () {
    if (!$ctrl.sheet) return;

    if (!$ctrl.sheet.mappedToStep) {
      importStripDataComments($ctrl.sheet.data);
      $ctrl.sheet.headRowIdx = importDetectHeadRowIdx($ctrl.sheet.data, $ctrl.fields);
      $ctrl.sheet.mapping = importAutoMapColumns($ctrl.sheet.data, $ctrl.fields, $ctrl.sheet.headRowIdx);

      if ($ctrl.sheet.headRowIdx >= 0) {
        // sheet auto-mapped successfully
        $ctrl.sheet.mappedToStep = $ctrl.step;
        $ctrl.sheet.rowsMeta = createRowsMeta($ctrl.sheet.data);
        ignorePreHeaderRows($ctrl.sheet);
      } else {
        $ctrl.sheet.rowsMeta = $ctrl.sheet.rowsMeta || createRowsMeta($ctrl.sheet.data);
      }
    }

    $timeout(function () {
      $scope.$broadcast('ht:render');
    }); // workaround for partly rendered table vertically
  });

  function createRowsMeta(data) {
    return _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default()(data).call(data, function (row) {
      var _context;

      return {
        cellsMeta: _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default()(_context = Array.apply(null, Array(row.length))).call(_context, function () {
          return {};
        })
      };
    });
  }

  function ignorePreHeaderRows(sheet) {
    var _context2;

    if (sheet.headRowIdx < 0) return sheet;

    _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_2___default()(_context2 = sheet.rowsMeta).call(_context2, 0, sheet.headRowIdx).forEach(function (rowMeta) {
      rowMeta.ignore = true;
    });

    sheet.rowsMeta[sheet.headRowIdx].headRow = true;
    return sheet;
  }

  $scope.$watch('$ctrl.sheet.mapping', function (mapping) {
    var _context3;

    if (!mapping) return;
    $ctrl.unMappedFields = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default()(_context3 = $ctrl.fields).call(_context3, function (field) {
      return mapping.indexOf(field.id) < 0;
    });
    $ctrl.availableFields = _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default()(mapping).call(mapping, function (id) {
      var _context4;

      return _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default()(_context4 = $ctrl.fields).call(_context4, function (field) {
        return field.id === id || mapping.indexOf(field.id) < 0;
      });
    });
    $ctrl.mappingFields = _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default()(mapping).call(mapping, function (id) {
      var _context5;

      return _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(_context5 = $ctrl.fields).call(_context5, function (obj) {
        return obj.id === id;
      });
    });
    $ctrl.onValidate();
  }, true);
  /**
   * Handsontable:afterCreateRow handler, syncs sheet.rowsMeta to just changed sheet.data
   */

  $scope.$on('ht:afterCreateRow', function ($event, index, count) {
    var _context6, _context7, _context9, _context10;

    $event.stopPropagation();
    if ($ctrl.sheet.headRowIdx >= index) $ctrl.sheet.headRowIdx += count; // shift sheet.headRowIdx

    var start = _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_2___default()(_context6 = $ctrl.sheet.rowsMeta).call(_context6, 0, index);

    var mid = _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default()(_context7 = Array.apply(null, Array(count))).call(_context7, function () {
      var _context8;

      return {
        cellsMeta: _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_1___default()(_context8 = Array.apply(null, Array($ctrl.sheet.data[0].length))).call(_context8, function () {
          return {};
        })
      };
    });

    var end = _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_2___default()(_context9 = $ctrl.sheet.rowsMeta).call(_context9, index);

    $ctrl.sheet.rowsMeta = _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_5___default()(_context10 = _babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_5___default()(start).call(start, mid)).call(_context10, end);
    $ctrl.onValidate();
  });
  /**
   * Handsontable:afterRemoveRow handler, syncs sheet.rowsMeta to just changed sheet.data
   */

  $scope.$on('ht:afterRemoveRow', function ($event, index, count) {
    var _context11;

    $event.stopPropagation();
    if ($ctrl.sheet.headRowIdx >= index + count) $ctrl.sheet.headRowIdx -= count; // shift sheet.headRowIdx
    else if ($ctrl.sheet.headRowIdx >= index) $ctrl.sheet.headRowIdx = -1;

    _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6___default()(_context11 = $ctrl.sheet.rowsMeta).call(_context11, index, count);

    $ctrl.onValidate();
  });
  /**
   * Handsontable:afterChange handler, re-validates data
   */

  $scope.$on('ht:afterChange', function ($event) {
    $event.stopPropagation();
    $ctrl.onValidate();
  });
  /**
   * Custom cell renderer for Handsontable
   */

  $ctrl.cellRenderer = function (instance, td, rowIdx, colIdx, prop, value, cellProperties) {
    td.innerHTML = value;
    td = angular.element(td);
    if (!$ctrl.sheet.rowsMeta || !$ctrl.sheet.rowsMeta[rowIdx] || !$ctrl.sheet.rowsMeta[rowIdx].cellsMeta || !$ctrl.sheet.rowsMeta[rowIdx].cellsMeta[colIdx]) return;

    if ($ctrl.sheet.rowsMeta[rowIdx].cellsMeta[colIdx].invalid) {
      td.addClass('ht-invalid');
      td[0].innerHTML += '<span class="fa fa-exclamation-triangle"></span>';
    }

    if ($ctrl.sheet.rowsMeta[rowIdx].headRow) td.addClass('ht-head-row');
    if ($ctrl.sheet.rowsMeta[rowIdx].ignore) td.addClass('ht-ignore');
    td.attr('rc', rowIdx + 'x' + colIdx); // mark each TD with its own coordinates

    return td[0];
  };
  /**
   * Row Icon click handler
   */


  $ctrl.onClickRowIcon = function (rowIdx) {
    var rowMeta = $ctrl.sheet.rowsMeta[rowIdx];
    if (rowMeta.headRow) return;
    rowMeta.ignore = !rowMeta.ignore;
    $ctrl.onValidate();
  };
  /**
   * Select Valid Data select onChange event handler. Commits change, checks for smart replacement and runs validation.
   */


  $ctrl.onSelectValidData = function (newVal, $row, $col) {
    var dupCount = $ctrl.sheet.data // detect smart replacement
    .reduce(function (sum, row, ri) {
      return $ctrl.sheet.rowsMeta[ri].invalid && (row[$col] || '') === ($ctrl.sheet.data[$row][$col] || '') ? ++sum : sum;
    }, 0);

    if (dupCount > 1) {
      var _context12;

      // confirm smart replacement
      var field = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(_context12 = $ctrl.fields).call(_context12, function (obj) {
        return obj.id === $ctrl.sheet.mapping[$col];
      });

      var text = '"' + field.name + '" column contains more "' + ($ctrl.sheet.data[$row][$col] || 'empty') + '" occurrences. Fix them all to "' + newVal + '" automatically?';

      if (confirm(text)) {
        for (var ri = 0; ri < $ctrl.sheet.data.length; ri++) {
          if (ri !== $row && $ctrl.sheet.rowsMeta[ri].invalid && ($ctrl.sheet.data[ri][$col] || '') === ($ctrl.sheet.data[$row][$col] || '')) {
            $ctrl.sheet.data[ri][$col] = newVal;
          }
        }
      }
    }

    $ctrl.sheet.data[$row][$col] = newVal; // commit value

    $scope.$broadcast('ht:commitValue', newVal);
    $ctrl.onValidate();
  };
}]));

/***/ }),

/***/ "./bundles/import/handsontable/import-handsontable.scss":
/*!**************************************************************!*\
  !*** ./bundles/import/handsontable/import-handsontable.scss ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by extract-css-chunks-webpack-plugin

/***/ }),

/***/ "./bundles/import/handsontable/import-handsontable.tpl.html":
/*!******************************************************************!*\
  !*** ./bundles/import/handsontable/import-handsontable.tpl.html ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Module
var code = "<handsontable id=\"htImport\" class=\"ht-import\" ht-data=\"$ctrl.sheet.data\" ht-rows-meta=\"$ctrl.sheet.rowsMeta\" ht-renderer=\"$ctrl.cellRenderer\" ht-manual-column-widths=\"$ctrl.sheet.manualColumnWidths\"> <ht-header-extra ht-fields=\"$ctrl.fields\" ht-available-fields=\"$ctrl.availableFields\" ht-mapping=\"$ctrl.sheet.mapping\"></ht-header-extra> <ht-row-extra> <div class=\"ht-row-extra\" ng-init=\"rowMeta = $ctrl.sheet.rowsMeta[$row]\" ng-show=\"!$ctrl.unMappedFields.length\"> <ff-icon sense=\"error\" ng-if=\"rowMeta.error && rowMeta.ignore\" ng-click=\"$ctrl.onClickRowIcon($row)\" title=\"{{rowMeta.error}}\"> </ff-icon> <ff-icon sense=\"warning\" ng-if=\"rowMeta.invalid && !rowMeta.ignore\" ng-click=\"$ctrl.onClickRowIcon($row)\" title=\"This row contains invalid values. Fix them or click this icon to ignore this row.\"></ff-icon> <ff-icon sense=\"check\" ng-if=\"rowMeta.id && !rowMeta.invalid && rowMeta.ignore && !rowMeta.error\" ng-click=\"$ctrl.onClickRowIcon($row)\" title=\"Existing data, this row will not be imported.\"></ff-icon> <ff-icon sense=\"refresh\" ng-if=\"rowMeta.id && !rowMeta.invalid && !rowMeta.ignore\" ng-click=\"$ctrl.onClickRowIcon($row)\" ng-class=\"{ rotate: rowMeta.spin }\" title=\"Existing data, this row will be updated.\"></ff-icon> <ff-icon sense=\"plus\" ng-if=\"!rowMeta.id && !rowMeta.ignore && !rowMeta.headRow && !rowMeta.empty && !rowMeta.invalid\" ng-click=\"$ctrl.onClickRowIcon($row)\" ng-class=\"{ rotate: rowMeta.spin }\" title=\"This row is new and will be imported.\"></ff-icon> <ff-icon sense=\"ignore\" ng-if=\"!rowMeta.id && rowMeta.ignore && !rowMeta.error\" ng-click=\"$ctrl.onClickRowIcon($row)\" title=\"This row is ignored. Click this icon to stop ignoring this row.\"></ff-icon> <ff-icon sense=\"header\" ng-if=\"rowMeta.headRow\" ng-click=\"$ctrl.onClickRowIcon($row)\" title=\"This row is recognized as header.\"></ff-icon> </div> </ht-row-extra> <ht-body-extra> <div class=\"itooltip ht-body-tooltip\" ng-show=\"$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid\"> <span ng-if=\"$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isString\" ng-bind-html=\"$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid\"></span> <ff-select ff-model=\"newVal\" ff-options=\"opt.name as opt.name for opt in $ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid\" ff-change=\"$ctrl.onSelectValidData(newVal, $row, $col)\" ng-if=\"$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isArray\"> <option value=\"\">please select</option> </ff-select> </div> </ht-body-extra> </handsontable> ";
// Exports
module.exports = code;

/***/ }),

/***/ "./bundles/import/index.js":
/*!*********************************!*\
  !*** ./bundles/import/index.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.replace.js */ "../node_modules/core-js/modules/es.string.replace.js");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_keys__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/keys */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/keys.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_keys__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_keys__WEBPACK_IMPORTED_MODULE_4__);





var index = ['$injector', function index($injector) {
  // JS
  var importAll = function importAll(r) {
    var _context;

    return _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3___default()(_context = _babel_runtime_corejs3_core_js_stable_instance_keys__WEBPACK_IMPORTED_MODULE_4___default()(r).call(r)).call(_context, r);
  };

  var js = importAll(__webpack_require__("./bundles/import sync recursive \\..+\\/.+\\.js$"));
  $injector.loadNewModules(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3___default()(js).call(js, function (m) {
    return m.default.name;
  })); // Templates

  $injector.invoke(['$templateCache', function ($templateCache) {
    var ctx = __webpack_require__("./bundles/import sync recursive .*\\.tpl\\.html$");

    _babel_runtime_corejs3_core_js_stable_instance_keys__WEBPACK_IMPORTED_MODULE_4___default()(ctx).call(ctx).forEach(function (key) {
      return $templateCache.put(key.replace(/^\.\//, ''), ctx(key));
    });
  }]);
}];
/* harmony default export */ __webpack_exports__["default"] = (index);

/***/ }),

/***/ "./bundles/import/services/auto-map-columns.service.js":
/*!*************************************************************!*\
  !*** ./bundles/import/services/auto-map-columns.service.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.string.match.js */ "../node_modules/core-js/modules/es.string.match.js");
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/slice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/slice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/splice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/splice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_5__);







/**
 * Maps import columns to given 'array of arrays' presentation of Excel sheet
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importAutoMapColumns', []).factory('importAutoMapColumns', ["helper", function (helper) {
  return function (data, columns, headRowIdx) {
    var _context, _context2;

    if (!angular.isArray(columns) || !angular.isArray(data)) return;
    if (headRowIdx < 0) return _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_2___default()(_context = Array.apply(null, Array(data[0].length))).call(_context, function () {
      return null;
    });

    var columnsPool = _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3___default()(columns).call(columns); // shallow copy columns as we are going to delete mapped columns


    return _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_2___default()(_context2 = data[headRowIdx]).call(_context2, function (cell) {
      for (var mi = 0; mi < columnsPool.length; mi++) {
        if (_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4___default()(helper).call(helper, cell).match(columnsPool[mi].pattern)) {
          return _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_5___default()(columnsPool).call(columnsPool, mi, 1)[0].id; // remove matched column to prevent mapping twice
        }
      }
    });
  };
}]));

/***/ }),

/***/ "./bundles/import/services/collect-stats.service.js":
/*!**********************************************************!*\
  !*** ./bundles/import/services/collect-stats.service.js ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);


/**
 * Collect stats for rowsMeta
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importCollectStats', []).factory('importCollectStats', function () {
  return function (rowsMeta) {
    var stats = {
      create: 0,
      update: 0,
      existing: 0,
      ignore: 0,
      invalid: 0,
      error: 0
    };
    angular.forEach(rowsMeta, function (rowMeta) {
      if (rowMeta.ignore && !rowMeta.headRow && !rowMeta.id) stats.ignore++;
      if (!rowMeta.id && !rowMeta.ignore && !rowMeta.headRow && !rowMeta.empty && !rowMeta.invalid) stats.create++;
      if (rowMeta.id && !rowMeta.ignore && !rowMeta.invalid) stats.update++;
      if (rowMeta.id && rowMeta.ignore) stats.existing++;
      if (rowMeta.invalid) stats.invalid++;
      if (rowMeta.error && rowMeta.ignore) stats.error++;
    });
    return stats;
  };
}));

/***/ }),

/***/ "./bundles/import/services/detect-head-row-idx.service.js":
/*!****************************************************************!*\
  !*** ./bundles/import/services/detect-head-row-idx.service.js ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.match.js */ "../node_modules/core-js/modules/es.string.match.js");
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/slice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/slice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/splice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/splice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6__);








/**
 * Detects 'head row' index in given 'array of arrays' presentation of Excel sheet
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importDetectHeadRowIdx', []).factory('importDetectHeadRowIdx', ["helper", function (helper) {
  return function (data, columns) {
    var _context;

    if (!angular.isArray(columns) || !angular.isArray(data)) return;

    var columnsPool = _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3___default()(columns).call(columns); // shallow copy columns as we are going to delete mapped columns


    var rowRanks = _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4___default()(_context = _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3___default()(data).call(data, 0, 5) // first 5 rows
    ).call(_context, function (row) {
      var rowRank = 0;
      row.forEach(function (cell) {
        for (var mi = 0; mi < columnsPool.length; mi++) {
          if (_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, cell).match(columnsPool[mi].pattern)) {
            _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_6___default()(columnsPool).call(columnsPool, mi, 1); // remove matched column to prevent mapping twice


            rowRank++;
            break;
          }
        }
      });
      return rowRank;
    });

    var headRowIdx = rowRanks.indexOf(Math.max.apply(Math, rowRanks));
    var headRowRank = rowRanks[headRowIdx]; // Accept headRow only if number of matches is at least 2/3 of total columns length

    return headRowRank >= columns.length / 1.5 ? headRowIdx : -1;
  };
}]));

/***/ }),

/***/ "./bundles/import/services/detect-subgroups.service.js":
/*!*************************************************************!*\
  !*** ./bundles/import/services/detect-subgroups.service.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/slice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/slice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3__);





/**
 * Detects subgroups in sheet data
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importDetectSubgroups', ['deskworks.helper']).factory('importDetectSubgroups', ["helper", function (helper) {
  return function ($ctrl, sheet, fields) {
    var subgroups = fields.reduce(function (subgroups, field) {
      // collect subgroups
      var subgroup = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(subgroups).call(subgroups, function (obj) {
        return obj.id === (field.subgroup || 'nosubgroup');
      });

      if (!subgroup) {
        subgroup = {
          id: field.subgroup,
          fields: []
        };
        subgroups.push(subgroup);
      }

      subgroup.fields.push(field);
      return subgroups;
    }, [{
      id: 'nosubgroup',
      fields: []
    }]);
    sheet.data // apply group to each row
    .forEach(function (row, ri) {
      var rowMeta = sheet.rowsMeta[ri];
      if (rowMeta.empty || rowMeta.headRow) return;
      subgroups.forEach(function (subgroup) {
        subgroup.nonEmptyCount = subgroup.fields.reduce(function (count, field) {
          return _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[sheet.mapping.indexOf(field.id)]) ? ++count : count;
        }, 0);
      });

      if (!subgroups[0].nonEmptyCount && subgroups.length > 1) {
        // subgroup
        var subgroup = _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_3___default()(subgroups).call(subgroups, 1, subgroups.length).reduce(function (prevSubgroup, subgroup) {
          return !prevSubgroup || subgroup.nonEmptyCount > prevSubgroup.nonEmptyCount ? subgroup : prevSubgroup;
        });

        rowMeta.subgroup = subgroup.id;
        var subgroupKeyIndex = helper.findIndexByKeyValue(fields, 'subgroupKey', true);

        if (subgroupKeyIndex >= 0 && !row[subgroupKeyIndex] && angular.isUndefined(rowMeta.ignore)) {
          rowMeta.ignore = true;
        }
      }
    });
  };
}]));

/***/ }),

/***/ "./bundles/import/services/excel.service.js":
/*!**************************************************!*\
  !*** ./bundles/import/services/excel.service.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! xlsx */ "../node_modules/xlsx/xlsx.js");
/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_2__);



/**
 * Excel (.xls/.xlsx) document reader, converts to 'array of arrays' format, based on XLSX component
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.excel', []).service('excel', ["$q", "helper", function ($q, helper) {
  var self = this;
  /**
   * Read Excel document and convert to 'array of arrays' format
   */

  self.read = function (file) {
    return $q(function (resolve) {
      var fileReader = new FileReader();

      fileReader.onload = function (e) {
        var sheets = []; // Read Excel workbook via XLSX component

        var workbook = xlsx__WEBPACK_IMPORTED_MODULE_2___default.a.read(e.target.result, {
          type: 'binary'
        }); // HTML -> plain text decoder (set innerHTML, get value)

        var decoder = document.createElement('textarea'); // Process all sheets in Excel

        angular.forEach(workbook.SheetNames, function (sheetName) {
          var sheet = workbook.Sheets[sheetName];
          var range = getTrimmedRange(sheet);
          var rows = []; // Iterate through rows and expand sheet data to matrix (array of arrays)

          for (var ri = range.s.r; ri <= range.e.r; ri++) {
            var cols = []; // Iterate through cols and accumulate row

            for (var ci = range.s.c; ci <= range.e.c; ci++) {
              var cell = sheet[xlsx__WEBPACK_IMPORTED_MODULE_2___default.a.utils.encode_cell({
                r: ri,
                c: ci
              })];
              cols.push(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, (cell || {}).w || ''));
            } // Decode HTML entities and tags to plain text


            decoder.innerHTML = sheetName; // Store converted row

            rows.push(cols);
          } // Store converted sheet


          sheets.push({
            name: decoder.value,
            data: rows
          }); // console.log('cell', angular.toJson(rows));
        });
        resolve(sheets);
      };

      fileReader.readAsBinaryString(file);
    });
  };
  /**
   * Get precised range from Excel sheet with trimming right/bottom whitespace.
   */


  function getTrimmedRange(sheet) {
    var range = xlsx__WEBPACK_IMPORTED_MODULE_2___default.a.utils.decode_range(sheet['!ref'] || 'A1:Z1000');
    var cellTrimMax = 0;
    var rowTrimMax = 0; // Iterate over rows to find last non-empty row within sheet range

    for (var ri = range.e.r; ri >= range.s.r; ri--) {
      var cellTrim = -1; // Iterate over cols to find last-non empty within sheet range

      for (var ci = range.e.c; ci >= range.s.c; ci--) {
        var cell = sheet[xlsx__WEBPACK_IMPORTED_MODULE_2___default.a.utils.encode_cell({
          r: ri,
          c: ci
        })]; // If current cell is non-empty, break cols-loop and store current index

        if (cell && angular.isDefined(cell.v) && cell.v !== null && cell.v !== '' && cellTrim < 0) {
          cellTrim = ci; // Store index of last non-empty column

          break;
        }
      } // Accumulate cellTrimMax -> range.e.c


      cellTrimMax = cellTrimMax > cellTrim ? cellTrimMax : cellTrim; // If current row is non-empty, store current index

      if (cellTrim >= 0 && !rowTrimMax) {
        rowTrimMax = ri; // Store index of last non-empty row
      }
    }

    return {
      s: {
        r: range.s.r,
        c: range.s.c
      },
      e: {
        r: rowTrimMax,
        c: cellTrimMax
      }
    };
  }
}]));

/***/ }),

/***/ "./bundles/import/services/init-meta-data.service.js":
/*!***********************************************************!*\
  !*** ./bundles/import/services/init-meta-data.service.js ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__);



/**
 * Initializes all sheet meta-data
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importInitMetaData', ['deskworks.helper']).factory('importInitMetaData', ["helper", function (helper) {
  return function (sheet) {
    sheet.rowsMeta.forEach(function (rowMeta, ri) {
      rowMeta.invalid = false; // mark everything as valid

      rowMeta.empty = true;
      rowMeta.id = null; // mark everything as un-wired

      rowMeta.subgroup = null;
      rowMeta.cellsMeta.forEach(function (cellMeta, ci) {
        cellMeta.invalid = false;
        rowMeta.empty = rowMeta.empty && !_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, sheet.data[ri][ci]);
      });
    });
  };
}]));

/***/ }),

/***/ "./bundles/import/services/parsers.service.js":
/*!****************************************************!*\
  !*** ./bundles/import/services/parsers.service.js ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.match.js */ "../node_modules/core-js/modules/es.string.match.js");
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/es.string.replace.js */ "../node_modules/core-js/modules/es.string.replace.js");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3__);





/**
 * Import parsers service - set of functions to parse each type during import
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importParsers', ['deskworks.helper']).service('importParsers', ["helper", function (helper) {
  var self = this;
  /**
   * Options type parser
   */

  self.options = function (data, options) {
    return helper.searchSoft(options, ['name', 'id', 'import'], data);
  };
  /**
   * bool type parser
   */


  self.bool = function (data) {
    return !!_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, data).match(/^Yes|Y|true$/i);
  };
  /**
   * int type parser
   */


  self.int = function (data) {
    data = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, data).replace(/,/g, '');
    return data.length ? parseInt(data) : undefined;
  };
  /**
   * uint type parser
   */


  self.uint = self.int;
  /**
   * float type parser
   */

  self.float = function (data) {
    data = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, data).replace(/,/g, '');
    return data.length ? parseFloat(data) : undefined;
  };
  /**
   * currency type parser
   */


  self.currency = function (data) {
    data = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, data).replace(/[,\$]/g, '');
    return data.length ? parseFloat(data) : undefined;
  };
  /**
   * ufloat type parser
   */


  self.ufloat = self.float;
  /**
   * date type parser
   */

  self.date = function (data) {
    var format;
    data = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, data); // 28 Mar 2015

    if (data.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)) {
      data = data.replace(/\s|-|\.|\//g, ' '); // Comb delimiters

      format = 'DD MMM YYYY';
    } // 03/28/2015
    else if (data.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)) {
        data = data.replace(/\s|-|\./g, '/'); // Comb delimiters

        format = 'MM/DD/YYYY';
      } // 2015-03-28
      else if (data.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)) {
          data = data.replace(/\s|-|\./g, '-'); // Comb delimiters

          format = 'YYYY-MM-DD';
        }

    if (format) {
      var date = moment(data, format);
      if (date.isValid()) return date;
    }
  };
}]));

/***/ }),

/***/ "./bundles/import/services/purge.service.js":
/*!**************************************************!*\
  !*** ./bundles/import/services/purge.service.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/**
 * Purge service - purges existing data during import
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.purge.service', ['ngResource', 'deskworks.config']).factory('purgeService', ["$resource", "deskworksConfig", function ($resource, deskworksConfig) {
  var resGlobal = $resource(deskworksConfig.getApiAbsUrl('/purge/:entity'));
  var resCenter = $resource(deskworksConfig.getApiAbsUrl('/purge/centers/:centerId/:entity'));
  return {
    purgeProducts: function purgeProducts(types) {
      return resGlobal.delete({
        entity: 'products',
        productTypes: types
      }).$promise;
    },
    purgePriceLists: function purgePriceLists(centerId) {
      return resCenter.delete({
        centerId: centerId,
        entity: 'price-lists'
      }).$promise;
    },
    purgeMembershipTypes: function purgeMembershipTypes() {
      return resGlobal.delete({
        entity: 'membership-types'
      }).$promise;
    },
    purgeReservationCategories: function purgeReservationCategories() {
      return resGlobal.delete({
        entity: 'reservation-types'
      }).$promise;
    },
    purgeReservationUnits: function purgeReservationUnits(centerId) {
      return resCenter.delete({
        centerId: centerId,
        entity: 'reservation-units'
      }).$promise;
    },
    purgeMembers: function purgeMembers() {
      return resGlobal.delete({
        entity: 'members'
      }).$promise;
    }
  };
}]));

/***/ }),

/***/ "./bundles/import/services/sheet-detector.service.js":
/*!***********************************************************!*\
  !*** ./bundles/import/services/sheet-detector.service.js ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.match.js */ "../node_modules/core-js/modules/es.string.match.js");
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__);




/**
 * Auto-detects sheet appropriate for each step
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importSheetDetector', ['deskworks.importSteps']).service('importSheetDetector', ["helper", "importSteps", function (helper, importSteps) {
  var self = this;
  /**
   * Detects sheet appropriate for given step
   */

  self.detect = function (sheets, step) {
    if (angular.isArray(sheets) && importSteps[step].sheetPattern) {
      for (var i = 0; i < sheets.length; i++) {
        if (_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, sheets[i].name).match(importSteps[step].sheetPattern)) {
          return sheets[i];
        }
      }
    }

    return (sheets || [])[0];
  };
}]));

/***/ }),

/***/ "./bundles/import/services/srip-data-comments.service.js":
/*!***************************************************************!*\
  !*** ./bundles/import/services/srip-data-comments.service.js ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/slice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/slice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/es.string.replace.js */ "../node_modules/core-js/modules/es.string.replace.js");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3__);





/**
 * Strip service comments from first 5 rows of excel data
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importStripDataComments', []).factory('importStripDataComments', function () {
  return function (data) {
    if (!angular.isArray(data)) return;

    _babel_runtime_corejs3_core_js_stable_instance_slice__WEBPACK_IMPORTED_MODULE_0___default()(data).call(data, 0, 5) // first 5 rows
    .forEach(function (row) {
      row.forEach(function (cell, ci) {
        row[ci] = cell.replace(/\(?PLEASE CHANGE SAMPLE DATA AS NEEDED\)?/i, '');
      });
    });
  };
}));

/***/ }),

/***/ "./bundles/import/services/validate-cell.service.js":
/*!**********************************************************!*\
  !*** ./bundles/import/services/validate-cell.service.js ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.string.replace.js */ "../node_modules/core-js/modules/es.string.replace.js");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.match.js */ "../node_modules/core-js/modules/es.string.match.js");
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_5__);







/**
 * Validates cell value according to field validators
 * @param data - data matrix with cell to validate
 * @param ri - row index
 * @param ci - cell index
 * @param fields - step fields
 * @param mapping - sheet fields mapping
 * @param $scope - $scope to $eval options expressions
 * @returns {*}
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importValidateCell', ['deskworks.helper']).factory('importValidateCell', ["helper", function (helper) {
  return function (data, ri, ci, rowsMeta, fields, mapping, $scope) {
    var field = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_3___default()(fields).call(fields, function (obj) {
      return obj.id === mapping[ci];
    });

    if (!field) return;

    var val = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4___default()(helper).call(helper, data[ri][ci]);
    /**
     * Options type validation
     */


    if (angular.isObject(field.type) && field.type.options) {
      if (field.required || val !== '') {
        var options;

        if (field.type.ref) {
          var ref = data[ri][mapping.indexOf(field.type.ref)]; // field value

          var refField = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_3___default()(fields).call(fields, function (obj) {
            return obj.id === field.type.ref;
          }); // field conf


          ref = helper.searchSoft(refField.type.options, ['id', 'name', 'import'], ref); // final field

          options = $scope.$eval(field.type.options.replace(/\$id/g, (ref || {}).id));
        } else {
          options = angular.isArray(field.type.options) ? field.type.options : $scope.$eval(field.type.options);
        }

        if (angular.isArray(options) && !helper.searchSoft(options, ['name', 'id', 'import'], val)) return options;
      }
    }
    /**
     * Required validation
     */


    if (field.required) {
      if (val === '') return field.name + ' is required.';
    } else if (val === '') {
      return; // if field is not required and empty, stop redundant validation
    }
    /**
     * Basic types validation
     */


    if (field.type === 'uint' && !val.match(/^\d*,?\d+$/i)) {
      return field.name + ' should be a positive integer number, e.g. 100 or 0';
    } else if (field.type === 'int' && !val.match(/^-?\d*,?\d+$/i)) {
      return field.name + ' should be an integer number, e.g. -10 or 50';
    } else if (field.type === 'ufloat' && !val.match(/^[\d,]*\.?\d+$/i)) {
      return field.name + ' should be a positive number, e.g. 10 or 10.50';
    } else if (field.type === 'float' && !val.match(/^-?[\d,]*\.?\d+$/i)) {
      return field.name + ' should be a number, e.g. 100 or -20 or 5.5';
    } else if (field.type === 'bool' && !val.match(/^Yes|No|Y|N|true|false$/i)) {
      return field.name + ' should be Yes/No, Y/N, true/false';
    } else if (field.type === 'currency' && !val.match(/^\$?[\d,]*\.?\d+$/i)) {
      return field.name + ' should be currency, e.g. $10 or $10.50 or 12.00';
    } else if (field.type === 'email' && !val.match(/^[\w\.%\+\-]+@(?:[A-Z0-9\-]+\.)+(?:[A-Z]+)$/i)) {
      return field.name + ' should be valid';
    } else if (field.type === 'date') {
      var format; // 28 Mar 2015

      if (val.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)) {
        val = val.replace(/\s|-|\.|\//g, ' '); // Comb delimiters

        format = 'DD MMM YYYY';
      } // 03/28/2015
      else if (val.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)) {
          val = val.replace(/\s|-|\./g, '/'); // Comb delimiters

          format = 'MM/DD/YYYY';
        } // 2015-03-28
        else if (val.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)) {
            val = val.replace(/\s|-|\./g, '-'); // Comb delimiters

            format = 'YYYY-MM-DD';
          }

      if (format && moment(val, format).isValid()) return;
      return field.name + ' format is 06/22/2015 or 22&nbsp;Jun&nbsp;2015';
    }
    /**
     * Min length validation
     */


    if (field.minLength) {
      if (val.length < field.minLength) return field.name + ' min length is ' + field.minLength;
    }
    /**
     * Unique value within col validation
     */


    if (field.unique) {
      var equalCount = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_5___default()(data).call(data, function (row, ri) {
        return !rowsMeta[ri].empty && !rowsMeta[ri].ignore && !rowsMeta[ri].headRow;
      }).reduce(function (sum, row) {
        return _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_4___default()(helper).call(helper, row[ci] || '').toLowerCase() === (val || '').toLowerCase() ? ++sum : sum;
      }, 0);

      if (equalCount > 1) return field.name + ' contains duplicate values. Must be unique.';
    }
    /**
     * Pattern type validation
     */


    if (angular.isObject(field.type) && field.type.pattern) {
      if (!val.match(field.type.pattern)) return field.type.msg;
    }
  };
}]));

/***/ }),

/***/ "./bundles/import/services/validate-data.service.js":
/*!**********************************************************!*\
  !*** ./bundles/import/services/validate-data.service.js ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__);



/**
 * Validates all sheet data
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importValidateData', ['deskworks.helper', 'deskworks.importValidateCell']).factory('importValidateData', ["helper", "importValidateCell", function (helper, importValidateCell) {
  return function (sheet, fields, $scope) {
    var invalidCount = 0;
    sheet.data.forEach(function (row, ri) {
      var rowMeta = sheet.rowsMeta[ri];
      var fieldsSet = fields;
      if (rowMeta.subgroup) fieldsSet = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0___default()(fields).call(fields, function (field) {
        return field.subgroup === rowMeta.subgroup;
      });
      rowMeta.invalid = fieldsSet.reduce(function (invalid, field) {
        var ci = sheet.mapping.indexOf(field.id);
        var cellMeta = rowMeta.cellsMeta[ci]; // skip empty and ignored rows

        if (rowMeta.empty || rowMeta.headRow || rowMeta.ignore) {
          cellMeta.invalid = false;
          return invalid;
        }

        cellMeta.invalid = importValidateCell(sheet.data, ri, ci, sheet.rowsMeta, fields, sheet.mapping, $scope);
        if (cellMeta.invalid) invalidCount++;
        return invalid || cellMeta.invalid;
      }, false);
    });
    return invalidCount;
  };
}]));

/***/ }),

/***/ "./bundles/import/services/wire-data.service.js":
/*!******************************************************!*\
  !*** ./bundles/import/services/wire-data.service.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);


/**
 * Wires sheet data to existing data
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importWireData', ['deskworks.helper', 'deskworks.importSteps']).factory('importWireData', ["helper", function (helper) {
  return function ($ctrl, sheet, fields, wireRow) {
    sheet.data // all fields mapped, proceed with wiring
    .forEach(function (row, ri) {
      var rowMeta = sheet.rowsMeta[ri];
      if (rowMeta.empty || rowMeta.headRow) return;
      var rowObj = sheet.mapping.reduce(function (obj, id, colIdx) {
        obj[id] = row[colIdx];
        return obj;
      }, {});
      rowMeta.id = wireRow($ctrl, rowObj, rowMeta, sheet.rowsMeta);
      if (rowMeta.id && angular.isUndefined(rowMeta.ignore)) rowMeta.ignore = true;
    });
  };
}]));

/***/ }),

/***/ "./bundles/import/step-components/import-dashboard.tpl.html":
/*!******************************************************************!*\
  !*** ./bundles/import/step-components/import-dashboard.tpl.html ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Module
var code = "<ff-panel ng-if=\"$ctrl.sheet && $ctrl.sheet.mappedToStep === $ctrl.step\"> <div class=\"ff-grid gutter-v-half gutter-h-half import-dashboard\"> <div flex=\"0 0 320px\" class=\"import-stats\" ng-if=\"!$ctrl.unMappedFields.length\"> <div class=\"text-brand\"> <span class=\"counter\">{{$ctrl.stats.create}}</span> <ff-icon sense=\"plus\"></ff-icon> <span class=\"text\">Create</span> </div> <div class=\"text-brand\"> <span class=\"counter\">{{$ctrl.stats.update}}</span> <ff-icon sense=\"refresh\"></ff-icon> <span class=\"text\">Update</span> </div> <div class=\"text-text\"> <span class=\"counter\">{{$ctrl.stats.existing}}</span> <ff-icon sense=\"check\"></ff-icon> <span class=\"text\">Existing</span> </div> <div class=\"text-text\"> <span class=\"counter\">{{$ctrl.stats.ignore}}</span> <ff-icon sense=\"ignore\"></ff-icon> <span class=\"text\">Ignore</span> </div> <div class=\"text-danger\" ng-if=\"!$ctrl.stats.invalid\"> <span class=\"counter\">{{$ctrl.stats.error}}</span> <ff-icon sense=\"error\"></ff-icon> <span class=\"text\">Error</span> </div> <div class=\"text-danger\" ng-if=\"$ctrl.stats.invalid\"> <span class=\"counter\">{{$ctrl.stats.invalid}}</span> <ff-icon sense=\"warning\"></ff-icon> <span class=\"text\">Invalid</span> </div> </div> <span ng-if=\"$ctrl.sheet.mappedToStep === $ctrl.step && $ctrl.unMappedFields.length\" class=\"text-danger\"> Some columns are unmapped. Please map them manually. Check <b><u>UNKNOWN</u></b> markers and select correct field mapping from the drop-down. </span> <span ng-if=\"$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && $ctrl.invalidCount\" class=\"text-danger\"> Invalid values detected. Please fix them manually to proceed to the next step. Look for cells with <ff-icon sense=\"warning\"></ff-icon> icon and fix their values. You can also ignore some rows by clicking <ff-icon sense=\"warning\"></ff-icon> icons near the row indexes at left. </span> <span ng-if=\"$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && !$ctrl.invalidCount\"> Click Next to proceed to the next step. </span> </div> </ff-panel> ";
// Exports
module.exports = code;

/***/ }),

/***/ "./bundles/import/step-components/import-sheet-selector.tpl.html":
/*!***********************************************************************!*\
  !*** ./bundles/import/step-components/import-sheet-selector.tpl.html ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Module
var code = "<ff-panel ff-dim=\"$ctrl.spin || !$ctrl.sheet\"> <div class=\"ff-grid gutter-v-half\"> <label class=\"ff-row ff-no-frame\"> <ff-label flex=\"0 0 120px\" ff-required=\"true\">Select Sheet</ff-label> <ff-select ff-model=\"$ctrl.sheet\" ff-options=\"sheet.name for sheet in $ctrl.sheets\" ff-required=\"true\" ff-valdate-alert=\"Sheet\"></ff-select> </label> <div ng-if=\"$ctrl.sheet && !$ctrl.sheet.mappedToStep\" class=\"text-danger\"> <ff-icon sense=\"info\"></ff-icon> This sheet seems to misfit to current import step. Please select another sheet or map all columns manually. </div> <div ng-if=\"$ctrl.sheet && $ctrl.sheet.mappedToStep && $ctrl.sheet.mappedToStep !== $ctrl.step\" class=\"text-danger\"> <ff-icon sense=\"info\"></ff-icon> This sheet is already mapped to \"{{$ctrl.steps[$ctrl.sheet.mappedToStep].name}}\" step, please select another sheet or <ff-btn sense=\"remove\" size=\"sm\" ff-click=\"$ctrl.remapFields()\">Remap Fields</ff-btn> </div> </div> </ff-panel> ";
// Exports
module.exports = code;

/***/ }),

/***/ "./bundles/import/step-components/step-complete.component.js":
/*!*******************************************************************!*\
  !*** ./bundles/import/step-components/step-complete.component.js ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.string.replace.js */ "../node_modules/core-js/modules/es.string.replace.js");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__);



/**
 * Import -> Complete
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importStepComplete', ['deskworks.state']).component('importStepComplete', {
  templateUrl: 'step-components/step-complete.tpl.html',
  controller: 'ImportStepCompleteCtrl',
  bindings: {
    step: '=',
    purge: '<'
  }
}).controller('ImportStepCompleteCtrl', ["state", function (state) {
  var $ctrl = this;

  $ctrl.navSidebar = function ($event) {
    $event.preventDefault();
    $event.stopPropagation();
    return state.setPath($event.target.hash.replace('#', ''));
  };

  $ctrl.home = function () {
    return state.setPath('/dashboard');
  };

  $ctrl.back = function () {
    $ctrl.step--;
  };
}]));

/***/ }),

/***/ "./bundles/import/step-components/step-complete.tpl.html":
/*!***************************************************************!*\
  !*** ./bundles/import/step-components/step-complete.tpl.html ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Module
var code = "<div> <p>Congratulations! You have completed the import. You can manage imported data through sidebar:</p> <p><a href=\"#/reservation-types\" ng-click=\"$ctrl.navSidebar($event)\">Inventory <ff-icon sense=\"breadcrumb\"></ff-icon> Reservation Categories</a></p> <p><a href=\"#/reservation-units\" ng-click=\"$ctrl.navSidebar($event)\">Inventory <ff-icon sense=\"breadcrumb\"></ff-icon> Reservation Units</a></p> <p><a href=\"#/products\" ng-click=\"$ctrl.navSidebar($event)\">Inventory <ff-icon sense=\"breadcrumb\"></ff-icon> Products</a></p> <p><a href=\"#/user-search\" ng-click=\"$ctrl.navSidebar($event)\">Members <ff-icon sense=\"breadcrumb\"></ff-icon> View/Edit Profile</a></p> </div> <ff-btn-group class=\"buttons-bottom\"> <ff-btn sense=\"back\" ff-click=\"$ctrl.back()\">Back To Step {{$ctrl.step}}</ff-btn> <ff-btn sense=\"home\" ff-click=\"$ctrl.home()\">Go To Dashboard</ff-btn> <ff-btn sense=\"remove\" ff-click=\"$ctrl.purge()\">Purge & Start From Scratch</ff-btn> </ff-btn-group> ";
// Exports
module.exports = code;

/***/ }),

/***/ "./bundles/import/step-components/step-import.component.js":
/*!*****************************************************************!*\
  !*** ./bundles/import/step-components/step-import.component.js ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.object.to-string.js */ "../node_modules/core-js/modules/es.object.to-string.js");
/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.promise.js */ "../node_modules/core-js/modules/es.promise.js");
/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var es6_promise_pool__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! es6-promise-pool */ "../node_modules/es6-promise-pool/es6-promise-pool.js");
/* harmony import */ var es6_promise_pool__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(es6_promise_pool__WEBPACK_IMPORTED_MODULE_3__);




/**
 * Import -> Import Sheet
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importStepImport', ['deskworks.dwAlerts', 'deskworks.handsontable', 'deskworks.importHandsontable', 'deskworks.importSheetDetector', 'deskworks.importSteps', 'deskworks.importInitMetaData', 'deskworks.importDetectSubgroups', 'deskworks.importWireData', 'deskworks.importValidateData', 'deskworks.importCollectStats']).component('importStepImport', {
  templateUrl: 'step-components/step-import.tpl.html',
  controller: 'ImportStepImportCtrl',
  bindings: {
    step: '=',
    sheets: '<',
    purge: '<'
  }
}).controller('ImportStepImportCtrl', ["$scope", "$q", "$timeout", "dwAlerts", "state", "helper", "importSheetDetector", "importSteps", "importInitMetaData", "importDetectSubgroups", "importWireData", "importValidateData", "importCollectStats", function ($scope, $q, $timeout, dwAlerts, state, helper, importSheetDetector, importSteps, importInitMetaData, importDetectSubgroups, importWireData, importValidateData, importCollectStats) {
  var $ctrl = this;
  $ctrl.steps = importSteps; // $ctrl.$onInit = function() {};
  // $ctrl.$onChanges = function() {};

  $scope.$watch('$ctrl.step', function () {
    if (!$ctrl.step) return;
    var step = $ctrl.steps[$ctrl.step];
    $ctrl.fields = step.fields;
    $ctrl.sheet = null;
    $q.when(step.hooks && step.hooks.init && step.hooks.init($ctrl)) // init hook call
    .then(function () {
      $ctrl.sheet = importSheetDetector.detect($ctrl.sheets, $ctrl.step);
    });
  });
  /**
   * Back button handler
   */

  $ctrl.back = function () {
    $ctrl.step--;
  };
  /**
   * Validate Data
   */


  $ctrl.validateData = function () {
    var _context;

    importInitMetaData($ctrl.sheet);

    if (!_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_2___default()(_context = $ctrl.fields).call(_context, function (field) {
      return $ctrl.sheet.mapping.indexOf(field.id) < 0;
    }).length) {
      // all fields mapped
      importDetectSubgroups($ctrl, $ctrl.sheet, $ctrl.fields);
      importWireData($ctrl, $ctrl.sheet, $ctrl.fields, $ctrl.steps[$ctrl.step].hooks.wireRow);
      $ctrl.invalidCount = importValidateData($ctrl.sheet, $ctrl.fields, $scope);
      $ctrl.stats = importCollectStats($ctrl.sheet.rowsMeta);
    }

    $scope.$broadcast('ht:render'); // force re-render handsontable
  };
  /**
   * Import Data
   */


  $ctrl.import = function () {
    if ($ctrl.unMappedFields.length) return dwAlerts.error('Some columns unmapped. Please check red UNKNOWN markers and map them to appropriate fields.');
    if ($ctrl.invalidCount) return dwAlerts.error($ctrl.invalidCount + ' invalid values found. Please fix them manually to proceed to the next step.');
    var step = $ctrl.steps[$ctrl.step];
    var ri = 0;

    var promiseProducer = function promiseProducer() {
      while (ri < $ctrl.sheet.data.length && ($ctrl.sheet.rowsMeta[ri].ignore || $ctrl.sheet.rowsMeta[ri].subgroup || $ctrl.sheet.rowsMeta[ri].headRow || $ctrl.sheet.rowsMeta[ri].empty)) {
        ri++;
      }

      if (ri >= $ctrl.sheet.data.length) return null;
      var rowMeta = $ctrl.sheet.rowsMeta[ri];
      rowMeta.spin = true;
      return step.hooks.importRow($ctrl, $ctrl.sheet.data[ri++], rowMeta, $ctrl.sheet.mapping, $ctrl.fields).then(function (result) {
        rowMeta.id = result.id || rowMeta.id;
        rowMeta.error = null;
      }).catch(function (err) {
        rowMeta.error = err.data && err.data.error || err.status + ' ' + err.statusText;
      }).finally(function () {
        $ctrl.stats = importCollectStats($ctrl.sheet.rowsMeta);
        rowMeta.spin = false;
        rowMeta.ignore = true;
      });
    };

    var pool = new es6_promise_pool__WEBPACK_IMPORTED_MODULE_3___default.a(promiseProducer, 5, {
      promise: $q
    });
    $ctrl.spin = true;
    return $q.when(step.hooks && step.hooks.preImport && step.hooks.preImport($ctrl, $ctrl.sheet, $ctrl.fields)).then(function () {
      return pool.start();
    }).then(function () {
      $ctrl.validateData();
      return $timeout(function () {
        $ctrl.spin = false;
        $ctrl.step++;
      }, 1000);
    }); // return pool.start()
    //   .then(function() {
    //     $ctrl.validateData();
    //     return $timeout(function() {
    //       $ctrl.spin = false;
    //       $ctrl.step++;
    //     }, 1000);
    //   });
  };
}]));

/***/ }),

/***/ "./bundles/import/step-components/step-import.tpl.html":
/*!*************************************************************!*\
  !*** ./bundles/import/step-components/step-import.tpl.html ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Module
var code = "<div class=\"ff-grid gutter-h gutter-v\"> <div style1=\"margin-bottom: .25rem\" ng-if=\"$ctrl.steps[$ls.step].id !== 'complete'\"> <span class=\"em\">Step {{$ls.step + 1}} of {{$ctrl.steps.length - 2}}</span> &nbsp; This step allows you to import <b ng-bind=\"$ctrl.steps[$ctrl.step].name\"></b>. Please select correct Excel sheet, check & fix columns mapping, fix invalid values, then import. </div> <div flex=\"{lg: '0 0 400px'}\" class=\"ff-grid\" ng-include=\"'step-components/import-sheet-selector.tpl.html'\"></div> <div flex=\"{lg: '1 1 360px'}\" class=\"ff-grid\" ng-include=\"'step-components/import-dashboard.tpl.html'\"></div> <ff-btn-group> <ff-btn sense=\"next\" ff-click=\"$ctrl.import()\">Next</ff-btn> <ff-btn sense=\"back\" ff-click=\"$ctrl.back()\">Back To Step {{$ctrl.step}}</ff-btn> <ff-btn sense=\"remove\" ff-click=\"$ctrl.purge()\">Purge & Start From Scratch</ff-btn> </ff-btn-group> <ff-panel class=\"ht-panel\" ng-if=\"$ctrl.sheet\" ff-dim=\"$ctrl.spin\"> <import-handsontable step=\"$ctrl.step\" sheet=\"$ctrl.sheet\" fields=\"$ctrl.fields\" on-validate=\"$ctrl.validateData()\" un-mapped-fields=\"$ctrl.unMappedFields\"></import-handsontable> </ff-panel> </div> ";
// Exports
module.exports = code;

/***/ }),

/***/ "./bundles/import/step-components/step-init.component.js":
/*!***************************************************************!*\
  !*** ./bundles/import/step-components/step-init.component.js ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var assets_new_center_startup_workbook_xlsx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! assets/new-center-startup-workbook.xlsx */ "./assets/new-center-startup-workbook.xlsx");

/**
 * Import -> Init
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importStepInit', ['ngFileUpload', 'deskworks.dwAlerts', 'deskworks.excel']).component('importStepInit', {
  templateUrl: 'step-components/step-init.tpl.html',
  controller: 'ImportStepInitCtrl',
  bindings: {
    step: '=',
    sheets: '=',
    purge: '<'
  }
}).controller('ImportStepInitCtrl', ["dwAlerts", "excel", function (dwAlerts, excel) {
  var $ctrl = this;
  /**
   * $onInit
   */

  $ctrl.$onInit = function () {
    $ctrl.xlsTemplateUrl = assets_new_center_startup_workbook_xlsx__WEBPACK_IMPORTED_MODULE_0__["default"];
  };
  /**
   * $onChanges
   */
  // $ctrl.$onChanges = () => {};

  /**
   * Upload new file handler
   */


  $ctrl.upload = function ($files, $invalidFiles) {
    if ($invalidFiles && $invalidFiles.length > 0) return dwAlerts.error('Please use .xls or .xlsx files.');
    if (!window.FileReader) return dwAlerts.error('FileReader is not supported by your web browser.');
    if (!$files || !$files.length) return;
    excel.read($files[0]).then(function (result) {
      $ctrl.sheets = result;
      $ctrl.step++;
    });
  };
}]));

/***/ }),

/***/ "./bundles/import/step-components/step-init.tpl.html":
/*!***********************************************************!*\
  !*** ./bundles/import/step-components/step-init.tpl.html ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Module
var code = "<div class=\"gutter-v\"> <ff-panel> <div class=\"em\"><ff-icon sense=\"info\"></ff-icon>&nbsp;&nbsp;This wizard will guide you through the following import steps:</div> <ff-label> <span>Reservation Categories</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Other Products</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Membership Products</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Reservation Units</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Members</span> </ff-label> <div class=\"em\"><ff-icon sense=\"info\"></ff-icon>&nbsp;&nbsp;The workflow for each step is:</div> <ff-label> <span>Select sheet in Excel file</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Map fields</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Fix invalid data</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Import</span><ff-icon sense=\"breadcrumb\"></ff-icon> <span>Move to next step</span> </ff-label> <p><ff-icon sense=\"info\"></ff-icon>&nbsp;&nbsp;Please download import template, open it in Excel (Numbers on Mac), replace sample data with your real data, then start import by selecting the file you've made.</p> <p><ff-icon sense=\"warning\"></ff-icon>&nbsp;&nbsp;Don't add/remove columns in the template, but you may add/remove rows.</p> </ff-panel> <ff-btn-group> <ff-btn sense=\"upload\" ngf-select=\"$ctrl.upload($files, $invalidFiles)\" ngf-pattern=\"'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel'\" accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\"> Select Excel File to Import </ff-btn> <a ng-href=\"{{$ctrl.xlsTemplateUrl}}\" target=\"_blank\" rel=\"noopener\" download> <ff-btn sense=\"download\">Download Import Template</ff-btn> </a> </ff-btn-group> </div> ";
// Exports
module.exports = code;

/***/ }),

/***/ "./bundles/import/step-fields/fields-members.service.js":
/*!**************************************************************!*\
  !*** ./bundles/import/step-fields/fields-members.service.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/**
 * Fields configuration for Import -> Members
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importFieldsMembers', ['deskworks.userProfile.optsCountry', 'deskworks.userProfile.optsState', 'deskworks.userProfile.optsMembershipStatus', 'deskworks.userProfile.optsBillingMethod', 'deskworks.billing.optsRenewalTerm', 'deskworks.billing.optsRenewalNoticePeriod']).factory('importFieldsMembers', ["optsCountry", "optsState", "optsMembershipStatus", "optsBillingMethod", "optsRenewalTerm", "optsRenewalNoticePeriod", function (optsCountry, optsState, optsMembershipStatus, optsBillingMethod, optsRenewalTerm, optsRenewalNoticePeriod) {
  return [{
    id: 'firstName',
    name: 'First Name',
    pattern: /First\s+Name/i,
    required: true
  }, {
    id: 'lastName',
    name: 'Last Name',
    pattern: /Last\s+Name/i,
    required: true,
    type: {
      pattern: /^[^\\<>\/&]*$/,
      msg: 'Last Name should not contain special characters'
    }
  }, {
    id: 'email',
    name: 'Email',
    pattern: /Email/i,
    required: true,
    unique: true,
    type: 'email'
  }, {
    id: 'company',
    name: 'Company',
    pattern: /Company/i
  }, {
    id: 'login',
    name: 'Login',
    pattern: /Login/i,
    required: true,
    unique: true,
    minLength: 3,
    type: {
      pattern: /^\w[\w\.\-_@]+$/,
      msg: 'Login should have only letters, numbers, and .-_@'
    }
  }, {
    id: 'password',
    name: 'Password',
    pattern: /Password/i,
    required: true,
    minLength: 6
  }, {
    id: 'addressStreet',
    name: 'Street',
    pattern: /Street/i,
    required: true
  }, {
    id: 'addressCity',
    name: 'City',
    pattern: /City/i,
    required: true
  }, {
    id: 'addressCountry',
    name: 'Country',
    pattern: /Country/i,
    required: true,
    type: {
      options: optsCountry
    }
  }, {
    id: 'addressState',
    name: 'State/Province',
    pattern: /State\s*\/\s*Province/i,
    required: true,
    type: {
      options: '$ctrl.optsState.$id',
      ref: 'addressCountry'
    }
  }, {
    id: 'addressZip',
    name: 'Zip/Postal',
    pattern: /Zip\s*\/\s*Post/i,
    required: true
  }, {
    id: 'phoneNumber',
    name: 'Phone Number',
    pattern: /Number/i,
    required: true,
    type: {
      pattern: /^((\+\d{1,3}[-. ]?\(?\d\)?[-. ]?\d{1,5})|(\(?\d{2,6}\)?))[-. ]?(\d{3,4})[-. ]?(\d{4})$/,
      msg: 'Phone number examples: 888-379-2865, +1-888-379-2865, 888 379 2865, 888.379.2865'
    }
  }, {
    id: 'mailboxNumber',
    name: 'Mailbox #',
    pattern: /Mailbox #/i
  }, {
    id: 'printerCode',
    name: 'Printer Code',
    pattern: /Printer\s+Code/i
  }, {
    id: 'accessCode',
    name: 'Access Code',
    pattern: /Access\s+Code/i
  }, {
    id: 'leadSource',
    name: 'Lead Source',
    pattern: /Lead\s+Source/i,
    required: true,
    type: {
      options: '$ctrl.leadSources'
    }
  }, {
    id: 'comments',
    name: 'Comments',
    pattern: /Comments/i
  }, {
    id: 'billingMethod',
    name: 'Billing Method',
    pattern: /Bill\s+By/i,
    required: true,
    type: {
      options: optsBillingMethod
    }
  }, {
    id: 'recurringProduct',
    name: 'Recurring Billing',
    pattern: /Recurring\s+Billing/i,
    type: {
      options: '$ctrl.products'
    },
    subgroup: 'recurring',
    subgroupKey: true
  }, {
    id: 'recurringQuantity',
    name: 'Qty',
    pattern: /Qty/i,
    type: 'uint',
    subgroup: 'recurring'
  }, {
    id: 'recurringDiscount',
    name: 'Discount',
    pattern: /^Discount/i,
    type: 'currency',
    subgroup: 'recurring'
  }, {
    id: 'recurringMonthsOfDiscount',
    name: 'Months of Discount',
    pattern: /Months\s+of\s+Discount/i,
    type: 'uint',
    subgroup: 'recurring'
  }, {
    id: 'recurringAttachedReservationUnit',
    name: 'Attached Reservation Unit',
    pattern: /Make\s+Matching\s+Reservation\s+Unit\s+Unavailable/i,
    unique: true,
    type: {
      options: '$ctrl.reservationUnits'
    },
    subgroup: 'recurring'
  }, {
    id: 'recurringNextBillDate',
    name: 'Next Bill Date',
    pattern: /Next\s+Bill\s+Date/i,
    type: 'date',
    subgroup: 'recurring'
  } // {
  //   id: 'renewalDate', name: 'Renewal Date', pattern: /Renewal\s+Date/i,
  //   type: 'date', subgroup: 'recurring',
  // },
  // {
  //   id: 'renewalTerm', name: 'Renewal Term', pattern: /Renewal\s+Term/i,
  //   type: { options: optsRenewalTerm }, subgroup: 'recurring',
  // },
  // {
  //   id: 'renewalNoticePeriod', name: 'Renewal Notice Period', pattern: /Renewal\s+Notice\s+Period/i,
  //   type: { options: optsRenewalNoticePeriod }, subgroup: 'recurring',
  // },
  ];
}]));

/***/ }),

/***/ "./bundles/import/step-fields/fields-membership-products.service.js":
/*!**************************************************************************!*\
  !*** ./bundles/import/step-fields/fields-membership-products.service.js ***!
  \**************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/**
 * Fields configuration for Import -> Membership Products
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importFieldsMembershipProducts', []).factory('importFieldsMembershipProducts', function () {
  return [{
    id: 'name',
    name: 'Product Name',
    pattern: /Product\s+Name/i,
    required: true,
    unique: true
  }, {
    id: 'membershipCategory',
    name: 'Membership Category',
    pattern: /Membership\s+Category/i,
    required: true
  }, {
    id: 'isCreditable',
    name: 'Has Reservation Credit?',
    pattern: /Has\s+Reservation\s+Credit/i,
    type: 'bool'
  }, {
    id: 'hasPasses',
    name: 'Has Passes?',
    pattern: /Has\s+Passes/i,
    type: 'bool'
  }, {
    id: 'passProduct',
    name: 'Product to use for pass',
    pattern: /Product.+for.+pass/i,
    type: {
      options: '$ctrl.productsRental'
    }
  }, {
    id: 'showInSelfRegistration',
    name: 'Show for Self-Registration',
    pattern: /Show.+Self.*Regis/i,
    type: 'bool'
  }, {
    id: 'productCategoryCode',
    name: 'Product Category Code',
    pattern: /Product\s+Category\s+Code/i,
    required: true
  }, {
    id: 'productCategoryName',
    name: 'Product Category Name',
    pattern: /Product\s+Category\s+Name/i
  }, {
    id: 'productNumber',
    name: 'Part Number Code',
    pattern: /Part\s+Number\s+Code/i,
    required: true,
    type: 'uint'
  }, {
    id: 'price',
    name: 'Price',
    pattern: /^Price/i,
    required: true,
    type: 'currency'
  }, {
    id: 'reservationCredit',
    name: 'Reservation Credit',
    pattern: /^Reservation\s+Credit/i,
    type: 'currency'
  }, {
    id: 'passQty',
    name: 'Passes',
    pattern: /^Passes/i,
    type: 'uint'
  }, {
    id: 'description',
    name: 'Description',
    pattern: /Description/i
  }];
}));

/***/ }),

/***/ "./bundles/import/step-fields/fields-other-products.service.js":
/*!*********************************************************************!*\
  !*** ./bundles/import/step-fields/fields-other-products.service.js ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0__);


/**
 * Fields configuration for Import -> Other Products
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importFieldsOtherProducts', ['deskworks.inventory.optsProductType']).factory('importFieldsOtherProducts', ["optsProductType", function (optsProductType) {
  return [{
    id: 'name',
    name: 'Product Name',
    pattern: /Product\s+Name/i,
    required: true,
    unique: true
  }, {
    id: 'type',
    name: 'Product Type',
    pattern: /Product\s+Type/i,
    required: true,
    type: {
      options: _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0___default()(optsProductType).call(optsProductType, function (opt) {
        return opt.id !== 'membership';
      })
    }
  }, {
    id: 'allowReservationCredits',
    name: 'Can use Reservation Credits',
    pattern: /Can\s+use\s+Reservation\s+Credit/i,
    type: 'bool'
  }, {
    id: 'passSize',
    name: 'Pass Size',
    pattern: /Pass\s+Size/i,
    type: 'uint'
  }, {
    id: 'reservationCategory',
    name: 'Reservation Category',
    pattern: /Reservation\s+Category/i,
    type: {
      options: '$ctrl.reservationCategories'
    }
  }, {
    id: 'productCategoryCode',
    name: 'Product Category Code',
    pattern: /Product\s+Category\s+Code/i,
    required: true
  }, {
    id: 'productCategoryName',
    name: 'Product Category Name',
    pattern: /Product\s+Category\s+Name/i
  }, {
    id: 'productNumber',
    name: 'Part Number Code',
    pattern: /Part\s+Number\s+Code/i,
    required: true,
    type: 'uint'
  }, {
    id: 'monthlyPrice',
    name: 'Monthly Members Price List',
    pattern: /Monthly\s+Members\s+Price\s?list/i,
    type: 'currency'
  }, {
    id: 'walkinPrice',
    name: 'Walkin Price List',
    pattern: /Walkin\s+Price\s?list/i,
    type: 'currency'
  }, {
    id: 'description',
    name: 'Product Description',
    pattern: /^Product\s+Description/i
  }];
}]));

/***/ }),

/***/ "./bundles/import/step-fields/fields-reservation-categories.service.js":
/*!*****************************************************************************!*\
  !*** ./bundles/import/step-fields/fields-reservation-categories.service.js ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/**
 * Fields configuration for Import -> Reservation Categories
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importFieldsReservationCategories', []).factory('importFieldsReservationCategories', function () {
  return [{
    id: 'name',
    name: 'Reservation Category',
    pattern: /^Reservation\s+Category/i,
    required: true,
    unique: true
  }, {
    id: 'description',
    name: 'Description',
    pattern: /^Description/i
  }];
}));

/***/ }),

/***/ "./bundles/import/step-fields/fields-reservation-units.service.js":
/*!************************************************************************!*\
  !*** ./bundles/import/step-fields/fields-reservation-units.service.js ***!
  \************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/**
 * Fields configuration for Import -> Reservation Units
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importFieldsReservationUnits', ['deskworks.reservationRules.optsWhoCanReserve']).factory('importFieldsReservationUnits', ["optsWhoCanReserve", function (optsWhoCanReserve) {
  return [{
    id: 'name',
    name: 'Reservation Unit',
    pattern: /^Reservation\s+Unit$/i,
    required: true,
    unique: true
  }, {
    id: 'reservationCategory',
    name: 'Reservation Category',
    pattern: /^Reservation\s+Category$/i,
    required: true,
    type: {
      options: '$ctrl.reservationCategories'
    }
  }, {
    id: 'whoCanReserve',
    name: 'Who can reserve?',
    pattern: /^Who\s+can\s+reserve/i,
    required: true,
    type: {
      options: optsWhoCanReserve
    }
  }, {
    id: 'fullTimeProduct',
    name: 'Full-time Product',
    pattern: /^Full-time\s+Product/i,
    type: {
      options: '$ctrl.productsMembership'
    }
  }];
}]));

/***/ }),

/***/ "./bundles/import/step-hooks/hooks-members.service.js":
/*!************************************************************!*\
  !*** ./bundles/import/step-hooks/hooks-members.service.js ***!
  \************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var shared_services_inventory_reservation_unit_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! shared/services/inventory/reservation-unit.service */ "./shared/services/inventory/reservation-unit.service.js");





/**
 * Hooks for Import -> Members
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importHooksMembers', ['deskworks.dwAlerts', 'deskworks.helper', 'deskworks.state', 'deskworks.importParsers', 'deskworks.inventory.product.service', 'deskworks.inventory.priceList.service', 'deskworks.inventory.membershipCategory.service', 'deskworks.system.service', 'deskworks.userProfile.service', 'deskworks.recurringCharge.service', 'deskworks.userProfile.optsMembershipStatus', 'deskworks.userProfile.optsState', 'deskworks.billing.optsDiscountType', shared_services_inventory_reservation_unit_service__WEBPACK_IMPORTED_MODULE_4__["default"].name]).factory('importHooksMembers', ["$q", "$filter", "dwAlerts", "helper", "state", "importParsers", "productService", "priceListService", "membershipCategoryService", "systemService", "userProfileService", "recurringChargeService", "ReservationUnit", "optsMembershipStatus", "optsState", "optsDiscountType", function ($q, $filter, dwAlerts, helper, state, importParsers, productService, priceListService, membershipCategoryService, systemService, userProfileService, recurringChargeService, ReservationUnit, optsMembershipStatus, optsState, optsDiscountType) {
  return {
    init: init,
    importRow: importRow,
    wireRow: wireRow
  };
  /**
   * Init hook
   */

  function init($ctrl) {
    return $q.all([productService.getProducts().catch(function (err) {
      return dwAlerts.error(err, 'Failed to query products.');
    }).then(function (products) {
      $ctrl.products = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_0___default()(products).call(products, function (product) {
        return product.type === 'membership' || product.type === 'services';
      });
    }), systemService.getLeadSources().catch(function (err) {
      return dwAlerts.error(err, 'Failed to query lead sources.');
    }).then(function (leadSources) {
      $ctrl.leadSources = leadSources;
    }), userProfileService.query(0, {
      activeMembers: true,
      inactiveMembers: true,
      activeCoMembers: true,
      inactiveCoMembers: true,
      nonMembers: true
    }).catch(function (err) {
      return dwAlerts.error(err, 'Failed to query all users.');
    }).then(function (users) {
      $ctrl.users = users;
    }), userProfileService.query(state.getCurrentCenterId(), {
      activeMembers: true
    }).catch(function (err) {
      return dwAlerts.error(err, 'Failed to query members.');
    }).then(function (members) {
      $ctrl.members = members;
    }), priceListService.getPricelists(state.getCurrentCenterId()).catch(function (err) {
      return dwAlerts.error(err, 'Failed to query price lists.');
    }).then(function (priceLists) {
      $ctrl.monthlyPriceList = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(priceLists).call(priceLists, function (obj) {
        return obj.name === 'Monthly Plans';
      });
      return priceListService.getPricelist(state.getCurrentCenterId(), $ctrl.monthlyPriceList.id).then(function (monthlyPriceList) {
        $ctrl.monthlyPriceList = monthlyPriceList;
      });
    }), ReservationUnit.query(state.getCurrentCenterId()).catch(function (err) {
      return dwAlerts.error(err, 'Failed to query reservation units');
    }).then(function (resUnits) {
      $ctrl.reservationUnits = resUnits;
    })]);
  }
  /**
   * Import Row hook
   */


  function importRow($ctrl, row, rowMeta, mapping, fields) {
    var billingMethods = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(fields).call(fields, function (obj) {
      return obj.id === 'billingMethod';
    }).type.options;

    var countries = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(fields).call(fields, function (obj) {
      return obj.id === 'addressCountry';
    }).type.options;

    var recurringProductIdx = mapping.indexOf('recurringProduct'); // const renewalTerms = fields.find(obj => obj.id === 'renewalTerm').type.options;
    // const renewalNoticePeriods = fields.find(obj => obj.id === 'renewalNoticePeriod').type.options;

    var user = {
      id: rowMeta.id || undefined,
      //|| helper.uid(),
      firstName: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('firstName')]),
      lastName: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('lastName')]),
      company: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('company')]),
      login: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('login')]),
      password: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('password')]),
      passwordConfirmation: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('password')]),
      email: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('email')]),
      //occupation: helper.trim(row[cmap.occupation.col]),
      comments: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('comments')]),
      leadSource: importParsers.options(row[mapping.indexOf('leadSource')], $ctrl.leadSources),
      membershipStatus: _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(optsMembershipStatus).call(optsMembershipStatus, function (obj) {
        return obj.id === 'nonMember';
      }),
      billingMethod: importParsers.options(row[mapping.indexOf('billingMethod')], billingMethods)
    };
    var recurringCharges = [];
    var riOrig = $ctrl.sheet.data.indexOf(row);
    var ri = riOrig;

    while (ri < $ctrl.sheet.data.length && ($ctrl.sheet.rowsMeta[ri].subgroup || ri === riOrig || $ctrl.sheet.rowsMeta[ri].headRow || $ctrl.sheet.rowsMeta[ri].empty)) {
      var rMeta = $ctrl.sheet.rowsMeta[ri];
      var rData = $ctrl.sheet.data[ri];

      if (!rMeta.ignore && !rMeta.headRow && !rMeta.empty && _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, rData[recurringProductIdx])) {
        (function () {
          var _context;

          var rc = recurringChargeService.new();
          rc.priceListProduct = {};
          var rcProduct = importParsers.options(rData[recurringProductIdx], $ctrl.products) || {};
          rc.priceListProduct.id = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(_context = $ctrl.monthlyPriceList.products).call(_context, function (obj) {
            return obj.productId === rcProduct.id;
          }).id;
          rc.priceListProduct.productId = rcProduct.id;
          rc.priceListProduct.priceListId = $ctrl.monthlyPriceList.id;
          rc.name = rcProduct.name;
          rc.nextBillDate = importParsers.date(rData[mapping.indexOf('recurringNextBillDate')]) || moment();
          rc.quantity = importParsers.uint(rData[mapping.indexOf('recurringQuantity')]) || 1;
          rc.discountValue = importParsers.currency(rData[mapping.indexOf('recurringDiscount')]);

          if (rc.discountValue) {
            rc.discountType = optsDiscountType[1]; // $

            rc.discountTrialOccurrences = {
              id: importParsers.uint(rData[mapping.indexOf('recurringMonthsOfDiscount')]) || 1
            };
          }

          rc.attachedReservationUnitId = (importParsers.options(rData[mapping.indexOf('recurringAttachedReservationUnit')], $ctrl.reservationUnits) || {}).id; // rc.renewalDate = importParsers.date(rData[mapping.indexOf('renewalDate')]);
          // rc.renewalTerm = (importParsers.options(rData[mapping.indexOf('renewalTerm')], renewalTerms) || {}).id;
          // rc.renewalNoticePeriod = (importParsers.options(rData[mapping.indexOf('renewalNoticePeriod')], renewalNoticePeriods) || {}).id;

          recurringCharges.push(rc);
        })();
      }

      ri++;
    } // Member if has membership product, otherwise, non-member


    if (recurringCharges.length) {
      user.membershipProduct = importParsers.options(recurringCharges[0].name, $ctrl.products);
      user.membershipStatus = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(optsMembershipStatus).call(optsMembershipStatus, function (obj) {
        return obj.id === 'active';
      });
      user.membershipType = {
        id: user.membershipProduct.membershipTypeId
      };
      user.membershipPriceList = $ctrl.monthlyPriceList;
    }

    var address = userProfileService.address.new();
    address.street = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('addressStreet')]);
    address.city = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('addressCity')]);
    address.country = importParsers.options(row[mapping.indexOf('addressCountry')], countries);
    address.state = optsState[address.country.id] ? importParsers.options(row[mapping.indexOf('addressState')], optsState[address.country.id]) : _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('addressState')]);
    address.zip = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('addressZip')]);
    var phone = userProfileService.phone.new();
    phone.number = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('phoneNumber')]);
    var printerCode = userProfileService.printerCode.new();
    printerCode.code = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('printerCode')]);
    var mailbox = userProfileService.mailbox.new();
    mailbox.number = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('mailboxNumber')]);
    var accessCard = {
      number: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_2___default()(helper).call(helper, row[mapping.indexOf('accessCode')]),
      effectiveDate: $filter('date')(moment(), 'yyyy-MM-dd')
    };
    return userProfileService.save(state.getCurrentCenterId(), user).then(function () {
      if (rowMeta.id) {
        // existing user, create recurring charge if doesn't exist
        if (!user.membershipProduct) return user;
        return recurringChargeService.query(state.getCurrentCenterId(), user.id).then(function (reccurings) {
          return $q.all(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_3___default()(recurringCharges).call(recurringCharges, function (rc) {
            rc.id = (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(reccurings).call(reccurings, function (obj) {
              return obj.productName === rc.name;
            }) || {}).id || rc.id;
            return recurringChargeService.save(state.getCurrentCenterId(), user.id, rc);
          })).then(function () {
            return user;
          });
        });
      }

      var promises = [];
      promises.push(userProfileService.address.save(state.getCurrentCenterId(), user.id, address));
      promises.push(userProfileService.phone.save(state.getCurrentCenterId(), user.id, phone));

      if (printerCode.code !== '') {
        promises.push(userProfileService.printerCode.save(state.getCurrentCenterId(), user.id, printerCode));
      }

      if (mailbox.number !== '') {
        promises.push(userProfileService.mailbox.save(state.getCurrentCenterId(), user.id, mailbox));
      }

      if (accessCard.number !== '') {
        accessCard.userId = user.id;
        promises.push(systemService.createAccessCard(state.getCurrentCenterId(), accessCard));
      }

      recurringCharges.forEach(function (rc) {
        promises.push(recurringChargeService.save(state.getCurrentCenterId(), user.id, rc));
      });
      return $q.all(promises).then(function () {
        return user;
      });
    });
  }
  /**
   * Wire Row hook
   */


  function wireRow($ctrl, rowObj, rowMeta, rowsMeta) {
    var _context2;

    if (rowMeta.subgroup === 'recurring') {
      var ownerIdx = rowsMeta.indexOf(rowMeta) - 1;

      while (ownerIdx >= 0 && (rowsMeta[ownerIdx].empty || rowsMeta[ownerIdx].headRow || rowsMeta[ownerIdx].subgroup)) {
        ownerIdx--;
      }

      rowMeta.ignore = rowMeta.ignore || rowsMeta[ownerIdx].ignore;
      rowMeta.id = rowsMeta[ownerIdx].id;
      return rowMeta.id;
    }

    rowMeta.id = (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(_context2 = $ctrl.users).call(_context2, function (obj) {
      return obj.fullName === rowObj.firstName + ' ' + rowObj.lastName;
    }) || {}).id || null;

    if (rowMeta.id) {
      var _context3;

      var isMember = !!_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(_context3 = $ctrl.members).call(_context3, function (obj) {
        return obj.fullName === rowObj.firstName + ' ' + rowObj.lastName;
      });

      if (!isMember && rowObj.recurringProduct && angular.isUndefined(rowMeta.ignore)) {
        rowMeta.ignore = false;
      }
    }

    return rowMeta.id;
  }
}]));

/***/ }),

/***/ "./bundles/import/step-hooks/hooks-membership-products.service.js":
/*!************************************************************************!*\
  !*** ./bundles/import/step-hooks/hooks-membership-products.service.js ***!
  \************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.symbol.js */ "../node_modules/core-js/modules/es.symbol.js");
/* harmony import */ var core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.symbol.description.js */ "../node_modules/core-js/modules/es.symbol.description.js");
/* harmony import */ var core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var shared_drag_n_drop_keese_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! shared/drag-n-drop/keese.service */ "./shared/drag-n-drop/keese.service.js");







/**
 * Hooks for Import -> Membership Products
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importHooksMembershipProducts', [shared_drag_n_drop_keese_service__WEBPACK_IMPORTED_MODULE_6__["default"].name, 'deskworks.dwAlerts', 'deskworks.helper', 'deskworks.state', 'deskworks.importParsers', 'deskworks.inventory.product.service', 'deskworks.inventory.priceList.service', 'deskworks.inventory.membershipCategory.service', 'deskworks.ProductCategory']).factory('importHooksMembershipProducts', ["$q", "dwAlerts", "helper", "state", "importParsers", "keese", "ProductCategory", "productService", "priceListService", "membershipCategoryService", function ($q, dwAlerts, helper, state, importParsers, keese, ProductCategory, productService, priceListService, membershipCategoryService) {
  return {
    init: init,
    preImport: preImport,
    importRow: importRow,
    wireRow: wireRow
  };
  /**
   * Init hook
   */

  function init($ctrl) {
    return $q.all([productService.getProducts().catch(function (err) {
      return dwAlerts.error(err, 'Failed to get products.');
    }).then(function (products) {
      $ctrl.products = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default()(products).call(products, function (product) {
        return product.type === 'membership';
      });
      $ctrl.productsRental = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default()(products).call(products, function (product) {
        return product.type === 'rental';
      });
    }), getPriceLists($ctrl), membershipCategoryService.query().catch(function (err) {
      return dwAlerts.error(err, 'Failed to get membership categories.');
    }).then(function (membershipCategories) {
      $ctrl.membershipCategories = angular.copy(membershipCategories);
    }), ProductCategory.query().catch(function (err) {
      return dwAlerts.error(err, 'Failed to query product categories.');
    }).then(function (categories) {
      $ctrl.productCategories = angular.copy(categories);
    })]);

    function getPriceLists($ctrl) {
      var priceList = {
        name: 'Monthly Plans',
        visibleForVisitors: true,
        useFor: 'members'
      };
      return priceListService.getPricelists(state.getCurrentCenterId()).catch(function (err) {
        return dwAlerts.error(err, 'Failed to get price lists.');
      }).then(function (priceLists) {
        var found = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(priceLists).call(priceLists, function (obj) {
          return obj.name === priceList.name;
        });

        return found || priceListService.save(state.getCurrentCenterId(), priceList).catch(function (err) {
          return dwAlerts.error(err, 'Failed to create "' + priceList.name + '" price list.');
        }).then(function () {
          return priceList;
        });
      }).then(function (priceList) {
        return priceListService.getPricelist(state.getCurrentCenterId(), priceList.id).catch(function (err) {
          return dwAlerts.error(err, 'Failed to get price list ' + priceList.name + '.');
        });
      }).then(function (priceList) {
        $ctrl.monthlyPriceList = priceList;
      });
    }
  }
  /**
   * Pre-Import hook
   */


  function preImport($ctrl, sheet, fields) {
    var promises = [];
    sheet.data.forEach(function (row, ri) {
      var rowMeta = sheet.rowsMeta[ri];
      if (rowMeta.ignore || rowMeta.headRow || rowMeta.empty) return;

      var value = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, row[sheet.mapping.indexOf('membershipCategory')]);

      var membershipCategory = importParsers.options(value, $ctrl.membershipCategories);

      if (!membershipCategory) {
        membershipCategory = {
          name: value,
          order: keese.generate($ctrl.membershipCategories.length && $ctrl.membershipCategories[$ctrl.membershipCategories.length - 1].order),
          note: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, row[sheet.mapping.indexOf('description')])
        };
        $ctrl.membershipCategories.push(membershipCategory);
        promises.push(membershipCategoryService.save(membershipCategory).catch(function (err) {
          return dwAlerts.error(err, 'Failed to create membership category.');
        }));
      }

      value = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, row[sheet.mapping.indexOf('productCategoryCode')]);

      var productCategory = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(helper).call(helper, $ctrl.productCategories, {
        code: value
      });

      if (!productCategory) {
        productCategory = {
          code: value,
          name: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, row[sheet.mapping.indexOf('productCategoryName')])
        };
        $ctrl.productCategories.push(productCategory);
        promises.push(ProductCategory.save(productCategory).catch(function (err) {
          return dwAlerts.error(err, 'Failed to create product category.');
        }));
      }
    });
    return $q.all(promises);
  }
  /**
   * Import Row hook
   */


  function importRow($ctrl, row, rowMeta, mapping, fields) {
    var product = productService.new();
    product.id = rowMeta.id || undefined;
    product.name = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, row[mapping.indexOf('name')]);
    product.membershipType = importParsers.options(row[mapping.indexOf('membershipCategory')], $ctrl.membershipCategories);
    product.isCreditable = importParsers.bool(row[mapping.indexOf('isCreditable')]);
    product.hasPasses = importParsers.bool(row[mapping.indexOf('hasPasses')]);
    product.passProduct = importParsers.options(row[mapping.indexOf('passProduct')], $ctrl.productsRental);
    product.showInSelfRegistration = importParsers.bool(row[mapping.indexOf('showInSelfRegistration')]);
    product.productCategoryId = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(helper).call(helper, $ctrl.productCategories, {
      code: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, row[mapping.indexOf('productCategoryCode')])
    }).id;
    product.productNumber = importParsers.uint(row[mapping.indexOf('productNumber')]);
    product.description = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, row[mapping.indexOf('description')]);
    return productService.save(product).then(function (result) {
      if (!rowMeta.id && result.id) $ctrl.products.push(product);
    }).then(function () {
      var _context;

      var monthlyItem = {
        id: (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(_context = $ctrl.monthlyPriceList.products).call(_context, function (obj) {
          return obj.productId === product.id;
        }) || {}).id,
        priceListId: $ctrl.monthlyPriceList.id,
        price: importParsers.currency(row[mapping.indexOf('price')]),
        reservationCredit: product.isCreditable ? importParsers.currency(row[mapping.indexOf('reservationCredit')]) : undefined,
        passQty: product.hasPasses ? importParsers.uint(row[mapping.indexOf('passQty')]) : undefined
      };
      return productService.savePriceItem(product.id, monthlyItem).then(function () {
        var _context2;

        if (!_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(_context2 = $ctrl.monthlyPriceList.products).call(_context2, function (obj) {
          return obj.productId === product.id;
        })) $ctrl.monthlyPriceList.products.push(monthlyItem);
      });
    }).then(function () {
      return product;
    });
  }
  /**
   * Wire Row hook
   */


  function wireRow($ctrl, rowObj, rowMeta) {
    var _context3;

    rowMeta.id = (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(_context3 = $ctrl.products).call(_context3, function (obj) {
      return obj.name === rowObj.name;
    }) || {}).id || null;

    if (rowMeta.id) {
      var _context4;

      var monthlyPriceItem = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_4___default()(_context4 = $ctrl.monthlyPriceList.products).call(_context4, function (obj) {
        return obj.productId === rowMeta.id;
      }) || {};

      if (monthlyPriceItem.price != importParsers.currency(rowObj.price) && angular.isUndefined(rowMeta.ignore)) {
        rowMeta.ignore = false;
      }
    }

    return rowMeta.id;
  }
}]));

/***/ }),

/***/ "./bundles/import/step-hooks/hooks-other-products.service.js":
/*!*******************************************************************!*\
  !*** ./bundles/import/step-hooks/hooks-other-products.service.js ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.symbol.js */ "../node_modules/core-js/modules/es.symbol.js");
/* harmony import */ var core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.symbol.description.js */ "../node_modules/core-js/modules/es.symbol.description.js");
/* harmony import */ var core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/filter */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/map */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6__);








/**
 * Hooks for Import -> Other Products
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importHooksOtherProducts', ['deskworks.dwAlerts', 'deskworks.helper', 'deskworks.state', 'deskworks.importParsers', 'deskworks.inventory.product.service', 'deskworks.inventory.priceList.service', 'deskworks.reservationCategory.service', 'deskworks.ProductCategory']).factory('importHooksOtherProducts', ["$q", "dwAlerts", "helper", "state", "importParsers", "ProductCategory", "productService", "priceListService", "reservationCategoryService", function ($q, dwAlerts, helper, state, importParsers, ProductCategory, productService, priceListService, reservationCategoryService) {
  return {
    init: init,
    preImport: preImport,
    importRow: importRow,
    wireRow: wireRow
  };
  /**
   * Init hook
   */

  function init($ctrl) {
    return $q.all([productService.getProducts().catch(function (err) {
      return dwAlerts.error(err, 'Failed to get products.');
    }).then(function (products) {
      $ctrl.products = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default()(products).call(products, function (product) {
        return product.type !== 'membership';
      });
    }), getPriceLists($ctrl), reservationCategoryService.query(state.getCurrentCenterId()).catch(function (err) {
      return dwAlerts.error(err, 'Failed to load reservation categories.');
    }).then(function (reservationCategories) {
      $ctrl.reservationCategories = reservationCategories;
    }), ProductCategory.query().catch(function (err) {
      return dwAlerts.error(err, 'Failed to query product categories.');
    }).then(function (categories) {
      $ctrl.productCategories = angular.copy(categories);
    })]);

    function getPriceLists($ctrl) {
      var requiredPriceLists = [{
        name: 'Monthly Plans',
        visibleForVisitors: true,
        useFor: 'members'
      }, {
        name: 'Walkin',
        visibleForVisitors: true,
        useFor: 'nonMembers'
      }];
      return priceListService.getPricelists(state.getCurrentCenterId()).catch(function (err) {
        return dwAlerts.error(err, 'Failed to get price lists.');
      }).then(function (priceLists) {
        return $q.all(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4___default()(requiredPriceLists).call(requiredPriceLists, function (plist) {
          var found = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(priceLists).call(priceLists, function (obj) {
            return obj.name === plist.name;
          });

          return found || priceListService.save(state.getCurrentCenterId(), plist).catch(function (err) {
            return dwAlerts.error(err, 'Failed to create "' + plist.name + '" price list.');
          }).then(function () {
            return plist;
          });
        }));
      }).then(function (priceLists) {
        return $q.all(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4___default()(priceLists).call(priceLists, function (plist, index) {
          return priceListService.getPricelist(state.getCurrentCenterId(), plist.id).catch(function (err) {
            return dwAlerts.error(err, 'Failed to get price list ' + plist.name + '.');
          });
        }));
      }).then(function (priceLists) {
        $ctrl.monthlyPriceList = priceLists[0];
        $ctrl.walkinPriceList = priceLists[1];
      });
    }
  }
  /**
   * Pre-Import hook
   */


  function preImport($ctrl, sheet, fields) {
    var promises = [];
    sheet.data.forEach(function (row, ri) {
      var rowMeta = sheet.rowsMeta[ri];
      if (rowMeta.ignore || rowMeta.headRow || rowMeta.empty) return;

      var value = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6___default()(helper).call(helper, row[sheet.mapping.indexOf('productCategoryCode')]);

      var productCategory = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, $ctrl.productCategories, {
        code: value
      });

      if (!productCategory) {
        productCategory = {
          code: value,
          name: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6___default()(helper).call(helper, row[sheet.mapping.indexOf('productCategoryName')])
        };
        $ctrl.productCategories.push(productCategory);
        promises.push(ProductCategory.save(productCategory).catch(function (err) {
          return dwAlerts.error(err, 'Failed to create product category.');
        }));
      }
    });
    return $q.all(promises);
  }
  /**
   * Import Row hook
   */


  function importRow($ctrl, row, rowMeta, mapping, fields) {
    var product = productService.new();
    product.id = rowMeta.id || undefined;
    product.name = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6___default()(helper).call(helper, row[mapping.indexOf('name')]);
    product.type = importParsers.options(row[mapping.indexOf('type')], _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(fields).call(fields, function (obj) {
      return obj.id === 'type';
    }).type.options);
    product.allowReservationCredits = importParsers.bool(row[mapping.indexOf('allowReservationCredits')]);
    product.passSize = importParsers.uint(row[mapping.indexOf('passSize')]);
    product.productCategoryId = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(helper).call(helper, $ctrl.productCategories, {
      code: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6___default()(helper).call(helper, row[mapping.indexOf('productCategoryCode')])
    }).id;
    product.productNumber = importParsers.uint(row[mapping.indexOf('productNumber')]);
    product.description = _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_6___default()(helper).call(helper, row[mapping.indexOf('description')]);
    product.reservationTypeId = (importParsers.options(row[mapping.indexOf('reservationCategory')], $ctrl.reservationCategories) || {}).id;
    return productService.save(product).then(function (result) {
      // sync saved product
      if (!rowMeta.id && result.id) $ctrl.products.push(product);
      return result;
    }).then(function () {
      var _context, _context2, _context3, _context4;

      var monthlyItem = {
        id: (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(_context = $ctrl.monthlyPriceList.products).call(_context, function (obj) {
          return obj.productId === product.id;
        }) || {}).id,
        priceList: $ctrl.monthlyPriceList,
        priceListId: $ctrl.monthlyPriceList.id,
        price: importParsers.currency(row[mapping.indexOf('monthlyPrice')])
      };
      var walkingItem = {
        id: (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(_context2 = $ctrl.walkinPriceList.products).call(_context2, function (obj) {
          return obj.productId === product.id;
        }) || {}).id,
        priceList: $ctrl.walkinPriceList,
        priceListId: $ctrl.walkinPriceList.id,
        price: importParsers.currency(row[mapping.indexOf('walkinPrice')])
      };
      return $q.all(_babel_runtime_corejs3_core_js_stable_instance_map__WEBPACK_IMPORTED_MODULE_4___default()(_context3 = _babel_runtime_corejs3_core_js_stable_instance_filter__WEBPACK_IMPORTED_MODULE_3___default()(_context4 = [monthlyItem, walkingItem]).call(_context4, function (priceItem) {
        return priceItem.price || priceItem.price == 0;
      }) // jshint ignore:line
      ).call(_context3, function (priceItem) {
        var priceList = priceItem.priceList;
        delete priceItem.priceList;
        return productService.savePriceItem(product.id, priceItem).then(function () {
          var _context5;

          if (!_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(_context5 = priceList.products).call(_context5, function (obj) {
            return obj.productId === product.id;
          })) priceList.products.push(priceItem);
        });
      })).then(function () {
        return product;
      });
    });
  }
  /**
   * Wire Row hook
   */


  function wireRow($ctrl, rowObj, rowMeta) {
    var _context6;

    rowMeta.id = (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(_context6 = $ctrl.products).call(_context6, function (obj) {
      return obj.name === rowObj.name;
    }) || {}).id || null;

    if (rowMeta.id) {
      var _context7, _context8;

      var monthlyPriceItem = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(_context7 = $ctrl.monthlyPriceList.products).call(_context7, function (obj) {
        return obj.productId === rowMeta.id;
      }) || {};

      if (monthlyPriceItem.price != importParsers.currency(rowObj.monthlyPrice) && angular.isUndefined(rowMeta.ignore)) {
        rowMeta.ignore = false;
      }

      var walkinPriceItem = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_5___default()(_context8 = $ctrl.monthlyPriceList.products).call(_context8, function (obj) {
        return obj.productId === rowMeta.id;
      }) || {};

      if (walkinPriceItem.price != importParsers.currency(rowObj.walkinPrice) && angular.isUndefined(rowMeta.ignore)) {
        rowMeta.ignore = false;
      }
    }

    return rowMeta.id;
  }
}]));

/***/ }),

/***/ "./bundles/import/step-hooks/hooks-reservation-categories.service.js":
/*!***************************************************************************!*\
  !*** ./bundles/import/step-hooks/hooks-reservation-categories.service.js ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__);



/**
 * Hooks for Import -> Reservation Categories
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importHooksReservationCategories', ['deskworks.dwAlerts', 'deskworks.helper', 'deskworks.state', 'deskworks.reservationCategory.service']).factory('importHooksReservationCategories', ["dwAlerts", "helper", "state", "reservationCategoryService", function (dwAlerts, helper, state, reservationCategoryService) {
  return {
    init: init,
    importRow: importRow,
    wireRow: wireRow
  };
  /**
   * Init hook
   */

  function init($ctrl) {
    return reservationCategoryService.query(state.getCurrentCenterId()).catch(function (err) {
      return dwAlerts.error(err, 'Failed to load reservation categories.');
    }).then(function (reservationCategories) {
      $ctrl.reservationCategories = reservationCategories;
    });
  }
  /**
   * Import Row hook
   */


  function importRow($ctrl, row, rowMeta, mapping) {
    var resCategory = {
      id: rowMeta.id || undefined,
      name: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, row[mapping.indexOf('name')]),
      description: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, row[mapping.indexOf('description')])
    };
    return reservationCategoryService.save(state.getCurrentCenterId(), resCategory).then(function (result) {
      // sync saved reservation
      if (!rowMeta.id && result.id) $ctrl.reservationCategories.push({
        id: result.id,
        name: resCategory.name
      });
      return result;
    });
  }
  /**
   * Wire Row hook
   */


  function wireRow($ctrl, rowObj) {
    var _context;

    return (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(_context = $ctrl.reservationCategories).call(_context, function (obj) {
      return obj.name === rowObj.name;
    }) || {}).id || null;
  }
}]));

/***/ }),

/***/ "./bundles/import/step-hooks/hooks-reservation-units.service.js":
/*!**********************************************************************!*\
  !*** ./bundles/import/step-hooks/hooks-reservation-units.service.js ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/trim */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/find */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var shared_services_inventory_reservation_unit_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! shared/services/inventory/reservation-unit.service */ "./shared/services/inventory/reservation-unit.service.js");



/**
 * Hooks for Import -> Reservation Units
 */

/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importHooksReservationUnits', ['deskworks.dwAlerts', 'deskworks.helper', 'deskworks.state', 'deskworks.importParsers', 'deskworks.reservationRules.service', 'deskworks.reservationCategory.service', 'deskworks.inventory.product.service', 'deskworks.reservationRules.optsWhoCanReserve', shared_services_inventory_reservation_unit_service__WEBPACK_IMPORTED_MODULE_2__["default"].name]).factory('importHooksReservationUnits', ["$q", "dwAlerts", "helper", "state", "importParsers", "ReservationRules", "reservationCategoryService", "ReservationUnit", "productService", "optsWhoCanReserve", function ($q, dwAlerts, helper, state, importParsers, ReservationRules, reservationCategoryService, ReservationUnit, productService, optsWhoCanReserve) {
  return {
    init: init,
    importRow: importRow,
    wireRow: wireRow
  };
  /**
   * Init hook
   */

  function init($ctrl) {
    return $q.all([reservationCategoryService.query(state.getCurrentCenterId()).catch(function (err) {
      return dwAlerts.error(err, 'Failed to load reservation categories.');
    }).then(function (reservationCategories) {
      $ctrl.reservationCategories = reservationCategories;
    }), ReservationUnit.query(state.getCurrentCenterId()).catch(function (err) {
      return dwAlerts.error(err, 'Failed to load reservation units.');
    }).then(function (reservationUnits) {
      $ctrl.reservationUnits = reservationUnits;
    }), productService.getMembershipProducts(state.getCurrentCenterId()).catch(function (err) {
      return dwAlerts.error(err, 'Failed to load membership products.');
    }).then(function (products) {
      $ctrl.productsMembership = products;
    })]);
  }
  /**
   * Import Row hook
   */


  function importRow($ctrl, row, rowMeta, mapping, fields) {
    var resUnit = {
      id: rowMeta.id || undefined,
      name: _babel_runtime_corejs3_core_js_stable_instance_trim__WEBPACK_IMPORTED_MODULE_0___default()(helper).call(helper, row[mapping.indexOf('name')]),
      reservationTypeId: (importParsers.options(row[mapping.indexOf('reservationCategory')], $ctrl.reservationCategories) || {}).id,
      fullTimeProductId: (importParsers.options(row[mapping.indexOf('fullTimeProduct')], $ctrl.productsMembership) || {}).id
    };
    return ReservationUnit.save(state.getCurrentCenterId(), resUnit).then(function (result) {
      // sync saved reservation unit
      if (!rowMeta.id && result.id) $ctrl.reservationUnits.push({
        id: result.id,
        name: resUnit.name
      });
      return result;
    }).then(function (result) {
      return ReservationRules.query({
        centerId: state.getCurrentCenterId(),
        reservationUnitId: resUnit.id
      }).then(function (rules) {
        var rule = _babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(rules).call(rules, function (obj) {
          return obj.uid === 'whoCanReserve';
        });

        rule.value = (importParsers.options(row[mapping.indexOf('whoCanReserve')], optsWhoCanReserve) || {}).id;
        return ReservationRules.save({
          centerId: state.getCurrentCenterId(),
          reservationUnitId: resUnit.id
        }, rule);
      }).then(function () {
        return result;
      });
    });
  }
  /**
   * Wire Row hook
   */


  function wireRow($ctrl, rowObj) {
    var _context;

    return (_babel_runtime_corejs3_core_js_stable_instance_find__WEBPACK_IMPORTED_MODULE_1___default()(_context = $ctrl.reservationUnits).call(_context, function (obj) {
      return obj.name === rowObj.name;
    }) || {}).id || null;
  }
}]));

/***/ }),

/***/ "./bundles/import/wizard/import.controller.js":
/*!****************************************************!*\
  !*** ./bundles/import/wizard/import.controller.js ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_object_keys__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/object/keys */ "../node_modules/@babel/runtime-corejs3/core-js-stable/object/keys.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_object_keys__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_object_keys__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/instance/splice */ "../node_modules/@babel/runtime-corejs3/core-js-stable/instance/splice.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ "../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/es.regexp.exec.js */ "../node_modules/core-js/modules/es.regexp.exec.js");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! core-js/modules/es.string.match.js */ "../node_modules/core-js/modules/es.string.match.js");
/* harmony import */ var core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_4__);





/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.SetupImportCtrl', ['ngStorage', 'deskworks.state', 'deskworks.importSteps', 'deskworks.importStepInit', 'deskworks.importStepImport', 'deskworks.importStepComplete', 'deskworks.purge.service']).controller('SetupImportCtrl', ["$scope", "$localStorage", "dwAlerts", "state", "importSteps", "purgeService", function ($scope, $localStorage, dwAlerts, state, importSteps, purgeService) {
  var $ctrl = this;
  var importVersion = 1; // increment it when import code gets breaking changes

  /**
   * Load previous import data from local storage
   */

  $localStorage.import = $localStorage.import || {};
  var importStorage = $localStorage.import;

  _babel_runtime_corejs3_core_js_stable_object_keys__WEBPACK_IMPORTED_MODULE_0___default()(importStorage).forEach(function (key) {
    // clean up non-versioned and obsolete data
    var match = key.match(/^v(\d+)$/i);
    if (!match || match && +match[1] !== importVersion) delete importStorage[key];
  });

  var localStorage = importStorage['v' + importVersion] = importStorage['v' + importVersion] || {};
  var $ls = $scope.$ls = localStorage[state.getCurrentCenterId()] = localStorage[state.getCurrentCenterId()] || {}; // import data is stored per center

  $ls.step = $ls.step || 0; // init default values

  $ls.sheets = $ls.sheets || [];
  $ctrl.steps = importSteps;
  $scope.$watch('$ls.step', function () {
    state.setPageTitle('Import ' + $ctrl.steps[$ls.step].name);
  });

  $ctrl.purge = function () {
    if (!window.confirm('It will purge all data. Are you sure?')) return;
    return purgeService.purgeMembers().catch(function (err) {
      return dwAlerts.error(err, 'Failed to purge members.');
    }).then(function () {
      return purgeService.purgeProducts().catch(function (err) {
        return dwAlerts.error(err, 'Failed to purge products.');
      });
    }).then(function () {
      return purgeService.purgePriceLists(state.getCurrentCenterId()).catch(function (err) {
        return dwAlerts.error(err, 'Failed to purge price lists.');
      });
    }).then(function () {
      return purgeService.purgeMembershipTypes().catch(function (err) {
        return dwAlerts.error(err, 'Failed to purge membership categories.');
      });
    }).then(function () {
      return purgeService.purgeReservationCategories().catch(function (err) {
        return dwAlerts.error(err, 'Failed to purge reservation categories.');
      });
    }).then(function () {
      _babel_runtime_corejs3_core_js_stable_object_keys__WEBPACK_IMPORTED_MODULE_0___default()(localStorage).forEach(function (key) {
        var _context;

        localStorage[key].step = 0;

        _babel_runtime_corejs3_core_js_stable_instance_splice__WEBPACK_IMPORTED_MODULE_1___default()(_context = localStorage[key].sheets).call(_context, 0, localStorage[key].sheets.length);
      });
    });
  };
}]));

/***/ }),

/***/ "./bundles/import/wizard/import.tpl.html":
/*!***********************************************!*\
  !*** ./bundles/import/wizard/import.tpl.html ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Module
var code = "<div id=\"setupImport\"> <h1 class=\"page-title\">{{state.getPageTitle()}}</h1> <import-step-init ng-if=\"$ctrl.steps[$ls.step].id === 'init'\" step=\"$ls.step\" sheets=\"$ls.sheets\" purge=\"$ctrl.purge\"></import-step-init> <import-step-import ng-if=\"$ctrl.steps[$ls.step].id !== 'init' && $ctrl.steps[$ls.step].id !== 'complete'\" step=\"$ls.step\" sheets=\"$ls.sheets\" purge=\"$ctrl.purge\"></import-step-import> <import-step-complete ng-if=\"$ctrl.steps[$ls.step].id === 'complete'\" step=\"$ls.step\" sheets=\"$ls.sheets\" purge=\"$ctrl.purge\"></import-step-complete> </div> ";
// Exports
module.exports = code;

/***/ }),

/***/ "./bundles/import/wizard/steps.service.js":
/*!************************************************!*\
  !*** ./bundles/import/wizard/steps.service.js ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/**
 * Steps for Setup -> Import wizard
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('deskworks.importSteps', ['deskworks.importFieldsReservationCategories', 'deskworks.importHooksReservationCategories', 'deskworks.importFieldsReservationUnits', 'deskworks.importHooksReservationUnits', 'deskworks.importFieldsOtherProducts', 'deskworks.importHooksOtherProducts', 'deskworks.importFieldsMembershipProducts', 'deskworks.importHooksMembershipProducts', 'deskworks.importFieldsMembers', 'deskworks.importHooksMembers']).factory('importSteps', ["importFieldsReservationCategories", "importHooksReservationCategories", "importFieldsReservationUnits", "importHooksReservationUnits", "importFieldsOtherProducts", "importHooksOtherProducts", "importFieldsMembershipProducts", "importHooksMembershipProducts", "importFieldsMembers", "importHooksMembers", function (importFieldsReservationCategories, importHooksReservationCategories, importFieldsReservationUnits, importHooksReservationUnits, importFieldsOtherProducts, importHooksOtherProducts, importFieldsMembershipProducts, importHooksMembershipProducts, importFieldsMembers, importHooksMembers) {
  return [{
    id: 'init',
    name: 'Wizard'
  }, {
    id: 'reservationCategories',
    name: 'Reservation Categories',
    sheetPattern: /Reservation\s+Categories/i,
    fields: importFieldsReservationCategories,
    hooks: importHooksReservationCategories
  }, {
    id: 'otherProducts',
    name: 'Other Products',
    sheetPattern: /Products.+Prices$/i,
    fields: importFieldsOtherProducts,
    hooks: importHooksOtherProducts
  }, {
    id: 'membershipProducts',
    name: 'Membership Products',
    sheetPattern: /Membership.+Products.+Prices/i,
    fields: importFieldsMembershipProducts,
    hooks: importHooksMembershipProducts
  }, {
    id: 'reservationUnits',
    name: 'Reservation Units',
    sheetPattern: /Reservation\s+Units/i,
    fields: importFieldsReservationUnits,
    hooks: importHooksReservationUnits
  }, {
    id: 'members',
    name: 'Members',
    sheetPattern: /Members.+Recurring.+Billing/i,
    fields: importFieldsMembers,
    hooks: importHooksMembers
  }, {
    id: 'complete',
    name: 'Complete'
  }];
}]));

/***/ }),

/***/ "./shared/drag-n-drop/keese.service.js":
/*!*********************************************!*\
  !*** ./shared/drag-n-drop/keese.service.js ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_json_stringify__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs3/core-js-stable/json/stringify */ "../node_modules/@babel/runtime-corejs3/core-js-stable/json/stringify.js");
/* harmony import */ var _babel_runtime_corejs3_core_js_stable_json_stringify__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_json_stringify__WEBPACK_IMPORTED_MODULE_0__);


/**
 * Sort keys generator. Based on node-keese v1.1.1: https://github.com/thejoshwolfe/node-keese
 */
/* harmony default export */ __webpack_exports__["default"] = (angular.module('keese', []).factory('keese', function () {
  var alphabet = "0123456789?@ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
  var radix = alphabet.length;
  var order_specifier = '~'; // bigger than any from the alphabet

  /**
   * Character to numerical value aka index of the character: "0": 0, "z": 63, etc.
   */

  var values = function () {
    var values = {};

    for (var i = 0; i < alphabet.length; i++) {
      values[alphabet[i]] = i;
    }

    return values;
  }();

  return {
    /**
     * Main exported function. Generates new sort key.
     * @param low - previous sort key or null/undefined
     * @param high - next sort key or null/undefined
     * @param count - if defined - the result is an Array of size count values
     * @returns {*} - single key or array of keys, depending on count
     */
    generate: function keese(low, high, count) {
      if (count) {
        return multi_keese(low, high, count);
      } else {
        return single_keese(low, high);
      }
    }
  };

  function single_keese(low, high) {
    if (!low) {
      if (!high) {
        return '1'; // return anything above 0
      } else {
        return average('0', high); // go smaller
      }
    } else {
      if (!high) {
        return increment(low); // go bigger
      } else {
        return average(low, high); // go in between
      }
    }
  }

  function multi_keese(low, high, count) {
    var result = new Array(count);

    if (count > 0) {
      if (!high) {
        for (var i = 0; i < count; i++) {
          // just allocate straight forward
          var value = keese(low, null);
          result[i] = value;
          low = value;
        }
      } else {
        recurse(low, high, 0, count); // binary tree descent
      }
    }

    return result;

    function recurse(low_value, high_value, low_index, high_index) {
      var mid_index = Math.floor((low_index + high_index) / 2);
      var mid_value = single_keese(low_value, high_value);
      result[mid_index] = mid_value;
      if (low_index < mid_index) recurse(low_value, mid_value, low_index, mid_index);
      if (mid_index + 1 < high_index) recurse(mid_value, high_value, mid_index + 1, high_index);
    }
  }

  function increment(value) {
    var n = parse(value);
    n.digits = n.digits.substr(0, n.order_length + 1); // drop the fraction

    return add(n, parse("1"));
  }

  function average(low, high) {
    if (low > high) {
      throw new Error('assertion failed: ' + _babel_runtime_corejs3_core_js_stable_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(low) + " < " + _babel_runtime_corejs3_core_js_stable_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(high));
    }

    var a = parse(low);
    var b = parse(high);
    pad_to_equal_order(a, b);
    var b_carry = 0;
    var max_digit_length = Math.max(a.digits.length, b.digits.length);

    for (var i = 0; i < max_digit_length || b_carry > 0; i++) {
      var a_value = values[a.digits[i]] || 0;
      var b_value = b_carry + (values[b.digits[i]] || 0);
      if (a_value === b_value) continue;

      if (a_value === b_value - 1) {
        b_carry = radix; // we need more digits, but remember that b is ahead

        continue;
      } // we have a distance of at least 2 between the values.
      // half the distance floored is sure to be a positive single digit.


      var half_distance_value = Math.floor((b_value - a_value) / 2);
      var half_distance_digits = '';

      for (var j = 0; j < i; j++) {
        half_distance_digits += '0';
      }

      half_distance_digits += alphabet[half_distance_value];
      var half_distance = parse(construct(a.order_length, half_distance_digits)); // truncate insignificant digits of a

      a.digits = a.digits.substr(0, i + 1);
      return add(a, half_distance);
    }

    throw new Error(); // unreachable
  }

  function add(a, b) {
    pad_to_equal_order(a, b);
    var result_digits = "";
    var order_length = a.order_length;
    var value = 0;

    for (var i = Math.max(a.digits.length, b.digits.length) - 1; i >= 0; i--) {
      value += values[a.digits[i]] || 0;
      value += values[b.digits[i]] || 0;
      result_digits = alphabet[value % radix] + result_digits;
      value = Math.floor(value / radix);
    } // overflow up to moar digits


    while (value > 0) {
      result_digits = alphabet[value % radix] + result_digits;
      value = Math.floor(value / radix);
      order_length++;
    }

    return construct(order_length, result_digits);
  }

  function parse(value) {
    var order_length = value.lastIndexOf(order_specifier) + 1;
    return {
      order_length: order_length,
      digits: value.substr(order_length)
    };
  }

  function construct(order_length, digits) {
    while (order_length > 0 && digits.charAt(0) == '0') {
      // strip unnecessary leading zeros
      digits = digits.substr(1);
      order_length--;
    }

    var result = "";

    for (var i = 0; i < order_length; i++) {
      result += order_specifier;
    }

    return result + digits;
  }

  function pad_to_equal_order(a, b) {
    pad_in_place(a, b.order_length);
    pad_in_place(b, a.order_length);
  }

  function pad_in_place(n, order_length) {
    while (n.order_length < order_length) {
      n.digits = "0" + n.digits;
      n.order_length++;
    }
  }
}));

/***/ }),

/***/ 14:
/*!********************!*\
  !*** fs (ignored) ***!
  \********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 15:
/*!************************!*\
  !*** crypto (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 16:
/*!************************!*\
  !*** stream (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ })

}]);
//# sourceMappingURL=import~._a.js.map?_rev=4f68e205d56c4a2004c0