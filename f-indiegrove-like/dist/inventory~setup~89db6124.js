(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"/MEN":function(e,r,t){},"10fB":function(e,r){e.exports='<ff-row> <ff-select ff-model="$ctrl.rule[$ctrl.role].available" ff-options="opt.id as opt.name for opt in $ctrl.options" ff-change="$ctrl.onChangeAvailable()"></ff-select> <ff-btn flex="none" sense="add" size="xs" ng-class="{ invisible: !$ctrl.rule[$ctrl.role].available }" title="{{\'RESERVATION_RULES.BTN_ADD_INTERVAL.HINT\' | translate}}" ff-click="$ctrl.addInterval()"></ff-btn> </ff-row> <ff-row ng-repeat="interval in $ctrl.rule[$ctrl.role].intervals track by $index" ng-if="$ctrl.rule[$ctrl.role].available"> <ff-time ff-model="interval.from" ff-change="$ctrl.rule.$as()" ff-required="true" ff-time-order="{ early: interval.from, late: interval.to }" ff-validate-alert="{ field: (\'RESERVATION_RULES.TIME_FROM\' | translate), late: (\'RESERVATION_RULES.TIME_TO\' | translate) }" placeholder="09:00 AM"></ff-time> <ff-time ff-model="interval.to" ff-change="$ctrl.rule.$as()" ff-required="true" ff-time-order="{ early: interval.from, late: interval.to }" ff-validate-alert="{ field: (\'RESERVATION_RULES.TIME_TO\' | translate), early: (\'RESERVATION_RULES.TIME_FROM\' | translate) }" placeholder="05:00 PM"></ff-time> <ff-btn flex="none" sense="delete" size="xs" ff-click="$ctrl.deleteInterval(interval)" title="{{\'RESERVATION_RULES.BTN_DELETE_INTERVAL.HINT\' | translate}}"></ff-btn> </ff-row> <ff-row ng-repeat="ghost in $ctrl.rule[$ctrl.role].$ghosts track by $index"> <ff-static></ff-static> </ff-row> '},"6K7E":function(e,r){e.exports='<div class="ff-grid gutter-h-half" style="justify-content:flex-start"> <label flex="none" ng-repeat="opt in $ctrl.options"> <ff-checkbox ff-model="$ctrl.rule.value[opt.id]" ff-change="$ctrl.rule.$as()">{{::opt.name}}</ff-checkbox> </label> </div> '},"7LHe":function(e,r){e.exports='<form name="formReservationRules" novalidate> <div class="gutter-v"> <ff-panel> <ff-panel-header ng-if="$ctrl.reservationUnitId"> <div class="ff-grid gutter-v-half gutter-h-half"> <div flex="auto"> <span translate="RESERVATION_RULES.ACTIVE.HEADER"></span> <ff-hint><span translate="RESERVATION_RULES.ACTIVE.HINT"></span></ff-hint> </div> <ff-btn flex="none" sense="clone" size="sm" ff-click="$ctrl.resetRules()" style="margin:-.5rem 0 .5rem 0"> <span translate="RESERVATION_RULES.ACTIVE.BTN_RESET"></span> </ff-btn> </div> </ff-panel-header> <ff-panel-header ng-if="!$ctrl.reservationUnitId"> <span translate="RESERVATION_RULES.DEFAULT.HEADER"></span> <ff-hint><span translate="RESERVATION_RULES.DEFAULT.HINT"></span></ff-hint> </ff-panel-header> <ff-col ff-dim="!$ctrl.rules" class="gutter-v"> <ff-col> <div class="rr-container gutter-v-half"> <rr-rule rule="$ctrl.whoCanReserve" options="$ctrl.conf.whoCanReserve.opts" flex="{sm: \'1 1 137px\', md: \'0 0 180px\'}">{{$ctrl.conf.whoCanReserve.name}}</rr-rule> <rr-rule rule="$ctrl.fullTimeProduct" options="$ctrl.conf.fullTimeProduct.opts" ng-if="$ctrl.reservationUnitId && $ctrl.conf.fullTimeProduct.opts" rule-save="$ctrl.saveFullTimeProduct()" flex="{sm: \'1 1 176px\', md: \'0 0 350px\'}">{{$ctrl.conf.fullTimeProduct.name}}</rr-rule> <rr-rule rule="$ctrl.attachedUser" ng-if="$ctrl.reservationUnitId && $ctrl.whoCanReserve.value === \'notAvailable\'" flex="{sm: \'1 1 313px\', md: \'0 0 250px\'}">{{$ctrl.conf.attachedUser.name}}</rr-rule> </div> </ff-col> <ff-col ng-if="$ctrl.rules"> <div class="rr-container gutter-v-half"> <rr-rule rule="$ctrl.scale" options="$ctrl.conf.scale.opts" flex="{sm: \'1 1 176px\', md: \'0 0 200px\'}"> {{$ctrl.conf.scale.name}} <ff-hint><span translate="RESERVATION_RULES.RESERVATION_SCALE.HINT"></span></ff-hint> </rr-rule> <rr-rule rule="$ctrl.buffer" options="$ctrl.conf.buffer.opts" flex="{sm: \'1 1 176px\', md: \'0 0 200px\'}"> {{$ctrl.conf.buffer.name}} <ff-hint><span translate="RESERVATION_RULES.RESERVATION_BUFFER.HINT"></span></ff-hint> </rr-rule> </div> </ff-col> <ff-col ng-if="!$ctrl.hideRules"> <div class="rr-container gutter-v-half"> <rr-rule rule="rule" options="$ctrl.conf[rule.uid].opts" ng-repeat="rule in $ctrl.rules | filter:{ type: \'roles\' }" flex="{sm: \'0 0 50%\', md: \'0 0 200px\'}"> <span ng-bind-html="$ctrl.conf[rule.uid].name"></span> </rr-rule> </div> </ff-col> <ff-col ng-if="!$ctrl.hideRules"> <div class="rr-container gutter-v-half"> <rr-rule rule="rule" ng-repeat="rule in $ctrl.rules | filter:{ type: \'weekday\' }" flex="{sm: \'0 0 50%\', md: \'0 0 200px\'}">{{rule.name.toUpperCase()}}</rr-rule> </div> </ff-col> <ff-col ng-if="!$ctrl.hideRules"> <div class="rr-container gutter-v-half"> <rr-rule rule="rule" ng-repeat="rule in $ctrl.rules | filter:{ type: \'checklist\' }" options="$ctrl.conf[rule.uid].opts" flex="auto" class="animate-collapse" ng-if="$ctrl.conf[rule.uid].opts.length">{{$ctrl.conf[rule.uid].name}}</rr-rule> </div> </ff-col> </ff-col> </ff-panel> <ff-panel class="rr-calendar" ng-if="!$ctrl.reservationUnitId"> <ff-panel-header> <span translate="RESERVATION_RULES.ANNUAL.HEADER"></span> <ff-hint><span translate="RESERVATION_RULES.ANNUAL.HINT"></span></ff-hint> </ff-panel-header> <ff-col ff-dim="!$ctrl.rules"> <div class="rr-container gutter-v-half"> <rr-rule rule="rule" ng-repeat="rule in $ctrl.rules | filter:{ type: \'date\' }" flex="{sm: \'0 0 50%\', md: \'0 0 200px\'}"></rr-rule> </div> <ff-btn-group class="ff-section-buttons"> <ff-btn sense="add" size="sm" ff-click="$ctrl.addDate()"><span translate="RESERVATION_RULES.BTN_ADD_DATE"></span></ff-btn> </ff-btn-group> </ff-col> </ff-panel> </div> </form> '},F3iT:function(e,r){e.exports='<ng-form name="rrForm"> <ff-header ff-spin="$ctrl.rule.$$autoSaving" class="ff-relative ff-spin-sm"> <ff-header class="rr-role"></ff-header> <cell ng-transclude flex="auto"> <ff-row> <ff-col> <ff-date ff-model="$ctrl.rule.date" ff-required="true" ff-validate-alert="Date" ff-change="$ctrl.rule.$as()"></ff-date> <ff-text ff-model="$ctrl.rule.name" ff-change="$ctrl.rule.$as()"></ff-text> </ff-col> <ff-btn flex="none" sense="delete" size="xs" ff-click="$ctrl.deleteRule()" title="{{\'RESERVATION_RULES.BTN_DELETE_DATE\' | translate}}"></ff-btn> </ff-row> </cell> </ff-header> <ff-row ng-repeat="role in $ctrl.roles" ng-if="(role.$visible || $ctrl.rule.type === \'date\') && $ctrl.rule.type !== \'value\' && $ctrl.rule.type !== \'static\' && $ctrl.rule.type !== \'checklist\'"> <ff-label class="rr-role">{{role.name}}</ff-label> <rr-limit rule="$ctrl.rule" role="role.id" options="$ctrl.options" ng-if="$ctrl.rule.type === \'roles\'"></rr-limit> <rr-weekday-limit rule="$ctrl.rule" role="role.id" ng-if="$ctrl.rule.type === \'weekday\'"></rr-weekday-limit> <rr-date-limit rule="$ctrl.rule" role="role.id" ng-if="$ctrl.rule.type === \'date\'"></rr-date-limit> </ff-row> <ff-row ng-if="$ctrl.rule.type === \'value\'"> <rr-limit rule="$ctrl.rule" options="$ctrl.options"></rr-limit> </ff-row> <ff-row ng-if="$ctrl.rule.type === \'static\'"> <rr-static rule="$ctrl.rule"></rr-static> </ff-row> <ff-row ng-if="$ctrl.rule.type === \'checklist\'"> <rr-checklist rule="$ctrl.rule" options="$ctrl.options"></rr-checklist> </ff-row> </ng-form> '},I5Zy:function(e,r,t){"use strict";var l=t("0zKI"),n=t.n(l),a=(t("RF9M"),t("/MEN"),t("jd5N"));r.a=angular.module("dnd",["dndLists",a.a.name]).factory("dnd",["keese",function(e){return{move:function(r,t,l,a){var i=r[t];l&&n()(l).call(l,a,0,i);r===l&&a<=t&&t++;if(n()(r).call(r,t,1),l){var o=l.indexOf(i);i.order=e.generate(l[o-1]&&l[o-1].order,l[o+1]&&l[o+1].order)}return i}}}])},OngR:function(e,r){e.exports='<div> <ff-select ff-model="$ctrl.rule[$ctrl.role]" ff-options="opt.id as opt.name for opt in $ctrl.options" ng-if="$ctrl.rule.type === \'roles\'" ff-change="$ctrl.rule.$as()"></ff-select> <ff-select ff-model="$ctrl.rule.value" ff-options="opt.id as opt.name for opt in $ctrl.options" ng-if="$ctrl.rule.type === \'value\'" ff-change="$ctrl.rule.$as()"></ff-select> </div> '},jd5N:function(e,r,t){"use strict";var l=t("gQJ2"),n=t.n(l);r.a=angular.module("keese",[]).factory("keese",(function(){var e="0123456789?@ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=e.length,t=function(){for(var r={},t=0;t<e.length;t++)r[e[t]]=t;return r}();return{generate:function(e,r,t){return t?a(e,r,t):l(e,r)}};function l(e,r){return e?r?i(e,r):((t=s(e)).digits=t.digits.substr(0,t.order_length+1),o(t,s("1"))):r?i("0",r):"1";var t}function a(e,r,t){var n=new Array(t);if(t>0)if(r)!function e(r,t,a,i){var o=Math.floor((a+i)/2),s=l(r,t);n[o]=s,a<o&&e(r,s,a,o);o+1<i&&e(s,t,o+1,i)}(e,r,0,t);else for(var a=0;a<t;a++){var i=keese(e,null);n[a]=i,e=i}return n}function i(l,a){if(l>a)throw new Error("assertion failed: "+n()(l)+" < "+n()(a));var i=s(l),c=s(a);u(i,c);for(var d=0,v=Math.max(i.digits.length,c.digits.length),R=0;R<v||d>0;R++){var p=t[i.digits[R]]||0,m=d+(t[c.digits[R]]||0);if(p!==m){if(p!==m-1){for(var E=Math.floor((m-p)/2),$="",h=0;h<R;h++)$+="0";$+=e[E];var I=s(f(i.order_length,$));return i.digits=i.digits.substr(0,R+1),o(i,I)}d=r}}throw new Error}function o(l,n){u(l,n);for(var a="",i=l.order_length,o=0,s=Math.max(l.digits.length,n.digits.length)-1;s>=0;s--)o+=t[l.digits[s]]||0,o+=t[n.digits[s]]||0,a=e[o%r]+a,o=Math.floor(o/r);for(;o>0;)a=e[o%r]+a,o=Math.floor(o/r),i++;return f(i,a)}function s(e){var r=e.lastIndexOf("~")+1;return{order_length:r,digits:e.substr(r)}}function f(e,r){for(;e>0&&"0"==r.charAt(0);)r=r.substr(1),e--;for(var t="",l=0;l<e;l++)t+="~";return t+r}function u(e,r){c(e,r.order_length),c(r,e.order_length)}function c(e,r){for(;e.order_length<r;)e.digits="0"+e.digits,e.order_length++}}))},nzBw:function(e,r,t){"use strict";t("3dw1");var l=t("nbuU"),n=t.n(l),a=t("hsT8"),i=t.n(a),o=t("yCd9"),s=t.n(o),f=t("7LHe"),u=t.n(f),c=(t("rYdl"),t("0zKI")),d=t.n(c),v=t("F3iT"),R=t.n(v),p=(angular.module("deskworks.reservationRules.rrRule",["autoSave","deskworks.reservationRules.service"]).directive("rrRule",(function(){return{scope:!0,require:{rrCtrl:"^^reservationRules"},transclude:!0,template:R.a,controller:"RrRuleCtrl as $ctrl",bindToController:{rule:"<",options:"<",ruleSave:"&?"}}})).controller("RrRuleCtrl",["$scope","$element","$timeout","helper","dwAlerts","ReservationRules","autoSave",function(e,r,t,l,n,a,i){var o=this;o.$onInit=function(){r.addClass("ff-col"),o.roles=a.roles},o.$onChanges=function(){o.rule&&t((function(){var r=o.ruleSave||function(){return a.save({centerId:o.rrCtrl.centerId,reservationUnitId:o.rrCtrl.reservationUnitId},this).catch((function(e){return n.error(e,"Failed to save rule.")}))};o.rule.$as=i.wrap(r,e.rrForm)}))},o.deleteRule=function(){return(o.rule.id?a.delete({centerId:o.rrCtrl.centerId,ruleId:o.rule.id}):t()).then((function(){var e;return d()(e=o.rrCtrl.rules).call(e,o.rrCtrl.rules.indexOf(o.rule),1)})).catch((function(e){return n.error(e,"Failed to delete rule")}))}}]),t("OngR")),m=t.n(p),E=(angular.module("deskworks.reservationRules.rrLimit",[]).directive("rrLimit",(function(){return{scope:!0,template:m.a,controller:"RrLimitCtrl as $ctrl",bindToController:{rule:"<",role:"<",options:"<"}}})).controller("RrLimitCtrl",["$scope","$element",function(e,r){this.$onInit=function(){return r.addClass("ff-col")}}]),t("zae7")),$=t.n(E),h=(angular.module("deskworks.reservationRules.rrDateLimit",["deskworks.reservationRules.service"]).directive("rrDateLimit",(function(){return{scope:!0,require:["rrDateLimit","^^reservationRules"],template:$.a,controller:"RrDateLimitCtrl as $ctrl",bindToController:{rule:"<",role:"<"},link:function(e,r,t,l){l[0].rrCtrl=l[1]}}})).controller("RrDateLimitCtrl",["$scope","$element","$timeout","$translate","helper","ReservationRules",function(e,r,t,l,n,a){var o=this;o.options=[{id:!0,name:l.instant("RESERVATION_RULES.AVAILABLE")},{id:!1,name:l.instant("RESERVATION_RULES.NOT_AVAILABLE")}],o.$onInit=function(){r.addClass("ff-col"),e.$watch("$ctrl.rrCtrl.rules",o.updateGhosts)},o.addInterval=function(){o.rule.$$autoSaving||(o.rule[o.role].$ghosts&&o.rule[o.role].$ghosts.pop(),t((function(){o.rule[o.role].intervals.push({from:null,to:null}),o.updateGhosts()})))},o.deleteInterval=function(e){var r;if(!o.rule.$$autoSaving)return d()(r=o.rule[o.role].intervals).call(r,o.rule[o.role].intervals.indexOf(e),1),t(o.updateGhosts),e.id?o.rule.$as():null},o.updateGhosts=function(){var e;if(o.rrCtrl){var r=i()(e=o.rrCtrl.rules).call(e,(function(e){return"date"===e.type}));a.roles.forEach((function(e){var t=r.reduce((function(r,t){return t[e.id].available&&t[e.id].intervals.length>r?t[e.id].intervals.length:r}),0);r.forEach((function(r){r[e.id].$ghosts=new Array(t-(r[e.id].available?r[e.id].intervals.length:0))}))}))}}}]),t("wJY6")),I=t.n(h),g=(angular.module("deskworks.reservationRules.rrStatic",[]).directive("rrStatic",(function(){return{scope:!0,require:["rrWeekdayLimit","^^reservationRules"],template:I.a,controller:"RrStaticCtrl as $ctrl",bindToController:{rule:"<"}}})).controller("RrStaticCtrl",["$scope","$element","helper",function(e,r,t){this.$onInit=function(){return r.addClass("ff-col")}}]),t("10fB")),T=t.n(g),S=(angular.module("deskworks.reservationRules.rrWeekdayLimit",["deskworks.reservationRules.service"]).directive("rrWeekdayLimit",(function(){return{scope:!0,require:["rrWeekdayLimit","^^reservationRules"],template:T.a,controller:"RrWeekdayLimitCtrl as $ctrl",bindToController:{rule:"<",role:"<"},link:function(e,r,t,l){l[0].rrCtrl=l[1],l[0].onInit()}}})).controller("RrWeekdayLimitCtrl",["$scope","$element","$timeout","$translate","$locale","helper","ReservationRules",function(e,r,t,l,a,o,f){var u=this;u.weekdayIds=["sun","mon","tue","wed","thu","fri","sat"],u.options=[{id:!0,name:l.instant("RESERVATION_RULES.AVAILABLE")},{id:!1,name:l.instant("RESERVATION_RULES.NOT_AVAILABLE")}],u.onChangeAvailable=function(){if(angular.isString(u.rule[u.role].available)){var e,r=n()(o).call(o,u.rrCtrl.rules,{uid:u.rule[u.role].available});u.rule[u.role].intervals=s()(e=r[u.role].intervals).call(e,(function(e){return{from:e.from.clone(),to:e.to.clone()}})),u.rule[u.role].available=r[u.role].available}u.updateGhosts(),u.rule.$as()},u.onInit=function(){r.addClass("ff-col"),u.weekdayIds.forEach((function(e){e!==u.rule.uid&&u.options.push({id:e,name:l.instant("RESERVATION_RULES.COPY_FROM",{weekday:n()(o).call(o,u.rrCtrl.rules,{uid:e}).name.toUpperCase()})})})),e.$watchCollection("$ctrl.rule[$ctrl.role].intervals",(function(){return u.updateGhosts()}))},u.addInterval=function(){u.rule.$$autoSaving||(u.rule[u.role].$ghosts.pop(),t((function(){return u.rule[u.role].intervals.push({from:null,to:null})})))},u.deleteInterval=function(e){var r;if(!u.rule.$$autoSaving)return d()(r=u.rule[u.role].intervals).call(r,u.rule[u.role].intervals.indexOf(e),1),e.id?u.rule.$as():null},u.updateGhosts=function(){var e,r=i()(e=u.rrCtrl.rules).call(e,(function(e){return"weekday"===e.type}));f.roles.forEach((function(e){var t=r.reduce((function(r,t){return t[e.id].available&&t[e.id].intervals.length>r?t[e.id].intervals.length:r}),0);r.forEach((function(r){r[e.id].$ghosts=new Array(t-(r[e.id].available?r[e.id].intervals.length:0))}))}))}}]),t("6K7E")),A=t.n(S),k=angular.module("deskworks.reservationRules.rrChecklist",[]).directive("rrChecklist",(function(){return{scope:!0,template:A.a,controller:"RrChecklistCtrl as $ctrl",bindToController:{rule:"<",role:"<",options:"<"}}})).controller("RrChecklistCtrl",["$scope","$element",function(e,r){this.$onInit=function(){return r.addClass("ff-col")}}]),L=angular.module("deskworks.optsReservationScale",[]).factory("optsReservationScale",["$rootScope","$filter",function(e,r){var t=[{id:15},{id:30}];function l(){t.forEach((function(e){e.name=r("minutes")(e.id)}))}return l(),e.$on("$setTranslationsSuccess",l),t}]),w=angular.module("deskworks.optsReservationBuffer",[]).factory("optsReservationBuffer",["$rootScope","$translate","$filter",function(e,r,t){var l=[{id:0,_name:"GLOBAL.NONE"},{id:15},{id:30}];function n(){l.forEach((function(e){e.name=e._name?r.instant(e._name):t("minutes")(e.id)}))}return n(),e.$on("$setTranslationsSuccess",n),l}]);r.a=angular.module("deskworks.reservationRules",["deskworks.reservationRules.service","deskworks.inventory.product.service","deskworks.reservationRules.rrRule","deskworks.reservationRules.rrLimit","deskworks.reservationRules.rrWeekdayLimit","deskworks.reservationRules.rrDateLimit","deskworks.reservationRules.rrStatic","deskworks.reservationRules.optsWhoCanReserve","deskworks.reservationRules.optsReservationLimitMin","deskworks.reservationRules.optsReservationLimitMax","deskworks.reservationRules.optsDaysInAdvance","deskworks.reservationRules.optsTimeInAdvance",L.name,w.name,k.name]).directive("reservationRules",(function(){return{scope:!0,template:u.a,controller:"ReservationRulesCtrl as $ctrl",bindToController:{centerId:"<",reservationUnitId:"<"}}})).controller("ReservationRulesCtrl",["$scope","$q","$filter","$timeout","$translate","helper","dwAlerts","ReservationRules","productService","ReservationUnit","optsWhoCanReserve","optsReservationLimitMin","optsReservationLimitMax","optsDaysInAdvance","optsTimeInAdvance","optsReservationScale","optsReservationBuffer",function(e,r,t,l,a,o,f,u,c,d,v,R,p,m,E,$,h){var I=this;I.conf={whoCanReserve:{name:a.instant("RESERVATION_RULES.WHO_CAN_RESERVE"),opts:v},scale:{name:a.instant("RESERVATION_RULES.RESERVATION_SCALE"),opts:$},buffer:{name:a.instant("RESERVATION_RULES.RESERVATION_BUFFER"),opts:h},fullTimeProduct:{name:a.instant("RESERVATION_RULES.FULL_TIME_PRODUCT")},attachedUser:{name:a.instant("RESERVATION_RULES.ATTACHED_USER")},limitMin:{name:a.instant("RESERVATION_RULES.MIN_LIMIT"),opts:R},limitMax:{name:a.instant("RESERVATION_RULES.MAX_LIMIT"),opts:p},daysInAdvance:{name:a.instant("RESERVATION_RULES.DAYS_IN_ADVANCE"),opts:m},timeInAdvance:{name:a.instant("RESERVATION_RULES.TIME_IN_ADVANCE"),opts:E},nestedUnits:{name:a.instant("RESERVATION_RULES.NESTED_UNITS")}},I.$onInit=function(){I.form=e.formReservationRules},I.$onChanges=function(){u.query({centerId:I.centerId,reservationUnitId:I.reservationUnitId}).catch((function(e){return f.error(e,"Failed to load reservation rules.")})).then((function(e){var r,t,l;I.rules=e,I.whoCanReserve=n()(r=I.rules).call(r,(function(e){return"whoCanReserve"===e.uid})),I.scale=n()(t=I.rules).call(t,(function(e){return"scale"===e.uid})),I.buffer=n()(l=I.rules).call(l,(function(e){return"buffer"===e.uid}))})),I.reservationUnitId&&(d.query(I.centerId).catch((function(e){return f.error(e,"Reservation Rules failed to query reservation units.")})).then((function(e){var r=n()(e).call(e,(function(e){return e.id===I.reservationUnitId}))||{};I.fullTimeProduct={uid:"fullTimeProduct",type:"value",value:r.fullTimeProductId},I.attachedUser={uid:"attachedUser",type:"static",value:r.attachedUserName},I.conf.nestedUnits.opts=i()(e).call(e,(function(e){return e.reservationTypeId===r.reservationTypeId&&e.id!==r.id}))})),c.getMembershipProducts(I.centerId).catch((function(e){return f.error(e,"Reservation Rules failed to query membership products.")})).then((function(e){angular.forEach(e,(function(e){e.name+=" ("+t("ncurrency")(e.price)+")"})),I.conf.fullTimeProduct.opts=e,I.conf.fullTimeProduct.opts.unshift({id:null,name:a.instant("GLOBAL.NONE")})})))},e.$watch("$ctrl.whoCanReserve.value",(function(e){e&&(u.roles.forEach((function(r){r.$visible=r.$isVisible(e)})),I.hideRules="staffOnly"===e||"notAvailable"===e)})),I.addDate=function(){I.rules.push({type:"date",member:{available:!1,intervals:[]},nonMember:{available:!1,intervals:[]}})},I.resetRules=function(){if(window.confirm(a.instant("RESERVATION_RULES.ACTIVE.BTN_RESET.CONFIRM")))return u.query({centerId:I.centerId}).catch((function(e){return f.error(e,"Failed to load reservation rules defaults from center.")})).then((function(e){return I.copyRules(e)}))},I.copyRules=function(e){var t;return r.all(s()(t=i()(e).call(e,(function(e){return"value"===e.type||"roles"===e.type||"weekday"===e.type}))).call(t,(function(e){var r=n()(o).call(o,I.rules,{uid:e.uid});if(r){switch(e.type){case"value":r.value=e.value;break;case"roles":u.roles.forEach((function(t){r[t.id]=e[t.id]}));break;case"weekday":u.roles.forEach((function(t){var l;r[t.id].available=e[t.id].available,r[t.id].intervals=s()(l=e[t.id].intervals).call(l,(function(e){return{from:e.from,to:e.to}}))}))}return l((function(){return r.$as()}),100)}})))},I.saveFullTimeProduct=function(){return d.save(I.centerId,{id:I.reservationUnitId,fullTimeProductId:I.fullTimeProduct.value&&+I.fullTimeProduct.value||null}).catch((function(e){return f.error(e,"Failed to save full time product.")}))}}])},rYdl:function(e,r,t){},wJY6:function(e,r){e.exports='<ff-static ff-bind="$ctrl.rule.value | nd"></ff-static> '},zae7:function(e,r){e.exports='<ff-row> <ff-select ff-model="$ctrl.rule[$ctrl.role].available" ff-options="opt.id as opt.name for opt in $ctrl.options" ff-change="$ctrl.updateGhosts() + $ctrl.rule.$as()"></ff-select> <ff-btn flex="none" sense="add" size="xs" ng-class="{ invisible: !$ctrl.rule[$ctrl.role].available }" title="{{\'RESERVATION_RULES.BTN_ADD_INTERVAL.HINT\' | translate}}" ff-click="$ctrl.addInterval()"></ff-btn> </ff-row> <ff-row ng-repeat="interval in $ctrl.rule[$ctrl.role].intervals" ng-if="$ctrl.rule[$ctrl.role].available"> <ff-time ff-model="interval.from" ff-change="$ctrl.rule.$as()" ff-required="true" ff-time-order="{ early: interval.from, late: interval.to }" ff-validate-alert="{ field: (\'RESERVATION_RULES.TIME_FROM\' | translate), late: (\'RESERVATION_RULES.TIME_TO\' | translate) }" placeholder="09:00 AM"></ff-time> <ff-time ff-model="interval.to" ff-change="$ctrl.rule.$as()" ff-required="true" ff-time-order="{ early: interval.from, late: interval.to }" ff-validate-alert="{ field: (\'RESERVATION_RULES.TIME_TO\' | translate), early: (\'RESERVATION_RULES.TIME_FROM\' | translate) }" placeholder="05:00 PM"></ff-time> <ff-btn flex="none" sense="delete" size="xs" ff-click="$ctrl.deleteInterval(interval)" title="{{\'RESERVATION_RULES.BTN_DELETE_INTERVAL.HINT\' | translate}}"></ff-btn> </ff-row> <ff-row ng-repeat="item in $ctrl.rule[$ctrl.role].$ghosts track by $index"> <ff-static></ff-static> </ff-row> '}}]);