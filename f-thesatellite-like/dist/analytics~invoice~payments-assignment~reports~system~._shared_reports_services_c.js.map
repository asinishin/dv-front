{"version":3,"sources":["webpack:///./shared/reports/services/csv-make.service.js","webpack:///./shared/reports/services/file-saver.service.js","webpack:///./shared/reports/services/jspdf.service.js","webpack:///./shared/reports/services/logo.service.js","webpack:///./shared/reports/services/report-footer.service.js","webpack:///./shared/reports/services/report-header.service.js","webpack:///./shared/reports/services/report-helper.service.js","webpack:///./shared/reports/services/report-sort.service.js","webpack:///./shared/reports/services/report-styles.service.js"],"names":["angular","module","service","$q","generate","data","options","txtDelim","decimalSep","fieldSep","charset","isSpecialChar","getSpecialChar","stringify","EOL","BOM","specialChars","stringifyField","isFloat","toLocaleString","toString","replace","quoteStrings","indexOf","input","isFinite","Boolean","stringifyAsync","def","defer","that","csv","csvContent","dataPromise","when","then","responseData","isDefined","header","encodingArray","headerString","forEach","title","key","push","join","arrData","isArray","isFunction","label","labelArray","labelString","value","oldRow","index","row","copy","dataString","infoArray","iterator","columnOrder","field","val","length","addByteOrderMarker","resolve","err","reject","promise","undefined","factory","$window","blob","name","opts","popup","cordova","InAppBrowser","platformId","reader","FileReader","onloadend","url","result","open","readAsDataURL","saveAs","jsPDF","jsPdf","logoUrl","$http","deskworksConfig","siteLogoPromise","siteLogoInvPromise","maxWidth","maxHeight","getSiteLogo","loadLogo","getSiteLogoInv","loadLogoInv","resetSiteLogo","resetSiteLogoInv","img","Image","crossOrigin","src","getApiAbsUrl","onerror","console","warn","onload","convertLogo","document","querySelector","dw","width","dh","height","scaleFactor","Math","round","canvas","createElement","body","appendChild","ctx","getContext","drawImage","toDataURL","removeChild","reportStyles","$filter","oldFooter","newFooter","args","config","doc","resources","center","centers","i","id","centerId","str","pageWidth","internal","pageSize","pageHeight","setFont","getFont","fontName","setTextColor","footer","textColor","setFontSize","phone","street1","street2","city","state","zip","text","getTextWidth","$translate","oldHeader","newHeader","x","y","pageMargins","reportName","toUpperCase","fromDate","toDate","instant","pageCount","reportFor","moment","reportDates","reportOptions","reportSort","csvMake","fileSaver","logo","reportHeader","reportFooter","$rootScope","$timeout","dwAlerts","centerService","sort","paramsChanged","loadResources","buildPdf","buildCsv","getReportFileName","download","np","op","props","some","p","isMoment","isSame","extraLoaderFn","all","query","catch","error","report","paperLayout","paperSize","startY","rows","colIdx","cell","idx","isUndefined","content","col","columns","pdf","converted","colSpan","styles","headStyles","textTransform","bodyStyles","columnStyles","tableMargin","didParseCell","stylesInjector","didDrawCell","hd","drawCell","didDrawPage","table","margin","autoTable","column","section","defaultStyles","minCellWidth","fillColor","extend","borderColor","borderWidth","setLineWidth","setDrawColor","rect","settings","left","getWidth","reduce","res","Array","unshift","Blob","type","extension","postfix","toLowerCase","centerName","fileName","reportData","order","reverse","ord","helper","borderLightColor","lightColor","darkColor","fontSize","fontStyle","valign","hex2rgbArr","overflow","rowOdd","h1","h2","h3"],"mappings":"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","file":"analytics~invoice~payments-assignment~reports~system~._shared_reports_services_c.js?_rev=e9dda25694d17e3a33e2","sourcesContent":["/**\n * csvMake service - generates CSV from data[[]]\n * Based on https://github.com/asafdav/ng-csv\n */\nexport default angular.module('csvMake', []).\n  service('csvMake', function($q) {\n\n    /**\n     * Generates CSV from data[[]] and options.\n     */\n    this.generate = function(data, options) {\n      options.txtDelim = options.txtDelim || '\"';\n      options.decimalSep = options.decimalSep || '.';\n      options.fieldSep = options.fieldSep || ',';\n      options.charset = options.charset || 'utf-8';\n\n      // Replaces any badly formatted special character string with correct special character\n      options.fieldSep = this.isSpecialChar(options.fieldSep) ? this.getSpecialChar(options.fieldSep) : options.fieldSep;\n\n      return this.stringify(data, options);\n    };\n\n    const EOL = '\\r\\n';\n    const BOM = \"\\ufeff\";\n\n    const specialChars = {\n      '\\\\t': '\\t',\n      '\\\\b': '\\b',\n      '\\\\v': '\\v',\n      '\\\\f': '\\f',\n      '\\\\r': '\\r'\n    };\n\n    /**\n     * Stringify one field\n     */\n    this.stringifyField = function (data, options) {\n      if (options.decimalSep === 'locale' && this.isFloat(data)) {\n        return data.toLocaleString();\n      }\n\n      if (options.decimalSep !== '.' && this.isFloat(data)) {\n        return data.toString().replace('.', options.decimalSep);\n      }\n\n      if (typeof data === 'string') {\n        data = data.replace(/\"/g, '\"\"'); // Escape double qoutes\n\n        if (options.quoteStrings || data.indexOf(',') > -1 || data.indexOf('\\n') > -1 || data.indexOf('\\r') > -1) {\n          data = options.txtDelim + data + options.txtDelim;\n        }\n\n        return data;\n      }\n\n      if (typeof data === 'boolean') {\n        return data ? 'TRUE' : 'FALSE';\n      }\n\n      return data;\n    };\n\n    /**\n     * Helper function to check if input is float\n     */\n    this.isFloat = function (input) {\n      return +input === input && (!isFinite(input) || Boolean(input % 1));\n    };\n\n    /**\n     * Creates a csv from a data array\n     * @param data\n     * @param options\n     *  * header - Provide the first row (optional)\n     *  * fieldSep - Field separator, default: ',',\n     *  * addByteOrderMarker - Add Byte order mark, default(false)\n     */\n    this.stringifyAsync = function (data, options) {\n      const def = $q.defer();\n\n      const that = this;\n      let csv = \"\";\n      let csvContent = \"\";\n\n      const dataPromise = $q.when(data).then(responseData => {\n        //responseData = angular.copy(responseData);//moved to row creation\n        // Check if there's a provided header array\n        if (angular.isDefined(options.header) && options.header) {\n          let encodingArray, headerString;\n\n          encodingArray = [];\n          angular.forEach(options.header, function(title, key) {\n            this.push(that.stringifyField(title, options));\n          }, encodingArray);\n\n          headerString = encodingArray.join(options.fieldSep ? options.fieldSep : \",\");\n          csvContent += headerString + EOL;\n        }\n\n        let arrData = [];\n\n        if (angular.isArray(responseData)) {\n          arrData = responseData;\n        }\n        else if (angular.isFunction(responseData)) {\n          arrData = responseData();\n        }\n\n        // Check if using keys as labels\n        if (angular.isDefined(options.label) && options.label && typeof options.label === 'boolean') {\n          let labelArray, labelString;\n\n          labelArray = [];\n          angular.forEach(arrData[0], function(value, label) {\n            this.push(that.stringifyField(label, options));\n          }, labelArray);\n          labelString = labelArray.join(options.fieldSep ? options.fieldSep : \",\");\n          csvContent += labelString + EOL;\n        }\n\n        angular.forEach(arrData, function (oldRow, index) {\n          const row = angular.copy(arrData[index]);\n          let dataString, infoArray;\n\n          infoArray = [];\n\n          var iterator = !!options.columnOrder ? options.columnOrder : row;\n          angular.forEach(iterator, function(field, key) {\n            const val = !!options.columnOrder ? row[field] : field;\n            this.push(that.stringifyField(val, options));\n          }, infoArray);\n\n          dataString = infoArray.join(options.fieldSep ? options.fieldSep : \",\");\n          csvContent += index < arrData.length ? dataString + EOL : dataString;\n        });\n\n        // Add BOM if needed\n        if (options.addByteOrderMarker) {\n          csv += BOM;\n        }\n\n        // Append the content and resolve.\n        csv += csvContent;\n        def.resolve(csv);\n      });\n\n      if (typeof dataPromise['catch'] === 'function') {\n        dataPromise['catch'](err => {\n          def.reject(err);\n        });\n      }\n\n      return def.promise;\n    };\n\n    /**\n     * Creates a csv from a data array\n     * @param data\n     * @param options\n     *  * header - Provide the first row (optional)\n     *  * fieldSep - Field separator, default: ',',\n     *  * addByteOrderMarker - Add Byte order mark, default(false)\n     */\n    this.stringify = function(data, options) {\n      const that = this;\n      let csv = '';\n      let csvContent = '';\n\n      // Check if there's a provided header array\n      if (angular.isDefined(options.header) && options.header) {\n        let encodingArray, headerString;\n\n        encodingArray = [];\n        angular.forEach(options.header, function(title, key) {\n          this.push(that.stringifyField(title, options));\n        }, encodingArray);\n\n        headerString = encodingArray.join(options.fieldSep ? options.fieldSep : \",\");\n        csvContent += headerString + EOL;\n      }\n\n      const arrData = data;\n\n      // Check if using keys as labels\n      if (angular.isDefined(options.label) && options.label && typeof options.label === 'boolean') {\n        let labelArray, labelString;\n\n        labelArray = [];\n        angular.forEach(arrData[0], function(value, label) {\n          this.push(that.stringifyField(label, options));\n        }, labelArray);\n        labelString = labelArray.join(options.fieldSep ? options.fieldSep : \",\");\n        csvContent += labelString + EOL;\n      }\n\n      angular.forEach(arrData, (oldRow, index) => {\n        const row = angular.copy(arrData[index]);\n        let dataString, infoArray;\n\n        infoArray = [];\n\n        const iterator = !!options.columnOrder ? options.columnOrder : row;\n        angular.forEach(iterator, function(field, key) {\n          const val = !!options.columnOrder ? row[field] : field;\n          this.push(that.stringifyField(val, options));\n        }, infoArray);\n\n        dataString = infoArray.join(options.fieldSep ? options.fieldSep : \",\");\n        csvContent += index < arrData.length ? dataString + EOL : dataString;\n      });\n\n      // Add BOM if needed\n      if (options.addByteOrderMarker) {\n        csv += BOM;\n      }\n\n      // Append the content\n      csv += csvContent;\n      return csv;\n    };\n\n    /**\n     * Helper function to check if input is really a special character\n     * @param input\n     * @returns {boolean}\n     */\n    this.isSpecialChar = function(input) {\n      return specialChars[input] !== undefined;\n    };\n\n    /**\n     * Helper function to get what the special character was supposed to be\n     * since Angular escapes the first backslash\n     * @param input\n     * @returns {special character string}\n     */\n    this.getSpecialChar = function (input) {\n      return specialChars[input];\n    };\n\n  });\n","import 'file-saver';\n\nexport default angular.module('fileSaver', [])\n  .factory('fileSaver', function($window) {\n    return function(blob, name, opts, popup) {\n\n      if ($window.cordova && $window.cordova.InAppBrowser && $window.cordova.platformId === 'ios') {\n        const reader = new FileReader();\n        reader.onloadend = function () {\n          const url = reader.result;\n          return $window.cordova.InAppBrowser.open(url, '_blank', 'hidenavigationbuttons=yes,hideurlbar=yes,enableViewportScale=yes,location=no');\n        };\n        reader.readAsDataURL(blob);\n        return;\n      }\n\n      return $window.saveAs(blob, name, opts, popup);\n    };\n  });\n","import jsPdf from 'jspdf';\nimport 'jspdf-autotable';\n\n/**\n * jsPDF service - wrapper for jsPDF\n */\nexport default angular.module('jsPDF', [])\n  .factory('jsPDF', function($window) {\n    $window.jsPDF = jsPdf;\n    return $window.jsPDF;\n  });\n","const logoUrl = '/white-label/images/logo-print.png';\n\n/**\n * Logo service - handles logos for invoice\n */\nexport default angular.module('deskworks.logo', [])\n\n  .factory('logo', function($window, $http, $q, deskworksConfig) {\n    let siteLogoPromise, siteLogoInvPromise;\n\n    const maxWidth = 480, maxHeight = 171; // according to w = 140, h = 50 in invoice-header.service.js\n\n    return {\n      getSiteLogo: function() {\n        siteLogoPromise = siteLogoPromise || loadLogo();\n        return siteLogoPromise;\n      },\n      getSiteLogoInv: function() {\n        siteLogoInvPromise = siteLogoInvPromise || loadLogoInv();\n        return siteLogoInvPromise;\n      },\n      resetSiteLogo: function() {\n        siteLogoPromise = null;\n      },\n      resetSiteLogoInv: function() {\n        siteLogoInvPromise = null;\n      },\n    };\n\n    /**\n     * Loads non-inverted logo\n     */\n    function loadLogo() {\n      return $q(resolve => {\n        let img = new Image();\n        img.crossOrigin = 'anonymous';\n        img.src = deskworksConfig.getApiAbsUrl(logoUrl);\n\n        img.onerror = function() {\n          console.warn('Report failed to load site logo.');\n          resolve(null);\n          img = null;\n        };\n\n        img.onload = function() {\n          resolve(img);\n          img = null;\n        };\n      })\n        .then(convertLogo);\n    }\n\n    /**\n     * Loads inverted logo\n     */\n    function loadLogoInv() {\n      return $q(resolve => {\n        const img = document.querySelector('.sidebar-logo a img');\n        if (!img) console.warn('Report failed to load site logo.');\n        resolve(img);\n      })\n        .then(convertLogo);\n    }\n\n    /**\n     * Downscales logo and converts to data-url then returns { width, height, data }\n     */\n    function convertLogo(img) {\n      if (!img) return null;\n\n      const dw = img.width / maxWidth;\n      const dh = img.height / maxHeight;\n      const scaleFactor = dw > dh ? dw : dh;\n      const width = Math.round(img.width / scaleFactor);\n      const height = Math.round(img.height / scaleFactor);\n\n      const canvas = document.createElement('canvas');\n      document.body.appendChild(canvas);\n      canvas.width = width;\n      canvas.height = height;\n\n      const ctx = canvas.getContext('2d');\n\n      ctx.drawImage(img, 0, 0, width, height);\n\n      const data = canvas.toDataURL('image/png');\n      document.body.removeChild(canvas);\n\n      return { width, height, data };\n    }\n  });\n","import reportStyles from './report-styles.service';\n\n/**\n * PDF Report Footer\n */\nexport default angular.module('deskworks.reports.reportFooter', [\n  reportStyles.name,\n])\n\n  .factory('reportFooter', function($filter, reportStyles) {\n    return (...args) => args.length === 3 ? oldFooter(...args) : newFooter(...args);\n\n    /**\n     * @param args.config - merged config + params\n     * @param args.doc - jsPdfDoc\n     * @param args.data - data.table\n     * @param args.resources - { centers: [{...}] }\n     */\n    function newFooter(args) {\n      const { config, doc, data, resources } = args;\n\n      const center = resources.centers.find(i => i.id === +config.centerId);\n      if (!center) return; // no center - no footer\n\n      let str;\n      const pageWidth = doc.internal.pageSize.width;\n      const pageHeight = doc.internal.pageSize.height;\n\n      doc.setFont(doc.getFont().fontName, 'normal');\n      doc.setTextColor(reportStyles.footer.textColor);\n\n      doc.setFontSize(9);\n      str = [\n        center.name,\n        center.phone,\n        center.street1\n      ];\n      if(center.street2) str.push(center.street2);\n      str.push(center.city);\n      str.push(center.state.name || center.state);\n      str.push(center.zip);\n      str = str.join(' / ');\n      doc.text(str, (pageWidth - doc.getTextWidth(str)) / 2, pageHeight - 30);\n    }\n\n\n\n    // TODO: remove it after migration to reportHelper service\n    function oldFooter(data, doc, config) {\n      var str;\n      var pageWidth = doc.internal.pageSize.width;\n      var pageHeight = doc.internal.pageSize.height;\n\n      doc.setFont(doc.getFont().fontName, 'normal');\n      doc.setTextColor(reportStyles.footer.textColor);\n\n      doc.setFontSize(9);\n      str = [\n        config.center.name,\n        config.center.phone,\n        config.center.street1\n      ];\n      if(config.center.street2) str.push(config.center.street2);\n      str.push(config.center.city);\n      str.push(config.center.state.name || config.center.state);\n      str.push(config.center.zip);\n      str = str.join(' / ');\n      doc.text(str, (pageWidth - doc.getTextWidth(str)) / 2, pageHeight - 30);\n    }\n  });\n","import reportStyles from './report-styles.service';\n\n/**\n * PDF Report Header\n */\nexport default angular.module('deskworks.reports.reportHeader', [\n  reportStyles.name,\n])\n\n  .factory('reportHeader', ($filter, $translate, reportStyles) => {\n    return (...args) => args.length === 3 ? oldHeader(...args) : newHeader(...args);\n\n    /**\n     * @param args.config - merged config + params\n     * @param args.doc - jsPdfDoc\n     * @param args.data - data.table\n     * @param args.resources - { centers: [{...}] }\n     */\n    function newHeader(args) {\n      const { config, doc, data, resources } = args;\n      const center = resources.centers.find(i => i.id === +config.centerId);\n\n      let str, x, y;\n      const pageWidth = doc.internal.pageSize.width;\n\n      doc.setFont(doc.getFont().fontName, 'normal');\n      doc.setTextColor(reportStyles.header.textColor);\n\n      /**\n       * Report Name\n       */\n      // x = data.settings.margin.left; y = 40;\n      x = reportStyles.pageMargins[3]; y = 40;\n      doc.setFontSize(14);\n      str = config.reportName.toUpperCase();\n      doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n\n      /**\n       * Report Period\n       */\n      if (config.fromDate || config.toDate) {\n        doc.setFontSize(7);\n        str = $translate.instant('REPORTS.HEADER.FOR_PERIOD').toUpperCase();\n        if (config.fromDate) str += ' ' + $translate.instant('REPORTS.HEADER.FROM').toUpperCase() + ':';\n        doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n\n        if (config.fromDate) {\n          doc.setFontSize(9);\n          str = $filter('date')(config.fromDate, 'mediumDate') || '';\n          doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n        }\n\n        doc.setFontSize(7);\n        str = $translate.instant('REPORTS.HEADER.THROUGH').toUpperCase() + ':';\n        doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n\n        doc.setFontSize(9);\n        str = $filter('date')(config.toDate, 'mediumDate') || '';\n        doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n      }\n\n      /**\n       * Page\n       */\n      // x = pageWidth - data.settings.margin.right;\n      x = pageWidth - reportStyles.pageMargins[1];\n      doc.setFontSize(9);\n      str = '' + data.pageCount;\n      x -= doc.getTextWidth(str); doc.text(str, x, y);\n      doc.setFontSize(7);\n      str = $translate.instant('REPORTS.HEADER.PAGE').toUpperCase() + ':';\n      x -= doc.getTextWidth(str + ' '); doc.text(str, x, y - 0.6);\n\n      /**\n       * Report For\n       */\n      // x = data.settings.margin.left; y += 11;\n      x = reportStyles.pageMargins[3]; y += 11;\n      doc.setFontSize(7);\n      str = $translate.instant('REPORTS.HEADER.REPORT_FOR').toUpperCase() + ':';\n      doc.text(str, x, y - 0.6); x += doc.getTextWidth(str + ' ');\n      doc.setFontSize(9);\n      str = config.reportFor || (center ? [center.name, center.city, center.state].join(', ') : 'All Centers');\n      doc.text(str, x, y); x += doc.getTextWidth(str + ' ');\n\n      /**\n       * Report Date\n       */\n      // x = pageWidth - data.settings.margin.right;\n      x = pageWidth - reportStyles.pageMargins[1];\n      doc.setFontSize(9);\n      str = $filter('date')(moment(), 'mediumDate');\n      x -= doc.getTextWidth(str); doc.text(str, x, y);\n      doc.setFontSize(7);\n      str = $translate.instant('REPORTS.HEADER.REPORT_DATE').toUpperCase() + ':';\n      x -= doc.getTextWidth(str + ' '); doc.text(str, x, y - 0.6);\n    }\n\n\n\n    // TODO: remove it after migration to reportHelper service\n    function oldHeader(data, doc, config) {\n      var str, x, y;\n      var pageWidth = doc.internal.pageSize.width;\n\n      doc.setFont(doc.getFont().fontName, 'normal');\n      doc.setTextColor(reportStyles.header.textColor);\n\n      /**\n       * Report Name\n       */\n      // x = data.settings.margin.left; y = 40;\n      x = reportStyles.pageMargins[3]; y = 40;\n      doc.setFontSize(14);\n      str = config.reportName.toUpperCase();\n      doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n\n      /**\n       * Report Period\n       */\n      if(config.reportDates) {\n        doc.setFontSize(7);\n        str = $translate.instant('REPORTS.HEADER.FOR_PERIOD').toUpperCase();\n        if(config.reportDates.fromDate) str += ' ' + $translate.instant('REPORTS.HEADER.FROM').toUpperCase() + ':';\n        doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n\n        if(config.reportDates.fromDate) {\n          doc.setFontSize(9);\n          str = $filter('date')(config.reportDates.fromDate, 'mediumDate') || '';\n          doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n        }\n\n        doc.setFontSize(7);\n        str = $translate.instant('REPORTS.HEADER.THROUGH').toUpperCase() + ':';\n        doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n\n        doc.setFontSize(9);\n        str = $filter('date')(config.reportDates.toDate, 'mediumDate') || '';\n        doc.text(str, x, y); x += doc.getTextWidth(str) + 3;\n      }\n\n      /**\n       * Page\n       */\n      // x = pageWidth - data.settings.margin.right;\n      x = pageWidth - reportStyles.pageMargins[1];\n      doc.setFontSize(9);\n      str = '' + data.pageCount;\n      x -= doc.getTextWidth(str); doc.text(str, x, y);\n      doc.setFontSize(7);\n      str = $translate.instant('REPORTS.HEADER.PAGE').toUpperCase() + ':';\n      x -= doc.getTextWidth(str + ' '); doc.text(str, x, y - 0.6);\n\n      /**\n       * Report For\n       */\n      // x = data.settings.margin.left; y += 11;\n      x = reportStyles.pageMargins[3]; y += 11;\n      doc.setFontSize(7);\n      str = $translate.instant('REPORTS.HEADER.REPORT_FOR').toUpperCase() + ':';\n      doc.text(str, x, y - 0.6); x += doc.getTextWidth(str + ' ');\n      doc.setFontSize(9);\n      str = config.reportFor || (config.reportOptions.centerId === false || +config.reportOptions.centerId) && [config.center.name, config.center.city, config.center.state.name].join(', ') || 'All Centers';\n      doc.text(str, x, y); x += doc.getTextWidth(str + ' ');\n\n      /**\n       * Report Date\n       */\n      // x = pageWidth - data.settings.margin.right;\n      x = pageWidth - reportStyles.pageMargins[1];\n      doc.setFontSize(9);\n      str = $filter('date')(moment(), 'mediumDate');\n      x -= doc.getTextWidth(str); doc.text(str, x, y);\n      doc.setFontSize(7);\n      str = $translate.instant('REPORTS.HEADER.REPORT_DATE').toUpperCase() + ':';\n      x -= doc.getTextWidth(str + ' '); doc.text(str, x, y - 0.6);\n    }\n  });\n","import reportSort from './report-sort.service';\nimport csvMake from './csv-make.service';\nimport jsPDF from './jspdf.service';\nimport fileSaver from './file-saver.service';\nimport logo from './logo.service';\nimport reportStyles from './report-styles.service';\nimport reportHeader from './report-header.service';\nimport reportFooter from './report-footer.service';\n\n/**\n * Report helper service - creates report configuration from report data to create PDF via pdfMake\n */\nexport default angular.module('deskworks.reportHelper', [\n  reportSort.name,\n  csvMake.name,\n  jsPDF.name,\n  fileSaver.name,\n  logo.name,\n  reportStyles.name,\n  reportHeader.name,\n  reportFooter.name,\n])\n  .factory('reportHelper', function($rootScope, $q, $timeout, $window, $filter, $http, dwAlerts,\n                                    state, logo, jsPDF, csvMake, centerService, reportStyles, reportHeader,\n                                    reportFooter, reportSort, fileSaver) {\n\n    return {\n      sort: reportSort,\n      paramsChanged,\n      loadResources,\n      buildPdf,\n      buildCsv,\n      getReportFileName,\n      download,\n    };\n\n    function paramsChanged(np = {}, op = {}, props = []) {\n      return props.some(p => moment.isMoment(np[p]) ? !moment.isMoment(op[p]) || !np[p].isSame(op[p]) : np[p] !== op[p]);\n    }\n\n    function loadResources(extraLoaderFn = () => ({})) {\n      return $q.all({\n        ...extraLoaderFn(),\n        centers: centerService.query().catch(err => dwAlerts.error(err, 'Failed to query centers.')),\n        logo: logo.getSiteLogo(),\n      });\n    }\n\n    /**\n     * Build jsPdfDoc based on config/params/data/resources\n     * @param args.config - merged config + params\n     * @param args.config.styles - custom report styles\n     * @param args.config.header - custom report header\n     * @param args.config.footer - custom report footer\n     * @param args.report - report data { rows: [], columns: [], styles: [] }\n     * @param args.resources - resources e.g. list of centers\n     * @param args.doc - JsPdf document\n     * @param args.startY -\n     * @returns {*|jsPDF}\n     */\n    function buildPdf(args) {\n      const { config, report, resources, doc = new jsPDF(config.paperLayout, 'pt', config.paperSize), startY } = args;\n\n      const rows = angular.copy(report.rows);\n\n      // Format data\n      rows.forEach(row => {\n        let colIdx = 0;\n        row.forEach((cell, idx) => {\n          if (!cell || angular.isUndefined(cell.content)) row[idx] = cell = { content: cell };\n          const col = report.columns[colIdx];\n          if (cell.content === false) {\n            cell.content = '';\n          } else {\n            if (col.pdf) { // pdf formatter\n              const converted = col.pdf(cell.content);\n              cell.content = converted === '' ? cell.content : converted;\n            }\n            cell.content = angular.isUndefined(cell.content) || cell.content === null || cell.content === '' ? '-' : cell.content;\n          }\n          colIdx += cell.colSpan || 1;\n        });\n      });\n\n      const options = {\n        columns: report.columns.map(col => !config.styles || config.styles.headStyles.textTransform === 'uppercase' ? col.title.toUpperCase() : col.title),\n        body: rows,\n        headStyles: (config.styles || reportStyles).headStyles,\n        bodyStyles: (config.styles || reportStyles).bodyStyles,\n        columnStyles: (config.styles || reportStyles).columnStyles,\n        tableMargin: config.styles && config.styles.tableMargin || (config.styles || reportStyles).pageMargins,\n        startY: startY || (config.styles || reportStyles).startY || false,\n        didParseCell: stylesInjector,\n        didDrawCell: hd => drawCell(hd, report.columns),\n        didDrawPage: data => {\n          (config.header || reportHeader)({ config, doc, data: data.table, resources });\n          (config.footer || reportFooter)({ config, doc, data: data.table, resources });\n        },\n      };\n\n      options.margin = options.tableMargin || (config.styles || reportStyles).pageMargins;\n\n      doc.autoTable(options);\n\n      return doc;\n\n      function stylesInjector(hd) { // Hook for individual row/cell styling\n        const { row, cell, column, section } = hd;\n        if (section === 'body') {\n          const defaultStyles = { minCellWidth: 50, fillColor: false };\n          angular.extend(cell.styles, defaultStyles, report.styles[row.index], report.columns[column.index].styles, rows[row.index][column.index] ? rows[row.index][column.index].styles : null);\n        } else {\n          angular.extend(cell.styles, report.columns[column.index].styles);\n        }\n      }\n\n      /**\n       * Custom Cell Renderer\n       */\n      function drawCell(data, columns) {\n        const { cell, doc } = data;\n        // Border\n        if (data.column.index === 0 && cell.styles.borderColor && cell.styles.borderWidth) {\n          doc.setLineWidth(cell.styles.borderWidth);\n          doc.setDrawColor(cell.styles.borderColor[0], cell.styles.borderColor[1], cell.styles.borderColor[2]);\n          doc.rect(\n            data.settings.margin.left + cell.styles.borderWidth / 2,\n            cell.y + cell.styles.borderWidth / 2,\n            data.table.getWidth(doc.internal.pageSize.width) - cell.styles.borderWidth,\n            data.row.height - cell.styles.borderWidth * 2,\n            'S'\n          );\n        }\n\n        return false;\n      }\n    }\n\n    /**\n     * Build CSV report\n     * @param args.report - report data { rows: [], columns: [], styles: [] }\n     */\n    function buildCsv(args) {\n      const { report } = args;\n      const options = { charset: 'utf-8' };\n\n      const rows = report.rows.map(row => row.reduce((res, cell) => { // unwrap colSpans\n        res.push(cell);\n        return res.concat(new Array((cell && cell.colSpan ? cell.colSpan : 1 || 1) - 1).fill(null));\n      }, []));\n\n      // Format data\n      rows.forEach(row => {\n        row.forEach((cell, idx) => {\n          if (row[idx] && angular.isDefined(row[idx].content)) row[idx] = row[idx].content;\n          const col = report.columns[idx];\n          if (col.csv) { // csv formatter\n            const converted = col.csv(row[idx]);\n            row[idx] = converted === '' ? row[idx] : converted;\n          }\n          row[idx] = angular.isUndefined(row[idx]) || row[idx] === null || row[idx] === false || row[idx] === '' ? '' : row[idx];\n        });\n      });\n\n      rows.unshift(report.columns.map(col => col.title.toUpperCase()));\n\n      return new Blob([csvMake.generate(rows, options)], { type: 'text/csv;charset=' + options.charset + ';' });\n    }\n\n    /**\n     * Builds report file name: report-name_center-name_yyyy-MM-dd_HH-mm-ss.type\n     * @param args.config - merged config + params\n     * @param args.resources - { centers: [{...}] }\n     * @param args.extension - file extension, default 'pdf'\n     * @param args.postfix - file postfix\n     */\n    function getReportFileName(args) {\n      const { extension = 'pdf', postfix = '', config, resources } = args;\n      const reportName = config.reportName.toLowerCase().replace(/\\s+/g, '-');\n\n      const center = resources.centers.find(i => i.id === +config.centerId) || { name: 'all-centers' };\n      const centerName = center.name.toLowerCase().replace(/\\s+/g, '-');\n\n      return reportName + '-' + centerName + '-' + $filter('date')(moment(), 'yyyyMMdd-HHmmss') + postfix + '.' + extension.toLowerCase();\n    }\n\n    /**\n     * Download report file\n     * @param blob - blob of pdf or csv\n     * @param fileName - file name\n     */\n    function download({ blob, fileName }) {\n      if (!blob) return;\n      fileSaver(blob, fileName);\n    }\n  });\n","export default angular.module('deskworks.reportSort', [])\n\n  .factory('reportSort', ($filter) => (reportData, order, reverse) => {\n    if (!angular.isArray(order)) order = [order];\n\n    order = order.map(ord => `${ord} || ${ord} === 0 ? ${ord} : \"~~~\"`);\n\n    return $filter('orderBy')(reportData, order, reverse);\n  });\n","/**\n * reportStyles service - defines PDF styling for all reports\n */\nexport default angular.module('deskworks.reports.reportStyles', [\n  'deskworks.helper',\n])\n  .factory('reportStyles', function(helper) {\n\n    const borderLightColor = '#eeeeee';\n    const lightColor = '#949594';\n    const darkColor = '#444444';\n\n    return {\n      pageMargins: [60, 25, 50, 25],\n\n      headStyles: {\n        fontSize: 9,\n        fontStyle: 'normal',\n        valign: 'middle',\n        fillColor: helper.hex2rgbArr(darkColor),\n        textColor: 255,\n        textTransform: 'uppercase',\n      },\n\n      bodyStyles: {\n        overflow: 'linebreak',\n        textColor: 0\n      },\n\n      header: {\n        textColor: lightColor,\n      },\n\n      footer: {\n        textColor: lightColor,\n      },\n\n      // Striped table\n      rowOdd: {\n        fillColor: [245, 245, 245]\n      },\n\n      // Special table rows for grouping\n      h1: {\n        fontStyle: 'bold',\n        fillColor: helper.hex2rgbArr(lightColor),\n        textColor: [255, 255, 255]\n      },\n      h2: {\n        fontStyle: 'bold',\n        textColor: helper.hex2rgbArr(darkColor),\n        borderWidth: 1,\n        borderColor: helper.hex2rgbArr(darkColor)\n      },\n      h3: {\n        fontStyle: 'bold'\n      }\n    };\n  });\n"],"sourceRoot":""}