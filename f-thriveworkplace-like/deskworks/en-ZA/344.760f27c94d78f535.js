"use strict";(self.webpackChunkdeskworks=self.webpackChunkdeskworks||[]).push([[344],{6344:(W,_,a)=>{a.r(_),a.d(_,{UserProfileModule:()=>B});var m=a(1343),d=a(6304),S=a(4762),u=a(423),O=a(5804),p=a(9578),e=a(3556),R=a(5130),c=a(3701),g=a(1732),h=a(5106),E=a(1847),U=a(8021),F=a(6357),P=a(6019),I=a(5043);let M=(()=>{class t{constructor(o){this.el=o,this.ffUpload=new e.vpe,this.ffUploadTypes=[],this.dragover=!1,this.dnd=!0}ngOnInit(){if(this.dnd="FF-BTN"!==this.el.nativeElement.tagName,!this.dnd){const o=this.el.nativeElement.querySelector("button");if(o){const n=document.createElement("input");n.type="file",n.hidden=!0,n.addEventListener("change",()=>{var s;(null===(s=n.files)||void 0===s?void 0:s.length)&&this.ffUpload.emit(Array.from(n.files))}),n.accept=this.ffUploadTypes.join(","),this.el.nativeElement.append(n),o.addEventListener("click",()=>n.click())}}}onDragenter(o){!this.dnd||(this.dragover=!0,o.preventDefault(),o.stopPropagation())}onDragover(o){!this.dnd||(this.dragover=!0,o.preventDefault(),o.stopPropagation())}onDragleave(o){!this.dnd||(this.dragover=!1,o.preventDefault(),o.stopPropagation())}onDrop(o){var n;if(this.dnd){if(null===(n=o.dataTransfer)||void 0===n?void 0:n.files.length){const s=Array.from(o.dataTransfer.files),i=this.ffUploadTypes.length&&s.find(f=>this.ffUploadTypes.indexOf(f.type.toLowerCase())<0);if(i){const f=this.ffUploadTypes.map(G=>`"${G}"`).join(" or "),L="File \"" + i.name + "\" has invalid type \"" + i.type + "\". Please use " + f + " type.";this.ffUpload.emit(new Error(L))}else this.ffUpload.emit(Array.from(o.dataTransfer.files))}this.dragover=!1,o.preventDefault(),o.stopPropagation()}}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(e.SBq))},t.\u0275dir=e.lG2({type:t,selectors:[["","ffUpload",""]],hostVars:2,hostBindings:function(o,n){1&o&&e.NdJ("dragenter",function(i){return n.onDragenter(i)})("dragover",function(i){return n.onDragover(i)})("dragleave",function(i){return n.onDragleave(i)})("drop",function(i){return n.onDrop(i)}),2&o&&e.ekj("dragover",n.dragover)},inputs:{ffUploadTypes:"ffUploadTypes"},outputs:{ffUpload:"ffUpload"}}),t})();var y=a(8896),D=a(3512),A=a(3733),C=a(8329);const T=function(){return["image/png","image/jpeg"]};function Z(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"ff-btn-group",6),e.TgZ(1,"ff-btn",7),e.NdJ("ffUpload",function(s){return e.CHM(o),e.oxw().upload(s)}),e.tHW(2,8),e._UZ(3,"fa-icon",9),e.N_p(),e.qZA(),e.qZA()}if(2&t){const o=e.oxw();e.xp6(1),e.Q6J("spin",o.uploading)("ffUploadTypes",e.DdM(3,T)),e.xp6(2),e.Q6J("icon",o.faUpload)}}let N=(()=>{class t{constructor(o,n,s){this.route=o,this.alerts=n,this.userService=s,this.faUpload=I.cf$,this.uploading=!1}upload(o){if(o instanceof Error)return this.alerts.error(o.message);if(!o.length)return;const n=+this.route.snapshot.queryParams.center;this.uploading=!0,this.userService.uploadPhoto(n,this.user.id,o[0]).pipe((0,u.x)(()=>this.uploading=!1)).subscribe({next:s=>this.user.photo=s.photo,error:s=>{var i;return this.alerts.error((null===(i=s.error)||void 0===i?void 0:i.error)||s.message)}})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(d.gz),e.Y36(c.m),e.Y36(g.i))},t.\u0275cmp=e.Xpm({type:t,selectors:[["dw-photo-info"]],inputs:{user:"user"},decls:6,vars:4,consts:function(){let r,o;return r="Photo",o=" Upload Photo " + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + "",[["flex","auto",3,"ffUploadTypes","ffUpload"],[1,"outer"],r,[1,"container"],["placeholder","500x500","alt","Photo",3,"src"],["flex","0 0 auto",4,"ngIf"],["flex","0 0 auto"],[1,"primary","sm",3,"spin","ffUploadTypes","ffUpload"],o,[3,"icon"]]},template:function(o,n){1&o&&(e.TgZ(0,"ff-panel",0),e.NdJ("ffUpload",function(i){return n.upload(i)}),e.TgZ(1,"ff-header",1),e.SDv(2,2),e.qZA(),e.TgZ(3,"div",3),e._UZ(4,"ff-img",4),e.YNc(5,Z,4,4,"ff-btn-group",5),e.qZA(),e.qZA()),2&o&&(e.Q6J("ffUploadTypes",e.DdM(3,T)),e.xp6(4),e.Q6J("src",null==n.user?null:n.user.photo),e.xp6(1),e.Q6J("ngIf",!n.user.schema.photo.$readOnly))},directives:[h.y,E.O,M,U.G,y.g,P.O5,D.P,A.H,C.BN],styles:["[_nghost-%COMP%]{display:flex;align-items:stretch}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}ff-img[_ngcontent-%COMP%]{width:250px;height:250px;max-width:100%;max-height:100%}ff-btn-group[_ngcontent-%COMP%]{margin-top:auto;padding-top:.5rem}"]}),t})();const v=function(){return{md:"0 0 50%"}};function x(t,r){if(1&t&&e._UZ(0,"dw-photo-info",6),2&t){const o=e.oxw();e.Q6J("flex",e.DdM(2,v))("user",o.user)}}let l=class{constructor(r,o,n,s){this.route=r,this.auth=o,this.alerts=n,this.userService=s,this.loading=!1}ngOnInit(){(0,O.a)([this.route.queryParams,this.auth.user$]).subscribe(([r,o])=>{const n=+r.center,s=isNaN(+r.user)?(null==o?void 0:o.id)||0:+r.user;this.loading=!0,this.userService.get(n,s).pipe((0,u.x)(()=>this.loading=!1)).pipe((0,p.t)(this)).subscribe({next:i=>this.user=i,error:i=>{var f;return this.alerts.error((null===(f=i.error)||void 0===f?void 0:f.error)||i.message)}})})}};l.\u0275fac=function(r){return new(r||l)(e.Y36(d.gz),e.Y36(R.e),e.Y36(c.m),e.Y36(g.i))},l.\u0275cmp=e.Xpm({type:l,selectors:[["dw-user-profile"]],decls:21,vars:3,consts:function(){let t;return t="User Profile",[[1,"page-title"],t,[1,"ff-grid","ff-gv","ff-gh"],[3,"flex"],[1,"outer"],[3,"flex","user",4,"ngIf"],[3,"flex","user"]]},template:function(r,o){1&r&&(e.TgZ(0,"h1",0),e.SDv(1,1),e.qZA(),e.TgZ(2,"div",2),e.TgZ(3,"ff-panel",3),e.TgZ(4,"ff-header",4),e._uU(5,"Blah"),e.qZA(),e.TgZ(6,"ff-static"),e._uU(7,"1"),e.qZA(),e.TgZ(8,"ff-static"),e._uU(9,"2"),e.qZA(),e.TgZ(10,"ff-static"),e._uU(11,"3"),e.qZA(),e.TgZ(12,"ff-static"),e._uU(13,"4"),e.qZA(),e.TgZ(14,"ff-static"),e._uU(15,"5"),e.qZA(),e.TgZ(16,"ff-static"),e._uU(17,"6"),e.qZA(),e.TgZ(18,"ff-static"),e._uU(19,"7"),e.qZA(),e.qZA(),e.YNc(20,x,1,3,"dw-photo-info",5),e.qZA()),2&r&&(e.xp6(3),e.Q6J("flex",e.DdM(2,v)),e.xp6(17),e.Q6J("ngIf",null==o.user||null==o.user.schema?null:o.user.schema.photo))},directives:[h.y,E.O,U.G,F.W,P.O5,N],styles:[""]}),l=(0,S.gn)([(0,p.c)()],l);const $=[{path:"",component:l}];let H=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.Bz.forChild($)],d.Bz]}),t})(),B=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[m.m,H]]}),t})()}}]);