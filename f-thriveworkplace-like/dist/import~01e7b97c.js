(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"+vx3":function(e,t,r){"use strict";r.r(t);var n=r("ipr/"),o=r.n(n),i=r("xeXu"),s=r.n(i),a=r("a8hB"),l=r.n(a),c=r("WSeP"),u=r.n(c),d=r("nbuU"),p=r.n(d),f=r("YtL8"),m=r.n(f);t.default=angular.module("deskworks.importDetectSubgroups",["deskworks.helper"]).factory("importDetectSubgroups",["helper",function(e){return function(t,r,n){var i,a=m()(n).call(n,(function(e,t){var r=p()(e).call(e,(function(e){return e.id===(t.subgroup||"nosubgroup")}));return r||(r={id:t.subgroup,fields:[]},e.push(r)),r.fields.push(t),e}),[{id:"nosubgroup",fields:[]}]);u()(i=r.data).call(i,(function(t,i){var c=r.rowsMeta[i];if(!c.empty&&!c.headRow&&(u()(a).call(a,(function(n){var o;n.nonEmptyCount=m()(o=n.fields).call(o,(function(n,o){var i;return l()(e).call(e,t[s()(i=r.mapping).call(i,o.id)])?++n:n}),0)})),!a[0].nonEmptyCount&&a.length>1)){var d,p=m()(d=o()(a).call(a,1,a.length)).call(d,(function(e,t){return!e||t.nonEmptyCount>e.nonEmptyCount?t:e}));c.subgroup=p.id;var f=e.findIndexByKeyValue(n,"subgroupKey",!0);f>=0&&!t[f]&&angular.isUndefined(c.ignore)&&(c.ignore=!0)}}))}}])},"/Qjn":function(e,t){e.exports="<div id=setupImport> <h1 class=page-title>{{state.getPageTitle()}}</h1> <import-step-init ng-if=\"$ctrl.steps[$ls.step].id === 'init'\" step=$ls.step sheets=$ls.sheets purge=$ctrl.purge></import-step-init> <import-step-import ng-if=\"$ctrl.steps[$ls.step].id !== 'init' && $ctrl.steps[$ls.step].id !== 'complete'\" step=$ls.step sheets=$ls.sheets purge=$ctrl.purge></import-step-import> <import-step-complete ng-if=\"$ctrl.steps[$ls.step].id === 'complete'\" step=$ls.step sheets=$ls.sheets purge=$ctrl.purge></import-step-complete> </div> "},15:function(e,t){},16:function(e,t){},17:function(e,t){},"2dNM":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");var n=r("xeXu"),o=r.n(n),i=r("hsT8"),s=r.n(i),a=r("5xSF"),l=r.n(a);t.default=angular.module("deskworks.importStepImport",["deskworks.dwAlerts","deskworks.handsontable","deskworks.importHandsontable","deskworks.importSheetDetector","deskworks.importSteps","deskworks.importInitMetaData","deskworks.importDetectSubgroups","deskworks.importWireData","deskworks.importValidateData","deskworks.importCollectStats"]).component("importStepImport",{templateUrl:"step-components/step-import.tpl.html",controller:"ImportStepImportCtrl",bindings:{step:"=",sheets:"<",purge:"<"}}).controller("ImportStepImportCtrl",["$scope","$q","$timeout","dwAlerts","state","helper","importSheetDetector","importSteps","importInitMetaData","importDetectSubgroups","importWireData","importValidateData","importCollectStats",function(e,t,r,n,i,a,c,u,d,p,f,m,h){var g=this;g.steps=u,e.$watch("$ctrl.step",(function(){if(g.step){var e=g.steps[g.step];g.fields=e.fields,g.sheet=null,t.when(e.hooks&&e.hooks.init&&e.hooks.init(g)).then((function(){g.sheet=c.detect(g.sheets,g.step)}))}})),g.back=function(){g.step--},g.validateData=function(){var t;d(g.sheet),s()(t=g.fields).call(t,(function(e){var t;return o()(t=g.sheet.mapping).call(t,e.id)<0})).length||(p(g,g.sheet,g.fields),f(g,g.sheet,g.fields,g.steps[g.step].hooks.wireRow),g.invalidCount=m(g.sheet,g.fields,e),g.stats=h(g.sheet.rowsMeta)),e.$broadcast("ht:render")},g.import=function(){if(g.unMappedFields.length)return n.error("Some columns unmapped. Please check red UNKNOWN markers and map them to appropriate fields.");if(g.invalidCount)return n.error(g.invalidCount+" invalid values found. Please fix them manually to proceed to the next step.");var e=g.steps[g.step],o=0,i=new l.a((function(){for(;o<g.sheet.data.length&&(g.sheet.rowsMeta[o].ignore||g.sheet.rowsMeta[o].subgroup||g.sheet.rowsMeta[o].headRow||g.sheet.rowsMeta[o].empty);)o++;if(o>=g.sheet.data.length)return null;var t=g.sheet.rowsMeta[o];return t.spin=!0,e.hooks.importRow(g,g.sheet.data[o++],t,g.sheet.mapping,g.fields).then((function(e){t.id=e.id||t.id,t.error=null})).catch((function(e){t.error=e.data&&e.data.error||e.status+" "+e.statusText})).finally((function(){g.stats=h(g.sheet.rowsMeta),t.spin=!1,t.ignore=!0}))}),5,{promise:t});return g.spin=!0,t.when(e.hooks&&e.hooks.preImport&&e.hooks.preImport(g,g.sheet,g.fields)).then((function(){return i.start()})).then((function(){return g.validateData(),r((function(){g.spin=!1,g.step++}),1e3)}))}}])},"4D44":function(e,t,r){"use strict";r.r(t);var n=r("YtL8"),o=r.n(n),i=r("0zKI"),s=r.n(i),a=r("6RpP"),l=r.n(a),c=r("nbuU"),u=r.n(c),d=r("xeXu"),p=r.n(d),f=r("hsT8"),m=r.n(f),h=r("ipr/"),g=r.n(h),v=r("WSeP"),w=r.n(v),y=r("yCd9"),b=r.n(y);r("Yew0");t.default=angular.module("deskworks.importHandsontable",["deskworks.helper","deskworks.dwAlerts","deskworks.importStripDataComments","deskworks.importDetectHeadRowIdx","deskworks.importAutoMapColumns"]).directive("importHandsontable",(function(){return{restrict:"E",scope:!0,templateUrl:"handsontable/import-handsontable.tpl.html",controller:"ImportHandsontableCtrl as $ctrl",bindToController:{step:"<",sheet:"<",fields:"<",onValidate:"&",unMappedFields:"="}}})).controller("ImportHandsontableCtrl",["$scope","$window","$timeout","dwAlerts","helper","importStripDataComments","importDetectHeadRowIdx","importAutoMapColumns",function(e,t,r,n,i,a,c,d){var f=this;function h(e){return b()(e).call(e,(function(e){var t;return{cellsMeta:b()(t=Array.apply(null,Array(e.length))).call(t,(function(){return{}}))}}))}e.$watch("$ctrl.sheet",(function(){var t,n,o;f.sheet&&(f.sheet.mappedToStep||(a(f.sheet.data),f.sheet.headRowIdx=c(f.sheet.data,f.fields),f.sheet.mapping=d(f.sheet.data,f.fields,f.sheet.headRowIdx),f.sheet.headRowIdx>=0?(f.sheet.mappedToStep=f.step,f.sheet.rowsMeta=h(f.sheet.data),(t=f.sheet).headRowIdx<0||(w()(n=g()(o=t.rowsMeta).call(o,0,t.headRowIdx)).call(n,(function(e){e.ignore=!0})),t.rowsMeta[t.headRowIdx].headRow=!0)):f.sheet.rowsMeta=f.sheet.rowsMeta||h(f.sheet.data)),r((function(){e.$broadcast("ht:render")})))})),e.$watch("$ctrl.sheet.mapping",(function(e){var t;e&&(f.unMappedFields=m()(t=f.fields).call(t,(function(t){return p()(e).call(e,t.id)<0})),f.availableFields=b()(e).call(e,(function(t){var r;return m()(r=f.fields).call(r,(function(r){return r.id===t||p()(e).call(e,r.id)<0}))})),f.mappingFields=b()(e).call(e,(function(e){var t;return u()(t=f.fields).call(t,(function(t){return t.id===e}))})),f.onValidate())}),!0),e.$on("ht:afterCreateRow",(function(e,t,r){var n,o,i,s;e.stopPropagation(),f.sheet.headRowIdx>=t&&(f.sheet.headRowIdx+=r);var a=g()(n=f.sheet.rowsMeta).call(n,0,t),c=b()(o=Array.apply(null,Array(r))).call(o,(function(){var e;return{cellsMeta:b()(e=Array.apply(null,Array(f.sheet.data[0].length))).call(e,(function(){return{}}))}})),u=g()(i=f.sheet.rowsMeta).call(i,t);f.sheet.rowsMeta=l()(s=l()(a).call(a,c)).call(s,u),f.onValidate()})),e.$on("ht:afterRemoveRow",(function(e,t,r){var n;e.stopPropagation(),f.sheet.headRowIdx>=t+r?f.sheet.headRowIdx-=r:f.sheet.headRowIdx>=t&&(f.sheet.headRowIdx=-1),s()(n=f.sheet.rowsMeta).call(n,t,r),f.onValidate()})),e.$on("ht:afterChange",(function(e){e.stopPropagation(),f.onValidate()})),f.cellRenderer=function(e,t,r,n,o,i,s){if(t.innerHTML=i,t=angular.element(t),f.sheet.rowsMeta&&f.sheet.rowsMeta[r]&&f.sheet.rowsMeta[r].cellsMeta&&f.sheet.rowsMeta[r].cellsMeta[n])return f.sheet.rowsMeta[r].cellsMeta[n].invalid&&(t.addClass("ht-invalid"),t[0].innerHTML+='<span class="fa fa-exclamation-triangle"></span>'),f.sheet.rowsMeta[r].headRow&&t.addClass("ht-head-row"),f.sheet.rowsMeta[r].ignore&&t.addClass("ht-ignore"),t.attr("rc",r+"x"+n),t[0]},f.onClickRowIcon=function(e){var t=f.sheet.rowsMeta[e];t.headRow||(t.ignore=!t.ignore,f.onValidate())},f.onSelectValidData=function(t,r,n){var i;if(o()(i=f.sheet.data).call(i,(function(e,t,o){return f.sheet.rowsMeta[o].invalid&&(t[n]||"")===(f.sheet.data[r][n]||"")?++e:e}),0)>1){var s,a='"'+u()(s=f.fields).call(s,(function(e){return e.id===f.sheet.mapping[n]})).name+'" column contains more "'+(f.sheet.data[r][n]||"empty")+'" occurrences. Fix them all to "'+t+'" automatically?';if(confirm(a))for(var l=0;l<f.sheet.data.length;l++)l!==r&&f.sheet.rowsMeta[l].invalid&&(f.sheet.data[l][n]||"")===(f.sheet.data[r][n]||"")&&(f.sheet.data[l][n]=t)}f.sheet.data[r][n]=t,e.$broadcast("ht:commitValue",t),f.onValidate()}}])},"52bj":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("w13K");var n=r("0zKI"),o=r.n(n),i=r("03wM"),s=r.n(i),a=r("WSeP"),l=r.n(a);t.default=angular.module("deskworks.SetupImportCtrl",["ngStorage","deskworks.state","deskworks.importSteps","deskworks.importStepInit","deskworks.importStepImport","deskworks.importStepComplete","deskworks.purge.service"]).controller("SetupImportCtrl",["$scope","$localStorage","dwAlerts","state","importSteps","purgeService",function(e,t,r,n,i,a){var c,u=this;t.import=t.import||{};var d=t.import;l()(c=s()(d)).call(c,(function(e){var t=e.match(/^v(\d+)$/i);(!t||t&&1!=+t[1])&&delete d[e]}));var p=d.v1=d.v1||{},f=e.$ls=p[n.getCurrentCenterId()]=p[n.getCurrentCenterId()]||{};f.step=f.step||0,f.sheets=f.sheets||[],u.steps=i,e.$watch("$ls.step",(function(){n.setPageTitle("Import "+u.steps[f.step].name)})),u.purge=function(){if(window.confirm("It will purge all data. Are you sure?"))return a.purgeMembers().catch((function(e){return r.error(e,"Failed to purge members.")})).then((function(){return a.purgeProducts().catch((function(e){return r.error(e,"Failed to purge products.")}))})).then((function(){return a.purgePriceLists(n.getCurrentCenterId()).catch((function(e){return r.error(e,"Failed to purge price lists.")}))})).then((function(){return a.purgeMembershipTypes().catch((function(e){return r.error(e,"Failed to purge membership categories.")}))})).then((function(){return a.purgeReservationCategories().catch((function(e){return r.error(e,"Failed to purge reservation categories.")}))})).then((function(){var e;l()(e=s()(p)).call(e,(function(e){var t;p[e].step=0,o()(t=p[e].sheets).call(t,0,p[e].sheets.length)}))}))}}])},"6Efl":function(e,t,r){"use strict";r.r(t);var n=r("Ehlk"),o=r.n(n);r("Pkjd");t.default=angular.module("deskworks.handsontable",["deskworks.handsontable.htHeaderExtra","deskworks.handsontable.htRowExtra","deskworks.handsontable.htBodyExtra"]).directive("handsontable",(function(){return window.Handsontable=o.a,{restrict:"E",scope:!0,controller:"HandsontableCtrl as ht",bindToController:{data:"<htData",renderer:"<htRenderer",manualColumnWidths:"<htManualColumnWidths"},compile:function(){return function(e,t,r,n){if(!window.Handsontable)return console.error("Handsontable component is not found.");e.$watch("ht.data",(function(r){angular.isArray(r)&&angular.isArray(r[0])&&(n.settings.data=r,n.instance?n.instance.updateSettings(n.settings):n.instance=new o.a(t[0],n.settings),e.$broadcast("ht:dataChange",n.settings.data))})),e.$on("$destroy",(function(){n.instance&&(n.instance.destroy(),delete n.instance)}))}}}})).controller("HandsontableCtrl",["$scope","$element","$attrs","$timeout",function(e,t,r,n){var o=arguments,i=this,s=document.getElementById("htImport"),a=s.addEventListener;s.addEventListener=function(e){if("wheel"!==e)return a.apply(s,o)},i.settings={data:i.data,rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,autoWrapRow:!0,autoWrapCol:!0,autoInsertRow:!1,autoRowSize:!0,autoColumnSize:!0,allowInsertColumn:!1,enterBeginsEditing:!1,cells:function(){return{renderer:i.renderer}},contextMenu:["row_above","row_below","remove_row"],afterSelectionEnd:function(t,r){e.$apply((function(){e.$emit("ht:afterSelection",t,r)}))},afterDeselect:function(){e.$apply((function(){e.$emit("ht:afterDeselect")}))},afterChange:function(){e.$root.$$phase||e.$apply((function(){e.$emit("ht:afterChange")}))},afterRender:function(){if(e.$root.$$phase)return n((function(){e.$emit("ht:afterRender")}));e.$apply((function(){e.$emit("ht:afterRender")}))},afterCreateRow:function(t,r){e.$apply((function(){e.$emit("ht:afterCreateRow",t,r)}))},afterRemoveRow:function(t,r){e.$apply((function(){e.$emit("ht:afterRemoveRow",t,r)}))},init:function(){this.getPlugin("manualColumnResize").manualColumnWidths=i.manualColumnWidths||[]},afterUpdateSettings:function(){this.getPlugin("manualColumnResize").manualColumnWidths=i.manualColumnWidths||[],this.getPlugin("autoRowSize").recalculateAllRowsHeight()},afterGetColHeader:function(e,t){e>=0&&t.setAttribute("htcol",e)},afterGetRowHeader:function(e,t){e>=0&&t.setAttribute("htrow",e)}},e.$on("ht:commitValue",(function(e,t){var r=i.instance.getActiveEditor();r&&r._opened&&(r.setValue(t),r.focus(),r.close())})),e.$on("ht:render",(function(){i.instance&&i.instance.render()}))}])},"6yKF":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("w13K");var n=r("xeXu"),o=r.n(n),i=r("0zKI"),s=r.n(i),a=r("a8hB"),l=r.n(a),c=r("WSeP"),u=r.n(c),d=r("yCd9"),p=r.n(d),f=r("ipr/"),m=r.n(f);t.default=angular.module("deskworks.importDetectHeadRowIdx",[]).factory("importDetectHeadRowIdx",["helper",function(e){return function(t,r){var n;if(angular.isArray(r)&&angular.isArray(t)){var i=m()(r).call(r),a=p()(n=m()(t).call(t,0,5)).call(n,(function(t){var r=0;return u()(t).call(t,(function(t){for(var n=0;n<i.length;n++)if(l()(e).call(e,t).match(i[n].pattern)){s()(i).call(i,n,1),r++;break}})),r})),c=o()(a).call(a,Math.max.apply(Math,a));return a[c]>=r.length/1.5?c:-1}}}])},"7A+6":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsMembershipProducts",[]).factory("importFieldsMembershipProducts",(function(){return[{id:"name",name:"Product Name",pattern:/Product\s+Name/i,required:!0,unique:!0},{id:"membershipCategory",name:"Membership Category",pattern:/Membership\s+Category/i,required:!0},{id:"isCreditable",name:"Has Reservation Credit?",pattern:/Has\s+Reservation\s+Credit/i,type:"bool"},{id:"hasPasses",name:"Has Passes?",pattern:/Has\s+Passes/i,type:"bool"},{id:"passProduct",name:"Product to use for pass",pattern:/Product.+for.+pass/i,type:{options:"$ctrl.productsRental"}},{id:"showInSelfRegistration",name:"Show for Self-Registration",pattern:/Show.+Self.*Regis/i,type:"bool"},{id:"productCategoryCode",name:"Product Category Code",pattern:/Product\s+Category\s+Code/i,required:!0},{id:"productCategoryName",name:"Product Category Name",pattern:/Product\s+Category\s+Name/i},{id:"productNumber",name:"Part Number Code",pattern:/Part\s+Number\s+Code/i,required:!0,type:"uint"},{id:"price",name:"Price",pattern:/^Price/i,required:!0,type:"currency"},{id:"reservationCredit",name:"Reservation Credit",pattern:/^Reservation\s+Credit/i,type:"currency"},{id:"passQty",name:"Passes",pattern:/^Passes/i,type:"uint"},{id:"description",name:"Description",pattern:/Description/i}]}))},"9AYr":function(e,t){e.exports='<handsontable id=htImport class=ht-import ht-data=$ctrl.sheet.data ht-rows-meta=$ctrl.sheet.rowsMeta ht-renderer=$ctrl.cellRenderer ht-manual-column-widths=$ctrl.sheet.manualColumnWidths> <ht-header-extra ht-fields=$ctrl.fields ht-available-fields=$ctrl.availableFields ht-mapping=$ctrl.sheet.mapping></ht-header-extra> <ht-row-extra> <div class=ht-row-extra ng-init="rowMeta = $ctrl.sheet.rowsMeta[$row]" ng-show=!$ctrl.unMappedFields.length> <ff-icon sense=error ng-if="rowMeta.error && rowMeta.ignore" ng-click=$ctrl.onClickRowIcon($row) title={{rowMeta.error}}> </ff-icon> <ff-icon sense=warning ng-if="rowMeta.invalid && !rowMeta.ignore" ng-click=$ctrl.onClickRowIcon($row) title="This row contains invalid values. Fix them or click this icon to ignore this row."></ff-icon> <ff-icon sense=check ng-if="rowMeta.id && !rowMeta.invalid && rowMeta.ignore && !rowMeta.error" ng-click=$ctrl.onClickRowIcon($row) title="Existing data, this row will not be imported."></ff-icon> <ff-icon sense=refresh ng-if="rowMeta.id && !rowMeta.invalid && !rowMeta.ignore" ng-click=$ctrl.onClickRowIcon($row) ng-class="{ rotate: rowMeta.spin }" title="Existing data, this row will be updated."></ff-icon> <ff-icon sense=plus ng-if="!rowMeta.id && !rowMeta.ignore && !rowMeta.headRow && !rowMeta.empty && !rowMeta.invalid" ng-click=$ctrl.onClickRowIcon($row) ng-class="{ rotate: rowMeta.spin }" title="This row is new and will be imported."></ff-icon> <ff-icon sense=ignore ng-if="!rowMeta.id && rowMeta.ignore && !rowMeta.error" ng-click=$ctrl.onClickRowIcon($row) title="This row is ignored. Click this icon to stop ignoring this row."></ff-icon> <ff-icon sense=header ng-if=rowMeta.headRow ng-click=$ctrl.onClickRowIcon($row) title="This row is recognized as header."></ff-icon> </div> </ht-row-extra> <ht-body-extra> <div class="itooltip ht-body-tooltip" ng-show=$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid> <span ng-if="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isString" ng-bind-html=$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid></span> <ff-select ff-model=newVal ff-options="opt.name as opt.name for opt in $ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid" ff-change="$ctrl.onSelectValidData(newVal, $row, $col)" ng-if="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isArray"> <option value="">please select</option> </ff-select> </div> </ht-body-extra> </handsontable> '},BGsA:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsMembers",["deskworks.userProfile.optsCountry","deskworks.userProfile.optsState","deskworks.userProfile.optsMembershipStatus","deskworks.userProfile.optsBillingMethod","deskworks.billing.optsRenewalTerm","deskworks.billing.optsRenewalNoticePeriod"]).factory("importFieldsMembers",["optsCountry","optsState","optsMembershipStatus","optsBillingMethod","optsRenewalTerm","optsRenewalNoticePeriod",function(e,t,r,n,o,i){return[{id:"firstName",name:"First Name",pattern:/First\s+Name/i,required:!0},{id:"lastName",name:"Last Name",pattern:/Last\s+Name/i,required:!0,type:{pattern:/^[^\\<>\/&]*$/,msg:"Last Name should not contain special characters"}},{id:"email",name:"Email",pattern:/Email/i,required:!0,unique:!0,type:"email"},{id:"company",name:"Company",pattern:/Company/i},{id:"login",name:"Login",pattern:/Login/i,required:!0,unique:!0,minLength:3,type:{pattern:/^\w[\w\.\-_@]+$/,msg:"Login should have only letters, numbers, and .-_@"}},{id:"password",name:"Password",pattern:/Password/i,required:!0,minLength:6},{id:"addressStreet",name:"Street",pattern:/Street/i,required:!0},{id:"addressCity",name:"City",pattern:/City/i,required:!0},{id:"addressCountry",name:"Country",pattern:/Country/i,required:!0,type:{options:e}},{id:"addressState",name:"State/Province",pattern:/State\s*\/\s*Province/i,required:!0,type:{options:"$ctrl.optsState.$id",ref:"addressCountry"}},{id:"addressZip",name:"Zip/Postal",pattern:/Zip\s*\/\s*Post/i,required:!0},{id:"phoneNumber",name:"Phone Number",pattern:/Number/i,required:!0,type:{pattern:/^((\+\d{1,3}[-. ]?\(?\d\)?[-. ]?\d{1,5})|(\(?\d{2,6}\)?))[-. ]?(\d{3,4})[-. ]?(\d{4})$/,msg:"Phone number examples: 888-379-2865, +1-888-379-2865, 888 379 2865, 888.379.2865"}},{id:"mailboxNumber",name:"Mailbox #",pattern:/Mailbox #/i},{id:"printerCode",name:"Printer Code",pattern:/Printer\s+Code/i},{id:"accessCode",name:"Access Code",pattern:/Access\s+Code/i},{id:"leadSource",name:"Lead Source",pattern:/Lead\s+Source/i,required:!0,type:{options:"$ctrl.leadSources"}},{id:"comments",name:"Comments",pattern:/Comments/i},{id:"billingMethod",name:"Billing Method",pattern:/Bill\s+By/i,required:!0,type:{options:n}},{id:"recurringProduct",name:"Recurring Billing",pattern:/Recurring\s+Billing/i,type:{options:"$ctrl.products"},subgroup:"recurring",subgroupKey:!0},{id:"recurringQuantity",name:"Qty",pattern:/Qty/i,type:"uint",subgroup:"recurring"},{id:"recurringDiscount",name:"Discount",pattern:/^Discount/i,type:"currency",subgroup:"recurring"},{id:"recurringMonthsOfDiscount",name:"Months of Discount",pattern:/Months\s+of\s+Discount/i,type:"uint",subgroup:"recurring"},{id:"recurringAttachedReservationUnit",name:"Attached Reservation Unit",pattern:/Make\s+Matching\s+Reservation\s+Unit\s+Unavailable/i,unique:!0,type:{options:"$ctrl.reservationUnits"},subgroup:"recurring"},{id:"recurringNextBillDate",name:"Next Bill Date",pattern:/Next\s+Bill\s+Date/i,type:"date",subgroup:"recurring"}]}])},BaSU:function(e,t,r){"use strict";r.r(t);var n=r("xeXu"),o=r.n(n),i=r("hsT8"),s=r.n(i),a=r("6RpP"),l=r.n(a),c=r("yCd9"),u=r.n(c),d=r("4BZO"),p=r.n(d);r("Ehlk");t.default=angular.module("deskworks.handsontable.htHeaderExtra",[]).directive("htHeaderExtra",["$timeout",function(e){return{scope:!0,restrict:"E",require:["htHeaderExtra","^handsontable"],controller:function(){},bindToController:{fields:"<htFields",availableFields:"<htAvailableFields",mapping:"<htMapping"},compile:function(t,r){return t.remove(),function(t,r,n,i){var a=p()(i,2),c=a[0],d=a[1],f=r.parent();d.settings.colHeaders=function(e){var t,r,n,i,a=u()(t=l()(r=[{name:"UNKNOWN"}]).call(r,c.availableFields[e])).call(t,(function(t){var r,n;return l()(r=l()(n='<option value="'.concat(t.id||"",'" ')).call(n,c.mapping[e]===t.id?"selected":"",">")).call(r,t.name,"</option>")})),d=s()(n=c.fields).call(n,(function(e){var t;return o()(t=c.mapping).call(t,e.id)<0})).length,p=!c.mapping[e]&&d?"ng-invalid":"";return l()(i='<select class="ht-mapping-select form-control ff-select ff-control '.concat(p,'">')).call(i,a,"</select>")},e((function(){var e=f[0].querySelector(".ht_clone_top .htCore");e.addEventListener("mousedown",(function(e){var t;"SELECT"!==e.target.nodeName||o()(t=e.target.className).call(t,"ht-mapping-select")<0||e.stopPropagation()})),e.addEventListener("mouseup",(function(e){var t;"SELECT"!==e.target.nodeName||o()(t=e.target.className).call(t,"ht-mapping-select")<0||e.stopPropagation()})),e.addEventListener("change",(function(e){var r;"SELECT"!==e.target.nodeName||o()(r=e.target.className).call(r,"ht-mapping-select")<0||(e.stopPropagation(),t.$apply((function(){var t=e.target,r=+t.parentNode.parentNode.parentNode.getAttribute("htcol");c.mapping[r]=t.value})))}))}))}}}}])},Bn1Q:function(e,t,r){"use strict";r.r(t);r("iPZ8"),r("kypl");var n=r("xeXu"),o=r.n(n),i=r("a8hB"),s=r.n(i),a=r("WSeP"),l=r.n(a),c=r("nbuU"),u=r.n(c),d=r("hsT8"),p=r.n(d),f=r("jd5N");t.default=angular.module("deskworks.importHooksMembershipProducts",[f.a.name,"deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.inventory.membershipCategory.service","deskworks.ProductCategory"]).factory("importHooksMembershipProducts",["$q","dwAlerts","helper","state","importParsers","keese","ProductCategory","productService","priceListService","membershipCategoryService",function(e,t,r,n,i,a,c,d,f,m){return{init:function(r){return e.all([d.getProducts().catch((function(e){return t.error(e,"Failed to get products.")})).then((function(e){r.products=p()(e).call(e,(function(e){return"membership"===e.type})),r.productsRental=p()(e).call(e,(function(e){return"rental"===e.type}))})),function(e){var r={name:"Monthly Plans",visibleForVisitors:!0,useFor:"members"};return f.getPricelists(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to get price lists.")})).then((function(e){return u()(e).call(e,(function(e){return e.name===r.name}))||f.save(n.getCurrentCenterId(),r).catch((function(e){return t.error(e,'Failed to create "'+r.name+'" price list.')})).then((function(){return r}))})).then((function(e){return f.getPricelist(n.getCurrentCenterId(),e.id).catch((function(r){return t.error(r,"Failed to get price list "+e.name+".")}))})).then((function(t){e.monthlyPriceList=t}))}(r),m.query().catch((function(e){return t.error(e,"Failed to get membership categories.")})).then((function(e){r.membershipCategories=angular.copy(e)})),c.query().catch((function(e){return t.error(e,"Failed to query product categories.")})).then((function(e){r.productCategories=angular.copy(e)}))])},preImport:function(n,d,p){var f,h=[];return l()(f=d.data).call(f,(function(e,l){var p,f,g=d.rowsMeta[l];if(!(g.ignore||g.headRow||g.empty)){var v,w=s()(r).call(r,e[o()(p=d.mapping).call(p,"membershipCategory")]),y=i.options(w,n.membershipCategories);if(!y)y={name:w,order:a.generate(n.membershipCategories.length&&n.membershipCategories[n.membershipCategories.length-1].order),note:s()(r).call(r,e[o()(v=d.mapping).call(v,"description")])},n.membershipCategories.push(y),h.push(m.save(y).catch((function(e){return t.error(e,"Failed to create membership category.")})));w=s()(r).call(r,e[o()(f=d.mapping).call(f,"productCategoryCode")]);var b,k=u()(r).call(r,n.productCategories,{code:w});if(!k)k={code:w,name:s()(r).call(r,e[o()(b=d.mapping).call(b,"productCategoryName")])},n.productCategories.push(k),h.push(c.save(k).catch((function(e){return t.error(e,"Failed to create product category.")})))}})),e.all(h)},importRow:function(e,t,n,a,l){var c=d.new();return c.id=n.id||void 0,c.name=s()(r).call(r,t[o()(a).call(a,"name")]),c.membershipType=i.options(t[o()(a).call(a,"membershipCategory")],e.membershipCategories),c.isCreditable=i.bool(t[o()(a).call(a,"isCreditable")]),c.hasPasses=i.bool(t[o()(a).call(a,"hasPasses")]),c.passProduct=i.options(t[o()(a).call(a,"passProduct")],e.productsRental),c.showInSelfRegistration=i.bool(t[o()(a).call(a,"showInSelfRegistration")]),c.productCategoryId=u()(r).call(r,e.productCategories,{code:s()(r).call(r,t[o()(a).call(a,"productCategoryCode")])}).id,c.productNumber=i.uint(t[o()(a).call(a,"productNumber")]),c.description=s()(r).call(r,t[o()(a).call(a,"description")]),d.save(c).then((function(t){!n.id&&t.id&&e.products.push(c)})).then((function(){var r,n={id:(u()(r=e.monthlyPriceList.products).call(r,(function(e){return e.productId===c.id}))||{}).id,priceListId:e.monthlyPriceList.id,price:i.currency(t[o()(a).call(a,"price")]),reservationCredit:c.isCreditable?i.currency(t[o()(a).call(a,"reservationCredit")]):void 0,passQty:c.hasPasses?i.uint(t[o()(a).call(a,"passQty")]):void 0};return d.savePriceItem(c.id,n).then((function(){var t;u()(t=e.monthlyPriceList.products).call(t,(function(e){return e.productId===c.id}))||e.monthlyPriceList.products.push(n)}))})).then((function(){return c}))},wireRow:function(e,t,r){var n;if(r.id=(u()(n=e.products).call(n,(function(e){return e.name===t.name}))||{}).id||null,r.id){var o;(u()(o=e.monthlyPriceList.products).call(o,(function(e){return e.productId===r.id}))||{}).price!=i.currency(t.price)&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},DEya:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("w13K");var n=r("a8hB"),o=r.n(n);t.default=angular.module("deskworks.importSheetDetector",["deskworks.importSteps"]).service("importSheetDetector",["helper","importSteps",function(e,t){this.detect=function(r,n){if(angular.isArray(r)&&t[n].sheetPattern)for(var i=0;i<r.length;i++)if(o()(e).call(e,r[i].name).match(t[n].sheetPattern))return r[i];return(r||[])[0]}}])},Ec5X:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");t.default=angular.module("deskworks.handsontable.htBodyExtra",[]).directive("htBodyExtra",["$compile",function(e){return{restrict:"E",require:"^handsontable",compile:function(t,r){var n=t.html();return t.remove(),function(t,r,o,i){var s=r.parent()[0];i.bodyExtraElement||(i.bodyExtraElement=e(n.replace(/\$row/g,"ht.erow").replace(/\$col/g,"ht.ecol"))(t).addClass("ht-body-extra")),t.$on("ht:afterRender",(function(e){e.stopPropagation();var t=angular.element(s.querySelector(".ht_master .wtSpreader"));t[0].querySelector(".ht-body-extra")||t.append(i.bodyExtraElement),i.repositionBodyExtra()})),i.repositionBodyExtra=function(){if(i.erow>=0&&i.ecol>=0){var e=s.querySelector('td[rc="'+i.erow+"x"+i.ecol+'"]');e&&(i.bodyExtraElement.css("top",e.offsetTop+"px"),i.bodyExtraElement.css("left",Math.floor(e.offsetLeft+e.offsetWidth/2)+"px"))}},t.$on("ht:afterSelection",(function(e,t,r){e.stopPropagation(),i.erow=t,i.ecol=r,i.repositionBodyExtra()})),t.$on("ht:afterDeselect",(function(e,t,r){e.stopPropagation(),i.erow=-1,i.ecol=-1}))}}}}])},Jrqs:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("w13K");var n=r("0zKI"),o=r.n(n),i=r("a8hB"),s=r.n(i),a=r("ipr/"),l=r.n(a),c=r("yCd9"),u=r.n(c);t.default=angular.module("deskworks.importAutoMapColumns",[]).factory("importAutoMapColumns",["helper",function(e){return function(t,r,n){var i,a;if(angular.isArray(r)&&angular.isArray(t)){if(n<0)return u()(i=Array.apply(null,Array(t[0].length))).call(i,(function(){return null}));var c=l()(r).call(r);return u()(a=t[n]).call(a,(function(t){for(var r=0;r<c.length;r++)if(s()(e).call(e,t).match(c[r].pattern))return o()(c).call(c,r,1)[0].id}))}}}])},KvHs:function(e,t,r){"use strict";r.r(t);var n=r("YtL8"),o=r.n(n),i=r("WSeP"),s=r.n(i);t.default=angular.module("deskworks.importWireData",["deskworks.helper","deskworks.importSteps"]).factory("importWireData",["helper",function(e){return function(e,t,r,n){var i;s()(i=t.data).call(i,(function(r,i){var s,a=t.rowsMeta[i];if(!a.empty&&!a.headRow){var l=o()(s=t.mapping).call(s,(function(e,t,n){return e[t]=r[n],e}),{});a.id=n(e,l,a,t.rowsMeta),a.id&&angular.isUndefined(a.ignore)&&(a.ignore=!0)}}))}}])},Pkjd:function(e,t,r){},R2MD:function(e,t){e.exports="<div> <p>Congratulations! You have completed the import. You can manage imported data through sidebar:</p> <p><a href=#/reservation-types ng-click=$ctrl.navSidebar($event)>Inventory <ff-icon sense=breadcrumb></ff-icon> Reservation Categories</a></p> <p><a href=#/reservation-units ng-click=$ctrl.navSidebar($event)>Inventory <ff-icon sense=breadcrumb></ff-icon> Reservation Units</a></p> <p><a href=#/products ng-click=$ctrl.navSidebar($event)>Inventory <ff-icon sense=breadcrumb></ff-icon> Products</a></p> <p><a href=#/user-search ng-click=$ctrl.navSidebar($event)>Members <ff-icon sense=breadcrumb></ff-icon> View/Edit Profile</a></p> </div> <ff-btn-group class=buttons-bottom> <ff-btn sense=back ff-click=$ctrl.back()>Back To Step {{$ctrl.step}}</ff-btn> <ff-btn sense=home ff-click=$ctrl.home()>Go To Dashboard</ff-btn> <ff-btn sense=remove ff-click=$ctrl.purge()>Purge & Start From Scratch</ff-btn> </ff-btn-group> "},RAZO:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");var n=r("WSeP"),o=r.n(n),i=r("lRNC"),s=r.n(i),a=r("yCd9"),l=r.n(a),c=["$injector",function(e){var t,n,i=(t=r("rQ7g"),l()(n=s()(t).call(t)).call(n,t));e.loadNewModules(l()(i).call(i,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var t,n=r("gnFY");o()(t=s()(n).call(n)).call(t,(function(t){return e.put(t.replace(/^\.\//,""),n(t))}))}])}];t.default=c},SXLm:function(e,t){e.exports='<div class="ff-grid gutter-h gutter-v"> <div style1="margin-bottom: .25rem" ng-if="$ctrl.steps[$ls.step].id !== \'complete\'"> <span class=em>Step {{$ls.step + 1}} of {{$ctrl.steps.length - 2}}</span> &nbsp; This step allows you to import <b ng-bind=$ctrl.steps[$ctrl.step].name></b>. Please select correct Excel sheet, check & fix columns mapping, fix invalid values, then import. </div> <div flex="{lg: \'0 0 400px\'}" class=ff-grid ng-include="\'step-components/import-sheet-selector.tpl.html\'"></div> <div flex="{lg: \'1 1 360px\'}" class=ff-grid ng-include="\'step-components/import-dashboard.tpl.html\'"></div> <ff-btn-group> <ff-btn sense=next ff-click=$ctrl.import()>Next</ff-btn> <ff-btn sense=back ff-click=$ctrl.back()>Back To Step {{$ctrl.step}}</ff-btn> <ff-btn sense=remove ff-click=$ctrl.purge()>Purge & Start From Scratch</ff-btn> </ff-btn-group> <ff-panel class=ht-panel ng-if=$ctrl.sheet ff-dim=$ctrl.spin> <import-handsontable step=$ctrl.step sheet=$ctrl.sheet fields=$ctrl.fields on-validate=$ctrl.validateData() un-mapped-fields=$ctrl.unMappedFields></import-handsontable> </ff-panel> </div> '},"V1x+":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");var n=r("WSeP"),o=r.n(n),i=r("yCd9"),s=r.n(i);t.default=angular.module("deskworks.handsontable.htRowExtra",[]).directive("htRowExtra",["$compile",function(e){return{restrict:"E",require:"^handsontable",compile:function(t,r){var n=t.html();return t.remove(),function(t,r,i,a){var l=r.parent()[0];function c(e,t){var r=l.querySelector(".ht_clone_left .wtSpreader");a.rowExtraScopes&&(angular.element(r.querySelectorAll(".ht-row-extra")).remove(),o()(angular).call(angular,a.rowExtraScopes,(function(e){e.$destroy()})),delete a.rowExtraScopes)}t.$on("ht:afterRender",(function(r){var i,c=angular.element(l.querySelector(".ht_clone_left .wtSpreader"));a.rowExtraScopes||angular.isArray(a.settings.data)&&angular.isArray(a.settings.data[0])&&(a.rowExtraScopes=s()(i=a.settings.data).call(i,(function(r,o){var i=t.$new();return c.append(e(n.replace(/\$row/g,o))(i).addClass("ht-row-extra")),i})));o()(angular).call(angular,c[0].querySelectorAll(".ht-row-extra"),(function(e){e.style.display="none"})),o()(angular).call(angular,l.querySelectorAll(".ht_clone_left th[htrow]"),(function(e){var t=c[0].querySelectorAll(".ht-row-extra")[e.getAttribute("htrow")];t.style.left=e.offsetLeft+"px",t.style.top=e.offsetTop+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.display=""}))})),t.$on("ht:afterCreateRow",c),t.$on("ht:afterRemoveRow",c),t.$on("ht:dataChange",c)}}}}])},VixM:function(e,t,r){"use strict";r.r(t);var n=r("hsT8"),o=r.n(n);t.default=angular.module("deskworks.importFieldsOtherProducts",["deskworks.inventory.optsProductType"]).factory("importFieldsOtherProducts",["optsProductType",function(e){return[{id:"name",name:"Product Name",pattern:/Product\s+Name/i,required:!0,unique:!0},{id:"type",name:"Product Type",pattern:/Product\s+Type/i,required:!0,type:{options:o()(e).call(e,(function(e){return"membership"!==e.id}))}},{id:"allowReservationCredits",name:"Can use Reservation Credits",pattern:/Can\s+use\s+Reservation\s+Credit/i,type:"bool"},{id:"passSize",name:"Pass Size",pattern:/Pass\s+Size/i,type:"uint"},{id:"reservationCategory",name:"Reservation Category",pattern:/Reservation\s+Category/i,type:{options:"$ctrl.reservationCategories"}},{id:"productCategoryCode",name:"Product Category Code",pattern:/Product\s+Category\s+Code/i,required:!0},{id:"productCategoryName",name:"Product Category Name",pattern:/Product\s+Category\s+Name/i},{id:"productNumber",name:"Part Number Code",pattern:/Part\s+Number\s+Code/i,required:!0,type:"uint"},{id:"monthlyPrice",name:"Monthly Members Price List",pattern:/Monthly\s+Members\s+Price\s?list/i,type:"currency"},{id:"walkinPrice",name:"Walkin Price List",pattern:/Walkin\s+Price\s?list/i,type:"currency"},{id:"description",name:"Product Description",pattern:/^Product\s+Description/i}]}])},WfNc:function(e,t,r){"use strict";r.r(t);var n=r("nbuU"),o=r.n(n),i=r("xeXu"),s=r.n(i),a=r("a8hB"),l=r.n(a),c=r("2/1H");t.default=angular.module("deskworks.importHooksReservationUnits",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.reservationRules.service","deskworks.reservationCategory.service","deskworks.inventory.product.service","deskworks.reservationRules.optsWhoCanReserve",c.a.name]).factory("importHooksReservationUnits",["$q","dwAlerts","helper","state","importParsers","ReservationRules","reservationCategoryService","ReservationUnit","productService","optsWhoCanReserve",function(e,t,r,n,i,a,c,u,d,p){return{init:function(r){return e.all([c.query(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load reservation categories.")})).then((function(e){r.reservationCategories=e})),u.query(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load reservation units.")})).then((function(e){r.reservationUnits=e})),d.getMembershipProducts(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load membership products.")})).then((function(e){r.productsMembership=e}))])},importRow:function(e,t,c,d,f){var m={id:c.id||void 0,name:l()(r).call(r,t[s()(d).call(d,"name")]),reservationTypeId:(i.options(t[s()(d).call(d,"reservationCategory")],e.reservationCategories)||{}).id,fullTimeProductId:(i.options(t[s()(d).call(d,"fullTimeProduct")],e.productsMembership)||{}).id};return u.save(n.getCurrentCenterId(),m).then((function(t){return!c.id&&t.id&&e.reservationUnits.push({id:t.id,name:m.name}),t})).then((function(e){return a.query({centerId:n.getCurrentCenterId(),reservationUnitId:m.id}).then((function(e){var r=o()(e).call(e,(function(e){return"whoCanReserve"===e.uid}));return r.value=(i.options(t[s()(d).call(d,"whoCanReserve")],p)||{}).id,a.save({centerId:n.getCurrentCenterId(),reservationUnitId:m.id},r)})).then((function(){return e}))}))},wireRow:function(e,t){var r;return(o()(r=e.reservationUnits).call(r,(function(e){return e.name===t.name}))||{}).id||null}}}])},Wid6:function(e,t,r){"use strict";r.r(t);var n=r.p+"./assets/new-center-startup-workbook.xlsx?_rev=8c5caafdc20958c74eedc8dc5b3f74d7";t.default=angular.module("deskworks.importStepInit",["ngFileUpload","deskworks.dwAlerts","deskworks.excel"]).component("importStepInit",{templateUrl:"step-components/step-init.tpl.html",controller:"ImportStepInitCtrl",bindings:{step:"=",sheets:"=",purge:"<"}}).controller("ImportStepInitCtrl",["dwAlerts","excel",function(e,t){var r=this;r.$onInit=function(){r.xlsTemplateUrl=n},r.upload=function(n,o){return o&&o.length>0?e.error("Please use .xls or .xlsx files."):window.FileReader?void(n&&n.length&&t.read(n[0]).then((function(e){r.sheets=e,r.step++}))):e.error("FileReader is not supported by your web browser.")}}])},Y5xL:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importSteps",["deskworks.importFieldsReservationCategories","deskworks.importHooksReservationCategories","deskworks.importFieldsReservationUnits","deskworks.importHooksReservationUnits","deskworks.importFieldsOtherProducts","deskworks.importHooksOtherProducts","deskworks.importFieldsMembershipProducts","deskworks.importHooksMembershipProducts","deskworks.importFieldsMembers","deskworks.importHooksMembers"]).factory("importSteps",["importFieldsReservationCategories","importHooksReservationCategories","importFieldsReservationUnits","importHooksReservationUnits","importFieldsOtherProducts","importHooksOtherProducts","importFieldsMembershipProducts","importHooksMembershipProducts","importFieldsMembers","importHooksMembers",function(e,t,r,n,o,i,s,a,l,c){return[{id:"init",name:"Wizard"},{id:"reservationCategories",name:"Reservation Categories",sheetPattern:/Reservation\s+Categories/i,fields:e,hooks:t},{id:"otherProducts",name:"Other Products",sheetPattern:/Products.+Prices$/i,fields:o,hooks:i},{id:"membershipProducts",name:"Membership Products",sheetPattern:/Membership.+Products.+Prices/i,fields:s,hooks:a},{id:"reservationUnits",name:"Reservation Units",sheetPattern:/Reservation\s+Units/i,fields:r,hooks:n},{id:"members",name:"Members",sheetPattern:/Members.+Recurring.+Billing/i,fields:l,hooks:c},{id:"complete",name:"Complete"}]}])},Y6HC:function(e,t,r){"use strict";r.r(t);var n=r("nbuU"),o=r.n(n),i=r("xeXu"),s=r.n(i),a=r("a8hB"),l=r.n(a);t.default=angular.module("deskworks.importHooksReservationCategories",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.reservationCategory.service"]).factory("importHooksReservationCategories",["dwAlerts","helper","state","reservationCategoryService",function(e,t,r,n){return{init:function(t){return n.query(r.getCurrentCenterId()).catch((function(t){return e.error(t,"Failed to load reservation categories.")})).then((function(e){t.reservationCategories=e}))},importRow:function(e,o,i,a){var c={id:i.id||void 0,name:l()(t).call(t,o[s()(a).call(a,"name")]),description:l()(t).call(t,o[s()(a).call(a,"description")])};return n.save(r.getCurrentCenterId(),c).then((function(t){return!i.id&&t.id&&e.reservationCategories.push({id:t.id,name:c.name}),t}))},wireRow:function(e,t){var r;return(o()(r=e.reservationCategories).call(r,(function(e){return e.name===t.name}))||{}).id||null}}}])},Yew0:function(e,t,r){},anLb:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsReservationUnits",["deskworks.reservationRules.optsWhoCanReserve"]).factory("importFieldsReservationUnits",["optsWhoCanReserve",function(e){return[{id:"name",name:"Reservation Unit",pattern:/^Reservation\s+Unit$/i,required:!0,unique:!0},{id:"reservationCategory",name:"Reservation Category",pattern:/^Reservation\s+Category$/i,required:!0,type:{options:"$ctrl.reservationCategories"}},{id:"whoCanReserve",name:"Who can reserve?",pattern:/^Who\s+can\s+reserve/i,required:!0,type:{options:e}},{id:"fullTimeProduct",name:"Full-time Product",pattern:/^Full-time\s+Product/i,type:{options:"$ctrl.productsMembership"}}]}])},atK1:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("w13K"),r("y89P");var n=r("hsT8"),o=r.n(n),i=r("YtL8"),s=r.n(i),a=r("xeXu"),l=r.n(a),c=r("a8hB"),u=r.n(c),d=r("nbuU"),p=r.n(d);t.default=angular.module("deskworks.importValidateCell",["deskworks.helper"]).factory("importValidateCell",["helper",function(e){return function(t,r,n,i,a,c,d){var f=p()(a).call(a,(function(e){return e.id===c[n]}));if(f){var m,h=u()(e).call(e,t[r][n]);if(angular.isObject(f.type)&&f.type.options&&(f.required||""!==h)){var g;if(f.type.ref){var v=t[r][l()(c).call(c,f.type.ref)],w=p()(a).call(a,(function(e){return e.id===f.type.ref}));v=e.searchSoft(w.type.options,["id","name","import"],v),g=d.$eval(f.type.options.replace(/\$id/g,(v||{}).id))}else g=angular.isArray(f.type.options)?f.type.options:d.$eval(f.type.options);if(angular.isArray(g)&&!e.searchSoft(g,["name","id","import"],h))return g}if(f.required){if(""===h)return f.name+" is required."}else if(""===h)return;if("uint"===f.type&&!h.match(/^\d*,?\d+$/i))return f.name+" should be a positive integer number, e.g. 100 or 0";if("int"===f.type&&!h.match(/^-?\d*,?\d+$/i))return f.name+" should be an integer number, e.g. -10 or 50";if("ufloat"===f.type&&!h.match(/^[\d,]*\.?\d+$/i))return f.name+" should be a positive number, e.g. 10 or 10.50";if("float"===f.type&&!h.match(/^-?[\d,]*\.?\d+$/i))return f.name+" should be a number, e.g. 100 or -20 or 5.5";if("bool"===f.type&&!h.match(/^Yes|No|Y|N|true|false$/i))return f.name+" should be Yes/No, Y/N, true/false";if("currency"===f.type&&!h.match(/^\$?[\d,]*\.?\d+$/i))return f.name+" should be currency, e.g. $10 or $10.50 or 12.00";if("email"===f.type&&!h.match(/^[\w\.%\+\-]+@(?:[A-Z0-9\-]+\.)+(?:[A-Z]+)$/i))return f.name+" should be valid";if("date"===f.type){var y;if(h.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(h=h.replace(/\s|-|\.|\//g," "),y="DD MMM YYYY"):h.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(h=h.replace(/\s|-|\./g,"/"),y="MM/DD/YYYY"):h.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)&&(h=h.replace(/\s|-|\./g,"-"),y="YYYY-MM-DD"),y&&moment(h,y).isValid())return;return f.name+" format is 06/22/2015 or 22&nbsp;Jun&nbsp;2015"}if(f.minLength&&h.length<f.minLength)return f.name+" min length is "+f.minLength;if(f.unique)if(s()(m=o()(t).call(t,(function(e,t){return!i[t].empty&&!i[t].ignore&&!i[t].headRow}))).call(m,(function(t,r){return u()(e).call(e,r[n]||"").toLowerCase()===(h||"").toLowerCase()?++t:t}),0)>1)return f.name+" contains duplicate values. Must be unique.";return angular.isObject(f.type)&&f.type.pattern&&!h.match(f.type.pattern)?f.type.msg:void 0}}}])},biy8:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.purge.service",["ngResource","deskworks.config"]).factory("purgeService",["$resource","deskworksConfig",function(e,t){var r=e(t.getApiAbsUrl("/purge/:entity")),n=e(t.getApiAbsUrl("/purge/centers/:centerId/:entity"));return{purgeProducts:function(e){return r.delete({entity:"products",productTypes:e}).$promise},purgePriceLists:function(e){return n.delete({centerId:e,entity:"price-lists"}).$promise},purgeMembershipTypes:function(){return r.delete({entity:"membership-types"}).$promise},purgeReservationCategories:function(){return r.delete({entity:"reservation-types"}).$promise},purgeReservationUnits:function(e){return n.delete({centerId:e,entity:"reservation-units"}).$promise},purgeMembers:function(){return r.delete({entity:"members"}).$promise}}}])},f4JS:function(e,t,r){"use strict";r.r(t);r("iPZ8"),r("kypl");var n=r("xeXu"),o=r.n(n),i=r("a8hB"),s=r.n(i),a=r("WSeP"),l=r.n(a),c=r("nbuU"),u=r.n(c),d=r("yCd9"),p=r.n(d),f=r("hsT8"),m=r.n(f);t.default=angular.module("deskworks.importHooksOtherProducts",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.reservationCategory.service","deskworks.ProductCategory"]).factory("importHooksOtherProducts",["$q","dwAlerts","helper","state","importParsers","ProductCategory","productService","priceListService","reservationCategoryService",function(e,t,r,n,i,a,c,d,f){return{init:function(r){return e.all([c.getProducts().catch((function(e){return t.error(e,"Failed to get products.")})).then((function(e){r.products=m()(e).call(e,(function(e){return"membership"!==e.type}))})),function(r){var o=[{name:"Monthly Plans",visibleForVisitors:!0,useFor:"members"},{name:"Walkin",visibleForVisitors:!0,useFor:"nonMembers"}];return d.getPricelists(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to get price lists.")})).then((function(r){return e.all(p()(o).call(o,(function(e){return u()(r).call(r,(function(t){return t.name===e.name}))||d.save(n.getCurrentCenterId(),e).catch((function(r){return t.error(r,'Failed to create "'+e.name+'" price list.')})).then((function(){return e}))})))})).then((function(r){return e.all(p()(r).call(r,(function(e,r){return d.getPricelist(n.getCurrentCenterId(),e.id).catch((function(r){return t.error(r,"Failed to get price list "+e.name+".")}))})))})).then((function(e){r.monthlyPriceList=e[0],r.walkinPriceList=e[1]}))}(r),f.query(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load reservation categories.")})).then((function(e){r.reservationCategories=e})),a.query().catch((function(e){return t.error(e,"Failed to query product categories.")})).then((function(e){r.productCategories=angular.copy(e)}))])},preImport:function(n,i,c){var d,p=[];return l()(d=i.data).call(d,(function(e,l){var c,d=i.rowsMeta[l];if(!(d.ignore||d.headRow||d.empty)){var f,m=s()(r).call(r,e[o()(c=i.mapping).call(c,"productCategoryCode")]),h=u()(r).call(r,n.productCategories,{code:m});if(!h)h={code:m,name:s()(r).call(r,e[o()(f=i.mapping).call(f,"productCategoryName")])},n.productCategories.push(h),p.push(a.save(h).catch((function(e){return t.error(e,"Failed to create product category.")})))}})),e.all(p)},importRow:function(t,n,a,l,d){var f=c.new();return f.id=a.id||void 0,f.name=s()(r).call(r,n[o()(l).call(l,"name")]),f.type=i.options(n[o()(l).call(l,"type")],u()(d).call(d,(function(e){return"type"===e.id})).type.options),f.allowReservationCredits=i.bool(n[o()(l).call(l,"allowReservationCredits")]),f.passSize=i.uint(n[o()(l).call(l,"passSize")]),f.productCategoryId=u()(r).call(r,t.productCategories,{code:s()(r).call(r,n[o()(l).call(l,"productCategoryCode")])}).id,f.productNumber=i.uint(n[o()(l).call(l,"productNumber")]),f.description=s()(r).call(r,n[o()(l).call(l,"description")]),f.reservationTypeId=(i.options(n[o()(l).call(l,"reservationCategory")],t.reservationCategories)||{}).id,c.save(f).then((function(e){return!a.id&&e.id&&t.products.push(f),e})).then((function(){var r,s,a,d,h={id:(u()(r=t.monthlyPriceList.products).call(r,(function(e){return e.productId===f.id}))||{}).id,priceList:t.monthlyPriceList,priceListId:t.monthlyPriceList.id,price:i.currency(n[o()(l).call(l,"monthlyPrice")])},g={id:(u()(s=t.walkinPriceList.products).call(s,(function(e){return e.productId===f.id}))||{}).id,priceList:t.walkinPriceList,priceListId:t.walkinPriceList.id,price:i.currency(n[o()(l).call(l,"walkinPrice")])};return e.all(p()(a=m()(d=[h,g]).call(d,(function(e){return e.price||0==e.price}))).call(a,(function(e){var t=e.priceList;return delete e.priceList,c.savePriceItem(f.id,e).then((function(){var r;u()(r=t.products).call(r,(function(e){return e.productId===f.id}))||t.products.push(e)}))}))).then((function(){return f}))}))},wireRow:function(e,t,r){var n;if(r.id=(u()(n=e.products).call(n,(function(e){return e.name===t.name}))||{}).id||null,r.id){var o,s;(u()(o=e.monthlyPriceList.products).call(o,(function(e){return e.productId===r.id}))||{}).price!=i.currency(t.monthlyPrice)&&angular.isUndefined(r.ignore)&&(r.ignore=!1),(u()(s=e.monthlyPriceList.products).call(s,(function(e){return e.productId===r.id}))||{}).price!=i.currency(t.walkinPrice)&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},gSLu:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsReservationCategories",[]).factory("importFieldsReservationCategories",(function(){return[{id:"name",name:"Reservation Category",pattern:/^Reservation\s+Category/i,required:!0,unique:!0},{id:"description",name:"Description",pattern:/^Description/i}]}))},ghTx:function(e,t,r){"use strict";r.r(t);var n=r("WSeP"),o=r.n(n);t.default=angular.module("deskworks.importCollectStats",[]).factory("importCollectStats",(function(){return function(e){var t={create:0,update:0,existing:0,ignore:0,invalid:0,error:0};return o()(angular).call(angular,e,(function(e){!e.ignore||e.headRow||e.id||t.ignore++,e.id||e.ignore||e.headRow||e.empty||e.invalid||t.create++,!e.id||e.ignore||e.invalid||t.update++,e.id&&e.ignore&&t.existing++,e.invalid&&t.invalid++,e.error&&e.ignore&&t.error++})),t}}))},gnFY:function(e,t,r){var n={"./handsontable/import-handsontable.tpl.html":"9AYr","./step-components/import-dashboard.tpl.html":"iAI1","./step-components/import-sheet-selector.tpl.html":"r6Yw","./step-components/step-complete.tpl.html":"R2MD","./step-components/step-import.tpl.html":"SXLm","./step-components/step-init.tpl.html":"ojsW","./wizard/import.tpl.html":"/Qjn"};function o(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id="gnFY"},iAI1:function(e,t){e.exports='<ff-panel ng-if="$ctrl.sheet && $ctrl.sheet.mappedToStep === $ctrl.step"> <div class="ff-grid gutter-v-half gutter-h-half import-dashboard"> <div flex="0 0 320px" class=import-stats ng-if=!$ctrl.unMappedFields.length> <div class=text-brand> <span class=counter>{{$ctrl.stats.create}}</span> <ff-icon sense=plus></ff-icon> <span class=text>Create</span> </div> <div class=text-brand> <span class=counter>{{$ctrl.stats.update}}</span> <ff-icon sense=refresh></ff-icon> <span class=text>Update</span> </div> <div class=text-text> <span class=counter>{{$ctrl.stats.existing}}</span> <ff-icon sense=check></ff-icon> <span class=text>Existing</span> </div> <div class=text-text> <span class=counter>{{$ctrl.stats.ignore}}</span> <ff-icon sense=ignore></ff-icon> <span class=text>Ignore</span> </div> <div class=text-danger ng-if=!$ctrl.stats.invalid> <span class=counter>{{$ctrl.stats.error}}</span> <ff-icon sense=error></ff-icon> <span class=text>Error</span> </div> <div class=text-danger ng-if=$ctrl.stats.invalid> <span class=counter>{{$ctrl.stats.invalid}}</span> <ff-icon sense=warning></ff-icon> <span class=text>Invalid</span> </div> </div> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && $ctrl.unMappedFields.length" class=text-danger> Some columns are unmapped. Please map them manually. Check <b><u>UNKNOWN</u></b> markers and select correct field mapping from the drop-down. </span> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && $ctrl.invalidCount" class=text-danger> Invalid values detected. Please fix them manually to proceed to the next step. Look for cells with <ff-icon sense=warning></ff-icon> icon and fix their values. You can also ignore some rows by clicking <ff-icon sense=warning></ff-icon> icons near the row indexes at left. </span> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && !$ctrl.invalidCount"> Click Next to proceed to the next step. </span> </div> </ff-panel> '},jd5N:function(e,t,r){"use strict";var n=r("JRMi"),o=r.n(n),i=r("gQJ2"),s=r.n(i);t.a=angular.module("keese",[]).factory("keese",(function(){var e="0123456789?@ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t=e.length,r=function(){for(var t={},r=0;r<e.length;r++)t[e[r]]=r;return t}();return{generate:function(e,t,r){return r?i(e,t,r):n(e,t)}};function n(e,t){return e?t?a(e,t):((r=c(e)).digits=r.digits.substr(0,r.order_length+1),l(r,c("1"))):t?a("0",t):"1";var r}function i(e,t,r){var o=new Array(r);if(r>0)if(t)!function e(t,r,i,s){var a=Math.floor((i+s)/2),l=n(t,r);o[a]=l,i<a&&e(t,l,i,a);a+1<s&&e(l,r,a+1,s)}(e,t,0,r);else for(var i=0;i<r;i++){var s=keese(e,null);o[i]=s,e=s}return o}function a(n,o){if(n>o)throw new Error("assertion failed: "+s()(n)+" < "+s()(o));var i=c(n),a=c(o);d(i,a);for(var p=0,f=Math.max(i.digits.length,a.digits.length),m=0;m<f||p>0;m++){var h=r[i.digits[m]]||0,g=p+(r[a.digits[m]]||0);if(h!==g){if(h!==g-1){for(var v=Math.floor((g-h)/2),w="",y=0;y<m;y++)w+="0";w+=e[v];var b=c(u(i.order_length,w));return i.digits=i.digits.substr(0,m+1),l(i,b)}p=t}}throw new Error}function l(n,o){d(n,o);for(var i="",s=n.order_length,a=0,l=Math.max(n.digits.length,o.digits.length)-1;l>=0;l--)a+=r[n.digits[l]]||0,a+=r[o.digits[l]]||0,i=e[a%t]+i,a=Math.floor(a/t);for(;a>0;)i=e[a%t]+i,a=Math.floor(a/t),s++;return u(s,i)}function c(e){var t=o()(e).call(e,"~")+1;return{order_length:t,digits:e.substr(t)}}function u(e,t){for(;e>0&&"0"==t.charAt(0);)t=t.substr(1),e--;for(var r="",n=0;n<e;n++)r+="~";return r+t}function d(e,t){p(e,t.order_length),p(t,e.order_length)}function p(e,t){for(;e.order_length<t;)e.digits="0"+e.digits,e.order_length++}}))},ojsW:function(e,t){e.exports="<div class=gutter-v> <ff-panel> <div class=em><ff-icon sense=info></ff-icon>&nbsp;&nbsp;This wizard will guide you through the following import steps:</div> <ff-label> <span>Reservation Categories</span><ff-icon sense=breadcrumb></ff-icon> <span>Other Products</span><ff-icon sense=breadcrumb></ff-icon> <span>Membership Products</span><ff-icon sense=breadcrumb></ff-icon> <span>Reservation Units</span><ff-icon sense=breadcrumb></ff-icon> <span>Members</span> </ff-label> <div class=em><ff-icon sense=info></ff-icon>&nbsp;&nbsp;The workflow for each step is:</div> <ff-label> <span>Select sheet in Excel file</span><ff-icon sense=breadcrumb></ff-icon> <span>Map fields</span><ff-icon sense=breadcrumb></ff-icon> <span>Fix invalid data</span><ff-icon sense=breadcrumb></ff-icon> <span>Import</span><ff-icon sense=breadcrumb></ff-icon> <span>Move to next step</span> </ff-label> <p><ff-icon sense=info></ff-icon>&nbsp;&nbsp;Please download import template, open it in Excel (Numbers on Mac), replace sample data with your real data, then start import by selecting the file you've made.</p> <p><ff-icon sense=warning></ff-icon>&nbsp;&nbsp;Don't add/remove columns in the template, but you may add/remove rows.</p> </ff-panel> <ff-btn-group> <ff-btn sense=upload ngf-select=\"$ctrl.upload($files, $invalidFiles)\" ngf-pattern=\"'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel'\" accept=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel> Select Excel File to Import </ff-btn> <a ng-href={{$ctrl.xlsTemplateUrl}} target=_blank rel=noopener download> <ff-btn sense=download>Download Import Template</ff-btn> </a> </ff-btn-group> </div> "},pfW1:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");t.default=angular.module("deskworks.importStepComplete",["deskworks.state"]).component("importStepComplete",{templateUrl:"step-components/step-complete.tpl.html",controller:"ImportStepCompleteCtrl",bindings:{step:"=",purge:"<"}}).controller("ImportStepCompleteCtrl",["state",function(e){var t=this;t.navSidebar=function(t){return t.preventDefault(),t.stopPropagation(),e.setPath(t.target.hash.replace("#",""))},t.home=function(){return e.setPath("/dashboard")},t.back=function(){t.step--}}])},qJvt:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),o=r.n(n),i=r("WSeP"),s=r.n(i),a=r("Isj4"),l=r.n(a);t.default=angular.module("deskworks.excel",[]).service("excel",["$q","helper",function(e,t){this.read=function(r){return e((function(e){var n=new FileReader;n.onload=function(r){var n=[],i=l.a.read(r.target.result,{type:"binary"}),a=document.createElement("textarea");s()(angular).call(angular,i.SheetNames,(function(e){for(var r=i.Sheets[e],s=function(e){for(var t=l.a.utils.decode_range(e["!ref"]||"A1:Z1000"),r=0,n=0,o=t.e.r;o>=t.s.r;o--){for(var i=-1,s=t.e.c;s>=t.s.c;s--){var a=e[l.a.utils.encode_cell({r:o,c:s})];if(a&&angular.isDefined(a.v)&&null!==a.v&&""!==a.v&&i<0){i=s;break}}r=r>i?r:i,i>=0&&!n&&(n=o)}return{s:{r:t.s.r,c:t.s.c},e:{r:n,c:r}}}(r),c=[],u=s.s.r;u<=s.e.r;u++){for(var d=[],p=s.s.c;p<=s.e.c;p++){var f=r[l.a.utils.encode_cell({r:u,c:p})];d.push(o()(t).call(t,(f||{}).w||""))}a.innerHTML=e,c.push(d)}n.push({name:a.value,data:c})})),e(n)},n.readAsBinaryString(r)}))}}])},r6Yw:function(e,t){e.exports='<ff-panel ff-dim="$ctrl.spin || !$ctrl.sheet"> <div class="ff-grid gutter-v-half"> <label class="ff-row ff-no-frame"> <ff-label flex="0 0 120px" ff-required=true>Select Sheet</ff-label> <ff-select ff-model=$ctrl.sheet ff-options="sheet.name for sheet in $ctrl.sheets" ff-required=true ff-valdate-alert=Sheet></ff-select> </label> <div ng-if="$ctrl.sheet && !$ctrl.sheet.mappedToStep" class=text-danger> <ff-icon sense=info></ff-icon> This sheet seems to misfit to current import step. Please select another sheet or map all columns manually. </div> <div ng-if="$ctrl.sheet && $ctrl.sheet.mappedToStep && $ctrl.sheet.mappedToStep !== $ctrl.step" class=text-danger> <ff-icon sense=info></ff-icon> This sheet is already mapped to "{{$ctrl.steps[$ctrl.sheet.mappedToStep].name}}" step, please select another sheet or <ff-btn sense=remove size=sm ff-click=$ctrl.remapFields()>Remap Fields</ff-btn> </div> </div> </ff-panel> '},rQ7g:function(e,t,r){var n={"./handsontable/handsontable.directive.js":"6Efl","./handsontable/ht-body-extra.directive.js":"Ec5X","./handsontable/ht-header-extra.directive.js":"BaSU","./handsontable/ht-row-extra.directive.js":"V1x+","./handsontable/import-handsontable.directive.js":"4D44","./services/auto-map-columns.service.js":"Jrqs","./services/collect-stats.service.js":"ghTx","./services/detect-head-row-idx.service.js":"6yKF","./services/detect-subgroups.service.js":"+vx3","./services/excel.service.js":"qJvt","./services/init-meta-data.service.js":"rwVl","./services/parsers.service.js":"z+6Y","./services/purge.service.js":"biy8","./services/sheet-detector.service.js":"DEya","./services/srip-data-comments.service.js":"zTxK","./services/validate-cell.service.js":"atK1","./services/validate-data.service.js":"sCVh","./services/wire-data.service.js":"KvHs","./step-components/step-complete.component.js":"pfW1","./step-components/step-import.component.js":"2dNM","./step-components/step-init.component.js":"Wid6","./step-fields/fields-members.service.js":"BGsA","./step-fields/fields-membership-products.service.js":"7A+6","./step-fields/fields-other-products.service.js":"VixM","./step-fields/fields-reservation-categories.service.js":"gSLu","./step-fields/fields-reservation-units.service.js":"anLb","./step-hooks/hooks-members.service.js":"z32g","./step-hooks/hooks-membership-products.service.js":"Bn1Q","./step-hooks/hooks-other-products.service.js":"f4JS","./step-hooks/hooks-reservation-categories.service.js":"Y6HC","./step-hooks/hooks-reservation-units.service.js":"WfNc","./wizard/import.controller.js":"52bj","./wizard/steps.service.js":"Y5xL"};function o(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id="rQ7g"},rwVl:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),o=r.n(n),i=r("WSeP"),s=r.n(i);t.default=angular.module("deskworks.importInitMetaData",["deskworks.helper"]).factory("importInitMetaData",["helper",function(e){return function(t){var r;s()(r=t.rowsMeta).call(r,(function(r,n){var i;r.invalid=!1,r.empty=!0,r.id=null,r.subgroup=null,s()(i=r.cellsMeta).call(i,(function(i,s){i.invalid=!1,r.empty=r.empty&&!o()(e).call(e,t.data[n][s])}))}))}}])},sCVh:function(e,t,r){"use strict";r.r(t);var n=r("xeXu"),o=r.n(n),i=r("YtL8"),s=r.n(i),a=r("hsT8"),l=r.n(a),c=r("WSeP"),u=r.n(c);t.default=angular.module("deskworks.importValidateData",["deskworks.helper","deskworks.importValidateCell"]).factory("importValidateData",["helper","importValidateCell",function(e,t){return function(e,r,n){var i,a=0;return u()(i=e.data).call(i,(function(i,c){var u=e.rowsMeta[c],d=r;u.subgroup&&(d=l()(r).call(r,(function(e){return e.subgroup===u.subgroup}))),u.invalid=s()(d).call(d,(function(i,s){var l,d=o()(l=e.mapping).call(l,s.id),p=u.cellsMeta[d];return u.empty||u.headRow||u.ignore?(p.invalid=!1,i):(p.invalid=t(e.data,c,d,e.rowsMeta,r,e.mapping,n),p.invalid&&a++,i||p.invalid)}),!1)})),a}}])},"z+6Y":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("w13K"),r("y89P");var n=r("mxFF"),o=r.n(n),i=r("T/jV"),s=r.n(i),a=r("a8hB"),l=r.n(a);t.default=angular.module("deskworks.importParsers",["deskworks.helper"]).service("importParsers",["helper",function(e){this.options=function(t,r){return e.searchSoft(r,["name","id","import"],t)},this.bool=function(t){return!!l()(e).call(e,t).match(/^Yes|Y|true$/i)},this.int=function(t){return(t=l()(e).call(e,t).replace(/,/g,"")).length?s()(t):void 0},this.uint=this.int,this.float=function(t){return(t=l()(e).call(e,t).replace(/,/g,"")).length?o()(t):void 0},this.currency=function(t){return(t=l()(e).call(e,t).replace(/[,\$]/g,"")).length?o()(t):void 0},this.ufloat=this.float,this.date=function(t){var r;if((t=l()(e).call(e,t)).match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(t=t.replace(/\s|-|\.|\//g," "),r="DD MMM YYYY"):t.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(t=t.replace(/\s|-|\./g,"/"),r="MM/DD/YYYY"):t.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)&&(t=t.replace(/\s|-|\./g,"-"),r="YYYY-MM-DD"),r){var n=moment(t,r);if(n.isValid())return n}}}])},z32g:function(e,t,r){"use strict";r.r(t);var n=r("WSeP"),o=r.n(n),i=r("yCd9"),s=r.n(i),a=r("a8hB"),l=r.n(a),c=r("xeXu"),u=r.n(c),d=r("nbuU"),p=r.n(d),f=r("hsT8"),m=r.n(f),h=r("2/1H");t.default=angular.module("deskworks.importHooksMembers",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.inventory.membershipCategory.service","deskworks.system.service","deskworks.userProfile.service","deskworks.recurringCharge.service","deskworks.userProfile.optsMembershipStatus","deskworks.userProfile.optsState","deskworks.billing.optsDiscountType",h.a.name]).factory("importHooksMembers",["$q","$filter","dwAlerts","helper","state","importParsers","productService","priceListService","membershipCategoryService","systemService","userProfileService","recurringChargeService","ReservationUnit","optsMembershipStatus","optsState","optsDiscountType",function(e,t,r,n,i,a,c,d,f,h,g,v,w,y,b,k){return{init:function(t){return e.all([c.getProducts().catch((function(e){return r.error(e,"Failed to query products.")})).then((function(e){t.products=m()(e).call(e,(function(e){return"membership"===e.type||"services"===e.type}))})),h.getLeadSources().catch((function(e){return r.error(e,"Failed to query lead sources.")})).then((function(e){t.leadSources=e})),g.query(0,{activeMembers:!0,inactiveMembers:!0,activeCoMembers:!0,inactiveCoMembers:!0,nonMembers:!0}).catch((function(e){return r.error(e,"Failed to query all users.")})).then((function(e){t.users=e})),g.query(i.getCurrentCenterId(),{activeMembers:!0}).catch((function(e){return r.error(e,"Failed to query members.")})).then((function(e){t.members=e})),d.getPricelists(i.getCurrentCenterId()).catch((function(e){return r.error(e,"Failed to query price lists.")})).then((function(e){return t.monthlyPriceList=p()(e).call(e,(function(e){return"Monthly Plans"===e.name})),d.getPricelist(i.getCurrentCenterId(),t.monthlyPriceList.id).then((function(e){t.monthlyPriceList=e}))})),w.query(i.getCurrentCenterId()).catch((function(e){return r.error(e,"Failed to query reservation units")})).then((function(e){t.reservationUnits=e}))])},importRow:function(r,c,d,f,m){var w,C=p()(m).call(m,(function(e){return"billingMethod"===e.id})).type.options,$=p()(m).call(m,(function(e){return"addressCountry"===e.id})).type.options,P=u()(f).call(f,"recurringProduct"),M={id:d.id||void 0,firstName:l()(n).call(n,c[u()(f).call(f,"firstName")]),lastName:l()(n).call(n,c[u()(f).call(f,"lastName")]),company:l()(n).call(n,c[u()(f).call(f,"company")]),login:l()(n).call(n,c[u()(f).call(f,"login")]),password:l()(n).call(n,c[u()(f).call(f,"password")]),passwordConfirmation:l()(n).call(n,c[u()(f).call(f,"password")]),email:l()(n).call(n,c[u()(f).call(f,"email")]),comments:l()(n).call(n,c[u()(f).call(f,"comments")]),leadSource:a.options(c[u()(f).call(f,"leadSource")],r.leadSources),membershipStatus:p()(y).call(y,(function(e){return"nonMember"===e.id})),billingMethod:a.options(c[u()(f).call(f,"billingMethod")],C)},S=[],x=u()(w=r.sheet.data).call(w,c),R=x;for(;R<r.sheet.data.length&&(r.sheet.rowsMeta[R].subgroup||R===x||r.sheet.rowsMeta[R].headRow||r.sheet.rowsMeta[R].empty);){var I=r.sheet.rowsMeta[R],F=r.sheet.data[R];I.ignore||I.headRow||I.empty||!l()(n).call(n,F[P])||function(){var e,t=v.new();t.priceListProduct={};var n=a.options(F[P],r.products)||{};t.priceListProduct.id=p()(e=r.monthlyPriceList.products).call(e,(function(e){return e.productId===n.id})).id,t.priceListProduct.productId=n.id,t.priceListProduct.priceListId=r.monthlyPriceList.id,t.name=n.name,t.nextBillDate=a.date(F[u()(f).call(f,"recurringNextBillDate")])||moment(),t.quantity=a.uint(F[u()(f).call(f,"recurringQuantity")])||1,t.discountValue=a.currency(F[u()(f).call(f,"recurringDiscount")]),t.discountValue&&(t.discountType=k[1],t.discountTrialOccurrences={id:a.uint(F[u()(f).call(f,"recurringMonthsOfDiscount")])||1}),t.attachedReservationUnitId=(a.options(F[u()(f).call(f,"recurringAttachedReservationUnit")],r.reservationUnits)||{}).id,S.push(t)}(),R++}S.length&&(M.membershipProduct=a.options(S[0].name,r.products),M.membershipStatus=p()(y).call(y,(function(e){return"active"===e.id})),M.membershipType={id:M.membershipProduct.membershipTypeId},M.membershipPriceList=r.monthlyPriceList);var N=g.address.new();N.street=l()(n).call(n,c[u()(f).call(f,"addressStreet")]),N.city=l()(n).call(n,c[u()(f).call(f,"addressCity")]),N.country=a.options(c[u()(f).call(f,"addressCountry")],$),N.state=b[N.country.id]?a.options(c[u()(f).call(f,"addressState")],b[N.country.id]):l()(n).call(n,c[u()(f).call(f,"addressState")]),N.zip=l()(n).call(n,c[u()(f).call(f,"addressZip")]);var A=g.phone.new();A.number=l()(n).call(n,c[u()(f).call(f,"phoneNumber")]);var D=g.printerCode.new();D.code=l()(n).call(n,c[u()(f).call(f,"printerCode")]);var L=g.mailbox.new();L.number=l()(n).call(n,c[u()(f).call(f,"mailboxNumber")]);var E={number:l()(n).call(n,c[u()(f).call(f,"accessCode")]),effectiveDate:t("date")(moment(),"yyyy-MM-dd")};return g.save(i.getCurrentCenterId(),M).then((function(){if(d.id)return M.membershipProduct?v.query(i.getCurrentCenterId(),M.id).then((function(t){return e.all(s()(S).call(S,(function(e){return e.id=(p()(t).call(t,(function(t){return t.productName===e.name}))||{}).id||e.id,v.save(i.getCurrentCenterId(),M.id,e)}))).then((function(){return M}))})):M;var t=[];return t.push(g.address.save(i.getCurrentCenterId(),M.id,N)),t.push(g.phone.save(i.getCurrentCenterId(),M.id,A)),""!==D.code&&t.push(g.printerCode.save(i.getCurrentCenterId(),M.id,D)),""!==L.number&&t.push(g.mailbox.save(i.getCurrentCenterId(),M.id,L)),""!==E.number&&(E.userId=M.id,t.push(h.createAccessCard(i.getCurrentCenterId(),E))),o()(S).call(S,(function(e){t.push(v.save(i.getCurrentCenterId(),M.id,e))})),e.all(t).then((function(){return M}))}))},wireRow:function(e,t,r,n){var o;if("recurring"===r.subgroup){for(var i=u()(n).call(n,r)-1;i>=0&&(n[i].empty||n[i].headRow||n[i].subgroup);)i--;return r.ignore=r.ignore||n[i].ignore,r.id=n[i].id,r.id}if(r.id=(p()(o=e.users).call(o,(function(e){return e.fullName===t.firstName+" "+t.lastName}))||{}).id||null,r.id){var s;!!!p()(s=e.members).call(s,(function(e){return e.fullName===t.firstName+" "+t.lastName}))&&t.recurringProduct&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},zTxK:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");var n=r("ipr/"),o=r.n(n),i=r("WSeP"),s=r.n(i);t.default=angular.module("deskworks.importStripDataComments",[]).factory("importStripDataComments",(function(){return function(e){var t;angular.isArray(e)&&s()(t=o()(e).call(e,0,5)).call(t,(function(e){s()(e).call(e,(function(t,r){e[r]=t.replace(/\(?PLEASE CHANGE SAMPLE DATA AS NEEDED\)?/i,"")}))}))}}))}}]);