(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{"12k6":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");t.default=angular.module("deskworks.ReservationTabletSignInCtrl",["flexForms","deskworks.state","deskworks.dwSignIn"]).controller("ReservationTabletSignInCtrl",["$scope","$translate","state",function(e,t,r){r.setPageTitle(t.instant("SIGN_IN.PAGE_TITLE")),e.$on("dwSignIn:SignIn",(function(e){return e.stopPropagation(),r.replace().setPath("/reservation-tablet-wizard/reserve")})),this.goBack=function(){return r.replace().setPath("/reservation-tablet-wizard")}}])},"1Xgu":function(e,t,r){},EkPe:function(e,t){e.exports='<form name="$ctrl.form" id="reservationTabletSchedule"> <div class="animate-collapse" ng-if="state.getPageTitle()"> <h1 class="page-title">{{state.getPageTitle()}}</h1> </div> <div class="animate-collapse" ng-if="!state.getPageTitle()" style="height:1rem"></div> <div class="ff-grid gutter-v"> <ff-panel ff-dim="!$ctrl.unit"> <ff-header class="animate-collapse" ng-if="$ctrl.unit"> <ff-row> <cell flex="0 1 160px"><span translate="GLOBAL.TIME"></span></cell> <cell flex="1 1 210px"><span translate="GLOBAL.COMPANY"></span> / <span translate="GLOBAL.NAME"></span></cell> <cell flex="1 1 210px"><span translate="GLOBAL.TITLE"></span></cell> </ff-row> </ff-header> <ff-row ng-repeat="res in $ctrl.unit.reservations | orderBy:\'from\'" class="animate-collapse"> <ff-static flex="0 1 160px"><span><span nice-time="::res.from"></span> - <span nice-time="::res.to"></span></span></ff-static> <ff-static flex="1 1 210px"> <span> <div class="rt-company" ng-if="::res.userCompany">{{::res.userCompany}}</div> <div>{{::res.userName}}</div> </span> </ff-static> <ff-static flex="1 1 210px">{{::res.title}}</ff-static> </ff-row> </ff-panel> <ff-btn-group> <ff-btn sense="reserve" ff-click="$ctrl.reserve()"><span translate="RESERVATION_TABLET.BNT_MAKE_RESERVATION"></span></ff-btn> </ff-btn-group> </div> </form> '},"F+j4":function(e,t,r){"use strict";r.r(t);r("bOPx"),r("1Xgu"),r("OVVd");t.default=angular.module("deskworks.ReservationTabletReserveCtrl",["deskworks.state","deskworks.resReservation","resTablet"]).controller("ReservationTabletReserveCtrl",["$scope","$translate","$timeout","state","helper","session","resTablet",function(e,t,r,n,a,s,i){var o=this;function l(){o.header=o.header||document.querySelector("header.header"),o.container=o.container||angular.element(document.querySelector(".res-reservation-tablet")),o.container.css("max-height","calc(100vh - ".concat(o.header.offsetHeight,"px)"))}o.next=function(){return i.resetParams(),n.setPath("/reservation-tablet-wizard/complete")},o.signOut=function(){return i.signOut()},o.stopWizard=function(){if(s.isAdmin())return n.resetParams(),n.setPath("/reservation-tablet-setup")},o.isAdmin=s.isAdmin,o.logo=document.querySelector(".header-logo img"),o.banner=document.querySelector(".header-banner img"),o.logo.addEventListener("load",l),o.banner.addEventListener("load",l),r((function(){return l()})),e.$on("$destroy",(function(){return o.logo.removeEventListener("load",l),void o.banner.removeEventListener("load",l)}))}])},IoQK:function(e,t,r){"use strict";r.r(t);var n=r("6RpP"),a=r.n(n),s=r("nbuU"),i=r.n(s),o=r("NOor"),l=r.n(o),c=r("0zKI"),f=r.n(c),u=(r("JBxO"),r("FdtR"),r("3dw1"),r("1Xgu"),r("+l1P"));t.default=angular.module("deskworks.ReservationTabletScheduleCtrl",["session","deskworks.state",u.a.name]).controller("ReservationTabletScheduleCtrl",["$scope","$translate","$q","$interval","$localStorage","dwAlerts","state","helper","session","calendarService",function(e,t,r,n,s,o,c,u,d,p){var v=this;s.reservationTablet=s.reservationTablet||{};var g=s.reservationTablet;c.setPageTitle(t.instant("RESERVATION_TABLET.SCHEDULE.PAGE_TITLE",{unit:g.unitName})),v.reserve=function(){return c.setCurrentCenterId(g.centerId),c.setParam("unit",g.unitId),c.setPath("/reservation-tablet-wizard/reserve")},v.fetch=function(e){if(n.cancel(v.timer),!v.fetching||e)return v.fetching=!0,d.loginSilent(g.login,g.password).catch((function(e){return o.error(e,"Failed to log in by system user.")})).then((function(){return p.query(g.centerId).catch((function(e){return o.error(e,"Failed to get calendar data.")}))})).then((function(e){return e.reduce((function(e,t){return a()(e).call(e,t.reservationUnits)}),[])})).then((function(e){var t=i()(e).call(e,(function(e){return e.id===g.unitId}));return t||o.error("Reservation unit not found.")})).then((function(e){v.unit=v.unit||{reservations:[]},v.unit.name=e.name,e.reservations.forEach((function(e){var t;if(!(e.to<Date.now())){var r=l()(t=v.unit.reservations).call(t,(function(t){return t.id===e.id}));r>=0?angular.copy(e,v.unit.reservations[r]):v.unit.reservations.push(e)}})),v.unit.reservations.forEach((function(t,r){var n,a;i()(n=e.reservations).call(n,(function(e){return e.id===t.id}))||f()(a=v.unit.reservations).call(a,r,1)})),g.unitName=v.unit.name,c.setPageTitle(t.instant("RESERVATION_TABLET.SCHEDULE.PAGE_TITLE",{unit:g.unitName}))})).finally((function(){v.fetching=!1,n.cancel(v.timer),v.timer=n(v.fetch,6e4)})).finally((function(){return d.logout()}))},v.fetch(),e.$on("$destroy",(function(){return n.cancel(v.timer)}))}])},OVVd:function(e,t,r){"use strict";r.r(t),t.default=angular.module("resTablet",["session","deskworks.state","deskworks.dwAlerts.service"]).factory("resTablet",["session","state","dwAlerts",function(e,t,r){return{signOut:function(){return e.logout().catch((function(e){return r.error(e,"Failed to terminate session.")})).then((function(){return n()})).then((function(){return t.setPath("/reservation-tablet-wizard")}))},resetParams:n};function n(){t.setParam("date",null),t.setParam("start",null),t.setParam("end",null),t.setParam("title",null),t.setParam("note",null),t.setParam("freq",null),t.setParam("duration",null),t.setParam("confirm",null)}}])},cVEE:function(e,t,r){var n={"./reservation-tablet-setup/setup.tpl.html":"e1WB","./reservation-tablet-wizard/01-schedule.tpl.html":"EkPe","./reservation-tablet-wizard/02-sign-in.tpl.html":"iEtI","./reservation-tablet-wizard/03-reserve.tpl.html":"pySg","./reservation-tablet-wizard/04-complete.tpl.html":"ruFd"};function a(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="cVEE"},day0:function(e,t,r){"use strict";r.r(t);r("3dw1"),r("Muwe"),r("y89P");var n=r("yCd9"),a=r.n(n),s=r("lRNC"),i=r.n(s),o=["$injector",function(e){var t,n,s=(t=r("fChp"),a()(n=i()(t).call(t)).call(n,t));e.loadNewModules(a()(s).call(s,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var t=r("cVEE");i()(t).call(t).forEach((function(r){return e.put(r.replace(/^\.\//,""),t(r))}))}])}];t.default=o},e1WB:function(e,t){e.exports='<form name="$ctrl.form" id="reservationTabletSetup" ff-bulk-read-only> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-panel style="max-width:600px"> <label class="ff-row"> <ff-label flex="0 1 180px"><span translate="RESERVATION_TABLET.RESERVATION_CATEGORY"></span></ff-label> <ff-select flex="1 1 320px" name="reservationCategory" ff-model="$ctrl.category" ff-required="true" ff-options="cat.name for cat in $ctrl.categories" ff-change="$ctrl.onCategoryChange()"></ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 180px"><span translate="RESERVATION_TABLET.RESERVATION_UNIT"></span></ff-label> <ff-select flex="1 1 320px" name="reservationUnit" ff-model="$ctrl.unit" ff-required="true" ff-options="unit.name for unit in $ctrl.category.reservationUnits"></ff-select> </label> <ff-row> <ff-label><span> <span translate="RESERVATION_TABLET.START_WIZARD"></span> <ff-hint><span translate="RESERVATION_TABLET.START_WIZARD.HINT"></span></ff-hint> </span></ff-label> <ff-btn flex="none" sense="ok" size="sm" class="buttons-row" ff-click="$ctrl.start()"> <span translate="RESERVATION_TABLET.BTN_START"></span> </ff-btn> </ff-row> </ff-panel> </form> '},fChp:function(e,t,r){var n={"./reservation-tablet-setup/setup.controller.js":"yJ0o","./reservation-tablet-wizard/01-schedule.controller.js":"IoQK","./reservation-tablet-wizard/02-sign-in.controller.js":"12k6","./reservation-tablet-wizard/03-reserve.controller.js":"F+j4","./reservation-tablet-wizard/04-complete.controller.js":"oVwT","./reservation-tablet-wizard/res-tablet.service.js":"OVVd"};function a(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="fChp"},iEtI:function(e,t){e.exports='<dw-sign-in id="signIn"> <extra-buttons> <ff-btn sense="back" ff-click="$ctrl.goBack()" ff-countdown="20"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </extra-buttons> </dw-sign-in> '},oVwT:function(e,t,r){"use strict";r.r(t);r("OVVd");t.default=angular.module("deskworks.ReservationTabletCompleteCtrl",["deskworks.state","resTablet"]).controller("ReservationTabletCompleteCtrl",["$translate","state","helper","resTablet",function(e,t,r,n){t.setPageTitle(e.instant("RESERVATION_TABLET.COMPLETE.PAGE_TITLE")),this.signOut=function(){return n.signOut()},this.reserve=function(){return n.resetParams(),t.setPath("/reservation-tablet-wizard/reserve")}}])},pySg:function(e,t){e.exports='<res-reservation center="$resolve.center" user="$resolve.user" cal-data="$resolve.calData" hide-reservation-cost-estimate="true" hide-calendar-btn="true" after-save="$ctrl.next" sign-out="$ctrl.signOut" stop-wizard="$ctrl.isAdmin() ? $ctrl.stopWizard : null" reservation-fields="$resolve.reservationFields" class="res-reservation-tablet"></res-reservation> '},ruFd:function(e,t){e.exports='<form name="$ctrl.form" id="reservationTabletComplete"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-btn-group> <ff-btn sense="signOut" ff-click="$ctrl.signOut()" ff-countdown="20"><span translate="GLOBAL.BTN_SIGN_OUT"></span></ff-btn> <ff-btn sense="reserve" ff-click="$ctrl.reserve()"><span translate="RESERVATION_TABLET.BNT_MAKE_ANOTHER_RESERVATION"></span></ff-btn> </ff-btn-group> </form> '},yJ0o:function(e,t,r){"use strict";r.r(t);var n=r("nbuU"),a=r.n(n);t.default=angular.module("deskworks.ReservationTabletSetupCtrl",["session","deskworks.state","deskworks.Credentials"]).controller("ReservationTabletSetupCtrl",["$scope","$translate","$localStorage","dwAlerts","state","helper","session","categories","Credentials",function(e,t,r,n,s,i,o,l,c){var f=this;s.setPageTitle(t.instant("RESERVATION_TABLET.SETUP.PAGE_TITLE")),r.reservationTablet=r.reservationTablet||{};var u,d,p=r.reservationTablet;(f.categories=l,f.categories.length)&&(f.category=p.categoryId&&a()(u=f.categories).call(u,(function(e){return e.id===p.categoryId}))||f.categories[0],f.unit=p.unitId&&a()(d=f.category.reservationUnits).call(d,(function(e){return e.id===p.unitId}))||f.category.reservationUnits[0]);f.onCategoryChange=function(){return f.unit=f.category?f.category.reservationUnits[0]:null},f.start=function(){if(!i.pointFirstInvalid("#reservationTabletSetup"))return c.get("$$reservations").catch((function(e){return n.error(e,"Failed to get credentials.")})).then((function(e){p.centerId=s.getCurrentCenterId(),p.login=e.login,p.password=e.password,p.unitId=f.unit.id,p.unitName=f.unit.name,r.$apply()})).then((function(){return o.logout()})).then((function(){return s.setPath("/reservation-tablet-wizard")}))}}])}}]);