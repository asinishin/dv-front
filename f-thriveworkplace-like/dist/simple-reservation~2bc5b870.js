(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{"+mGx":function(e,t){e.exports='<div class="sr-centers"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <div class="ff-grid ff-gutter-h ff-gutter-v"> <ff-panel class="ff-panel-card" flex="{md: \'0 0 50%\'}" ng-repeat="center in vm.centers"> <ff-img ff-src="{{::center.thumbnail}}" ff-src-hq="{{::center.photo}}" ff-alt="{{::center.name}}" img-placeholder="{{\'GLOBAL.NO_PHOTO\' | translate}}"></ff-img> <div flex="1 1 auto"> <ff-header style="margin-bottom:.5rem">{{::center.name}}</ff-header> <div class="ff-grid gutter-v-half" flex="1 1 auto"> <div flex="1 1 auto"> <div class="sr-center-address"> <ff-icon sense="location"></ff-icon> <a href="{{::vm.getMapUrl(center)}}" target="_blank" rel="noopener"> {{::center.street2 ? center.street1 + \', \' + center.street2 : center.street1}} </a> </div> <div class="sr-center-phone"> <ff-icon sense="phone"></ff-icon> <a href="tel:{{::center.phone}}">{{::center.phone}}</a> </div> <div class="sr-center-email"> <ff-icon sense="email"></ff-icon> <a href="mailto:{{::center.email}}" target="_blank" rel="noopener">{{::center.email}}</a> </div> </div> <ff-btn-group flex="0 0 auto"> <ff-btn sense="ok" ff-click="vm.select(center)" aria-label="{{(\'SIMPLE_RES.BTN_SELECT\' | translate) + \' \' + center.name}}"> <span translate="SIMPLE_RES.BTN_SELECT"></span> </ff-btn> </ff-btn-group> </div> </div> </ff-panel> </div> </ff-board> </div> '},"1/Md":function(e,t,r){"use strict";var n=r("NOor"),a=r.n(n),s=r("0zKI"),i=r.n(s);t.a=angular.module("deskworks.dwInvoicePaymentProcessingFee",["deskworks.state","deskworks.helper"]).directive("dwInvoicePaymentProcessingFee",(function(){return{restrict:"A",scope:!0,controller:"DwInvoicePaymentProcessingFeeCtrl as $ctrl",bindToController:{invoice:"<",settings:"<",creditCards:"<",eChecks:"<"}}})).controller("DwInvoicePaymentProcessingFeeCtrl",["$scope","$timeout","state","helper",function(e,t,r,n){var s=this;s.$onChanges=function(){return t((function(){var e,t;if(s.invoice&&s.settings&&s.creditCards&&s.eChecks&&s.settings.enablePaymentProcessingCharges){var r=0;s.creditCards.length?r=s.settings.paymentProcessingRates.cc||0:s.eChecks.length&&(r=s.settings.paymentProcessingRates.ach||0);var l=a()(e=s.invoice.items).call(e,(function(e){return"fake-payment-processing-fee"===e.id}));if(l>=0&&i()(t=s.invoice.items).call(t,l,1),r&&+s.invoice.balance){var o=n.round(r*+s.invoice.balance/100),c={addedBy:"system",amount:o,billedAt:moment(),createdAt:moment(),description:"Payment processing fee",id:"fake-payment-processing-fee",name:"Payment Fee",price:o,quantity:1};s.invoice.items.push(c),angular.isUndefined(s.invoice.chargesTotalInitial)&&(s.invoice.chargesTotalInitial=+s.invoice.chargesTotal),angular.isUndefined(s.invoice.balanceInitial)&&(s.invoice.balanceInitial=+s.invoice.balance),s.invoice.chargesTotal=n.round(s.invoice.chargesTotalInitial+o),s.invoice.balance=n.round(s.invoice.balanceInitial+o)}}}))}}])},"1Od8":function(e,t,r){},"26Fw":function(e,t,r){"use strict";r.r(t);r("oySO");t.default=angular.module("deskworks.SimpleReservationDateCtrl",[]).controller("SimpleReservationDateCtrl",["$scope","$route","$filter","$translate","unavailableDates","state",function(e,t,r,n,a,s){var i=this;s.setPageTitle(n.instant("SIMPLE_RES.DATE.PAGE_TITLE")),i.centerId=t.current.params.centerId,i.reservationTypeId=t.current.params.reservationTypeId,i.unavailableDates=a,i.dateMin=moment().startOf("day"),i.checkDateDisabled=function(e){return i.unavailableDates.indexOf(r("date")(e,"yyyy-MM-dd"))>=0},i.next=function(){if(angular.isDefined(i.selectedDate))return s.setPath(s.getPath()+"/"+r("date")(i.selectedDate,"yyyy-MM-dd")+"/units")},i.back=s.back}])},"4HDf":function(e,t){e.exports='<div class="sr-categories"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <div class="ff-grid gutter-h gutter-v"> <ff-panel class="ff-panel-card" flex="{md: \'0 0 50%\'}" ng-repeat="category in vm.categories"> <ff-img ff-src="{{::category.thumbnail}}" ff-src-hq="{{::category.photo}}" ff-alt="{{::category.name}}" img-placeholder="{{\'GLOBAL.NO_PHOTO\' | translate}}"></ff-img> <div flex="1 1 auto"> <ff-header style="margin-bottom:.5rem">{{::category.name}}</ff-header> <div class="ff-grid gutter-v-half" flex="1 1 auto"> <div flex="1 1 auto" class="sr-cat-desc" ng-if="::category.description" ng-bind-html="::category.description"></div> <div flex="1 1 auto" ng-if="::category.staffOnly"> <span translate="RESERVATIONS.STAFF_ONLY" translate-values="{ centerName: vm.center.name, centerPhone: vm.center.phone, centerEmail: vm.center.email }"> </span> </div> <ff-btn-group flex="0 0 auto" ng-if="::!category.staffOnly"> <ff-btn sense="ok" ff-click="vm.select(category)" aria-label="{{(\'SIMPLE_RES.BTN_SELECT\' | translate) + \' \' + category.name}}"> <span translate="SIMPLE_RES.BTN_SELECT"></span> </ff-btn> </ff-btn-group> </div> </div> </ff-panel> </div> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="vm.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> </div> '},"5myT":function(e,t,r){"use strict";r.r(t);r("bOPx");angular.module("deskworks.simpleSelectTime",["deskworks.resReservation"]).component("simpleSelectTime",{templateUrl:"06-time/simple-select-time.tpl.html",controller:"ResReservationController",bindings:{center:"<",calData:"<",date:"<",hideRecurringReservations:"<",reservationFields:"<"}})},"5nZu":function(e,t,r){"use strict";r("JBxO"),r("FdtR"),angular.module("deskworks.StaffHelpCtrl",["ngRoute","deskworks.helper","deskworks.config"]).controller("StaffHelpCtrl",["$scope","$timeout","$q","$route","$window","$translate","dwAlerts","helper","state","deskworksConfig",function(e,t,r,n,a,s,i,l,o,c){this.notice=o.getParam("notice"),o.setPageTitle(s.instant("SIMPLE_RES.STAFF_HELP.PAGE_TITLE")),e.$on("$routeChangeStart",(function(e,t,r){!t.$$route||"MemberSignUpBillingCtrl"!==t.$$route.controller&&"MemberSignUpPurchaseCtrl"!==t.$$route.controller&&"SimpleReservationBillingCtrl"!==t.$$route.controller&&"SimpleReservationPurchaseCtrl"!==t.$$route.controller&&"BuyPassBillingCtrl"!==t.$$route.controller&&"BuyPassPurchaseCtrl"!==t.$$route.controller||(i.error(s.instant("SIMPLE_RES.STAFF_HELP.BACK_ERROR")),e.preventDefault())})),this.home=function(){if(o.getParam("redirect"))a.location.href=o.getParam("redirect");else{var e=o.getParam("origin"),n=o.getCurrentCenterId();(e?o.logout():r.when()).finally((function(){return o.resetParams(),e&&o.setCurrentCenterId(n),o.setPath(e||c.getDefaultRoute())}))}return t(1e4)}}])},"71HN":function(e,t){e.exports='<div class="sr-category-details rental-type-details"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <ff-panel class="sr-category-panel"> <ff-header style="margin-bottom:.5rem">{{vm.category.name}}</ff-header> <div class="sr-swiper-wrapper" ng-if="vm.category.photos.length"> <div class="sr-swiper-content"> <swiper images="vm.category.photoUrls" thumbnail="vm.category.thumbnail" ff-alt="{{vm.category.name}}"></swiper> </div> </div> <div class="tabs-block"> <uib-tabset type="pills"> <uib-tab heading="{{\'SIMPLE_RES.CATEGORY.PRICES\' | translate}}"> <div ng-repeat="product in vm.category.products" class="sr-category-products"> <h3 ng-bind="product.name"></h3> <div class="ff-row" ng-repeat="priceItem in product.priceItems"> <div flex="1 1 auto" ng-bind="priceItem.name"></div> <div flex="0 0 70px" ng-bind="priceItem.price | currency"></div> </div> </div> <div ng-hide="vm.category.products && vm.category.products.length" translate="SIMPLE_RES.CATEGORY.PRICES.EMPTY"></div> </uib-tab> <uib-tab heading="{{\'SIMPLE_RES.CATEGORY.DESCRIPTION\' | translate}}"> <div ng-bind-html="vm.category.description || (\'SIMPLE_RES.CATEGORY.DESCRIPTION.EMPTY\' | translate)"></div> </uib-tab> </uib-tabset> </div> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="vm.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="ok" ff-click="vm.reserve()"><span translate="SIMPLE_RES.CATEGORY.BTN_RESERVE"></span></ff-btn> </ff-btn-group> </div> '},"8MBW":function(e,t,r){"use strict";r.r(t);r("3dw1");var n=r("KK/u"),a=r.n(n),s=r("0zKI"),i=r.n(s),l=r("yCd9"),o=r.n(l);r("x3lI");angular.module("ui.bootstrap.tabs",[]).controller("UibTabsetController",["$scope",function(e){var t,r,n=this;function s(e){for(var t=0;t<n.tabs.length;t++)if(n.tabs[t].index===e)return t}n.tabs=[],n.select=function(e,a){if(!r){var i=s(t),l=n.tabs[i];if(l){if(l.tab.onDeselect({$event:a,$selectedIndex:e}),a&&a.isDefaultPrevented())return;l.tab.active=!1}var o=n.tabs[e];o?(o.tab.onSelect({$event:a}),o.tab.active=!0,n.active=o.index,t=o.index):!o&&angular.isDefined(t)&&(n.active=null,t=null)}},n.addTab=function(e){var t;if(n.tabs.push({tab:e,index:e.index}),a()(t=n.tabs).call(t,(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0})),e.index===n.active||!angular.isDefined(n.active)&&1===n.tabs.length){var r=s(e.index);n.select(r)}},n.removeTab=function(e){for(var t,r,a=0;a<n.tabs.length;a++)if(n.tabs[a].tab===e){r=a;break}if(n.tabs[r].index===n.active){var s=r===n.tabs.length-1?r-1:r+1%n.tabs.length;n.select(s)}i()(t=n.tabs).call(t,r,1)},e.$watch("tabset.active",(function(e){angular.isDefined(e)&&e!==t&&n.select(s(e))})),e.$on("$destroy",(function(){r=!0}))}]).directive("uibTabset",(function(){return{transclude:!0,replace:!0,scope:{},bindToController:{active:"=?",type:"@"},controller:"UibTabsetController",controllerAs:"tabset",template:'<div><ul class="nav nav-{{tabset.type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul><div class="tab-content"><div class="tab-pane" ng-repeat="tab in tabset.tabs" ng-class="{active: tabset.active === tab.index}" uib-tab-content-transclude="tab"></div></div></div>',link:function(e,t,r){e.vertical=!!angular.isDefined(r.vertical)&&e.$parent.$eval(r.vertical),e.justified=!!angular.isDefined(r.justified)&&e.$parent.$eval(r.justified)}}})).directive("uibTab",["$parse",function(e){return{require:"^uibTabset",replace:!0,template:'<li ng-class="[{active: active, disabled: disabled}, classes]" class="uib-tab nav-item"><a href ng-click="select($event)" class="nav-link" role="button" uib-tab-heading-transclude>{{heading}}</a></li>',transclude:!0,scope:{heading:"@",index:"=?",classes:"@?",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},controllerAs:"tab",link:function(t,r,n,a,s){var i;(t.disabled=!1,n.disable&&t.$parent.$watch(e(n.disable),(function(e){t.disabled=!!e})),angular.isUndefined(n.index))&&(a.tabs&&a.tabs.length?t.index=Math.max.apply(null,o()(i=a.tabs).call(i,(function(e){return e.index})))+1:t.index=0);angular.isUndefined(n.classes)&&(t.classes=""),t.select=function(e){if(!t.disabled){for(var r,n=0;n<a.tabs.length;n++)if(a.tabs[n].tab===t){r=n;break}a.select(r,e)}},a.addTab(t),t.$on("$destroy",(function(){a.removeTab(t)})),t.$transcludeFn=s}}}]).directive("uibTabHeadingTransclude",(function(){return{restrict:"A",require:"^uibTab",link:function(e,t){e.$watch("headingElement",(function(e){e&&(t.html(""),t.append(e))}))}}})).directive("uibTabContentTransclude",(function(){return{restrict:"A",require:"^uibTabset",link:function(e,t,r){var n=e.$eval(r.uibTabContentTransclude).tab;n.$transcludeFn(n.$parent,(function(e){angular.forEach(e,(function(e){!function(e){return e.tagName&&(e.hasAttribute("uib-tab-heading")||e.hasAttribute("data-uib-tab-heading")||e.hasAttribute("x-uib-tab-heading")||"uib-tab-heading"===e.tagName.toLowerCase()||"data-uib-tab-heading"===e.tagName.toLowerCase()||"x-uib-tab-heading"===e.tagName.toLowerCase()||"uib:tab-heading"===e.tagName.toLowerCase())}(e)?t.append(e):n.headingElement=e}))}))}}}))},"9ynW":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");var n=r("Vtxe");t.default=angular.module("deskworks.SimpleReservationCompleteCtrl",[n.a.name]).controller("SimpleReservationCompleteCtrl",["$scope","$q","$timeout","$translate","dwAlerts","state","helper","deskworksConfig","center","purchase","settings",function(e,t,r,n,a,s,i,l,o,c,f){var u=this;u.center=o,u.purchase=c,u.accessCode=s.getParam("accessCode"),u.settings=f,s.setPageTitle(n.instant("SIMPLE_RES.COMPLETE.PAGE_TITLE")),e.$on("$locationChangeStart",(function(e,t){t&&t.indexOf("/simple-reservation")>=0&&(e.preventDefault(),a.error(n.instant("SIMPLE_RES.COMPLETE.BACK_ERROR")))})),u.home=function(){var e=s.getParam("origin"),n=s.getCurrentCenterId();return(e?s.logout():t.when()).finally((function(){s.resetParams(),s.setPath(e||l.getDefaultRoute()),e?s.setCurrentCenterId(n):u.center&&s.setCurrentCenterId(u.center.id)})),r(1e4)}}])},EilH:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");var n=r("hsT8"),a=r.n(n),s=(r("3dw1"),r("ZEAQ"),r("nwT/")),i=r.n(s),l=(r("Fee/"),angular.module("deskworks.resClock",["deskworks.rcHelper"]).component("resClock",{template:i.a,controller:"ResClockCtrl",bindings:{resUnit:"<",am:"<"}}).controller("ResClockCtrl",["$locale","$filter","rcHelper",function(e,t,r){var n=this;function a(e){var t=4*Math.PI/1440,a=[];return e.forEach((function(e){var l=e.from.clone().hour(n.am?0:12).minute(0).second(0),o=e.from.clone().hour(n.am?12:24).minute(0).second(0);if(r.checkIntersection(e.from,e.to,l,o)){var c=e.from<l?l:e.from,f=e.to>o?o:e.to;a.push(function(e,t){if(t-e>=2*Math.PI)return t-=.001,"M "+i(100,e)+","+s(100,e)+"  A100,100 1 "+(t-e>Math.PI?"1":"0")+",1 "+i(100,t)+","+s(100,t)+" z";return"M0,0 L"+i(100,e)+","+s(100,e)+"  A100,100 1 "+(t-e>Math.PI?"1":"0")+",1 "+i(100,t)+","+s(100,t)+" z"}(Math.PI+(60*c.hour()+c.minute())*t,Math.PI+(60*c.hour()+c.minute()+(f-c)/6e4)*t))}})),a}function s(e,t){return+(e*Math.cos(-t)).toFixed(3)}function i(e,t){return+(e*Math.sin(-t)).toFixed(3)}n.$onInit=function(){!function(){n.hours=[],n.quarters=[];for(var e=0;e<12;e++){var t=e*(Math.PI/6),r="M"+i(90,t)+","+s(90,t)+"  L"+i(100,t)+","+s(100,t)+"  z";n.hours.push(r)}for(var a=0;a<4;a++){var l=a*(Math.PI/2),o="M"+i(75,l)+","+s(75,l)+"  L"+i(100,l)+","+s(100,l)+"  z";n.quarters.push(o)}}(),n.AMPMS=e.DATETIME_FORMATS.AMPMS},n.$onChanges=function(){n.availabilities=a(n.resUnit.availabilities),n.reservations=a(n.resUnit.reservations)}}]).directive("svgD",(function(){return{restrict:"A",scope:!0,link:function(e,t,r){e.$watch(r.svgD,(function(e){t.attr("d",e)}))}}})));t.default=angular.module("deskworks.SimpleReservationUnitsCtrl",[l.name]).controller("SimpleReservationUnitsCtrl",["$scope","$route","$translate","$locale","state","resUnits","center","settings",function(e,t,r,n,s,i,l,o){var c=this;s.setPageTitle(r.instant("SIMPLE_RES.UNITS.PAGE_TITLE")),c.center=l,c.resTypeId=t.current.params.reservationTypeId,c.date=t.current.params.date,c.units=a()(i).call(i,(function(e){return e.availabilities.length||"staffOnly"===e.whoCanReserve&&!o.hideStaffOnlyUnits})),e.$on("LOGOUT",t.reload),e.$on("LOGIN",t.reload),c.select=function(e){return s.setPath(s.getPath()+"/"+e.id)},1===c.units.length&&"staffOnly"!==c.units[0].whoCanReserve&&(s.replace(),c.select(c.units[0])),c.back=s.back}])},FBsi:function(e,t,r){},"Fee/":function(e,t,r){},Fq4b:function(e,t,r){},Glix:function(e,t,r){},HxVc:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");t.default=angular.module("deskworks.SimpleReservationSignInCtrl",["flexForms","deskworks.state","deskworks.config","deskworks.dwSignIn"]).controller("SimpleReservationSignInCtrl",["$scope","$q","$location","$route","$translate","state",function(e,t,r,n,a,s){s.setPageTitle(a.instant("SIGN_IN.PAGE_TITLE")),e.$on("dwSignIn:SignIn",(function(e){e.stopPropagation(),s.replace(),s.isLoggedNonMember()?s.setPath(s.getPath()+"/"+s.getLoggedUserId()):s.setPath(s.getPath()+"/"+s.getLoggedUserId()+"/confirm")})),e.$on("dwSignIn:SignUp",(function(e){e.stopPropagation(),s.setPath(s.getPath()+"/new")}))}])},IJqC:function(e,t){e.exports='<ff-panel id="reservationAgreement" class="ff-no-frame"> <label> <ff-checkbox ff-model="reservationAgreement" ff-required="true" ff-validate-alert="{ required: (\'RESERVATIONS.RESERVATION_AGREEMENT.REQUIRED\' | translate) }" title="{{\'RESERVATIONS.RESERVATION_AGREEMENT.REQUIRED\' | translate}}"> <div translate="RESERVATIONS.RESERVATION_AGREEMENT.LABEL"></div> <a ng-href="{{::wlLinks.reservationAgreementLinkUrl}}" ng-bind="::wlLinks.reservationAgreementLinkText" target="_blank" rel="noopener"></a> </ff-checkbox> </label> </ff-panel> '},Ij62:function(e,t,r){"use strict";r.r(t);var n=r("6RpP"),a=r.n(n);r("Muwe"),r("y89P"),r("FBsi");t.default=angular.module("deskworks.SimpleReservationCentersCtrl",[]).controller("SimpleReservationCentersCtrl",["$scope","$translate","centers","state",function(e,t,r,n){n.setPageTitle(t.instant("SIMPLE_RES.CENTERS.PAGE_TITLE")),1===r.length&&(n.replace(),n.setPath(n.getPath()+"/centers/"+r[0].id+"/types")),this.centers=r,this.getMapUrl=function(e){var t,r;return"https://maps.google.com?q="+encodeURIComponent(a()(t=a()(r="".concat(e.street1,", ")).call(r,e.city,", ")).call(t,e.state))},this.select=function(e){return n.getCurrentCenterId()!==e.id&&n.setCurrentCenterId(e.id),n.setPath("/simple-reservation/centers/"+e.id+"/types")}}])},KYZr:function(e,t,r){"use strict";r.r(t);r("1Od8");t.default=angular.module("deskworks.SimpleReservationTimeCtrl",["deskworks.simpleSelectTime"]).controller("SimpleReservationTimeCtrl",["$scope","$translate","state",function(e,t,r){r.setPageTitle(t.instant("SIMPLE_RES.TIME.PAGE_TITLE"))}])},KdAj:function(e,t){e.exports='<div class="sr-units"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <ff-panel ng-if="!vm.units.length"><span translate="SIMPLE_RES.UNITS.EMPTY"></span></ff-panel> <div class="em" style="margin:0 0 .5rem 1rem">{{vm.date | date:\'longDate\'}}</div> <div class="ff-grid ff-gutter-h ff-gutter-v"> <ff-panel class="ff-panel-card" flex="{md: \'0 0 50%\'}" ng-repeat="unit in vm.units"> <ff-header style="margin-bottom:.5rem">{{::unit.name}}</ff-header> <div class="ff-row" style="height:100%"> <div flex="0 0 142px" class="sr-clocks"> <res-clock res-unit="::unit" am="true"></res-clock> <res-clock res-unit="::unit" am="false"></res-clock> </div> <ff-col flex="1 1 auto"> <div ng-if="unit.capacity" translate="GLOBAL.UNIT_CAPACITY" translate-values="{ capacity: unit.capacity }" style="text-align:right;font-size:.9rem;line-height:1.1;margin-bottom:5px"></div> <ff-btn-group style="margin-top:auto"> <ff-btn sense="ok" ff-click="vm.select(unit)" aria-label="{{(\'SIMPLE_RES.BTN_SELECT\' | translate) + \' \' + unit.name}}"> <span translate="SIMPLE_RES.BTN_SELECT"></span></ff-btn> </ff-btn-group> </ff-col> </div> </ff-panel> </div> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="vm.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> </div> '},KjfD:function(e,t,r){},"NM/t":function(e,t){e.exports='<div id="simpleReservationComplete"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <div class="ff-grid ff-gutter-v"> <ff-panel> <span class="ff-center ff-bmargin" ng-if="vm.accessCode && vm.settings.enableAccessCodes" translate="SIMPLE_RES.COMPLETE.ACCESS_CODE" translate-values="{ accessCode: vm.accessCode }"></span> </ff-panel> <ff-panel ng-if="vm.purchase"> <ff-panel-header> <span translate="SIMPLE_RES.COMPLETE.ORDER.HEADER" translate-values="{ orderId: vm.purchase.orderId }"></span> </ff-panel-header> <dw-invoice invoice="vm.purchase" center="vm.center" allow-remove="false"></dw-invoice> </ff-panel> </div> </ff-board> <ff-btn-group class="buttons-bottom" ng-class="{\'ff-center\': !vm.purchase}"> <ff-btn sense="home" type="submit" ff-click="vm.home()"><span translate="GLOBAL.BTN_HOME"></span></ff-btn> </ff-btn-group> </div> '},QEpw:function(e,t){e.exports='<span translate="BILLING_PROFILE.PAYMENT_METHOD.EMPTY" ng-if="$ctrl.showSwitchCC() && $ctrl.showSwitchACH()"></span> <up-billing-method user="$ctrl.user" settings="$ctrl.settings" ng-if="!$ctrl.isSingleMode()"></up-billing-method> <up-credit-cards user-profile="$ctrl.user" settings="$ctrl.settings" single="$ctrl.isSingleMode()" ng-if="$ctrl.user.creditCards.length || !$ctrl.isSingleMode()"></up-credit-cards> <up-e-checks user-profile="$ctrl.user" single="$ctrl.isSingleMode()" ng-if="$ctrl.settings.enableEChecks && ($ctrl.user.eChecks.length || !$ctrl.isSingleMode())"></up-e-checks> '},SLH3:function(e,t,r){"use strict";r.r(t);var n=r("hsT8"),a=r.n(n);r("KjfD");t.default=angular.module("deskworks.SimpleReservationCategoriesCtrl",[]).controller("SimpleReservationCategoriesCtrl",["$scope","$translate","state","center","reservationCategories","settings",function(e,t,r,n,s,i){r.setPageTitle(t.instant("SIMPLE_RES.CATEGORIES.PAGE_TITLE")),this.center=n,this.categories=a()(s).call(s,(function(e){var t,n,s=a()(t=e.reservationUnits).call(t,(function(e){return!i.hideStaffOnlyUnits&&"staffOnly"===e.whoCanReserve})).length,l=a()(n=e.reservationUnits).call(n,(function(e){return"notAvailable"!==e.whoCanReserve&&("staffOnly"!==e.whoCanReserve||r.isLoggedAdmin())&&("member"!==e.whoCanReserve||r.isLoggedMember()||r.isLoggedAdmin())&&("nonMember"!==e.whoCanReserve||r.isLoggedNonMember()||r.isLoggedAdmin()||!r.getLoggedUserId())})).length;return e.staffOnly=!!s&&!l,!!l||!!s})),this.select=function(e){return r.setPath(r.getPath()+"/"+e.id)},this.back=r.back}])},TiT8:function(e,t,r){var n={"./01-centers/centers.controller.js":"Ij62","./02-reservation-categories/reservation-categories.controller.js":"SLH3","./03-reservation-category/reservation-category.controller.js":"kAKh","./03-reservation-category/swiper.directive.js":"pAtM","./03-reservation-category/tabs.js":"8MBW","./04-date/date.controller.js":"26Fw","./05-reservation-units/reservation-units.controller.js":"EilH","./06-time/simple-reservation-time.controller.js":"KYZr","./06-time/simple-select-time.component.js":"5myT","./07-user-profile/user-profile.controller.js":"zT5p","./08-purchase/purchase.controller.js":"v/E5","./other/complete.controller.js":"9ynW","./other/confirm.controller.js":"hjI7","./other/simple-reservation-sign-in.controller.js":"HxVc"};function a(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="TiT8"},VHWN:function(e,t,r){},aE5K:function(e,t){e.exports='<div class="user-profile" id="userProfile"> <h1 class="page-title flex"> <span> {{state.getPageTitle()}} <span ng-if="vm.reg.member && !vm.reg.selfRegistration" ng-style="{ color: vm.center.color }">{{vm.center.name}}</span> </span> <need-help phone="vm.reg.phone"></need-help> </h1> <ff-board> <ff-panel role="article" aria-label="{{\'USER_PROFILE.USER_PROFILE\' | translate}}"> <ff-panel-header ng-if="vm.reg"> <span translate="GLOBAL.STEP_X_OF_Y" translate-values="vm.reg" ng-if="vm.reg.stepCount"></span> <small translate="GLOBAL.REQUIRED_FIELDS_MARKED_WITH"></small> </ff-panel-header> <div class="ff-grid ff-gutter-v ff-gutter-h"> <up-personal-info user="vm.userProfile" schema="vm.schema" reg="vm.reg"></up-personal-info> <up-addresses flex="{md: \'0 0 50%\'}" user="vm.userProfile" schema="vm.schema" reg="vm.reg" center="vm.center" single="true"></up-addresses> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-login-info user="vm.userProfile" schema="vm.schema" reg="vm.reg" member-directory-url="wlLinks.memberDirectoryUrl"></up-login-info> <up-phones user="vm.userProfile" schema="vm.schema" reg="vm.reg" single="true"></up-phones> </div> </div> <up-photo flex="{md: \'0 0 50%\'}" user="vm.userProfile" schema="vm.schema" reg="vm.reg"></up-photo> <div flex="{md: \'0 0 50%\'}"> <div class="ff-grid ff-gutter-v"> <up-lead-source user="vm.userProfile" schema="vm.schema" reg="vm.reg"></up-lead-source> <up-terms-of-service user="vm.userProfile" schema="vm.schema" reg="vm.reg"></up-terms-of-service> </div> </div> </div> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom" ng-if="vm.reg"> <ff-btn sense="back" ff-click="vm.back()" ng-if="vm.back"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="next" ff-click="vm.next()"><span translate="GLOBAL.BTN_NEXT"></span></ff-btn> </ff-btn-group> </div> '},aIjk:function(e,t,r){"use strict";t.a=angular.module("needHelp",[]).directive("needHelp",(function(){return{restrict:"E",scope:!0,controller:function(){},controllerAs:"$ctrl",template:'<span translate="GLOBAL.NEED_HELP" class="need-help" ng-if="$ctrl.phone" translate-values="{ phone: \'<a href=&quot;tel:\' + $ctrl.phone + \'&quot;>\' + $ctrl.phone + \'</a>\' }"></span>',bindToController:{phone:"<"}}}))},dLOS:function(e,t,r){"use strict";r("3dw1");var n=r("hsT8"),a=r.n(n),s=r("nbuU"),i=r.n(s),l=r("6RpP"),o=r.n(l),c=r("QEpw"),f=r.n(c);t.a=angular.module("newBillingProfile",[]).directive("newBillingProfile",(function(){return{template:f.a,restrict:"E",scope:!0,controller:"NewBillingProfileCtrl as $ctrl",bindToController:{settings:"<",user:"<"}}})).controller("NewBillingProfileCtrl",["$scope","userProfileService",function(e,t){var r=this;r.$onInit=function(){var n;if(r.settings.creditCardTypes=a()(n=r.settings.creditCardTypes).call(n,(function(e){return e.enable})),r.user.creditCards.forEach((function(e){var t;e.type=i()(t=r.settings.creditCardTypes).call(t,(function(t){return t.id===e.type}))||e.type||{}})),r.user.creditCards=r.user.creditCards||[],!r.user.creditCards.length&&!r.user.eChecks.length){var s=t.creditCard.new(r.user);s.type=r.settings.creditCardTypes[0],r.user.creditCards.push(s)}e.$watchCollection((function(e){var t;return o()(t=r.user.creditCards).call(t,r.user.eChecks)}),(function(e){e&&r.user.paymentMethodId&&!i()(e).call(e,(function(e){return e.id===r.user.paymentMethodId}))&&(r.user.billingMethod=null,r.user.paymentMethodId=null)})),t.bindTestBillingGenerator(e,r.user)},r.isSingleMode=function(){var e=r.user,n=e.creditCards,a=e.eChecks;return!n.length&&(!a.length||t.eCheck.isNew(a[0]))||!a.length&&(!n.length||t.creditCard.isNew(n[0]))}}])},"e+LO":function(e,t){e.exports='<form name="formSimpleReservationConfirm" id="simpleReservationConfirm"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <ff-panel style="max-width:480px"> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.LOCATION"></span></ff-label> <ff-static ff-bind="vm.center.name" name="center"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.SPACE"></span></ff-label> <ff-static ff-bind="vm.reservationUnit.name" name="reservationUnit"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.DATE"></span></ff-label> <ff-static ff-bind="vm.date | date:\'longDate\'" name="date"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.TIME"></span></ff-label> <ff-static> <span><span nice-time="vm.timeStart"></span> - <span nice-time="vm.timeEnd"></span></span> </ff-static> </ff-row> <div ng-if="vm.hasRecurring()"> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.REPEAT_FREQUENCY"></span></ff-label> <ff-static name="repeats"><span ng-bind="vm.repeatFrequency.name"></span></ff-static> </ff-row> <ff-row ng-if="vm.repeatFrequency.repeatDurationOptions"> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.REPEAT_DURATION"></span></ff-label> <ff-static>{{vm.repeatFrequency.repeatDurationFilter(vm.repeatDuration)}}</ff-static> </ff-row> </div> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="vm.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="next" type="submit" ff-click="vm.next()"><span translate="GLOBAL.BTN_NEXT"></span></ff-btn> </ff-btn-group> </form> '},hjI7:function(e,t,r){"use strict";r.r(t);r("3dw1");var n=r("nbuU"),a=r.n(n),s=r("03wM"),i=r.n(s),l=r("+l1P");t.default=angular.module("deskworks.SimpleReservationConfirmCtrl",["deskworks.center.service","deskworks.reservationCategory.service","deskworks.reservationService","deskworks.reservationUnit.optsRepeatFrequency","deskworks.ReservationCost",l.a.name]).controller("SimpleReservationConfirmCtrl",["$scope","$route","$filter","$translate","$q","settings","dwAlerts","helper","session","center","state","reservationUnit","reservationCategoryService","reservationService","ReservationCost","reservationFields","optsRepeatFrequency",function(e,t,r,n,s,l,o,c,f,u,d,p,m,g,v,h,b){var E=this;d.setPageTitle(n.instant("RESERVATIONS.CONFIRM.PAGE_TITLE")),E.center=u,E.reservationUnit=p,E.date=r("toDate")(d.getParam("start")),E.timeStart=r("toDate")(d.getParam("start")),E.timeEnd=r("toDate")(d.getParam("end")),E.reservationNote=d.getParam("note")||"",E.emailConfirmation=!!d.getParam("confirm"),E.repeatFrequencyOptions=b,E.repeatFrequency=E.repeatFrequencyOptions[0],d.getParam("freq")&&(E.repeatFrequency=a()(c).call(c,E.repeatFrequencyOptions,d.getParam("freq")),E.repeatFrequency&&E.repeatFrequency.repeatDurationOptions&&d.getParam("duration")-1<E.repeatFrequency.repeatDurationOptions.length&&(E.repeatDuration=+d.getParam("duration"))),E.back=d.back,E.next=function(){return s.when(f.isRole("nonMember")&&v.calcAsync(E.center.id,d.getCurrentUserId(),E.reservationUnit.id,d.getParam("start"),d.getParam("end")).then((function(e){if(e)return o.error("Not allowed. Chargeable reservation.")}))).then((function(){var e=JSON.parse(d.getParam("fields")||"{}");i()(e).forEach((function(t){var r=a()(h).call(h,(function(e){return e.id===+t}));e[t]=r.$$serialize(r,e[t])}));var t={centerId:E.center.id,reservationUnitId:E.reservationUnit.id,from:E.timeStart,to:E.timeEnd,reservationNote:E.reservationNote,emailConfirmation:!!E.emailConfirmation,repeatFrequency:E.repeatFrequency.id,repeatDuration:E.repeatDuration,fields:e};return g.save(E.center.id,d.getCurrentUserId(),t).catch((function(e){return o.error(e,"Failed to make reservation.")}))})).then((function(e){return d.setParam("accessCode",e?e.accessCode||e.access_code:null),d.setPath("/simple-reservation/complete")}))},E.hasRecurring=function(){return f.isAdmin()||!l.hideRecurringReservations}}])},kAKh:function(e,t,r){"use strict";r.r(t);var n=r("yCd9"),a=r.n(n),s=r("hsT8"),i=r.n(s);r("iPZ8"),r("kypl"),r("Fq4b");t.default=angular.module("deskworks.SimpleReservationCategoryCtrl",["ngSanitize","ui.bootstrap.tabs","swiper"]).controller("SimpleReservationCategoryCtrl",["$scope","$route","$sce","$translate","reservationCategory","state",function(e,t,r,n,s,l){var o,c,f=this;(f.centerId=t.current.params.centerId,f.category=s,l.setPageTitle(n.instant("SIMPLE_RES.CATEGORY.PAGE_TITLE")),f.category.description=r.trustAsHtml(f.category.description),f.category.photos)&&(f.category.photoUrls=a()(c=f.category.photos).call(c,(function(e){return e.url})));f.category.products=i()(o=f.category.products).call(o,(function(e){return e.priceItems&&e.priceItems.length})),f.reserve=function(){return l.setPath(l.getPath()+"/dates")},f.back=l.back}])},l7sz:function(e,t){e.exports='<div id="staffHelp" class="ff-tmargin"> <ff-board> <ff-panel> <span ng-bind="::vm.notice"></span> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom ff-center"> <ff-btn sense="home" type="submit" ff-click="vm.home()"><span translate="GLOBAL.BTN_HOME"></span></ff-btn> </ff-btn-group> </div> '},mAfg:function(e,t,r){"use strict";r.r(t);r("3dw1"),r("Muwe"),r("y89P");var n=r("yCd9"),a=r.n(n),s=r("lRNC"),i=r.n(s),l=r("hsT8"),o=r.n(l),c=(r("VHWN"),r("5nZu"),r("l7sz")),f=r.n(c),u=r("aE5K"),d=r.n(u),p=["$injector",function(e){var t,n,s,l=(n=r("TiT8"),a()(s=i()(n).call(n)).call(s,n));e.loadNewModules(a()(t=o()(l).call(l,(function(e){return e.default}))).call(t,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var t=r("o6Dd");i()(t).call(t).forEach((function(r){return e.put(r.replace(/^\.\//,""),t(r))})),e.put("staff-help/staff-help.tpl.html",f.a),e.put("templates/new-user-profile.tpl.html",d.a)}])}];t.default=p},"nwT/":function(e,t){e.exports='<svg class="res-clock" viewBox="-102 -102 204 204"> <circle cx="0" cy="0" r="100"></circle> <path ng-repeat="path in $ctrl.availabilities track by $index" svg-d="path" class="available"></path> <path ng-repeat="path in $ctrl.reservations track by $index" svg-d="path" class="reserved"></path> <path ng-repeat="path in $ctrl.hours track by $index" svg-d="path" class="hour"></path> <path ng-repeat="path in $ctrl.quarters track by $index" svg-d="path" class="quarter"></path> <text text-anchor="middle" alignment-baseline="middle" ng-bind="$ctrl.am ? $ctrl.AMPMS[0] : $ctrl.AMPMS[1]"></text> </svg> '},o6Dd:function(e,t,r){var n={"./01-centers/centers.tpl.html":"+mGx","./02-reservation-categories/reservation-categories.tpl.html":"4HDf","./03-reservation-category/reservation-category.tpl.html":"71HN","./04-date/date.tpl.html":"ypT5","./05-reservation-units/reservation-units.tpl.html":"KdAj","./06-time/simple-reservation-time.tpl.html":"wMt5","./06-time/simple-select-time.tpl.html":"wXwX","./08-purchase/purchase.tpl.html":"pJ+n","./other/complete.tpl.html":"NM/t","./other/confirm.tpl.html":"e+LO","./other/simple-reservation-sign-in.tpl.html":"qQ0/"};function a(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="o6Dd"},oySO:function(e,t,r){},pAtM:function(e,t,r){"use strict";r.r(t);var n=r("9hLu"),a=r.n(n);r("Glix");t.default=angular.module("swiper",[]).value("swiperCount",0).directive("swiper",["$timeout","swiperCount",function(e,t){return{restrict:"E",scope:{images:"<",thumbnail:"<",ffAlt:"@"},link:function(r,n,s){var i;n.addClass("loading"),r.$watch("images",(function(){angular.isDefined(r.images)&&angular.isUndefined(i)&&(r.swiperContainer="swiper-"+t++,e((function(){i=new a.a("#"+r.swiperContainer,{pagination:".swiper-pagination",paginationClickable:!0});var e=document.getElementById(r.swiperContainer).getElementsByTagName("img");if(e.length>0){var t=new Image;t.onload=function(){angular.element(document.getElementById(r.swiperContainer)).css("opacity",1),n.removeClass("loading")},t.src=e[0].src}}),0,!1))})),r.prev=function(){i.swipePrev()},r.next=function(){i.swipeNext()}},template:'<div class="swiper-thumbnail" ng-if="thumbnail"><ff-img ff-src="{{thumbnail}}" alt="{{ffAlt}}" img-placeholder="{{\'GLOBAL.NO_PHOTO\' | translate}}"></div><div class="swiper-container" id="{{swiperContainer}}"><div class="swiper-wrapper"><div class="swiper-slide" ng-repeat="image in images"><img ng-src="{{image}}" alt="{{ffAlt}}"></div></div><div class="swiper-pagination" ng-show="images.length > 1"></div><div class="swiper-prev" ng-show="images.length > 1" ng-click="prev()" aria-label="{{\'SIMPLE_RES.CATEGORY.PREV_SLIDE\' | translate}}"><span class="fa fa-chevron-left"></span></div><div class="swiper-next" ng-show="images.length > 1" ng-click="next()" aria-label="{{\'SIMPLE_RES.CATEGORY.NEXT_SLIDE\' | translate}}"><span class="fa fa-chevron-right"></span></div></div>'}}])},"pJ+n":function(e,t){e.exports='<div> <h1 class="page-title flex"> <span>{{state.getPageTitle()}}</span> <need-help phone="vm.center.phone"></need-help> </h1> <form name="formPurchase" id="simpleReservationPurchase" novalidate> <ff-board ff-dim="vm.spin"> <div class="ff-grid gutter-v gutter-h"> <ff-panel ng-if="vm.date"> <ff-panel-header> <span translate="SIMPLE_RES.PURCHASE.RESERVATION.HEADER"></span> </ff-panel-header> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.LOCATION"></span></ff-label> <ff-static ff-bind="::vm.center.name" name="center"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.SPACE"></span></ff-label> <ff-static ff-bind="::vm.reservationUnit.name" name="reservationUnit"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.DATE"></span></ff-label> <ff-static ff-bind="::vm.date | date:\'longDate\'" name="date"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.TIME"></span></ff-label> <ff-static> <span><span nice-time="::vm.timeStart"></span> - <span nice-time="::vm.timeEnd"></span></span> </ff-static> </ff-row> <ff-row ng-if="vm.hasRecurring()"> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.REPEAT_FREQUENCY"></span></ff-label> <ff-static><span ng-bind="::vm.repeatFrequency.name"></span></ff-static> </ff-row> <ff-row ng-if="vm.hasRecurring() && vm.repeatFrequency.repeatDurationOptions"> <ff-label flex="0 1 100px"><span translate="RESERVATIONS.REPEAT_DURATION"></span></ff-label> <ff-static>{{::vm.repeatFrequency.repeatDurationFilter(vm.repeatDuration)}}</ff-static> </ff-row> </ff-panel> <ff-panel> <ff-panel-header> <span translate="SIMPLE_RES.PURCHASE.ORDER.HEADER" translate-values="{ orderId: vm.purchase.orderId }"></span> </ff-panel-header> <dw-invoice invoice="vm.purchase" center="vm.center" allow-remove="false" dw-invoice-payment-processing-fee settings="$resolve.settings" credit-cards="$resolve.userProfile.creditCards" e-checks="$resolve.userProfile.eChecks"></dw-invoice> </ff-panel> <div> <ff-panel-header> <div translate="BILLING_PROFILE.PAGE_TITLE" translate-values="{ userName: vm.user.fullNameCompany }"></div> <small translate="GLOBAL.REQUIRED_FIELDS_MARKED_WITH"></small> </ff-panel-header> <new-billing-profile user="vm.user" settings="vm.settings" id="newBillingProfile" class="ff-grid gutter-v"></new-billing-profile> </div> <ff-col> <div class="ff-grid gutter-h gutter-v" style="justify-content:flex-end"> <reservation-agreement flex="0 0 300px" ng-if="wlLinks.reservationAgreementLinkUrl"></reservation-agreement> <ff-panel flex="0 0 300px"> <label class="ff-row"> <ff-checkbox name="emailConfirmation" ff-model="vm.emailConfirmation"> <span translate="RESERVATIONS.EMAIL_CONFIRMATION"></span> </ff-checkbox> </label> </ff-panel> </div> </ff-col> </div> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="help" ff-click="vm.staffHelp()"><span translate="GLOBAL.BTN_STAFF_HELP"></span></ff-btn> <ff-btn sense="back" ff-click="vm.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="next" type="submit" ff-click="vm.next()"><span translate="SIMPLE_RES.BILLING.BTN_PURCHASE"></span></ff-btn> </ff-btn-group> </form> </div> '},"qQ0/":function(e,t){e.exports='<dw-sign-in id="signIn" show-sign-up="true"></dw-sign-in> '},tzPS:function(e,t,r){"use strict";var n=r("IJqC"),a=r.n(n);t.a=angular.module("deskworks.reservationAgreement",["deskworks.helper","deskworks.state"]).directive("reservationAgreement",(function(){return{restrict:"E",scope:!0,template:a.a,translations:["reservations"]}}))},"v/E5":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR"),r("Muwe"),r("y89P"),r("3dw1");var n=r("nbuU"),a=r.n(n),s=r("03wM"),i=r.n(s),l=r("dLOS"),o=r("aIjk"),c=r("tzPS"),f=r("2/1H"),u=r("Vtxe"),d=r("1/Md"),p=r("+l1P");t.default=angular.module("deskworks.SimpleReservationPurchaseCtrl",["ngRoute","deskworks.helper","deskworks.StaffHelpCtrl","deskworks.userProfile.service","deskworks.purchase.service","deskworks.reservationService","deskworks.reservationUnit.optsRepeatFrequency",l.a.name,o.a.name,c.a.name,f.a.name,u.a.name,d.a.name,p.a.name]).controller("SimpleReservationPurchaseCtrl",["$scope","$filter","$q","$route","$translate","$timeout","dwAlerts","helper","session","state","reg","settings","center","purchase","userProfile","userProfileService","reservationUnit","purchaseService","reservationService","optsRepeatFrequency","reservationFields",function(e,t,r,n,s,l,o,c,f,u,d,p,m,g,v,h,b,E,P,R,T){var S=this;u.setPageTitle(s.instant("SIMPLE_RES.PURCHASE.PAGE_TITLE",{centerName:m.name})),S.reg=d,S.center=m,S.settings=p,S.user=v,S.purchase=g,S.reservationUnit=b,S.date=t("toDate")(n.current.params.date),S.timeStart=t("toDate")(u.getParam("start")),S.timeEnd=t("toDate")(u.getParam("end")),S.reservationNote=u.getParam("note")||"",S.emailConfirmation=!!u.getParam("confirm"),S.repeatFrequency=R[0],u.getParam("freq")&&(S.repeatFrequency=a()(R).call(R,(function(e){return e.id===u.getParam("freq")})),S.repeatFrequency&&S.repeatFrequency.repeatDurationOptions&&u.getParam("duration")-1<S.repeatFrequency.repeatDurationOptions.length&&(S.repeatDuration=+u.getParam("duration"))),S.next=function(){if(!c.pointFirstInvalid("#simpleReservationPurchase"))return S.spin=!0,h.saveBillingProfile(n.current.params.centerId,S.user).then((function(e){return+S.purchase.balance<=0?u.setPath(u.getPath()+"/complete"):S.createReservationWithPayment().then((function(e){return S.updatePurchase().then((function(t){return e}))})).then((function(e){return u.replace().setParam("accessCode",e.accessCode),l((function(e){return u.setPath(u.getPath()+"/complete")}))}))})).finally((function(e){S.spin=!1}))},S.createReservationWithPayment=function(e){var t=JSON.parse(u.getParam("fields")||"{}");i()(t).forEach((function(e){var r=a()(T).call(T,(function(t){return t.id===+e}));t[e]=r.$$serialize(r,t[e])}));var r={from:S.timeStart,to:S.timeEnd,reservationNote:u.getParam("note"),title:S.reservationTitle,reservationUnitId:n.current.params.reservationUnitId,emailConfirmation:!!u.getParam("confirm"),repeatFrequency:u.getParam("freq"),repeatDuration:u.getParam("duration"),fields:t};return u.getParam("purchasePackageId")&&(r.purchasePackageId=+u.getParam("purchasePackageId")),P.saveWithPayment(S.center.id,S.user.id,r).catch((function(e){return o.error(e,"Failed to make reservation and payment.")}))},S.updatePurchase=function(e){return E.get(S.center.id,S.user.id,S.purchase.id).catch((function(e){return o.error(e,"Failed to get purchase.")})).then((function(e){S.purchase=e}))},S.back=function(){return u.setPath(u.getPath().replace(/\/purchases\/\d+$/,""))},S.staffHelp=function(){return E.createStaffHelp(S.center.id,n.current.params.userId,n.current.params.purchaseId).catch((function(e){return o.error(e,"Failed to create staff help.")})).then((function(e){return u.setParam("notice",e.notice),u.setPath(u.getPath()+"/staff-help")}))},S.hasRecurring=function(){return f.isAdmin()||!p.hideRecurringReservations}}])},wMt5:function(e,t){e.exports='<h1 class="page-title">{{state.getPageTitle()}}</h1> <simple-select-time center="$resolve.center" cal-data="$resolve.calData" reservation-prices="$resolve.reservationPrices" hide-recurring-reservations="$resolve.settings.hideRecurringReservations" reservation-fields="$resolve.reservationFields"></simple-select-time> '},wXwX:function(e,t){e.exports='<form class="sr-time" novalidate> <ff-board> <ff-panel class="sr-time-panel"> <ff-panel-header>{{$ctrl.date | date:\'longDate\'}}</ff-panel-header> <div class="sr-time-container"> <div class="ff-relative"> <time-selector class="ff-bmargin" date="$ctrl.date" time-start="$ctrl.timeStart" time-end="$ctrl.timeEnd" scale="$ctrl.reservationUnit.scale" buffer="$ctrl.reservationUnit.buffer" reservations="$ctrl.reservationUnit.reservations" availabilities="$ctrl.reservationUnit.availabilities"> </time-selector> <ff-info ng-if="!$ctrl.reservationUnit.availabilities.length && $ctrl.reservationUnit.whoCanReserve === \'staffOnly\'" class="staff-only" translate="RESERVATIONS.STAFF_ONLY" translate-values="{ centerName: $ctrl.center.name, centerPhone: $ctrl.center.phone, centerEmail: $ctrl.center.email }"> </ff-info> </div> <ff-textarea name="reservationNote" ff-maxlength="250" ff-model="$ctrl.reservationNote" rowspan="2" placeholder="{{\'RESERVATIONS.NOTES\' | translate}}" aria-label="{{\'RESERVATIONS.NOTES\' | translate}}"></ff-textarea> <label class="sr-time-email"> <ff-checkbox name="emailConfirmation" ff-model="$ctrl.emailConfirmation"> <span translate="RESERVATIONS.EMAIL_CONFIRMATION"></span> </ff-checkbox> </label> <div class="ff-grid ff-gutter-h" ng-if="$ctrl.hasRecurring()"> <label class="ff-row" flex="1 1 auto"> <ff-label flex="0 1 64px"> <span translate="RESERVATIONS.REPEAT_FREQUENCY"></span> </ff-label> <ff-select name="repeatFrequency" ff-model="$ctrl.repeatFrequency" ff-options="opt.name for opt in $ctrl.optsRepeatFrequency" ff-change="$ctrl.repeatDuration = $ctrl.repeatFrequency.repeatDurationOptions[0]"></ff-select> </label> <label class="ff-row" ng-if="$ctrl.repeatFrequency.repeatDurationOptions" flex="{md: \'0 1 200px\'}"> <ff-label flex="0 1 86px"> <span translate="RESERVATIONS.REPEAT_DURATION"></span> </ff-label> <ff-select name="repeatDuration" flex="0 1 50px" ff-model="$ctrl.repeatDuration" ff-options="opt for opt in $ctrl.repeatFrequency.repeatDurationOptions"></ff-select> <ff-label>{{$ctrl.repeatFrequency.repeatDurationFilter($ctrl.repeatDuration, true)}}</ff-label> </label> </div> <fd-field field="field" ng-repeat="field in $ctrl.reservationType.fields"></fd-field> </div> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="$ctrl.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> <ff-btn sense="next" type="submit" ff-disabled="!$ctrl.timeStart || !$ctrl.timeEnd || !$ctrl.reservationUnit.availabilities.length && $ctrl.reservationUnit.whoCanReserve === \'staffOnly\'" ff-click="$ctrl.next()"> <span translate="GLOBAL.BTN_NEXT"></span> </ff-btn> </ff-btn-group> </form> '},x3lI:function(e,t,r){},ypT5:function(e,t){e.exports='<div class="sr-date"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <ff-board> <ff-panel class="sr-date-panel"> <ff-datepicker ff-model="vm.selectedDate" date-min="vm.dateMin" date-disabled="vm.checkDateDisabled($date)"></ff-datepicker> </ff-panel> </ff-board> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="vm.back()"> <span translate="GLOBAL.BTN_BACK"></span> </ff-btn> <ff-btn sense="next" type="submit" ff-disabled="!vm.selectedDate" ff-click="vm.next()"> <span translate="GLOBAL.BTN_NEXT"></span> </ff-btn> </ff-btn-group> </div> '},zT5p:function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR"),r("Muwe"),r("y89P");t.default=angular.module("deskworks.SimpleReservationUserProfileCtrl",["ngRoute","deskworks.userProfile.service","deskworks.center.service","deskworks.routeHelper","deskworks.helper","deskworks.ReservationCost"]).controller("SimpleReservationUserProfileCtrl",["$scope","$filter","$timeout","$q","$route","$translate","dwAlerts","helper","state","userProfile","reg","userProfileService","centerService","purchaseService","ReservationCost",function(e,t,r,n,a,s,i,l,o,c,f,u,d,p,m){var g=this;g.reg=f,g.userProfile=c,g.schema=c.schema,o.setPageTitle(s.instant(g.reg.new?"USER_PROFILE.NEW_USER.PAGE_TITLE":"USER_PROFILE.PAGE_TITLE",{userName:g.userProfile.fullNameCompany})),u.bindTestUserGenerator(e,g.userProfile,g.reg),g.next=function(){if(!l.pointFirstInvalid("#userProfile")){t("toDate")(o.getParam("start")),t("toDate")(o.getParam("end"));return(g.reg.new?u.registerNewUser(0,g.userProfile):n.when()).then((function(){if(g.reg.new)return o.login(g.userProfile.login,g.userProfile.password).catch((function(e){return i.error(e,"Failed to login under created user.")}))})).then((function(){return m.calcAsync(a.current.params.centerId,g.userProfile.id,a.current.params.reservationUnitId,o.getParam("start"),o.getParam("end"))})).then((function(e){if(!e)return o.setPath(o.getPath()+"/confirm").then((function(){return n.reject()}))})).then((function(){var e=a.current.params.centerId,t=g.userProfile.id,r={reservationUnitId:a.current.params.reservationUnitId,reservationFrom:o.getParam("start"),reservationTo:o.getParam("end"),reservationRepeatFrequency:o.getParam("freq"),reservationRepeatDuration:o.getParam("duration")};return p.createPurchaseForReservation(e,t,r).catch((function(e){return i.error(e,"Failed to create purchase for reservation.")})).finally((function(){g.reg.new&&(o.replace(),a.updateParams({userId:g.userProfile.id}))}))})).then((function(e){return r((function(){return e.purchasePackageId&&o.setParam("purchasePackageId",e.purchasePackageId),o.setPath(o.getPath()+"/purchases/"+e.id)}))})).catch(angular.noop)}}}])}}]);