(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"1GpU":function(t,e,r){"use strict";r.r(e),e.default=angular.module("deskworks.FacturaOrder",["ngResource","deskworks.config"]).factory("FacturaOrder",["$resource","deskworksConfig",function(t,e){var r=t(e.getApiAbsUrl("/factura/orders/:orderId/:action"),{},{stamp:{method:"POST",isArray:!1,params:{action:"stamp"}},cancel:{method:"POST",isArray:!1,params:{action:"cancel"}}});return{get:function(t){var e=t.orderId;return r.get({orderId:e}).$promise},stamp:function(t){var e=t.orderId;return r.stamp({orderId:e},{}).$promise},cancel:function(t){var e=t.orderId;return r.cancel({orderId:e},{}).$promise}}}])},"7v6b":function(t,e,r){t.exports=r("M381")},"9EuJ":function(t,e,r){var n={"./order/factura-order.directive.js":"HFos","./order/factura-order.service.js":"1GpU","./settings/factura-settings.directive.js":"xDqT","./settings/factura-settings.service.js":"qgk1","./tax-id/factura-tax-id.directive.js":"iolw","./tax-id/factura-user.service.js":"Q1us"};function a(t){var e=s(t);return r(e)}function s(t){if(!r.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}a.keys=function(){return Object.keys(n)},a.resolve=s,t.exports=a,a.id="9EuJ"},DDl7:function(t,e,r){r("h2hn");var n=r("/ZBe").Object,a=t.exports=function(t,e,r){return n.defineProperty(t,e,r)};n.defineProperty.sham&&(a.sham=!0)},Ekwr:function(t,e,r){t.exports=r("MK67")},HFos:function(t,e,r){"use strict";r.r(e);r("3dw1");var n=r("03wM"),a=r.n(n),s=r("Ekwr"),f=r.n(s),c=r("lvz6"),o=r.n(c),l=r("yKah"),i=r.n(l),d=r("fzuT"),u=r.n(d),p=r("hsT8"),g=r.n(p),A=r("LBg+"),h=r.n(A),I=r("1GpU");function m(t,e){var r=a()(t);if(f.a){var n=f()(t);e&&(n=g()(n).call(n,(function(e){return o()(t,e).enumerable}))),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){u()(t,e,r[e])})):i.a?Object.defineProperties(t,i()(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,o()(r,e))}))}return t}e.default=angular.module("deskworks.facturaOrderDirective",["debounce",I.default.name]).directive("facturaOrder",(function(){return{template:h.a,restrict:"E",scope:!0,controller:"FacturaOrderCtrl as $ctrl",bindToController:{orderId:"<"}}})).controller("FacturaOrderCtrl",["$scope","$element","dwAlerts","debounce","helper","state","FacturaOrder",function(t,e,r,n,a,s,f){var c=this;c.$onInit=function(){c.load(),t.$on("purchase:update",(function(){return c.load()}))},c.load=function(){return f.get({orderId:c.orderId}).catch((function(t){return r.error(t,"Failed to load Factura order.")})).then((function(t){var e;c.order=t,c.purchases=g()(e=t.items).call(e,(function(t){return!t.method&&t.amount>0}))}))},c.stamp=function(){return f.stamp({orderId:c.orderId}).catch((function(t){return r.error(t,"Failed to stamp Factura order.")})).then((function(t){c.order=v(v({},c.order),t)}))},c.cancel=function(){return f.cancel({orderId:c.orderId}).catch((function(t){return r.error(t,"Failed to cancel Factura order.")})).then((function(t){c.order=v(v({},c.order),t)}))}}])},HGI2:function(t,e,r){r("BZMQ");var n=r("/ZBe");t.exports=n.Object.getOwnPropertySymbols},"LBg+":function(t,e){t.exports='<ff-panel ng-if="$ctrl.order && $ctrl.order.enabled" style="margin:1.5rem 0"> <ff-panel-header> <span translate="PURCHASE.FACTURA.HEADER"></span> </ff-panel-header> <div class="ff-grid" style="justify-content:stretch"> <ff-label flex="0 0 50px"><span translate="GLOBAL.STATUS"></span></ff-label> <ff-static flex="{ xs: \'1 0 120px\', sm: \'0 0 120px\' }" ng-if="!$ctrl.order.taxId"> <span> <span translate="PURCHASE.FACTURA.NO_TAX_ID"></span> <ff-hint hint-type="warning"> <span translate="PURCHASE.FACTURA.NO_TAX_ID.HINT"></span> </ff-hint> </span> </ff-static> <ff-static flex="{ xs: \'1 0 120px\', sm: \'0 0 120px\' }" ng-if="$ctrl.order.taxId"> <span ng-if="!$ctrl.order.items.length"> <span translate="PURCHASE.FACTURA.EMPTY"></span> <ff-hint><span translate="PURCHASE.FACTURA.EMPTY.HINT"></span></ff-hint> </span> <span ng-if="$ctrl.order.items.length && !$ctrl.purchases.length"> <span translate="PURCHASE.FACTURA.NO_CHARGES"></span> <ff-hint><span translate="PURCHASE.FACTURA.NO_CHARGES.HINT"></span></ff-hint> </span> <span ng-if="$ctrl.order.items.length && $ctrl.purchases.length && $ctrl.order.stampedAt && $ctrl.order.stampedAt >= $ctrl.order.updatedAt"> <span translate="PURCHASE.FACTURA.STAMPED"></span> </span> <span ng-if="$ctrl.order.items.length && $ctrl.purchases.length && ($ctrl.order.stampedAt < $ctrl.order.updatedAt)"> <span translate="PURCHASE.FACTURA.DIRTY"></span> <ff-hint hint-type="warning"><span translate="PURCHASE.FACTURA.DIRTY.HINT"></span></ff-hint> </span> <span ng-if="$ctrl.order.items.length && $ctrl.purchases.length && !$ctrl.order.stampedAt"> <span translate="PURCHASE.FACTURA.USTAMPED"></span> </span> </ff-static> <ff-static flex="none" ng-if="$ctrl.order.taxId && $ctrl.order.items.length && $ctrl.purchases.length"> <ff-btn sense="cancel" size="sm" ng-if="$ctrl.order.stampedAt >= $ctrl.order.updatedAt" ff-click="$ctrl.cancel()"> <span translate="PURCHASE.FACTURA.CANCEL"></span> </ff-btn> <ff-btn sense="ok" size="sm" ng-if="$ctrl.order.stampedAt < $ctrl.order.updatedAt" ff-click="$ctrl.stamp()"> <span translate="PURCHASE.FACTURA.RE_STAMP"></span> </ff-btn> <ff-btn sense="ok" size="sm" ng-if="!$ctrl.order.stampedAt" ff-click="$ctrl.stamp()"> <span translate="PURCHASE.FACTURA.STAMP"></span> </ff-btn> </ff-static> <ff-static flex="none" ng-if="$ctrl.order.taxId && $ctrl.order.items.length" ng-repeat="cfdi in $ctrl.order.cfdis"> <a href="/api/v1/factura/cfdis/{{cfdi.uid}}.pdf?centerId={{state.getCurrentCenterId()}}" target="_blank" rel="noopener"> <ff-icon sense="pdf"></ff-icon> <span translate="{{ \'PURCHASE.FACTURA.CFDI_TYPE.\' + cfdi.type.toUpperCase() }}"></span> </a> </ff-static> <ff-static flex="auto"></ff-static> </div> </ff-panel> '},LPPa:function(t,e,r){r("YpQb");var n=r("/ZBe");t.exports=n.Object.getOwnPropertyDescriptors},M381:function(t,e,r){var n=r("DDl7");t.exports=n},MK67:function(t,e,r){var n=r("HGI2");t.exports=n},Q1us:function(t,e,r){"use strict";r.r(e),e.default=angular.module("deskworks.FacturaUser",["ngResource","deskworks.config"]).factory("FacturaUser",["$resource","deskworksConfig",function(t,e){var r=t(e.getApiAbsUrl("/factura/users/:userId"),{},{get:{method:"GET"},update:{method:"PUT"}});return{get:function(t){var e=t.userId,n=t.centerId;return r.get({userId:e,centerId:n}).$promise},save:function(t){var e=t.userId,n=t.data;return r.update({userId:e},n).$promise}}}])},QPzo:function(t,e,r){var n=r("qqp4");t.exports=n},YpQb:function(t,e,r){var n=r("iddO"),a=r("loUa"),s=r("cJ2G"),f=r("Btbx"),c=r("3tq3"),o=r("i13M");n({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(t){for(var e,r,n=f(t),a=c.f,l=s(n),i={},d=0;l.length>d;)void 0!==(r=a(n,e=l[d++]))&&o(i,e,r);return i}})},cJ2G:function(t,e,r){var n=r("UkRz"),a=r("FkQy"),s=r("/ADo"),f=r("CvrR");t.exports=n("Reflect","ownKeys")||function(t){var e=a.f(f(t)),r=s.f;return r?e.concat(r(t)):e}},cc2Z:function(t,e,r){"use strict";r.r(e);var n=r("yCd9"),a=r.n(n),s=r("lRNC"),f=r.n(s),c=["$injector",function(t){var e,n,s=(e=r("9EuJ"),a()(n=f()(e).call(e)).call(n,e));t.loadNewModules(a()(s).call(s,(function(t){return t.default.name})))}];e.default=c},eMDo:function(t,e){t.exports='<ff-panel> <ff-panel-header> <span translate="INTEGRATIONS_SETUP.FACTURA.HEADER"></span> </ff-panel-header> <ff-spin ng-if="$ctrl.spin"></ff-spin> <form name="$ctrl.form" novalidate ff-dim="!$ctrl.settings"> <ff-static> <label class="ff-row"> <ff-checkbox name="enabled" ff-model="$ctrl.settings.enabled" ff-change="$ctrl.save()"> <span translate="INTEGRATIONS_SETUP.ENABLED"></span> </ff-checkbox> </label> </ff-static> <label class="ff-row"> <ff-label flex="0 0 120px" ff-required="{{$ctrl.settings.enabled}}"> <span translate="INTEGRATIONS_SETUP.FACTURA.BASE_URL"></span> </ff-label> <ff-text ff-model="$ctrl.settings.facturaBaseUrl" ff-change="$ctrl.save()" ff-required="$ctrl.settings.enabled" placeholder="https://factura.com" ff-validate-alert="{{\'INTEGRATIONS_SETUP.FACTURA.BASE_URL\' | translate}}"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 0 120px" ff-required="{{$ctrl.settings.enabled}}"> <span translate="INTEGRATIONS_SETUP.FACTURA.API_KEY"></span> </ff-label> <ff-text ff-model="$ctrl.settings.facturaApiKey" ff-change="$ctrl.save()" ff-required="$ctrl.settings.enabled" ff-validate-alert="{{\'INTEGRATIONS_SETUP.FACTURA.API_KEY\' | translate}}"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 0 120px" ff-required="{{$ctrl.settings.enabled}}"> <span translate="INTEGRATIONS_SETUP.FACTURA.SECRET_KEY"></span> </ff-label> <ff-text ff-model="$ctrl.settings.facturaSecretKey" ff-change="$ctrl.save()" ff-required="$ctrl.settings.enabled" ff-validate-alert="{{\'INTEGRATIONS_SETUP.FACTURA.SECRET_KEY\' | translate}}"></ff-text> </label> </form> </ff-panel> '},fzuT:function(t,e,r){var n=r("7v6b");t.exports=function(t,e,r){return e in t?n(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.default=t.exports,t.exports.__esModule=!0},h2hn:function(t,e,r){var n=r("iddO"),a=r("loUa");n({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperty:r("UkIg").f})},iDDw:function(t,e,r){var n=r("LPPa");t.exports=n},iolw:function(t,e,r){"use strict";r.r(e);r("JBxO"),r("FdtR");var n=r("tP+D"),a=r.n(n),s=r("Q1us");e.default=angular.module("deskworks.facturaTaxIdDirective",["debounce",s.default.name]).directive("facturaTaxId",(function(){return{template:a.a,restrict:"E",scope:!0,controller:"FacturaTaxIdCtrl as $ctrl",bindToController:{userId:"<",noHeader:"<"}}})).controller("FacturaTaxIdCtrl",["$element","dwAlerts","debounce","helper","state","FacturaUser",function(t,e,r,n,a,s){var f=this;f.$onInit=function(){f.load()},f.load=function(){return s.get({userId:f.userId,centerId:a.getCurrentCenterId()}).catch((function(t){return e.error(t,"Failed to load Factura user settings.")})).then((function(t){f.settings=t}))},f.save=r((function(){if(n.pointFirstInvalid(t))return;return f.spin=!0,s.save({userId:f.userId,data:f.settings}).catch((function(t){return e.error(t,"Failed to save Factura user settings.")})).finally((function(){f.spin=!1}))}),1e3)}])},lvz6:function(t,e,r){t.exports=r("QPzo")},qgk1:function(t,e,r){"use strict";r.r(e),e.default=angular.module("deskworks.FacturaSettings",["ngResource","deskworks.config"]).factory("FacturaSettings",["$resource","deskworksConfig",function(t,e){var r=t(e.getApiAbsUrl("/factura/centers/:centerId"),{},{get:{method:"GET"},update:{method:"PUT"}});return{get:function(t){var e=t.centerId;return r.get({centerId:e}).$promise},save:function(t){var e=t.centerId,n=t.data;return r.update({centerId:e},n).$promise}}}])},qqp4:function(t,e,r){r("zzoj");var n=r("/ZBe").Object,a=t.exports=function(t,e){return n.getOwnPropertyDescriptor(t,e)};n.getOwnPropertyDescriptor.sham&&(a.sham=!0)},"tP+D":function(t,e){t.exports='<ff-panel ng-if="$ctrl.settings && $ctrl.settings.enabled && !$ctrl.noHeader"> <ff-header> <span translate="GLOBAL.TAX_ID"></span> </ff-header> <ff-spin ng-if="$ctrl.spin"></ff-spin> <ff-text ff-model="$ctrl.settings.taxId" ff-change="$ctrl.save()" ff-required="true" placeholder="AAA010101AAA" ff-validate-alert="{{\'GLOBAL.TAX_ID\' | translate}}"></ff-text> </ff-panel> <ff-panel ng-if="$ctrl.settings && $ctrl.settings.enabled && $ctrl.noHeader"> <ff-spin ng-if="$ctrl.spin"></ff-spin> <label class="ff-row"> <ff-label flex="0 1 60px"><req translate="GLOBAL.TAX_ID"></req></ff-label> <ff-text ff-model="$ctrl.settings.taxId" ff-change="$ctrl.save()" ff-required="true" placeholder="AAA010101AAA" ff-validate-alert="{{\'GLOBAL.TAX_ID\' | translate}}"></ff-text> </label> </ff-panel> '},xDqT:function(t,e,r){"use strict";r.r(e);r("JBxO"),r("FdtR");var n=r("eMDo"),a=r.n(n),s=r("qgk1");e.default=angular.module("deskworks.facturaSettingsDirective",["debounce",s.default.name]).directive("facturaSettings",(function(){return{template:a.a,restrict:"E",scope:!0,controller:"FacturaSettingsCtrl as $ctrl"}})).controller("FacturaSettingsCtrl",["dwAlerts","debounce","helper","state","FacturaSettings",function(t,e,r,n,a){var s=this;s.$onInit=function(){s.load()},s.load=function(){return a.get({centerId:n.getCurrentCenterId()}).catch((function(e){return t.error(e,"Failed to load Factura center settings.")})).then((function(t){s.settings=t}))},s.save=e((function(){if(r.pointFirstInvalid("factura-settings"))return;return s.spin=!0,a.save({centerId:n.getCurrentCenterId(),data:s.settings}).catch((function(e){return t.error(e,"Failed to save Factura center settings.")})).finally((function(){s.spin=!1}))}),1e3)}])},yKah:function(t,e,r){t.exports=r("iDDw")},zzoj:function(t,e,r){var n=r("iddO"),a=r("wkvk"),s=r("Btbx"),f=r("3tq3").f,c=r("loUa"),o=a((function(){f(1)}));n({target:"Object",stat:!0,forced:!c||o,sham:!c},{getOwnPropertyDescriptor:function(t,e){return f(s(t),e)}})}}]);