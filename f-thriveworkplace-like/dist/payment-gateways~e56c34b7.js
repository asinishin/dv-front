(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"+ZZM":function(e,t,r){var a={"./gateways/gateway-edit.controller.js":"cyhy","./gateways/gateways.controller.js":"rcyg","./services/payment-center.service.js":"0uo4","./services/payment-gateway.service.js":"eyCE","./services/payment-processor.service.js":"fYgO"};function f(e){var t=n(e);return r(t)}function n(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}f.keys=function(){return Object.keys(a)},f.resolve=n,e.exports=f,f.id="+ZZM"},"0uo4":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.PaymentCenter",["ngResource","deskworks.config"]).factory("PaymentCenter",["$resource","deskworksConfig",function(e,t){var r=e(t.getApiAbsUrl("/payments/centers/:id"),{},{query:{method:"GET",isArray:!0},update:{method:"PUT"}});return{query:function(e){return r.query(e).$promise},save:function(e){return r.update({id:e.id},e).$promise}}}])},MZew:function(e,t,r){var a={"./gateways/gateway-edit.tpl.html":"jVJa","./gateways/gateways.tpl.html":"NfT1"};function f(e){var t=n(e);return r(t)}function n(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}f.keys=function(){return Object.keys(a)},f.resolve=n,e.exports=f,f.id="MZew"},NfT1:function(e,t){e.exports='<form name="$ctrl.form" novalidate ff-bulk-read-only> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="ff-grid gutter-v gutter-h"> <ff-panel flex="{md: \'0 0 50%\'}" ng-if="!$ctrl.processor"> <ff-spin class="ff-spin-placeholder"></ff-spin> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}" ng-if="$ctrl.processor"> <ff-header>{{$ctrl.processor.name || \'Payment Processor\'}}</ff-header> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.CURRENCY"></req></ff-label> <ff-select flex="auto" name="currency" ff-model="$ctrl.processor.currency" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.CURRENCY\' | translate}}" ff-options="curr for curr in $ctrl.currencies"></ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.BASE_URL"></req></ff-label> <ff-text flex="1 1 290px" name="baseUrl" ff-model="$ctrl.processor.settings.baseUrl" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.BASE_URL\' | translate}}" placeholder="https://test.oppwa.com"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.ACCESS_TOKEN"></req></ff-label> <ff-text flex="1 1 290px" name="accessToken" ff-model="$ctrl.processor.settings.accessToken" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.ACCESS_TOKEN\' | translate}}"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.ENTITY_ID"></req></ff-label> <ff-text flex="1 1 290px" name="entityId" ff-model="$ctrl.processor.settings.entityId" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.ENTITY_ID\' | translate}}"></ff-text> </label> </ff-panel> <ff-btn-group> <ff-btn sense="save" ff-click="$ctrl.save()"><span translate="GLOBAL.BTN_SAVE"></span></ff-btn> </ff-btn-group> </div> </form> '},"a/TE":function(e,t,r){"use strict";r.r(t);r("3dw1"),r("Muwe"),r("y89P");var a=r("yCd9"),f=r.n(a),n=r("lRNC"),l=r.n(n),s=["$injector",function(e){var t,a,n=(t=r("+ZZM"),f()(a=l()(t).call(t)).call(a,t));e.loadNewModules(f()(n).call(n,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var t=r("MZew");l()(t).call(t).forEach((function(r){return e.put(r.replace(/^\.\//,""),t(r))}))}])}];t.default=s},cyhy:function(e,t,r){"use strict";r.r(t);var a=r("nbuU"),f=r.n(a),n=r("eyCE"),l=r("fYgO");t.default=angular.module("deskworks.PaymentGatewayEditCtrl",[n.default.name,l.default.name,"deskworks.optsTimezone"]).controller("PaymentGatewayEditCtrl",["$scope","$window","$translate","$route","$q","$filter","$locale","dwAlerts","state","helper","PaymentProcessor","PaymentGateway","optsTimezone",function(e,t,r,a,n,l,s,o,c,i,u,d,p){var m=this;c.setPageTitle(r.instant("PAYMENT_GATEWAYS.EDIT.PAGE_TITLE")),m.onInit=function(){m.optsTimezone=p,m.currencies=["USD","GBP","EUR","CAD","MXN","ZAR"],m.fetchProcessors(),"new"===a.current.params.id?m.gateway={settings:{}}:m.fetchGateways()},m.fetchProcessors=function(){return u.query().catch((function(e){return o.error(e,"Failed to query payment processors.")})).then((function(e){m.processors=e,"new"===a.current.params.id&&(m.gateway.processorId=m.processors[0]&&m.processors[0].id,m.gateway.settings.baseUrl="https://test.oppwa.com",m.gateway.cutOffTime=l("toDate")("23:45"),m.gateway.currency=m.currencies[0])}))},m.fetchGateways=function(){return d.query().catch((function(e){return o.error(e,"Failed to query payment gateways.")})).then((function(e){m.gateway=f()(e).call(e,(function(e){return e.id===+a.current.params.id}))}))},m.save=function(){if(!i.pointFirstInvalid('form[name="$ctrl.form"]'))return d.save(m.gateway).catch((function(e){return o.error(e,"Failed to save payment gateway.")})).then((function(){if("new"===a.current.params.id)return c.setPath("/payment-gateways/".concat(m.gateway.id));m.form.$setPristine()}))},m.delete=function(){if(t.confirm(r.instant("PAYMENT_GATEWAYS.CONFIRM_DELETE")))return d.delete({id:m.gateway.id}).catch((function(e){return o.error(e,"Failed to delete payment gateway.")})).then((function(){return c.setPath("/payment-gateways")}))},m.back=function(){return c.setPath("/payment-gateways")},m.onInit()}])},eyCE:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.PaymentGateway",["ngResource","deskworks.config","datesDeserializer"]).factory("PaymentGateway",["$resource","$filter","deskworksConfig","datesDeserializer",function(e,t,r,a){var f=a(["cutOffTime"]),n=e(r.getApiAbsUrl("/payments/gateways/:id"),{},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,f]},update:{method:"PUT"}});return{query:function(e){return n.query(e).$promise},save:function(e){var r=angular.copy(e);return r.cutOffTime=t("date")(r.cutOffTime,"HH:mm"),e.id?n.update({id:e.id},r).$promise:n.save(r).$promise.then((function(t){e.id=t.id}))},delete:function(e){return n.delete(e).$promise}}}])},fYgO:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.PaymentProcessor",["ngResource","deskworks.config"]).factory("PaymentProcessor",["$resource","deskworksConfig",function(e,t){var r=e(t.getApiAbsUrl("/payments/processor"),{},{update:{method:"PUT"}});return{get:function(){return r.get().$promise},save:function(e){var t=e.id,a=e.currency,f=e.settings;return r.update({},{id:t,currency:a,settings:f}).$promise}}}])},jVJa:function(e,t){e.exports='<form name="$ctrl.form" novalidate ff-bulk-read-only> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="ff-grid gutter-h gutter-v"> <ff-panel flex="{md: \'0 0 50%\'}"> <label class="ff-row"> <ff-label flex="0 1 110px"><req translate="PAYMENT_GATEWAYS.NAME"></req></ff-label> <ff-text flex="1 1 290px" name="name" ff-model="$ctrl.gateway.name" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.NAME\' | translate}}"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 1 110px"><req translate="PAYMENT_GATEWAYS.TIMEZONE"></req></ff-label> <ff-select flex="1 1 290px" name="timezone" ff-model="$ctrl.gateway.timezone" ff-options="tz.iana as tz.name for tz in $ctrl.optsTimezone" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.TIMEZONE\' | translate}}"></ff-select> </label> <div class="ff-row"> <label class="ff-row" flex="0 0 190px"> <ff-label flex="0 0 110px"><req translate="PAYMENT_GATEWAYS.CUT_OFF_TIME"></req></ff-label> <ff-time flex="auto" name="cutOffTime" ff-model="$ctrl.gateway.cutOffTime" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.CUT_OFF_TIME\' | translate}}"></ff-time> </label> <ff-static flex="auto"></ff-static> <label class="ff-row" flex="0 0 140px"> <ff-label flex="0 0 80px"><req translate="PAYMENT_GATEWAYS.CURRENCY"></req></ff-label> <ff-select flex="auto" name="currency" ff-model="$ctrl.gateway.currency" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.CURRENCY\' | translate}}" ff-options="curr for curr in $ctrl.currencies"></ff-select> </label> </div> <label class="ff-row"> <ff-label flex="0 1 110px"><span translate="PAYMENT_GATEWAYS.NOTES"></span></ff-label> <ff-text flex="1 1 290px" name="notes" ff-model="$ctrl.gateway.notes"></ff-text> </label> </ff-panel> <ff-panel flex="{md: \'0 0 50%\'}"> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.PROCESSOR"></req></ff-label> <ff-select flex="1 1 290px" name="processor" ff-model="$ctrl.gateway.processorId" ff-options="p.id as p.name for p in $ctrl.processors" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.PROCESSOR\' | translate}}"></ff-select> </label> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.BASE_URL"></req></ff-label> <ff-text flex="1 1 290px" name="baseUrl" ff-model="$ctrl.gateway.settings.baseUrl" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.BASE_URL\' | translate}}" placeholder="https://test.oppwa.com"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.ACCESS_TOKEN"></req></ff-label> <ff-text flex="1 1 290px" name="accessToken" ff-model="$ctrl.gateway.settings.accessToken" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.ACCESS_TOKEN\' | translate}}"></ff-text> </label> <label class="ff-row"> <ff-label flex="0 1 120px"><req translate="PAYMENT_GATEWAYS.ENTITY_ID"></req></ff-label> <ff-text flex="1 1 290px" name="entityId" ff-model="$ctrl.gateway.settings.entityId" ff-required="true" ff-validate-alert="{{\'PAYMENT_GATEWAYS.ENTITY_ID\' | translate}}"></ff-text> </label> </ff-panel> <ff-btn-group> <ff-btn sense="save" type="submit" ff-click="$ctrl.save()" ff-disabled="$ctrl.form.$pristine"> <span translate="GLOBAL.BTN_SAVE"></span> </ff-btn> <ff-btn sense="delete" ff-click="$ctrl.delete()" ng-if="$ctrl.bank.id !== \'new\'"> <span translate="GLOBAL.BTN_DELETE"></span> </ff-btn> <ff-btn sense="back" ff-click="$ctrl.back()"><span translate="GLOBAL.BTN_BACK"></span></ff-btn> </ff-btn-group> </div> </form> '},rcyg:function(e,t,r){"use strict";r.r(t);var a=r("+l1P"),f=r("eyCE"),n=r("fYgO"),l=r("0uo4");t.default=angular.module("deskworks.PaymentGatewaysCtrl",["autoSave",a.a.name,f.default.name,n.default.name,l.default.name]).controller("PaymentGatewaysCtrl",["$scope","$translate","$q","dwAlerts","state","helper","autoSave","PaymentGateway","PaymentProcessor","PaymentCenter",function(e,t,r,a,f,n,l,s,o,c){var i=this;f.setPageTitle(t.instant("PAYMENT_GATEWAYS.PAGE_TITLE")),i.onInit=function(){i.currencies=["USD","GBP","EUR","CAD","MXN","ZAR"],i.fetch()},i.fetchProcessor=function(){return o.get().catch((function(e){return a.error(e,"Failed to get payment processor.")})).then((function(e){i.processor=e}))},i.fetch=function(){return r.all([i.fetchProcessor()])},i.save=function(){if(!n.pointFirstInvalid('form[name="$ctrl.form"]'))return o.save(i.processor).catch((function(e){return a.error(e,"Failed to save payment processor.")})).then((function(){i.form.$setPristine()}))},i.onInit()}])}}]);