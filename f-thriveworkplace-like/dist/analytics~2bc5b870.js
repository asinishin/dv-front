(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"/MEN":function(t,e,a){},"1KV+":function(t,e,a){"use strict";a.r(e);var n=a("YtL8"),r=a.n(n),o=a("yCd9"),i=a.n(o),l=a("WSeP"),s=a.n(l),c=a("nbuU"),d=a.n(c),u=a("Xp5u");e.default=angular.module("deskworks.AnalyticsSales",["ngResource","datesDeserializer","deskworks.config",u.a.name]).factory("AnalyticsSales",["$resource","$filter","$timeout","datesDeserializer","deskworksConfig","helper","optsChartByPeriod",function(t,e,a,n,o,l,c){var u=n(["periods.from","periods.to"]),f=t(o.getApiAbsUrl("/analytics/sales"),{byPeriod:"@byPeriod",from:"@from",to:"@to"},{get:{method:"GET",isArray:!1,transformResponse:[angular.fromJson,u]}});return{get:function(t){return f.get({centerId:t.centerId||null,byPeriod:t.byPeriod||"month",from:e("date")(t.from,"yyyy-MM-dd"),to:e("date")(t.to,"yyyy-MM-dd")}).$promise.then((function(e){return function(t){var e,a,n,o=t.data,u=t.params.byPeriod,f=void 0===u?"month":u,p=d()(c).call(c,(function(t){return t.id===f}));return s()(e=o.periods).call(e,(function(t){t.title=p.format(t.from,t.to)})),o.totals=i()(a=o.periods).call(a,(function(t,e){var a;return l.round(r()(a=o.data).call(a,(function(t,a){return t+a.totals[e]}),0))})),s()(n=o.data).call(n,(function(t){var e;t.total=l.round(r()(e=t.totals).call(e,(function(t,e){return t+e}),0))})),o}({data:e,params:t})}))}}}])},"1LnZ":function(t,e,a){var n={"./dashboard/analytics-dashboard.controller.js":"Dc08","./dashboard/analytics-user.service.js":"RlMt","./widgets/analytics-widget.directive.js":"1e+P","./widgets/analytics-widgets-list.service.js":"Xh+F","./widgets/income/analytics-income-chart.service.js":"O7bB","./widgets/income/analytics-income.directive.js":"p5aI","./widgets/income/analytics-income.service.js":"2Bp7","./widgets/occupancy-vacancy/analytics-occupancy-vacancy-chart-units.service.js":"9pnN","./widgets/occupancy-vacancy/analytics-occupancy-vacancy-chart.service.js":"oCA5","./widgets/occupancy-vacancy/analytics-occupancy-vacancy.directive.js":"qLGz","./widgets/occupancy-vacancy/analytics-occupancy-vacancy.service.js":"G6gN","./widgets/sales/analytics-sales-chart.service.js":"DbU7","./widgets/sales/analytics-sales.directive.js":"4uyB","./widgets/sales/analytics-sales.service.js":"1KV+"};function r(t){var e=o(t);return a(e)}function o(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=o,t.exports=r,r.id="1LnZ"},"1e+P":function(t,e,a){"use strict";a.r(e);var n=a("WSeP"),r=a.n(n),o=a("nbuU"),i=a.n(o),l=(a("KOgG"),a("r970")),s=a.n(l),c=a("Xh+F");e.default=angular.module("deskworks.analyticsWidgetDirective",[c.default.name]).directive("analyticsWidget",(function(){return{template:s.a,restrict:"E",scope:!0,controller:"AnalyticsWidgetDirectiveCtrl as $w",bindToController:{widget:"<",centerId:"@"},link:function(t,e){e.addClass("analytics-widget")}}})).controller("AnalyticsWidgetDirectiveCtrl",["$scope","$element","$window","$compile","state","dwAlerts","helper","analyticsWidgetsList",function(t,e,a,n,o,l,s,c){var d=this;d.$onInit=function(){t.$watch("$w.widget.wide",(function(){e.toggleClass("analytics-widget-wide",!!d.widget.wide)}))},d.$onChanges=function(){if(d.widget){if(d.config=i()(c).call(c,(function(t){return t.uid===d.widget.uid})),!d.config)return void e.css("display","none");var a=angular.element(e[0].querySelector(".analytics-widget-body")),o=angular.element(d.config.template);o.attr("params","$w.widget"),o.attr("center-id",d.centerId),r()(angular).call(angular,a.children(),(function(t){return t.remove()})),a.append(o),n(o)(t.$new())}},d.onDragStart=function(t){var e=s.findParentElement(t.target,(function(t){return void 0!==t.attr("dnd-list")}));e.toggleClass("analytics-wide-placeholder",!!d.widget.wide),e.toggleClass("analytics-dragging",!0)},d.onDragEnd=function(t){s.findParentElement(t.target,(function(t){return void 0!==t.attr("dnd-list")})).toggleClass("analytics-dragging",!1)}}])},"2Bp7":function(t,e,a){"use strict";a.r(e);var n=a("WSeP"),r=a.n(n),o=a("nbuU"),i=a.n(o),l=a("Xp5u");e.default=angular.module("deskworks.AnalyticsIncome",["ngResource","datesDeserializer","deskworks.config",l.a.name]).factory("AnalyticsIncome",["$resource","$filter","$timeout","datesDeserializer","deskworksConfig","helper","optsChartByPeriod",function(t,e,a,n,o,l,s){var c=n(["periods.from","periods.to"]),d=t(o.getApiAbsUrl("/analytics/income"),{byPeriod:"@byPeriod",from:"@from",to:"@to"},{get:{method:"GET",isArray:!1,transformResponse:[angular.fromJson,c]}});return{get:function(t){return d.get({centerId:t.centerId||null,byPeriod:t.byPeriod||"month",from:e("date")(t.from,"yyyy-MM-dd")||null,to:e("date")(t.to,"yyyy-MM-dd")||null}).$promise.then((function(e){return function(t){var e,a=t.data,n=t.params.byPeriod,o=void 0===n?"month":n,l=i()(s).call(s,(function(t){return t.id===o}));return r()(e=a.periods).call(e,(function(t){t.title=l.format(t.from,t.to)})),a}({data:e,params:t})}))}}}])},"2R0e":function(t,e){t.exports='<label class=ff-row style=min-width:130px> <ff-label flex=none><span translate=CHARTS.BY_PERIOD></span></ff-label> <ff-select ff-model=$ctrl.period ff-options="opt.id as opt.name for opt in $ctrl.optsPeriod"></ff-select> </label> '},"4uyB":function(t,e,a){"use strict";a.r(e);a("JBxO"),a("FdtR");var n=a("Tfwl"),r=a.n(n),o=a("XAgg"),i=a.n(o),l=a("yKah"),s=a.n(l),c=a("WSeP"),d=a.n(c),u=a("lvz6"),f=a.n(u),p=a("hsT8"),m=a.n(p),g=a("Ekwr"),y=a.n(g),h=a("03wM"),b=a.n(h),v=a("fzuT"),C=a.n(v),w=a("RnuU"),$=a.n(w),k=a("CLLE"),A=a("G6E5"),P=a("1KV+"),T=a("Xp5u"),I=a("CgoQ"),O=a("DbU7"),x=a("DcLO"),R=a("OOrm");function S(t,e){var a=b()(t);if(y.a){var n=y()(t);e&&(n=m()(n).call(n,(function(e){return f()(t,e).enumerable}))),a.push.apply(a,n)}return a}function E(t){for(var e=1;e<arguments.length;e++){var a,n=null!=arguments[e]?arguments[e]:{};if(e%2)d()(a=S(Object(n),!0)).call(a,(function(e){C()(t,e,n[e])}));else if(s.a)i()(t,s()(n));else{var o;d()(o=S(Object(n))).call(o,(function(e){r()(t,e,f()(n,e))}))}}return t}e.default=angular.module("deskworks.analyticsSalesDirective",["debounce",k.a.name,A.a.name,P.default.name,T.a.name,I.a.name,O.default.name,x.a.name,R.a.name]).directive("analyticsSales",(function(){return{template:$.a,restrict:"E",scope:!0,controller:"AnalyticsSalesDirectiveCtrl as $ctrl",bindToController:{params:"<",centerId:"<"}}})).controller("AnalyticsSalesDirectiveCtrl",["$scope","$q","state","dwAlerts","helper","debounce","reportHelper","AnalyticsSales","analyticsSalesChart","optsChartByPeriod","optsChartPeriod",function(t,e,a,n,r,o,i,l,s,c,d){var u=this,f=i.paramsChanged;u.optsByPeriod=c,u.optsPeriod=d,u.data=null,u.$onInit=function(){t.$watch((function(){return E(E({},u.params),{},{centerId:u.centerId})}),o((function(t,a){u.params.period=u.params.period||"12months",u.params.byPeriod=u.params.byPeriod||"month",u.widgetToolbarForm.$invalid||(f(t,a,["centerId","from","to","byPeriod"])&&(u.data=null),u.data=u.data||(u.spin=!0,l.get(t).catch((function(t){return n.error(t,"Failed to get Sales widget data.")})).finally((function(){u.spin=!1}))),e.all({data:u.data}).then((function(t){u.data=t.data})).then((function(){u.chart=s(E(E({},u.data),{},{params:u.params}))})))}),100),!0)}}])},"9pnN":function(t,e,a){"use strict";a.r(e);var n=a("6RpP"),r=a.n(n),o=a("yCd9"),i=a.n(o),l=a("G6E5"),s=a("aGVL"),c=a("bU+R"),d=a.n(c);e.default=angular.module("deskworks.analyticsOccupancyVacancyChartUnits",[l.a.name,s.a.name]).factory("analyticsOccupancyVacancyChartUnits",["$filter","$translate","chartColors","reportHelper",function(t,e,a,n){return function(t){var e,n=t.periods,o=t.data,l=t.params,s=i()(n).call(n,(function(t){return t.title})),c=i()(e=o[l.selected].units).call(e,(function(t,e){return{label:t.name,data:t.totals,maxBarThickness:80,backgroundColor:a[e]}}));return{type:"bar",plugins:[d.a],data:{labels:s,datasets:c},options:{plugins:{datalabels:{display:"auto",color:"#fff",backgroundColor:"#000",padding:1,borderRadius:3,formatter:function(t,e){return"".concat(Math.round(t),"%")}}},tooltips:{mode:"index",intersect:!0,displayColors:!0,callbacks:{label:function(t){var e,a=o[l.selected].units[t.datasetIndex],n=a.name,i=a.totals;return r()(e="".concat(n,": ")).call(e,i[t.index],"%")}}},layout:{padding:{top:15}},legend:{display:!0,position:l.wide?"right":"bottom"},scales:{yAxes:[{ticks:{min:0,max:100,callback:function(t){return"".concat(t,"%")}}}]}}}}}])},C5yw:function(t,e,a){var n={"./dashboard/analytics-dashboard.tpl.html":"aOtR","./widgets/analytics-widget-base.tpl.html":"RnuU","./widgets/analytics-widget.tpl.html":"r970","./widgets/occupancy-vacancy/analytics-occupancy-vacancy.tpl.html":"jwnm"};function r(t){var e=o(t);return a(e)}function o(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=o,t.exports=r,r.id="C5yw"},CLLE:function(t,e,a){"use strict";var n=a("Tfwl"),r=a.n(n),o=a("XAgg"),i=a.n(o),l=a("yKah"),s=a.n(l),c=a("WSeP"),d=a.n(c),u=a("lvz6"),f=a.n(u),p=a("hsT8"),m=a.n(p),g=a("Ekwr"),y=a.n(g),h=a("03wM"),b=a.n(h),v=a("ipr/"),C=a.n(v),w=a("yCd9"),$=a.n(w),k=a("fzuT"),A=a.n(k),P=(a("S2gh"),a("bG+q"),a("pl6f")),T=a("aGVL"),I=a("bU+R"),O=a.n(I);function x(t,e){var a=b()(t);if(y.a){var n=y()(t);e&&(n=m()(n).call(n,(function(e){return f()(t,e).enumerable}))),a.push.apply(a,n)}return a}function R(t){for(var e=1;e<arguments.length;e++){var a,n=null!=arguments[e]?arguments[e]:{};if(e%2)d()(a=x(Object(n),!0)).call(a,(function(e){A()(t,e,n[e])}));else if(s.a)i()(t,s()(n));else{var o;d()(o=x(Object(n))).call(o,(function(e){r()(t,e,f()(n,e))}))}}return t}e.a=angular.module("chartDirective",["deskworks.helper",P.a.name,T.a.name]).directive("chart",["$window","systemColors",function(t,e){return t.Chart.defaults.global.legend.labels.boxWidth=12,t.Chart.defaults.global.tooltips.cornerRadius=3,t.Chart.defaults.global.tooltips.displayColors=!1,t.Chart.defaults.global.tooltips.backgroundColor="rgba(0,0,0,0.65)",t.Chart.defaults.global.elements.rectangle.borderWidth=1,t.Chart.defaults.global.elements.rectangle.backgroundColor=e.primary,t.Chart.defaults.global.elements.arc.borderWidth=1,t.Chart.plugins.unregister(O.a),{restrict:"E",scope:!0,controller:"ChartCtrl as $ctrl",bindToController:{type:"@chartType",labels:"<chartLabels",data:"<chartData",options:"<chartOptions",config:"<"},template:"<canvas></canvas>"}}]).controller("ChartCtrl",["$scope","$element","$window","chartColors",function(t,e,a,n){var r,o=this,i={maintainAspectRatio:!1},l={backgroundColor:n,hoverBorderWidth:2,hoverBorderColor:"#fff"};o.$onDestroy=function(){r&&r.destroy()},o.$onChanges=function(t){var n;if(o.config){var s;r&&r.destroy();var c=R({},o.config);return c.options=R(R({},c.options),i),c.data=R({},c.data),c.data.datasets=$()(s=c.data.datasets).call(s,(function(t){return R(R({},l),t)})),void(r=new a.Chart(e.children(),c))}if(o.options){var d={labels:o.labels,datasets:C()(n=o.data).call(n)};d.datasets[0]=angular.extend({},l,d.datasets[0]),!r||t.type&&t.type.currentValue!==t.type.previousValue?(r&&r.destroy(),r=new a.Chart(e.children(),{type:o.type,data:d,options:angular.extend({},i,o.options)})):(angular.extend(r.data,d),angular.extend(r.options,i,o.options),r.update())}}}])},CgoQ:function(t,e,a){"use strict";var n=a("WSeP"),r=a.n(n);e.a=angular.module("deskworks.optsChartPeriod",[]).factory("optsChartPeriod",["$rootScope","$translate",function(t,e){var a=[{id:"lastMonth",_name:"CHARTS.PERIOD.LAST_MONTH",from:function(){return moment().subtract(1,"month").startOf("month")},to:function(){return moment().subtract(1,"month").endOf("month")}},{id:"thisMonth",_name:"CHARTS.PERIOD.THIS_MONTH",from:function(){return moment().startOf("month")},to:function(){return moment().endOf("month")}},{id:"12months",_name:"CHARTS.PERIOD.12_MONTHS",from:function(){return moment().subtract(12,"month")},to:function(){return moment()}},{id:"lastYear",_name:"CHARTS.PERIOD.LAST_YEAR",from:function(){return moment().subtract(1,"year").startOf("year")},to:function(){return moment().subtract(1,"year").endOf("year")}},{id:"thisYear",_name:"CHARTS.PERIOD.THIS_YEAR",from:function(){return moment().startOf("year")},to:function(){return moment().endOf("year")}},{id:"allTime",_name:"CHARTS.PERIOD.ALL_TIME",from:function(){return null},to:function(){return null}},{id:"custom",_name:"CHARTS.PERIOD.CUSTOM",from:function(){return moment().subtract(1,"month").startOf("month")},to:function(){return moment().subtract(1,"month").endOf("month")}}];function n(){r()(a).call(a,(function(t){t.name=e.instant(t._name)}))}return n(),t.$on("$setTranslationsSuccess",n),a}])},DLeD:function(t,e,a){"use strict";a.r(e);a("Muwe"),a("y89P");var n=a("WSeP"),r=a.n(n),o=a("lRNC"),i=a.n(o),l=a("yCd9"),s=a.n(l),c=["$injector",function(t){var e,n,o=(e=a("1LnZ"),s()(n=i()(e).call(e)).call(n,e));t.loadNewModules(s()(o).call(o,(function(t){return t.default.name}))),t.invoke(["$templateCache",function(t){var e,n=a("C5yw");r()(e=i()(n).call(n)).call(e,(function(e){return t.put(e.replace(/^\.\//,""),n(e))}))}])}];e.default=c},DbU7:function(t,e,a){"use strict";a.r(e);var n=a("6RpP"),r=a.n(n),o=a("yCd9"),i=a.n(o),l=a("G6E5"),s=a("aGVL"),c=a("bU+R"),d=a.n(c);e.default=angular.module("deskworks.analyticsSalesChart",[l.a.name,s.a.name]).factory("analyticsSalesChart",["$filter","$translate","chartColors","reportHelper",function(t,e,a,n){return function(n){var o,l=n.periods,s=n.data,c=n.totals,u=n.params,f=i()(l).call(l,(function(t){return t.title})),p=r()(o=i()(s).call(s,(function(t,e){return{label:t.name,data:t.totals,backgroundColor:a[e],maxBarThickness:80}}))).call(o,[{label:e.instant("GLOBAL.TOTAL"),data:i()(c).call(c,(function(t){return 0})),backgroundColor:"transparent",maxBarThickness:80,datalabels:{display:!0,align:"end",offset:-3,color:"#fff",backgroundColor:"#000",padding:1,borderRadius:3,font:{weight:"bold"}}}]);return{type:"bar",plugins:[d.a],data:{labels:f,datasets:p},options:{plugins:{datalabels:{display:"auto",color:"#fff",backgroundColor:"#000",padding:1,borderRadius:3,formatter:function(e,a){return t("ncurrency")(a.datasetIndex<p.length-1?e:c[a.dataIndex],void 0,0)}}},tooltips:{mode:"index",intersect:!0,displayColors:!0,callbacks:{label:function(e,a){var n=a.datasets[e.datasetIndex];return n.label+": "+t("ncurrency")(e.datasetIndex<p.length-1?n.data[e.index]:c[e.index])}}},layout:{padding:{top:15}},legend:{display:!0,position:u.wide?"right":"bottom"},scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{callback:function(e){return t("ncurrency")(e,void 0,0)}}}]}}}}}])},Dc08:function(t,e,a){"use strict";a.r(e);a("va6R");var n=a("I5Zy"),r=a("jd5N"),o=a("1e+P"),i=a("Xh+F"),l=a("RlMt");e.default=angular.module("deskworks.AnalyticsDashboardCtrl",["deskworks.state","session",n.a.name,r.a.name,o.default.name,i.default.name,l.default.name]).controller("AnalyticsDashboardCtrl",["$scope","$translate","$timeout","dwAlerts","state","helper","dnd","keese","session","analyticsWidgetsList","AnalyticsUser",function(t,e,a,n,r,o,i,l,s,c,d){var u=this;r.setPageTitle(e.instant("ANALYTICS.PAGE_TITLE")),u.widgetsList=c,u.widgetToAdd=u.widgetsList[0],u.onInit=function(){u.loadDefaults()},u.getCenterId=function(){return u.settings.allCenters?null:r.getCurrentCenterId()},u.onDrop=function(t,e,a,n){i.move(t,e,a,n);return!0},u.addWidget=function(){var t=u.settings.widgets;t.push({uid:u.widgetToAdd.uid,order:l.generate(t.length&&t[t.length-1].order),wide:!1})},u.saveDefaults=function(){return d.save({userId:s.user.id},u.settings).catch((function(t){return n.error(t,"Failed to save dashboard settings.")})).then((function(){u.defaults=angular.copy(u.settings)}))},u.loadDefaults=function(){return d.get({userId:s.user.id}).catch((function(t){return n.error(t,"Failed to get dashboard settings.")})).then((function(t){u.settings=o.purify(t),a((function(){u.defaults=angular.copy(u.settings)}))}))},u.isPristine=function(){return angular.equals(u.settings,u.defaults)},u.onInit()}])},DcLO:function(t,e,a){"use strict";var n=a("nbuU"),r=a.n(n),o=a("ggrz"),i=a.n(o),l=(a("gq4Z"),a("CgoQ"));e.a=angular.module("deskworks.chartPeriodDirective",[l.a.name]).directive("chartPeriod",(function(){return{template:i.a,restrict:"E",scope:!0,controller:"ChartPeriodCtrl as $ctrl",bindToController:{period:"=",from:"=",to:"="}}})).controller("ChartPeriodCtrl",["$scope","optsChartPeriod",function(t,e){var a=this;a.optsPeriod=e,t.$watchGroup(["$ctrl.period","$ctrl.from","$ctrl.to"],(function(t,n){if("custom"===a.period&&a.to&&a.to.endOf("month"),t[0]!==n[0]||a.period&&!a.from&&!a.to){var o=r()(e).call(e,(function(t){return t.id===a.period}));a.from=o.from(),a.to=o.to()}}))}])},G6gN:function(t,e,a){"use strict";a.r(e);var n=a("WSeP"),r=a.n(n),o=a("nbuU"),i=a.n(o),l=a("Xp5u");e.default=angular.module("deskworks.AnalyticsOccupancyVacancy",["ngResource","datesDeserializer","deskworks.config",l.a.name]).factory("AnalyticsOccupancyVacancy",["$resource","$filter","$timeout","datesDeserializer","deskworksConfig","helper","optsChartByPeriod",function(t,e,a,n,o,l,s){var c=n(["periods.from","periods.to"]),d=t(o.getApiAbsUrl("/analytics/occupancy-vacancy"),{byPeriod:"@byPeriod",from:"@from",to:"@to"},{get:{method:"GET",isArray:!1,transformResponse:[angular.fromJson,c]}});return{get:function(t){return d.get({centerId:t.centerId||null,byPeriod:t.byPeriod||"month",from:e("date")(t.from,"yyyy-MM-dd")||null,to:e("date")(t.to,"yyyy-MM-dd")||null}).$promise.then((function(e){return function(t){var e,a=t.data,n=t.params.byPeriod,o=void 0===n?"month":n,l=i()(s).call(s,(function(t){return t.id===o}));return r()(e=a.periods).call(e,(function(t){t.title=l.format(t.from,t.to)})),a}({data:e,params:t})}))}}}])},I5Zy:function(t,e,a){"use strict";var n=a("xeXu"),r=a.n(n),o=a("0zKI"),i=a.n(o),l=(a("RF9M"),a("/MEN"),a("jd5N"));e.a=angular.module("dnd",["dndLists",l.a.name]).factory("dnd",["keese",function(t){return{move:function(e,a,n,o){var l=e[a];n&&i()(n).call(n,o,0,l);e===n&&o<=a&&a++;if(i()(e).call(e,a,1),n){var s=r()(n).call(n,l);l.order=t.generate(n[s-1]&&n[s-1].order,n[s+1]&&n[s+1].order)}return l}}}])},KOgG:function(t,e,a){},O7bB:function(t,e,a){"use strict";a.r(e);var n=a("6RpP"),r=a.n(n),o=a("yCd9"),i=a.n(o),l=a("aGVL"),s=a("bU+R"),c=a.n(s);e.default=angular.module("deskworks.analyticsIncomeChart",[l.a.name,"deskworks.whitelabel"]).factory("analyticsIncomeChart",["$filter","$translate","chartColors","whitelabel",function(t,e,a,n){return function(o){var l=o.periods,s=o.totals,d=(o.params,i()(l).call(l,(function(t){return t.title}))),u=[{data:s,maxBarThickness:80,backgroundColor:n.getProperty("--brand-color")||a[0]}],f=e.instant("ANALYTICS.INCOME");return{type:"bar",plugins:[c.a],data:{labels:d,datasets:u},options:{plugins:{datalabels:{display:"auto",color:"#fff",backgroundColor:"#000",padding:1,borderRadius:3,formatter:function(e,a){return t("ncurrency")(e,void 0,0)}}},tooltips:{callbacks:{label:function(e){var a;return r()(a="".concat(f,": ")).call(a,t("ncurrency")(s[e.index]))}}},layout:{padding:{top:15}},legend:{display:!1},scales:{yAxes:[{ticks:{min:0,callback:function(e){return t("ncurrency")(e,void 0,0)}}}]}}}}}])},OOrm:function(t,e,a){"use strict";var n=a("2R0e"),r=a.n(n),o=a("Xp5u");e.a=angular.module("deskworks.chartByPeriodDirective",[o.a.name]).directive("chartByPeriod",(function(){return{template:r.a,restrict:"E",scope:!0,controller:"ChartByPeriodCtrl as $ctrl",bindToController:{period:"="}}})).controller("ChartByPeriodCtrl",["$scope","optsChartByPeriod",function(t,e){this.optsPeriod=e}])},RlMt:function(t,e,a){"use strict";a.r(e),e.default=angular.module("deskworks.AnalyticsUser",["ngResource","datesDeserializer","deskworks.config"]).factory("AnalyticsUser",["$resource","$timeout","datesDeserializer","deskworksConfig",function(t,e,a,n){var r=n.getApiAbsUrl("/analytics/users/:userId"),o=a(["widgets.from","widgets.to"]),i=t(r,{userId:"@userId"},{get:{method:"GET",transformResponse:[angular.fromJson,o]},update:{method:"PUT"}});return{get:function(t){return i.get(t).$promise},save:function(t,e){return i.update(t,e).$promise}}}])},RnuU:function(t,e){t.exports='<div> <ng-form name=$ctrl.widgetToolbarForm class=ff-grid> <chart-by-period flex=none period=$ctrl.params.byPeriod></chart-by-period> <ff-static flex=auto></ff-static> <chart-period flex="0 1 auto" period=$ctrl.params.period from=$ctrl.params.from to=$ctrl.params.to></chart-period> </ng-form> <chart config=$ctrl.chart ff-dim=$ctrl.spin></chart> </div> '},"Xh+F":function(t,e,a){"use strict";a.r(e);var n=a("4uyB"),r=a("p5aI"),o=a("qLGz");e.default=angular.module("deskworks.analyticsWidgetsList",[n.default.name,r.default.name,o.default.name]).factory("analyticsWidgetsList",(function(){return[{uid:"sales",_name:"ANALYTICS.WIDGET.SALES",template:"<analytics-sales></analytics-sales>"},{uid:"income",_name:"ANALYTICS.WIDGET.INCOME",template:"<analytics-income></analytics-income>"},{uid:"occupancy-vacancy",_name:"ANALYTICS.WIDGET.OCCUPANCY_VACANCY",template:"<analytics-occupancy-vacancy></analytics-occupancy-vacancy>"}]}))},Xp5u:function(t,e,a){"use strict";var n=a("WSeP"),r=a.n(n);e.a=angular.module("deskworks.optsChartByPeriod",[]).factory("optsChartByPeriod",["$rootScope","$translate","$filter",function(t,e,a){var n=a("date"),o=[{id:"week",_name:"CHARTS.BY_PERIOD.WEEK",format:function(t,e){return n(t,"MMM d")+" - "+n(e,"MMM d")}},{id:"month",_name:"CHARTS.BY_PERIOD.MONTH",format:function(t,e){return n(t,"MMM")}},{id:"quarter",_name:"CHARTS.BY_PERIOD.QUARTER",format:function(t,e){return n(t,"MMM")+" - "+n(e,"MMM")}},{id:"year",_name:"CHARTS.BY_PERIOD.YEAR",format:function(t,e){return n(t,"yyyy")}}];function i(){r()(o).call(o,(function(t){t.name=e.instant(t._name)}))}return i(),t.$on("$setTranslationsSuccess",i),o}])},aGVL:function(t,e,a){"use strict";e.a=angular.module("chartColors",[]).factory("chartColors",(function(){return["#317da3","#e6194b","#3cb44b","#ffe119","#f58231","#911eb4","#aa6e28","#008080","#808080","#800000","#3244a1","#e64c19","#3db372","#d1ff1a","#f5c131","#b31e81","#a89728","#005580","#806659","#804000"]}))},aOtR:function(t,e){t.exports='<div class=analytics-dashboard> <h1 class=page-title>{{state.getPageTitle()}}</h1> <div class="ff-spin ff-spin-placeholder" ng-if=!$ctrl.settings></div> <div class=gutter-v ng-if=$ctrl.settings> <ff-panel ng-if="state.getUserCenters().length > 1"> <div> <label class=i-block> <ff-checkbox ff-model=$ctrl.settings.allCenters><span translate=ANALYTICS.ALL_CENTERS></span></ff-checkbox> </label> <ff-hint><span translate=ANALYTICS.ALL_CENTERS.HINT></span></ff-hint> </div> </ff-panel> <div> <div class="ff-grid gutter-h gutter-v" dnd-list dnd-drop="callback({ targetList: $ctrl.settings.widgets, targetIndex: index })"> <analytics-widget ng-repeat="widget in $ctrl.settings.widgets" widget=widget center-id=$ctrl.getCenterId() dnd-draggable=null dnd-nodrag dnd-dragstart=$w.onDragStart(event) dnd-dragend=$w.onDragEnd(event) dnd-callback="$ctrl.onDrop($ctrl.settings.widgets, $index, targetList, targetIndex)"></analytics-widget> <div class=dndPlaceholder>Drop here.</div> <div class=analytics-dashboard-trash title="{{\'ANALYTICS.BTN_TRASH\' | translate}}" dnd-list=[] dnd-drop="callback({ targetList: null, targetIndex: index })"><i class="fa fa-trash"></i></div> </div> </div> <div> <div class="ff-grid gutter-h-half gutter-v-half"> <ng-form class=ff-row flex="0 1 300px"> <label class=ff-row> <ff-label flex=none>Add widget:</ff-label> <ff-select ff-model=$ctrl.widgetToAdd ff-options="widget._name | translate for widget in $ctrl.widgetsList"></ff-select> </label> <ff-btn-group flex=none class=buttons-row> <ff-btn sense=add size=xs type=submit ff-click=$ctrl.addWidget() title="{{ \'GLOBAL.BTN_NEW\' | translate }}"></ff-btn> </ff-btn-group> </ng-form> <ff-btn-group flex=none> <ff-btn sense=makeFavorite ff-click=$ctrl.saveDefaults() ff-disabled=$ctrl.isPristine()> <span translate=ANALYTICS.BTN_SAVE_DEFAULTS></span> </ff-btn> </ff-btn-group> </div> </div> </div> </div> '},"bG+q":function(t,e,a){},ggrz:function(t,e){t.exports="<label class=ff-row style=min-width:190px> <ff-label flex=none><span translate=CHARTS.PERIOD></span></ff-label> <ff-select ff-model=$ctrl.period ff-options=\"opt.id as opt.name for opt in $ctrl.optsPeriod\"></ff-select> </label> <ff-row style=z-index:1;margin-left:-108px ng-style=\"{ 'min-width': $ctrl.period === 'custom' ? '300px' : 'none' }\"> <label class=ff-row flex=\"0 1 158px\" ng-if=\"$ctrl.period === 'custom'\"> <ff-label flex=none><span translate=CHARTS.FROM></span></ff-label> <ff-date name=from ff-model=$ctrl.from monthly=true ff-required=true ff-validate-alert=\"{{'CHARTS.FROM' | translate}}\"></ff-date> </label> <label class=ff-row flex=\"0 1 140px\" ng-if=\"$ctrl.period === 'custom'\"> <ff-label flex=none><span translate=CHARTS.TO></span></ff-label> <ff-date name=to ff-model=$ctrl.to monthly=true ff-required=true ff-validate-alert=\"{{'CHARTS.TO' | translate}}\"></ff-date> </label> </ff-row> "},gq4Z:function(t,e,a){},jd5N:function(t,e,a){"use strict";var n=a("JRMi"),r=a.n(n),o=a("gQJ2"),i=a.n(o);e.a=angular.module("keese",[]).factory("keese",(function(){var t="0123456789?@ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",e=t.length,a=function(){for(var e={},a=0;a<t.length;a++)e[t[a]]=a;return e}();return{generate:function(t,e,a){return a?o(t,e,a):n(t,e)}};function n(t,e){return t?e?l(t,e):((a=c(t)).digits=a.digits.substr(0,a.order_length+1),s(a,c("1"))):e?l("0",e):"1";var a}function o(t,e,a){var r=new Array(a);if(a>0)if(e)!function t(e,a,o,i){var l=Math.floor((o+i)/2),s=n(e,a);r[l]=s,o<l&&t(e,s,o,l);l+1<i&&t(s,a,l+1,i)}(t,e,0,a);else for(var o=0;o<a;o++){var i=keese(t,null);r[o]=i,t=i}return r}function l(n,r){if(n>r)throw new Error("assertion failed: "+i()(n)+" < "+i()(r));var o=c(n),l=c(r);u(o,l);for(var f=0,p=Math.max(o.digits.length,l.digits.length),m=0;m<p||f>0;m++){var g=a[o.digits[m]]||0,y=f+(a[l.digits[m]]||0);if(g!==y){if(g!==y-1){for(var h=Math.floor((y-g)/2),b="",v=0;v<m;v++)b+="0";b+=t[h];var C=c(d(o.order_length,b));return o.digits=o.digits.substr(0,m+1),s(o,C)}f=e}}throw new Error}function s(n,r){u(n,r);for(var o="",i=n.order_length,l=0,s=Math.max(n.digits.length,r.digits.length)-1;s>=0;s--)l+=a[n.digits[s]]||0,l+=a[r.digits[s]]||0,o=t[l%e]+o,l=Math.floor(l/e);for(;l>0;)o=t[l%e]+o,l=Math.floor(l/e),i++;return d(i,o)}function c(t){var e=r()(t).call(t,"~")+1;return{order_length:e,digits:t.substr(e)}}function d(t,e){for(;t>0&&"0"==e.charAt(0);)e=e.substr(1),t--;for(var a="",n=0;n<t;n++)a+="~";return a+e}function u(t,e){f(t,e.order_length),f(e,t.order_length)}function f(t,e){for(;t.order_length<e;)t.digits="0"+t.digits,t.order_length++}}))},jwnm:function(t,e){t.exports='<div> <ng-form name=$ctrl.widgetToolbarForm class=ff-grid> <chart-by-period flex=none period=$ctrl.params.byPeriod></chart-by-period> <ff-static flex=auto> <ff-hint ng-if="$ctrl.params.selected === null"><span translate=ANALYTICS.WIDGET.OCCUPANCY_VACANCY.HINT></span></ff-hint> <ff-btn sense=back size=sm ng-if="$ctrl.params.selected !== null" ff-click="$ctrl.params.selected = null"> <span translate=GLOBAL.BTN_BACK></span> </ff-btn> </ff-static> <chart-period flex="0 1 auto" period=$ctrl.params.period from=$ctrl.params.from to=$ctrl.params.to></chart-period> </ng-form> <chart config=$ctrl.chart ff-dim=$ctrl.spin></chart> </div> '},oCA5:function(t,e,a){"use strict";a.r(e);var n=a("6RpP"),r=a.n(n),o=a("yCd9"),i=a.n(o),l=a("G6E5"),s=a("aGVL"),c=a("bU+R"),d=a.n(c);e.default=angular.module("deskworks.analyticsOccupancyVacancyChart",[l.a.name,s.a.name]).factory("analyticsOccupancyVacancyChart",["$rootScope","$filter","$translate","chartColors","reportHelper",function(t,e,a,n,o){return function(e){var a=e.periods,o=e.data,l=e.params,s=e.onChartClick,c=i()(a).call(a,(function(t){return t.title})),u=i()(o).call(o,(function(t,e){return{label:t.name,data:t.totals,maxBarThickness:80,backgroundColor:n[e]}}));return{type:"bar",plugins:[d.a],data:{labels:c,datasets:u},options:{plugins:{datalabels:{display:"auto",color:"#fff",backgroundColor:"#000",padding:1,borderRadius:3,formatter:function(t,e){return"".concat(Math.round(t),"%")}}},tooltips:{mode:"index",intersect:!0,displayColors:!0,callbacks:{label:function(t){var e,a=o[t.datasetIndex],n=a.name,i=a.totals;return r()(e="".concat(n,": ")).call(e,i[t.index],"%")}}},layout:{padding:{top:15}},legend:{display:!0,position:l.wide?"right":"bottom"},scales:{yAxes:[{ticks:{min:0,max:100,callback:function(t){return"".concat(t,"%")}}}]},onClick:function(e,a){var n=this;t.$apply((function(t){var a=n.getElementAtEvent(e)[0];a&&s(a._datasetIndex)}))}}}}}])},p5aI:function(t,e,a){"use strict";a.r(e);a("JBxO"),a("FdtR");var n=a("Tfwl"),r=a.n(n),o=a("XAgg"),i=a.n(o),l=a("yKah"),s=a.n(l),c=a("WSeP"),d=a.n(c),u=a("lvz6"),f=a.n(u),p=a("hsT8"),m=a.n(p),g=a("Ekwr"),y=a.n(g),h=a("03wM"),b=a.n(h),v=a("fzuT"),C=a.n(v),w=a("RnuU"),$=a.n(w),k=a("CLLE"),A=a("G6E5"),P=a("2Bp7"),T=a("Xp5u"),I=a("CgoQ"),O=a("O7bB"),x=a("DcLO"),R=a("OOrm");function S(t,e){var a=b()(t);if(y.a){var n=y()(t);e&&(n=m()(n).call(n,(function(e){return f()(t,e).enumerable}))),a.push.apply(a,n)}return a}function E(t){for(var e=1;e<arguments.length;e++){var a,n=null!=arguments[e]?arguments[e]:{};if(e%2)d()(a=S(Object(n),!0)).call(a,(function(e){C()(t,e,n[e])}));else if(s.a)i()(t,s()(n));else{var o;d()(o=S(Object(n))).call(o,(function(e){r()(t,e,f()(n,e))}))}}return t}e.default=angular.module("deskworks.analyticsIncomeDirective",["debounce",k.a.name,A.a.name,T.a.name,I.a.name,P.default.name,O.default.name,x.a.name,R.a.name]).directive("analyticsIncome",(function(){return{template:$.a,restrict:"E",scope:!0,controller:"AnalyticsIncomeDirectiveCtrl as $ctrl",bindToController:{params:"<",centerId:"<"}}})).controller("AnalyticsIncomeDirectiveCtrl",["$scope","$q","state","dwAlerts","helper","debounce","reportHelper","AnalyticsIncome","analyticsIncomeChart","optsChartByPeriod","optsChartPeriod",function(t,e,a,n,r,o,i,l,s,c,d){var u=this,f=i.paramsChanged;u.optsByPeriod=c,u.optsPeriod=d,u.data=null,u.$onInit=function(){t.$watch((function(){return E(E({},u.params),{},{centerId:u.centerId})}),o((function(t,a){u.params.period=u.params.period||"12months",u.params.byPeriod=u.params.byPeriod||"month",u.widgetToolbarForm.$invalid||(f(t,a,["byPeriod","from","to","centerId"])&&(u.data=null),u.data=u.data||(u.spin=!0,l.get(t).catch((function(t){return n.error(t,"Failed to query Income widget data.")})).finally((function(){u.spin=!1}))),e.all({data:u.data}).then((function(t){u.data=t.data})).then((function(){u.chart=s(E(E({},u.data),{},{params:u.params}))})))}),100),!0)}}])},pl6f:function(t,e,a){"use strict";e.a=angular.module("systemColors",["deskworks.helper"]).factory("systemColors",["$window","helper",function(t,e){var a={},n=angular.element('<div style="display: none"></div>');return n.append('<div class="text-text"></div>'),n.append('<div class="text-brand"></div>'),n.append('<div class="text-brand"></div>'),n.append('<div class="text-danger"></div>'),n.append("<div></div>"),n.append('<div class="sidebar-group-header"></div>'),document.body.appendChild(n[0]),a.text=e.rgb2hex(t.getComputedStyle(n.children()[0]).getPropertyValue("color"))||"#444",a.info=e.rgb2hex(t.getComputedStyle(n.children()[4]).getPropertyValue("color"))||"#4d4e4c",a.primary=e.rgb2hex(t.getComputedStyle(n.children()[5]).getPropertyValue("background-color"))||"#949594",a.warning=e.rgb2hex(t.getComputedStyle(n.children()[3]).getPropertyValue("color"))||"#ff9b00",n.remove(),a}])},qLGz:function(t,e,a){"use strict";a.r(e);a("JBxO"),a("FdtR");var n=a("Tfwl"),r=a.n(n),o=a("XAgg"),i=a.n(o),l=a("yKah"),s=a.n(l),c=a("WSeP"),d=a.n(c),u=a("lvz6"),f=a.n(u),p=a("hsT8"),m=a.n(p),g=a("Ekwr"),y=a.n(g),h=a("03wM"),b=a.n(h),v=a("fzuT"),C=a.n(v),w=a("jwnm"),$=a.n(w),k=a("CLLE"),A=a("G6E5"),P=a("G6gN"),T=a("Xp5u"),I=a("CgoQ"),O=a("oCA5"),x=a("9pnN"),R=a("DcLO"),S=a("OOrm");function E(t,e){var a=b()(t);if(y.a){var n=y()(t);e&&(n=m()(n).call(n,(function(e){return f()(t,e).enumerable}))),a.push.apply(a,n)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a,n=null!=arguments[e]?arguments[e]:{};if(e%2)d()(a=E(Object(n),!0)).call(a,(function(e){C()(t,e,n[e])}));else if(s.a)i()(t,s()(n));else{var o;d()(o=E(Object(n))).call(o,(function(e){r()(t,e,f()(n,e))}))}}return t}e.default=angular.module("deskworks.analyticsOccupancyVacancyDirective",["debounce",k.a.name,A.a.name,T.a.name,I.a.name,P.default.name,O.default.name,x.default.name,R.a.name,S.a.name]).directive("analyticsOccupancyVacancy",(function(){return{template:$.a,restrict:"E",scope:!0,controller:"AnalyticsOccupancyVacancyDirectiveCtrl as $ctrl",bindToController:{params:"<",centerId:"<"}}})).controller("AnalyticsOccupancyVacancyDirectiveCtrl",["$scope","$q","state","dwAlerts","helper","debounce","reportHelper","AnalyticsOccupancyVacancy","analyticsOccupancyVacancyChart","analyticsOccupancyVacancyChartUnits","optsChartByPeriod","optsChartPeriod",function(t,e,a,n,r,o,i,l,s,c,d,u){var f=this,p=i.paramsChanged;function m(t){f.params.selected=t}f.optsByPeriod=d,f.optsPeriod=u,f.data=null,f.$onInit=function(){t.$watch((function(){return D(D({},f.params),{},{centerId:f.centerId})}),o((function(t,a){f.params.period=f.params.period||"12months",f.params.byPeriod=f.params.byPeriod||"month",f.widgetToolbarForm.$invalid||(p(t,a,["byPeriod","from","to","centerId"])&&(f.data=null,f.params.selected=null),f.data=f.data||(f.spin=!0,l.get(t).catch((function(t){return n.error(t,"Failed to query Occupancy Vacancy widget data.")})).finally((function(){f.spin=!1}))),e.all({data:f.data}).then((function(t){f.data=t.data})).then((function(){null!==f.params.selected?f.chart=c(D(D({},f.data),{},{params:f.params})):f.chart=s(D(D({},f.data),{},{params:f.params,onChartClick:m}))})))}),100),!0)}}])},r970:function(t,e){t.exports='<ff-panel> <ff-panel-header class=ff-row> <span translate={{$w.config._name}}></span> <div class=analytics-widget-toolbar> <ff-btn sense=widen size=xs class=ff-btn-icon ff-click="$w.widget.wide = !$w.widget.wide" title="{{\'ANALYTICS.WIDE\' | translate}}"></ff-btn> <ff-btn sense=drag size=xs class=ff-btn-icon dnd-handle title="{{\'ANALYTICS.DRAG_N_DROP\' | translate}}"></ff-btn> </div> </ff-panel-header> <div class=analytics-widget-body></div> </ff-panel> '},va6R:function(t,e,a){}}]);