(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{DQFS:function(e,t,r){},W87a:function(e,t,r){"use strict";r("DQFS");var a=r("nOZT"),n=r.n(a);t.a=angular.module("deskworks.rcDateSelector",[]).component("rcDateSelector",{template:n.a,controller:"RcDateSelectorController as $ctrl",bindings:{mode:"<",date:"="}}).controller("RcDateSelectorController",["$scope",function(e){var t=this;e.$watch("$ctrl.date",(function(){moment.isMoment(t.date)&&(t.weekStart=t.date.clone().startOf("week"),t.weekEnd=t.weekStart.clone().endOf("week"))})),t.prev=function(){moment.isMoment(t.date)&&(t.date=t.date.clone().subtract("week"===t.mode?7:1,"d"))},t.next=function(){moment.isMoment(t.date)&&(t.date=t.date.clone().add("week"===t.mode?7:1,"d"))}}])},bOPx:function(e,t,r){"use strict";r("JBxO"),r("FdtR"),r("Muwe"),r("y89P");var a=r("WSeP"),n=r.n(a),i=r("nbuU"),l=r.n(i),s=r("gQJ2"),o=r.n(s),c=r("yCd9"),f=r.n(c),d=r("YtL8"),u=r.n(d),v=r("hsT8"),m=r.n(v),p=r("0zKI"),E=r.n(p),S=r("NOor"),$=r.n(S),T=r("D4RU"),g=r.n(T),R=(r("W87a"),r("cRes"),r("l3lf")),h=r.n(R),b=r("+l1P"),w=(angular.module("deskworks.timeSelector",["deskworks.state",b.a.name,"deskworks.userRoles","session"]).directive("timeSelector",(function(){return{template:h.a,restrict:"E",scope:!0,controller:"TimeSelectorDirectiveCtrl as $ctrl",bindToController:{date:"<",reservations:"<",timeStart:"=",timeEnd:"=",availabilities:"<",role:"<?",scale:"<?",buffer:"<?"},link:function(e,t){t.addClass("time-selector")}}})).controller("TimeSelectorDirectiveCtrl",["$scope","$timeout","$filter","$translate","state","userRoles","session",function(e,t,r,a,i,l,s){var o=this;function c(){for(var e=[],t=o.date.clone().startOf("day"),r=t.clone().add(1,"d");t<r;t.add(o.scale||30,"m"))e.push({reserved:!1,time:t.clone(),timeEnd:t.clone().add(o.scale||30,"m")});return e}o.$onInit=function(){o.currentUserId=i.getCurrentUserId(),o.timeStartInitial=moment.isMoment(o.timeStart)?o.timeStart.clone():moment(),o.timeEndInitial=moment.isMoment(o.timeEnd)?o.timeEnd.clone():moment(),t((function(){var e=document.querySelector(".slots-wrapper"),t=e.querySelector('.slot[time-str="'+r("date")(o.date,"HH:mm:00")+'"]')||e.querySelector('.slot[time-str="08:00:00"]');e.scrollTop=t.offsetTop})),o.slots=c(),o.selectionStart=o.timeStart?Math.floor((60*o.timeStart.hours()+o.timeStart.minutes())/(o.scale||30)):-1,o.selectionEnd=o.timeEnd?Math.ceil(o.selectionStart+(o.timeEnd-o.timeStart)/1e3/60/(o.scale||30)-1):-1},o.$onChanges=function(e){!e.date||!moment.isMoment(e.date.previousValue)||e.date.currentValue.isSame(e.date.previousValue)||(o.selectClear(),angular.isArray(e.reservations)||angular.isArray(e.availabilities))?t((function(){var e;o.slots=c(),e=o.slots,n()(angular).call(angular,e,(function(e){e.available=!1})),n()(angular).call(angular,o.availabilities,(function(t){for(var r=Math.floor((60*t.from.hour()+t.from.minute())/(o.scale||30)),a=Math.ceil((60*t.to.hour()+t.to.minute())/(o.scale||30)||e.length),n=r;n<a;n++)e[n].available=!0})),function(e){u()(e).call(e,(function(e,t){return t.optional=!1,t.available?++e:e}),0)&&(g()(e).call(e,(function(e){if(e.available)return!0;e.optional=!0})),g()(e).call(e,(function(t,r,a){if((t=e[e.length-r-1]).available)return!0;t.optional=!0})))}(o.slots),function(e){moment.isMoment(o.timeStartInitial)&&moment.isMoment(o.timeEndInitial)||o.selectClear();if(angular.isDefined(o.reservations)){var t;n()(e).call(e,(function(e){e.reserved=!1,e.buffer=!1,delete e.text,delete e.userId,delete e.reservedLength})),n()(t=o.reservations).call(t,(function(t){if(!(moment.isMoment(o.timeStartInitial)&&moment.isMoment(o.timeEndInitial)&&t.from.isSame(o.timeStartInitial)&&t.to.isSame(o.timeEndInitial))){var a=t.from.diff(t.from.clone().startOf("date"),"minutes")/(o.scale||30),n=Math.floor(a),i=a+(t.to-t.from)/1e3/60/(o.scale||30),l=Math.ceil(i);l+=i!==l?1:0,r({slots:e,reservation:t,index:n-1,direction:-1});for(var s=n;s<l;s++)e[s].reserved=!0,e[s].text=t.userCompany?t.userCompany+": ":"",e[s].text+="<strong>"+t.userName+"</strong>",e[s].userId=t.userId,s===n&&(e[s].reservedLength=l-n);r({slots:e,reservation:t,index:l})}}))}function r(e){var t=e.slots,r=(e.reservation,e.index),a=e.direction,n=void 0===a?1:a;if(o.buffer&&t[r]&&!(o.role?"admin"===(l[o.role]||{}).type:s.isAdmin()))for(var i=r+Math.ceil(o.buffer/(o.scale||30))*n,c=r;n>0?c<i:c>i;c+=n)t[c]&&!t[c].reserved&&(t[c].available=!1,t[c].buffer=!0)}}(o.slots)})):o.slots=c()},o.selectTime=function(e){if(!o.slots[e].reserved&&o.slots[e].available){if(-1===o.selectionStart)o.selectionStart=e,o.selectionEnd=e;else if(o.selectionEnd===o.selectionStart){if(e>o.selectionStart){o.selectionEnd=e;for(var t=o.selectionStart;t<=o.selectionEnd;t++)if(o.slots[t].reserved||!o.slots[t].available){o.selectionStart=e,o.selectionEnd=e;break}}else if(e<o.selectionStart){o.selectionEnd=o.selectionStart,o.selectionStart=e;for(var r=o.selectionEnd;r>=o.selectionStart;r--)if(o.slots[r].reserved||!o.slots[r].available){o.selectionStart=e,o.selectionEnd=e;break}}}else o.selectionStart=e,o.selectionEnd=e;o.selectionStart>=0&&o.selectionEnd>=0?(o.timeStart=o.slots[o.selectionStart].time.clone(),o.timeEnd=o.slots[o.selectionEnd>=0?o.selectionEnd:o.selectionStart].timeEnd.clone()):(o.timeStart=null,o.timeEnd=null)}},o.selectClear=function(){o.selectionStart=o.selectionEnd=-1,o.timeStart=o.timeEnd=null},o.getSlotClass=function(e,t){return{reserved:e.reserved,"reserved-own":e.reserved&&o.currentUserId===e.userId,available:e.available,optional:e.optional,buffer:e.buffer,selected:t===o.selectionStart&&-1===o.selectionEnd||t>=o.selectionStart&&t<=o.selectionEnd}},o.getSlotTitle=function(e,t){var n=e.available?"AVAILABLE":"UNAVAILABLE";e.reserved&&(n="RESERVED"),(t===o.selectionStart&&-1===o.selectionEnd||t>=o.selectionStart&&t<=o.selectionEnd)&&(n="SELECTED");var i={from:r("date")(e.time,"shortTime"),to:r("date")(e.timeEnd,"shortTime")};return a.instant("RESERVATIONS.TIME_SELECTOR.SLOT.".concat(n),i)}}]),r("qNmJ"),r("q9Tw")),N=r.n(w),y=r("GJsN");t.a=angular.module("deskworks.resReservation",["deskworks.rcHelper","deskworks.reservationUnit.optsRepeatFrequency","deskworks.timeSelector","deskworks.reservationService","deskworks.calendarService","deskworks.rcDateSelector","deskworks.ReservationCost",b.a.name,y.a.name]).directive("resReservation",(function(){return{template:N.a,scope:!0,controller:"ResReservationController as $ctrl",bindToController:{center:"<",calData:"<",user:"<",reservationPrices:"<",reservationFields:"<",hideReservationCostEstimate:"<",hideRecurringReservations:"<",afterSave:"<",hideCalendarBtn:"<",signOut:"<",stopWizard:"<",backFn:"&?back",nextFn:"&?next"}}})).controller("ResReservationController",["$scope","$filter","$interval","$route","$window","session","dwAlerts","helper","rcHelper","state","reservationService","calendarService","ReservationCost","optsRepeatFrequency",function(e,t,r,a,i,s,c,d,v,p,S,T,R,h){var b=this;b.$onInit=function(){var i;e.state=p,b.optsRepeatFrequency=h,b.afterSave=b.afterSave||b.navCalendar,b.role=p.getParam("role"),g()(i=b.calData).call(i,(function(e){var t;return g()(t=e.reservationUnits).call(t,(function(e){var t,r,n=$()(t=e.reservations).call(t,(function(e){return e.id===+a.current.params.reservationId}));n>=0&&(b.reservation=e.reservations[n],E()(r=e.reservations).call(r,n,1),p.setParam("unit",e.id).replace());return!!b.reservation}))})),b.$onChanges=function(){b.afterSave=b.afterSave||b.navCalendar},b.date=t("toDate")(a.current.params.date||p.getParam("date")),b.date=moment.isMoment(b.date)?b.date:moment(),v.floorDate(b.date,30);var s=b.reservation&&b.reservation.from||t("toDate")(p.getParam("start"));b.timeStart=moment.isMoment(s)?s:null,s=b.reservation&&b.reservation.to||t("toDate")(p.getParam("end")),b.timeEnd=moment.isMoment(s)&&b.timeStart?s:null,b.reservationTitle=p.getParam("title")||(b.reservation?b.reservation.title:""),b.reservationNote=p.getParam("note")||b.reservation&&b.reservation.reservationNote,b.repeatFrequency=d.findByKeyValue(b.optsRepeatFrequency,"id",p.getParam("freq"))||b.optsRepeatFrequency[0],b.repeatDuration=p.getParam("duration")&&+p.getParam("duration")||b.repeatFrequency.repeatDurationOptions&&b.repeatFrequency.repeatDurationOptions[0],b.emailConfirmation=!0,e.$watch("$ctrl.calData",(function(){var e,t;!function(){var e;if(b.reservationTypes=[],!angular.isArray(b.calData))return;n()(e=b.calData).call(e,(function(e){var t;if(e.reservationUnits=m()(t=e.reservationUnits).call(t,(function(e){return e.availabilities.length||"staffOnly"===e.whoCanReserve})),e.reservationUnits.length){var r,a;b.reservationTypes.push(e),e.fields=m()(r=b.reservationFields).call(r,(function(t){return t.reservationCategoryId===e.id||0===t.reservationCategoryId}));var i=JSON.parse(p.getParam("fields")||"{}");n()(a=e.fields).call(a,(function(e){return e.value=i[e.id]||0===i[e.id]?i[e.id]:((b.reservation||{}).fields||{})[e.id]}))}}))}(),t=a.current.params.reservationUnitId||p.getParam("unit"),g()(e=b.reservationTypes).call(e,(function(e){var r=l()(d).call(d,e.reservationUnits,t);if(r)return b.reservationType=e,b.reservationUnit=r,!0})),b.reservationUnit||(b.reservationType=b.reservationTypes[0],b.reservationUnit=b.reservationType&&b.reservationType.reservationUnits[0])})),e.$watch("$ctrl.reservationUnit.id",(function(e){p.setParam("unit",e).replace()})),e.$watch("$ctrl.date",(function(e){p.setParam("date",v.dateToStr(e)).replace()})),e.$watch("$ctrl.timeStart",(function(e){p.setParam("start",v.dateToStr(e)).replace()})),e.$watch("$ctrl.timeEnd",(function(e){p.setParam("end",v.dateToStr(e)).replace()})),e.$watch("$ctrl.emailConfirmation",(function(e){p.setParam("confirm",e||null).replace()})),e.$watch("$ctrl.repeatFrequency.id",(function(e){p.setParam("freq",e).replace()})),e.$watch("$ctrl.repeatDuration",(function(e){p.setParam("duration",e).replace()})),e.$watch("$ctrl.reservationTitle",(function(e){p.setParam("title",e).replace()})),e.$watch("$ctrl.reservationNote",(function(e){p.setParam("note",e).replace()})),e.$watch((function(){var e;return f()(e=b.reservationType.fields).call(e,(function(e){return{id:e.id,value:e.value}}))}),(function(e){var t=u()(e).call(e,(function(e,t){return(t.value||0===t.value||!1===t.value)&&(e[t.id]=t.value),e}),{});p.setParam("fields",o()(t))}),!0),e.$watch("$ctrl.date",(function(e,t){e!==t?b.fetch(!0):(r.cancel(b.timer),b.timer=r(b.fetch,6e4))})),e.$watchGroup(["$ctrl.reservationType","$ctrl.timeStart","$ctrl.timeEnd"],(function(){b.reservationType&&b.timeStart&&b.timeEnd?b.reservationCost=R.calcSync(b.timeStart,b.timeEnd,b.reservationPrices,b.reservationType.id):b.reservationCost=null})),e.$watch((function(){return p.getCurrentCenterId()}),(function(e,t){e!==t&&a.reload()}))},b.$onDestroy=function(){r.cancel(b.timer)},b.next=function(){if(!d.pointFirstInvalid(".sr-time"))return p.setPath(p.getPath()+"/users")},b.onNextClick=function(){if(!d.pointFirstInvalid(".res-container"))return b.nextFn?b.nextFn():(b.totalCost=function(){var e,t,r,a,n,i,l,s=m()(e=m()(t=b.reservationType.fields).call(t,(function(e){return"customPrice"===e.type}))).call(e,(function(e){return e.value||0===e.value})),o=(m()(r=m()(a=b.reservationType.fields).call(a,(function(e){return"extraPrice"===e.type}))).call(r,(function(e){return e.value||0===e.value})),u()(s).call(s,(function(e,t){return e+t.$$deserialize(t,t.value)}),0));s.length||(o=b.reservationCost);return o+=u()(n=m()(i=m()(l=b.reservationType.fields).call(l,(function(e){return"extraPrice"===e.type}))).call(i,(function(e){return e.value||0===e.value}))).call(n,(function(e,t){return e+t.$$deserialize(t,t.value)}),0)}(),void(b.confirmation=!0))},b.makeReservation=function(){var e,t,r={from:b.timeStart,to:b.timeEnd,title:b.reservationTitle,reservationNote:b.reservationNote,centerId:b.center.id,reservationUnitId:b.reservationUnit.id,emailConfirmation:b.emailConfirmation,repeatFrequency:b.repeatFrequency.id,repeatDuration:angular.isDefined(b.repeatFrequency.repeatDurationOptions)?b.repeatDuration:"",fields:u()(e=m()(t=b.reservationType.fields).call(t,(function(e){return e.value||0===e.value||!1===e.value}))).call(e,(function(e,t){return e[t.id]=t.$$serialize(t,t.value),e}),{})};return S.save(b.center.id,b.user.id,r).catch((function(e){return c.error(e,"Failed to save reservation.")})).then((function(){return b.afterSave()}))},b.updateReservation=function(){var e,t,r={id:b.reservation.id,from:b.timeStart,to:b.timeEnd,title:b.reservationTitle,reservationNote:b.reservationNote,emailConfirmation:b.emailConfirmation,fields:u()(e=m()(t=b.reservationType.fields).call(t,(function(e){return e.value||0===e.value||!1===e.value}))).call(e,(function(e,t){return e[t.id]=t.$$serialize(t,t.value),e}),{})};return S.save(b.center.id,b.user.id,r).catch((function(e){return c.error(e,"Failed to update reservation.")})).then((function(){return b.afterSave()}))},b.cancelReservation=function(){return S.delete(b.center.id,b.user.id,b.reservation.id,b.emailConfirmation).catch((function(e){return c.error(e,"Failed to cancel reservation.")})).then((function(){return b.afterSave()}))},b.fetch=function(e){if(r.cancel(b.timer),!b.fetching||e)return b.fetching=!0,T.query(p.getCurrentCenterId()||a.current.params.centerId,b.date,b.date,b.role).catch((function(e){return c.error(e,"Failed to fetch calendar data.")})).then((function(e){b.calData=e})).finally((function(){b.fetching=!1,r.cancel(b.timer),b.timer=r(b.fetch,6e4)}))},b.navCalendar=function(){return p.setParam("unit",null),p.setParam("start",null),p.setParam("end",null),p.setParam("confirm",null),p.setParam("freq",null),p.setParam("duration",null),p.setParam("title",null),p.setParam("note",null),p.setParam("fields",null),p.setPath("/reservation-calendar")},b.back=p.back,b.hasRecurring=function(){return!b.reservation&&(s.isAdmin()||!b.hideRecurringReservations)}}])},cRes:function(e,t,r){},l3lf:function(e,t){e.exports='<div class=hint translate=RESERVATIONS.TIME_SELECTOR.HINT.START ng-if="$ctrl.selectionStart === -1 || $ctrl.selectionStart !== $ctrl.selectionEnd"></div> <div class=hint translate=RESERVATIONS.TIME_SELECTOR.HINT.END ng-if="$ctrl.selectionStart !== -1 && $ctrl.selectionStart === $ctrl.selectionEnd"></div> <div class=slots-wrapper flex="1 1 auto"> <div class=slot ng-repeat="slot in $ctrl.slots" ng-click=$ctrl.selectTime($index) ng-class="$ctrl.getSlotClass(slot, $index)" time-str="{{slot.time | date:\'HH:mm:00\'}}" aria-label="{{$ctrl.getSlotTitle(slot, $index)}}"> <div class=reserved-outline ng-if=slot.reservedLength> <div class=reserved-outline-inner ng-style="{ height: \'calc(\' + (slot.reservedLength * 100) + \'% - 20px)\' }"> <span ng-bind-html=slot.text></span> </div> </div> <div class=selected-outline ng-if="$index === $ctrl.selectionStart"> <div class=selected-outline-inner ng-style="{ height: \'calc(\' + (($ctrl.selectionEnd != -1 ? $ctrl.selectionEnd - $ctrl.selectionStart + 1 : 1) * 100) + \'% - 20px)\' }"> <div class=selected-from ng-show="$ctrl.selectionStart !== -1" translate=RESERVATIONS.TIME_SELECTOR.FROM></div> <div class=selected-to ng-show="$ctrl.selectionEnd !== -1" translate=RESERVATIONS.TIME_SELECTOR.TO></div> <svg xmlns=http://www.w3.org/2000/svg class=diagonal-hatch> <defs> <pattern id=diagonalHatch patternUnits=userSpaceOnUse x=0 y=0 width=105 height=105> <g class=diagonal-hatch-pattern transform="translate(105,0) scale(-1,1)"> <path d="M0 90 l15,15"/> <path d="M0 75 l30,30"/> <path d="M0 60 l45,45"/> <path d="M0 45 l60,60"/> <path d="M0 30 l75,75"/> <path d="M0 15 l90,90"/> <path d="M0 0 l105,105"/> <path d="M15 0 l90,90"/> <path d="M30 0 l75,75"/> <path d="M45 0 l60,60"/> <path d="M60 0 l45,45"/> <path d="M75 0 l30,30"/> <path d="M90 0 l15,15"/> </g> </pattern> </defs> <g> <rect x=0 y=0 width=100% height=2000 class=diagonal-hatch-rect /> </g> </svg> </div> </div> <div ng-if=slot.buffer class=buffer-label translate=RESERVATIONS.RESERVATION_BUFFER></div> <div class=time-cell> <div class=time nice-time=slot.time></div> </div> <div class="time-cell time-cell-right"> <div class=time nice-time=slot.timeEnd></div> </div> </div> </div> <div class=clear-selection> <button type=button class="btn ff-btn btn-primary" ng-click=$ctrl.selectClear() translate=RESERVATIONS.TIME_SELECTOR.BTN_CLEAR></button> </div> '},nOZT:function(e,t){e.exports="<div ng-show=\"$ctrl.mode === 'day'\" class=day-mode> <ff-col class=day-pictogram flex=\"0 0 auto\"> <div class=rc-pictogram title=\"Click to pick date\"> <ff-datepicker-popup tabindex=0 ff-model=$ctrl.date></ff-datepicker-popup> <ff-row> <div class=serifs><hr><hr><hr></div> </ff-row> <span ng-bind=\"$ctrl.date | date:'dd'\"></span> </div> <div class=weekday> <span ng-bind=\"$ctrl.date | date:'EEE'\"></span> <div class=prev title=\"{{'RESERVATIONS.DATE_SELECTOR.DAY.PREV.HINT' | translate}}\" ng-click=$ctrl.prev()></div> <div class=next title=\"{{'RESERVATIONS.DATE_SELECTOR.DAY.NEXT.HINT' | translate}}\" ng-click=$ctrl.next()></div> </div> </ff-col> <div class=bar translate=RESERVATIONS.DATE_SELECTOR.DAY.EXTRA translate-values=\"{ month: ($ctrl.date | date:'MMMM'), year: ($ctrl.date | date:'yyyy') }\">></div> </div> <div ng-show=\"$ctrl.mode === 'week'\" class=week-mode> <div class=week-pictogram flex=\"0 0 auto\"> <div class=rc-pictogram> <ff-row> <div class=serifs><hr><hr><hr><hr><hr><hr></div> </ff-row> <span ng-bind=\"($ctrl.weekStart | date:'dd') + '-' +  ($ctrl.weekEnd | date:'dd')\"></span> </div> <div class=prev title=\"{{'RESERVATIONS.DATE_SELECTOR.WEEK.PREV.HINT' | translate}}\" ng-click=$ctrl.prev()></div> <div class=next title=\"{{'RESERVATIONS.DATE_SELECTOR.WEEK.NEXT.HINT' | translate}}\" ng-click=$ctrl.next()></div> </div> <div class=bar translate=RESERVATIONS.DATE_SELECTOR.WEEK.EXTRA translate-values=\"{ month: ($ctrl.date | date:'MMMM'), year: ($ctrl.date | date:'yyyy') }\"></div> </div> "},q9Tw:function(e,t){e.exports='<form class=res-container flex="1 1 auto" ng-if="!$ctrl.confirmation && !$ctrl.cancelConfirmation" novalidate ng-style="{ marginTop: $app.hideHeader ? 0 : null }"> <div class=res-header> <h1 class=page-title ng-if=!$ctrl.reservation translate=RESERVATIONS.NEW.PAGE_TITLE translate-values="{ centerName: $ctrl.center.name }"></h1> <h1 class=page-title ng-if=$ctrl.reservation translate=RESERVATIONS.EDIT.PAGE_TITLE translate-values="{ centerName: $ctrl.center.name }"></h1> <small translate=RESERVATIONS.HINT></small> </div> <ff-row class=res-body> <ff-col class=res-col-opts> <ff-row flex="0 0 auto"> <rc-date-selector mode="\'day\'" date=$ctrl.date></rc-date-selector> </ff-row> <ff-row flex="0 0 auto"> <ff-select name=reservationType ff-model=$ctrl.reservationType ff-options="resType.name for resType in $ctrl.reservationTypes" ff-disabled="$ctrl.reservation || $ctrl.reservationTypes.length < 2" ff-change="$ctrl.reservationUnit = $ctrl.reservationType.reservationUnits[0]" aria-label="{{\'RESERVATIONS.CATEGORY\' | translate}}"></ff-select> </ff-row> <ff-row flex="0 0 auto"> <ff-select name=reservationUnit ff-model=$ctrl.reservationUnit ff-options="resUnit.name for resUnit in $ctrl.reservationType.reservationUnits" ff-disabled="$ctrl.reservation || $ctrl.reservationType.reservationUnits.length < 2" aria-label="{{\'RESERVATIONS.SPACE\' | translate}}"></ff-select> </ff-row> <ff-row flex="0 0 auto" ng-if="!$ctrl.hideReservationCostEstimate && $ctrl.reservationPrices"> <ff-static> <span style=text-transform:uppercase;max-width:200px> <strong style=font-size:.8em><span translate=RESERVATIONS.ESTIMATED_COST></span>:</strong> <strong class=text-text ng-bind="$ctrl.reservationCost | ncurrency | nd"></strong> </span> </ff-static> </ff-row> <ff-row flex="0 0 auto"> <ff-text name=reservationTitle ff-maxlength=128 ff-model=$ctrl.reservationTitle placeholder="{{(\'RESERVATIONS.TITLE\' | translate)}}" aria-label="{{(\'RESERVATIONS.TITLE\' | translate)}}"></ff-text> </ff-row> <ff-row flex="1 0 30px"> <ff-textarea name=reservationNote ff-maxlength=250 ff-model=$ctrl.reservationNote placeholder="{{(\'RESERVATIONS.NOTES\' | translate)}}" aria-label="{{(\'RESERVATIONS.NOTES\' | translate)}}"></ff-textarea> </ff-row> <div ng-if="!$ctrl.reservation ? ($ctrl.hideRecurringReservations ? !state.isLoggedMember() && !state.isLoggedNonMember() && !!state.getLoggedUser() : true) : false"> <ff-row flex="0 0 auto"> <ff-select name=repeatFrequency ff-model=$ctrl.repeatFrequency ff-options="opt.name for opt in $ctrl.optsRepeatFrequency" ff-change="$ctrl.repeatDuration = $ctrl.repeatFrequency.repeatDurationOptions[0]" aria-label="{{\'RESERVATIONS.REPEAT_FREQUENCY\' | translate}}"></ff-select> </ff-row> <ff-row flex="0 0 auto" ng-if=$ctrl.repeatFrequency.repeatDurationOptions> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.REPEAT_DURATION></span></ff-label> <ff-select name=repeatDuration flex="0 1 50px" ff-model=$ctrl.repeatDuration ff-options="opt for opt in $ctrl.repeatFrequency.repeatDurationOptions" aria-label="{{\'RESERVATIONS.REPEAT_DURATION.LABEL\' | translate}}"></ff-select> <ff-label>{{$ctrl.repeatFrequency.repeatDurationFilter($ctrl.repeatDuration, true)}}</ff-label> </ff-row> </div> <fd-field field=field ng-repeat="field in $ctrl.reservationType.fields"></fd-field> <ff-btn-group class=res-buttons style=margin-top:.5rem> <ff-btn sense=back ff-click=$ctrl.backFn() ng-if=$ctrl.backFn> <span translate=GLOBAL.BTN_BACK></span> </ff-btn> <ff-btn sense=save type=submit ff-click=$ctrl.onNextClick() ff-disabled="!$ctrl.timeStart || !$ctrl.timeEnd || !$ctrl.reservationUnit.availabilities.length && $ctrl.reservationUnit.whoCanReserve === \'staffOnly\'"> <span translate=RESERVATIONS.BTN_CREATE ng-show=!$ctrl.reservation></span> <span translate=RESERVATIONS.BTN_UPDATE ng-show=$ctrl.reservation></span> </ff-btn> <ff-btn sense=remove ff-click="$ctrl.cancelConfirmation = true" ng-if=$ctrl.reservation> <span translate=RESERVATIONS.BTN_DELETE></span> </ff-btn> <ff-btn sense=calendar ff-click=$ctrl.navCalendar() ng-if=!$ctrl.hideCalendarBtn> <span translate=RESERVATIONS.BTN_CALENDAR></span> </ff-btn> <ff-btn sense=settings ng-if=$ctrl.stopWizard ff-click=$ctrl.stopWizard()> <span translate=GLOBAL.BTN_SETTINGS></span> </ff-btn> <ff-btn sense=signOut ng-if=$ctrl.signOut ff-click=$ctrl.signOut() ff-countdown=30> <span translate=GLOBAL.BTN_SIGN_OUT></span> </ff-btn> </ff-btn-group> </ff-col> <ff-col class=res-col-time> <div class=res-current-member ng-if="(state.isLoggedAdmin() || state.isMasterProfile()) && ($ctrl.reservation || $ctrl.user)"> <span translate=RESERVATIONS.USER></span>: <span ng-bind="$ctrl.reservation ? $ctrl.reservation.userName : $ctrl.user.fullName"></span> </div> <time-selector date=$ctrl.date time-start=$ctrl.timeStart time-end=$ctrl.timeEnd role=$ctrl.role scale=$ctrl.reservationUnit.scale buffer=$ctrl.reservationUnit.buffer reservations=$ctrl.reservationUnit.reservations availabilities=$ctrl.reservationUnit.availabilities></time-selector> <ff-info ng-if="!$ctrl.reservationUnit.availabilities.length && $ctrl.reservationUnit.whoCanReserve === \'staffOnly\'" style=position:absolute;top:0;width:100%;height:100%;padding-top:55px;text-align:center;text-transform:none;font-weight:400;background:rgba(255,255,255,.9);z-index:5 translate=RESERVATIONS.STAFF_ONLY translate-values="{ centerName: $ctrl.center.name, centerPhone: $ctrl.center.phone, centerEmail: $ctrl.center.email }"> </ff-info> </ff-col> </ff-row> </form> <form class=res-confirm ng-if="$ctrl.confirmation || $ctrl.cancelConfirmation" ng-style="{ marginTop: $app.hideHeader ? 0 : null }"> <div class=res-header> <h1 class=page-title ng-if=$ctrl.confirmation translate=RESERVATIONS.CONFIRM.PAGE_TITLE></h1> <h1 class=page-title ng-if=$ctrl.cancelConfirmation translate=RESERVATIONS.CANCEL.PAGE_TITLE></h1> <small translate=RESERVATIONS.HINT></small> </div> <ff-col class=res-confirm-body> <ff-panel> <ff-row ng-if="$ctrl.reservation ? $ctrl.reservation.companyName : $ctrl.user.company"> <ff-label flex="0 1 110px">Company</ff-label> <ff-static ff-bind="$ctrl.reservation ? $ctrl.reservation.companyName : $ctrl.user.company"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.USER></span></ff-label> <ff-static ff-bind="$ctrl.reservation ? $ctrl.reservation.userName : $ctrl.user.firstName + \' \' + $ctrl.user.lastName"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.LOCATION></span></ff-label> <ff-static ff-bind=$ctrl.center.name></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.SPACE></span></ff-label> <ff-static ff-bind=$ctrl.reservationUnit.name></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.DATE></span></ff-label> <ff-static ff-bind="$ctrl.date | date:\'mediumDate\'"></ff-static> </ff-row> <ff-row> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.TIME></span></ff-label> <ff-static><span nice-time=$ctrl.timeStart></span>&nbsp;-&nbsp;<span nice-time=$ctrl.timeEnd></span></ff-static> </ff-row> <div ng-if=$ctrl.hasRecurring()> <ff-row> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.REPEAT_FREQUENCY></span></ff-label> <ff-static ff-bind=$ctrl.repeatFrequency.name></ff-static> </ff-row> <ff-row ng-if=$ctrl.repeatFrequency.repeatDurationOptions> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.REPEAT_DURATION></span></ff-label> <ff-static ff-bind="$ctrl.repeatDuration + \' \' + $ctrl.repeatFrequency.repeatDurationUnit"></ff-static> </ff-row> </div> <ff-row ng-if=!$ctrl.hideReservationCostEstimate> <ff-label flex="0 1 110px"><span translate=RESERVATIONS.COST></span></ff-label> <ff-static ff-bind="$ctrl.totalCost | ncurrency | nd"></ff-static> </ff-row> <label class="ff-row ff-tmargin" style=margin-left:.5rem> <ff-checkbox name=emailConfirmation ff-model=$ctrl.emailConfirmation> <span translate=RESERVATIONS.EMAIL_CONFIRMATION></span> </ff-checkbox> </label> </ff-panel> </ff-col> <ff-btn-group class=buttons-bottom> <ff-btn sense=signOut ng-if=$ctrl.signOut ff-click=$ctrl.signOut() ff-countdown=30> <span translate=GLOBAL.BTN_SIGN_OUT></span> </ff-btn> <ff-btn sense=cancel ff-click="$ctrl.confirmation = $ctrl.cancelConfirmation = false"> <span translate=GLOBAL.BTN_CANCEL></span> </ff-btn> <ff-btn sense=ok type=submit ff-click="$ctrl.cancelConfirmation ? $ctrl.cancelReservation() : $ctrl.reservation ? $ctrl.updateReservation() : $ctrl.makeReservation()"> <span translate=GLOBAL.BTN_CONFIRM></span> </ff-btn> </ff-btn-group> </form> '},qNmJ:function(e,t,r){}}]);