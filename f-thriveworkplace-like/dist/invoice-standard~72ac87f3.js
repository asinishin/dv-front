(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{OiyR:function(t,e,n){"use strict";n("3dw1");var r=n("nbuU"),o=n.n(r),a=n("hsT8"),i=n.n(a);e.a=angular.module("deskworks.invoiceHelper",[]).factory("invoiceHelper",["$translate","$filter",function(t,e){var n=["recurring","rental","deposit","payment","refund"],r=[{id:"recurring",_name:"INVOICE.RECURRING",filter:function(t){return"recurring"===t.type}},{id:"rental",_name:"INVOICE.RENTAL",filter:function(t){return"rental"===t.type}},{id:"deposit",_name:"INVOICE.DEPOSITS",filter:function(t){return"deposit"===t.type}},{id:"other",_name:"INVOICE.OTHER_CHARGES",filter:function(t){return n.indexOf(t.type)<0}},{id:"payment",_name:"INVOICE.PAYMENTS",filter:function(t){return"payment"===t.type}},{id:"refund",_name:"INVOICE.REFUNDS",filter:function(t){return"refund"===t.type}}];return{getGroup:function(e){var n=e.items,a=e.type;return a=o()(r).call(r,(function(t){return t.id===a})),n=i()(n).call(n,(function(t){return t.include&&i()(a).call(a,t)})),{name:t.instant(a._name),items:n,total:n.reduce((function(t,e){return t+ +e.amount}),0)}},getChargesTotal:function(t){return i()(t).call(t,(function(t){return t.include&&"payment"!==t.type&&"refund"!==t.type})).reduce((function(t,e){return t+(+e.amount||0)}),0)},getTaxTotals:a,getBalance:function(t){var e=i()(t).call(t,(function(t){return t.include&&"payment"!==t.type&&"refund"!==t.type})).reduce((function(t,e){return t+(+e.amount||0)}),0)+t.reduce((function(t,e){return!e.include||"payment"!==e.type&&"refund"!==e.type?t:t+(+e.amount||0)}),0);return a(t).forEach((function(t){e+=t.amount||0})),e},getLogoSize:function(t){var e=t.resources,n=0,r=0;if(e.logo){r=80;var o=(n=140)/e.logo.width,a=r/e.logo.height;o<=a?r*=o/a:n*=a/o}return{width:n,height:r}}};function a(t){var e=[];return i()(t).call(t,(function(t){return t.include&&"payment"!==t.type&&"refund"!==t.type})).forEach((function(t){angular.forEach(t.taxes,(function(t,n){e.length<=n&&e.push({name:t.taxName,amount:0}),e[n].amount+=+t.taxAmount}))})),e}}])},vj9N:function(t,e,n){"use strict";n.r(e);var r=n("5/DJ"),o=angular.module("deskworks.invoiceStyles",["deskworks.helper",r.a.name]).factory("invoiceStyles",["helper","reportStyles",function(t,e){var n=angular.copy(e);return n.pageMargins[0]=50,n.pageMargins[2]=30,n.startY=170,n.header.textColor="#000000",n.headStyles={fontSize:9,fontStyle:"normal",valign:"middle",fillColor:100,textColor:255},n.h1={fontStyle:"bold",textColor:0,borderWidth:1,borderColor:[0,0,0]},n.h2={fontStyle:"bold",textColor:0,borderWidth:1,borderColor:[180,180,180]},n}]),a=(n("3dw1"),angular.module("deskworks.invoiceColumns",[]).factory("invoiceColumns",["$rootScope","$filter","$translate",function(t,e,n){var r=[{dataKey:"date",_title:"INVOICE.COLUMNS.DATE",include:!0,styles:{cellWidth:"wrap",halign:"right"},pdf:function(t){return e("date")(t,"mediumDate")},csv:function(t){return e("date")(t,"shortDate")}},{dataKey:"name",_title:"INVOICE.COLUMNS.ITEM",include:!0,styles:{minCellWidth:150}},{dataKey:"description",_title:"INVOICE.COLUMNS.DESCRIPTION",include:!0,styles:{minCellWidth:150}},{dataKey:"price",_title:"INVOICE.COLUMNS.RATE",include:!0,styles:{cellWidth:"wrap",halign:"right"},pdf:function(t){return e("ncurrency")(t)},csv:function(t){return e("ncurrency")(t)}},{dataKey:"qty",_title:"INVOICE.COLUMNS.QTY",include:!0,styles:{cellWidth:"wrap",halign:"right"},pdf:function(t){return e("round")(t)},csv:function(t){return e("round")(t)}},{dataKey:"amount",_title:"INVOICE.COLUMNS.AMOUNT",include:!0,styles:{cellWidth:"wrap",halign:"right"},pdf:function(t){return e("ncurrency")(t)},csv:function(t){return e("ncurrency")(t)}}];function o(){r.forEach((function(t){t.title=n.instant(t._title)}))}return o(),t.$on("$setTranslationsSuccess",o),r}])),i=(n("8cZI"),n("nbuU")),s=n.n(i),u=angular.module("deskworks.invoiceHeader",[o.name]).factory("invoiceHeader",["$filter","$translate","invoiceStyles",function(t,e,n){return function(r){var o,a,i,u,l=r.config,c=r.doc,d=r.data,m=r.resources,f=s()(o=m.centers).call(o,(function(t){return t.id===l.centerId})),p=c.internal.pageSize.width;if(c.setFont(c.getFont().fontName,"normal"),c.setTextColor(n.header.textColor),c.setFontSize(14),a=l.reportName.toUpperCase(),i=(p-c.getTextWidth(a))/2,u=40,c.text(a,i,u),1!==d.pageCount)return;c.setFontSize(10),c.setFont(c.getFont().fontName,"normal"),i=d.settings.margin.left,u=60,c.text(f.name,i,u),u+=12,c.text(f.street1||"",i,u),f.street2&&(u+=12,c.text(f.street2||"",i,u));u+=12,c.text([f.city,f.state.name||f.state,f.zip].join(", "),i,u),u+=12,c.text(e.instant("INVOICE.HEADER.PHONE").toUpperCase()+": "+f.phone,i,u),f.taxId&&(u+=12,c.text(e.instant("INVOICE.HEADER.TAX_ID").toUpperCase()+": "+f.taxId,i,u));var g=u+18;if(m.logo){i=p-d.settings.margin.right,u=50;var y=140,h=50,C=y/m.logo.width,E=h/m.logo.height;C<=E?h*=C/E:y*=E/C,c.addImage(m.logo.data,i-y,u,y,h)}c.setFontSize(8),c.setFont(c.getFont().fontName,"bold"),i=d.settings.margin.left,u=g,c.text(e.instant("INVOICE.HEADER.BILL_TO").toUpperCase()+":",i,u),c.setFontSize(10),c.setFont(c.getFont().fontName,"normal"),u+=12,c.text(l.userName||"",i,u),u+=12,c.text(l.userCompany||"",i,u),l.address&&(u+=12,c.text(l.address.street||"",i,u),u+=12,c.text([l.address.city,l.address.state.name||l.address.state,l.address.zip].join(", "),i,u));i=p-d.settings.margin.right,u=g,c.setFontSize(8),c.setFont(c.getFont().fontName,"bold"),a=e.instant("INVOICE.HEADER.DATE").toUpperCase()+":",c.text(a,i-c.getTextWidth(a),u),c.setFontSize(10),c.setFont(c.getFont().fontName,"normal"),u+=12,a=t("date")(l.date||l.endDate,"mediumDate"),c.text(a,i-c.getTextWidth(a),u),u+=12,c.setFontSize(8),c.setFont(c.getFont().fontName,"bold"),a=e.instant("INVOICE.HEADER.DUE_DATE").toUpperCase()+":",c.text(a,i-c.getTextWidth(a),u),c.setFontSize(10),c.setFont(c.getFont().fontName,"normal"),u+=12,a=t("date")(l.dueDate,"mediumDate"),c.text(a,i-c.getTextWidth(a),u)}}]),l=n("hsT8"),c=n.n(l),d=n("yCd9"),m=n.n(d),f=n("OiyR"),p=angular.module("deskworks.invoiceBody",[f.a.name,o.name]).factory("invoiceBody",["$translate","$filter","invoiceHelper","invoiceStyles",function(t,e,n,r){return function(o){o.params;var a=o.data,i=o.columns,s={columns:c()(i).call(i,(function(t){return t.include})),rows:[],styles:[]};l(n.getGroup({items:a.items,type:"recurring"})),l(n.getGroup({items:a.items,type:"rental"})),l(n.getGroup({items:a.items,type:"deposit"})),l(n.getGroup({items:a.items,type:"other"}));var u=n.getTaxTotals(a.items);u.length&&(s.rows.push([{content:t.instant("INVOICE.CHARGES")+":",colSpan:s.columns.length-1},{content:e("ncurrency")(n.getChargesTotal(a.items))}]),s.styles.push(r.h1),u.forEach((function(t){s.rows.push([{content:t.name+":",colSpan:s.columns.length-1},{content:e("ncurrency")(t.amount)}]),s.styles.push(r.h1)})));return l(n.getGroup({items:a.items,type:"payment"})),l(n.getGroup({items:a.items,type:"refund"})),s.rows.push([{content:t.instant("INVOICE.BALANCE")+":",colSpan:s.columns.length-1},{content:e("ncurrency")(n.getBalance(a.items))}]),s.styles.push(r.h1),s;function l(n){n.items&&n.items.length&&(s.rows.push([{content:n.name,colSpan:s.columns.length,styles:{halign:"left"}}]),s.styles.push(r.h2),n.items.forEach((function(t,e){var n;s.rows.push(m()(n=s.columns).call(n,(function(e){return t[e.dataKey]}))),s.styles.push(e%2?null:r.rowOdd)})),s.rows.push([{content:t.instant("INVOICE.SUBTOTAL")+":",colSpan:s.columns.length-1},{content:e("ncurrency")(n.total)}]),s.styles.push(r.h3))}}}]),g=["$injector",function(t){return t.loadNewModules([o.name,a.name,u.name,p.name]),{styles:t.get("invoiceStyles"),columns:t.get("invoiceColumns"),header:t.get("invoiceHeader"),body:t.get("invoiceBody")}}];e.default=g}}]);