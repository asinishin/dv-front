var c3=Object.defineProperty,l3=(ai,qe,O)=>qe in ai?c3(ai,qe,{enumerable:!0,configurable:!0,writable:!0,value:O}):ai[qe]=O,R=(ai,qe,O)=>(l3(ai,"symbol"!=typeof qe?qe+"":qe,O),O);(self.webpackChunktic_tac_toe_v2_front_end=self.webpackChunktic_tac_toe_v2_front_end||[]).push([[179],{158:(ai,qe,O)=>{"use strict";function ne(t){return"function"==typeof t}function Z(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const C=Z(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function Q(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class M{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(ne(r))try{r()}catch(s){e=s instanceof C?s.errors:[s]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const s of i)try{v(s)}catch(o){e=null!=e?e:[],o instanceof C?e=[...e,...o.errors]:e.push(o)}}if(e)throw new C(e)}}add(e){var n;if(e&&e!==this)if(this.closed)v(e);else{if(e instanceof M){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Q(n,e)}remove(e){const{_teardowns:n}=this;n&&Q(n,e),e instanceof M&&e._removeParent(this)}}M.EMPTY=(()=>{const t=new M;return t.closed=!0,t})();const _=M.EMPTY;function b(t){return t instanceof M||t&&"closed"in t&&ne(t.remove)&&ne(t.add)&&ne(t.unsubscribe)}function v(t){ne(t)?t():t.unsubscribe()}const T={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},G={setTimeout(...t){const{delegate:e}=G;return((null==e?void 0:e.setTimeout)||setTimeout)(...t)},clearTimeout(t){const{delegate:e}=G;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function V(t){G.setTimeout(()=>{const{onUnhandledError:e}=T;if(!e)throw t;e(t)})}function oe(){}const J=re("C",void 0,void 0);function re(t,e,n){return{kind:t,value:e,error:n}}let me=null;function se(t){if(T.useDeprecatedSynchronousErrorHandling){const e=!me;if(e&&(me={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=me;if(me=null,n)throw r}}else t()}class ie extends M{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,b(e)&&e.add(this)):this.destination=Ye}static create(e,n,r){return new Fe(e,n,r)}next(e){this.isStopped?ae(function $(t){return re("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?ae(function K(t){return re("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ae(J,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Fe extends ie{constructor(e,n,r){let i;if(super(),ne(e))i=e;else if(e){let s;({next:i,error:n,complete:r}=e),this&&T.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe()):s=e,i=null==i?void 0:i.bind(s),n=null==n?void 0:n.bind(s),r=null==r?void 0:r.bind(s)}this.destination={next:i?Ie(i):oe,error:Ie(null!=n?n:Be),complete:r?Ie(r):oe}}}function Ie(t,e){return(...n)=>{try{t(...n)}catch(r){T.useDeprecatedSynchronousErrorHandling?function le(t){T.useDeprecatedSynchronousErrorHandling&&me&&(me.errorThrown=!0,me.error=t)}(r):V(r)}}}function Be(t){throw t}function ae(t,e){const{onStoppedNotification:n}=T;n&&G.setTimeout(()=>n(t,e))}const Ye={closed:!0,next:oe,error:Be,complete:oe},Ot="function"==typeof Symbol&&Symbol.observable||"@@observable";function Pt(t){return t}let _t=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function wt(t){return t&&t instanceof ie||function bt(t){return t&&ne(t.next)&&ne(t.error)&&ne(t.complete)}(t)&&b(t)}(n)?n:new Fe(n,r,i);return se(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=nn(r))((i,s)=>{let o;o=this.subscribe(a=>{try{n(a)}catch(l){s(l),null==o||o.unsubscribe()}},s,i)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[Ot](){return this}pipe(...n){return function Gt(t){return 0===t.length?Pt:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}(n)(this)}toPromise(n){return new(n=nn(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function nn(t){var e;return null!==(e=null!=t?t:T.Promise)&&void 0!==e?e:Promise}const Yt=Z(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Bt=(()=>{class t extends _t{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new Bn(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Yt}next(n){se(()=>{if(this._throwIfClosed(),!this.isStopped){const r=this.observers.slice();for(const i of r)i.next(n)}})}error(n){se(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){se(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?_:(s.push(n),new M(()=>Q(s,n)))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new _t;return n.source=this,n}}return t.create=(e,n)=>new Bn(e,n),t})();class Bn extends Bt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:_}}function qn(t){return ne(null==t?void 0:t.lift)}function Mt(t){return e=>{if(qn(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}class Vt extends ie{constructor(e,n,r,i,s){super(e),this.onFinalize=s,this._next=n?function(o){try{n(o)}catch(a){e.error(a)}}:super._next,this._error=i?function(o){try{i(o)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function ct(t,e){return Mt((n,r)=>{let i=0;n.subscribe(new Vt(r,s=>{r.next(t.call(e,s,i++))}))})}function cn(t){return this instanceof cn?(this.v=t,this):new cn(t)}function Fr(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(E){r[E]&&(i[E]=function(x){return new Promise(function(j,de){s.push([E,x,j,de])>1||a(E,x)})})}function a(E,x){try{!function l(E){E.value instanceof cn?Promise.resolve(E.value.v).then(f,p):m(s[0][2],E)}(r[E](x))}catch(j){m(s[0][3],j)}}function f(E){a("next",E)}function p(E){a("throw",E)}function m(E,x){E(x),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Qt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function it(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){!function i(s,o,a,l){Promise.resolve(l).then(function(f){s({value:f,done:a})},o)}(a,l,(o=t[s](o)).done,o.value)})}}}const Ne=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Ua(t){return ne(null==t?void 0:t.then)}function Ha(t){return ne(t[Ot])}function Gs(t){return Symbol.asyncIterator&&ne(null==t?void 0:t[Symbol.asyncIterator])}function $r(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ps=function Eo(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ln(t){return ne(null==t?void 0:t[ps])}function Ut(t){return Fr(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield cn(n.read());if(i)return yield cn(void 0);yield yield cn(r)}}finally{n.releaseLock()}})}function xo(t){return ne(null==t?void 0:t.getReader)}function $t(t){if(t instanceof _t)return t;if(null!=t){if(Ha(t))return function ar(t){return new _t(e=>{const n=t[Ot]();if(ne(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Ne(t))return function qr(t){return new _t(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(Ua(t))return function _c(t){return new _t(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,V)})}(t);if(Gs(t))return Va(t);if(ln(t))return function bc(t){return new _t(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(xo(t))return function Yn(t){return Va(Ut(t))}(t)}throw $r(t)}function Va(t){return new _t(e=>{(function Kr(t,e){var n,r,i,s;return function ce(t,e,n,r){return new(n||(n=Promise))(function(s,o){function a(p){try{f(r.next(p))}catch(m){o(m)}}function l(p){try{f(r.throw(p))}catch(m){o(m)}}function f(p){p.done?s(p.value):function i(s){return s instanceof n?s:new n(function(o){o(s)})}(p.value).then(a,l)}f((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=Qt(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function Ir(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function sn(t,e,n=1/0){return ne(e)?sn((r,i)=>ct((s,o)=>e(r,s,i,o))($t(t(r,i))),n):("number"==typeof e&&(n=e),Mt((r,i)=>function wc(t,e,n,r,i,s,o,a){const l=[];let f=0,p=0,m=!1;const E=()=>{m&&!l.length&&!f&&e.complete()},x=de=>f<r?j(de):l.push(de),j=de=>{s&&e.next(de),f++;let we=!1;$t(n(de,p++)).subscribe(new Vt(e,xe=>{null==i||i(xe),s?x(xe):e.next(xe)},()=>{we=!0},void 0,()=>{if(we)try{for(f--;l.length&&f<r;){const xe=l.shift();o?Ir(e,o,()=>j(xe)):j(xe)}E()}catch(xe){e.error(xe)}}))};return t.subscribe(new Vt(e,x,()=>{m=!0,E()})),()=>{null==a||a()}}(r,i,t,n)))}function Ti(t=1/0){return sn(Pt,t)}const Gr=new _t(t=>t.complete());function Do(t){return t[t.length-1]}function gs(t){return function Co(t){return t&&ne(t.schedule)}(Do(t))?t.pop():void 0}function Sc(t,e=0){return Mt((n,r)=>{n.subscribe(new Vt(r,i=>Ir(r,t,()=>r.next(i),e),()=>Ir(r,t,()=>r.complete(),e),i=>Ir(r,t,()=>r.error(i),e)))})}function Ka(t,e=0){return Mt((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Cc(t,e){if(!t)throw new Error("Iterable cannot be null");return new _t(n=>{Ir(n,e,()=>{const r=t[Symbol.asyncIterator]();Ir(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function bn(t,e){return e?function Yd(t,e){if(null!=t){if(Ha(t))return function Ec(t,e){return $t(t).pipe(Ka(e),Sc(e))}(t,e);if(Ne(t))return function fn(t,e){return new _t(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(Ua(t))return function xc(t,e){return $t(t).pipe(Ka(e),Sc(e))}(t,e);if(Gs(t))return Cc(t,e);if(ln(t))return function Wd(t,e){return new _t(n=>{let r;return Ir(n,e,()=>{r=t[ps](),Ir(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>ne(null==r?void 0:r.return)&&r.return()})}(t,e);if(xo(t))return function Jd(t,e){return Cc(Ut(t),e)}(t,e)}throw $r(t)}(t,e):$t(t)}function Ao(t){return t<=0?()=>Gr:Mt((e,n)=>{let r=0;e.subscribe(new Vt(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Ga(t,e,...n){return!0===e?(t(),null):!1===e?null:e(...n).pipe(Ao(1)).subscribe(()=>t())}function Nt(t){for(let e in t)if(t[e]===Nt)return e;throw Error("Could not find renamed property on target object.")}function u(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(u).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function d(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const h=Nt({__forward_ref__:Nt});function g(t){return t.__forward_ref__=g,t.toString=function(){return u(this())},t}function y(t){return function D(t){return"function"==typeof t&&t.hasOwnProperty(h)&&t.__forward_ref__===g}(t)?t():t}class F extends Error{constructor(e,n){super(function N(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function P(t){return"string"==typeof t?t:null==t?"":String(t)}function U(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():P(t)}function be(t,e){const n=e?` in ${e}`:"";throw new F(-201,`No provider for ${U(t)} found${n}`)}function mt(t,e){null==t&&function tt(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function ze(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Lt(t){return{providers:t.providers||[],imports:t.imports||[]}}function Pn(t){return ms(t,vs)||ms(t,mr)}function ms(t,e){return t.hasOwnProperty(e)?t[e]:null}function Ji(t){return t&&(t.hasOwnProperty(Yi)||t.hasOwnProperty(yr))?t[Yi]:null}const vs=Nt({\u0275prov:Nt}),Yi=Nt({\u0275inj:Nt}),mr=Nt({ngInjectableDef:Nt}),yr=Nt({ngInjectorDef:Nt});var st=(()=>((st=st||{})[st.Default=0]="Default",st[st.Host=1]="Host",st[st.Self=2]="Self",st[st.SkipSelf=4]="SkipSelf",st[st.Optional=8]="Optional",st))();let Qi;function vr(t){const e=Qi;return Qi=t,e}function Io(t,e,n){const r=Pn(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&st.Optional?null:void 0!==e?e:void be(u(t),"Injector")}function Sn(t){return{toString:t}.toString()}var kn=(()=>((kn=kn||{})[kn.OnPush=0]="OnPush",kn[kn.Default=1]="Default",kn))(),En=(()=>{return(t=En||(En={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",En;var t})();const _s="undefined"!=typeof globalThis&&globalThis,yn="undefined"!=typeof window&&window,za="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,xt=_s||"undefined"!=typeof global&&global||yn||za,Zi={},Kt=[],Dc=Nt({\u0275cmp:Nt}),Xd=Nt({\u0275dir:Nt}),ef=Nt({\u0275pipe:Nt}),cm=Nt({\u0275mod:Nt}),Xi=Nt({\u0275fac:Nt}),Wa=Nt({__NG_ELEMENT_ID__:Nt});let tE=0;function _r(t){return Sn(()=>{const n={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===kn.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Kt,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||En.Emulated,id:"c",styles:t.styles||Kt,_:null,setInput:null,schemas:t.schemas||null,tView:null},i=t.directives,s=t.features,o=t.pipes;return r.id+=tE++,r.inputs=hm(t.inputs,n),r.outputs=hm(t.outputs),s&&s.forEach(a=>a(r)),r.directiveDefs=i?()=>("function"==typeof i?i():i).map(lm):null,r.pipeDefs=o?()=>("function"==typeof o?o():o).map(dm):null,r})}function lm(t){return Xn(t)||function ws(t){return t[Xd]||null}(t)}function dm(t){return function Ws(t){return t[ef]||null}(t)}const fm={};function ki(t){return Sn(()=>{const e={type:t.type,bootstrap:t.bootstrap||Kt,declarations:t.declarations||Kt,imports:t.imports||Kt,exports:t.exports||Kt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(fm[t.id]=t.type),e})}function hm(t,e){if(null==t)return Zi;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}const Zn=_r;function Xn(t){return t[Dc]||null}function zr(t,e){const n=t[cm]||null;if(!n&&!0===e)throw new Error(`Type ${u(t)} does not have '\u0275mod' property.`);return n}function Mi(t){return Array.isArray(t)&&"object"==typeof t[1]}function ci(t){return Array.isArray(t)&&!0===t[1]}function rf(t){return 0!=(8&t.flags)}function Tc(t){return 2==(2&t.flags)}function Pc(t){return 1==(1&t.flags)}function li(t){return null!==t.template}function aE(t){return 0!=(512&t[2])}function Zs(t,e){return t.hasOwnProperty(Xi)?t[Xi]:null}class lE{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function gm(t){return t.type.prototype.ngOnChanges&&(t.setInput=fE),dE}function dE(){const t=ym(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===Zi)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function fE(t,e,n,r){const i=ym(t)||function hE(t,e){return t[mm]=e}(t,{previous:Zi,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[n],l=o[a];s[a]=new lE(l&&l.currentValue,e,o===Zi),t[r]=e}const mm="__ngSimpleChanges__";function ym(t){return t[mm]||null}let af;function hn(t){return!!t.listen}const bm={createRenderer:(t,e)=>function uf(){return void 0!==af?af:"undefined"!=typeof document?document:void 0}()};function xn(t){for(;Array.isArray(t);)t=t[0];return t}function kc(t,e){return xn(e[t])}function Yr(t,e){return xn(e[t.index])}function cf(t,e){return t.data[e]}function Pr(t,e){const n=e[t];return Mi(n)?n:n[0]}function lf(t){return 128==(128&t[2])}function Ss(t,e){return null==e?null:t[e]}function Sm(t){t[18]=0}function df(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const ot={lFrame:Tm(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Em(){return ot.bindingsEnabled}function Pe(){return ot.lFrame.lView}function Tt(){return ot.lFrame.tView}function Mc(t){return ot.lFrame.contextLView=t,t[8]}function Mn(){let t=xm();for(;null!==t&&64===t.type;)t=t.parent;return t}function xm(){return ot.lFrame.currentTNode}function Ri(t,e){const n=ot.lFrame;n.currentTNode=t,n.isParent=e}function ff(){return ot.lFrame.isParent}function hf(){ot.lFrame.isParent=!1}function Rc(){return ot.isInCheckNoChangesMode}function Oc(t){ot.isInCheckNoChangesMode=t}function No(){return ot.lFrame.bindingIndex++}function ts(t){const e=ot.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function AE(t,e){const n=ot.lFrame;n.bindingIndex=n.bindingRootIndex=t,pf(e)}function pf(t){ot.lFrame.currentDirectiveIndex=t}function mf(t){ot.lFrame.currentQueryIndex=t}function IE(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Fm(t,e,n){if(n&st.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&st.Host||(i=IE(s),null===i||(s=s[15],10&i.type))););if(null===i)return!1;e=i,t=s}const r=ot.lFrame=Im();return r.currentTNode=e,r.lView=t,!0}function Nc(t){const e=Im(),n=t[1];ot.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Im(){const t=ot.lFrame,e=null===t?null:t.child;return null===e?Tm(t):e}function Tm(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Pm(){const t=ot.lFrame;return ot.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const km=Pm;function Lc(){const t=Pm();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function lr(){return ot.lFrame.selectedIndex}function Es(t){ot.lFrame.selectedIndex=t}function pn(){const t=ot.lFrame;return cf(t.tView,t.selectedIndex)}function jc(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:f,ngOnDestroy:p}=s;o&&(t.contentHooks||(t.contentHooks=[])).push(-n,o),a&&((t.contentHooks||(t.contentHooks=[])).push(n,a),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,a)),l&&(t.viewHooks||(t.viewHooks=[])).push(-n,l),f&&((t.viewHooks||(t.viewHooks=[])).push(n,f),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,f)),null!=p&&(t.destroyHooks||(t.destroyHooks=[])).push(n,p)}}function Bc(t,e,n){Mm(t,e,3,n)}function Uc(t,e,n,r){(3&t[2])===n&&Mm(t,e,n,r)}function yf(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function Mm(t,e,n,r){const s=null!=r?r:-1,o=e.length-1;let a=0;for(let l=void 0!==r?65535&t[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=r&&a>=r)break}else e[l]<0&&(t[18]+=65536),(a<s||-1==s)&&(jE(t,n,e,l),t[18]=(4294901760&t[18])+l+2),l++}function jE(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];if(i){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Xa{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Hc(t,e,n){const r=hn(t);let i=0;for(;i<n.length;){const s=n[i];if("number"==typeof s){if(0!==s)break;i++;const o=n[i++],a=n[i++],l=n[i++];r?t.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=n[++i];_f(o)?r&&t.setProperty(e,o,a):r?t.setAttribute(e,o,a):e.setAttribute(o,a),i++}}return i}function Rm(t){return 3===t||4===t||6===t}function _f(t){return 64===t.charCodeAt(0)}function Vc(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||Om(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function Om(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}function Nm(t){return-1!==t}function Lo(t){return 32767&t}function jo(t,e){let n=function $E(t){return t>>16}(t),r=e;for(;n>0;)r=r[15],n--;return r}let bf=!0;function $c(t){const e=bf;return bf=t,e}let qE=0;function tu(t,e){const n=Sf(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,wf(r.data,t),wf(e,null),wf(r.blueprint,null));const i=qc(t,e),s=t.injectorIndex;if(Nm(i)){const o=Lo(i),a=jo(i,e),l=a[1].data;for(let f=0;f<8;f++)e[s+f]=a[o+f]|l[o+f]}return e[s+8]=i,s}function wf(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Sf(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function qc(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){const s=i[1],o=s.type;if(r=2===o?s.declTNode:1===o?i[6]:null,null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Kc(t,e,n){!function KE(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Wa)&&(r=n[Wa]),null==r&&(r=n[Wa]=qE++);const i=255&r;e.data[t+(i>>5)]|=1<<i}(t,e,n)}function Bm(t,e,n){if(n&st.Optional)return t;be(e,"NodeInjector")}function Um(t,e,n,r){if(n&st.Optional&&void 0===r&&(r=null),0==(n&(st.Self|st.Host))){const i=t[9],s=vr(void 0);try{return i?i.get(e,r,n&st.Optional):Io(e,r,n&st.Optional)}finally{vr(s)}}return Bm(r,e,n)}function Hm(t,e,n,r=st.Default,i){if(null!==t){const s=function JE(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Wa)?t[Wa]:void 0;return"number"==typeof e?e>=0?255&e:zE:e}(n);if("function"==typeof s){if(!Fm(e,t,r))return r&st.Host?Bm(i,n,r):Um(e,n,r,i);try{const o=s(r);if(null!=o||r&st.Optional)return o;be(n)}finally{km()}}else if("number"==typeof s){let o=null,a=Sf(t,e),l=-1,f=r&st.Host?e[16][6]:null;for((-1===a||r&st.SkipSelf)&&(l=-1===a?qc(t,e):e[a+8],-1!==l&&qm(r,!1)?(o=e[1],a=Lo(l),e=jo(l,e)):a=-1);-1!==a;){const p=e[1];if($m(s,a,p.data)){const m=WE(a,e,n,o,r,f);if(m!==Vm)return m}l=e[a+8],-1!==l&&qm(r,e[1].data[a+8]===f)&&$m(s,a,e)?(o=p,a=Lo(l),e=jo(l,e)):a=-1}}}return Um(e,n,r,i)}const Vm={};function zE(){return new Bo(Mn(),Pe())}function WE(t,e,n,r,i,s){const o=e[1],a=o.data[t+8],p=function Gc(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,p=s>>20,E=i?a+p:t.directiveEnd;for(let x=r?a:a+p;x<E;x++){const j=o[x];if(x<l&&n===j||x>=l&&j.type===n)return x}if(i){const x=o[l];if(x&&li(x)&&x.type===n)return l}return null}(a,o,n,null==r?Tc(a)&&bf:r!=o&&0!=(3&a.type),i&st.Host&&s===a);return null!==p?nu(e,o,p,a):Vm}function nu(t,e,n,r){let i=t[n];const s=e.data;if(function BE(t){return t instanceof Xa}(i)){const o=i;o.resolving&&function X(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new F(-200,`Circular dependency in DI detected for ${t}${n}`)}(U(s[n]));const a=$c(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?vr(o.injectImpl):null;Fm(t,r,st.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function LE(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=gm(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==l&&vr(l),$c(a),o.resolving=!1,km()}}return i}function $m(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function qm(t,e){return!(t&st.Self||t&st.Host&&e)}class Bo{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return Hm(this._tNode,this._lView,e,r,n)}}const Ho="__parameters__";function $o(t,e,n){return Sn(()=>{const r=function xf(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(l,f,p){const m=l.hasOwnProperty(Ho)?l[Ho]:Object.defineProperty(l,Ho,{value:[]})[Ho];for(;m.length<=p;)m.push(null);return(m[p]=m[p]||[]).push(o),l}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class Ct{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ze({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const ZE=new Ct("AnalyzeForEntryComponents");function Oi(t,e){t.forEach(n=>Array.isArray(n)?Oi(n,e):e(n))}function Gm(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function zc(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function ou(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function kr(t,e,n){let r=qo(t,e);return r>=0?t[1|r]=n:(r=~r,function tx(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function Df(t,e){const n=qo(t,e);if(n>=0)return t[1|n]}function qo(t,e){return function Jm(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){const s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}(t,e,1)}const au={},Ff="__NG_DI_FLAG__",Jc="ngTempTokenPath",ux=/\n/gm,Qm="__source",lx=Nt({provide:String,useValue:Nt});let uu;function Zm(t){const e=uu;return uu=t,e}function dx(t,e=st.Default){if(void 0===uu)throw new F(203,"");return null===uu?Io(t,void 0,e):uu.get(t,e&st.Optional?null:void 0,e)}function Qe(t,e=st.Default){return(function Fo(){return Qi}()||dx)(y(t),e)}function If(t){const e=[];for(let n=0;n<t.length;n++){const r=y(t[n]);if(Array.isArray(r)){if(0===r.length)throw new F(900,"");let i,s=st.Default;for(let o=0;o<r.length;o++){const a=r[o],l=fx(a);"number"==typeof l?-1===l?i=a.token:s|=l:i=a}e.push(Qe(i,s))}else e.push(Qe(r))}return e}function cu(t,e){return t[Ff]=e,t.prototype[Ff]=e,t}function fx(t){return t[Ff]}const lu=cu($o("Inject",t=>({token:t})),-1),Ni=cu($o("Optional"),8),Ko=cu($o("SkipSelf"),4);function Cs(t){return t instanceof class u0{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?t.changingThisBreaksApplicationSecurity:t}const v0="__ngContext__";function tr(t,e){t[v0]=e}function Bf(t){const e=function gu(t){return t[v0]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Hf(t){return t.ngOriginalError}function iC(t,...e){t.error(...e)}class Wo{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e),r=function rC(t){return t&&t.ngErrorLogger||iC}(e);r(this._console,"ERROR",e),n&&r(this._console,"ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Hf(e);for(;n&&Hf(n);)n=Hf(n);return n||null}}const E0=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(xt))();function ji(t){return t instanceof Function?t():t}var Mr=(()=>((Mr=Mr||{})[Mr.Important=1]="Important",Mr[Mr.DashCase=2]="DashCase",Mr))();function $f(t,e){return undefined(t,e)}function mu(t){const e=t[3];return ci(e)?e[3]:e}function qf(t){return F0(t[13])}function Kf(t){return F0(t[4])}function F0(t){for(;null!==t&&!ci(t);)t=t[4];return t}function Yo(t,e,n,r,i){if(null!=r){let s,o=!1;ci(r)?s=r:Mi(r)&&(o=!0,r=r[0]);const a=xn(r);0===t&&null!==n?null==i?R0(e,n,a):eo(e,n,a,i||null,!0):1===t&&null!==n?eo(e,n,a,i||null,!0):2===t?function H0(t,e,n){const r=tl(t,e);r&&function AC(t,e,n,r){hn(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function TC(t,e,n,r,i){const s=n[7];s!==xn(n)&&Yo(e,t,r,s,i);for(let a=10;a<n.length;a++){const l=n[a];yu(l[1],l,t,e,r,s)}}(e,t,s,n,i)}}function zf(t,e,n){return hn(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function T0(t,e){const n=t[9],r=n.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,df(i,-1)),n.splice(r,1)}function Wf(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&T0(i,r),e>0&&(t[n-1][4]=r[4]);const s=zc(t,10+e);!function _C(t,e){yu(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const o=s[19];null!==o&&o.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function P0(t,e){if(!(256&e[2])){const n=e[11];hn(n)&&n.destroyNode&&yu(t,e,n,3,null,null),function SC(t){let e=t[13];if(!e)return Jf(t[1],t);for(;e;){let n=null;if(Mi(e))n=e[13];else{const r=e[10];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)Mi(e)&&Jf(e[1],e),e=e[3];null===e&&(e=t),Mi(e)&&Jf(e[1],e),n=e&&e[4]}e=n}}(e)}}function Jf(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function DC(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Xa)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(i)}finally{}}}}(t,e),function CC(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+1],a="function"==typeof o?o(e):xn(e[o]),l=r[i=n[s+2]],f=n[s+3];"boolean"==typeof f?a.removeEventListener(n[s],l,f):f>=0?r[i=f]():r[i=-f].unsubscribe(),s+=2}else{const o=r[i=n[s+1]];n[s].call(o)}if(null!==r){for(let s=i+1;s<r.length;s++)r[s]();e[7]=null}}(t,e),1===e[1].type&&hn(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&ci(e[3])){n!==e[3]&&T0(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function k0(t,e,n){return function M0(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const i=t.data[r.directiveStart].encapsulation;if(i===En.None||i===En.Emulated)return null}return Yr(r,n)}(t,e.parent,n)}function eo(t,e,n,r,i){hn(t)?t.insertBefore(e,n,r,i):e.insertBefore(n,r,i)}function R0(t,e,n){hn(t)?t.appendChild(e,n):e.appendChild(n)}function O0(t,e,n,r,i){null!==r?eo(t,e,n,r,i):R0(t,e,n)}function tl(t,e){return hn(t)?t.parentNode(e):e.parentNode}function N0(t,e,n){return j0(t,e,n)}let j0=function L0(t,e,n){return 40&t.type?Yr(t,n):null};function nl(t,e,n,r){const i=k0(t,r,e),s=e[11],a=N0(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(n))for(let l=0;l<n.length;l++)O0(s,i,n[l],a,!1);else O0(s,i,n,a,!1)}function rl(t,e){if(null!==e){const n=e.type;if(3&n)return Yr(e,t);if(4&n)return Qf(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return rl(t,r);{const i=t[e.index];return ci(i)?Qf(-1,i):xn(i)}}if(32&n)return $f(e,t)()||xn(t[e.index]);{const r=U0(t,e);return null!==r?Array.isArray(r)?r[0]:rl(mu(t[16]),r):rl(t,e.next)}}return null}function U0(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Qf(t,e){const n=10+t+1;if(n<e.length){const r=e[n],i=r[1].firstChild;if(null!==i)return rl(r,i)}return e[7]}function Zf(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],l=n.type;if(o&&0===e&&(a&&tr(xn(a),r),n.flags|=4),64!=(64&n.flags))if(8&l)Zf(t,e,n.child,r,i,s,!1),Yo(e,t,i,a,s);else if(32&l){const f=$f(n,r);let p;for(;p=f();)Yo(e,t,i,p,s);Yo(e,t,i,a,s)}else 16&l?V0(t,e,r,n,i,s):Yo(e,t,i,a,s);n=o?n.projectionNext:n.next}}function yu(t,e,n,r,i,s){Zf(n,r,t.firstChild,e,i,s,!1)}function V0(t,e,n,r,i,s){const o=n[16],l=o[6].projection[r.projection];if(Array.isArray(l))for(let f=0;f<l.length;f++)Yo(e,t,i,l[f],s);else Zf(t,e,l,o[3],i,s,!0)}function $0(t,e,n){hn(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Xf(t,e,n){hn(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function q0(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}const K0="ng-template";function kC(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==q0(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function G0(t){return 4===t.type&&t.value!==K0}function MC(t,e,n){return e===(4!==t.type||n?t.value:K0)}function RC(t,e,n){let r=4;const i=t.attrs||[],s=function LC(t){for(let e=0;e<t.length;e++)if(Rm(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&r){if(r=2|1&r,""!==l&&!MC(t,l,n)||""===l&&1===e.length){if(di(r))return!1;o=!0}}else{const f=8&r?l:e[++a];if(8&r&&null!==t.attrs){if(!kC(t.attrs,f,n)){if(di(r))return!1;o=!0}continue}const m=OC(8&r?"class":l,i,G0(t),n);if(-1===m){if(di(r))return!1;o=!0;continue}if(""!==f){let E;E=m>s?"":i[m+1].toLowerCase();const x=8&r?E:null;if(x&&-1!==q0(x,f,0)||2&r&&f!==E){if(di(r))return!1;o=!0}}}}else{if(!o&&!di(r)&&!di(l))return!1;if(o&&di(l))continue;o=!1,r=l|1&r}}return di(r)||o}function di(t){return 0==(1&t)}function OC(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function jC(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function z0(t,e,n=!1){for(let r=0;r<e.length;r++)if(RC(t,e[r],n))return!0;return!1}function BC(t,e){e:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let i=0;i<t.length;i++)if(t[i]!==r[i])continue e;return!0}}return!1}function W0(t,e){return t?":not("+e.trim()+")":e}function UC(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!di(o)&&(e+=W0(s,i),i=""),r=o,s=s||!di(r);n++}return""!==i&&(e+=W0(s,i)),e}const at={};function Wt(t){J0(Tt(),Pe(),lr()+t,Rc())}function J0(t,e,n,r){if(!r)if(3==(3&e[2])){const s=t.preOrderCheckHooks;null!==s&&Bc(e,s,n)}else{const s=t.preOrderHooks;null!==s&&Uc(e,s,0,n)}Es(n)}function il(t,e){return t<<17|e<<2}function fi(t){return t>>17&32767}function eh(t){return 2|t}function ns(t){return(131068&t)>>2}function th(t,e){return-131069&t|e<<2}function nh(t){return 1|t}function oy(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],s=n[r+1];if(-1!==s){const o=t.data[s];mf(i),o.contentQueries(2,e[s],s)}}}function vu(t,e,n,r,i,s,o,a,l,f){const p=e.blueprint.slice();return p[0]=i,p[2]=140|r,Sm(p),p[3]=p[15]=t,p[8]=n,p[10]=o||t&&t[10],p[11]=a||t&&t[11],p[12]=l||t&&t[12]||null,p[9]=f||t&&t[9]||null,p[6]=s,p[16]=2==e.type?t[16]:p,p}function Qo(t,e,n,r,i){let s=t.data[e];if(null===s)s=function dh(t,e,n,r,i){const s=xm(),o=ff(),l=t.data[e]=function iD(t,e,n,r,i,s){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(t,e,n,r,i),function DE(){return ot.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function Za(){const t=ot.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ri(s,!0),s}function Zo(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function _u(t,e,n){Nc(e);try{const r=t.viewQuery;null!==r&&bh(1,r,n);const i=t.template;null!==i&&ay(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&oy(t,e),t.staticViewQueries&&bh(2,t.viewQuery,n);const s=t.components;null!==s&&function tD(t,e){for(let n=0;n<e.length;n++)SD(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,Lc()}}function Xo(t,e,n,r){const i=e[2];if(256==(256&i))return;Nc(e);const s=Rc();try{Sm(e),function Cm(t){return ot.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&ay(t,e,n,2,r);const o=3==(3&i);if(!s)if(o){const f=t.preOrderCheckHooks;null!==f&&Bc(e,f,null)}else{const f=t.preOrderHooks;null!==f&&Uc(e,f,0,null),yf(e,0)}if(function bD(t){for(let e=qf(t);null!==e;e=Kf(e)){if(!e[2])continue;const n=e[9];for(let r=0;r<n.length;r++){const i=n[r],s=i[3];0==(1024&i[2])&&df(s,1),i[2]|=1024}}}(e),function _D(t){for(let e=qf(t);null!==e;e=Kf(e))for(let n=10;n<e.length;n++){const r=e[n],i=r[1];lf(r)&&Xo(i,r,i.template,r[8])}}(e),null!==t.contentQueries&&oy(t,e),!s)if(o){const f=t.contentCheckHooks;null!==f&&Bc(e,f)}else{const f=t.contentHooks;null!==f&&Uc(e,f,1),yf(e,1)}!function XC(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)Es(~i);else{const s=i,o=n[++r],a=n[++r];AE(o,s),a(2,e[s])}}}finally{Es(-1)}}(t,e);const a=t.components;null!==a&&function eD(t,e){for(let n=0;n<e.length;n++)wD(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&bh(2,l,r),!s)if(o){const f=t.viewCheckHooks;null!==f&&Bc(e,f)}else{const f=t.viewHooks;null!==f&&Uc(e,f,2),yf(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,df(e[3],-1))}finally{Lc()}}function nD(t,e,n,r){const i=e[10],s=!Rc(),o=function wm(t){return 4==(4&t[2])}(e);try{s&&!o&&i.begin&&i.begin(),o&&_u(t,e,r),Xo(t,e,n,r)}finally{s&&!o&&i.end&&i.end()}}function ay(t,e,n,r,i){const s=lr(),o=2&r;try{Es(-1),o&&e.length>20&&J0(t,e,20,Rc()),n(r,i)}finally{Es(s)}}function uy(t,e,n){if(rf(e)){const i=e.directiveEnd;for(let s=e.directiveStart;s<i;s++){const o=t.data[s];o.contentQueries&&o.contentQueries(1,n[s],s)}}}function fh(t,e,n){!Em()||(function dD(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||tu(n,e),tr(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const l=t.data[a],f=li(l);f&&mD(e,n,l);const p=nu(e,t,a,n);tr(p,e),null!==o&&yD(0,a-i,p,l,0,o),f&&(Pr(n.index,e)[8]=p)}}(t,e,n,Yr(n,e)),128==(128&n.flags)&&function fD(t,e,n){const r=n.directiveStart,i=n.directiveEnd,o=n.index,a=function FE(){return ot.lFrame.currentDirectiveIndex}();try{Es(o);for(let l=r;l<i;l++){const f=t.data[l],p=e[l];pf(l),(null!==f.hostBindings||0!==f.hostVars||null!==f.hostAttrs)&&my(f,p)}}finally{Es(-1),pf(a)}}(t,e,n))}function hh(t,e,n=Yr){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}function cy(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=al(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function al(t,e,n,r,i,s,o,a,l,f){const p=20+r,m=p+i,E=function rD(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:at);return n}(p,m),x="function"==typeof f?f():f;return E[1]={type:t,blueprint:E,template:n,queries:null,viewQuery:a,declTNode:e,data:E.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:x,incompleteFirstPass:!1}}function hy(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function Rr(t,e,n,r,i,s,o,a){const l=Yr(e,n);let p,f=e.inputs;!a&&null!=f&&(p=f[r])?(Dy(t,n,p,r,i),Tc(e)&&function aD(t,e){const n=Pr(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r=function oD(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=o?o(i,e.value||"",r):i,hn(s)?s.setProperty(l,r,i):_f(r)||(l.setProperty?l.setProperty(r,i):l[r]=i))}function ph(t,e,n,r){let i=!1;if(Em()){const s=function hD(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let s=0;s<r.length;s++){const o=r[s];z0(n,o.selectors,!1)&&(i||(i=[]),Kc(tu(n,e),t,o.type),li(o)?(yy(t,n),i.unshift(o)):i.push(o))}return i}(t,e,n),o=null===r?null:{"":-1};if(null!==s){i=!0,vy(n,t.data.length,s.length);for(let p=0;p<s.length;p++){const m=s[p];m.providersResolver&&m.providersResolver(m)}let a=!1,l=!1,f=Zo(t,e,s.length,null);for(let p=0;p<s.length;p++){const m=s[p];n.mergedAttrs=Vc(n.mergedAttrs,m.hostAttrs),_y(t,n,e,f,m),gD(f,m,o),null!==m.contentQueries&&(n.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(n.flags|=128);const E=m.type.prototype;!a&&(E.ngOnChanges||E.ngOnInit||E.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),a=!0),!l&&(E.ngOnChanges||E.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),l=!0),f++}!function sD(t,e){const r=e.directiveEnd,i=t.data,s=e.attrs,o=[];let a=null,l=null;for(let f=e.directiveStart;f<r;f++){const p=i[f],m=p.inputs,E=null===s||G0(e)?null:vD(m,s);o.push(E),a=hy(m,f,a),l=hy(p.outputs,f,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(t,n)}o&&function pD(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new F(-301,`Export of name '${e[i+1]}' not found!`);r.push(e[i],s)}}}(n,r,o)}return n.mergedAttrs=Vc(n.mergedAttrs,n.attrs),i}function gy(t,e,n,r,i,s){const o=s.hostBindings;if(o){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const l=~e.index;(function lD(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(a)!=l&&a.push(l),a.push(r,i,o)}}function my(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function yy(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function gD(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;li(e)&&(n[""]=t)}}function vy(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function _y(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=Zs(i.type)),o=new Xa(s,li(i),null);t.blueprint[r]=o,n[r]=o,gy(t,e,0,r,Zo(t,n,i.hostVars,at),i)}function mD(t,e,n){const r=Yr(e,t),i=cy(n),s=t[10],o=ul(t,vu(t,i,null,n.onPush?64:16,r,e,s,s.createRenderer(r,n),null,null));t[e.index]=o}function yD(t,e,n,r,i,s){const o=s[e];if(null!==o){const a=r.setInput;for(let l=0;l<o.length;){const f=o[l++],p=o[l++],m=o[l++];null!==a?r.setInput(n,m,f,p):n[p]=m}}}function vD(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function by(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function wD(t,e){const n=Pr(e,t);if(lf(n)){const r=n[1];80&n[2]?Xo(r,n,r.template,n[8]):n[5]>0&&mh(n)}}function mh(t){for(let r=qf(t);null!==r;r=Kf(r))for(let i=10;i<r.length;i++){const s=r[i];if(1024&s[2]){const o=s[1];Xo(o,s,o.template,s[8])}else s[5]>0&&mh(s)}const n=t[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=Pr(n[r],t);lf(i)&&i[5]>0&&mh(i)}}function SD(t,e){const n=Pr(e,t),r=n[1];(function ED(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(r,n),_u(r,n,n[8])}function ul(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function yh(t){for(;t;){t[2]|=64;const e=mu(t);if(aE(t)&&!e)return t;t=e}return null}function _h(t,e,n){const r=e[10];r.begin&&r.begin();try{Xo(t,e,t.template,n)}catch(i){throw Cy(e,i),i}finally{r.end&&r.end()}}function wy(t){!function vh(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=Bf(n),i=r[1];nD(i,r,i.template,n)}}(t[8])}function bh(t,e,n){mf(0),e(t,n)}const AD=(()=>Promise.resolve(null))();function Sy(t){return t[7]||(t[7]=[])}function Ey(t){return t.cleanup||(t.cleanup=[])}function Cy(t,e){const n=t[9],r=n?n.get(Wo,null):null;r&&r.handleError(e)}function Dy(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=e[o],f=t.data[o];null!==f.setInput?f.setInput(l,i,r,a):l[a]=i}}function rs(t,e,n){const r=kc(e,t);!function I0(t,e,n){hn(t)?t.setValue(e,n):e.textContent=n}(t[11],r,n)}function cl(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=d(i,a):2==s&&(r=d(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}const wh=new Ct("INJECTOR",-1);class Ay{get(e,n=au){if(n===au){const r=new Error(`NullInjectorError: No provider for ${u(e)}!`);throw r.name="NullInjectorError",r}return n}}const Sh=new Ct("Set Injector scope."),bu={},TD={};let Eh;function Fy(){return void 0===Eh&&(Eh=new Ay),Eh}function Iy(t,e=null,n=null,r){const i=Ty(t,e,n,r);return i._resolveInjectorDefTypes(),i}function Ty(t,e=null,n=null,r){return new PD(t,n,e||Fy(),r)}class PD{constructor(e,n,r,i=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];n&&Oi(n,a=>this.processProvider(a,e,n)),Oi([e],a=>this.processInjectorType(a,[],s)),this.records.set(wh,ea(void 0,this));const o=this.records.get(Sh);this.scope=null!=o?o.value:null,this.source=i||("object"==typeof e?null:u(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,n=au,r=st.Default){this.assertNotDestroyed();const i=Zm(this),s=vr(void 0);try{if(!(r&st.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function BD(t){return"function"==typeof t||"object"==typeof t&&t instanceof Ct}(e)&&Pn(e);a=l&&this.injectableDefInScope(l)?ea(xh(e),bu):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(r&st.Self?Fy():this.parent).get(e,n=r&st.Optional&&n===au?null:n)}catch(o){if("NullInjectorError"===o.name){if((o[Jc]=o[Jc]||[]).unshift(u(e)),i)throw o;return function hx(t,e,n,r){const i=t[Jc];throw e[Qm]&&i.unshift(e[Qm]),t.message=function px(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=u(e);if(Array.isArray(e))i=e.map(u).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):u(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(ux,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[Jc]=null,t}(o,e,"R3InjectorError",this.source)}throw o}finally{vr(s),Zm(i)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((r,i)=>e.push(u(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new F(205,"")}processInjectorType(e,n,r){if(!(e=y(e)))return!1;let i=Ji(e);const s=null==i&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==r.indexOf(o);if(void 0!==s&&(i=Ji(s)),null==i)return!1;if(null!=i.imports&&!a){let p;r.push(o);try{Oi(i.imports,m=>{this.processInjectorType(m,n,r)&&(void 0===p&&(p=[]),p.push(m))})}finally{}if(void 0!==p)for(let m=0;m<p.length;m++){const{ngModule:E,providers:x}=p[m];Oi(x,j=>this.processProvider(j,E,x||Kt))}}this.injectorDefTypes.add(o);const l=Zs(o)||(()=>new o);this.records.set(o,ea(l,bu));const f=i.providers;if(null!=f&&!a){const p=e;Oi(f,m=>this.processProvider(m,p,f))}return void 0!==s&&void 0!==e.providers}processProvider(e,n,r){let i=ta(e=y(e))?e:y(e&&e.provide);const s=function MD(t,e,n){return ky(t)?ea(void 0,t.useValue):ea(function Py(t,e,n){let r;if(ta(t)){const i=y(t);return Zs(i)||xh(i)}if(ky(t))r=()=>y(t.useValue);else if(function OD(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...If(t.deps||[]));else if(function RD(t){return!(!t||!t.useExisting)}(t))r=()=>Qe(y(t.useExisting));else{const i=y(t&&(t.useClass||t.provide));if(!function LD(t){return!!t.deps}(t))return Zs(i)||xh(i);r=()=>new i(...If(t.deps))}return r}(t),bu)}(e);if(ta(e)||!0!==e.multi)this.records.get(i);else{let o=this.records.get(i);o||(o=ea(void 0,bu,!0),o.factory=()=>If(o.multi),this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,s)}hydrate(e,n){return n.value===bu&&(n.value=TD,n.value=n.factory()),"object"==typeof n.value&&n.value&&function jD(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=y(e.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function xh(t){const e=Pn(t),n=null!==e?e.factory:Zs(t);if(null!==n)return n;if(t instanceof Ct)throw new F(204,"");if(t instanceof Function)return function kD(t){const e=t.length;if(e>0)throw ou(e,"?"),new F(204,"");const n=function ys(t){const e=t&&(t[vs]||t[mr]);if(e){const n=function zs(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new F(204,"")}function ea(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function ky(t){return null!==t&&"object"==typeof t&&lx in t}function ta(t){return"function"==typeof t}let nr=(()=>{class t{static create(n,r){var i;if(Array.isArray(n))return Iy({name:""},r,n,"");{const s=null!==(i=n.name)&&void 0!==i?i:"";return Iy({name:s},n.parent,n.providers,s)}}}return t.THROW_IF_NOT_FOUND=au,t.NULL=new Ay,t.\u0275prov=ze({token:t,providedIn:"any",factory:()=>Qe(wh)}),t.__NG_ELEMENT_ID__=-1,t})();function zD(t,e){jc(Bf(t)[1],Mn())}let ll=null;function na(){if(!ll){const t=xt.Symbol;if(t&&t.iterator)ll=t.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<e.length;++n){const r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(ll=r)}}}return ll}function wu(t){return!!Fh(t)&&(Array.isArray(t)||!(t instanceof Map)&&na()in t)}function Fh(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function rr(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function ia(t,e,n,r){return rr(t,No(),n)?e+P(n)+r:at}function fa(t,e,n,r,i,s,o,a){const l=Pe(),f=Tt(),p=t+20,m=f.firstCreatePass?function iA(t,e,n,r,i,s,o,a,l){const f=e.consts,p=Qo(e,t,4,o||null,Ss(f,a));ph(e,n,p,Ss(f,l)),jc(e,p);const m=p.tViews=al(2,p,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,f);return null!==e.queries&&(e.queries.template(e,p),m.queries=e.queries.embeddedTView(p)),p}(p,f,l,e,n,r,i,s,o):f.data[p];Ri(m,!1);const E=l[11].createComment("");nl(f,l,E,m),tr(E,l),ul(l,l[p]=by(E,l,E,m)),Pc(m)&&fh(f,l,m),null!=o&&hh(l,m,a)}function He(t,e=st.Default){const n=Pe();return null===n?Qe(t,e):Hm(Mn(),n,y(t),e)}function Rh(){throw new Error("invalid")}function Or(t,e,n){const r=Pe();return rr(r,No(),e)&&Rr(Tt(),pn(),r,t,e,r[11],n,!1),Or}function Oh(t,e,n,r,i){const o=i?"class":"style";Dy(t,n,e.inputs[o],o,r)}function pt(t,e,n,r){const i=Pe(),s=Tt(),o=20+t,a=i[11],l=i[o]=zf(a,e,function NE(){return ot.lFrame.currentNamespace}()),f=s.firstCreatePass?function DA(t,e,n,r,i,s,o){const a=e.consts,f=Qo(e,t,2,i,Ss(a,s));return ph(e,n,f,Ss(a,o)),null!==f.attrs&&cl(f,f.attrs,!1),null!==f.mergedAttrs&&cl(f,f.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,f),f}(o,s,i,0,e,n,r):s.data[o];Ri(f,!0);const p=f.mergedAttrs;null!==p&&Hc(a,l,p);const m=f.classes;null!==m&&Xf(a,l,m);const E=f.styles;null!==E&&$0(a,l,E),64!=(64&f.flags)&&nl(s,i,l,f),0===function bE(){return ot.lFrame.elementDepthCount}()&&tr(l,i),function wE(){ot.lFrame.elementDepthCount++}(),Pc(f)&&(fh(s,i,f),uy(s,f,i)),null!==r&&hh(i,f)}function gt(){let t=Mn();ff()?hf():(t=t.parent,Ri(t,!1));const e=t;!function SE(){ot.lFrame.elementDepthCount--}();const n=Tt();n.firstCreatePass&&(jc(n,t),rf(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function HE(t){return 0!=(16&t.flags)}(e)&&Oh(n,e,Pe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function VE(t){return 0!=(32&t.flags)}(e)&&Oh(n,e,Pe(),e.stylesWithoutHost,!1)}function Hi(t,e,n,r){pt(t,e,n,r),gt()}function hl(t,e,n){const r=Pe(),i=Tt(),s=t+20,o=i.firstCreatePass?function AA(t,e,n,r,i){const s=e.consts,o=Ss(s,r),a=Qo(e,t,8,"ng-container",o);return null!==o&&cl(a,o,!0),ph(e,n,a,Ss(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,r,e,n):i.data[s];Ri(o,!0);const a=r[s]=r[11].createComment("");nl(i,r,a,o),tr(a,r),Pc(o)&&(fh(i,r,o),uy(i,o,r)),null!=n&&hh(r,o)}function pl(){let t=Mn();const e=Tt();ff()?hf():(t=t.parent,Ri(t,!1)),e.firstCreatePass&&(jc(e,t),rf(t)&&e.queries.elementEnd(t))}function gl(){return Pe()}function ml(t){return!!t&&"function"==typeof t.then}const fv=function dv(t){return!!t&&"function"==typeof t.subscribe};function tn(t,e,n,r){const i=Pe(),s=Tt(),o=Mn();return function pv(t,e,n,r,i,s,o,a){const l=Pc(r),p=t.firstCreatePass&&Ey(t),m=e[8],E=Sy(e);let x=!0;if(3&r.type||a){const we=Yr(r,e),xe=a?a(we):we,ye=E.length,Me=a?Ze=>a(xn(Ze[r.index])):r.index;if(hn(n)){let Ze=null;if(!a&&l&&(Ze=function IA(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===n&&i[s+1]===r){const a=e[7],l=i[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(t,e,i,r.index)),null!==Ze)(Ze.__ngLastListenerFn__||Ze).__ngNextListenerFn__=s,Ze.__ngLastListenerFn__=s,x=!1;else{s=Nh(r,e,m,s,!1);const ut=n.listen(xe,i,s);E.push(s,ut),p&&p.push(i,Me,ye,ye+1)}}else s=Nh(r,e,m,s,!0),xe.addEventListener(i,s,o),E.push(s),p&&p.push(i,Me,ye,o)}else s=Nh(r,e,m,s,!1);const j=r.outputs;let de;if(x&&null!==j&&(de=j[i])){const we=de.length;if(we)for(let xe=0;xe<we;xe+=2){const Tn=e[de[xe]][de[xe+1]].subscribe(s),si=E.length;E.push(s,Tn),p&&p.push(i,r.index,si,-(si+1))}}}(s,i,i[11],o,t,e,!!n,r),tn}function gv(t,e,n,r){try{return!1!==n(r)}catch(i){return Cy(t,i),!1}}function Nh(t,e,n,r,i){return function s(o){if(o===Function)return r;const a=2&t.flags?Pr(t.index,e):e;0==(32&e[2])&&yh(a);let l=gv(e,0,r,o),f=s.__ngNextListenerFn__;for(;f;)l=gv(e,0,f,o)&&l,f=f.__ngNextListenerFn__;return i&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Eu(t=1){return function TE(t){return(ot.lFrame.contextLView=function PE(t,e){for(;t>0;)e=e[15],t--;return e}(t,ot.lFrame.contextLView))[8]}(t)}function TA(t,e){let n=null;const r=function NC(t){const e=t.attrs;if(null!=e){const n=e.indexOf(5);if(0==(1&n))return e[n+1]}return null}(t);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===r?z0(t,s,!0):BC(r,s))return i}else n=i}return n}function Lh(t,e,n){return jh(t,"",e,"",n),Lh}function jh(t,e,n,r,i){const s=Pe(),o=ia(s,e,n,r);return o!==at&&Rr(Tt(),pn(),s,t,o,s[11],i,!1),jh}function Dv(t,e,n,r,i){const s=t[n+1],o=null===e;let a=r?fi(s):ns(s),l=!1;for(;0!==a&&(!1===l||o);){const p=t[a+1];MA(t[a],e)&&(l=!0,t[a+1]=r?nh(p):eh(p)),a=r?fi(p):ns(p)}l&&(t[n+1]=r?eh(s):nh(s))}function MA(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&qo(t,e)>=0}const On={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Av(t){return t.substring(On.key,On.keyEnd)}function Fv(t,e){const n=On.textEnd;return n===e?-1:(e=On.keyEnd=function LA(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,On.key=e,n),pa(t,e,n))}function pa(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function Fs(t,e){return function pi(t,e,n,r){const i=Pe(),s=Tt(),o=ts(2);s.firstUpdatePass&&Ov(s,t,o,r),e!==at&&rr(i,o,e)&&Lv(s,s.data[lr()],i,i[11],t,i[o+1]=function zA(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=u(Cs(t)))),t}(e,n),r,o)}(t,e,null,!0),Fs}function Bh(t){!function gi(t,e,n,r){const i=Tt(),s=ts(2);i.firstUpdatePass&&Ov(i,null,s,r);const o=Pe();if(n!==at&&rr(o,s,n)){const a=i.data[lr()];if(Bv(a,r)&&!Rv(i,s)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(n=d(l,n||"")),Oh(i,a,o,n,r)}else!function GA(t,e,n,r,i,s,o,a){i===at&&(i=Kt);let l=0,f=0,p=0<i.length?i[0]:null,m=0<s.length?s[0]:null;for(;null!==p||null!==m;){const E=l<i.length?i[l+1]:void 0,x=f<s.length?s[f+1]:void 0;let de,j=null;p===m?(l+=2,f+=2,E!==x&&(j=m,de=x)):null===m||null!==p&&p<m?(l+=2,j=p):(f+=2,j=m,de=x),null!==j&&Lv(t,e,n,r,j,de,o,a),p=l<i.length?i[l]:null,m=f<s.length?s[f]:null}}(i,a,o,o[11],o[s+1],o[s+1]=function KA(t,e,n){if(null==n||""===n)return Kt;const r=[],i=Cs(n);if(Array.isArray(i))for(let s=0;s<i.length;s++)t(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&t(r,s,i[s]);else"string"==typeof i&&e(r,i);return r}(t,e,n),r,s)}}(kr,$i,t,!0)}function $i(t,e){for(let n=function OA(t){return function Tv(t){On.key=0,On.keyEnd=0,On.value=0,On.valueEnd=0,On.textEnd=t.length}(t),Fv(t,pa(t,0,On.textEnd))}(e);n>=0;n=Fv(e,n))kr(t,Av(e),!0)}function Rv(t,e){return e>=t.expandoStartIndex}function Ov(t,e,n,r){const i=t.data;if(null===i[n+1]){const s=i[lr()],o=Rv(t,n);Bv(s,r)&&null===e&&!o&&(e=!1),e=function HA(t,e,n,r){const i=function gf(t){const e=ot.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=xu(n=Uh(null,t,e,n,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==i)if(n=Uh(i,t,e,n,r),null===s){let l=function VA(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==ns(r))return t[fi(r)]}(t,e,r);void 0!==l&&Array.isArray(l)&&(l=Uh(null,t,e,l[1],r),l=xu(l,e.attrs,r),function $A(t,e,n,r){t[fi(n?e.classBindings:e.styleBindings)]=r}(t,e,r,l))}else s=function qA(t,e,n){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=xu(r,t[s].hostAttrs,n);return xu(r,e.attrs,n)}(t,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),n}(i,s,e,r),function PA(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=fi(o),l=ns(o);t[r]=n;let p,f=!1;if(Array.isArray(n)){const m=n;p=m[1],(null===p||qo(m,p)>0)&&(f=!0)}else p=n;if(i)if(0!==l){const E=fi(t[a+1]);t[r+1]=il(E,a),0!==E&&(t[E+1]=th(t[E+1],r)),t[a+1]=function $C(t,e){return 131071&t|e<<17}(t[a+1],r)}else t[r+1]=il(a,0),0!==a&&(t[a+1]=th(t[a+1],r)),a=r;else t[r+1]=il(l,0),0===a?a=r:t[l+1]=th(t[l+1],r),l=r;f&&(t[r+1]=eh(t[r+1])),Dv(t,p,r,!0),Dv(t,p,r,!1),function kA(t,e,n,r,i){const s=i?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&qo(s,e)>=0&&(n[r+1]=nh(n[r+1]))}(e,p,t,r,s),o=il(a,l),s?e.classBindings=o:e.styleBindings=o}(i,s,e,n,o,r)}}function Uh(t,e,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],r=xu(r,s.hostAttrs,i),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function xu(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),kr(t,o,!!n||e[++s]))}return void 0===t?null:t}function Lv(t,e,n,r,i,s,o,a){if(!(3&e.type))return;const l=t.data,f=l[a+1];yl(function Z0(t){return 1==(1&t)}(f)?jv(l,e,n,i,ns(f),o):void 0)||(yl(s)||function Q0(t){return 2==(2&t)}(f)&&(s=jv(l,null,n,i,a,o)),function PC(t,e,n,r,i){const s=hn(t);if(e)i?s?t.addClass(n,r):n.classList.add(r):s?t.removeClass(n,r):n.classList.remove(r);else{let o=-1===r.indexOf("-")?void 0:Mr.DashCase;if(null==i)s?t.removeStyle(n,r,o):n.style.removeProperty(r);else{const a="string"==typeof i&&i.endsWith("!important");a&&(i=i.slice(0,-10),o|=Mr.Important),s?t.setStyle(n,r,i,o):n.style.setProperty(r,i,a?"important":"")}}}(r,o,kc(lr(),n),i,s))}function jv(t,e,n,r,i,s){const o=null===e;let a;for(;i>0;){const l=t[i],f=Array.isArray(l),p=f?l[1]:l,m=null===p;let E=n[i+1];E===at&&(E=m?Kt:void 0);let x=m?Df(E,r):p===r?E:void 0;if(f&&!yl(x)&&(x=Df(l,r)),yl(x)&&(a=x,o))return a;const j=t[i+1];i=o?fi(j):ns(j)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Df(l,r))}return a}function yl(t){return void 0!==t}function Bv(t,e){return 0!=(t.flags&(e?16:32))}function Xt(t,e=""){const n=Pe(),r=Tt(),i=t+20,s=r.firstCreatePass?Qo(r,i,1,e,null):r.data[i],o=n[i]=function Gf(t,e){return hn(t)?t.createText(e):t.createTextNode(e)}(n[11],e);nl(r,n,o,s),Ri(s,!1)}function zn(t){return vl("",t,""),zn}function vl(t,e,n){const r=Pe(),i=ia(r,t,e,n);return i!==at&&rs(r,lr(),i),vl}const no=void 0;var hF=["en",[["a","p"],["AM","PM"],no],[["AM","PM"],no,no],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],no,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],no,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",no,"{1} 'at' {0}",no],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function fF(t){const n=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===r?1:5}];let ga={};function o_(t){return t in ga||(ga[t]=xt.ng&&xt.ng.common&&xt.ng.common.locales&&xt.ng.common.locales[t]),ga[t]}var Ve=(()=>((Ve=Ve||{})[Ve.LocaleId=0]="LocaleId",Ve[Ve.DayPeriodsFormat=1]="DayPeriodsFormat",Ve[Ve.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ve[Ve.DaysFormat=3]="DaysFormat",Ve[Ve.DaysStandalone=4]="DaysStandalone",Ve[Ve.MonthsFormat=5]="MonthsFormat",Ve[Ve.MonthsStandalone=6]="MonthsStandalone",Ve[Ve.Eras=7]="Eras",Ve[Ve.FirstDayOfWeek=8]="FirstDayOfWeek",Ve[Ve.WeekendRange=9]="WeekendRange",Ve[Ve.DateFormat=10]="DateFormat",Ve[Ve.TimeFormat=11]="TimeFormat",Ve[Ve.DateTimeFormat=12]="DateTimeFormat",Ve[Ve.NumberSymbols=13]="NumberSymbols",Ve[Ve.NumberFormats=14]="NumberFormats",Ve[Ve.CurrencyCode=15]="CurrencyCode",Ve[Ve.CurrencySymbol=16]="CurrencySymbol",Ve[Ve.CurrencyName=17]="CurrencyName",Ve[Ve.Currencies=18]="Currencies",Ve[Ve.Directionality=19]="Directionality",Ve[Ve.PluralCase=20]="PluralCase",Ve[Ve.ExtraData=21]="ExtraData",Ve))();const _l="en-US";let a_=_l;class k_{}class mI{resolveComponentFactory(e){throw function gI(t){const e=Error(`No component factory found for ${u(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(e)}}let ya=(()=>{class t{}return t.NULL=new mI,t})();function yI(){return va(Mn(),Pe())}function va(t,e){return new Is(Yr(t,e))}let Is=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=yI,t})();class R_{}let wI=(()=>{class t{}return t.\u0275prov=ze({token:t,providedIn:"root",factory:()=>null}),t})();class Cl{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const SI=new Cl("13.1.3"),zh={};function Dl(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&r.push(xn(s)),ci(s))for(let a=10;a<s.length;a++){const l=s[a],f=l[1].firstChild;null!==f&&Dl(l[1],l,f,r)}const o=n.type;if(8&o)Dl(t,e,n.child,r);else if(32&o){const a=$f(n,e);let l;for(;l=a();)r.push(l)}else if(16&o){const a=U0(e,n);if(Array.isArray(a))r.push(...a);else{const l=mu(e[16]);Dl(l[1],l,a,r,!0)}}n=i?n.projectionNext:n.next}return r}class Iu{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return Dl(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(ci(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(Wf(e,r),zc(n,r))}this._attachedToViewContainer=!1}P0(this._lView[1],this._lView)}onDestroy(e){!function fy(t,e,n,r){const i=Sy(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&Ey(t).push(r,i.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){yh(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){_h(this._lView[1],this._lView,this.context)}checkNoChanges(){!function CD(t,e,n){Oc(!0);try{_h(t,e,n)}finally{Oc(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new F(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function wC(t,e){yu(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new F(902,"");this._appRef=e}}class EI extends Iu{constructor(e){super(e),this._view=e}detectChanges(){wy(this._view)}checkNoChanges(){!function DD(t){Oc(!0);try{wy(t)}finally{Oc(!1)}}(this._view)}get context(){return null}}class O_ extends ya{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=Xn(e);return new Wh(n,this.ngModule)}}function N_(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const CI=new Ct("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>E0});class Wh extends k_{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function HC(t){return t.map(UC).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return N_(this.componentDef.inputs)}get outputs(){return N_(this.componentDef.outputs)}create(e,n,r,i){const s=(i=i||this.ngModule)?function DI(t,e){return{get:(n,r,i)=>{const s=t.get(n,zh,i);return s!==zh||r===zh?s:e.get(n,r,i)}}}(e,i.injector):e,o=s.get(R_,bm),a=s.get(wI,null),l=o.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?function dy(t,e,n){if(hn(t))return t.selectRootElement(e,n===En.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(l,r,this.componentDef.encapsulation):zf(o.createRenderer(null,this.componentDef),f,function xI(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(f)),m=this.componentDef.onPush?576:528,E=function $y(t,e){return{components:[],scheduler:t||E0,clean:AD,playerHandler:e||null,flags:0}}(),x=al(0,null,null,1,0,null,null,null,null,null),j=vu(null,x,E,m,null,null,o,l,a,s);let de,we;Nc(j);try{const xe=function Hy(t,e,n,r,i,s){const o=n[1];n[20]=t;const l=Qo(o,20,2,"#host",null),f=l.mergedAttrs=e.hostAttrs;null!==f&&(cl(l,f,!0),null!==t&&(Hc(i,t,f),null!==l.classes&&Xf(i,t,l.classes),null!==l.styles&&$0(i,t,l.styles)));const p=r.createRenderer(t,e),m=vu(n,cy(e),null,e.onPush?64:16,n[20],l,r,p,s||null,null);return o.firstCreatePass&&(Kc(tu(l,n),o,e.type),yy(o,l),vy(l,n.length,1)),ul(n,m),n[20]=m}(p,this.componentDef,j,o,l);if(p)if(r)Hc(l,p,["ng-version",SI.full]);else{const{attrs:ye,classes:Me}=function VC(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!di(i))break;i=s}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);ye&&Hc(l,p,ye),Me&&Me.length>0&&Xf(l,p,Me.join(" "))}if(we=cf(x,20),void 0!==n){const ye=we.projection=[];for(let Me=0;Me<this.ngContentSelectors.length;Me++){const Ze=n[Me];ye.push(null!=Ze?Array.from(Ze):null)}}de=function Vy(t,e,n,r,i){const s=n[1],o=function cD(t,e,n){const r=Mn();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),_y(t,r,e,Zo(t,e,1,null),n));const i=nu(e,t,r.directiveStart,r);tr(i,e);const s=Yr(r,e);return s&&tr(s,e),i}(s,n,e);if(r.components.push(o),t[8]=o,i&&i.forEach(l=>l(o,e)),e.contentQueries){const l=Mn();e.contentQueries(1,o,l.directiveStart)}const a=Mn();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Es(a.index),gy(n[1],a,0,a.directiveStart,a.directiveEnd,e),my(e,o)),o}(xe,this.componentDef,j,E,[zD]),_u(x,j,null)}finally{Lc()}return new FI(this.componentType,de,va(we,j),j,we)}}class FI extends class pI{}{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new EI(i),this.componentType=e}get injector(){return new Bo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class is{}class L_{}const _a=new Map;class U_ extends is{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new O_(this);const r=zr(e);this._bootstrapComponents=ji(r.bootstrap),this._r3Injector=Ty(e,n,[{provide:is,useValue:this},{provide:ya,useValue:this.componentFactoryResolver}],u(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,n=nr.THROW_IF_NOT_FOUND,r=st.Default){return e===nr||e===is||e===wh?this:this._r3Injector.get(e,n,r)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Jh extends L_{constructor(e){super(),this.moduleType=e,null!==zr(e)&&function TI(t){const e=new Set;!function n(r){const i=zr(r,!0),s=i.id;null!==s&&(function j_(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${u(e)} vs ${u(e.name)}`)}(s,_a.get(s),r),_a.set(s,r));const o=ji(i.imports);for(const a of o)e.has(a)||(e.add(a),n(a))}(t)}(e)}create(e){return new U_(this.moduleType,e)}}function Yh(t){return e=>{setTimeout(t,void 0,e)}}const Dn=class WI extends Bt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){var i,s,o;let a=e,l=n||(()=>null),f=r;if(e&&"object"==typeof e){const m=e;a=null===(i=m.next)||void 0===i?void 0:i.bind(m),l=null===(s=m.error)||void 0===s?void 0:s.bind(m),f=null===(o=m.complete)||void 0===o?void 0:o.bind(m)}this.__isAsync&&(l=Yh(l),a&&(a=Yh(a)),f&&(f=Yh(f)));const p=super.subscribe({next:a,error:l,complete:f});return e instanceof M&&e.add(p),p}};Symbol;let ss=(()=>{class t{}return t.__NG_ELEMENT_ID__=ZI,t})();const YI=ss,QI=class extends YI{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(e){const n=this._declarationTContainer.tViews,r=vu(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(r[19]=s.createEmbeddedView(n)),_u(n,r,e),new Iu(r)}};function ZI(){return function Al(t,e){return 4&t.type?new QI(e,t,va(t,e)):null}(Mn(),Pe())}let mi=(()=>{class t{}return t.__NG_ELEMENT_ID__=XI,t})();function XI(){return function W_(t,e){let n;const r=e[t.index];if(ci(r))n=r;else{let i;if(8&t.type)i=xn(r);else{const s=e[11];i=s.createComment("");const o=Yr(t,e);eo(s,tl(s,o),i,function FC(t,e){return hn(t)?t.nextSibling(e):e.nextSibling}(s,o),!1)}e[t.index]=n=by(r,e,i,t),ul(e,n)}return new G_(n,t,e)}(Mn(),Pe())}const e2=mi,G_=class extends e2{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return va(this._hostTNode,this._hostLView)}get injector(){return new Bo(this._hostTNode,this._hostLView)}get parentInjector(){const e=qc(this._hostTNode,this._hostLView);if(Nm(e)){const n=jo(e,this._hostLView),r=Lo(e);return new Bo(n[1].data[r+8],n)}return new Bo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=z_(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,r){const i=e.createEmbeddedView(n||{});return this.insert(i,r),i}createComponent(e,n,r,i,s){const o=e&&!function su(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const m=n||{};a=m.index,r=m.injector,i=m.projectableNodes,s=m.ngModuleRef}const l=o?e:new Wh(Xn(e)),f=r||this.parentInjector;if(!s&&null==l.ngModule&&f){const m=f.get(is,null);m&&(s=m)}const p=l.create(f,i,void 0,s);return this.insert(p.hostView,a),p}insert(e,n){const r=e._lView,i=r[1];if(function _E(t){return ci(t[3])}(r)){const p=this.indexOf(e);if(-1!==p)this.detach(p);else{const m=r[3],E=new G_(m,m[6],m[3]);E.detach(E.indexOf(e))}}const s=this._adjustIndex(n),o=this._lContainer;!function EC(t,e,n,r){const i=10+r,s=n.length;r>0&&(n[i-1][4]=e),r<s-10?(e[4]=n[i],Gm(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const o=e[17];null!==o&&n!==o&&function xC(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(i,r,o,s);const a=Qf(s,o),l=r[11],f=tl(l,o[7]);return null!==f&&function bC(t,e,n,r,i,s){r[0]=i,r[6]=e,yu(t,r,n,1,i,s)}(i,o[6],l,r,f,a),e.attachToViewContainerRef(),Gm(Zh(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=z_(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=Wf(this._lContainer,n);r&&(zc(Zh(this._lContainer),n),P0(r[1],r))}detach(e){const n=this._adjustIndex(e,-1),r=Wf(this._lContainer,n);return r&&null!=zc(Zh(this._lContainer),n)?new Iu(r):null}_adjustIndex(e,n=0){return null==e?this.length+n:e}};function z_(t){return t[8]}function Zh(t){return t[8]||(t[8]=[])}function Tl(...t){}const Pl=new Ct("Application Initializer");let wa=(()=>{class t{constructor(n){this.appInits=n,this.resolve=Tl,this.reject=Tl,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const s=this.appInits[i]();if(ml(s))n.push(s);else if(fv(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});n.push(o)}}Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(Qe(Pl,8))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const Mu=new Ct("AppId"),F2={provide:Mu,useFactory:function A2(){return`${fp()}${fp()}${fp()}`},deps:[]};function fp(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const mb=new Ct("Platform Initializer"),kl=new Ct("Platform ID"),yb=new Ct("appBootstrapListener");let vb=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const Ts=new Ct("LocaleId"),_b=new Ct("DefaultCurrencyCode");class I2{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let Ml=(()=>{class t{compileModuleSync(n){return new Jh(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),s=ji(zr(n).declarations).reduce((o,a)=>{const l=Xn(a);return l&&o.push(new Wh(l)),o},[]);return new I2(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const P2=(()=>Promise.resolve(0))();function hp(t){"undefined"==typeof Zone?P2.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Nn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Dn(!1),this.onMicrotaskEmpty=new Dn(!1),this.onStable=new Dn(!1),this.onError=new Dn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function k2(){let t=xt.requestAnimationFrame,e=xt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function O2(t){const e=()=>{!function R2(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(xt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,gp(t),t.isCheckStableRunning=!0,pp(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),gp(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return bb(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),wb(t)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return bb(t),n.invoke(i,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),wb(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,gp(t),pp(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Nn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Nn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,M2,Tl,Tl);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const M2={};function pp(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function gp(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function bb(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function wb(t){t._nesting--,pp(t)}class N2{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Dn,this.onMicrotaskEmpty=new Dn,this.onStable=new Dn,this.onError=new Dn}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}let mp=(()=>{class t{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Nn.assertNotInAngularZone(),hp(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())hp(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,r,i){return[]}}return t.\u0275fac=function(n){return new(n||t)(Qe(Nn))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),Sb=(()=>{class t{constructor(){this._applications=new Map,yp.addToWindow(this)}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return yp.findTestabilityInTree(this,n,r)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();class L2{addToWindow(e){}findTestabilityInTree(e,n,r){return null}}let yi,yp=new L2;const Eb=new Ct("AllowMultipleToken");class xb{constructor(e,n){this.name=e,this.token=n}}function Cb(t,e,n=[]){const r=`Platform: ${e}`,i=new Ct(r);return(s=[])=>{let o=Db();if(!o||o.injector.get(Eb,!1))if(t)t(n.concat(s).concat({provide:i,useValue:!0}));else{const a=n.concat(s).concat({provide:i,useValue:!0},{provide:Sh,useValue:"platform"});!function H2(t){if(yi&&!yi.destroyed&&!yi.injector.get(Eb,!1))throw new F(400,"");yi=t.get(Ab);const e=t.get(mb,null);e&&e.forEach(n=>n())}(nr.create({providers:a,name:r}))}return function V2(t){const e=Db();if(!e)throw new F(401,"");return e}()}}function Db(){return yi&&!yi.destroyed?yi:null}let Ab=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const a=function $2(t,e){let n;return n="noop"===t?new N2:("zone.js"===t?void 0:t)||new Nn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),l=[{provide:Nn,useValue:a}];return a.run(()=>{const f=nr.create({providers:l,parent:this.injector,name:n.moduleType.name}),p=n.create(f),m=p.injector.get(Wo,null);if(!m)throw new F(402,"");return a.runOutsideAngular(()=>{const E=a.onError.subscribe({next:x=>{m.handleError(x)}});p.onDestroy(()=>{vp(this._modules,p),E.unsubscribe()})}),function q2(t,e,n){try{const r=n();return ml(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(m,a,()=>{const E=p.injector.get(wa);return E.runInitializers(),E.donePromise.then(()=>(function vF(t){mt(t,"Expected localeId to be defined"),"string"==typeof t&&(a_=t.toLowerCase().replace(/_/g,"-"))}(p.injector.get(Ts,_l)||_l),this._moduleDoBootstrap(p),p))})})}bootstrapModule(n,r=[]){const i=Fb({},r);return function B2(t,e,n){const r=new Jh(n);return Promise.resolve(r)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(n){const r=n.injector.get(Ru);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new F(403,"");n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new F(404,"");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(Qe(nr))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();function Fb(t,e){return Array.isArray(e)?e.reduce(Fb,t):Object.assign(Object.assign({},t),e)}let Ru=(()=>{class t{constructor(n,r,i,s,o){this._zone=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new _t(f=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{f.next(this._stable),f.complete()})}),l=new _t(f=>{let p;this._zone.runOutsideAngular(()=>{p=this._zone.onStable.subscribe(()=>{Nn.assertNotInAngularZone(),hp(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,f.next(!0))})})});const m=this._zone.onUnstable.subscribe(()=>{Nn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{f.next(!1)}))});return()=>{p.unsubscribe(),m.unsubscribe()}});this.isStable=function Qd(...t){const e=gs(t),n=function dn(t,e){return"number"==typeof Do(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?$t(r[0]):Ti(n)(bn(r,e)):Gr}(a,l.pipe(function Zd(t={}){const{connector:e=(()=>new Bt),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o=null,a=null,l=null,f=0,p=!1,m=!1;const E=()=>{null==a||a.unsubscribe(),a=null},x=()=>{E(),o=l=null,p=m=!1},j=()=>{const de=o;x(),null==de||de.unsubscribe()};return Mt((de,we)=>{f++,!m&&!p&&E();const xe=l=null!=l?l:e();we.add(()=>{f--,0===f&&!m&&!p&&(a=Ga(j,i))}),xe.subscribe(we),o||(o=new Fe({next:ye=>xe.next(ye),error:ye=>{m=!0,E(),a=Ga(x,n,ye),xe.error(ye)},complete:()=>{p=!0,E(),a=Ga(x,r),xe.complete()}}),bn(de).subscribe(o))})(s)}}()))}bootstrap(n,r){if(!this._initStatus.done)throw new F(405,"");let i;i=n instanceof k_?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(i.componentType);const s=function U2(t){return t.isBoundToModule}(i)?void 0:this._injector.get(is),a=i.create(nr.NULL,[],r||i.selector,s),l=a.location.nativeElement,f=a.injector.get(mp,null),p=f&&a.injector.get(Sb);return f&&p&&p.registerApplication(l,f),a.onDestroy(()=>{this.detachView(a.hostView),vp(this.components,a),p&&p.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new F(101,"");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;vp(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(yb,[]).concat(this._bootstrapListeners).forEach(i=>i(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(n){return new(n||t)(Qe(Nn),Qe(nr),Qe(Wo),Qe(ya),Qe(wa))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();function vp(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}let Tb=!0,_p=(()=>{class t{}return t.__NG_ELEMENT_ID__=z2,t})();function z2(t){return function W2(t,e,n){if(Tc(t)&&!n){const r=Pr(t.index,e);return new Iu(r,r)}return 47&t.type?new Iu(e[16],e):null}(Mn(),Pe(),16==(16&t))}class Lb{constructor(){}supports(e){return wu(e)}create(e){return new eT(e)}}const X2=(t,e)=>e;class eT{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||X2}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){const o=!r||n&&n.currentIndex<Bb(r,i,s)?n:r,a=Bb(o,i,s),l=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,null==o.previousIndex)i++;else{s||(s=[]);const f=a-i,p=l-i;if(f!=p){for(let E=0;E<f;E++){const x=E<s.length?s[E]:s[E]=0,j=x+E;p<=j&&j<f&&(s[E]=x+1)}s[o.previousIndex]=p-f}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!wu(e))throw new F(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==n&&Object.is(n.trackById,o)?(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,o,a),r=!0),n=n._next}else i=0,function rA(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[na()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,a=>{o=this._trackByFn(i,a),null!==n&&Object.is(n.trackById,o)?(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,o,i),r=!0),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new tT(n,r),s,i),e}_verifyReinsertion(e,n,r,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const i=null===n?this._itHead:n._next;return e._next=i,e._prev=n,null===i?this._itTail=e:i._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new jb),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new jb),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class tT{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class nT{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class jb{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new nT,this.map.set(n,r)),r.add(e)}get(e,n){const i=this.map.get(e);return i?i.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Bb(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Ub{constructor(){}supports(e){return e instanceof Map||Fh(e)}create(){return new rT}}class rT{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let n;for(n=this._mapHead;null!==n;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}diff(e){if(e){if(!(e instanceof Map||Fh(e)))throw new F(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(n&&n.key===i)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const s=this._getOrCreateRecordForKey(i,r);n=this._insertBeforeOrAppend(n,s)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){const r=e._prev;return n._next=e,n._prev=r,e._prev=n,r&&(r._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,n);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const r=new iT(e);return this._records.set(e,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(r=>n(e[r],r))}}class iT{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Hb(){return new Ou([new Lb])}let Ou=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(null!=r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||Hb()),deps:[[t,new Ko,new Ni]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(null!=r)return r;throw new F(901,"")}}return t.\u0275prov=ze({token:t,providedIn:"root",factory:Hb}),t})();function Vb(){return new Sa([new Ub])}let Sa=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||Vb()),deps:[[t,new Ko,new Ni]]}}find(n){const r=this.factories.find(s=>s.supports(n));if(r)return r;throw new F(901,"")}}return t.\u0275prov=ze({token:t,providedIn:"root",factory:Vb}),t})();const sT=[new Ub],aT=new Ou([new Lb]),uT=new Sa(sT),cT=Cb(null,"core",[{provide:kl,useValue:"unknown"},{provide:Ab,deps:[nr]},{provide:Sb,deps:[]},{provide:vb,deps:[]}]),pT=[{provide:Ru,useClass:Ru,deps:[Nn,nr,Wo,ya,wa]},{provide:CI,deps:[Nn],useFactory:function gT(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(n){e.push(n)}}},{provide:wa,useClass:wa,deps:[[new Ni,Pl]]},{provide:Ml,useClass:Ml,deps:[]},F2,{provide:Ou,useFactory:function lT(){return aT},deps:[]},{provide:Sa,useFactory:function dT(){return uT},deps:[]},{provide:Ts,useFactory:function fT(t){return t||function hT(){return"undefined"!=typeof $localize&&$localize.locale||_l}()},deps:[[new lu(Ts),new Ni,new Ko]]},{provide:_b,useValue:"USD"}];let mT=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(Qe(Ru))},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({providers:pT}),t})(),Ol=null;function Ps(){return Ol}const Nr=new Ct("DocumentToken");let io=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:function(){return function bT(){return Qe($b)}()},providedIn:"platform"}),t})();const wT=new Ct("Location Initialized");let $b=(()=>{class t extends io{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ps().getBaseHref(this._doc)}onPopState(n){const r=Ps().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=Ps().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,r,i){qb()?this._history.pushState(n,r,i):this.location.hash=i}replaceState(n,r,i){qb()?this._history.replaceState(n,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return t.\u0275fac=function(n){return new(n||t)(Qe(Nr))},t.\u0275prov=ze({token:t,factory:function(){return function ST(){return new $b(Qe(Nr))}()},providedIn:"platform"}),t})();function qb(){return!!window.history.pushState}function xp(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function Kb(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function os(t){return t&&"?"!==t[0]?"?"+t:t}let Ea=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:function(){return function ET(t){const e=Qe(Nr).location;return new Gb(Qe(io),e&&e.origin||"")}()},providedIn:"root"}),t})();const Cp=new Ct("appBaseHref");let Gb=(()=>{class t extends Ea{constructor(n,r){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return xp(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+os(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){const o=this.prepareExternalUrl(i+os(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){const o=this.prepareExternalUrl(i+os(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,n)}}return t.\u0275fac=function(n){return new(n||t)(Qe(io),Qe(Cp,8))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),xT=(()=>{class t extends Ea{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=xp(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+os(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+os(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,n)}}return t.\u0275fac=function(n){return new(n||t)(Qe(io),Qe(Cp,8))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),Dp=(()=>{class t{constructor(n,r){this._subject=new Dn,this._urlChangeListeners=[],this._platformStrategy=n;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=Kb(zb(i)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+os(r))}normalize(n){return t.stripTrailingSlash(function DT(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,zb(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._platformStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+os(r)),i)}replaceState(n,r="",i=null){this._platformStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+os(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}}return t.normalizeQueryParams=os,t.joinWithSlash=xp,t.stripTrailingSlash=Kb,t.\u0275fac=function(n){return new(n||t)(Qe(Ea),Qe(io))},t.\u0275prov=ze({token:t,factory:function(){return function CT(){return new Dp(Qe(Ea),Qe(io))}()},providedIn:"root"}),t})();function zb(t){return t.replace(/\/index.html$/,"")}var An=(()=>((An=An||{})[An.Zero=0]="Zero",An[An.One=1]="One",An[An.Two=2]="Two",An[An.Few=3]="Few",An[An.Many=4]="Many",An[An.Other=5]="Other",An))();const MT=function s_(t){return function fr(t){const e=function pF(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=o_(e);if(n)return n;const r=e.split("-")[0];if(n=o_(r),n)return n;if("en"===r)return hF;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Ve.PluralCase]};class Kl{}let uP=(()=>{class t extends Kl{constructor(n){super(),this.locale=n}getPluralCategory(n,r){switch(MT(r||this.locale)(n)){case An.Zero:return"zero";case An.One:return"one";case An.Two:return"two";case An.Few:return"few";case An.Many:return"many";default:return"other"}}}return t.\u0275fac=function(n){return new(n||t)(Qe(Ts))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();function nw(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}class dP{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Op=(()=>{class t{constructor(n,r,i){this._viewContainer=n,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((i,s,o)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new dP(i.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===s?void 0:s);else if(null!==s){const a=r.get(s);r.move(a,o),rw(a,i)}});for(let i=0,s=r.length;i<s;i++){const a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(i=>{rw(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(He(mi),He(ss),He(Ou))},t.\u0275dir=Zn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();function rw(t,e){t.context.$implicit=e.item}let iw=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new fP,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){sw("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){sw("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(He(mi),He(ss))},t.\u0275dir=Zn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class fP{constructor(){this.$implicit=null,this.ngIf=null}}function sw(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${u(e)}'.`)}let BP=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({providers:[{provide:Kl,useClass:uP}]}),t})();let $P=(()=>{class t{}return t.\u0275prov=ze({token:t,providedIn:"root",factory:()=>new qP(Qe(Nr),window)}),t})();class qP{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function KP(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=e)}}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=cw(this.window.history)||cw(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function cw(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class lw{}class Up extends class GP extends class _T{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function vT(t){Ol||(Ol=t)}(new Up)}onAndCancel(e,n,r){return e.addEventListener(n,r,!1),()=>{e.removeEventListener(n,r,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function zP(){return ju=ju||document.querySelector("base"),ju?ju.getAttribute("href"):null}();return null==n?null:function WP(t){Gl=Gl||document.createElement("a"),Gl.setAttribute("href",t);const e=Gl.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){ju=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return nw(document.cookie,e)}}let Gl,ju=null;const dw=new Ct("TRANSITION_ID"),YP=[{provide:Pl,useFactory:function JP(t,e,n){return()=>{n.get(wa).donePromise.then(()=>{const r=Ps(),i=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<i.length;s++)r.remove(i[s])})}},deps:[dw,Nr,nr],multi:!0}];class Hp{static init(){!function j2(t){yp=t}(new Hp)}addToWindow(e){xt.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new Error("Could not find testability for element.");return s},xt.getAllAngularTestabilities=()=>e.getAllTestabilities(),xt.getAllAngularRootElements=()=>e.getAllRootElements(),xt.frameworkStabilizers||(xt.frameworkStabilizers=[]),xt.frameworkStabilizers.push(r=>{const i=xt.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(l){o=o||l,s--,0==s&&r(o)};i.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,n,r){if(null==n)return null;const i=e.getTestability(n);return null!=i?i:r?Ps().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null}}let QP=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const zl=new Ct("EventManagerPlugins");let Wl=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>i.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}addGlobalEventListener(n,r,i){return this._findPluginFor(r).addGlobalEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const i=this._plugins;for(let s=0;s<i.length;s++){const o=i[s];if(o.supports(n))return this._eventNameToPlugin.set(n,o),o}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(Qe(zl),Qe(Nn))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();class fw{constructor(e){this._doc=e}addGlobalEventListener(e,n,r){const i=Ps().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${n}`);return this.addEventListener(i,n,r)}}let hw=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),Bu=(()=>{class t extends hw{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,i){n.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,i.push(r.appendChild(o))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(pw),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(n,i,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(pw))}}return t.\u0275fac=function(n){return new(n||t)(Qe(Nr))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();function pw(t){Ps().remove(t)}const Vp={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},$p=/%COMP%/g;function Jl(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Jl(t,i,n):(i=i.replace($p,t),n.push(i))}return n}function yw(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let qp=(()=>{class t{constructor(n,r,i){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Kp(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case En.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new rk(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(n),i}case 1:case En.ShadowDom:return new ik(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const i=Jl(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(Qe(Wl),Qe(Bu),Qe(Mu))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();class Kp{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?document.createElementNS(Vp[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){e.appendChild(n)}insertBefore(e,n,r){e&&e.insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=Vp[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=Vp[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Mr.DashCase|Mr.Important)?e.style.setProperty(n,r,i&Mr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Mr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,yw(r)):this.eventManager.addEventListener(e,n,yw(r))}}class rk extends Kp{constructor(e,n,r,i){super(e),this.component=r;const s=Jl(i+"-"+r.id,r.styles,[]);n.addStyles(s),this.contentAttr=function ek(t){return"_ngcontent-%COMP%".replace($p,t)}(i+"-"+r.id),this.hostAttr=function tk(t){return"_nghost-%COMP%".replace($p,t)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}class ik extends Kp{constructor(e,n,r,i){super(e),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Jl(i.id,i.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let sk=(()=>{class t extends fw{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}}return t.\u0275fac=function(n){return new(n||t)(Qe(Nr))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const _w=["alt","control","meta","shift"],ak={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},bw={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},uk={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let ck=(()=>{class t extends fw{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ps().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="";if(_w.forEach(l=>{const f=r.indexOf(l);f>-1&&(r.splice(f,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const a={};return a.domEventName=i,a.fullKey=o,a}static getEventFullKey(n){let r="",i=function lk(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&bw.hasOwnProperty(e)&&(e=bw[e]))}return ak[e]||e}(n);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),_w.forEach(s=>{s!=i&&uk[s](n)&&(r+=s+".")}),r+=i,r}static eventCallback(n,r,i){return s=>{t.getEventFullKey(s)===n&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return t.\u0275fac=function(n){return new(n||t)(Qe(Nr))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const pk=Cb(cT,"browser",[{provide:kl,useValue:"browser"},{provide:mb,useValue:function dk(){Up.makeCurrent(),Hp.init()},multi:!0},{provide:Nr,useFactory:function hk(){return function gE(t){af=t}(document),document},deps:[]}]),gk=[{provide:Sh,useValue:"root"},{provide:Wo,useFactory:function fk(){return new Wo},deps:[]},{provide:zl,useClass:sk,multi:!0,deps:[Nr,Nn,kl]},{provide:zl,useClass:ck,multi:!0,deps:[Nr]},{provide:qp,useClass:qp,deps:[Wl,Bu,Mu]},{provide:R_,useExisting:qp},{provide:hw,useExisting:Bu},{provide:Bu,useClass:Bu,deps:[Nr]},{provide:mp,useClass:mp,deps:[Nn]},{provide:Wl,useClass:Wl,deps:[zl,Nn]},{provide:lw,useClass:QP,deps:[]}];let mk=(()=>{class t{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:t,providers:[{provide:Mu,useValue:n.appId},{provide:dw,useExisting:Mu},YP]}}}return t.\u0275fac=function(n){return new(n||t)(Qe(t,12))},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({providers:gk,imports:[BP,mT]}),t})();function lt(...t){return bn(t,gs(t))}function xa(t,e){return ne(e)?sn(t,e,1):sn(t,1)}function so(t,e){return Mt((n,r)=>{let i=0;n.subscribe(new Vt(r,s=>t.call(e,s,i++)&&r.next(s)))})}"undefined"!=typeof window&&window;class Ew{}class xw{}class ti{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(n=>{const r=n.indexOf(":");if(r>0){const i=n.slice(0,r),s=i.toLowerCase(),o=n.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(n=>{let r=e[n];const i=n.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(i,r),this.maybeSetNormalizedName(n,i))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof ti?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){const n=new ti;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof ti?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){const n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,n);const i=("a"===e.op?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(n);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}}class Ak{encodeKey(e){return Cw(e)}encodeValue(e){return Cw(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Ik=/%(\d[a-f0-9])/gi,Tk={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Cw(t){return encodeURIComponent(t).replace(Ik,(e,n)=>{var r;return null!==(r=Tk[n])&&void 0!==r?r:e})}function Dw(t){return`${t}`}class Ms{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Ak,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Fk(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=n.get(o)||[];l.push(a),n.set(o,l)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{const r=e.fromObject[n];this.map.set(n,Array.isArray(r)?r:[r])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){const n=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(s=>{n.push({param:r,value:s,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const n=new Ms({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const n=("a"===e.op?this.map.get(e.param):void 0)||[];n.push(Dw(e.value)),this.map.set(e.param,n);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(Dw(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Pk{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function Aw(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function Fw(t){return"undefined"!=typeof Blob&&t instanceof Blob}function Iw(t){return"undefined"!=typeof FormData&&t instanceof FormData}class Uu{constructor(e,n,r,i){let s;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function kk(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new ti),this.context||(this.context=new Pk),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+o}}else this.params=new Ms,this.urlWithParams=n}serializeBody(){return null===this.body?null:Aw(this.body)||Fw(this.body)||Iw(this.body)||function Mk(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ms?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Iw(this.body)?null:Fw(this.body)?this.body.type||null:Aw(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ms?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var n;const r=e.method||this.method,i=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let f=e.headers||this.headers,p=e.params||this.params;const m=null!==(n=e.context)&&void 0!==n?n:this.context;return void 0!==e.setHeaders&&(f=Object.keys(e.setHeaders).reduce((E,x)=>E.set(x,e.setHeaders[x]),f)),e.setParams&&(p=Object.keys(e.setParams).reduce((E,x)=>E.set(x,e.setParams[x]),p)),new Uu(r,i,o,{params:p,headers:f,context:m,reportProgress:l,responseType:s,withCredentials:a})}}var In=(()=>((In=In||{})[In.Sent=0]="Sent",In[In.UploadProgress=1]="UploadProgress",In[In.ResponseHeader=2]="ResponseHeader",In[In.DownloadProgress=3]="DownloadProgress",In[In.Response=4]="Response",In[In.User=5]="User",In))();class zp{constructor(e,n=200,r="OK"){this.headers=e.headers||new ti,this.status=void 0!==e.status?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Wp extends zp{constructor(e={}){super(e),this.type=In.ResponseHeader}clone(e={}){return new Wp({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Yl extends zp{constructor(e={}){super(e),this.type=In.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Yl({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Jp extends zp{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Yp(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Qp=(()=>{class t{constructor(n){this.handler=n}request(n,r,i={}){let s;if(n instanceof Uu)s=n;else{let l,f;l=i.headers instanceof ti?i.headers:new ti(i.headers),i.params&&(f=i.params instanceof Ms?i.params:new Ms({fromObject:i.params})),s=new Uu(n,r,void 0!==i.body?i.body:null,{headers:l,context:i.context,params:f,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const o=lt(s).pipe(xa(l=>this.handler.handle(l)));if(n instanceof Uu||"events"===i.observe)return o;const a=o.pipe(so(l=>l instanceof Yl));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(ct(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(ct(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(ct(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(ct(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(n,r={}){return this.request("DELETE",n,r)}get(n,r={}){return this.request("GET",n,r)}head(n,r={}){return this.request("HEAD",n,r)}jsonp(n,r){return this.request("JSONP",n,{params:(new Ms).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,r={}){return this.request("OPTIONS",n,r)}patch(n,r,i={}){return this.request("PATCH",n,Yp(i,r))}post(n,r,i={}){return this.request("POST",n,Yp(i,r))}put(n,r,i={}){return this.request("PUT",n,Yp(i,r))}}return t.\u0275fac=function(n){return new(n||t)(Qe(Ew))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();class Tw{constructor(e,n){this.next=e,this.interceptor=n}handle(e){return this.interceptor.intercept(e,this.next)}}const Zp=new Ct("HTTP_INTERCEPTORS");let Rk=(()=>{class t{intercept(n,r){return r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const Ok=/^\)\]\}',?\n/;let Pw=(()=>{class t{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new _t(r=>{const i=this.xhrFactory.build();if(i.open(n.method,n.urlWithParams),n.withCredentials&&(i.withCredentials=!0),n.headers.forEach((x,j)=>i.setRequestHeader(x,j.join(","))),n.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const x=n.detectContentTypeHeader();null!==x&&i.setRequestHeader("Content-Type",x)}if(n.responseType){const x=n.responseType.toLowerCase();i.responseType="json"!==x?x:"text"}const s=n.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const x=1223===i.status?204:i.status,j=i.statusText||"OK",de=new ti(i.getAllResponseHeaders()),we=function Nk(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(i)||n.url;return o=new Wp({headers:de,status:x,statusText:j,url:we}),o},l=()=>{let{headers:x,status:j,statusText:de,url:we}=a(),xe=null;204!==j&&(xe=void 0===i.response?i.responseText:i.response),0===j&&(j=xe?200:0);let ye=j>=200&&j<300;if("json"===n.responseType&&"string"==typeof xe){const Me=xe;xe=xe.replace(Ok,"");try{xe=""!==xe?JSON.parse(xe):null}catch(Ze){xe=Me,ye&&(ye=!1,xe={error:Ze,text:xe})}}ye?(r.next(new Yl({body:xe,headers:x,status:j,statusText:de,url:we||void 0})),r.complete()):r.error(new Jp({error:xe,headers:x,status:j,statusText:de,url:we||void 0}))},f=x=>{const{url:j}=a(),de=new Jp({error:x,status:i.status||0,statusText:i.statusText||"Unknown Error",url:j||void 0});r.error(de)};let p=!1;const m=x=>{p||(r.next(a()),p=!0);let j={type:In.DownloadProgress,loaded:x.loaded};x.lengthComputable&&(j.total=x.total),"text"===n.responseType&&!!i.responseText&&(j.partialText=i.responseText),r.next(j)},E=x=>{let j={type:In.UploadProgress,loaded:x.loaded};x.lengthComputable&&(j.total=x.total),r.next(j)};return i.addEventListener("load",l),i.addEventListener("error",f),i.addEventListener("timeout",f),i.addEventListener("abort",f),n.reportProgress&&(i.addEventListener("progress",m),null!==s&&i.upload&&i.upload.addEventListener("progress",E)),i.send(s),r.next({type:In.Sent}),()=>{i.removeEventListener("error",f),i.removeEventListener("abort",f),i.removeEventListener("load",l),i.removeEventListener("timeout",f),n.reportProgress&&(i.removeEventListener("progress",m),null!==s&&i.upload&&i.upload.removeEventListener("progress",E)),i.readyState!==i.DONE&&i.abort()}})}}return t.\u0275fac=function(n){return new(n||t)(Qe(lw))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const Xp=new Ct("XSRF_COOKIE_NAME"),eg=new Ct("XSRF_HEADER_NAME");class kw{}let Lk=(()=>{class t{constructor(n,r,i){this.doc=n,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=nw(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return t.\u0275fac=function(n){return new(n||t)(Qe(Nr),Qe(kl),Qe(Xp))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),tg=(()=>{class t{constructor(n,r){this.tokenService=n,this.headerName=r}intercept(n,r){const i=n.url.toLowerCase();if("GET"===n.method||"HEAD"===n.method||i.startsWith("http://")||i.startsWith("https://"))return r.handle(n);const s=this.tokenService.getToken();return null!==s&&!n.headers.has(this.headerName)&&(n=n.clone({headers:n.headers.set(this.headerName,s)})),r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(Qe(kw),Qe(eg))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),jk=(()=>{class t{constructor(n,r){this.backend=n,this.injector=r,this.chain=null}handle(n){if(null===this.chain){const r=this.injector.get(Zp,[]);this.chain=r.reduceRight((i,s)=>new Tw(i,s),this.backend)}return this.chain.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(Qe(xw),Qe(nr))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),Bk=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:tg,useClass:Rk}]}}static withOptions(n={}){return{ngModule:t,providers:[n.cookieName?{provide:Xp,useValue:n.cookieName}:[],n.headerName?{provide:eg,useValue:n.headerName}:[]]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({providers:[tg,{provide:Zp,useExisting:tg,multi:!0},{provide:kw,useClass:Lk},{provide:Xp,useValue:"XSRF-TOKEN"},{provide:eg,useValue:"X-XSRF-TOKEN"}]}),t})(),Uk=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({providers:[Qp,{provide:Ew,useClass:jk},Pw,{provide:xw,useExisting:Pw}],imports:[[Bk.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();class bi extends Bt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const{isArray:Hk}=Array,{getPrototypeOf:Vk,prototype:$k,keys:qk}=Object;const{isArray:zk}=Array;function Qk(...t){const e=gs(t),n=function qa(t){return ne(Do(t))?t.pop():void 0}(t),{args:r,keys:i}=function Kk(t){if(1===t.length){const e=t[0];if(Hk(e))return{args:e,keys:null};if(function Gk(t){return t&&"object"==typeof t&&Vk(t)===$k}(e)){const n=qk(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}(t);if(0===r.length)return bn([],e);const s=new _t(function Zk(t,e,n=Pt){return r=>{Mw(e,()=>{const{length:i}=t,s=new Array(i);let o=i,a=i;for(let l=0;l<i;l++)Mw(e,()=>{const f=bn(t[l],e);let p=!1;f.subscribe(new Vt(r,m=>{s[l]=m,p||(p=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>function Yk(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}(i,o):Pt));return n?s.pipe(function Jk(t){return ct(e=>function Wk(t,e){return zk(e)?t(...e):t(e)}(t,e))}(n)):s}function Mw(t,e,n){t?Ir(n,t,e):e()}const Hu=Z(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function ng(...t){return function Xk(){return Ti(1)}()(bn(t,gs(t)))}function Rw(t){return new _t(e=>{$t(t()).subscribe(e)})}function Ow(){return Mt((t,e)=>{let n=null;t._refCount++;const r=new Vt(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}class eM extends _t{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,qn(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new M;const n=this.getSubject();e.add(this.source.subscribe(new Vt(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=M.EMPTY)}return e}refCount(){return Ow()(this)}}function oo(t,e){return Mt((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(new Vt(r,l=>{null==i||i.unsubscribe();let f=0;const p=s++;$t(t(l,p)).subscribe(i=new Vt(r,m=>r.next(e?e(l,m,p,f++):m),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function nM(t,e,n,r,i){return(s,o)=>{let a=n,l=e,f=0;s.subscribe(new Vt(o,p=>{const m=f++;l=a?t(l,p,m):(a=!0,p),r&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}function Nw(t,e){return Mt(nM(t,e,arguments.length>=2,!0))}function Rs(t){return Mt((e,n)=>{let s,r=null,i=!1;r=e.subscribe(new Vt(n,void 0,void 0,o=>{s=$t(t(o,Rs(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function rg(t){return t<=0?()=>Gr:Mt((e,n)=>{let r=[];e.subscribe(new Vt(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Lw(t=rM){return Mt((e,n)=>{let r=!1;e.subscribe(new Vt(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function rM(){return new Hu}function jw(t){return Mt((e,n)=>{let r=!1;e.subscribe(new Vt(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Ca(t,e){const n=arguments.length>=2;return r=>r.pipe(t?so((i,s)=>t(i,s,r)):Pt,Ao(1),n?jw(e):Lw(()=>new Hu))}function Lr(t,e,n){const r=ne(t)||e||n?{next:t,error:e,complete:n}:t;return r?Mt((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(new Vt(s,l=>{var f;null===(f=r.next)||void 0===f||f.call(r,l),s.next(l)},()=>{var l;a=!1,null===(l=r.complete)||void 0===l||l.call(r),s.complete()},l=>{var f;a=!1,null===(f=r.error)||void 0===f||f.call(r,l),s.error(l)},()=>{var l,f;a&&(null===(l=r.unsubscribe)||void 0===l||l.call(r)),null===(f=r.finalize)||void 0===f||f.call(r)}))}):Pt}class us{constructor(e,n){this.id=e,this.url=n}}class ig extends us{constructor(e,n,r="imperative",i=null){super(e,n),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Vu extends us{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Bw extends us{constructor(e,n,r){super(e,n),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class oM extends us{constructor(e,n,r){super(e,n),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class aM extends us{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class uM extends us{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cM extends us{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class lM extends us{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dM extends us{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Uw{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Hw{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class fM{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hM{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pM{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gM{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vw{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const vt="primary";class mM{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function Da(t){return new mM(t)}const $w="ngNavigationCancelingError";function sg(t){const e=Error("NavigationCancelingError: "+t);return e[$w]=!0,e}function vM(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function qi(t,e){const n=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!qw(t[i],e[i]))return!1;return!0}function qw(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}return t===e}function Kw(t){return Array.prototype.concat.apply([],t)}function Gw(t){return t.length>0?t[t.length-1]:null}function Wn(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Ki(t){return fv(t)?t:ml(t)?bn(Promise.resolve(t)):lt(t)}const wM={exact:function Jw(t,e,n){if(!uo(t.segments,e.segments)||!Ql(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!Jw(t.children[r],e.children[r],n))return!1;return!0},subset:Yw},zw={exact:function SM(t,e){return qi(t,e)},subset:function EM(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>qw(t[n],e[n]))},ignored:()=>!0};function Ww(t,e,n){return wM[n.paths](t.root,e.root,n.matrixParams)&&zw[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function Yw(t,e,n){return Qw(t,e,e.segments,n)}function Qw(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!(!uo(i,n)||e.hasChildren()||!Ql(i,n,r))}if(t.segments.length===n.length){if(!uo(t.segments,n)||!Ql(t.segments,n,r))return!1;for(const i in e.children)if(!t.children[i]||!Yw(t.children[i],e.children[i],r))return!1;return!0}{const i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(uo(t.segments,i)&&Ql(t.segments,i,r)&&t.children[vt])&&Qw(t.children[vt],e,s,r)}}function Ql(t,e,n){return e.every((r,i)=>zw[n](t[i].parameters,r.parameters))}class ao{constructor(e,n,r){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Da(this.queryParams)),this._queryParamMap}toString(){return DM.serialize(this)}}class Dt{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Wn(n,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Zl(this)}}class $u{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=Da(this.parameters)),this._parameterMap}toString(){return n1(this)}}function uo(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}class Zw{}class Xw{parse(e){const n=new OM(e);return new ao(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${qu(e.root,!0)}`,r=function IM(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(i=>`${Xl(n)}=${Xl(i)}`).join("&"):`${Xl(n)}=${Xl(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${r}${"string"==typeof e.fragment?`#${function AM(t){return encodeURI(t)}(e.fragment)}`:""}`}}const DM=new Xw;function Zl(t){return t.segments.map(e=>n1(e)).join("/")}function qu(t,e){if(!t.hasChildren())return Zl(t);if(e){const n=t.children[vt]?qu(t.children[vt],!1):"",r=[];return Wn(t.children,(i,s)=>{s!==vt&&r.push(`${s}:${qu(i,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function CM(t,e){let n=[];return Wn(t.children,(r,i)=>{i===vt&&(n=n.concat(e(r,i)))}),Wn(t.children,(r,i)=>{i!==vt&&(n=n.concat(e(r,i)))}),n}(t,(r,i)=>i===vt?[qu(t.children[vt],!1)]:[`${i}:${qu(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[vt]?`${Zl(t)}/${n[0]}`:`${Zl(t)}/(${n.join("//")})`}}function e1(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Xl(t){return e1(t).replace(/%3B/gi,";")}function og(t){return e1(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ed(t){return decodeURIComponent(t)}function t1(t){return ed(t.replace(/\+/g,"%20"))}function n1(t){return`${og(t.path)}${function FM(t){return Object.keys(t).map(e=>`;${og(e)}=${og(t[e])}`).join("")}(t.parameters)}`}const TM=/^[^\/()?;=#]+/;function td(t){const e=t.match(TM);return e?e[0]:""}const PM=/^[^=?&#]+/,MM=/^[^&#]+/;class OM{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Dt([],{}):new Dt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[vt]=new Dt(e,n)),r}parseSegment(){const e=td(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new $u(ed(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=td(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=td(this.remaining);i&&(r=i,this.capture(r))}e[ed(n)]=ed(r)}parseQueryParam(e){const n=function kM(t){const e=t.match(PM);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const o=function RM(t){const e=t.match(MM);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=t1(n),s=t1(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=td(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let s;r.indexOf(":")>-1?(s=r.substr(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=vt);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[vt]:new Dt([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class r1{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=ag(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=ag(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=ug(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ug(e,this._root).map(n=>n.value)}}function ag(t,e){if(t===e.value)return e;for(const n of e.children){const r=ag(t,n);if(r)return r}return null}function ug(t,e){if(t===e.value)return[e];for(const n of e.children){const r=ug(t,n);if(r.length)return r.unshift(e),r}return[]}class cs{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Aa(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class i1 extends r1{constructor(e,n){super(e),this.snapshot=n,cg(this,e)}toString(){return this.snapshot.toString()}}function s1(t,e){const n=function NM(t,e){const o=new nd([],{},{},"",{},vt,e,null,t.root,-1,{});return new a1("",new cs(o,[]))}(t,e),r=new bi([new $u("",{})]),i=new bi({}),s=new bi({}),o=new bi({}),a=new bi(""),l=new co(r,i,o,a,s,vt,e,n.root);return l.snapshot=n.root,new i1(new cs(l,[]),n)}class co{constructor(e,n,r,i,s,o,a,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ct(e=>Da(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ct(e=>Da(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function o1(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const i=n[r],s=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(s.component)break;r--}}return function LM(t){return t.reduce((e,n)=>({params:Object.assign(Object.assign({},e.params),n.params),data:Object.assign(Object.assign({},e.data),n.data),resolve:Object.assign(Object.assign({},e.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class nd{constructor(e,n,r,i,s,o,a,l,f,p,m){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=f,this._lastPathIndex=p,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Da(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Da(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class a1 extends r1{constructor(e,n){super(n),this.url=e,cg(this,n)}toString(){return u1(this._root)}}function cg(t,e){e.value._routerState=t,e.children.forEach(n=>cg(t,n))}function u1(t){const e=t.children.length>0?` { ${t.children.map(u1).join(", ")} } `:"";return`${t.value}${e}`}function lg(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,qi(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),qi(e.params,n.params)||t.params.next(n.params),function _M(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!qi(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),qi(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function dg(t,e){const n=qi(t.params,e.params)&&function xM(t,e){return uo(t,e)&&t.every((n,r)=>qi(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||dg(t.parent,e.parent))}function Ku(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function BM(t,e,n){return e.children.map(r=>{for(const i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Ku(t,r,i);return Ku(t,r)})}(t,e,n);return new cs(r,i)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Ku(t,a)),o}}const r=function UM(t){return new co(new bi(t.url),new bi(t.params),new bi(t.queryParams),new bi(t.fragment),new bi(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(s=>Ku(t,s));return new cs(r,i)}}function rd(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Gu(t){return"object"==typeof t&&null!=t&&t.outlets}function fg(t,e,n,r,i){let s={};return r&&Wn(r,(o,a)=>{s[a]=Array.isArray(o)?o.map(l=>`${l}`):`${o}`}),new ao(n.root===t?e:c1(n.root,t,e),s,i)}function c1(t,e,n){const r={};return Wn(t.children,(i,s)=>{r[s]=i===e?n:c1(i,e,n)}),new Dt(t.segments,r)}class l1{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&rd(r[0]))throw new Error("Root segment cannot have matrix parameters");const i=r.find(Gu);if(i&&i!==Gw(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class hg{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function d1(t,e,n){if(t||(t=new Dt([],{})),0===t.segments.length&&t.hasChildren())return id(t,e,n);const r=function GM(t,e,n){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;const o=t.segments[i],a=n[r];if(Gu(a))break;const l=`${a}`,f=r<n.length-1?n[r+1]:null;if(i>0&&void 0===l)break;if(l&&f&&"object"==typeof f&&void 0===f.outlets){if(!h1(l,f,o))return s;r+=2}else{if(!h1(l,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const s=new Dt(t.segments.slice(0,r.pathIndex),{});return s.children[vt]=new Dt(t.segments.slice(r.pathIndex),t.children),id(s,0,i)}return r.match&&0===i.length?new Dt(t.segments,{}):r.match&&!t.hasChildren()?pg(t,e,n):r.match?id(t,0,i):pg(t,e,n)}function id(t,e,n){if(0===n.length)return new Dt(t.segments,{});{const r=function KM(t){return Gu(t[0])?t[0].outlets:{[vt]:t}}(n),i={};return Wn(r,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=d1(t.children[o],e,s))}),Wn(t.children,(s,o)=>{void 0===r[o]&&(i[o]=s)}),new Dt(t.segments,i)}}function pg(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const s=n[i];if(Gu(s)){const l=zM(s.outlets);return new Dt(r,l)}if(0===i&&rd(n[0])){r.push(new $u(t.segments[e].path,f1(n[0]))),i++;continue}const o=Gu(s)?s.outlets[vt]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&rd(a)?(r.push(new $u(o,f1(a))),i+=2):(r.push(new $u(o,{})),i++)}return new Dt(r,{})}function zM(t){const e={};return Wn(t,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(e[r]=pg(new Dt([],{}),0,n))}),e}function f1(t){const e={};return Wn(t,(n,r)=>e[r]=`${n}`),e}function h1(t,e,n){return t==n.path&&qi(e,n.parameters)}class JM{constructor(e,n,r,i){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),lg(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const i=Aa(n);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Wn(i,(s,o)=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Aa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Aa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,n,r){const i=Aa(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new gM(s.value.snapshot))}),e.children.length&&this.forwardEvent(new hM(e.value.snapshot))}activateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(lg(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),lg(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=function YM(t){for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(i.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=i,o.resolver=l,o.outlet&&o.outlet.activateWith(i,l),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class gg{constructor(e,n){this.routes=e,this.module=n}}function Os(t){return"function"==typeof t}function lo(t){return t instanceof ao}const zu=Symbol("INITIAL_VALUE");function Wu(){return oo(t=>Qk(t.map(e=>e.pipe(Ao(1),function tM(...t){const e=gs(t);return Mt((n,r)=>{(e?ng(t,n,e):ng(t,n)).subscribe(r)})}(zu)))).pipe(Nw((e,n)=>{let r=!1;return n.reduce((i,s,o)=>i!==zu?i:(s===zu&&(r=!0),r||!1!==s&&o!==n.length-1&&!lo(s)?i:s),e)},zu),so(e=>e!==zu),ct(e=>lo(e)?e:!0===e),Ao(1)))}class nR{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Ju,this.attachRef=null}}class Ju{constructor(){this.contexts=new Map}onChildOutletCreated(e,n){const r=this.getOrCreateContext(e);r.outlet=n,this.contexts.set(e,r)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new nR,this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}}let mg=(()=>{class t{constructor(n,r,i,s,o){this.parentContexts=n,this.location=r,this.resolver=i,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Dn,this.deactivateEvents=new Dn,this.attachEvents=new Dn,this.detachEvents=new Dn,this.name=s||vt,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const o=(r=r||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new rR(n,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(n){return new(n||t)(He(Ju),He(mi),He(ya),function ru(t){return function GE(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const r=n.length;let i=0;for(;i<r;){const s=n[i];if(Rm(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(s===e)return n[i+1];i+=2}}}return null}(Mn(),t)}("name"),He(_p))},t.\u0275dir=Zn({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),t})();class rR{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===co?this.route:e===Ju?this.childContexts:this.parent.get(e,n)}}let p1=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_r({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,r){1&n&&Hi(0,"router-outlet")},directives:[mg],encapsulation:2}),t})();function g1(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];iR(r,sR(e,r))}}function iR(t,e){t.children&&g1(t.children,e)}function sR(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function yg(t){const e=t.children&&t.children.map(yg),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==vt&&(n.component=p1),n}function ni(t){return t.outlet||vt}function m1(t,e){const n=t.filter(r=>ni(r)===e);return n.push(...t.filter(r=>ni(r)!==e)),n}const y1={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function sd(t,e,n){var r;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},y1):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(e.matcher||vM)(n,t,e);if(!s)return Object.assign({},y1);const o={};Wn(s.posParams,(l,f)=>{o[f]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:a,positionalParamSegments:null!==(r=s.posParams)&&void 0!==r?r:{}}}function od(t,e,n,r,i="corrected"){if(n.length>0&&function uR(t,e,n){return n.some(r=>ad(t,e,r)&&ni(r)!==vt)}(t,n,r)){const o=new Dt(e,function aR(t,e,n,r){const i={};i[vt]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&ni(s)!==vt){const o=new Dt([],{});o._sourceSegment=t,o._segmentIndexShift=e.length,i[ni(s)]=o}return i}(t,e,r,new Dt(n,t.children)));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function cR(t,e,n){return n.some(r=>ad(t,e,r))}(t,n,r)){const o=new Dt(t.segments,function oR(t,e,n,r,i,s){const o={};for(const a of r)if(ad(t,n,a)&&!i[ni(a)]){const l=new Dt([],{});l._sourceSegment=t,l._segmentIndexShift="legacy"===s?t.segments.length:e.length,o[ni(a)]=l}return Object.assign(Object.assign({},i),o)}(t,e,n,r,t.children,i));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}const s=new Dt(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function ad(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function v1(t,e,n,r){return!!(ni(t)===r||r!==vt&&ad(e,n,t))&&("**"===t.path||sd(e,t,n).matched)}function _1(t,e,n){return 0===e.length&&!t.children[n]}class Yu{constructor(e){this.segmentGroup=e||null}}class b1{constructor(e){this.urlTree=e}}function ud(t){return new _t(e=>e.error(new Yu(t)))}function w1(t){return new _t(e=>e.error(new b1(t)))}function lR(t){return new _t(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class hR{constructor(e,n,r,i,s){this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(is)}apply(){const e=od(this.urlTree.root,[],[],this.config).segmentGroup,n=new Dt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,n,vt).pipe(ct(s=>this.createUrlTree(vg(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Rs(s=>{if(s instanceof b1)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Yu?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,vt).pipe(ct(i=>this.createUrlTree(vg(i),e.queryParams,e.fragment))).pipe(Rs(i=>{throw i instanceof Yu?this.noMatchError(i):i}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,n,r){const i=e.segments.length>0?new Dt([],{[vt]:e}):e;return new ao(i,n,r)}expandSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,n,r).pipe(ct(s=>new Dt([],s))):this.expandSegment(e,r,n,r.segments,i,!0)}expandChildren(e,n,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return bn(i).pipe(xa(s=>{const o=r.children[s],a=m1(n,s);return this.expandSegmentGroup(e,a,o,s).pipe(ct(l=>({segment:l,outlet:s})))}),Nw((s,o)=>(s[o.outlet]=o.segment,s),{}),function iM(t,e){const n=arguments.length>=2;return r=>r.pipe(t?so((i,s)=>t(i,s,r)):Pt,rg(1),n?jw(e):Lw(()=>new Hu))}())}expandSegment(e,n,r,i,s,o){return bn(r).pipe(xa(a=>this.expandSegmentAgainstRoute(e,n,r,a,i,s,o).pipe(Rs(f=>{if(f instanceof Yu)return lt(null);throw f}))),Ca(a=>!!a),Rs((a,l)=>{if(a instanceof Hu||"EmptyError"===a.name){if(_1(n,i,s))return lt(new Dt([],{}));throw new Yu(n)}throw a}))}expandSegmentAgainstRoute(e,n,r,i,s,o,a){return v1(i,n,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,n,i,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o):ud(n):ud(n)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,i){const s=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?w1(s):this.lineralizeSegments(r,s).pipe(sn(o=>{const a=new Dt(o,{});return this.expandSegment(e,a,n,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){const{matched:a,consumedSegments:l,lastChild:f,positionalParamSegments:p}=sd(n,i,s);if(!a)return ud(n);const m=this.applyRedirectCommands(l,i.redirectTo,p);return i.redirectTo.startsWith("/")?w1(m):this.lineralizeSegments(i,m).pipe(sn(E=>this.expandSegment(e,n,r,E.concat(s.slice(f)),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){if("**"===r.path)return r.loadChildren?(r._loadedConfig?lt(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe(ct(E=>(r._loadedConfig=E,new Dt(i,{})))):lt(new Dt(i,{}));const{matched:o,consumedSegments:a,lastChild:l}=sd(n,r,i);if(!o)return ud(n);const f=i.slice(l);return this.getChildConfig(e,r,i).pipe(sn(m=>{const E=m.module,x=m.routes,{segmentGroup:j,slicedSegments:de}=od(n,a,f,x),we=new Dt(j.segments,j.children);if(0===de.length&&we.hasChildren())return this.expandChildren(E,x,we).pipe(ct(Ze=>new Dt(a,Ze)));if(0===x.length&&0===de.length)return lt(new Dt(a,{}));const xe=ni(r)===s;return this.expandSegment(E,we,x,de,xe?vt:s,!0).pipe(ct(Me=>new Dt(a.concat(Me.segments),Me.children)))}))}getChildConfig(e,n,r){return n.children?lt(new gg(n.children,e)):n.loadChildren?void 0!==n._loadedConfig?lt(n._loadedConfig):this.runCanLoadGuards(e.injector,n,r).pipe(sn(i=>i?this.configLoader.load(e.injector,n).pipe(ct(s=>(n._loadedConfig=s,s))):function dR(t){return new _t(e=>e.error(sg(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(n))):lt(new gg([],e))}runCanLoadGuards(e,n,r){const i=n.canLoad;return i&&0!==i.length?lt(i.map(o=>{const a=e.get(o);let l;if(function ZM(t){return t&&Os(t.canLoad)}(a))l=a.canLoad(n,r);else{if(!Os(a))throw new Error("Invalid CanLoad guard");l=a(n,r)}return Ki(l)})).pipe(Wu(),Lr(o=>{if(!lo(o))return;const a=sg(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),ct(o=>!0===o)):lt(!0)}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return lt(r);if(i.numberOfChildren>1||!i.children[vt])return lR(e.redirectTo);i=i.children[vt]}}applyRedirectCommands(e,n,r){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),e,r)}applyRedirectCreatreUrlTree(e,n,r,i){const s=this.createSegmentGroup(e,n.root,r,i);return new ao(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return Wn(e,(i,s)=>{if("string"==typeof i&&i.startsWith(":")){const a=i.substring(1);r[s]=n[a]}else r[s]=i}),r}createSegmentGroup(e,n,r,i){const s=this.createSegments(e,n.segments,r,i);let o={};return Wn(n.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,r,i)}),new Dt(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){const i=r[n.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${e}'. Cannot find '${n.path}'.`);return i}findOrReturn(e,n){let r=0;for(const i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}}function vg(t){const e={};for(const r of Object.keys(t.children)){const s=vg(t.children[r]);(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function pR(t){if(1===t.numberOfChildren&&t.children[vt]){const e=t.children[vt];return new Dt(t.segments.concat(e.segments),e.children)}return t}(new Dt(t.segments,e))}class S1{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class cd{constructor(e,n){this.component=e,this.route=n}}function mR(t,e,n){const r=t._root;return Qu(r,e?e._root:null,n,[r.value])}function ld(t,e,n){const r=function vR(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function Qu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Aa(e);return t.children.forEach(o=>{(function _R(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function bR(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!uo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!uo(t.url,e.url)||!qi(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!dg(t,e)||!qi(t.queryParams,e.queryParams);default:return!dg(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new S1(r)):(s.data=o.data,s._resolvedData=o._resolvedData),Qu(t,e,s.component?a?a.children:null:n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new cd(a.outlet.component,o))}else o&&Zu(e,a,i),i.canActivateChecks.push(new S1(r)),Qu(t,null,s.component?a?a.children:null:n,r,i)})(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Wn(s,(o,a)=>Zu(o,n.getContext(a),i)),i}function Zu(t,e,n){const r=Aa(t),i=t.value;Wn(r,(s,o)=>{Zu(s,i.component?e?e.children.getContext(o):null:e,n)}),n.canDeactivateChecks.push(new cd(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class IR{}function E1(t){return new _t(e=>e.error(t))}class PR{constructor(e,n,r,i,s,o){this.rootComponentType=e,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=od(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,e,vt);if(null===n)return null;const r=new nd([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},vt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new cs(r,n),s=new a1(this.url,i);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const n=e.value,r=o1(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,n):this.processSegment(e,n,n.segments,r)}processChildren(e,n){const r=[];for(const s of Object.keys(n.children)){const o=n.children[s],a=m1(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;r.push(...l)}const i=x1(r);return function kR(t){t.sort((e,n)=>e.value.outlet===vt?-1:n.value.outlet===vt?1:e.value.outlet.localeCompare(n.value.outlet))}(i),i}processSegment(e,n,r,i){for(const s of e){const o=this.processSegmentAgainstRoute(s,n,r,i);if(null!==o)return o}return _1(n,r,i)?[]:null}processSegmentAgainstRoute(e,n,r,i){if(e.redirectTo||!v1(e,n,r,i))return null;let s,o=[],a=[];if("**"===e.path){const x=r.length>0?Gw(r).parameters:{};s=new nd(r,x,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,A1(e),ni(e),e.component,e,C1(n),D1(n)+r.length,F1(e))}else{const x=sd(n,e,r);if(!x.matched)return null;o=x.consumedSegments,a=r.slice(x.lastChild),s=new nd(o,x.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,A1(e),ni(e),e.component,e,C1(n),D1(n)+o.length,F1(e))}const l=function MR(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(e),{segmentGroup:f,slicedSegments:p}=od(n,o,a,l.filter(x=>void 0===x.redirectTo),this.relativeLinkResolution);if(0===p.length&&f.hasChildren()){const x=this.processChildren(l,f);return null===x?null:[new cs(s,x)]}if(0===l.length&&0===p.length)return[new cs(s,[])];const m=ni(e)===i,E=this.processSegment(l,f,p,m?vt:i);return null===E?null:[new cs(s,E)]}}function RR(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function x1(t){const e=[],n=new Set;for(const r of t){if(!RR(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):e.push(r)}for(const r of n){const i=x1(r.children);e.push(new cs(r.value,i))}return e.filter(r=>!n.has(r))}function C1(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function D1(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function A1(t){return t.data||{}}function F1(t){return t.resolve||{}}function _g(t){return oo(e=>{const n=t(e);return n?bn(n).pipe(ct(()=>e)):lt(e)})}class VR extends class HR{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}{}const bg=new Ct("ROUTES");class I1{constructor(e,n,r,i){this.injector=e,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}load(e,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const i=this.loadModuleFactory(n.loadChildren).pipe(ct(s=>{this.onLoadEndListener&&this.onLoadEndListener(n);const o=s.create(e);return new gg(Kw(o.injector.get(bg,void 0,st.Self|st.Optional)).map(yg),o)}),Rs(s=>{throw n._loader$=void 0,s}));return n._loader$=new eM(i,()=>new Bt).pipe(Ow()),n._loader$}loadModuleFactory(e){return Ki(e()).pipe(sn(n=>n instanceof L_?lt(n):bn(this.compiler.compileModuleAsync(n))))}}class qR{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}}function KR(t){throw t}function GR(t,e,n){return e.parse("/")}function T1(t,e){return lt(null)}const zR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},WR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Jn=(()=>{class t{constructor(n,r,i,s,o,a,l){this.rootComponentType=n,this.urlSerializer=r,this.rootContexts=i,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Bt,this.errorHandler=KR,this.malformedUriErrorHandler=GR,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:T1,afterPreactivation:T1},this.urlHandlingStrategy=new qR,this.routeReuseStrategy=new VR,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(is),this.console=o.get(vb);const m=o.get(Nn);this.isNgZoneEnabled=m instanceof Nn&&Nn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function bM(){return new ao(new Dt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new I1(o,a,E=>this.triggerEvent(new Uw(E)),E=>this.triggerEvent(new Hw(E))),this.routerState=s1(this.currentUrlTree,this.rootComponentType),this.transitions=new bi({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const r=this.events;return n.pipe(so(i=>0!==i.id),ct(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),oo(i=>{let s=!1,o=!1;return lt(i).pipe(Lr(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),oo(a=>{const l=this.browserUrlTree.toString(),f=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||f)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return dd(a.source)&&(this.browserUrlTree=a.extractedUrl),lt(a).pipe(oo(m=>{const E=this.transitions.getValue();return r.next(new ig(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),E!==this.transitions.getValue()?Gr:Promise.resolve(m)}),function gR(t,e,n,r){return oo(i=>function fR(t,e,n,r,i){return new hR(t,e,n,r,i).apply()}(t,e,n,i.extractedUrl,r).pipe(ct(s=>Object.assign(Object.assign({},i),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Lr(m=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:m.urlAfterRedirects})}),function OR(t,e,n,r,i){return sn(s=>function TR(t,e,n,r,i="emptyOnly",s="legacy"){try{const o=new PR(t,e,n,r,i,s).recognize();return null===o?E1(new IR):lt(o)}catch(o){return E1(o)}}(t,e,s.urlAfterRedirects,n(s.urlAfterRedirects),r,i).pipe(ct(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,m=>this.serializeUrl(m),this.paramsInheritanceStrategy,this.relativeLinkResolution),Lr(m=>{if("eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const x=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(x,m)}this.browserUrlTree=m.urlAfterRedirects}const E=new aM(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(E)}));if(f&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:E,extractedUrl:x,source:j,restoredState:de,extras:we}=a,xe=new ig(E,this.serializeUrl(x),j,de);r.next(xe);const ye=s1(x,this.rootComponentType).snapshot;return lt(Object.assign(Object.assign({},a),{targetSnapshot:ye,urlAfterRedirects:x,extras:Object.assign(Object.assign({},we),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),Gr}),_g(a=>{const{targetSnapshot:l,id:f,extractedUrl:p,rawUrl:m,extras:{skipLocationChange:E,replaceUrl:x}}=a;return this.hooks.beforePreactivation(l,{navigationId:f,appliedUrlTree:p,rawUrlTree:m,skipLocationChange:!!E,replaceUrl:!!x})}),Lr(a=>{const l=new uM(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),ct(a=>Object.assign(Object.assign({},a),{guards:mR(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function wR(t,e){return sn(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?lt(Object.assign(Object.assign({},n),{guardsResult:!0})):function SR(t,e,n,r){return bn(t).pipe(sn(i=>function FR(t,e,n,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?lt(s.map(a=>{const l=ld(a,e,i);let f;if(function tR(t){return t&&Os(t.canDeactivate)}(l))f=Ki(l.canDeactivate(t,e,n,r));else{if(!Os(l))throw new Error("Invalid CanDeactivate guard");f=Ki(l(t,e,n,r))}return f.pipe(Ca())})).pipe(Wu()):lt(!0)}(i.component,i.route,n,e,r)),Ca(i=>!0!==i,!0))}(o,r,i,t).pipe(sn(a=>a&&function QM(t){return"boolean"==typeof t}(a)?function ER(t,e,n,r){return bn(e).pipe(xa(i=>ng(function CR(t,e){return null!==t&&e&&e(new fM(t)),lt(!0)}(i.route.parent,r),function xR(t,e){return null!==t&&e&&e(new pM(t)),lt(!0)}(i.route,r),function AR(t,e,n){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function yR(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Rw(()=>lt(o.guards.map(l=>{const f=ld(l,o.node,n);let p;if(function eR(t){return t&&Os(t.canActivateChild)}(f))p=Ki(f.canActivateChild(r,t));else{if(!Os(f))throw new Error("Invalid CanActivateChild guard");p=Ki(f(r,t))}return p.pipe(Ca())})).pipe(Wu())));return lt(s).pipe(Wu())}(t,i.path,n),function DR(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return lt(!0);const i=r.map(s=>Rw(()=>{const o=ld(s,e,n);let a;if(function XM(t){return t&&Os(t.canActivate)}(o))a=Ki(o.canActivate(e,t));else{if(!Os(o))throw new Error("Invalid CanActivate guard");a=Ki(o(e,t))}return a.pipe(Ca())}));return lt(i).pipe(Wu())}(t,i.route,n))),Ca(i=>!0!==i,!0))}(r,s,t,e):lt(a)),ct(a=>Object.assign(Object.assign({},n),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Lr(a=>{if(lo(a.guardsResult)){const f=sg(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw f.url=a.guardsResult,f}const l=new cM(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),so(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),_g(a=>{if(a.guards.canActivateChecks.length)return lt(a).pipe(Lr(l=>{const f=new lM(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(f)}),oo(l=>{let f=!1;return lt(l).pipe(function NR(t,e){return sn(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return lt(n);let s=0;return bn(i).pipe(xa(o=>function LR(t,e,n,r){return function jR(t,e,n,r){const i=Object.keys(t);if(0===i.length)return lt({});const s={};return bn(i).pipe(sn(o=>function BR(t,e,n,r){const i=ld(t,e,r);return Ki(i.resolve?i.resolve(e,n):i(e,n))}(t[o],e,n,r).pipe(Lr(a=>{s[o]=a}))),rg(1),sn(()=>Object.keys(s).length===i.length?lt(s):Gr))}(t._resolve,t,e,r).pipe(ct(s=>(t._resolvedData=s,t.data=Object.assign(Object.assign({},t.data),o1(t,n).resolve),null)))}(o.route,r,t,e)),Lr(()=>s++),rg(1),sn(o=>s===i.length?lt(n):Gr))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Lr({next:()=>f=!0,complete:()=>{f||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),Lr(l=>{const f=new dM(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(f)}))}),_g(a=>{const{targetSnapshot:l,id:f,extractedUrl:p,rawUrl:m,extras:{skipLocationChange:E,replaceUrl:x}}=a;return this.hooks.afterPreactivation(l,{navigationId:f,appliedUrlTree:p,rawUrlTree:m,skipLocationChange:!!E,replaceUrl:!!x})}),ct(a=>{const l=function jM(t,e,n){const r=Ku(t,e._root,n?n._root:void 0);return new i1(r,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),Lr(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((t,e,n)=>ct(r=>(new JM(e,r.targetRouterState,r.currentRouterState,n).activate(t),r)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Lr({next(){s=!0},complete(){s=!0}}),function sM(t){return Mt((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}(()=>{var a;s||o||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===i.id&&(this.currentNavigation=null)}),Rs(a=>{if(o=!0,function yM(t){return t&&t[$w]}(a)){const l=lo(a.url);l||(this.navigated=!0,this.restoreHistory(i,!0));const f=new Bw(i.id,this.serializeUrl(i.extractedUrl),a.message);r.next(f),l?setTimeout(()=>{const p=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),m={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||dd(i.source)};this.scheduleNavigation(p,"imperative",null,m,{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const l=new oM(i.id,this.serializeUrl(i.extractedUrl),a);r.next(l);try{i.resolve(this.errorHandler(a))}catch(f){i.reject(f)}}return Gr}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var i;const s={replaceUrl:!0},o=(null===(i=n.state)||void 0===i?void 0:i.navigationId)?n.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(n.url);this.scheduleNavigation(a,r,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){g1(n),this.config=n.map(yg),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=r,f=i||this.routerState.root,p=l?this.currentUrlTree.fragment:o;let m=null;switch(a){case"merge":m=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=s||null}return null!==m&&(m=this.removeEmptyProps(m)),function HM(t,e,n,r,i){if(0===n.length)return fg(e.root,e.root,e,r,i);const s=function VM(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new l1(!0,0,t);let e=0,n=!1;const r=t.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Wn(s.outlets,(l,f)=>{a[f]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?n=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new l1(n,e,r)}(n);if(s.toRoot())return fg(e.root,new Dt([],{}),e,r,i);const o=function $M(t,e,n){if(t.isAbsolute)return new hg(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const s=n.snapshot._urlSegment;return new hg(s,s===e.root,0)}const r=rd(t.commands[0])?0:1;return function qM(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new hg(r,!1,i-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(s,e,t),a=o.processChildren?id(o.segmentGroup,o.index,s.commands):d1(o.segmentGroup,o.index,s.commands);return fg(o.segmentGroup,a,e,r,i)}(f,this.currentUrlTree,n,m,null!=p?p:null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=lo(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,r)}navigate(n,r={skipLocationChange:!1}){return function JR(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,n)}return r}isActive(n,r){let i;if(i=!0===r?Object.assign({},zR):!1===r?Object.assign({},WR):r,lo(n))return Ww(this.currentUrlTree,n,i);const s=this.parseUrl(n);return Ww(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.keys(n).reduce((r,i)=>{const s=n[i];return null!=s&&(r[i]=s),r},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new Vu(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,r,i,s,o){var a,l,f;if(this.disposed)return Promise.resolve(!1);const p=this.transitions.value,m=dd(r)&&p&&!dd(p.source),E=p.rawUrl.toString()===n.toString(),x=p.id===(null===(a=this.currentNavigation)||void 0===a?void 0:a.id);if(m&&E&&x)return Promise.resolve(!0);let de,we,xe;o?(de=o.resolve,we=o.reject,xe=o.promise):xe=new Promise((Ze,ut)=>{de=Ze,we=ut});const ye=++this.navigationId;let Me;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),Me=i&&i.\u0275routerPageId?i.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(l=this.browserPageId)&&void 0!==l?l:0:(null!==(f=this.browserPageId)&&void 0!==f?f:0)+1):Me=0,this.setTransition({id:ye,targetPageId:Me,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:s,resolve:de,reject:we,promise:xe,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),xe.catch(Ze=>Promise.reject(Ze))}setBrowserUrl(n,r){const i=this.urlSerializer.serialize(n),s=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",s):this.location.go(i,"",s)}restoreHistory(n,r=!1){var i,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,r){const i=new Bw(n.id,this.serializeUrl(n.extractedUrl),r);this.triggerEvent(i),n.resolve(!1)}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}}return t.\u0275fac=function(n){Rh()},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();function dd(t){return"imperative"!==t}class P1{}class k1{preload(e,n){return lt(null)}}let M1=(()=>{class t{constructor(n,r,i,s){this.router=n,this.injector=i,this.preloadingStrategy=s,this.loader=new I1(i,r,l=>n.triggerEvent(new Uw(l)),l=>n.triggerEvent(new Hw(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(so(n=>n instanceof Vu),xa(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(is);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const s of r)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;i.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?i.push(this.preloadConfig(n,s)):s.children&&i.push(this.processRoutes(n,s.children));return bn(i).pipe(Ti(),ct(s=>{}))}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?lt(r._loadedConfig):this.loader.load(n.injector,r)).pipe(sn(s=>(r._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return t.\u0275fac=function(n){return new(n||t)(Qe(Jn),Qe(Ml),Qe(nr),Qe(P1))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),Eg=(()=>{class t{constructor(n,r,i={}){this.router=n,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof ig?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Vu&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof Vw&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.router.triggerEvent(new Vw(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(n){Rh()},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();const fo=new Ct("ROUTER_CONFIGURATION"),R1=new Ct("ROUTER_FORROOT_GUARD"),XR=[Dp,{provide:Zw,useClass:Xw},{provide:Jn,useFactory:function iO(t,e,n,r,i,s,o={},a,l){const f=new Jn(null,t,e,n,r,i,Kw(s));return a&&(f.urlHandlingStrategy=a),l&&(f.routeReuseStrategy=l),function sO(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(e.canceledNavigationResolution=t.canceledNavigationResolution)}(o,f),o.enableTracing&&f.events.subscribe(p=>{var m,E;null===(m=console.group)||void 0===m||m.call(console,`Router Event: ${p.constructor.name}`),console.log(p.toString()),console.log(p),null===(E=console.groupEnd)||void 0===E||E.call(console)}),f},deps:[Zw,Ju,Dp,nr,Ml,bg,fo,[class $R{},new Ni],[class UR{},new Ni]]},Ju,{provide:co,useFactory:function oO(t){return t.routerState.root},deps:[Jn]},M1,k1,class ZR{preload(e,n){return n().pipe(Rs(()=>lt(null)))}},{provide:fo,useValue:{enableTracing:!1}}];function eO(){return new xb("Router",Jn)}let O1=(()=>{class t{constructor(n,r){}static forRoot(n,r){return{ngModule:t,providers:[XR,N1(n),{provide:R1,useFactory:rO,deps:[[Jn,new Ni,new Ko]]},{provide:fo,useValue:r||{}},{provide:Ea,useFactory:nO,deps:[io,[new lu(Cp),new Ni],fo]},{provide:Eg,useFactory:tO,deps:[Jn,$P,fo]},{provide:P1,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:k1},{provide:xb,multi:!0,useFactory:eO},[xg,{provide:Pl,multi:!0,useFactory:aO,deps:[xg]},{provide:L1,useFactory:uO,deps:[xg]},{provide:yb,multi:!0,useExisting:L1}]]}}static forChild(n){return{ngModule:t,providers:[N1(n)]}}}return t.\u0275fac=function(n){return new(n||t)(Qe(R1,8),Qe(Jn,8))},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({}),t})();function tO(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Eg(t,e,n)}function nO(t,e,n={}){return n.useHash?new xT(t,e):new Gb(t,e)}function rO(t){return"guarded"}function N1(t){return[{provide:ZE,multi:!0,useValue:t},{provide:bg,multi:!0,useValue:t}]}let xg=(()=>{class t{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Bt}appInitializer(){return this.injector.get(wT,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const i=new Promise(a=>r=a),s=this.injector.get(Jn),o=this.injector.get(fo);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),r(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?lt(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),s.initialNavigation()):r(!0),i})}bootstrapListener(n){const r=this.injector.get(fo),i=this.injector.get(M1),s=this.injector.get(Eg),o=this.injector.get(Jn),a=this.injector.get(Ru);n===a.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&o.initialNavigation(),i.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(n){return new(n||t)(Qe(nr))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();function aO(t){return t.appInitializer.bind(t)}function uO(t){return t.bootstrapListener.bind(t)}const L1=new Ct("Router Initializer");let Er=(()=>{class t{}return t.clientRoot="https://tic-tac-toe.si4b.com/",t.stsAuthority="https://identity.si4b.com/",t.resourceRootDomain="https://resource.com",t.resourceApiRoot="/api",t})(),Cg=(()=>{class t{constructor(n){this._httpClient=n,this._httpOptions={headers:new ti({"Content-Type":"application/json"})}}getGames(){return this._httpClient.get(`${Er.resourceRootDomain}/games`)}getGame(n){return this._httpClient.get(`${Er.resourceRootDomain}/games/${n}`)}create(n){return this._httpClient.post(`${Er.resourceRootDomain}/games`,n,this._httpOptions)}makeMove(n,r){return this._httpClient.post(`${Er.resourceRootDomain}/games/${n}/moves`,r,this._httpOptions)}join(n){return this._httpClient.post(`${Er.resourceRootDomain}/games/${n}/join`,{},this._httpOptions)}}return t.\u0275fac=function(n){return new(n||t)(Qe(Qp))},t.\u0275prov=ze({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function j1(t,e,n,r,i,s,o){try{var a=t[s](o),l=a.value}catch(f){return void n(f)}a.done?e(l):Promise.resolve(l).then(r,i)}function Oe(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(l){j1(s,r,i,o,a,"next",l)}function a(l){j1(s,r,i,o,a,"throw",l)}o(void 0)})}}function Ag(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function H1(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){!function i(s,o,a,l){Promise.resolve(l).then(function(f){s({value:f,done:a})},o)}(a,l,(o=t[s](o)).done,o.value)})}}}function Ns(t){var e,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(e=t[n]))return e.call(t);if(r&&null!=(e=t[r]))return new hd(e.call(t));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function hd(t){function e(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var r=n.done;return Promise.resolve(n.value).then(function(i){return{value:i,done:r}})}return(hd=function(r){this.s=r,this.n=r.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(r){var i=this.s.return;return void 0===i?Promise.resolve({value:r,done:!0}):e(i.apply(this.s,arguments))},throw:function(r){var i=this.s.return;return void 0===i?Promise.reject(r):e(i.apply(this.s,arguments))}},new hd(t)}function V1(t){this.wrapped=t}function pd(t){return new V1(t)}function Xu(t){var e,n;function i(o,a){try{var l=t[o](a),f=l.value,p=f instanceof V1;Promise.resolve(p?f.wrapped:f).then(function(m){p?i("return"===o?"return":"next",m):s(l.done?"return":"normal",m)},function(m){i("throw",m)})}catch(m){s("throw",m)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?i(e.key,e.arg):n=null}this._invoke=function r(o,a){return new Promise(function(l,f){var p={key:o,arg:a,resolve:l,reject:f,next:null};n?n=n.next=p:(e=n=p,i(o,a))})},"function"!=typeof t.return&&(this.return=void 0)}function Fg(t){return function(){return new Xu(t.apply(this,arguments))}}Xu.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Xu.prototype.next=function(t){return this._invoke("next",t)},Xu.prototype.throw=function(t){return this._invoke("throw",t)},Xu.prototype.return=function(t){return this._invoke("return",t)};var Re=(()=>{return(t=Re||(Re={})).ApiError="BAD API",t.BadAuthentication="BAD_AUTHENTICATION",t.BadCreds="BAD_CREDS",t.BadHeader="BAD_HEADER",t.BadJson="BAD_JSON",t.BadPayload="BAD_PAYLOAD",t.BadSubject="BAD_SUBJECT",t.Cancelled="CANCELLED",t.ConnectionClosed="CONNECTION_CLOSED",t.ConnectionDraining="CONNECTION_DRAINING",t.ConnectionRefused="CONNECTION_REFUSED",t.ConnectionTimeout="CONNECTION_TIMEOUT",t.Disconnect="DISCONNECT",t.InvalidOption="INVALID_OPTION",t.InvalidPayload="INVALID_PAYLOAD",t.MaxPayloadExceeded="MAX_PAYLOAD_EXCEEDED",t.NoResponders="503",t.NotFunction="NOT_FUNC",t.RequestError="REQUEST_ERROR",t.ServerOptionNotAvailable="SERVER_OPT_NA",t.SubClosed="SUB_CLOSED",t.SubDraining="SUB_DRAINING",t.Timeout="TIMEOUT",t.Tls="TLS",t.Unknown="UNKNOWN_ERROR",t.WssRequired="WSS_REQUIRED",t.JetStreamInvalidAck="JESTREAM_INVALID_ACK",t.JetStream404NoMessages="404",t.JetStream408RequestTimeout="408",t.JetStream409MaxAckPendingExceeded="409",t.JetStream409="409",t.JetStreamNotEnabled="503",t.JetStreamIdleHeartBeat="IDLE_HEARTBEAT",t.AuthorizationViolation="AUTHORIZATION_VIOLATION",t.AuthenticationExpired="AUTHENTICATION_EXPIRED",t.ProtocolError="NATS_PROTOCOL_ERR",t.PermissionsViolation="PERMISSIONS_VIOLATION",Re;var t})();class $1{constructor(){R(this,"messages"),this.messages=new Map,this.messages.set(Re.InvalidPayload,"Invalid payload type - payloads can be 'binary', 'string', or 'json'"),this.messages.set(Re.BadJson,"Bad JSON"),this.messages.set(Re.WssRequired,"TLS is required, therefore a secure websocket connection is also required")}static getMessage(e){return fO.getMessage(e)}getMessage(e){return this.messages.get(e)||e}}const fO=new $1;class We extends Error{constructor(e,n,r){super(e),R(this,"name"),R(this,"message"),R(this,"code"),R(this,"permissionContext"),R(this,"chainedError"),R(this,"api_error"),this.name="NatsError",this.message=e,this.code=n,this.chainedError=r}static errorForCode(e,n){const r=$1.getMessage(e);return new We(r,e,n)}isAuthError(){return this.code===Re.AuthenticationExpired||this.code===Re.AuthorizationViolation}isPermissionError(){return this.code===Re.PermissionsViolation}isProtocolError(){return this.code===Re.ProtocolError}isJetStreamError(){return void 0!==this.api_error}jsError(){return this.api_error?this.api_error:null}}const ir=new Uint8Array(0);var Ls=(()=>{return(t=Ls||(Ls={})).Disconnect="disconnect",t.Reconnect="reconnect",t.Update="update",t.LDM="ldm",t.Error="error",Ls;var t})(),Ia=(()=>{return(t=Ia||(Ia={})).Reconnecting="reconnecting",t.PingTimer="pingTimer",t.StaleConnection="staleConnection",Ia;var t})();const Ig="127.0.0.1";var wi=(()=>{return(t=wi||(wi={})).Timer="timer",t.Count="count",t.JitterTimer="jitterTimer",t.SentinelMsg="sentinelMsg",wi;var t})(),gd=(()=>{return(t=gd||(gd={})).Limits="limits",t.Interest="interest",t.Workqueue="workqueue",gd;var t})(),Ta=(()=>{return(t=Ta||(Ta={})).Old="old",t.New="new",Ta;var t})(),md=(()=>{return(t=md||(md={})).File="file",t.Memory="memory",md;var t})(),xr=(()=>{return(t=xr||(xr={})).All="all",t.Last="last",t.New="new",t.StartSequence="by_start_sequence",t.StartTime="by_start_time",t.LastPerSubject="last_per_subject",xr;var t})(),Vn=(()=>{return(t=Vn||(Vn={})).None="none",t.All="all",t.Explicit="explicit",t.NotSet="",Vn;var t})(),ho=(()=>{return(t=ho||(ho={})).Instant="instant",t.Original="original",ho;var t})(),ri=(()=>{return(t=ri||(ri={})).StreamSourceHdr="Nats-Stream-Source",t.LastConsumerSeqHdr="Nats-Last-Consumer",t.LastStreamSeqHdr="Nats-Last-Stream",t.ConsumerStalledHdr="Nats-Consumer-Stalled",t.MessageSizeHdr="Nats-Msg-Size",t.RollupHdr="Nats-Rollup",t.RollupValueSubject="sub",t.RollupValueAll="all",ri;var t})(),po=(()=>{return(t=po||(po={})).Stream="Nats-Stream",t.Sequence="Nats-Sequence",t.TimeStamp="Nats-Time-Stamp",t.Subject="Nats-Subject",po;var t})();const js=new TextEncoder,Si=new TextDecoder;function ec(...t){const e=[];for(let n=0;n<t.length;n++)e.push(js.encode(t[n]));return 0===e.length?ir:1===e.length?e[0]:function gO(...t){let e=0;for(let i=0;i<t.length;i++)e+=t[i].length;const n=new Uint8Array(e);let r=0;for(let i=0;i<t.length;i++)n.set(t[i],r),r+=t[i].length;return n}(...e)}function G1(t){return t&&0!==t.length?Si.decode(t):""}class tc{constructor(){R(this,"buffers"),R(this,"byteLength"),this.buffers=[],this.byteLength=0}static concat(...e){let n=0;for(let s=0;s<e.length;s++)n+=e[s].length;const r=new Uint8Array(n);let i=0;for(let s=0;s<e.length;s++)r.set(e[s],i),i+=e[s].length;return r}static fromAscii(e){return e||(e=""),js.encode(e)}static toAscii(e){return Si.decode(e)}reset(){this.buffers.length=0,this.byteLength=0}pack(){if(this.buffers.length>1){const e=new Uint8Array(this.byteLength);let n=0;for(let r=0;r<this.buffers.length;r++)e.set(this.buffers[r],n),n+=this.buffers[r].length;this.buffers.length=0,this.buffers.push(e)}}shift(){if(this.buffers.length){const e=this.buffers.shift();if(e)return this.byteLength-=e.length,e}return new Uint8Array(0)}drain(e){if(this.buffers.length){this.pack();const n=this.buffers.pop();if(n){const r=this.byteLength;(void 0===e||e>r)&&(e=r);const i=n.subarray(0,e);return r>e&&this.buffers.push(n.subarray(e)),this.byteLength=r-e,i}}return new Uint8Array(0)}fill(e,...n){e&&(this.buffers.push(e),this.byteLength+=e.length);for(let r=0;r<n.length;r++)n[r]&&n[r].length&&(this.buffers.push(n[r]),this.byteLength+=n[r].length)}peek(){return this.buffers.length?(this.pack(),this.buffers[0]):new Uint8Array(0)}size(){return this.byteLength}length(){return this.buffers.length}}const yd=tc.fromAscii("\r\n"),mO=new Uint8Array(yd)[0],yO=new Uint8Array(yd)[1];function vd(t,...e){for(let n=0;n<e.length;n++){const r=e[n];Object.keys(r).forEach(function(i){t[i]=r[i]})}return t}function _d(t){return Si.decode(t).replace(/\n/g,"\u240a").replace(/\r/g,"\u240d")}function bd(t){const e=We.errorForCode(Re.Timeout);let n,r;const i=new Promise((s,o)=>{n={cancel:()=>{r&&clearTimeout(r)}},r=setTimeout(()=>{o(e)},t)});return Object.assign(i,n)}function Tg(t=0){return new Promise(e=>{setTimeout(()=>{e()},t)})}function an(){let t={};const e=new Promise((n,r)=>{t={resolve:n,reject:r}});return Object.assign(e,t)}function z1(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}class Cr{constructor(){R(this,"inflight"),R(this,"processed"),R(this,"received"),R(this,"noIterator"),R(this,"iterClosed"),R(this,"done"),R(this,"signal"),R(this,"yields"),R(this,"filtered"),R(this,"pendingFiltered"),R(this,"ingestionFilterFn"),R(this,"protocolFilterFn"),R(this,"dispatchedFn"),R(this,"ctx"),R(this,"_data"),R(this,"err"),R(this,"time"),this.inflight=0,this.filtered=0,this.pendingFiltered=0,this.processed=0,this.received=0,this.noIterator=!1,this.done=!1,this.signal=an(),this.yields=[],this.iterClosed=an(),this.time=0}[Symbol.asyncIterator](){return this.iterate()}push(e){if(this.done)return;if("function"==typeof e)return this.yields.push(e),void this.signal.resolve();const{ingest:n,protocol:r}=this.ingestionFilterFn?this.ingestionFilterFn(e,this.ctx||this):{ingest:!0,protocol:!1};n&&(r&&(this.filtered++,this.pendingFiltered++),this.yields.push(e),this.signal.resolve())}iterate(){var e=this;return Fg(function*(){if(e.noIterator)throw new We("unsupported iterator",Re.ApiError);try{for(;;){if(0===e.yields.length&&(yield pd(e.signal)),e.err)throw e.err;const n=e.yields;e.inflight=n.length,e.yields=[];for(let r=0;r<n.length;r++)if("function"!=typeof n[r]){if(!e.protocolFilterFn||e.protocolFilterFn(n[r])){e.processed++;const s=Date.now();yield n[r],e.time=Date.now()-s,e.dispatchedFn&&n[r]&&e.dispatchedFn(n[r])}else e.pendingFiltered--;e.inflight--}else{const s=n[r];try{s()}catch(o){throw o}if(e.err)throw e.err}if(e.done)break;0===e.yields.length&&(n.length=0,e.yields=n,e.signal=an())}}finally{e.stop()}})()}stop(e){this.done||(this.err=e,this.done=!0,this.signal.resolve(),this.iterClosed.resolve())}getProcessed(){return this.noIterator?this.received:this.processed}getPending(){return this.yields.length+this.inflight-this.pendingFiltered}getReceived(){return this.received-this.filtered}}function W1(t){let r=!0;const i=new Array(t.length);for(let s=0;s<t.length;s++){let o=t.charCodeAt(s);if(58===o||o<33||o>126)throw new We(`'${t[s]}' is not a valid character for a header key`,Re.BadHeader);r&&97<=o&&o<=122?o-=32:!r&&65<=o&&o<=90&&(o+=32),i[s]=o,r=45==o}return String.fromCharCode(...i)}function ls(t=0,e=""){if(0===t&&""!==e||t>0&&""===e)throw new Error("setting status requires both code and description");return new Us(t,e)}const Pg="NATS/1.0";var jr=(()=>{return(t=jr||(jr={}))[t.Exact=0]="Exact",t[t.CanonicalMIME=1]="CanonicalMIME",t[t.IgnoreCase=2]="IgnoreCase",jr;var t})();class Us{constructor(e=0,n=""){R(this,"_code"),R(this,"headers"),R(this,"_description"),this._code=e,this._description=n,this.headers=new Map}[Symbol.iterator](){return this.headers.entries()}size(){return this.headers.size}equals(e){if(e&&this.headers.size===e.headers.size&&this._code===e._code){for(const[n,r]of this.headers){const i=e.values(n);if(r.length!==i.length)return!1;const s=[...r].sort(),o=[...i].sort();for(let a=0;a<s.length;a++)if(s[a]!==o[a])return!1}return!0}return!1}static decode(e){const n=new Us,i=Si.decode(e).split("\r\n"),s=i[0];if(s!==Pg){let o=s.replace(Pg,"");n._code=parseInt(o,10);const a=n._code.toString();o=o.replace(a,""),n._description=o.trim()}return i.length>=1&&i.slice(1).map(o=>{if(o){const a=o.indexOf(":");if(a>-1){const l=o.slice(0,a),f=o.slice(a+1).trim();n.append(l,f)}}}),n}toString(){if(0===this.headers.size&&0===this._code)return"";let e=Pg;this._code>0&&""!==this._description&&(e+=` ${this._code} ${this._description}`);for(const[n,r]of this.headers)for(let i=0;i<r.length;i++)e=`${e}\r\n${n}: ${r[i]}`;return`${e}\r\n\r\n`}encode(){return js.encode(this.toString())}static validHeaderValue(e){if(/[\r\n]/.test(e))throw new We("invalid header value - \\r and \\n are not allowed.",Re.BadHeader);return e.trim()}keys(){const e=[];for(const n of this.headers.keys())e.push(n);return e}findKeys(e,n=jr.Exact){const r=this.keys();switch(n){case jr.Exact:return r.filter(i=>i===e);case jr.CanonicalMIME:return e=W1(e),r.filter(i=>i===e);default:{const i=e.toLowerCase();return r.filter(s=>i===s.toLowerCase())}}}get(e,n=jr.Exact){const r=this.findKeys(e,n);if(r.length){const i=this.headers.get(r[0]);if(i)return Array.isArray(i)?i[0]:i}return""}has(e,n=jr.Exact){return this.findKeys(e,n).length>0}set(e,n,r=jr.Exact){this.delete(e,r),this.append(e,n,r)}append(e,n,r=jr.Exact){const i=W1(e);r===jr.CanonicalMIME&&(e=i);const s=this.findKeys(e,r);e=s.length>0?s[0]:e;const o=Us.validHeaderValue(n);let a=this.headers.get(e);a||(a=[],this.headers.set(e,a)),a.push(o)}values(e,n=jr.Exact){const r=[];return this.findKeys(e,n).forEach(s=>{const o=this.headers.get(s);o&&r.push(...o)}),r}delete(e,n=jr.Exact){this.findKeys(e,n).forEach(i=>{this.headers.delete(i)})}get hasError(){return this._code>=300}get status(){return`${this._code} ${this._description}`.trim()}toRecord(){const e={};return this.keys().forEach(n=>{e[n]=this.values(n)}),e}get code(){return this._code}get description(){return this._description}static fromRecord(e){const n=new Us;for(const r in e)n.headers.set(r,e[r]);return n}}function J1(){return{encode:t=>js.encode(t),decode:t=>Si.decode(t)}}function Gi(t){return{encode(e){try{return void 0===e&&(e=null),js.encode(JSON.stringify(e))}catch(n){throw We.errorForCode(Re.BadJson,n)}},decode(e){try{return JSON.parse(Si.decode(e),t)}catch(n){throw We.errorForCode(Re.BadJson,n)}}}}const Y1="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";const nc=new class DO{constructor(){R(this,"buf"),R(this,"seq"),R(this,"inc"),this.buf=new Uint8Array(22),this.init()}init(){this.setPre(),this.initSeqAndInc(),this.fillSeq()}initSeqAndInc(){this.seq=Math.floor(0xcfd41b9100000*Math.random()),this.inc=Math.floor(300*Math.random()+33)}setPre(){const e=new Uint8Array(12);!function CO(t){var e;(null==(e=null==globalThis?void 0:globalThis.crypto)?void 0:e.getRandomValues)?globalThis.crypto.getRandomValues(t):function xO(t){for(let e=0;e<t.length;e++)t[e]=Math.floor(255*Math.random())}(t)}(e);for(let n=0;n<12;n++)this.buf[n]=Y1.charCodeAt(e[n]%36)}fillSeq(){let e=this.seq;for(let n=21;n>=12;n--)this.buf[n]=Y1.charCodeAt(e%36),e=Math.floor(e/36)}next(){return this.seq+=this.inc,this.seq>0xcfd41b9100000&&(this.setPre(),this.initSeqAndInc()),this.fillSeq(),String.fromCharCode.apply(String,this.buf)}reset(){this.init()}};function eS(t){var e;return t&&0===t.data.length&&503===(null==(e=t.headers)?void 0:e.code)?We.errorForCode(Re.NoResponders):null}class tS{constructor(e,n,r){R(this,"_headers"),R(this,"_msg"),R(this,"_rdata"),R(this,"_reply"),R(this,"_subject"),R(this,"publisher"),this._msg=e,this._rdata=n,this.publisher=r}get subject(){return this._subject||(this._subject=Si.decode(this._msg.subject)),this._subject}get reply(){return this._reply||(this._reply=Si.decode(this._msg.reply)),this._reply}get sid(){return this._msg.sid}get headers(){if(this._msg.hdr>-1&&!this._headers){const e=this._rdata.subarray(0,this._msg.hdr);this._headers=Us.decode(e)}return this._headers}get data(){return this._rdata?this._msg.hdr>-1?this._rdata.subarray(this._msg.hdr):this._rdata:new Uint8Array(0)}respond(e=ir,n){return!!this.reply&&(this.publisher.publish(this.reply,e,n),!0)}size(){var i;return this._msg.subject.length+((null==(i=this._msg.reply)?void 0:i.length)||0)+(-1===this._msg.size?0:this._msg.size)}}function Pa(t){return nS("durable",t)}function Dr(t){return nS("stream",t)}function nS(t,e=""){if(""===e)throw Error(`${t} name required`);return[".","*",">","/","\\"].forEach(r=>{if(-1!==e.indexOf(r))throw Error(`invalid ${t} name - ${t} name cannot contain '${r}'`)}),""}function wd(t,e=""){if(""===e)throw Error(`${t} name required`);const n=rS(e);if(n.length)throw new Error(`invalid ${t} name - ${t} name ${n}`)}function rS(t=""){if(""===t)throw Error("name required");const e=/^[-\w]+$/g;if(null===t.match(e))for(const r of t.split(""))if(null===r.match(e))return`cannot contain '${r}'`;return""}function jn(t){return 1e6*t}function kg(t){return Math.floor(t/1e6)}function Mg(t){if(t.data.length>0)return!1;const e=t.headers;return!!e&&e.code>=100&&e.code<200}function iS(t){var e;return Mg(t)&&"Idle Heartbeat"===(null==(e=t.headers)?void 0:e.description)}function ka(t){if(0!==t.data.length)return null;const e=t.headers;return e?sS(e.code,e.description):null}var Br=(()=>{return(t=Br||(Br={})).MaxBatchExceeded="exceeded maxrequestbatch of",t.MaxExpiresExceeded="exceeded maxrequestexpires of",t.MaxBytesExceeded="exceeded maxrequestmaxbytes of",t.MaxMessageSizeExceeded="message size exceeds maxbytes",t.PushConsumer="consumer is push based",t.MaxWaitingExceeded="exceeded maxwaiting",t.IdleHeartbeatMissed="`idle heartbeats missed`",Br;var t})();function sS(t,e=""){if(t<300)return null;switch(e=e.toLowerCase(),t){case 404:return new We(e,Re.JetStream404NoMessages);case 408:return new We(e,Re.JetStream408RequestTimeout);case 409:{const n=e.startsWith(Br.IdleHeartbeatMissed)?Re.JetStreamIdleHeartBeat:Re.JetStream409;return new We(e,n)}case 503:return We.errorForCode(Re.JetStreamNotEnabled,new Error(e));default:return""===e&&(e=Re.Unknown),new We(e,`${t}`)}}function go(t=""){const e=t.match(/(\d+).(\d+).(\d+)/);if(e)return{major:parseInt(e[1]),minor:parseInt(e[2]),micro:parseInt(e[3])};throw new Error(`'${t}' is not a semver value`)}function Rg(t,e){return t.major<e.major?-1:t.major>e.major?1:t.minor<e.minor?-1:t.minor>e.minor?1:t.micro<e.micro?-1:t.micro>e.micro?1:0}var Ar=(()=>{return(t=Ar||(Ar={})).JS_KV="js_kv",t.JS_OBJECTSTORE="js_objectstore",t.JS_PULL_MAX_BYTES="js_pull_max_bytes",t.JS_NEW_CONSUMER_CREATE_API="js_new_consumer_create",t.JS_ALLOW_DIRECT="js_allow_direct",Ar;var t})();class PO{constructor(e){R(this,"server"),R(this,"features"),R(this,"disabled"),this.features=new Map,this.disabled=[],this.update(e)}resetDisabled(){this.disabled.length=0,this.update(this.server)}disable(e){this.disabled.push(e),this.update(this.server)}isDisabled(e){return-1!==this.disabled.indexOf(e)}update(e){"string"==typeof e&&(e=go(e)),this.server=e,this.set(Ar.JS_KV,"2.6.2"),this.set(Ar.JS_OBJECTSTORE,"2.6.3"),this.set(Ar.JS_PULL_MAX_BYTES,"2.8.3"),this.set(Ar.JS_NEW_CONSUMER_CREATE_API,"2.9.0"),this.set(Ar.JS_ALLOW_DIRECT,"2.9.0"),this.disabled.forEach(n=>{this.features.delete(n)})}set(e,n){this.features.set(e,{min:n,ok:Rg(this.server,go(n))>=0})}get(e){return this.features.get(e)||{min:"unknown",ok:!1}}supports(e){var n;return(null==(n=this.get(e))?void 0:n.ok)||!1}require(e){return"string"==typeof e&&(e=go(e)),Rg(this.server,e)>=0}}const Sd="Nats-Service-Error",Ed="Nats-Service-Error-Code";var Ei=(()=>{return(t=Ei||(Ei={})).PING="PING",t.STATS="STATS",t.INFO="INFO",t.SCHEMA="SCHEMA",Ei;var t})(),mo=(()=>{return(t=mo||(mo={})).STATS="io.nats.micro.v1.stats_response",t.INFO="io.nats.micro.v1.info_response",t.PING="io.nats.micro.v1.ping_response",t.SCHEMA="io.nats.micro.v1.schema_response",mo;var t})();class oS{constructor(e){R(this,"msg"),this.msg=e}get data(){return this.msg.data}get sid(){return this.msg.sid}get subject(){return this.msg.subject}respond(e,n){return this.msg.respond(e,n)}respondError(e,n,r,i){var s,o;return(i=i||{}).headers=i.headers||ls(),null==(s=i.headers)||s.set(Ed,`${e}`),null==(o=i.headers)||o.set(Sd,n),this.msg.respond(r,i)}}class rc{constructor(e,n=""){R(this,"subject"),R(this,"srv"),""!==n&&function RO(t,e){if(-1!==e.indexOf(" "))throw new Error(`${t} cannot contain spaces: '${e}'`);e.split(".").forEach(r=>{if(">"===r)throw new Error(`${t} name cannot contain internal '>': '${e}'`)})}("service group",n);let r="";if(e instanceof ic)this.srv=e,r="";else{if(!(e instanceof rc))throw new Error("unknown ServiceGroup type");{const i=e;this.srv=i.srv,r=i.subject}}this.subject=this.calcSubject(r,n)}calcSubject(e,n=""){return""===n?e:""!==e?`${e}.${n}`:n}addEndpoint(e="",n){const r="function"==typeof(n=n||{subject:e})?{handler:n,subject:e}:n;wd("endpoint",e);let{subject:i,handler:s,schema:o}=r;return i=i||e,function MO(t,e){if(""===e)throw new Error(`${t} cannot be empty`);if(-1!==e.indexOf(" "))throw new Error(`${t} cannot contain spaces: '${e}'`);const n=e.split(".");n.forEach((r,i)=>{if(">"===r&&i!==n.length-1)throw new Error(`${t} cannot have internal '>': '${e}'`)})}("endpoint subject",i),i=this.calcSubject(this.subject,i),this.srv._addEndpoint({name:e,subject:i,handler:s,schema:o})}addGroup(e=""){return new rc(this,e)}}class xd extends Error{constructor(e,n){super(n),R(this,"code"),this.code=e}static isServiceError(e){return null!==xd.toServiceError(e)}static toServiceError(e){var r,i;const n=(null==(r=null==e?void 0:e.headers)?void 0:r.get(Ed))||"";if(""!==n){const s=parseInt(n)||400,o=(null==(i=null==e?void 0:e.headers)?void 0:i.get(Sd))||"";return new xd(s,o.length?o:n)}return null}}class ic extends Cr{constructor(e,n={name:"",version:""}){var r,i,s;super(),R(this,"nc"),R(this,"_id"),R(this,"config"),R(this,"handlers"),R(this,"internal"),R(this,"_stopped"),R(this,"_done"),R(this,"_schema"),R(this,"started"),this.nc=e,this.config=n,wd("name",this.config.name),go(this.config.version),this._id=nc.next(),this.internal=[],this._done=an(),this._stopped=!1,this.handlers=[],this.noIterator=!0,this.started=(new Date).toISOString(),this.reset(),this.config.endpoint&&this._addEndpoint({name:"default",subject:null==(r=this.config.endpoint)?void 0:r.subject,handler:null==(i=this.config.endpoint)?void 0:i.handler,schema:null==(s=this.config.endpoint)?void 0:s.schema},!0),this.nc.closed().then(()=>{this.close().catch()}).catch(o=>{this.close(o).catch()})}static controlSubject(e,n="",r="",i){const s=null!=i?i:"$SRV";return""===n&&""===r?`${s}.${e}`:(wd("control subject name",n),""!==r?(wd("control subject id",r),`${s}.${e}.${n}.${r}`):`${s}.${e}.${n}`)}get subjects(){return this.handlers.filter(e=>!1===e.internal).map(e=>e.subject)}get id(){return this._id}get name(){return this.config.name}get description(){var e;return null!=(e=this.config.description)?e:""}get version(){return this.config.version}errorToHeader(e){const n=ls();if(e instanceof xd){const r=e;n.set(Sd,r.message),n.set(Ed,`${r.code}`)}else n.set(Sd,e.message),n.set(Ed,"500");return n}setupHandler(e,n=!1){const r=n?"":"q",{name:i,subject:s,handler:o,schema:a}=e,l=e;l.internal=n,n&&this.internal.push(l),l.stats=new OO(i,s),l.schema=a;const f=o?(p,m)=>{if(p)return void this.close(p);const E=Date.now();try{o(p,new oS(m))}catch(x){l.stats.countError(x),null==m||m.respond(ir,{headers:this.errorToHeader(x)})}finally{l.stats.countLatency(E)}}:void 0;return l.sub=this.nc.subscribe(s,{callback:f,queue:r}),l.sub.closed.then(()=>{this._stopped||this.close(new Error(`required subscription ${e.subject} stopped`)).catch()}).catch(p=>{if(!this._stopped){const m=new Error(`required subscription ${e.subject} errored: ${p.message}`);m.stack=p.stack,this.close(m).catch()}}),l}info(){return{type:mo.INFO,name:this.name,id:this.id,version:this.version,description:this.description,subjects:this.subjects}}stats(){var e=this;return Oe(function*(){const n=[];for(const r of e.handlers){if("function"==typeof e.config.statsHandler)try{r.stats.data=yield e.config.statsHandler(r)}catch(i){r.stats.countError(i)}n.push(r.stats.stats(r.qi))}return{type:mo.STATS,name:e.name,id:e.id,version:e.version,started:e.started,endpoints:n}})()}addInternalHandler(e,n){const r=`${e}`.toUpperCase();this._doAddInternalHandler(`${r}-all`,e,n),this._doAddInternalHandler(`${r}-kind`,e,n,this.name),this._doAddInternalHandler(`${r}`,e,n,this.name,this.id)}_doAddInternalHandler(e,n,r,i="",s=""){const o={};o.name=e,o.subject=ic.controlSubject(n,i,s),o.handler=r,this.setupHandler(o,!0)}start(){const e=Gi(),i=e.encode({type:mo.PING,name:this.name,id:this.id,version:this.version});return this.addInternalHandler(Ei.PING,(a,l)=>a?(this.close(a).then().catch(),Promise.reject(a)):(l.respond(i),Promise.resolve())),this.addInternalHandler(Ei.STATS,(a,l)=>a?(this.close(a),Promise.reject(a)):this.stats().then(f=>(null==l||l.respond(e.encode(f)),Promise.resolve()))),this.addInternalHandler(Ei.INFO,(a,l)=>a?(this.close(a),Promise.reject(a)):(null==l||l.respond(e.encode(this.info())),Promise.resolve())),this.addInternalHandler(Ei.SCHEMA,(a,l)=>a?(this.close(a),Promise.reject(a)):(null==l||l.respond(Gi().encode(this.schema())),Promise.resolve())),this.handlers.forEach(a=>{const{subject:l}=a;"string"==typeof l&&null!==a.handler&&this.setupHandler(a)}),Promise.resolve(this)}close(e){if(this._stopped)return this._done;this._stopped=!0;let n=[];return this.nc.isClosed()||(n=this.handlers.concat(this.internal).map(r=>r.sub.drain())),Promise.allSettled(n).then(()=>{this._done.resolve(e||null)}),this._done}get stopped(){return this._done}get isStopped(){return this._stopped}stop(e){return this.close(e)}schema(){const e={type:mo.SCHEMA,name:this.name,id:this.id,version:this.version,api_url:this.config.apiURL,endpoints:[]};return e.endpoints=this.handlers.map(n=>{const{schema:r,subject:i,name:s}=n;return{schema:r,subject:i,name:s}}),e}reset(){if(this.started=(new Date).toISOString(),this.handlers)for(const e of this.handlers)e.stats.reset(e.qi)}addGroup(e){return new rc(this,e)}addEndpoint(e,n){return new rc(this).addEndpoint(e,n)}_addEndpoint(e,n=!1){const r=n?this:new Cr;r.noIterator="function"==typeof e.handler,r.noIterator||(e.handler=(s,o)=>{s?this.stop(s).catch():r.push(new oS(o))},r.iterClosed.then(()=>{this.close().catch()}));const i=this.setupHandler(e,!1);return i.qi=r,this.handlers.push(i),r}}class OO{constructor(e,n){R(this,"name"),R(this,"subject"),R(this,"average_processing_time"),R(this,"num_requests"),R(this,"processing_time"),R(this,"num_errors"),R(this,"last_error"),R(this,"data"),this.name=e,this.subject=n,this.average_processing_time=0,this.num_errors=0,this.num_requests=0,this.processing_time=0}reset(e){this.num_requests=0,this.processing_time=0,this.average_processing_time=0,this.num_errors=0,this.last_error=void 0,this.data=void 0;const n=e;n&&(n.time=0,n.processed=0)}countLatency(e){this.num_requests++,this.processing_time+=jn(Date.now()-e),this.average_processing_time=Math.round(this.processing_time/this.num_requests)}countError(e){this.num_errors++,this.last_error=e.message}_stats(){const{name:e,subject:n,average_processing_time:r,num_errors:i,num_requests:s,processing_time:o,last_error:a,data:l}=this;return{name:e,subject:n,average_processing_time:r,num_errors:i,num_requests:s,processing_time:o,last_error:a,data:l}}stats(e){const n=e;return!1===(null==n?void 0:n.noIterator)&&(this.processing_time=n.time,this.num_requests=n.processed,this.average_processing_time=this.processing_time>0&&this.num_requests>0?this.processing_time/this.num_requests:0),this._stats()}}class sc{constructor(e,n){R(this,"nc"),R(this,"opts"),R(this,"prefix"),R(this,"timeout"),R(this,"jc"),this.nc=e,this.opts=function LO(t){return(t=t||{}).domain&&(t.apiPrefix=`$JS.${t.domain}.API`,delete t.domain),vd({apiPrefix:"$JS.API",timeout:5e3},t)}(n),this._parseOpts(),this.prefix=this.opts.apiPrefix,this.timeout=this.opts.timeout,this.jc=Gi()}_parseOpts(){let e=this.opts.apiPrefix;if(!e||0===e.length)throw new Error("invalid empty prefix");"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),this.opts.apiPrefix=e}_request(e,n=null,r){var i=this;return Oe(function*(){(r=r||{}).timeout=i.timeout;let s=ir;n&&(s=i.jc.encode(n));const o=yield i.nc.request(e,s,r);return i.parseJsResponse(o)})()}findStream(e){var n=this;return Oe(function*(){const r={subject:e},s=yield n._request(`${n.prefix}.STREAM.NAMES`,r);if(!s.streams||1!==s.streams.length)throw new Error("no stream matches subject");return s.streams[0]})()}parseJsResponse(e){const n=this.jc.decode(e.data),r=n;if(r.error){const i=sS(r.error.code,r.error.description);if(null!==i)throw i.api_error=r.error,i}return n}}class oc{constructor(e,n,r,i){if(R(this,"err"),R(this,"offset"),R(this,"pageInfo"),R(this,"subject"),R(this,"jsm"),R(this,"filter"),R(this,"payload"),!e)throw new Error("subject is required");this.subject=e,this.jsm=r,this.offset=0,this.pageInfo={},this.filter=n,this.payload=i||{}}next(){var e=this;return Oe(function*(){if(e.err)return[];if(e.pageInfo&&e.offset>=e.pageInfo.total)return[];const n={offset:e.offset};e.payload&&Object.assign(n,e.payload);try{const r=yield e.jsm._request(e.subject,n,{timeout:e.jsm.timeout});return e.pageInfo=r,e.offset+=e.countResponse(r),e.filter(r)}catch(r){throw e.err=r,r}})()}countResponse(e){var n;switch(null==e?void 0:e.type){case"io.nats.jetstream.api.v1.stream_names_response":case"io.nats.jetstream.api.v1.stream_list_response":return e.streams.length;case"io.nats.jetstream.api.v1.consumer_list_response":return e.consumers.length;default:return console.error(`jslister.ts: unknown API response for paged output: ${null==e?void 0:e.type}`),(null==(n=e.streams)?void 0:n.length)||0}return 0}[Symbol.asyncIterator](){var e=this;return Fg(function*(){let n=yield pd(e.next());for(;n.length>0;){for(const r of n)yield r;n=yield pd(e.next())}})()}}class aS extends sc{constructor(e,n){super(e,n)}add(e,n){var r=this;return Oe(function*(){var E,x,j;if(Dr(e),n.deliver_group&&n.flow_control)throw new Error("jetstream flow control is not supported with queue groups");if(n.deliver_group&&n.idle_heartbeat)throw new Error("jetstream idle heartbeat is not supported with queue groups");const i={};i.config=n,i.stream_name=e,i.config.durable_name&&Pa(i.config.durable_name);const s=r.nc,{min:o,ok:a}=s.features.get(Ar.JS_NEW_CONSUMER_CREATE_API),l=""===n.name?void 0:n.name;if(l&&!a)throw new Error(`consumer 'name' requires server ${o}`);if(l){const de=rS(l);if(de.length)throw new Error(`consumer 'name' ${de}`)}let f,p="";if(a&&(p=null!=(x=null!=(E=n.name)?E:n.durable_name)?x:""),""!==p){let de=null!=(j=n.filter_subject)?j:void 0;">"===de&&(de=void 0),f=void 0!==de?`${r.prefix}.CONSUMER.CREATE.${e}.${p}.${de}`:`${r.prefix}.CONSUMER.CREATE.${e}.${p}`}else f=n.durable_name?`${r.prefix}.CONSUMER.DURABLE.CREATE.${e}.${n.durable_name}`:`${r.prefix}.CONSUMER.CREATE.${e}`;return yield r._request(f,i)})()}update(e,n,r){var i=this;return Oe(function*(){const s=yield i.info(e,n);return i.add(e,Object.assign(s.config,r))})()}info(e,n){var r=this;return Oe(function*(){return Dr(e),Pa(n),yield r._request(`${r.prefix}.CONSUMER.INFO.${e}.${n}`)})()}delete(e,n){var r=this;return Oe(function*(){return Dr(e),Pa(n),(yield r._request(`${r.prefix}.CONSUMER.DELETE.${e}.${n}`)).success})()}list(e){return Dr(e),new oc(`${this.prefix}.CONSUMER.LIST.${e}`,i=>i.consumers,this)}}class uS{constructor(e,n){R(this,"token"),R(this,"received"),R(this,"ctx"),R(this,"requestSubject"),R(this,"mux"),this.mux=e,this.requestSubject=n,this.received=0,this.token=nc.next(),this.ctx=new Error}}class jO extends uS{constructor(e,n,r={maxWait:1e3}){if(super(e,n),R(this,"callback"),R(this,"done"),R(this,"timer"),R(this,"max"),R(this,"opts"),this.opts=r,"function"!=typeof this.opts.callback)throw new Error("callback is required");this.callback=this.opts.callback,this.max="number"==typeof r.maxMessages&&r.maxMessages>0?r.maxMessages:-1,this.done=an(),this.done.then(()=>{this.callback(null,null)}),this.timer=setTimeout(()=>{this.cancel()},r.maxWait)}cancel(e){e&&this.callback(e,null),clearTimeout(this.timer),this.mux.cancel(this),this.done.resolve()}resolver(e,n){e?(e.stack+=`\n\n${this.ctx.stack}`,this.cancel(e)):(this.callback(null,n),this.opts.strategy===wi.Count&&(this.max--,0===this.max&&this.cancel()),this.opts.strategy===wi.JitterTimer&&(clearTimeout(this.timer),this.timer=setTimeout(()=>{this.cancel()},this.opts.jitter||300)),this.opts.strategy===wi.SentinelMsg&&n&&0===n.data.length&&this.cancel())}}class cS extends uS{constructor(e,n,r={timeout:1e3}){super(e,n),R(this,"deferred"),R(this,"timer"),this.deferred=an(),this.timer=bd(r.timeout)}resolver(e,n){this.timer&&this.timer.cancel(),e?(e.stack+=`\n\n${this.ctx.stack}`,this.deferred.reject(e)):this.deferred.resolve(n),this.cancel()}cancel(e){this.timer&&this.timer.cancel(),this.mux.cancel(this),this.deferred.reject(e||We.errorForCode(Re.Cancelled))}}const lS=Uint8Array.of(43,65,67,75),BO=Uint8Array.of(45,78,65,75),ac=Uint8Array.of(43,87,80,73),UO=Uint8Array.of(43,78,88,84),HO=Uint8Array.of(43,84,69,82,77),VO=Uint8Array.of(32);function Cd(t){return new qO(t)}class qO{constructor(e){R(this,"msg"),R(this,"di"),R(this,"didAck"),this.msg=e,this.didAck=!1}get subject(){return this.msg.subject}get sid(){return this.msg.sid}get data(){return this.msg.data}get headers(){return this.msg.headers}get info(){return this.di||(this.di=function $O(t){const e=t.split(".");if(9===e.length&&e.splice(2,0,"_",""),e.length<11||"$JS"!==e[0]||"ACK"!==e[1])throw new Error("not js message");const n={};return n.domain="_"===e[2]?"":e[2],n.account_hash=e[3],n.stream=e[4],n.consumer=e[5],n.redeliveryCount=parseInt(e[6],10),n.redelivered=n.redeliveryCount>1,n.streamSequence=parseInt(e[7],10),n.deliverySequence=parseInt(e[8],10),n.timestampNanos=parseInt(e[9],10),n.pending=parseInt(e[10],10),n}(this.reply)),this.di}get redelivered(){return this.info.redeliveryCount>1}get reply(){return this.msg.reply||""}get seq(){return this.info.streamSequence}doAck(e){this.didAck||(this.didAck=!this.isWIP(e),this.msg.respond(e))}isWIP(e){return 4===e.length&&e[0]===ac[0]&&e[1]===ac[1]&&e[2]===ac[2]&&e[3]===ac[3]}ackAck(){var e=this;return Oe(function*(){if(!e.didAck&&(e.didAck=!0,e.msg.reply)){const r=e.msg.publisher,i=new cS(r.muxSubscriptions,e.msg.reply);r.request(i);try{r.publish(e.msg.reply,lS,{reply:`${r.muxSubscriptions.baseInbox}${i.token}`})}catch(s){i.cancel(s)}try{return yield Promise.race([i.timer,i.deferred]),!0}catch(s){i.cancel(s)}}return!1})()}ack(){this.doAck(lS)}nak(e){let n=BO;e&&(n=J1().encode(`-NAK ${JSON.stringify({delay:jn(e)})}`)),this.doAck(n)}working(){this.doAck(ac)}next(e,n={batch:1}){const r={};r.batch=n.batch||1,r.no_wait=n.no_wait||!1,n.expires&&n.expires>0&&(r.expires=jn(n.expires));const i=Gi().encode(r),s=tc.concat(UO,VO,i);this.msg.respond(s,e?{reply:e}:void 0)}term(){this.doAck(HO)}}function Ma(t,e,n=!1){if(!0===n&&!t)throw We.errorForCode(Re.ApiError,new Error(`${e} is not a function`));if(t&&"function"!=typeof t)throw We.errorForCode(Re.ApiError,new Error(`${e} is not a function`))}class KO extends Cr{constructor(e,n,r){var i;super(),R(this,"sub"),R(this,"adapter"),R(this,"subIterDone"),i=this,Ma(r.adapter,"adapter",!0),this.adapter=r.adapter,r.callback&&Ma(r.callback,"callback"),this.noIterator="function"==typeof r.callback,r.ingestionFilterFn&&(Ma(r.ingestionFilterFn,"ingestionFilterFn"),this.ingestionFilterFn=r.ingestionFilterFn),r.protocolFilterFn&&(Ma(r.protocolFilterFn,"protocolFilterFn"),this.protocolFilterFn=r.protocolFilterFn),r.dispatchedFn&&(Ma(r.dispatchedFn,"dispatchedFn"),this.dispatchedFn=r.dispatchedFn),r.cleanupFn&&Ma(r.cleanupFn,"cleanupFn");let s=(p,m)=>{this.callback(p,m)};if(r.callback){const p=r.callback;s=(m,E)=>{const[x,j]=this.adapter(m,E);if(x)return void p(x,null);const{ingest:de}=this.ingestionFilterFn?this.ingestionFilterFn(j,this):{ingest:!0};de&&(!this.protocolFilterFn||this.protocolFilterFn(j))&&(p(x,j),this.dispatchedFn&&j&&this.dispatchedFn(j))}}const{max:o,queue:a,timeout:l}=r,f={queue:a,timeout:l,callback:s};var p;o&&o>0&&(f.max=o),this.sub=e.subscribe(n,f),r.cleanupFn&&(this.sub.cleanupFn=r.cleanupFn),this.noIterator||this.iterClosed.then(()=>{this.unsubscribe()}),this.subIterDone=an(),Promise.all([this.sub.closed,this.iterClosed]).then(()=>{this.subIterDone.resolve()}).catch(()=>{this.subIterDone.resolve()}),(p=Oe(function*(m){yield m.closed,i.stop()}),function(m){return p.apply(this,arguments)})(this.sub).then().catch()}unsubscribe(e){this.sub.unsubscribe(e)}drain(){return this.sub.drain()}isDraining(){return this.sub.isDraining()}isClosed(){return this.sub.isClosed()}callback(e,n){this.sub.cancelTimeout();const[r,i]=this.adapter(e,n);r&&this.stop(r),i&&this.push(i)}getSubject(){return this.sub.getSubject()}getReceived(){return this.sub.getReceived()}getProcessed(){return this.sub.getProcessed()}getPending(){return this.sub.getPending()}getID(){return this.sub.getID()}getMax(){return this.sub.getMax()}get closed(){return this.sub.closed}}let Ur;function dS(){return void 0!==Ur&&void 0!==Ur.defaultPort?Ur.defaultPort:4222}function Og(){return void 0!==Ur&&Ur.urlParseFn?Ur.urlParseFn:void 0}function fS(){return void 0!==Ur&&Ur.dnsResolveFn?Ur.dnsResolveFn:void 0}function Ng(t){return void 0!==function ZO(t){for(let e=0;e<t.length;e++)switch(t[e]){case".":return pS(t);case":":return XO(t)}}(t)}function pS(t){const e=new Uint8Array(4);for(let n=0;n<4;n++){if(0===t.length)return;if(n>0){if("."!==t[0])return;t=t.substring(1)}const{n:r,c:i,ok:s}=eN(t);if(!s||r>255)return;t=t.substring(i),e[n]=r}return function QO(t,e,n,r){const i=new Uint8Array(16);return[0,0,0,0,0,0,0,0,0,0,255,255].forEach((o,a)=>{i[a]=o}),i[12]=t,i[13]=e,i[14]=n,i[15]=r,i}(e[0],e[1],e[2],e[3])}function XO(t){const e=new Uint8Array(16);let n=-1;if(t.length>=2&&":"===t[0]&&":"===t[1]&&(n=0,0===(t=t.substring(2)).length))return e;let r=0;for(;r<16;){const{n:i,c:s,ok:o}=tN(t);if(!o||i>65535)return;if(s<t.length&&"."===t[s]){if(n<0&&12!=r||r+4>16)return;const a=pS(t);if(void 0===a)return;e[r]=a[12],e[r+1]=a[13],e[r+2]=a[14],e[r+3]=a[15],t="",r+=4;break}if(e[r]=i>>8,e[r+1]=i,r+=2,0===(t=t.substring(s)).length)break;if(":"!==t[0]||1==t.length)return;if(":"===(t=t.substring(1))[0]){if(n>=0)return;if(n=r,0===(t=t.substring(1)).length)break}}if(0===t.length){if(r<16){if(n<0)return;const i=16-r;for(let s=r-1;s>=n;s--)e[s+i]=e[s];for(let s=n+i-1;s>=n;s--)e[s]=0}else if(n>=0)return;return e}}function eN(t){let e=0,n=0;for(e=0;e<t.length&&48<=t.charCodeAt(e)&&t.charCodeAt(e)<=57;e++)if(n=10*n+(t.charCodeAt(e)-48),n>=16777215)return{n:16777215,c:e,ok:!1};return 0===e?{n:0,c:0,ok:!1}:{n,c:e,ok:!0}}function tN(t){let e=0,n=0;for(n=0;n<t.length;n++){if(48<=t.charCodeAt(n)&&t.charCodeAt(n)<=57)e*=16,e+=t.charCodeAt(n)-48;else if(97<=t.charCodeAt(n)&&t.charCodeAt(n)<=102)e*=16,e+=t.charCodeAt(n)-97+10;else{if(!(65<=t.charCodeAt(n)&&t.charCodeAt(n)<=70))break;e*=16,e+=t.charCodeAt(n)-65+10}if(e>=16777215)return{n:0,c:n,ok:!1}}return 0===n?{n:0,c:n,ok:!1}:{n:e,c:n,ok:!0}}function Lg(t){return!function nN(t){return-1!==t.indexOf(".")||-1===t.indexOf("[")&&-1===t.indexOf("::")&&t.split(":").length<=2}(t)}class uc{constructor(e,n=!1){R(this,"src"),R(this,"listen"),R(this,"hostname"),R(this,"port"),R(this,"didConnect"),R(this,"reconnects"),R(this,"lastConnect"),R(this,"gossiped"),R(this,"tlsName"),R(this,"resolves"),this.src=e,this.tlsName="";const r=function rN(t){(t=t.trim()).match(/^(.*:\/\/)(.*)/m)&&(t=t.replace(/^(.*:\/\/)(.*)/gm,"$2")),Lg(t)&&-1===t.indexOf("[")&&(t=`[${t}]`);const e=Lg(t)?t.match(/(]:)(\d+)/):t.match(/(:)(\d+)/),n=e&&3===e.length&&e[1]&&e[2]?parseInt(e[2]):4222,i=new URL(`${80===n?"https":"http"}://${t}`);i.port=`${n}`;let s=i.hostname;return"["===s.charAt(0)&&(s=s.substring(1,s.length-1)),{listen:i.host,hostname:s,port:n}}(e);this.listen=r.listen,this.hostname=r.hostname,this.port=r.port,this.didConnect=!1,this.reconnects=0,this.lastConnect=0,this.gossiped=n}toString(){return this.listen}resolve(e){var n=this;return Oe(function*(){if(!e.fn)return[n];const r=[];if(Ng(n.hostname))return[n];{const i=yield e.fn(n.hostname);e.debug&&console.log(`resolve ${n.hostname} = ${i.join(",")}`);for(const s of i){const a=new URL(`${80===n.port?"https":"http"}://${Lg(s)?"["+s+"]":s}`);a.port=`${n.port}`;const l=new uc(a.host,!1);l.tlsName=n.hostname,r.push(l)}}return e.randomize&&z1(r),n.resolves=r,r})()}}class iN{constructor(e=[],n={}){R(this,"firstSelect"),R(this,"servers"),R(this,"currentServer"),R(this,"tlsName"),R(this,"randomize"),this.firstSelect=!0,this.servers=[],this.tlsName="",this.randomize=n.randomize||!1;const r=Og();e&&(e.forEach(i=>{i=r?r(i):i,this.servers.push(new uc(i))}),this.randomize&&(this.servers=z1(this.servers))),0===this.servers.length&&this.addServer(`${Ig}:${dS()}`,!1),this.currentServer=this.servers[0]}clear(){this.servers.length=0}updateTLSName(){const e=this.getCurrentServer();Ng(e.hostname)||(this.tlsName=e.hostname,this.servers.forEach(n=>{n.gossiped&&(n.tlsName=this.tlsName)}))}getCurrentServer(){return this.currentServer}addServer(e,n=!1){const r=Og();e=r?r(e):e;const i=new uc(e,n);Ng(i.hostname)&&(i.tlsName=this.tlsName),this.servers.push(i)}selectServer(){if(this.firstSelect)return this.firstSelect=!1,this.currentServer;const e=this.servers.shift();return e&&(this.servers.push(e),this.currentServer=e),e}removeCurrentServer(){this.removeServer(this.currentServer)}removeServer(e){if(e){const n=this.servers.indexOf(e);this.servers.splice(n,1)}}length(){return this.servers.length}next(){return this.servers.length?this.servers[0]:void 0}getServers(){return this.servers}update(e){const n=[];let r=[];const i=Og(),s=new Map;e.connect_urls&&e.connect_urls.length>0&&e.connect_urls.forEach(a=>{a=i?i(a):a;const l=new uc(a,!0);s.set(a,l)});const o=[];return this.servers.forEach((a,l)=>{const f=a.listen;a.gossiped&&this.currentServer.listen!==f&&void 0===s.get(f)&&o.push(l),s.delete(f)}),o.reverse(),o.forEach(a=>{const l=this.servers.splice(a,1);r=r.concat(l[0].listen)}),s.forEach((a,l)=>{this.servers.push(a),n.push(l)}),{added:n,deleted:r}}}class gS extends Cr{constructor(e,n,r={}){super(),R(this,"sid"),R(this,"queue"),R(this,"draining"),R(this,"max"),R(this,"subject"),R(this,"drained"),R(this,"protocol"),R(this,"timer"),R(this,"info"),R(this,"cleanupFn"),R(this,"closed"),R(this,"requestSubject"),vd(this,r),this.protocol=e,this.subject=n,this.draining=!1,this.noIterator="function"==typeof r.callback,this.closed=an(),r.timeout&&(this.timer=bd(r.timeout),this.timer.then(()=>{this.timer=void 0}).catch(i=>{this.stop(i),this.noIterator&&this.callback(i,{})})),this.noIterator||this.iterClosed.then(()=>{this.closed.resolve(),this.unsubscribe()})}setPrePostHandlers(e){if(this.noIterator){const n=this.callback,r=e.ingestionFilterFn?e.ingestionFilterFn:()=>({ingest:!0,protocol:!1}),i=e.protocolFilterFn?e.protocolFilterFn:()=>!0,s=e.dispatchedFn?e.dispatchedFn:()=>{};this.callback=(o,a)=>{const{ingest:l}=r(a);!l||i(a)&&(n(o,a),s(a))}}else this.protocolFilterFn=e.protocolFilterFn,this.dispatchedFn=e.dispatchedFn}callback(e,n){this.cancelTimeout(),e?this.stop(e):this.push(n)}close(){if(!this.isClosed()){this.cancelTimeout();const e=()=>{if(this.stop(),this.cleanupFn)try{this.cleanupFn(this,this.info)}catch(n){}this.closed.resolve()};this.noIterator?e():this.push(e)}}unsubscribe(e){this.protocol.unsubscribe(this,e)}cancelTimeout(){this.timer&&(this.timer.cancel(),this.timer=void 0)}drain(){return this.protocol.isClosed()?Promise.reject(We.errorForCode(Re.ConnectionClosed)):this.isClosed()?Promise.reject(We.errorForCode(Re.SubClosed)):(this.drained||(this.protocol.unsub(this),this.drained=this.protocol.flush(an()).then(()=>{this.protocol.subscriptions.cancel(this)}).catch(()=>{this.protocol.subscriptions.cancel(this)})),this.drained)}isDraining(){return this.draining}isClosed(){return this.done}getSubject(){return this.subject}getMax(){return this.max}getID(){return this.sid}}class sN{constructor(){R(this,"mux"),R(this,"subs"),R(this,"sidCounter"),this.sidCounter=0,this.mux=null,this.subs=new Map}size(){return this.subs.size}add(e){return this.sidCounter++,e.sid=this.sidCounter,this.subs.set(e.sid,e),e}setMux(e){return this.mux=e,e}getMux(){return this.mux}get(e){return this.subs.get(e)}resub(e){return this.sidCounter++,this.subs.delete(e.sid),e.sid=this.sidCounter,this.subs.set(e.sid,e),e}all(){return Array.from(this.subs.values())}cancel(e){e&&(e.close(),this.subs.delete(e.sid))}handleError(e){if(e&&e.permissionContext){const n=e.permissionContext,r=this.all();let i;if("subscription"===n.operation&&(i=r.find(s=>s.subject===n.subject)),"publish"===n.operation&&(i=r.find(s=>s.requestSubject===n.subject)),i)return i.callback(e,{}),i.close(),this.subs.delete(i.sid),i!==this.mux}return!1}close(){this.subs.forEach(e=>{e.close()})}}class oN{constructor(e,n,r){R(this,"ph"),R(this,"interval"),R(this,"maxOut"),R(this,"timer"),R(this,"pendings"),this.ph=e,this.interval=n,this.maxOut=r,this.pendings=[]}start(){this.cancel(),this._schedule()}cancel(e){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this._reset(),e&&this.ph.disconnect()}_schedule(){this.timer=setTimeout(()=>{if(this.ph.dispatchStatus({type:Ia.PingTimer,data:`${this.pendings.length+1}`}),this.pendings.length===this.maxOut)return void this.cancel(!0);const e=an();this.ph.flush(e).then(()=>{this._reset()}).catch(()=>{this.cancel()}),this.pendings.push(e),this._schedule()},this.interval)}_reset(){this.pendings=this.pendings.filter(e=>(e.resolve(),!1))}}class aN extends Error{constructor(e){super(e),this.name="AssertionError"}}const jg=2**32-2;function Dd(t,e,n=0){const r=e.byteLength-n;return t.byteLength>r&&(t=t.subarray(0,r)),e.set(t,n),t.byteLength}class Bg{constructor(e){R(this,"_buf"),R(this,"_off"),this._off=0,this._buf=null!=e?new Uint8Array(e):new Uint8Array(0)}bytes(e={copy:!0}){return!1===e.copy?this._buf.subarray(this._off):this._buf.slice(this._off)}empty(){return this._buf.byteLength<=this._off}get length(){return this._buf.byteLength-this._off}get capacity(){return this._buf.buffer.byteLength}truncate(e){if(0!==e){if(e<0||e>this.length)throw Error("bytes.Buffer: truncation out of range");this._reslice(this._off+e)}else this.reset()}reset(){this._reslice(0),this._off=0}_tryGrowByReslice(e){const n=this._buf.byteLength;return e<=this.capacity-n?(this._reslice(n+e),n):-1}_reslice(e){(function uN(t,e="Assertion failed."){if(!t)throw new aN(e)})(e<=this._buf.buffer.byteLength),this._buf=new Uint8Array(this._buf.buffer,0,e)}readByte(){const e=new Uint8Array(1);return this.read(e)?e[0]:null}read(e){if(this.empty())return this.reset(),0===e.byteLength?0:null;const n=Dd(this._buf.subarray(this._off),e);return this._off+=n,n}writeByte(e){return this.write(Uint8Array.of(e))}writeString(e){return this.write(js.encode(e))}write(e){const n=this._grow(e.byteLength);return Dd(e,this._buf,n)}_grow(e){const n=this.length;0===n&&0!==this._off&&this.reset();const r=this._tryGrowByReslice(e);if(r>=0)return r;const i=this.capacity;if(e<=Math.floor(i/2)-n)Dd(this._buf.subarray(this._off),this._buf);else{if(i+e>jg)throw new Error("The buffer cannot be grown beyond the maximum size.");{const s=new Uint8Array(Math.min(2*i+e,jg));Dd(this._buf.subarray(this._off),s),this._buf=s}}return this._off=0,this._reslice(Math.min(n+e,jg)),n}grow(e){if(e<0)throw Error("Buffer._grow: negative count");const n=this._grow(e);this._reslice(n)}readFrom(e){let n=0;const r=new Uint8Array(32768);for(;;){const i=this.capacity-this.length<32768,s=i?r:new Uint8Array(this._buf.buffer,this.length),o=e.read(s);if(null===o)return n;i?this.write(s.subarray(0,o)):this._reslice(this.length+o),n+=o}}}var sr=(()=>{return(t=sr||(sr={}))[t.OK=0]="OK",t[t.ERR=1]="ERR",t[t.MSG=2]="MSG",t[t.INFO=3]="INFO",t[t.PING=4]="PING",t[t.PONG=5]="PONG",sr;var t})();class vS{constructor(e){R(this,"dispatcher"),R(this,"state"),R(this,"as"),R(this,"drop"),R(this,"hdr"),R(this,"ma"),R(this,"argBuf"),R(this,"msgBuf"),this.dispatcher=e,this.state=Le.OP_START,this.as=0,this.drop=0,this.hdr=0}parse(e){let n;for(n=0;n<e.length;n++){const r=e[n];switch(this.state){case Le.OP_START:switch(r){case je.M:case je.m:this.state=Le.OP_M,this.hdr=-1,this.ma={sid:-1,hdr:-1,size:-1};break;case je.H:case je.h:this.state=Le.OP_H,this.hdr=0,this.ma={sid:-1,hdr:-1,size:-1};break;case je.P:case je.p:this.state=Le.OP_P;break;case je.PLUS:this.state=Le.OP_PLUS;break;case je.MINUS:this.state=Le.OP_MINUS;break;case je.I:case je.i:this.state=Le.OP_I;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_H:switch(r){case je.M:case je.m:this.state=Le.OP_M;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_M:switch(r){case je.S:case je.s:this.state=Le.OP_MS;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_MS:switch(r){case je.G:case je.g:this.state=Le.OP_MSG;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_MSG:switch(r){case je.SPACE:case je.TAB:this.state=Le.OP_MSG_SPC;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_MSG_SPC:switch(r){case je.SPACE:case je.TAB:continue;default:this.state=Le.MSG_ARG,this.as=n}break;case Le.MSG_ARG:switch(r){case je.CR:this.drop=1;break;case je.NL:{const i=this.argBuf?this.argBuf.bytes():e.subarray(this.as,n-this.drop);this.processMsgArgs(i),this.drop=0,this.as=n+1,this.state=Le.MSG_PAYLOAD,n=this.as+this.ma.size-1;break}default:this.argBuf&&this.argBuf.writeByte(r)}break;case Le.MSG_PAYLOAD:if(this.msgBuf)if(this.msgBuf.length>=this.ma.size){const i=this.msgBuf.bytes({copy:!1});this.dispatcher.push({kind:sr.MSG,msg:this.ma,data:i}),this.argBuf=void 0,this.msgBuf=void 0,this.state=Le.MSG_END}else{let i=this.ma.size-this.msgBuf.length;const s=e.length-n;s<i&&(i=s),i>0?(this.msgBuf.write(e.subarray(n,n+i)),n=n+i-1):this.msgBuf.writeByte(r)}else n-this.as>=this.ma.size&&(this.dispatcher.push({kind:sr.MSG,msg:this.ma,data:e.subarray(this.as,n)}),this.argBuf=void 0,this.msgBuf=void 0,this.state=Le.MSG_END);break;case Le.MSG_END:if(r!==je.NL)continue;this.drop=0,this.as=n+1,this.state=Le.OP_START;break;case Le.OP_PLUS:switch(r){case je.O:case je.o:this.state=Le.OP_PLUS_O;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_PLUS_O:switch(r){case je.K:case je.k:this.state=Le.OP_PLUS_OK;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_PLUS_OK:r===je.NL&&(this.dispatcher.push({kind:sr.OK}),this.drop=0,this.state=Le.OP_START);break;case Le.OP_MINUS:switch(r){case je.E:case je.e:this.state=Le.OP_MINUS_E;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_MINUS_E:switch(r){case je.R:case je.r:this.state=Le.OP_MINUS_ER;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_MINUS_ER:switch(r){case je.R:case je.r:this.state=Le.OP_MINUS_ERR;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_MINUS_ERR:switch(r){case je.SPACE:case je.TAB:this.state=Le.OP_MINUS_ERR_SPC;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_MINUS_ERR_SPC:switch(r){case je.SPACE:case je.TAB:continue;default:this.state=Le.MINUS_ERR_ARG,this.as=n}break;case Le.MINUS_ERR_ARG:switch(r){case je.CR:this.drop=1;break;case je.NL:{let i;this.argBuf?(i=this.argBuf.bytes(),this.argBuf=void 0):i=e.subarray(this.as,n-this.drop),this.dispatcher.push({kind:sr.ERR,data:i}),this.drop=0,this.as=n+1,this.state=Le.OP_START;break}default:this.argBuf&&this.argBuf.write(Uint8Array.of(r))}break;case Le.OP_P:switch(r){case je.I:case je.i:this.state=Le.OP_PI;break;case je.O:case je.o:this.state=Le.OP_PO;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_PO:switch(r){case je.N:case je.n:this.state=Le.OP_PON;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_PON:switch(r){case je.G:case je.g:this.state=Le.OP_PONG;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_PONG:r===je.NL&&(this.dispatcher.push({kind:sr.PONG}),this.drop=0,this.state=Le.OP_START);break;case Le.OP_PI:switch(r){case je.N:case je.n:this.state=Le.OP_PIN;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_PIN:switch(r){case je.G:case je.g:this.state=Le.OP_PING;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_PING:r===je.NL&&(this.dispatcher.push({kind:sr.PING}),this.drop=0,this.state=Le.OP_START);break;case Le.OP_I:switch(r){case je.N:case je.n:this.state=Le.OP_IN;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_IN:switch(r){case je.F:case je.f:this.state=Le.OP_INF;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_INF:switch(r){case je.O:case je.o:this.state=Le.OP_INFO;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_INFO:switch(r){case je.SPACE:case je.TAB:this.state=Le.OP_INFO_SPC;break;default:throw this.fail(e.subarray(n))}break;case Le.OP_INFO_SPC:switch(r){case je.SPACE:case je.TAB:continue;default:this.state=Le.INFO_ARG,this.as=n}break;case Le.INFO_ARG:switch(r){case je.CR:this.drop=1;break;case je.NL:{let i;this.argBuf?(i=this.argBuf.bytes(),this.argBuf=void 0):i=e.subarray(this.as,n-this.drop),this.dispatcher.push({kind:sr.INFO,data:i}),this.drop=0,this.as=n+1,this.state=Le.OP_START;break}default:this.argBuf&&this.argBuf.writeByte(r)}break;default:throw this.fail(e.subarray(n))}}(this.state===Le.MSG_ARG||this.state===Le.MINUS_ERR_ARG||this.state===Le.INFO_ARG)&&!this.argBuf&&(this.argBuf=new Bg(e.subarray(this.as,n-this.drop))),this.state===Le.MSG_PAYLOAD&&!this.msgBuf&&(this.argBuf||this.cloneMsgArg(),this.msgBuf=new Bg(e.subarray(this.as)))}cloneMsgArg(){const e=this.ma.subject.length,r=new Uint8Array(e+(this.ma.reply?this.ma.reply.length:0));r.set(this.ma.subject),this.ma.reply&&r.set(this.ma.reply,e),this.argBuf=new Bg(r),this.ma.subject=r.subarray(0,e),this.ma.reply&&(this.ma.reply=r.subarray(e))}processMsgArgs(e){if(this.hdr>=0)return this.processHeaderMsgArgs(e);const n=[];let r=-1;for(let i=0;i<e.length;i++)switch(e[i]){case je.SPACE:case je.TAB:case je.CR:case je.NL:r>=0&&(n.push(e.subarray(r,i)),r=-1);break;default:r<0&&(r=i)}switch(r>=0&&n.push(e.subarray(r)),n.length){case 3:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=void 0,this.ma.size=this.protoParseInt(n[2]);break;case 4:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=n[2],this.ma.size=this.protoParseInt(n[3]);break;default:throw this.fail(e,"processMsgArgs Parse Error")}if(this.ma.sid<0)throw this.fail(e,"processMsgArgs Bad or Missing Sid Error");if(this.ma.size<0)throw this.fail(e,"processMsgArgs Bad or Missing Size Error")}fail(e,n=""){return n=n?`${n} [${this.state}]`:`parse error [${this.state}]`,new Error(`${n}: ${Si.decode(e)}`)}processHeaderMsgArgs(e){const n=[];let r=-1;for(let i=0;i<e.length;i++)switch(e[i]){case je.SPACE:case je.TAB:case je.CR:case je.NL:r>=0&&(n.push(e.subarray(r,i)),r=-1);break;default:r<0&&(r=i)}switch(r>=0&&n.push(e.subarray(r)),n.length){case 4:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=void 0,this.ma.hdr=this.protoParseInt(n[2]),this.ma.size=this.protoParseInt(n[3]);break;case 5:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=n[2],this.ma.hdr=this.protoParseInt(n[3]),this.ma.size=this.protoParseInt(n[4]);break;default:throw this.fail(e,"processHeaderMsgArgs Parse Error")}if(this.ma.sid<0)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Sid Error");if(this.ma.hdr<0||this.ma.hdr>this.ma.size)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Header Size Error");if(this.ma.size<0)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Size Error")}protoParseInt(e){if(0===e.length)return-1;let n=0;for(let r=0;r<e.length;r++){if(e[r]<48||e[r]>57)return-1;n=10*n+(e[r]-48)}return n}}var Le=(()=>{return(t=Le||(Le={}))[t.OP_START=0]="OP_START",t[t.OP_PLUS=1]="OP_PLUS",t[t.OP_PLUS_O=2]="OP_PLUS_O",t[t.OP_PLUS_OK=3]="OP_PLUS_OK",t[t.OP_MINUS=4]="OP_MINUS",t[t.OP_MINUS_E=5]="OP_MINUS_E",t[t.OP_MINUS_ER=6]="OP_MINUS_ER",t[t.OP_MINUS_ERR=7]="OP_MINUS_ERR",t[t.OP_MINUS_ERR_SPC=8]="OP_MINUS_ERR_SPC",t[t.MINUS_ERR_ARG=9]="MINUS_ERR_ARG",t[t.OP_M=10]="OP_M",t[t.OP_MS=11]="OP_MS",t[t.OP_MSG=12]="OP_MSG",t[t.OP_MSG_SPC=13]="OP_MSG_SPC",t[t.MSG_ARG=14]="MSG_ARG",t[t.MSG_PAYLOAD=15]="MSG_PAYLOAD",t[t.MSG_END=16]="MSG_END",t[t.OP_H=17]="OP_H",t[t.OP_P=18]="OP_P",t[t.OP_PI=19]="OP_PI",t[t.OP_PIN=20]="OP_PIN",t[t.OP_PING=21]="OP_PING",t[t.OP_PO=22]="OP_PO",t[t.OP_PON=23]="OP_PON",t[t.OP_PONG=24]="OP_PONG",t[t.OP_I=25]="OP_I",t[t.OP_IN=26]="OP_IN",t[t.OP_INF=27]="OP_INF",t[t.OP_INFO=28]="OP_INFO",t[t.OP_INFO_SPC=29]="OP_INFO_SPC",t[t.INFO_ARG=30]="INFO_ARG",Le;var t})(),je=(()=>{return(t=je||(je={}))[t.CR="\r".charCodeAt(0)]="CR",t[t.E="E".charCodeAt(0)]="E",t[t.e="e".charCodeAt(0)]="e",t[t.F="F".charCodeAt(0)]="F",t[t.f="f".charCodeAt(0)]="f",t[t.G="G".charCodeAt(0)]="G",t[t.g="g".charCodeAt(0)]="g",t[t.H="H".charCodeAt(0)]="H",t[t.h="h".charCodeAt(0)]="h",t[t.I="I".charCodeAt(0)]="I",t[t.i="i".charCodeAt(0)]="i",t[t.K="K".charCodeAt(0)]="K",t[t.k="k".charCodeAt(0)]="k",t[t.M="M".charCodeAt(0)]="M",t[t.m="m".charCodeAt(0)]="m",t[t.MINUS="-".charCodeAt(0)]="MINUS",t[t.N="N".charCodeAt(0)]="N",t[t.n="n".charCodeAt(0)]="n",t[t.NL="\n".charCodeAt(0)]="NL",t[t.O="O".charCodeAt(0)]="O",t[t.o="o".charCodeAt(0)]="o",t[t.P="P".charCodeAt(0)]="P",t[t.p="p".charCodeAt(0)]="p",t[t.PLUS="+".charCodeAt(0)]="PLUS",t[t.R="R".charCodeAt(0)]="R",t[t.r="r".charCodeAt(0)]="r",t[t.S="S".charCodeAt(0)]="S",t[t.s="s".charCodeAt(0)]="s",t[t.SPACE=" ".charCodeAt(0)]="SPACE",t[t.TAB="\t".charCodeAt(0)]="TAB",je;var t})();const dN=/^INFO\s+([^\r\n]+)\r\n/i;function Hs(t=""){if("string"!=typeof(t=t||"_INBOX"))throw new Error("prefix must be a string");return`${t}.${nc.next()}`}class fN{constructor(){R(this,"baseInbox"),R(this,"reqs"),this.reqs=new Map}size(){return this.reqs.size}init(e){return this.baseInbox=`${Hs(e)}.`,this.baseInbox}add(e){isNaN(e.received)||(e.received=0),this.reqs.set(e.token,e)}get(e){return this.reqs.get(e)}cancel(e){this.reqs.delete(e.token)}getToken(e){const n=e.subject||"";return 0===n.indexOf(this.baseInbox)?n.substring(this.baseInbox.length):null}all(){return Array.from(this.reqs.values())}handleError(e,n){if(n&&n.permissionContext){if(e)return this.all().forEach(i=>{i.resolver(n,{})}),!0;const r=n.permissionContext;if("publish"===r.operation){const i=this.all().find(s=>s.requestSubject===r.subject);if(i)return i.resolver(n,{}),!0}}return!1}dispatcher(){return(e,n)=>{const r=this.getToken(n);if(r){const i=this.get(r);i&&(null===e&&n.headers&&(e=eS(n)),i.resolver(e,n))}}}close(){const e=We.errorForCode(Re.Timeout);this.reqs.forEach(n=>{n.resolver(e,{})})}}const hN=ec("PONG\r\n"),_S=ec("PING\r\n");class pN{constructor(e,n,r){R(this,"echo"),R(this,"no_responders"),R(this,"protocol"),R(this,"verbose"),R(this,"pedantic"),R(this,"jwt"),R(this,"nkey"),R(this,"sig"),R(this,"user"),R(this,"pass"),R(this,"auth_token"),R(this,"tls_required"),R(this,"name"),R(this,"lang"),R(this,"version"),R(this,"headers"),this.protocol=1,this.version=e.version,this.lang=e.lang,this.echo=!n.noEcho&&void 0,this.verbose=n.verbose,this.pedantic=n.pedantic,this.tls_required=!!n.tls||void 0,this.name=n.name,vd(this,(n&&n.authenticator?n.authenticator(r):{})||{})}}class Ad{constructor(e,n){R(this,"connected"),R(this,"connectedOnce"),R(this,"infoReceived"),R(this,"info"),R(this,"muxSubscriptions"),R(this,"options"),R(this,"outbound"),R(this,"pongs"),R(this,"subscriptions"),R(this,"transport"),R(this,"noMorePublishing"),R(this,"connectError"),R(this,"publisher"),R(this,"_closed"),R(this,"closed"),R(this,"listeners"),R(this,"heartbeats"),R(this,"parser"),R(this,"outMsgs"),R(this,"inMsgs"),R(this,"outBytes"),R(this,"inBytes"),R(this,"pendingLimit"),R(this,"lastError"),R(this,"abortReconnect"),R(this,"servers"),R(this,"server"),R(this,"features"),this._closed=!1,this.connected=!1,this.connectedOnce=!1,this.infoReceived=!1,this.noMorePublishing=!1,this.abortReconnect=!1,this.listeners=[],this.pendingLimit=32768,this.outMsgs=0,this.inMsgs=0,this.outBytes=0,this.inBytes=0,this.options=e,this.publisher=n,this.subscriptions=new sN,this.muxSubscriptions=new fN,this.outbound=new tc,this.pongs=[],this.pendingLimit=e.pendingLimit||this.pendingLimit,this.features=new PO({major:0,minor:0,micro:0}),this.servers=new iN("string"==typeof e.servers?[e.servers]:e.servers,{randomize:!e.noRandomize}),this.closed=an(),this.parser=new vS(this),this.heartbeats=new oN(this,this.options.pingInterval||12e4,this.options.maxPingOut||2)}resetOutbound(){this.outbound.reset();const e=this.pongs;this.pongs=[];const n=We.errorForCode(Re.Disconnect);n.stack="",e.forEach(r=>{r.reject(n)}),this.parser=new vS(this),this.infoReceived=!1}dispatchStatus(e){this.listeners.forEach(n=>{n.push(e)})}status(){const e=new Cr;return this.listeners.push(e),e}prepare(){var e=this;this.info=void 0,this.resetOutbound();const n=an();return n.catch(()=>{}),this.pongs.unshift(n),this.connectError=r=>{n.reject(r)},this.transport=function zO(){if(!Ur||"function"!=typeof Ur.factory)throw new Error("transport fn is not set");return Ur.factory()}(),this.transport.closed().then(function(){var r=Oe(function*(i){e.connected=!1,e.isClosed()||(yield e.disconnected(e.transport.closeError||e.lastError))});return function(i){return r.apply(this,arguments)}}()),n}disconnect(){this.dispatchStatus({type:Ia.StaleConnection,data:""}),this.transport.disconnect()}disconnected(e){var n=this;return Oe(function*(){n.dispatchStatus({type:Ls.Disconnect,data:n.servers.getCurrentServer().toString()}),n.options.reconnect?yield n.dialLoop().then(()=>{var r;n.dispatchStatus({type:Ls.Reconnect,data:n.servers.getCurrentServer().toString()}),(null==(r=n.lastError)?void 0:r.code)===Re.AuthenticationExpired&&(n.lastError=void 0)}).catch(r=>{n._close(r)}):yield n._close(e)})()}dial(e){var n=this;return Oe(function*(){const r=n.prepare();let i;try{i=bd(n.options.timeout||2e4);const s=n.transport.connect(e,n.options);yield Promise.race([s,i]),Oe(function*(){try{var l,o=!1,a=!1;try{for(var p,f=Ns(n.transport);o=!(p=yield f.next()).done;o=!1)n.parser.parse(p.value)}catch(m){a=!0,l=m}finally{try{o&&null!=f.return&&(yield f.return())}finally{if(a)throw l}}}catch(m){console.log("reader closed",m)}})().then()}catch(s){r.reject(s)}try{yield Promise.race([i,r]),i&&i.cancel(),n.connected=!0,n.connectError=void 0,n.sendSubscriptions(),n.connectedOnce=!0,n.server.didConnect=!0,n.server.reconnects=0,n.flushPending(),n.heartbeats.start()}catch(s){throw i&&i.cancel(),yield n.transport.close(s),s}})()}_doDial(e){var n=this;return Oe(function*(){const r=yield e.resolve({fn:fS(),debug:n.options.debug,randomize:!n.options.noRandomize});let i=null;for(const s of r)try{return i=null,n.dispatchStatus({type:Ia.Reconnecting,data:s.toString()}),void(yield n.dial(s))}catch(o){i=o}throw i})()}dialLoop(){var e=this;return Oe(function*(){let n;for(;;){e._closed&&e.servers.clear();const r=e.options.reconnectDelayHandler?e.options.reconnectDelayHandler():2e3;let i=r;const s=e.selectServer();if(!s||e.abortReconnect)throw n||(e.lastError?e.lastError:We.errorForCode(Re.ConnectionRefused));const o=Date.now();if(0===s.lastConnect||s.lastConnect+r<=o){s.lastConnect=Date.now();try{yield e._doDial(s);break}catch(a){if(n=a,!e.connectedOnce){if(e.options.waitOnFirstConnect)continue;e.servers.removeCurrentServer()}s.reconnects++;const l=e.options.maxReconnectAttempts||0;-1!==l&&s.reconnects>=l&&e.servers.removeCurrentServer()}}else i=Math.min(i,s.lastConnect+r-o),yield Tg(i)}})()}static connect(e,n){return Oe(function*(){const r=new Ad(e,n);return yield r.dialLoop(),r})()}static toError(e){const n=e?e.toLowerCase():"";if(-1!==n.indexOf("permissions violation")){const r=new We(e,Re.PermissionsViolation),i=e.match(/(Publish|Subscription) to "(\S+)"/);return i&&(r.permissionContext={operation:i[1].toLowerCase(),subject:i[2]}),r}return-1!==n.indexOf("authorization violation")?new We(e,Re.AuthorizationViolation):-1!==n.indexOf("user authentication expired")?new We(e,Re.AuthenticationExpired):new We(e,Re.ProtocolError)}processMsg(e,n){if(this.inMsgs++,this.inBytes+=n.length,!this.subscriptions.sidCounter)return;const r=this.subscriptions.get(e.sid);!r||(r.received+=1,r.callback&&r.callback(null,new tS(e,n,this)),void 0!==r.max&&r.received>=r.max&&r.unsubscribe())}processError(e){const n=G1(e),r=Ad.toError(n),i={type:Ls.Error,data:r.code};if(r.isPermissionError()){let s=!1;if(r.permissionContext){i.permissionContext=r.permissionContext;const o=this.subscriptions.getMux();s=(null==o?void 0:o.subject)===r.permissionContext.subject}this.subscriptions.handleError(r),this.muxSubscriptions.handleError(s,r),s&&this.subscriptions.setMux(null)}this.dispatchStatus(i),this.handleError(r)}handleError(e){e.isAuthError()&&this.handleAuthError(e),e.isProtocolError()&&(this.lastError=e),e.isPermissionError()||(this.lastError=e)}handleAuthError(e){this.lastError&&e.code===this.lastError.code&&!1===this.options.ignoreAuthErrorAbort&&(this.abortReconnect=!0),this.connectError?this.connectError(e):this.disconnect()}processPing(){this.transport.send(hN)}processPong(){const e=this.pongs.shift();e&&e.resolve()}processInfo(e){const n=JSON.parse(G1(e));this.info=n;const r=this.options&&this.options.ignoreClusterUpdates?void 0:this.servers.update(n);if(!this.infoReceived){this.features.update(go(n.version)),this.infoReceived=!0,this.transport.isEncrypted()&&this.servers.updateTLSName();const{version:s,lang:o}=this.transport;try{const a=new pN({version:s,lang:o},this.options,n.nonce);n.headers&&(a.headers=!0,a.no_responders=!0);const l=JSON.stringify(a);this.transport.send(ec(`CONNECT ${l}\r\n`)),this.transport.send(_S)}catch(a){this._close(a)}}r&&this.dispatchStatus({type:Ls.Update,data:r}),void 0!==n.ldm&&n.ldm&&this.dispatchStatus({type:Ls.LDM,data:this.servers.getCurrentServer().toString()})}push(e){switch(e.kind){case sr.MSG:{const{msg:n,data:r}=e;this.processMsg(n,r);break}case sr.OK:break;case sr.ERR:this.processError(e.data);break;case sr.PING:this.processPing();break;case sr.PONG:this.processPong();break;case sr.INFO:this.processInfo(e.data)}}sendCommand(e,...n){const r=this.outbound.length();let i;i="string"==typeof e?ec(e):e,this.outbound.fill(i,...n),0===r?setTimeout(()=>{this.flushPending()}):this.outbound.size()>=this.pendingLimit&&this.flushPending()}publish(e,n,r){let i=n.length;(r=r||{}).reply=r.reply||"";let a,s=ir,o=0;if(r.headers){if(this.info&&!this.info.headers)throw new We("headers",Re.ServerOptionNotAvailable);s=r.headers.encode(),o=s.length,i=n.length+o}if(this.info&&i>this.info.max_payload)throw We.errorForCode(Re.MaxPayloadExceeded);this.outBytes+=i,this.outMsgs++,r.headers?(a=r.reply?`HPUB ${e} ${r.reply} ${o} ${i}\r\n`:`HPUB ${e} ${o} ${i}\r\n`,this.sendCommand(a,s,n,yd)):(a=r.reply?`PUB ${e} ${r.reply} ${i}\r\n`:`PUB ${e} ${i}\r\n`,this.sendCommand(a,n,yd))}request(e){return this.initMux(),this.muxSubscriptions.add(e),e}subscribe(e){return this.subscriptions.add(e),this._subunsub(e),e}_sub(e){this.sendCommand(e.queue?`SUB ${e.subject} ${e.queue} ${e.sid}\r\n`:`SUB ${e.subject} ${e.sid}\r\n`)}_subunsub(e){return this._sub(e),e.max&&this.unsubscribe(e,e.max),e}unsubscribe(e,n){this.unsub(e,n),(void 0===e.max||e.received>=e.max)&&this.subscriptions.cancel(e)}unsub(e,n){!e||this.isClosed()||(this.sendCommand(n?`UNSUB ${e.sid} ${n}\r\n`:`UNSUB ${e.sid}\r\n`),e.max=n)}resub(e,n){!e||this.isClosed()||(e.subject=n,this.subscriptions.resub(e),this._sub(e))}flush(e){return e||(e=an()),this.pongs.push(e),this.sendCommand(_S),e}sendSubscriptions(){const e=[];this.subscriptions.all().forEach(n=>{e.push(n.queue?`SUB ${n.subject} ${n.queue} ${n.sid}\r\n`:`SUB ${n.subject} ${n.sid}\r\n`)}),e.length&&this.transport.send(ec(e.join("")))}_close(e){var n=this;return Oe(function*(){n._closed||(n.heartbeats.cancel(),n.connectError&&(n.connectError(e),n.connectError=void 0),n.muxSubscriptions.close(),n.subscriptions.close(),n.listeners.forEach(r=>{r.stop()}),n._closed=!0,yield n.transport.close(e),yield n.closed.resolve(e))})()}close(){return this._close()}isClosed(){return this._closed}drain(){var e=this;const n=this.subscriptions.all(),r=[];return n.forEach(i=>{r.push(i.drain())}),Promise.all(r).then(Oe(function*(){return e.noMorePublishing=!0,yield e.flush(),e.close()})).catch(()=>{})}flushPending(){if(this.infoReceived&&this.connected&&this.outbound.size()){const e=this.outbound.drain();this.transport.send(e)}}initMux(){if(!this.subscriptions.getMux()){const n=this.muxSubscriptions.init(this.options.inboxPrefix),r=new gS(this,`${n}*`);r.callback=this.muxSubscriptions.dispatcher(),this.subscriptions.setMux(r),this.subscribe(r)}}selectServer(){const e=this.servers.selectServer();if(void 0!==e)return this.server=e,this.server}getServer(){return this.server}}function Vs(t){return new gN(t)}class gN{constructor(e){R(this,"config"),R(this,"ordered"),R(this,"mack"),R(this,"stream"),R(this,"callbackFn"),R(this,"max"),R(this,"qname"),R(this,"isBind"),this.stream="",this.mack=!1,this.ordered=!1,this.config=function AO(t,e={}){return Object.assign({name:t,deliver_policy:xr.All,ack_policy:Vn.Explicit,ack_wait:jn(3e4),replay_policy:ho.Instant},e)}("",e||{})}getOpts(){const e={};return e.config=this.config,e.mack=this.mack,e.stream=this.stream,e.callbackFn=this.callbackFn,e.max=this.max,e.queue=this.qname,e.ordered=this.ordered,e.config.ack_policy=e.ordered?Vn.None:e.config.ack_policy,e.isBind=e.isBind||!1,e}description(e){return this.config.description=e,this}deliverTo(e){return this.config.deliver_subject=e,this}durable(e){return Pa(e),this.config.durable_name=e,this}startSequence(e){if(e<=0)throw new Error("sequence must be greater than 0");return this.config.deliver_policy=xr.StartSequence,this.config.opt_start_seq=e,this}startTime(e){return this.config.deliver_policy=xr.StartTime,this.config.opt_start_time=e.toISOString(),this}deliverAll(){return this.config.deliver_policy=xr.All,this}deliverLastPerSubject(){return this.config.deliver_policy=xr.LastPerSubject,this}deliverLast(){return this.config.deliver_policy=xr.Last,this}deliverNew(){return this.config.deliver_policy=xr.New,this}startAtTimeDelta(e){return this.startTime(new Date(Date.now()-e)),this}headersOnly(){return this.config.headers_only=!0,this}ackNone(){return this.config.ack_policy=Vn.None,this}ackAll(){return this.config.ack_policy=Vn.All,this}ackExplicit(){return this.config.ack_policy=Vn.Explicit,this}ackWait(e){return this.config.ack_wait=jn(e),this}maxDeliver(e){return this.config.max_deliver=e,this}filterSubject(e){return this.config.filter_subject=e,this}replayInstantly(){return this.config.replay_policy=ho.Instant,this}replayOriginal(){return this.config.replay_policy=ho.Original,this}sample(e){if((e=Math.trunc(e))<0||e>100)throw new Error("value must be between 0-100");return this.config.sample_freq=`${e}%`,this}limit(e){return this.config.rate_limit_bps=e,this}maxWaiting(e){return this.config.max_waiting=e,this}maxAckPending(e){return this.config.max_ack_pending=e,this}idleHeartbeat(e){return this.config.idle_heartbeat=jn(e),this}flowControl(){return this.config.flow_control=!0,this}deliverGroup(e){return this.queue(e),this}manualAck(){return this.mack=!0,this}maxMessages(e){return this.max=e,this}callback(e){return this.callbackFn=e,this}queue(e){return this.qname=e,this.config.deliver_group=e,this}orderedConsumer(){return this.ordered=!0,this}bind(e,n){return this.stream=e,this.config.durable_name=n,this.isBind=!0,this}bindStream(e){return this.stream=e,this}inactiveEphemeralThreshold(e){return this.config.inactive_threshold=jn(e),this}maxPullBatch(e){return this.config.max_batch=e,this}maxPullRequestExpires(e){return this.config.max_expires=jn(e),this}memory(){return this.config.mem_storage=!0,this}numReplicas(e){return this.config.num_replicas=e,this}}function bS(t){return"function"==typeof t.getOpts}class wS{constructor(e,n,r={maxOut:2}){R(this,"interval"),R(this,"maxOut"),R(this,"cancelAfter"),R(this,"timer"),R(this,"autoCancelTimer"),R(this,"last"),R(this,"missed"),R(this,"count"),R(this,"callback"),this.interval=e,this.maxOut=(null==r?void 0:r.maxOut)||2,this.cancelAfter=(null==r?void 0:r.cancelAfter)||0,this.last=Date.now(),this.missed=0,this.count=0,this.callback=n,this._schedule()}cancel(){this.autoCancelTimer&&clearTimeout(this.autoCancelTimer),this.timer&&clearInterval(this.timer),this.timer=0,this.autoCancelTimer=0}work(){this.last=Date.now(),this.missed=0}_change(e,n=0,r=2){this.interval=e,this.maxOut=r,this.cancelAfter=n,this.restart()}restart(){this.cancel(),this._schedule()}_schedule(){this.cancelAfter>0&&(this.autoCancelTimer=setTimeout(()=>{this.cancel()},this.cancelAfter)),this.timer=setInterval(()=>{if(this.count++,Date.now()-this.interval>this.last&&this.missed++,this.missed>=this.maxOut)try{!0===this.callback(this.missed)&&this.cancel()}catch(e){console.log(e)}},this.interval)}}class cc{static encode(e){return cc.toB64URLEncoding(class mN{static encode(e){if("string"==typeof e)return btoa(e);const n=Array.from(e);return btoa(String.fromCharCode(...n))}static decode(e,n=!1){const r=atob(e);return n?Uint8Array.from(r,i=>i.charCodeAt(0)):r}}.encode(e))}static decode(e,n=!1){return cc.decode(cc.fromB64URLEncoding(e),n)}static toB64URLEncoding(e){return e.replace(/\+/g,"-").replace(/\//g,"_")}static fromB64URLEncoding(e){return e.replace(/_/g,"/").replace(/-/g,"+")}}function SS(t){const e=t.length;let n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}const ES=[],xS=[],Ug="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";for(let t=0,e=Ug.length;t<e;++t)ES[t]=Ug[t],xS[Ug.charCodeAt(t)]=t;const{toUint8Array:vN,fromUint8Array:_N}=function yN(t,e,n=!1){function r(o,a){return Math.floor(3*(o+a)/4-a)}function i(o){return t[o>>18&63]+t[o>>12&63]+t[o>>6&63]+t[63&o]}function s(o,a,l){const f=new Array((l-a)/3);for(let p=a,m=0;p<l;p+=3)f[m++]=i((o[p]<<16)+(o[p+1]<<8)+o[p+2]);return f.join("")}return{byteLength:o=>r.apply(null,SS(o)),toUint8Array(o){const[a,l]=SS(o),f=new Uint8Array(r(a,l)),p=l?a-4:a;let m,x,E=0;for(x=0;x<p;x+=4)m=e[o.charCodeAt(x)]<<18|e[o.charCodeAt(x+1)]<<12|e[o.charCodeAt(x+2)]<<6|e[o.charCodeAt(x+3)],f[E++]=m>>16&255,f[E++]=m>>8&255,f[E++]=255&m;return 2===l?(m=e[o.charCodeAt(x)]<<2|e[o.charCodeAt(x+1)]>>4,f[E++]=255&m):1===l&&(m=e[o.charCodeAt(x)]<<10|e[o.charCodeAt(x+1)]<<4|e[o.charCodeAt(x+2)]>>2,f[E++]=m>>8&255,f[E++]=255&m),f},fromUint8Array(o){const l=o.length,f=l%3,p=l-f,m=new Array(Math.ceil(p/16383)+(f?1:0));let x,j,E=0;for(let de=0;de<p;de+=16383)x=de+16383,m[E++]=s(o,de,x>p?p:x);return 1===f?(j=o[p],m[E]=t[j>>2]+t[j<<4&63],n||(m[E]+="==")):2===f&&(j=o[p]<<8|255&o[p+1],m[E]=t[j>>10]+t[j>>4&63]+t[j<<2&63],n||(m[E]+="=")),m.join("")}}}(ES,xS,!0),bN=new TextDecoder,wN=new TextEncoder;class CS{constructor(){R(this,"hashSize",32),R(this,"_buf"),R(this,"_bufIdx"),R(this,"_count"),R(this,"_K"),R(this,"_H"),R(this,"_finalized"),this._buf=new Uint8Array(64),this._K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),this.init()}init(){return this._H=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),this._bufIdx=0,this._count=new Uint32Array(2),this._buf.fill(0),this._finalized=!1,this}update(e,n){if(null===e)throw new TypeError("msg must be a string or Uint8Array.");"string"==typeof e&&(e=function CN(t,e="utf8"){if(/^utf-?8$/i.test(e))return wN.encode(t);if(/^base64$/i.test(e))return vN(t);if(/^hex(?:adecimal)?$/i.test(e))return function EN(t){const e=t.length;if(e%2||!/^[0-9a-fA-F]+$/.test(t))throw new TypeError("Invalid hex string.");t=t.toLowerCase();const n=new Uint8Array(Math.floor(e/2)),r=e/2;for(let i=0;i<r;++i)n[i]=parseInt(t.substr(2*i,2),16);return n}(t);throw new TypeError("Unsupported string encoding.")}(e,n));for(let i=0,s=e.length;i<s;i++)this._buf[this._bufIdx++]=e[i],64===this._bufIdx&&(this._transform(),this._bufIdx=0);const r=this._count;return(r[0]+=e.length<<3)<e.length<<3&&r[1]++,r[1]+=e.length>>>29,this}digest(e){if(this._finalized)throw new Error("digest has already been called.");this._finalized=!0;const n=this._buf;let r=this._bufIdx;for(n[r++]=128;56!==r;)64===r&&(this._transform(),r=0),n[r++]=0;const i=this._count;n[56]=i[1]>>>24&255,n[57]=i[1]>>>16&255,n[58]=i[1]>>>8&255,n[59]=i[1]>>>0&255,n[60]=i[0]>>>24&255,n[61]=i[0]>>>16&255,n[62]=i[0]>>>8&255,n[63]=i[0]>>>0&255,this._transform();const s=new Uint8Array(32);for(let o=0;o<8;o++)s[0+(o<<2)]=this._H[o]>>>24&255,s[1+(o<<2)]=this._H[o]>>>16&255,s[2+(o<<2)]=this._H[o]>>>8&255,s[3+(o<<2)]=this._H[o]>>>0&255;return this.init(),e?function xN(t,e="utf8"){if(/^utf-?8$/i.test(e))return bN.decode(t);if(/^base64$/i.test(e))return _N(t);if(/^hex(?:adecimal)?$/i.test(e))return function SN(t){return t.reduce((e,n)=>`${e}${n<16?"0":""}${n.toString(16)}`,"")}(t);throw new TypeError("Unsupported string encoding.")}(s,e):s}_transform(){const e=this._H;let n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],f=e[7];const p=new Uint32Array(16);let m;for(m=0;m<16;m++)p[m]=this._buf[3+(m<<2)]|this._buf[2+(m<<2)]<<8|this._buf[1+(m<<2)]<<16|this._buf[m<<2]<<24;for(m=0;m<64;m++){let E;if(m<16)E=p[m];else{let x=p[m+1&15],j=p[m+14&15];E=p[15&m]=(x>>>7^x>>>18^x>>>3^x<<25^x<<14)+(j>>>17^j>>>19^j>>>10^j<<15^j<<13)+p[15&m]+p[m+9&15]|0}E=E+f+(o>>>6^o>>>11^o>>>25^o<<26^o<<21^o<<7)+(l^o&(a^l))+this._K[m]|0,f=l,l=a,a=o,o=s+E,s=i,i=r,r=n,n=E+(r&i^s&(r^i))+(r>>>2^r>>>13^r>>>22^r<<30^r<<19^r<<10)|0}e[0]=e[0]+n|0,e[1]=e[1]+r|0,e[2]=e[2]+i|0,e[3]=e[3]+s|0,e[4]=e[4]+o|0,e[5]=e[5]+a|0,e[6]=e[6]+l|0,e[7]=e[7]+f|0}}class DN extends sc{constructor(e,n){super(e,n)}getMessage(e,n){var r=this;return Oe(function*(){Dr(e);let i=n;const{last_by_subj:s}=i;s&&(i=null);const o=i?r.jc.encode(i):ir,a=r.opts.apiPrefix||"$JS.API",l=s?`${a}.DIRECT.GET.${e}.${s}`:`${a}.DIRECT.GET.${e}`,f=yield r.nc.request(l,o),p=ka(f);if(p)return Promise.reject(p);const m=new AN(f);return Promise.resolve(m)})()}}class AN{constructor(e){if(R(this,"data"),R(this,"header"),!e.headers)throw new Error("headers expected");this.data=e.data,this.header=e.headers}get subject(){return this.header.get(po.Subject)}get seq(){const e=this.header.get(po.Sequence);return"string"==typeof e?parseInt(e):0}get time(){return new Date(Date.parse(this.header.get(po.TimeStamp)))}get stream(){return this.header.get(po.Stream)}}!function(t){var e=function(I,H){this.hi=0|I,this.lo=0|H},n=function(I){var H,L=new Float64Array(16);if(I)for(H=0;H<I.length;H++)L[H]=I[H];return L},r=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var o=n(),a=n([1]),l=n([56129,1]),f=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),E=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function j(I,H){return I<<H|I>>>32-H}function de(I,H){var L=255&I[H+3];return(L=(L=L<<8|255&I[H+2])<<8|255&I[H+1])<<8|255&I[H+0]}function we(I,H){return new e(I[H]<<24|I[H+1]<<16|I[H+2]<<8|I[H+3],I[H+4]<<24|I[H+5]<<16|I[H+6]<<8|I[H+7])}function xe(I,H,L){var z;for(z=0;z<4;z++)I[H+z]=255&L,L>>>=8}function ye(I,H,L){I[H]=L.hi>>24&255,I[H+1]=L.hi>>16&255,I[H+2]=L.hi>>8&255,I[H+3]=255&L.hi,I[H+4]=L.lo>>24&255,I[H+5]=L.lo>>16&255,I[H+6]=L.lo>>8&255,I[H+7]=255&L.lo}function Me(I,H,L,z,fe){var ge,Ae=0;for(ge=0;ge<fe;ge++)Ae|=I[H+ge]^L[z+ge];return(1&Ae-1>>>8)-1}function Ze(I,H,L,z){return Me(I,H,L,z,16)}function ut(I,H,L,z){return Me(I,H,L,z,32)}function Tn(I,H,L,z,fe){var De,Je,It,ge=new Uint32Array(16),Ae=new Uint32Array(16),ke=new Uint32Array(16),Se=new Uint32Array(4);for(De=0;De<4;De++)Ae[5*De]=de(z,4*De),Ae[1+De]=de(L,4*De),Ae[6+De]=de(H,4*De),Ae[11+De]=de(L,16+4*De);for(De=0;De<16;De++)ke[De]=Ae[De];for(De=0;De<20;De++){for(Je=0;Je<4;Je++){for(It=0;It<4;It++)Se[It]=Ae[(5*Je+4*It)%16];for(Se[1]^=j(Se[0]+Se[3]|0,7),Se[2]^=j(Se[1]+Se[0]|0,9),Se[3]^=j(Se[2]+Se[1]|0,13),Se[0]^=j(Se[3]+Se[2]|0,18),It=0;It<4;It++)ge[4*Je+(Je+It)%4]=Se[It]}for(It=0;It<16;It++)Ae[It]=ge[It]}if(fe){for(De=0;De<16;De++)Ae[De]=Ae[De]+ke[De]|0;for(De=0;De<4;De++)Ae[5*De]=Ae[5*De]-de(z,4*De)|0,Ae[6+De]=Ae[6+De]-de(H,4*De)|0;for(De=0;De<4;De++)xe(I,4*De,Ae[5*De]),xe(I,16+4*De,Ae[6+De])}else for(De=0;De<16;De++)xe(I,4*De,Ae[De]+ke[De]|0)}function si(I,H,L,z){return Tn(I,H,L,z,!1),0}function xi(I,H,L,z){return Tn(I,H,L,z,!0),0}var gr=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function zi(I,H,L,z,fe,ge,Ae){var De,Je,ke=new Uint8Array(16),Se=new Uint8Array(64);if(!fe)return 0;for(Je=0;Je<16;Je++)ke[Je]=0;for(Je=0;Je<8;Je++)ke[Je]=ge[Je];for(;fe>=64;){for(si(Se,ke,Ae,gr),Je=0;Je<64;Je++)I[H+Je]=(L?L[z+Je]:0)^Se[Je];for(De=1,Je=8;Je<16;Je++)ke[Je]=255&(De=De+(255&ke[Je])|0),De>>>=8;fe-=64,H+=64,L&&(z+=64)}if(fe>0)for(si(Se,ke,Ae,gr),Je=0;Je<fe;Je++)I[H+Je]=(L?L[z+Je]:0)^Se[Je];return 0}function Ks(I,H,L,z,fe){return zi(I,H,null,0,L,z,fe)}function ds(I,H,L,z,fe){var ge=new Uint8Array(32);return xi(ge,z,fe,gr),Ks(I,H,L,z.subarray(16),ge)}function Ci(I,H,L,z,fe,ge,Ae){var ke=new Uint8Array(32);return xi(ke,ge,Ae,gr),zi(I,H,L,z,fe,ge.subarray(16),ke)}function vo(I,H){var L,z=0;for(L=0;L<17;L++)I[L]=255&(z=z+(I[L]+H[L]|0)|0),z>>>=8}var fc=new Uint32Array([5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252]);function _o(I,H,L,z,fe,ge){var Ae,ke,Se,De,Je=new Uint32Array(17),It=new Uint32Array(17),un=new Uint32Array(17),Fi=new Uint32Array(17),Ba=new Uint32Array(17);for(Se=0;Se<17;Se++)It[Se]=un[Se]=0;for(Se=0;Se<16;Se++)It[Se]=ge[Se];for(It[3]&=15,It[4]&=252,It[7]&=15,It[8]&=252,It[11]&=15,It[12]&=252,It[15]&=15;fe>0;){for(Se=0;Se<17;Se++)Fi[Se]=0;for(Se=0;Se<16&&Se<fe;++Se)Fi[Se]=L[z+Se];for(Fi[Se]=1,z+=Se,fe-=Se,vo(un,Fi),ke=0;ke<17;ke++)for(Je[ke]=0,Se=0;Se<17;Se++)Je[ke]=0|Je[ke]+un[Se]*(Se<=ke?It[ke-Se]:320*It[ke+17-Se]|0);for(ke=0;ke<17;ke++)un[ke]=Je[ke];for(De=0,Se=0;Se<16;Se++)un[Se]=255&(De=De+un[Se]|0),De>>>=8;for(un[16]=3&(De=De+un[16]|0),De=5*(De>>>2)|0,Se=0;Se<16;Se++)un[Se]=255&(De=De+un[Se]|0),De>>>=8;un[16]=De=De+un[16]|0}for(Se=0;Se<17;Se++)Ba[Se]=un[Se];for(vo(un,fc),Ae=0|-(un[16]>>>7),Se=0;Se<17;Se++)un[Se]^=Ae&(Ba[Se]^un[Se]);for(Se=0;Se<16;Se++)Fi[Se]=ge[Se+16];for(Fi[16]=0,vo(un,Fi),Se=0;Se<16;Se++)I[H+Se]=un[Se];return 0}function HS(I,H,L,z,fe,ge){var Ae=new Uint8Array(16);return _o(Ae,0,L,z,fe,ge),Ze(I,H,Ae,0)}function Wg(I,H,L,z,fe){var ge;if(L<32)return-1;for(Ci(I,0,H,0,L,z,fe),_o(I,16,I,32,L-32,I),ge=0;ge<16;ge++)I[ge]=0;return 0}function Jg(I,H,L,z,fe){var ge,Ae=new Uint8Array(32);if(L<32||(ds(Ae,0,32,z,fe),0!==HS(H,16,H,32,L-32,Ae)))return-1;for(Ci(I,0,H,0,L,z,fe),ge=0;ge<32;ge++)I[ge]=0;return 0}function fs(I,H){var L;for(L=0;L<16;L++)I[L]=0|H[L]}function hc(I){var H,L;for(L=0;L<16;L++)I[L]+=65536,H=Math.floor(I[L]/65536),I[(L+1)*(L<15?1:0)]+=H-1+37*(H-1)*(15===L?1:0),I[L]-=65536*H}function Oa(I,H,L){for(var z,fe=~(L-1),ge=0;ge<16;ge++)I[ge]^=z=fe&(I[ge]^H[ge]),H[ge]^=z}function Na(I,H){var L,z,fe,ge=n(),Ae=n();for(L=0;L<16;L++)Ae[L]=H[L];for(hc(Ae),hc(Ae),hc(Ae),z=0;z<2;z++){for(ge[0]=Ae[0]-65517,L=1;L<15;L++)ge[L]=Ae[L]-65535-(ge[L-1]>>16&1),ge[L-1]&=65535;ge[15]=Ae[15]-32767-(ge[14]>>16&1),fe=ge[15]>>16&1,ge[14]&=65535,Oa(Ae,ge,1-fe)}for(L=0;L<16;L++)I[2*L]=255&Ae[L],I[2*L+1]=Ae[L]>>8}function VS(I,H){var L=new Uint8Array(32),z=new Uint8Array(32);return Na(L,I),Na(z,H),ut(L,0,z,0)}function $S(I){var H=new Uint8Array(32);return Na(H,I),1&H[0]}function Yg(I,H){var L;for(L=0;L<16;L++)I[L]=H[2*L]+(H[2*L+1]<<8);I[15]&=32767}function Di(I,H,L){var z;for(z=0;z<16;z++)I[z]=H[z]+L[z]|0}function Ai(I,H,L){var z;for(z=0;z<16;z++)I[z]=H[z]-L[z]|0}function Ft(I,H,L){var z,fe,ge=new Float64Array(31);for(z=0;z<31;z++)ge[z]=0;for(z=0;z<16;z++)for(fe=0;fe<16;fe++)ge[z+fe]+=H[z]*L[fe];for(z=0;z<15;z++)ge[z]+=38*ge[z+16];for(z=0;z<16;z++)I[z]=ge[z];hc(I),hc(I)}function oi(I,H){Ft(I,H,H)}function qS(I,H){var z,L=n();for(z=0;z<16;z++)L[z]=H[z];for(z=253;z>=0;z--)oi(L,L),2!==z&&4!==z&&Ft(L,L,H);for(z=0;z<16;z++)I[z]=L[z]}function KS(I,H){var z,L=n();for(z=0;z<16;z++)L[z]=H[z];for(z=250;z>=0;z--)oi(L,L),1!==z&&Ft(L,L,H);for(z=0;z<16;z++)I[z]=L[z]}function Ld(I,H,L){var ge,Ae,z=new Uint8Array(32),fe=new Float64Array(80),ke=n(),Se=n(),De=n(),Je=n(),It=n(),un=n();for(Ae=0;Ae<31;Ae++)z[Ae]=H[Ae];for(z[31]=127&H[31]|64,z[0]&=248,Yg(fe,L),Ae=0;Ae<16;Ae++)Se[Ae]=fe[Ae],Je[Ae]=ke[Ae]=De[Ae]=0;for(ke[0]=Je[0]=1,Ae=254;Ae>=0;--Ae)Oa(ke,Se,ge=z[Ae>>>3]>>>(7&Ae)&1),Oa(De,Je,ge),Di(It,ke,De),Ai(ke,ke,De),Di(De,Se,Je),Ai(Se,Se,Je),oi(Je,It),oi(un,ke),Ft(ke,De,ke),Ft(De,Se,It),Di(It,ke,De),Ai(ke,ke,De),oi(Se,ke),Ai(De,Je,un),Ft(ke,De,l),Di(ke,ke,Je),Ft(De,De,ke),Ft(ke,Je,un),Ft(Je,Se,fe),oi(Se,It),Oa(ke,Se,ge),Oa(De,Je,ge);for(Ae=0;Ae<16;Ae++)fe[Ae+16]=ke[Ae],fe[Ae+32]=De[Ae],fe[Ae+48]=Se[Ae],fe[Ae+64]=Je[Ae];var Fi=fe.subarray(32),Ba=fe.subarray(16);return qS(Fi,Fi),Ft(Ba,Ba,Fi),Na(I,Ba),0}function jd(I,H){return Ld(I,H,s)}function GS(I,H){return r(H,32),jd(I,H)}function Bd(I,H,L){var z=new Uint8Array(32);return Ld(z,L,H),xi(I,i,z,gr)}var zS=Wg,WL=Jg;function pc(){var ge,Ae,ke,I=0,H=0,L=0,z=0,fe=65535;for(ke=0;ke<arguments.length;ke++)I+=(ge=arguments[ke].lo)&fe,H+=ge>>>16,L+=(Ae=arguments[ke].hi)&fe,z+=Ae>>>16;return new e((L+=(H+=I>>>16)>>>16)&fe|(z+=L>>>16)<<16,I&fe|H<<16)}function WS(I,H){return new e(I.hi>>>H,I.lo>>>H|I.hi<<32-H)}function Ud(){var L,I=0,H=0;for(L=0;L<arguments.length;L++)I^=arguments[L].lo,H^=arguments[L].hi;return new e(H,I)}function Wi(I,H){var L,z,fe=32-H;return H<32?(L=I.hi>>>H|I.lo<<fe,z=I.lo>>>H|I.hi<<fe):H<64&&(L=I.lo>>>H|I.hi<<fe,z=I.hi>>>H|I.lo<<fe),new e(L,z)}function QL(I,H,L){return new e(I.hi&H.hi^~I.hi&L.hi,I.lo&H.lo^~I.lo&L.lo)}function ZL(I,H,L){return new e(I.hi&H.hi^I.hi&L.hi^H.hi&L.hi,I.lo&H.lo^I.lo&L.lo^H.lo&L.lo)}function XL(I){return Ud(Wi(I,28),Wi(I,34),Wi(I,39))}function e3(I){return Ud(Wi(I,14),Wi(I,18),Wi(I,41))}function t3(I){return Ud(Wi(I,1),Wi(I,8),WS(I,7))}function n3(I){return Ud(Wi(I,19),Wi(I,61),WS(I,6))}var r3=[new e(1116352408,3609767458),new e(1899447441,602891725),new e(3049323471,3964484399),new e(3921009573,2173295548),new e(961987163,4081628472),new e(1508970993,3053834265),new e(2453635748,2937671579),new e(2870763221,3664609560),new e(3624381080,2734883394),new e(310598401,1164996542),new e(607225278,1323610764),new e(1426881987,3590304994),new e(1925078388,4068182383),new e(2162078206,991336113),new e(2614888103,633803317),new e(3248222580,3479774868),new e(3835390401,2666613458),new e(4022224774,944711139),new e(264347078,2341262773),new e(604807628,2007800933),new e(770255983,1495990901),new e(1249150122,1856431235),new e(1555081692,3175218132),new e(1996064986,2198950837),new e(2554220882,3999719339),new e(2821834349,766784016),new e(2952996808,2566594879),new e(3210313671,3203337956),new e(3336571891,1034457026),new e(3584528711,2466948901),new e(113926993,3758326383),new e(338241895,168717936),new e(666307205,1188179964),new e(773529912,1546045734),new e(1294757372,1522805485),new e(1396182291,2643833823),new e(1695183700,2343527390),new e(1986661051,1014477480),new e(2177026350,1206759142),new e(2456956037,344077627),new e(2730485921,1290863460),new e(2820302411,3158454273),new e(3259730800,3505952657),new e(3345764771,106217008),new e(3516065817,3606008344),new e(3600352804,1432725776),new e(4094571909,1467031594),new e(275423344,851169720),new e(430227734,3100823752),new e(506948616,1363258195),new e(659060556,3750685593),new e(883997877,3785050280),new e(958139571,3318307427),new e(1322822218,3812723403),new e(1537002063,2003034995),new e(1747873779,3602036899),new e(1955562222,1575990012),new e(2024104815,1125592928),new e(2227730452,2716904306),new e(2361852424,442776044),new e(2428436474,593698344),new e(2756734187,3733110249),new e(3204031479,2999351573),new e(3329325298,3815920427),new e(3391569614,3928383900),new e(3515267271,566280711),new e(3940187606,3454069534),new e(4118630271,4000239992),new e(116418474,1914138554),new e(174292421,2731055270),new e(289380356,3203993006),new e(460393269,320620315),new e(685471733,587496836),new e(852142971,1086792851),new e(1017036298,365543100),new e(1126000580,2618297676),new e(1288033470,3409855158),new e(1501505948,4234509866),new e(1607167915,987167468),new e(1816402316,1246189591)];function JS(I,H,L){var ke,Se,De,z=[],fe=[],ge=[],Ae=[];for(Se=0;Se<8;Se++)z[Se]=ge[Se]=we(I,8*Se);for(var Je=0;L>=128;){for(Se=0;Se<16;Se++)Ae[Se]=we(H,8*Se+Je);for(Se=0;Se<80;Se++){for(De=0;De<8;De++)fe[De]=ge[De];for(ke=pc(ge[7],e3(ge[4]),QL(ge[4],ge[5],ge[6]),r3[Se],Ae[Se%16]),fe[7]=pc(ke,XL(ge[0]),ZL(ge[0],ge[1],ge[2])),fe[3]=pc(fe[3],ke),De=0;De<8;De++)ge[(De+1)%8]=fe[De];if(Se%16==15)for(De=0;De<16;De++)Ae[De]=pc(Ae[De],Ae[(De+9)%16],t3(Ae[(De+1)%16]),n3(Ae[(De+14)%16]))}for(Se=0;Se<8;Se++)ge[Se]=pc(ge[Se],z[Se]),z[Se]=ge[Se];Je+=128,L-=128}for(Se=0;Se<8;Se++)ye(I,8*Se,z[Se]);return L}var i3=new Uint8Array([106,9,230,103,243,188,201,8,187,103,174,133,132,202,167,59,60,110,243,114,254,148,248,43,165,79,245,58,95,29,54,241,81,14,82,127,173,230,130,209,155,5,104,140,43,62,108,31,31,131,217,171,251,65,189,107,91,224,205,25,19,126,33,121]);function bo(I,H,L){var ge,z=new Uint8Array(64),fe=new Uint8Array(256),Ae=L;for(ge=0;ge<64;ge++)z[ge]=i3[ge];for(JS(z,H,L),L%=128,ge=0;ge<256;ge++)fe[ge]=0;for(ge=0;ge<L;ge++)fe[ge]=H[Ae-L+ge];for(fe[L]=128,fe[(L=256-128*(L<112?1:0))-9]=0,ye(fe,L-8,new e(Ae/536870912|0,Ae<<3)),JS(z,fe,L),ge=0;ge<64;ge++)I[ge]=z[ge];return 0}function Hd(I,H){var L=n(),z=n(),fe=n(),ge=n(),Ae=n(),ke=n(),Se=n(),De=n(),Je=n();Ai(L,I[1],I[0]),Ai(Je,H[1],H[0]),Ft(L,L,Je),Di(z,I[0],I[1]),Di(Je,H[0],H[1]),Ft(z,z,Je),Ft(fe,I[3],H[3]),Ft(fe,fe,p),Ft(ge,I[2],H[2]),Di(ge,ge,ge),Ai(Ae,z,L),Ai(ke,ge,fe),Di(Se,ge,fe),Di(De,z,L),Ft(I[0],Ae,ke),Ft(I[1],De,Se),Ft(I[2],Se,ke),Ft(I[3],Ae,De)}function YS(I,H,L){var z;for(z=0;z<4;z++)Oa(I[z],H[z],L)}function Qg(I,H){var L=n(),z=n(),fe=n();qS(fe,H[2]),Ft(L,H[0],fe),Ft(z,H[1],fe),Na(I,z),I[31]^=$S(L)<<7}function Zg(I,H,L){var z,fe;for(fs(I[0],o),fs(I[1],a),fs(I[2],a),fs(I[3],o),fe=255;fe>=0;--fe)YS(I,H,z=L[fe/8|0]>>(7&fe)&1),Hd(H,I),Hd(I,I),YS(I,H,z)}function Vd(I,H){var L=[n(),n(),n(),n()];fs(L[0],m),fs(L[1],E),fs(L[2],a),Ft(L[3],m,E),Zg(I,L,H)}function Xg(I,H,L){var ge,z=new Uint8Array(64),fe=[n(),n(),n(),n()];for(L||r(H,32),bo(z,H,32),z[0]&=248,z[31]&=127,z[31]|=64,Vd(fe,z),Qg(I,fe),ge=0;ge<32;ge++)H[ge+32]=I[ge];return 0}var I,$d=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function em(I,H){var L,z,fe,ge;for(z=63;z>=32;--z){for(L=0,fe=z-32,ge=z-12;fe<ge;++fe)H[fe]+=L-16*H[z]*$d[fe-(z-32)],L=Math.floor((H[fe]+128)/256),H[fe]-=256*L;H[fe]+=L,H[z]=0}for(L=0,fe=0;fe<32;fe++)H[fe]+=L-(H[31]>>4)*$d[fe],L=H[fe]>>8,H[fe]&=255;for(fe=0;fe<32;fe++)H[fe]-=L*$d[fe];for(z=0;z<32;z++)H[z+1]+=H[z]>>8,I[z]=255&H[z]}function tm(I){var L,H=new Float64Array(64);for(L=0;L<64;L++)H[L]=I[L];for(L=0;L<64;L++)I[L]=0;em(I,H)}function QS(I,H,L,z){var ke,Se,fe=new Uint8Array(64),ge=new Uint8Array(64),Ae=new Uint8Array(64),De=new Float64Array(64),Je=[n(),n(),n(),n()];bo(fe,z,32),fe[0]&=248,fe[31]&=127,fe[31]|=64;var It=L+64;for(ke=0;ke<L;ke++)I[64+ke]=H[ke];for(ke=0;ke<32;ke++)I[32+ke]=fe[32+ke];for(bo(Ae,I.subarray(32),L+32),tm(Ae),Vd(Je,Ae),Qg(I,Je),ke=32;ke<64;ke++)I[ke]=z[ke];for(bo(ge,I,L+64),tm(ge),ke=0;ke<64;ke++)De[ke]=0;for(ke=0;ke<32;ke++)De[ke]=Ae[ke];for(ke=0;ke<32;ke++)for(Se=0;Se<32;Se++)De[ke+Se]+=ge[ke]*fe[Se];return em(I.subarray(32),De),It}function nm(I,H,L,z){var fe,ge=new Uint8Array(32),Ae=new Uint8Array(64),ke=[n(),n(),n(),n()],Se=[n(),n(),n(),n()];if(L<64||function s3(I,H){var L=n(),z=n(),fe=n(),ge=n(),Ae=n(),ke=n(),Se=n();return fs(I[2],a),Yg(I[1],H),oi(fe,I[1]),Ft(ge,fe,f),Ai(fe,fe,I[2]),Di(ge,I[2],ge),oi(Ae,ge),oi(ke,Ae),Ft(Se,ke,Ae),Ft(L,Se,fe),Ft(L,L,ge),KS(L,L),Ft(L,L,fe),Ft(L,L,ge),Ft(L,L,ge),Ft(I[0],L,ge),oi(z,I[0]),Ft(z,z,ge),VS(z,fe)&&Ft(I[0],I[0],x),oi(z,I[0]),Ft(z,z,ge),VS(z,fe)?-1:($S(I[0])===H[31]>>7&&Ai(I[0],o,I[0]),Ft(I[3],I[0],I[1]),0)}(Se,z))return-1;for(fe=0;fe<L;fe++)I[fe]=H[fe];for(fe=0;fe<32;fe++)I[fe+32]=z[fe];if(bo(Ae,I,L),tm(Ae),Zg(ke,Se,Ae),Vd(Se,H.subarray(32)),Hd(ke,Se),Qg(ge,ke),L-=64,ut(H,0,ge,0)){for(fe=0;fe<L;fe++)I[fe]=0;return-1}for(fe=0;fe<L;fe++)I[fe]=H[fe+64];return L}function XS(I,H){if(32!==I.length)throw new Error("bad key size");if(24!==H.length)throw new Error("bad nonce size")}function Hr(){for(var I=0;I<arguments.length;I++)if(!(arguments[I]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function eE(I){for(var H=0;H<I.length;H++)I[H]=0}t.lowlevel={crypto_core_hsalsa20:xi,crypto_stream_xor:Ci,crypto_stream:ds,crypto_stream_salsa20_xor:zi,crypto_stream_salsa20:Ks,crypto_onetimeauth:_o,crypto_onetimeauth_verify:HS,crypto_verify_16:Ze,crypto_verify_32:ut,crypto_secretbox:Wg,crypto_secretbox_open:Jg,crypto_scalarmult:Ld,crypto_scalarmult_base:jd,crypto_box_beforenm:Bd,crypto_box_afternm:zS,crypto_box:function JL(I,H,L,z,fe,ge){var Ae=new Uint8Array(32);return Bd(Ae,fe,ge),zS(I,H,L,z,Ae)},crypto_box_open:function YL(I,H,L,z,fe,ge){var Ae=new Uint8Array(32);return Bd(Ae,fe,ge),WL(I,H,L,z,Ae)},crypto_box_keypair:GS,crypto_hash:bo,crypto_sign:QS,crypto_sign_keypair:Xg,crypto_sign_open:nm,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:n,D:f,L:$d,pack25519:Na,unpack25519:Yg,M:Ft,A:Di,S:oi,Z:Ai,pow2523:KS,add:Hd,set25519:fs,modL:em,scalarmult:Zg,scalarbase:Vd},t.randomBytes=function(I){var H=new Uint8Array(I);return r(H,I),H},t.secretbox=function(I,H,L){Hr(I,H,L),XS(L,H);for(var z=new Uint8Array(32+I.length),fe=new Uint8Array(z.length),ge=0;ge<I.length;ge++)z[ge+32]=I[ge];return Wg(fe,z,z.length,H,L),fe.subarray(16)},t.secretbox.open=function(I,H,L){Hr(I,H,L),XS(L,H);for(var z=new Uint8Array(16+I.length),fe=new Uint8Array(z.length),ge=0;ge<I.length;ge++)z[ge+16]=I[ge];return z.length<32||0!==Jg(fe,z,z.length,H,L)?null:fe.subarray(32)},t.secretbox.keyLength=32,t.secretbox.nonceLength=24,t.secretbox.overheadLength=16,t.scalarMult=function(I,H){if(Hr(I,H),32!==I.length)throw new Error("bad n size");if(32!==H.length)throw new Error("bad p size");var L=new Uint8Array(32);return Ld(L,I,H),L},t.scalarMult.base=function(I){if(Hr(I),32!==I.length)throw new Error("bad n size");var H=new Uint8Array(32);return jd(H,I),H},t.scalarMult.scalarLength=32,t.scalarMult.groupElementLength=32,t.box=function(I,H,L,z){var fe=t.box.before(L,z);return t.secretbox(I,H,fe)},t.box.before=function(I,H){Hr(I,H),function u3(I,H){if(32!==I.length)throw new Error("bad public key size");if(32!==H.length)throw new Error("bad secret key size")}(I,H);var L=new Uint8Array(32);return Bd(L,I,H),L},t.box.after=t.secretbox,t.box.open=function(I,H,L,z){var fe=t.box.before(L,z);return t.secretbox.open(I,H,fe)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var I=new Uint8Array(32),H=new Uint8Array(32);return GS(I,H),{publicKey:I,secretKey:H}},t.box.keyPair.fromSecretKey=function(I){if(Hr(I),32!==I.length)throw new Error("bad secret key size");var H=new Uint8Array(32);return jd(H,I),{publicKey:H,secretKey:new Uint8Array(I)}},t.box.publicKeyLength=32,t.box.secretKeyLength=32,t.box.sharedKeyLength=32,t.box.nonceLength=24,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(I,H){if(Hr(I,H),64!==H.length)throw new Error("bad secret key size");var L=new Uint8Array(64+I.length);return QS(L,I,I.length,H),L},t.sign.open=function(I,H){if(Hr(I,H),32!==H.length)throw new Error("bad public key size");var L=new Uint8Array(I.length),z=nm(L,I,I.length,H);if(z<0)return null;for(var fe=new Uint8Array(z),ge=0;ge<fe.length;ge++)fe[ge]=L[ge];return fe},t.sign.detached=function(I,H){for(var L=t.sign(I,H),z=new Uint8Array(64),fe=0;fe<z.length;fe++)z[fe]=L[fe];return z},t.sign.detached.verify=function(I,H,L){if(Hr(I,H,L),64!==H.length)throw new Error("bad signature size");if(32!==L.length)throw new Error("bad public key size");var ge,z=new Uint8Array(64+I.length),fe=new Uint8Array(64+I.length);for(ge=0;ge<64;ge++)z[ge]=H[ge];for(ge=0;ge<I.length;ge++)z[ge+64]=I[ge];return nm(fe,z,z.length,L)>=0},t.sign.keyPair=function(){var I=new Uint8Array(32),H=new Uint8Array(64);return Xg(I,H),{publicKey:I,secretKey:H}},t.sign.keyPair.fromSecretKey=function(I){if(Hr(I),64!==I.length)throw new Error("bad secret key size");for(var H=new Uint8Array(32),L=0;L<H.length;L++)H[L]=I[32+L];return{publicKey:H,secretKey:new Uint8Array(I)}},t.sign.keyPair.fromSeed=function(I){if(Hr(I),32!==I.length)throw new Error("bad seed size");for(var H=new Uint8Array(32),L=new Uint8Array(64),z=0;z<32;z++)L[z]=I[z];return Xg(H,L,!0),{publicKey:H,secretKey:L}},t.sign.publicKeyLength=32,t.sign.secretKeyLength=64,t.sign.seedLength=32,t.sign.signatureLength=64,t.hash=function(I){Hr(I);var H=new Uint8Array(64);return bo(H,I,I.length),H},t.hash.hashLength=64,t.verify=function(I,H){return Hr(I,H),0!==I.length&&0!==H.length&&I.length===H.length&&0===Me(I,0,H,0,I.length)},t.setPRNG=function(I){r=I},(I="undefined"!=typeof globalThis?globalThis.crypto||globalThis.msCrypto:null)&&I.getRandomValues?t.setPRNG(function(L,z){var fe,ge=new Uint8Array(z);for(fe=0;fe<z;fe+=65536)I.getRandomValues(ge.subarray(fe,fe+Math.min(z-fe,65536)));for(fe=0;fe<z;fe++)L[fe]=ge[fe];eE(ge)}):"undefined"!=typeof require&&(I=require("crypto"))&&I.randomBytes&&t.setPRNG(function(L,z){var fe,ge=I.randomBytes(z);for(fe=0;fe<z;fe++)L[fe]=ge[fe];eE(ge)})}("undefined"!=typeof module&&module.exports?module.exports:globalThis.nacl=globalThis.nacl||{});const Fd="undefined"!=typeof module&&module.exports?module.exports:globalThis.nacl,FN={fromSeed:Fd.sign.keyPair.fromSeed,sign:Fd.sign.detached,verify:Fd.sign.detached.verify,randomBytes:Fd.randomBytes};let DS;new Uint16Array([0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920]),Error,function IN(t){DS=t}(FN);const kd="KV-Operation",ii="KV_",QN=/^[-/=.\w]+$/,ZN=/^[-/=.>*\w]+$/,XN=/^[-\w]+$/;function kS(t){if(t.startsWith(".")||t.endsWith(".")||!QN.test(t))throw new Error(`invalid key: ${t}`)}function eL(t){if(t.startsWith(".")||t.endsWith(".")||!ZN.test(t))throw new Error(`invalid key: ${t}`)}function tL(t){if(t.startsWith(".")||t.endsWith("."))throw new Error(`invalid key: ${t}`);const e=t.split(".");let n=!1;for(let r=0;r<e.length;r++)switch(e[r]){case"*":n=!0;break;case">":if(r!==e.length-1)throw new Error(`invalid key: ${t}`);n=!0}return n}function Md(t){if(!XN.test(t))throw new Error(`invalid bucket name: ${t}`)}class lc{constructor(e,n,r){R(this,"jsm"),R(this,"js"),R(this,"stream"),R(this,"bucket"),R(this,"direct"),R(this,"codec"),R(this,"prefix"),R(this,"editPrefix"),R(this,"useJsPrefix"),R(this,"_prefixLen"),R(this,"validateKey",kS),R(this,"validateSearchKey",eL),R(this,"hasWildcards",tL),Md(e),this.jsm=n,this.js=r,this.bucket=e,this.prefix="$KV",this.editPrefix="",this.useJsPrefix=!1,this._prefixLen=0}static create(e,n,r={}){return Oe(function*(){const i=e,{ok:s,min:o}=i.nc.features.get(Ar.JS_KV);if(!s)return Promise.reject(new Error(`kv is only supported on servers ${o} or better`));Md(n);let l=i.opts||{};l=Object.assign(l,{timeout:r.timeout||2e3});const f=yield i.nc.jetstreamManager(l),p=new lc(n,f,e);return yield p.init(r),p})()}static bind(e,n,r={}){return Oe(function*(){var l;const s=yield e.nc.jetstreamManager(),o=yield s.streams.info(`KV_${n}`);Md(o.config.name);const a=new lc(n,s,e);return Object.assign(a,o),a.codec=r.codec||{key:{encode:t=>t,decode:t=>t},value:{encode:t=>t,decode:t=>t}},a.direct=null!=(l=o.config.allow_direct)&&l,a.initializePrefixes(o),a})()}init(e={}){var n=this;return Oe(function*(){var E,x;const r=Object.assign(function YN(){return{replicas:1,history:1,timeout:2e3,maxBucketSize:-1,maxValueSize:-1,codec:{key:{encode:t=>t,decode:t=>t},value:{encode:t=>t,decode:t=>t}},storage:md.File}}(),e);n.codec=r.codec;const i={};n.stream=i.name=null!=(E=e.streamName)?E:n.bucketName(),i.retention=gd.Limits,i.max_msgs_per_subject=r.history,r.maxBucketSize&&(r.max_bytes=r.maxBucketSize),r.max_bytes&&(i.max_bytes=r.max_bytes),i.max_msg_size=r.maxValueSize,i.storage=r.storage;const s=null!=(x=e.placementCluster)?x:"";if(s&&(e.placement={},e.placement.cluster=s,e.placement.tags=[]),e.placement&&(i.placement=e.placement),e.republish&&(i.republish=e.republish),e.description&&(i.description=e.description),e.mirror){const j=Object.assign({},e.mirror);j.name.startsWith(ii)||(j.name=`KV_${j.name}`),i.mirror=j,i.mirror_direct=!0}else if(e.sources){const j=e.sources.map(de=>{const we=Object.assign({},de);we.name.startsWith(ii)||(we.name=`KV_${we.name}`)});i.sources=j}else i.subjects=[n.subjectForBucket()];const o=n.js.nc,a=o.getServerVersion(),l=!!a&&Rg(a,go("2.7.2"))>=0;i.discard=l?Ta.New:Ta.Old;const{ok:f,min:p}=o.features.get(Ar.JS_ALLOW_DIRECT);if(!f&&!0===e.allow_direct)return Promise.reject(new Error(`allow_direct is not available on server version ${a?`${a.major}.${a.minor}.${a.micro}`:"unknown"} - requires ${p}`));let m;e.allow_direct="boolean"==typeof e.allow_direct?e.allow_direct:f,i.allow_direct=e.allow_direct,n.direct=i.allow_direct,i.num_replicas=r.replicas,r.ttl&&(i.max_age=jn(r.ttl)),i.allow_rollup_hdrs=!0;try{m=yield n.jsm.streams.info(i.name),!m.config.allow_direct&&!0===n.direct&&(n.direct=!1)}catch(j){if("stream not found"!==j.message)throw j;m=yield n.jsm.streams.add(i)}n.initializePrefixes(m)})()}initializePrefixes(e){this._prefixLen=0,this.prefix=`$KV.${this.bucket}`,this.useJsPrefix="$JS.API"!==this.js.opts.apiPrefix;const{mirror:n}=e.config;if(n){let r=n.name;if(r.startsWith(ii)&&(r=r.substring(ii.length)),n.external&&""!==n.external.api){const i=n.name.substring(ii.length);this.useJsPrefix=!1,this.prefix=`$KV.${i}`,this.editPrefix=`${n.external.api}.$KV.${r}`}else this.editPrefix=this.prefix}}bucketName(){var e;return null!=(e=this.stream)?e:`KV_${this.bucket}`}subjectForBucket(){return`${this.prefix}.${this.bucket}.>`}subjectForKey(e,n=!1){const r=[];return n?(this.useJsPrefix&&r.push(this.js.apiPrefix),r.push(""!==this.editPrefix?this.editPrefix:this.prefix)):this.prefix&&r.push(this.prefix),r.push(e),r.join(".")}fullKeyName(e){return""!==this.prefix?`${this.prefix}.${e}`:`$KV.${this.bucket}.${e}`}get prefixLen(){return 0===this._prefixLen&&(this._prefixLen=this.prefix.length+1),this._prefixLen}encodeKey(e){const n=[];for(const r of e.split("."))switch(r){case">":case"*":n.push(r);break;default:n.push(this.codec.key.encode(r))}return n.join(".")}decodeKey(e){const n=[];for(const r of e.split("."))switch(r){case">":case"*":n.push(r);break;default:n.push(this.codec.key.decode(r))}return n.join(".")}close(){return Promise.resolve()}dataLen(e,n){const r=n&&n.get(ri.MessageSizeHdr)||"";return""!==r?parseInt(r,10):e.length}smToEntry(e){return{bucket:this.bucket,key:e.subject.substring(this.prefixLen),value:e.data,delta:0,created:e.time,revision:e.seq,operation:e.header.get(kd)||"PUT",length:this.dataLen(e.data,e.header)}}jmToEntry(e){var r;const n=this.decodeKey(e.subject.substring(this.prefixLen));return{bucket:this.bucket,key:n,value:e.data,created:new Date(kg(e.info.timestampNanos)),revision:e.seq,operation:(null==(r=e.headers)?void 0:r.get(kd))||"PUT",delta:e.info.pending,length:this.dataLen(e.data,e.headers)}}create(e,n){var r=this;return Oe(function*(){var o;let i;try{const a=yield r.put(e,n,{previousSeq:0});return Promise.resolve(a)}catch(a){if(i=a,10071!==(null==(o=null==a?void 0:a.api_error)?void 0:o.err_code))return Promise.reject(a)}let s=0;try{const a=yield r.get(e);return"DEL"===(null==a?void 0:a.operation)||"PURGE"===(null==a?void 0:a.operation)?(s=null!==a?a.revision:0,r.update(e,n,s)):Promise.reject(i)}catch(a){return Promise.reject(a)}})()}update(e,n,r){if(r<=0)throw new Error("version must be greater than 0");return this.put(e,n,{previousSeq:r})}put(e,n,r={}){var i=this;return Oe(function*(){var a,l;const s=i.encodeKey(e);i.validateKey(s);const o={};if(void 0!==r.previousSeq){const f=ls();o.headers=f,f.set("Nats-Expected-Last-Subject-Sequence",`${r.previousSeq}`)}try{return(yield i.js.publish(i.subjectForKey(s,!0),n,o)).seq}catch(f){const p=f;return p.isJetStreamError()?(p.message=null==(a=p.api_error)?void 0:a.description,p.code=`${null==(l=p.api_error)?void 0:l.code}`,Promise.reject(p)):Promise.reject(f)}})()}get(e,n){var r=this;return Oe(function*(){const i=r.encodeKey(e);r.validateKey(i);let o,s={last_by_subj:r.subjectForKey(i)};n&&n.revision>0&&(s={seq:n.revision});try{o=r.direct?yield r.jsm.direct.getMessage(r.bucketName(),s):yield r.jsm.streams.getMessage(r.bucketName(),s);const a=r.smToEntry(o);return a.key!==i?null:a}catch(a){if(a.code===Re.JetStream404NoMessages)return null;throw a}})()}purge(e){return this._deleteOrPurge(e,"PURGE")}delete(e){return this._deleteOrPurge(e,"DEL")}purgeDeletes(e=18e5){var n=this;return Oe(function*(){const r=an(),i=[],s=yield n.watch({key:">",initializedFn:()=>{r.resolve()}});Oe(function*(){var m,f=!1,p=!1;try{for(var x,E=Ns(s);f=!(x=yield E.next()).done;f=!1){const j=x.value;("DEL"===j.operation||"PURGE"===j.operation)&&i.push(j)}}catch(j){p=!0,m=j}finally{try{f&&null!=E.return&&(yield E.return())}finally{if(p)throw m}}})().then(),yield r,s.stop();const o=Date.now()-e,a=i.map(f=>{const p=n.subjectForKey(f.key);return f.created.getTime()>=o?n.jsm.streams.purge(n.stream,{filter:p,keep:1}):n.jsm.streams.purge(n.stream,{filter:p,keep:0})}),l=yield Promise.all(a);return l.unshift({success:!0,purged:0}),l.reduce((f,p)=>(f.purged+=p.purged,f))})()}_deleteOrPurge(e,n){var r=this;return Oe(function*(){if(!r.hasWildcards(e))return r._doDeleteOrPurge(e,n);const i=yield r.keys(e),s=[];var l,o=!1,a=!1;try{for(var p,f=Ns(i);o=!(p=yield f.next()).done;o=!1)s.push(r._doDeleteOrPurge(p.value,n)),100===s.length&&(yield Promise.all(s),s.length=0)}catch(m){a=!0,l=m}finally{try{o&&null!=f.return&&(yield f.return())}finally{if(a)throw l}}s.length>0&&(yield Promise.all(s))})()}_doDeleteOrPurge(e,n){var r=this;return Oe(function*(){const i=r.encodeKey(e);r.validateKey(i);const s=ls();s.set(kd,n),"PURGE"===n&&s.set(ri.RollupHdr,ri.RollupValueSubject),yield r.js.publish(r.subjectForKey(i,!0),ir,{headers:s})})()}_buildCC(e,n=!1,r={}){const i=this.encodeKey(e);return this.validateSearchKey(e),Object.assign({deliver_policy:n?xr.All:xr.LastPerSubject,ack_policy:Vn.None,filter_subject:this.fullKeyName(i),flow_control:!0,idle_heartbeat:jn(5e3)},r)}remove(e){return this.purge(e)}history(e={}){var n=this;return Oe(function*(){var E;const r=null!=(E=e.key)?E:">",i=new Cr,s={};let o;s.headers_only=e.headers_only||!1,o=()=>{i.stop()};let a=0;const l=n._buildCC(r,!0,s),f=l.filter_subject,p=Vs(l);p.bindStream(n.stream),p.orderedConsumer(),p.callback((x,j)=>{if(x)i.stop(x);else if(j){const de=n.jmToEntry(j);i.push(de),i.received++,(o&&a>0&&i.received>=a||0===j.info.pending)&&(i.push(o),o=void 0)}});const m=yield n.js.subscribe(f,p);if(o){const{info:{last:x}}=m,j=x.num_pending+x.delivered.consumer_seq;if(0===j||i.received>=j)try{o()}catch(de){i.stop(de)}finally{o=void 0}else a=j}return i._data=m,i.iterClosed.then(()=>{m.unsubscribe()}),m.closed.then(()=>{i.stop()}).catch(x=>{i.stop(x)}),i})()}watch(e={}){var n=this;return Oe(function*(){var E;const r=null!=(E=e.key)?E:">",i=new Cr,s={};s.headers_only=e.headers_only||!1;let o=e.initializedFn,a=0;const l=n._buildCC(r,!1,s),f=l.filter_subject,p=Vs(l);p.bindStream(n.stream),p.orderedConsumer(),p.callback((x,j)=>{if(x)i.stop(x);else if(j){const de=n.jmToEntry(j);i.push(de),i.received++,o&&(a>0&&i.received>=a||0===j.info.pending)&&(i.push(o),o=void 0)}});const m=yield n.js.subscribe(f,p);if(o){const{info:{last:x}}=m,j=x.num_pending+x.delivered.consumer_seq;if(0===j||i.received>=j)try{o()}catch(de){i.stop(de)}finally{o=void 0}else a=j}return i._data=m,i.iterClosed.then(()=>{m.unsubscribe()}),m.closed.then(()=>{i.stop()}).catch(x=>{i.stop(x)}),i})()}keys(e=">"){var n=this;return Oe(function*(){const r=new Cr,i=n._buildCC(e,!1,{headers_only:!0}),s=i.filter_subject,o=Vs(i);o.bindStream(n.stream),o.orderedConsumer();const a=yield n.js.subscribe(s,o);return Oe(function*(){var j,m,f=!1,p=!1;try{for(var x,E=Ns(a);f=!(x=yield E.next()).done;f=!1){const de=x.value,we=null==(j=de.headers)?void 0:j.get(kd);if("DEL"!==we&&"PURGE"!==we){const xe=n.decodeKey(de.subject.substring(n.prefixLen));r.push(xe)}0===de.info.pending&&a.unsubscribe()}}catch(de){p=!0,m=de}finally{try{f&&null!=E.return&&(yield E.return())}finally{if(p)throw m}}})().then(()=>{r.stop()}).catch(f=>{r.stop(f)}),0===a.info.last.num_pending&&a.unsubscribe(),r})()}purgeBucket(e){return this.jsm.streams.purge(this.bucketName(),e)}destroy(){return this.jsm.streams.delete(this.bucketName())}status(){var e=this;return Oe(function*(){var o,a;const r=null!=(a=null==(o=e.js.nc.info)?void 0:o.cluster)?a:"",i=e.bucketName(),s=yield e.jsm.streams.info(i);return new MS(s,r)})()}}class MS{constructor(e,n=""){R(this,"si"),R(this,"cluster"),this.si=e,this.cluster=n}get bucket(){return this.si.config.name.startsWith(ii)?this.si.config.name.substring(ii.length):this.si.config.name}get values(){return this.si.state.messages}get history(){return this.si.config.max_msgs_per_subject}get ttl(){return kg(this.si.config.max_age)}get bucket_location(){return this.cluster}get backingStore(){return this.si.config.storage}get storage(){return this.si.config.storage}get replicas(){return this.si.config.num_replicas}get description(){var e;return null!=(e=this.si.config.description)?e:""}get maxBucketSize(){return this.si.config.max_bytes}get maxValueSize(){return this.si.config.max_msg_size}get max_bytes(){return this.si.config.max_bytes}get placement(){return this.si.config.placement||{cluster:"",tags:[]}}get placementCluster(){var e,n;return null!=(n=null==(e=this.si.config.placement)?void 0:e.cluster)?n:""}get republish(){var e;return null!=(e=this.si.config.republish)?e:{src:"",dest:""}}get streamInfo(){return this.si}get size(){return this.si.state.bytes}}const RS="SHA-256=";class $g{constructor(e){R(this,"si"),R(this,"backingStore"),this.si=e,this.backingStore="JetStream"}get bucket(){return function rL(t){return t.startsWith("OBJ_")?t.substring(4):t}(this.si.config.name)}get description(){var e;return null!=(e=this.si.config.description)?e:""}get ttl(){return this.si.config.max_age}get storage(){return this.si.config.storage}get replicas(){return this.si.config.num_replicas}get sealed(){return this.si.config.sealed}get size(){return this.si.state.bytes}get streamInfo(){return this.si}}function Rd(t){if(void 0===t)return;const{domain:e}=t;if(void 0===e)return t;const n=Object.assign({},t);if(delete n.domain,""===e)return n;if(n.external)throw new Error("domain and external are both set");return n.external={api:`$JS.${e}.API`},n}class iL extends sc{constructor(e,n){super(e,n)}add(e={}){var n=this;return Oe(function*(){var s;Dr(e.name),e.mirror=Rd(e.mirror),e.sources=null==(s=e.sources)?void 0:s.map(Rd);const i=yield n._request(`${n.prefix}.STREAM.CREATE.${e.name}`,e);return n._fixInfo(i),i})()}delete(e){var n=this;return Oe(function*(){return Dr(e),(yield n._request(`${n.prefix}.STREAM.DELETE.${e}`)).success})()}update(e,n={}){var r=this;return Oe(function*(){var l;if("object"==typeof e){const f=e;e=f.name,n=f,console.trace("\x1b[33m >> streams.update(config: StreamConfig) api changed to streams.update(name: string, config: StreamUpdateConfig) - this shim will be removed - update your code.  \x1b[0m")}Dr(e);const i=yield r.info(e),s=Object.assign(i.config,n);s.mirror=Rd(s.mirror),s.sources=null==(l=s.sources)?void 0:l.map(Rd);const a=yield r._request(`${r.prefix}.STREAM.UPDATE.${e}`,s);return r._fixInfo(a),a})()}info(e,n){var r=this;return Oe(function*(){Dr(e);const i=`${r.prefix}.STREAM.INFO.${e}`;let o=yield r._request(i,n),{total:a,limit:l}=o,f=o.state.subjects?Object.getOwnPropertyNames(o.state.subjects).length:1;if(a&&a>f){const p=[o],m=n||{};let E=0;for(;a>f;){E++,m.offset=l*E;const j=yield r._request(i,m);a=j.total,p.push(j);const de=Object.getOwnPropertyNames(j.state.subjects).length;if(f+=de,de<l)break}let x={};for(let j=0;j<p.length;j++)o=p[j],o.state.subjects&&(x=Object.assign(x,o.state.subjects));o.offset=0,o.total=0,o.limit=0,o.state.subjects=x}return r._fixInfo(o),o})()}list(e=""){return new oc(`${this.prefix}.STREAM.LIST`,s=>{const o=s;return o.streams.forEach(a=>{this._fixInfo(a)}),o.streams},this,(null==e?void 0:e.length)?{subject:e}:{})}_fixInfo(e){e.config.sealed=e.config.sealed||!1,e.config.deny_delete=e.config.deny_delete||!1,e.config.deny_purge=e.config.deny_purge||!1,e.config.allow_rollup_hdrs=e.config.allow_rollup_hdrs||!1}purge(e,n){var r=this;return Oe(function*(){if(n){const{keep:s,seq:o}=n;if("number"==typeof s&&"number"==typeof o)throw new Error("can specify one of keep or seq")}return Dr(e),yield r._request(`${r.prefix}.STREAM.PURGE.${e}`,n)})()}deleteMessage(e,n,r=!0){var i=this;return Oe(function*(){Dr(e);const s={seq:n};return r||(s.no_erase=!0),(yield i._request(`${i.prefix}.STREAM.MSG.DELETE.${e}`,s)).success})()}getMessage(e,n){var r=this;return Oe(function*(){Dr(e);const s=yield r._request(`${r.prefix}.STREAM.MSG.GET.${e}`,n);return new fL(s)})()}find(e){return this.findStream(e)}listKvs(){return new oc(`${this.prefix}.STREAM.LIST`,r=>{var l,f;const s=r.streams.filter(p=>p.config.name.startsWith(ii));s.forEach(p=>{this._fixInfo(p)});let o="";return s.length&&(o=null!=(f=null==(l=this.nc.info)?void 0:l.cluster)?f:""),s.map(p=>new MS(p,o))},this)}listObjectStores(){return new oc(`${this.prefix}.STREAM.LIST`,r=>{const s=r.streams.filter(a=>a.config.name.startsWith("OBJ_"));return s.forEach(a=>{this._fixInfo(a)}),s.map(a=>new $g(a))},this)}names(e=""){return new oc(`${this.prefix}.STREAM.NAMES`,s=>s.streams,this,(null==e?void 0:e.length)?{subject:e}:{})}}class sL extends sc{constructor(e,n){super(e,n),R(this,"streams"),R(this,"consumers"),R(this,"direct"),this.streams=new iL(e,n),this.consumers=new aS(e,n),this.direct=new DN(e,n)}getAccountInfo(){var e=this;return Oe(function*(){return yield e._request(`${e.prefix}.INFO`)})()}advisories(){const e=new Cr;return this.nc.subscribe("$JS.EVENT.ADVISORY.>",{callback:(n,r)=>{if(n)throw n;try{const i=this.parseJsResponse(r),s=i.type.split(".");e.push({kind:s[s.length-1],data:i})}catch(i){e.stop(i)}}}),e}}var qs=(()=>{return(t=qs||(qs={})).MsgIdHdr="Nats-Msg-Id",t.ExpectedStreamHdr="Nats-Expected-Stream",t.ExpectedLastSeqHdr="Nats-Expected-Last-Sequence",t.ExpectedLastMsgIdHdr="Nats-Expected-Last-Msg-Id",t.ExpectedLastSubjectSequenceHdr="Nats-Expected-Last-Subject-Sequence",qs;var t})();class qg{constructor(e){R(this,"info"),R(this,"hdrs"),this.info=e}get name(){return this.info.name}get description(){var e;return null!=(e=this.info.description)?e:""}get headers(){return this.hdrs||(this.hdrs=Us.fromRecord(this.info.headers||{})),this.hdrs}get options(){return this.info.options}get bucket(){return this.info.bucket}get chunks(){return this.info.chunks}get deleted(){var e;return null!=(e=this.info.deleted)&&e}get digest(){return this.info.digest}get mtime(){return this.info.mtime}get nuid(){return this.info.nuid}get size(){return this.info.size}}function OS(t){var n;const e={name:t.name,description:null!=(n=t.description)?n:"",options:t.options};return t.headers&&(e.headers=t.headers.toRecord()),e}class dc{constructor(e,n,r){R(this,"jsm"),R(this,"js"),R(this,"stream"),R(this,"name"),this.name=e,this.jsm=n,this.js=r}_sanitizeName(e){if(!e||0===e.length)return{name:e,error:new Error("name cannot be empty")};let n;e=e.replace(/[. ]/g,"_");try{kS(e)}catch(r){n=r}return{name:e,error:n}}info(e){var n=this;return Oe(function*(){const r=yield n.rawInfo(e);return r?new qg(r):null})()}list(){var e=this;return Oe(function*(){const n=[],r=yield e.watch({ignoreDeletes:!0,includeHistory:!0});var o,i=!1,s=!1;try{for(var l,a=Ns(r);i=!(l=yield a.next()).done;i=!1){const f=l.value;if(null===f)break;n.push(f)}}catch(f){s=!0,o=f}finally{try{i&&null!=a.return&&(yield a.return())}finally{if(s)throw o}}return Promise.resolve(n)})()}rawInfo(e){var n=this;return Oe(function*(){const{name:r,error:i}=n._sanitizeName(e);if(i)return Promise.reject(i);const s=n._metaSubject(r);try{const o=yield n.jsm.streams.getMessage(n.stream,{last_by_subj:s});return Gi().decode(o.data)}catch(o){return"404"===o.code?null:Promise.reject(o)}})()}_si(e){var n=this;return Oe(function*(){try{return yield n.jsm.streams.info(n.stream,e)}catch(r){return"404"===r.code?null:Promise.reject(r)}})()}seal(){var e=this;return Oe(function*(){let n=yield e._si();return null===n?Promise.reject(new Error("object store not found")):(n.config.sealed=!0,n=yield e.jsm.streams.update(e.stream,n.config),Promise.resolve(new $g(n)))})()}status(e){var n=this;return Oe(function*(){const r=yield n._si(e);return null===r?Promise.reject(new Error("object store not found")):Promise.resolve(new $g(r))})()}destroy(){return this.jsm.streams.delete(this.stream)}_put(e,n,r){var i=this;return Oe(function*(){var Me,Ze;const s=i.js;(r=r||{timeout:s.timeout}).timeout=r.timeout||1e3;const{timeout:o}=r,a=(null==(Me=s.nc.info)?void 0:Me.max_payload)||1024;(e=e||{}).options=e.options||{};let l=(null==(Ze=e.options)?void 0:Ze.max_chunk_size)||131072;l=l>a?a:l,e.options.max_chunk_size=l;const f=yield i.info(e.name),{name:p,error:m}=i._sanitizeName(e.name);if(m)return Promise.reject(m);const E=nc.next(),x=i._chunkSubject(E),j=i._metaSubject(p),de=Object.assign({bucket:i.name,nuid:E,size:0,chunks:0},OS(e)),we=an(),xe=[],ye=new tc;try{const ut=n?n.getReader():null,Tn=new CS;for(;;){const{done:si,value:xi}=ut?yield ut.read():{done:!0,value:void 0};if(si){if(ye.size()>0){const Ci=ye.drain();Tn.update(Ci),de.chunks++,de.size+=Ci.length,xe.push(i.js.publish(x,Ci,{timeout:o}))}de.mtime=(new Date).toISOString();const gr=Tn.digest("base64"),zi=gr.length%3,Ks=zi>0?"=".repeat(zi):"";de.digest=`${RS}${gr}${Ks}`,de.deleted=!1;const ds=ls();ds.set(ri.RollupHdr,ri.RollupValueSubject),xe.push(i.js.publish(j,Gi().encode(de),{headers:ds,timeout:o})),f&&xe.push(i.jsm.streams.purge(i.stream,{filter:`$O.${i.name}.C.${f.nuid}`})),yield Promise.all(xe),we.resolve(new qg(de));break}if(xi)for(ye.fill(xi);ye.size()>l;){de.chunks++,de.size+=l;const gr=ye.drain(e.options.max_chunk_size);Tn.update(gr),xe.push(i.js.publish(x,gr,{timeout:o}))}}}catch(ut){yield i.jsm.streams.purge(i.stream,{filter:x}),we.reject(ut)}return we})()}put(e,n,r){var i;return(null==(i=null==e?void 0:e.options)?void 0:i.link)?Promise.reject(new Error("link cannot be set when putting the object in bucket")):this._put(e,n,r)}get(e){var n=this;return Oe(function*(){const r=yield n.rawInfo(e);if(null===r||r.deleted)return Promise.resolve(null);if(r.options&&r.options.link){const m=r.options.link.name||"";if(""===m)throw new Error("link is a bucket");return(yield dc.create(n.js,r.options.link.bucket)).get(m)}const i=an(),s={info:new qg(r),error:i};if(0===r.size)return s.data=function aL(){return new ReadableStream({pull(t){t.enqueue(new Uint8Array(0)),t.close()}})}(),i.resolve(null),Promise.resolve(s);let o;const a=Vs();a.orderedConsumer();const l=new CS,f=`$O.${n.name}.C.${r.nuid}`,p=yield n.js.subscribe(f,a);return Oe(function*(){var x,m=!1,E=!1;try{for(var de,j=Ns(p);m=!(de=yield j.next()).done;m=!1){const we=de.value;if(we.data.length>0&&(l.update(we.data),o.enqueue(we.data)),0===we.info.pending){const xe=l.digest("base64"),ye=xe.length%3,Me=ye>0?"=".repeat(ye):"",Ze=`${RS}${xe}${Me}`;Ze!==r.digest?o.error(new Error(`received a corrupt object, digests do not match received: ${r.digest} calculated ${Ze}`)):o.close(),p.unsubscribe()}}}catch(we){E=!0,x=we}finally{try{m&&null!=j.return&&(yield j.return())}finally{if(E)throw x}}})().then(()=>{i.resolve()}).catch(m=>{o.error(m),i.reject(m)}),s.data=new ReadableStream({start(m){o=m},cancel(){p.unsubscribe()}}),s})()}linkStore(e,n){if(!(n instanceof dc))return Promise.reject("bucket required");const r=n,{name:i,error:s}=this._sanitizeName(e);return s?Promise.reject(s):this._put({name:i,options:{link:{bucket:r.name}}},null)}link(e,n){var r=this;return Oe(function*(){if(n.deleted)return Promise.reject(new Error("object is deleted"));const{name:i,error:s}=r._sanitizeName(e);if(s)return Promise.reject(s);if(r.name===n.bucket){const l=Object.assign({},function oL(t){return{name:t.name,description:t.description,headers:t.headers,options:t.options}}(n));l.name=i;try{return yield r.update(n.name,l),yield r.info(i)}catch(f){return Promise.reject(f)}}return r._put({name:i,options:{link:{bucket:n.bucket,name:n.name}}},null)})()}delete(e){var n=this;return Oe(function*(){const r=yield n.rawInfo(e);if(null===r)return Promise.resolve({purged:0,success:!1});r.deleted=!0,r.size=0,r.chunks=0,r.digest="";const i=Gi(),s=ls();return s.set(ri.RollupHdr,ri.RollupValueSubject),yield n.js.publish(n._metaSubject(r.name),i.encode(r),{headers:s}),n.jsm.streams.purge(n.stream,{filter:n._chunkSubject(r.nuid)})})()}update(e,n={}){var r=this;return Oe(function*(){var f;const i=yield r.rawInfo(e);if(null===i)return Promise.reject(new Error("object not found"));if(i.deleted)return Promise.reject(new Error("cannot update meta for a deleted object"));n.name=null!=(f=n.name)?f:i.name;const{name:s,error:o}=r._sanitizeName(n.name);if(o)return Promise.reject(o);if(e!==n.name){const p=yield r.info(n.name);if(p&&!p.deleted)return Promise.reject(new Error("an object already exists with that name"))}n.name=s;const a=Object.assign({},i,OS(n)),l=Gi();return r.js.publish(r._metaSubject(a.name),l.encode(a))})()}watch(e={}){var n=this;return Oe(function*(){var f,p;e.includeHistory=null!=(f=e.includeHistory)&&f,e.ignoreDeletes=null!=(p=e.ignoreDeletes)&&p;let r=!1;const i=new Cr,s=n._metaSubjectAll();try{yield n.jsm.streams.getMessage(n.stream,{last_by_subj:s})}catch(m){"404"===m.code?(i.push(null),r=!0):i.stop(m)}const o=Gi(),a=Vs();a.orderedConsumer(),e.includeHistory?a.deliverLastPerSubject():(r=!0,a.deliverNew()),a.callback((m,E)=>{var x;if(m)i.stop(m);else if(null!==E){const j=o.decode(E.data);j.deleted&&!0===e.ignoreDeletes||i.push(j),0===(null==(x=E.info)?void 0:x.pending)&&!r&&(r=!0,i.push(null))}});const l=yield n.js.subscribe(s,a);return i._data=l,i.iterClosed.then(()=>{l.unsubscribe()}),l.closed.then(()=>{i.stop()}).catch(m=>{i.stop(m)}),i})()}_chunkSubject(e){return`$O.${this.name}.C.${e}`}_metaSubject(e){return`$O.${this.name}.M.${cc.encode(e)}`}_metaSubjectAll(){return`$O.${this.name}.M.>`}init(e={}){var n=this;return Oe(function*(){try{n.stream=function nL(t){return Md(t),`OBJ_${t}`}(n.name)}catch(i){return Promise.reject(i)}const r=Object.assign({},e);r.name=n.stream,r.allow_rollup_hdrs=!0,r.discard=Ta.New,r.subjects=[`$O.${n.name}.C.>`,`$O.${n.name}.M.>`],e.placement&&(r.placement=e.placement);try{yield n.jsm.streams.info(r.name)}catch(i){"stream not found"===i.message&&(yield n.jsm.streams.add(r))}})()}static create(e,n,r={}){return Oe(function*(){var m;if("function"!=typeof(null==(m=null==crypto?void 0:crypto.subtle)?void 0:m.digest))return Promise.reject(new Error("objectstore: unable to calculate hashes - crypto.subtle.digest with sha256 support is required"));const i=e,{ok:s,min:o}=i.nc.features.get(Ar.JS_OBJECTSTORE);if(!s)return Promise.reject(new Error(`objectstore is only supported on servers ${o} or better`));let a=i.opts||{};a=Object.assign(a,{timeout:a.timeout||2e3});const f=yield i.nc.jetstreamManager(a),p=new dc(n,f,e);return yield p.init(r),Promise.resolve(p)})()}}class uL{constructor(e){R(this,"js"),this.js=e}kv(e,n={}){return n.bindOnly?lc.bind(this.js,e):lc.create(this.js,e,n)}os(e,n={}){return vL(this.js.nc),dc.create(this.js,e,n)}}class Kg extends sc{constructor(e,n){super(e,n),R(this,"api"),this.api=new aS(e,n)}get apiPrefix(){return this.prefix}get views(){return new uL(this)}publish(e,n=ir,r){var i=this;return Oe(function*(){(r=r||{}).expect=r.expect||{};const s=(null==r?void 0:r.headers)||ls();r&&(r.msgID&&s.set(qs.MsgIdHdr,r.msgID),r.expect.lastMsgID&&s.set(qs.ExpectedLastMsgIdHdr,r.expect.lastMsgID),r.expect.streamName&&s.set(qs.ExpectedStreamHdr,r.expect.streamName),"number"==typeof r.expect.lastSequence&&s.set(qs.ExpectedLastSeqHdr,`${r.expect.lastSequence}`),"number"==typeof r.expect.lastSubjectSequence&&s.set(qs.ExpectedLastSubjectSequenceHdr,`${r.expect.lastSubjectSequence}`));const o=r.timeout||i.timeout,a={};o&&(a.timeout=o),r&&(a.headers=s);let p,{retries:l,retry_delay:f}=r;l=l||1,f=f||250;for(let E=0;E<l;E++)try{p=yield i.nc.request(e,n,a);break}catch(x){if(!("503"===x.code&&E+1<l))throw x;yield Tg(f)}const m=i.parseJsResponse(p);if(""===m.stream)throw We.errorForCode(Re.JetStreamInvalidAck);return m.duplicate=!!m.duplicate&&m.duplicate,m})()}pull(e,n,r=0){var i=this;return Oe(function*(){Dr(e),Pa(n);let s=i.timeout;r>s&&(s=r);const o={batch:1,no_wait:0===(r=r<0?0:jn(r)),expires:r},a=yield i.nc.request(`${i.prefix}.CONSUMER.MSG.NEXT.${e}.${n}`,i.jc.encode(o),{noMux:!0,timeout:s}),l=ka(a);if(l)throw l;return Cd(a)})()}fetch(e,n,r={}){var xe;Dr(e),Pa(n);let i=null;const s=(null!=(xe=r.max_bytes)?xe:0)>0;let o=0;const a=s?r.max_bytes:0;let l=null;const f={};if(f.batch=r.batch||1,a){const ye=this.nc.features.get(Ar.JS_PULL_MAX_BYTES);if(!ye.ok)throw new Error(`max_bytes is only supported on servers ${ye.min} or better`);f.max_bytes=a}f.no_wait=r.no_wait||!1,f.no_wait&&f.expires&&(f.expires=0);const p=r.expires||0;if(p&&(f.expires=jn(p)),0===p&&!1===f.no_wait)throw new Error("expires or no_wait is required");const m=r.idle_heartbeat||0;m&&(f.idle_heartbeat=jn(m),!0===r.delay_heartbeat&&(f.idle_heartbeat=jn(4*m)));const E=new Cr,x=f.batch;let j=0;E.protocolFilterFn=(ye,Me=!1)=>!iS(ye.msg)||(null==l||l.work(),!1),E.dispatchedFn=ye=>{if(ye){if(s&&(o+=ye.data.length),j++,i&&0===ye.info.pending)return;(1===E.getPending()&&0===ye.info.pending||x===j||a>0&&o>=a)&&E.stop()}};const de=Hs(this.nc.options.inboxPrefix),we=this.nc.subscribe(de,{max:r.batch,callback:(ye,Me)=>{null===ye&&(ye=ka(Me)),null!==ye?(i&&(i.cancel(),i=null),function hO(t){return"string"==typeof t.code}(ye)?E.stop(null===LS(ye)?void 0:ye):E.stop(ye)):(null==l||l.work(),E.received++,E.push(Cd(Me)))}});return p&&(i=bd(p),i.catch(()=>{we.isClosed()||(we.drain().catch(()=>{}),i=null),l&&l.cancel()})),Oe(function*(){try{m&&(l=new wS(m,ye=>(E.push(()=>{E.err=new We(`${Br.IdleHeartbeatMissed}: ${ye}`,Re.JetStreamIdleHeartBeat)}),!0)))}catch(ye){}yield we.closed,null!==i&&(i.cancel(),i=null),l&&l.cancel(),E.stop()})().catch(),this.nc.publish(`${this.prefix}.CONSUMER.MSG.NEXT.${e}.${n}`,this.jc.encode(f),{reply:de}),E}pullSubscribe(e,n=Vs()){var r=this;return Oe(function*(){const i=yield r._processOptions(e,n);if(i.ordered)throw new Error("pull subscribers cannot be be ordered");if(i.attached||(i.config.filter_subject=e),i.config.deliver_subject)throw new Error("consumer info specifies deliver_subject - pull consumers cannot have deliver_subject set");const s=i.config.ack_policy;if(s===Vn.None||s===Vn.All)throw new Error("ack policy for pull consumers must be explicit");const o=r._buildTypedSubscriptionOpts(i),a=new hL(r,i.deliver,o);a.info=i;try{yield r._maybeCreateConsumer(i)}catch(l){throw a.unsubscribe(),l}return a})()}subscribe(e,n=Vs()){var r=this;return Oe(function*(){const i=yield r._processOptions(e,n);if(!i.isBind&&!i.config.deliver_subject)throw new Error("push consumer requires deliver_subject");const s=r._buildTypedSubscriptionOpts(i),o=new NS(r,i.deliver,s);o.info=i;try{yield r._maybeCreateConsumer(i)}catch(a){throw o.unsubscribe(),a}return o._maybeSetupHbMonitoring(),o})()}_processOptions(e,n=Vs()){var r=this;return Oe(function*(){var s,o;const i=bS(n)?n.getOpts():n;if(i.isBind=!!bS(n)&&n.isBind,i.flow_control={heartbeat_count:0,fc_count:0,consumer_restarts:0},i.ordered){if(i.ordered_consumer_sequence={stream_seq:0,delivery_seq:0},i.config.ack_policy!==Vn.NotSet&&i.config.ack_policy!==Vn.None)throw new We("ordered consumer: ack_policy can only be set to 'none'",Re.ApiError);if(i.config.durable_name&&i.config.durable_name.length>0)throw new We("ordered consumer: durable_name cannot be set",Re.ApiError);if(i.config.deliver_subject&&i.config.deliver_subject.length>0)throw new We("ordered consumer: deliver_subject cannot be set",Re.ApiError);if(void 0!==i.config.max_deliver&&i.config.max_deliver>1)throw new We("ordered consumer: max_deliver cannot be set",Re.ApiError);if(i.config.deliver_group&&i.config.deliver_group.length>0)throw new We("ordered consumer: deliver_group cannot be set",Re.ApiError);i.config.deliver_subject=Hs(r.nc.options.inboxPrefix),i.config.ack_policy=Vn.None,i.config.max_deliver=1,i.config.flow_control=!0,i.config.idle_heartbeat=i.config.idle_heartbeat||jn(5e3),i.config.ack_wait=jn(792e5),i.config.mem_storage=!0,i.config.num_replicas=1}if(i.config.ack_policy===Vn.NotSet&&(i.config.ack_policy=Vn.All),i.api=r,i.config=i.config||{},i.stream=i.stream?i.stream:yield r.findStream(e),i.attached=!1,i.config.durable_name)try{const a=yield r.api.info(i.stream,i.config.durable_name);if(a){if(a.config.filter_subject&&a.config.filter_subject!==e)throw new Error("subject does not match consumer");const l=null!=(s=i.config.deliver_group)?s:"";if(""===l&&!0===a.push_bound)throw new Error("duplicate subscription");const f=null!=(o=a.config.deliver_group)?o:"";if(l!==f)throw""===f?new Error("durable requires no queue group"):new Error(`durable requires queue group '${f}'`);i.last=a,i.config=a.config,i.attached=!0,i.config.durable_name||(i.name=a.name)}}catch(a){if("404"!==a.code)throw a}return i.attached||(i.config.filter_subject=e),i.deliver=i.config.deliver_subject||Hs(r.nc.options.inboxPrefix),i})()}_buildTypedSubscriptionOpts(e){const n={};return n.adapter=function pL(t){return t?mL:gL}(void 0===e.callbackFn),n.ingestionFilterFn=Kg.ingestionFn(e.ordered),n.protocolFilterFn=(r,i=!1)=>{const s=r;return!Mg(s.msg)||(i||s.msg.respond(),!1)},!e.mack&&e.config.ack_policy!==Vn.None&&(n.dispatchedFn=yL),e.callbackFn&&(n.callback=e.callbackFn),n.max=e.max||0,n.queue=e.queue,n}_maybeCreateConsumer(e){var n=this;return Oe(function*(){if(e.attached)return;if(e.isBind)throw new Error(`unable to bind - durable consumer ${e.config.durable_name} doesn't exist in ${e.stream}`);e.config=Object.assign({deliver_policy:xr.All,ack_policy:Vn.Explicit,ack_wait:jn(3e4),replay_policy:ho.Instant},e.config);const r=yield n.api.add(e.stream,e.config);e.name=r.name,e.config=r.config,e.last=r})()}static ingestionFn(e){return(n,r)=>{var a;const i=r;if(!n)return{ingest:!1,protocol:!1};const s=n;if(ka(s.msg)||null==(a=i.monitor)||a.work(),iS(s.msg)){const l=!e||i._checkHbOrderConsumer(s.msg);return e||i.info.flow_control.heartbeat_count++,{ingest:l,protocol:!0}}return Mg(s.msg)?(i.info.flow_control.fc_count++,{ingest:!0,protocol:!0}):{ingest:!e||i._checkOrderedConsumer(n),protocol:!1}}}}class Gg{constructor(e){R(this,"options"),R(this,"protocol"),R(this,"draining"),R(this,"listeners"),R(this,"_services"),this.draining=!1,this.options=function JN(t){const e=`${Ig}:${dS()}`;if((t=t||{servers:[e]}).servers=t.servers||[],"string"==typeof t.servers&&(t.servers=[t.servers]),t.servers.length>0&&t.port)throw new We("port and servers options are mutually exclusive",Re.InvalidOption);0===t.servers.length&&t.port&&(t.servers=[`${Ig}:${t.port}`]),t.servers&&0===t.servers.length&&(t.servers=[e]);const n=vd({maxPingOut:2,maxReconnectAttempts:10,noRandomize:!1,pedantic:!1,pingInterval:12e4,reconnect:!0,reconnectJitter:100,reconnectJitterTLS:1e3,reconnectTimeWait:2e3,tls:void 0,verbose:!1,waitOnFirstConnect:!1,ignoreAuthErrorAbort:!1},t);if(t.user&&t.token||t.authenticator&&(t.token||t.user||t.pass))throw We.errorForCode(Re.BadAuthentication);if(n.authenticator=function BN(t){return t.authenticator?t.authenticator:t.token?function VN(t){return()=>({auth_token:"function"==typeof t?t():t})}(t.token):t.user?function HN(t,e){return()=>({user:"function"==typeof t?t():t,pass:"function"==typeof e?e():e})}(t.user,t.pass):()=>{}}(n),["reconnectDelayHandler","authenticator"].forEach(r=>{if(n[r]&&"function"!=typeof n[r])throw new We(`${r} option should be a function`,Re.NotFunction)}),n.reconnectDelayHandler||(n.reconnectDelayHandler=()=>{let r=n.tls?n.reconnectJitterTLS:n.reconnectJitter;return r&&(r++,r=Math.floor(Math.random()*r)),n.reconnectTimeWait+r}),n.inboxPrefix)try{Hs(n.inboxPrefix)}catch(r){throw new We(r.message,Re.ApiError)}if(n.resolve&&"function"!=typeof fS())throw new We("'resolve' is not supported on this client",Re.InvalidOption);return n}(e),this.listeners=[]}static connect(e={}){return new Promise((n,r)=>{const i=new Gg(e);Ad.connect(i.options,i).then(s=>{i.protocol=s,Oe(function*(){var l,o=!1,a=!1;try{for(var p,f=Ns(s.status());o=!(p=yield f.next()).done;o=!1){const m=p.value;i.listeners.forEach(E=>{E.push(m)})}}catch(m){a=!0,l=m}finally{try{o&&null!=f.return&&(yield f.return())}finally{if(a)throw l}}})(),n(i)}).catch(s=>{r(s)})})}closed(){return this.protocol.closed}close(){var e=this;return Oe(function*(){yield e.protocol.close()})()}_check(e,n,r){if(this.isClosed())throw We.errorForCode(Re.ConnectionClosed);if(n&&this.isDraining()||r&&this.protocol.noMorePublishing)throw We.errorForCode(Re.ConnectionDraining);if(0===(e=e||"").length)throw We.errorForCode(Re.BadSubject)}publish(e,n=ir,r){if(this._check(e,!1,!0),n&&!function vO(t){return t instanceof Uint8Array}(n))throw We.errorForCode(Re.BadPayload);this.protocol.publish(e,n,r)}subscribe(e,n={}){this._check(e,!0,!1);const r=new gS(this.protocol,e,n);return this.protocol.subscribe(r),r}_resub(e,n,r){this._check(n,!0,!1);const i=e;i.max=r,r&&(i.max=r+i.received),this.protocol.resub(i,n)}requestMany(e,n=ir,r={maxWait:1e3,maxMessages:-1}){try{this._check(e,!0,!0)}catch(a){return Promise.reject(a)}if(r.strategy=r.strategy||wi.Timer,r.maxWait=r.maxWait||1e3,r.maxWait<1)return Promise.reject(new We("timeout",Re.InvalidOption));const i=new Cr;function s(a){i.push(()=>{i.stop(a)})}function o(a,l){a||null===l?s(null===a?void 0:a):i.push(l)}if(r.noMux){const a=(new Error).stack;let l="number"==typeof r.maxMessages&&r.maxMessages>0?r.maxMessages:-1;const f=this.subscribe(Hs(this.options.inboxPrefix),{callback:(x,j)=>{var de,we;if(0===(null==(de=null==j?void 0:j.data)?void 0:de.length)&&(null==(we=null==j?void 0:j.headers)?void 0:we.status)===Re.NoResponders&&(x=We.errorForCode(Re.NoResponders)),x)return x.stack+=`\n\n${a}`,void p(x);o(null,j),r.strategy===wi.Count&&(l--,0===l&&p()),r.strategy===wi.JitterTimer&&(E(),m=setTimeout(()=>{p()},300)),r.strategy===wi.SentinelMsg&&j&&0===j.data.length&&p()}});f.closed.then(()=>{s()}).catch(x=>{i.stop(x)});const p=x=>{x&&i.push(()=>{throw x}),E(),f.drain().then(()=>{s()}).catch(j=>{s()})};i.iterClosed.then(()=>{E(),null==f||f.unsubscribe()}).catch(x=>{E(),null==f||f.unsubscribe()});try{this.publish(e,ir,{reply:f.getSubject()})}catch(x){p(x)}let m=setTimeout(()=>{p()},r.maxWait);const E=()=>{m&&clearTimeout(m)}}else{const a=r;a.callback=o,i.iterClosed.then(()=>{l.cancel()}).catch(f=>{l.cancel(f)});const l=new jO(this.protocol.muxSubscriptions,e,a);this.protocol.request(l);try{this.publish(e,n,{reply:`${this.protocol.muxSubscriptions.baseInbox}${l.token}`,headers:r.headers})}catch(f){l.cancel(f)}}return Promise.resolve(i)}request(e,n=ir,r={timeout:1e3,noMux:!1}){try{this._check(e,!0,!0)}catch(i){return Promise.reject(i)}if(r.timeout=r.timeout||1e3,r.timeout<1)return Promise.reject(new We("timeout",Re.InvalidOption));if(!r.noMux&&r.reply)return Promise.reject(new We("reply can only be used with noMux",Re.InvalidOption));if(r.noMux){const i=r.reply?r.reply:Hs(this.options.inboxPrefix),s=an(),o=new Error;return this.subscribe(i,{max:1,timeout:r.timeout,callback:(l,f)=>{l?(l.code!==Re.Timeout&&(l.stack+=`\n\n${o.stack}`),s.reject(l)):(l=eS(f))?(l.stack+=`\n\n${o.stack}`,s.reject(l)):s.resolve(f)}}).requestSubject=e,this.protocol.publish(e,n,{reply:i,headers:r.headers}),s}{const i=new cS(this.protocol.muxSubscriptions,e,r);this.protocol.request(i);try{this.publish(e,n,{reply:`${this.protocol.muxSubscriptions.baseInbox}${i.token}`,headers:r.headers})}catch(o){i.cancel(o)}const s=Promise.race([i.timer,i.deferred]);return s.catch(()=>{i.cancel()}),s}}flush(){return this.isClosed()?Promise.reject(We.errorForCode(Re.ConnectionClosed)):this.protocol.flush()}drain(){return this.isClosed()?Promise.reject(We.errorForCode(Re.ConnectionClosed)):this.isDraining()?Promise.reject(We.errorForCode(Re.ConnectionDraining)):(this.draining=!0,this.protocol.drain())}isClosed(){return this.protocol.isClosed()}isDraining(){return this.draining}getServer(){const e=this.protocol.getServer();return e?e.listen:""}status(){const e=new Cr;return this.listeners.push(e),e}get info(){return this.protocol.isClosed()?void 0:this.protocol.info}stats(){return{inBytes:this.protocol.inBytes,outBytes:this.protocol.outBytes,inMsgs:this.protocol.inMsgs,outMsgs:this.protocol.outMsgs}}jetstreamManager(e={}){var n=this;return Oe(function*(){const r=new sL(n,e);try{yield r.getAccountInfo()}catch(i){const s=i;throw s.code===Re.NoResponders&&(s.code=Re.JetStreamNotEnabled),s}return r})()}jetstream(e={}){return new Kg(this,e)}getServerVersion(){const e=this.info;return e?go(e.version):void 0}rtt(){var e=this;return Oe(function*(){if(!e.protocol._closed&&!e.protocol.connected)throw We.errorForCode(Re.Disconnect);const n=Date.now();return yield e.flush(),Date.now()-n})()}get features(){return this.protocol.features}get services(){return this._services||(this._services=new dL(this)),this._services}}class cL{constructor(e,n={strategy:wi.JitterTimer,maxWait:2e3},r){R(this,"nc"),R(this,"prefix"),R(this,"opts"),this.nc=e,this.prefix=r,this.opts=n}ping(e="",n=""){return this.q(Ei.PING,e,n)}stats(e="",n=""){return this.q(Ei.STATS,e,n)}schema(e="",n=""){return this.q(Ei.SCHEMA,e,n)}info(e="",n=""){return this.q(Ei.INFO,e,n)}q(e,n="",r=""){var i=this;return Oe(function*(){const s=new Cr,o=Gi(),a=ic.controlSubject(e,n,r,i.prefix),l=yield i.nc.requestMany(a,ir,i.opts);return Oe(function*(){var m,f=!1,p=!1;try{for(var x,E=Ns(l);f=!(x=yield E.next()).done;f=!1){const j=x.value;try{const de=o.decode(j.data);s.push(de)}catch(de){s.push(()=>{s.stop(de)})}}}catch(j){p=!0,m=j}finally{try{f&&null!=E.return&&(yield E.return())}finally{if(p)throw m}}s.push(()=>{s.stop()})})().catch(f=>{s.stop(f)}),s})()}}class dL{constructor(e){R(this,"nc"),this.nc=e,console.log("\x1b[33m >> service framework is beta functionality \x1b[0m")}add(e){try{return new ic(this.nc,e).start()}catch(n){return Promise.reject(n)}}client(e,n){return new cL(this.nc,e,n)}}class fL{constructor(e){if(R(this,"subject"),R(this,"seq"),R(this,"data"),R(this,"time"),R(this,"header"),this.subject=e.message.subject,this.seq=e.message.seq,this.time=new Date(Date.parse(e.message.time)),this.data=e.message.data?this._parse(e.message.data):ir,e.message.hdrs){const n=this._parse(e.message.hdrs);this.header=Us.decode(n)}else this.header=ls()}_parse(e){const n=atob(e),r=n.length,i=new Uint8Array(r);for(let s=0;s<r;s++)i[s]=n.charCodeAt(s);return i}}class NS extends KO{constructor(e,n,r){super(e.nc,n,r),R(this,"js"),R(this,"monitor"),this.js=e,this.monitor=null,this.sub.closed.then(()=>{this.monitor&&this.monitor.cancel()})}set info(e){this.sub.info=e}get info(){return this.sub.info}_resetOrderedConsumer(e){if(null===this.info||this.sub.isClosed())return;const n=Hs(this.js.nc.options.inboxPrefix);this.js.nc._resub(this.sub,n);const i=this.info;i.ordered_consumer_sequence.delivery_seq=0,i.flow_control.heartbeat_count=0,i.flow_control.fc_count=0,i.flow_control.consumer_restarts++,i.deliver=n,i.config.deliver_subject=n,i.config.deliver_policy=xr.StartSequence,i.config.opt_start_seq=e;const s={};s.stream_name=this.info.stream,s.config=i.config,this.js._request(`${i.api.prefix}.CONSUMER.CREATE.${i.stream}`,s).then(a=>{const l=a;this.info.config=l.config,this.info.name=l.name}).catch(a=>{const l=new We(`unable to recreate ordered consumer ${i.stream} at seq ${e}`,Re.RequestError,a);this.sub.callback(l,{})})}_maybeSetupHbMonitoring(){var n,r;const e=(null==(r=null==(n=this.info)?void 0:n.config)?void 0:r.idle_heartbeat)||0;e&&this._setupHbMonitoring(kg(e))}_setupHbMonitoring(e,n=0){const r={cancelAfter:0,maxOut:2};n&&(r.cancelAfter=n);const i=this.sub;this.monitor=new wS(e,o=>{var f,p,m;const a=function FO(t,e,n){const r=ls(t,e),s=new tS({hdr:1,sid:0,size:0},ir,{});return s._headers=r,s._subject=n,s}(409,`${Br.IdleHeartbeatMissed}: ${o}`,this.sub.subject);if(null==(f=this.info)?void 0:f.ordered){if(!this.js.nc.protocol.connected)return!1;const E=(null==(m=null==(p=this.info)?void 0:p.ordered_consumer_sequence)?void 0:m.stream_seq)||0;return this._resetOrderedConsumer(E+1),!1}return this.sub.callback(null,a),!i.noIterator},r)}_checkHbOrderConsumer(e){const n=e.headers.get(ri.ConsumerStalledHdr);""!==n&&this.js.nc.publish(n);const r=parseInt(e.headers.get(ri.LastConsumerSeqHdr),10),i=this.info.ordered_consumer_sequence;return this.info.flow_control.heartbeat_count++,r!==i.delivery_seq&&this._resetOrderedConsumer(i.stream_seq+1),!1}_checkOrderedConsumer(e){const n=this.info.ordered_consumer_sequence,r=e.info.streamSequence,i=e.info.deliverySequence;return i!=n.delivery_seq+1?(this._resetOrderedConsumer(n.stream_seq+1),!1):(n.delivery_seq=i,n.stream_seq=r,!0)}destroy(){var e=this;return Oe(function*(){e.isClosed()||(yield e.drain());const n=e.sub.info,i=`${n.api.prefix}.CONSUMER.DELETE.${n.stream}.${n.config.durable_name||n.name}`;yield n.api._request(i)})()}consumerInfo(){var e=this;return Oe(function*(){const n=e.sub.info,i=`${n.api.prefix}.CONSUMER.INFO.${n.stream}.${n.config.durable_name||n.name}`,s=yield n.api._request(i);return n.last=s,s})()}}class hL extends NS{constructor(e,n,r){super(e,n,r)}pull(e={batch:1}){var f,p;const{stream:n,config:r,name:i}=this.sub.info,s=null!=(f=r.durable_name)?f:i,o={};if(o.batch=e.batch||1,o.no_wait=e.no_wait||!1,(null!=(p=e.max_bytes)?p:0)>0){const m=this.js.nc.features.get(Ar.JS_PULL_MAX_BYTES);if(!m.ok)throw new Error(`max_bytes is only supported on servers ${m.min} or better`);o.max_bytes=e.max_bytes}let a=0;e.expires&&e.expires>0&&(a=e.expires,o.expires=jn(a));let l=0;if(e.idle_heartbeat&&e.idle_heartbeat>0&&(l=e.idle_heartbeat,o.idle_heartbeat=jn(l)),l&&0===a)throw new Error("idle_heartbeat requires expires");if(l>a)throw new Error("expires must be greater than idle_heartbeat");if(this.info){this.monitor&&this.monitor.cancel(),a&&l&&(this.monitor?this.monitor._change(l,a):this._setupHbMonitoring(l,a));const m=this.info.api,x=this.sub.subject;m.nc.publish(`${m.prefix}.CONSUMER.MSG.NEXT.${n}.${s}`,m.jc.encode(o),{reply:x})}}}function gL(t,e){return t||(t=ka(e))?[t,null]:[null,Cd(e)]}function mL(t,e){if(t)return[t,null];const n=ka(e);return null!==n?[LS(n),null]:[null,Cd(e)]}function LS(t){if(null!==t)switch(t.code){case Re.JetStream404NoMessages:case Re.JetStream408RequestTimeout:return null;case Re.JetStream409:return function TO(t){return t.code===Re.JetStream409&&void 0!==[Br.MaxBatchExceeded,Br.MaxExpiresExceeded,Br.MaxBytesExceeded,Br.MaxMessageSizeExceeded,Br.PushConsumer,Br.IdleHeartbeatMissed].find(n=>-1!==t.message.indexOf(n))}(t)?t:null;default:return t}return null}function yL(t){t&&t.ack()}const vL=(()=>{let t=!1;return e=>{var n;if(!t){t=!0;const{lang:r}=null==(n=null==e?void 0:e.protocol)?void 0:n.transport;console.log(r?`\x1b[33m >> jetstream's materialized views object store functionality in ${r} is beta functionality \x1b[0m`:"\x1b[33m >> jetstream's materialized views object store functionality is beta functionality \x1b[0m")}}})();class wL{constructor(){R(this,"version"),R(this,"lang"),R(this,"closeError"),R(this,"connected"),R(this,"done"),R(this,"socket"),R(this,"options"),R(this,"socketClosed"),R(this,"encrypted"),R(this,"peeked"),R(this,"yields"),R(this,"signal"),R(this,"closedNotification"),this.version="1.14.0",this.lang="nats.ws",this.connected=!1,this.done=!1,this.socketClosed=!1,this.encrypted=!1,this.peeked=!1,this.yields=[],this.signal=an(),this.closedNotification=an()}connect(e,n){var r=this;return Oe(function*(){const s=an();if(n.tls)return s.reject(new We("tls",Re.InvalidOption)),s;r.options=n;const o=e.src;if(n.wsFactory){const{socket:a,encrypted:l}=yield n.wsFactory(e.src,n);r.socket=a,r.encrypted=l}else r.encrypted=0===o.indexOf("wss://"),r.socket=new WebSocket(o);return r.socket.binaryType="arraybuffer",r.socket.onopen=()=>{},r.socket.onmessage=a=>{if(r.yields.push(new Uint8Array(a.data)),r.peeked)return void r.signal.resolve();const l=tc.concat(...r.yields),f=function bO(t){const e=function _O(t){for(let e=0;e<t.length;e++){const n=e+1;if(t.byteLength>n&&t[e]===mO&&t[n]===yO)return n+1}return 0}(t);if(e>0){const r=new Uint8Array(t).slice(0,e);return Si.decode(r)}return""}(l);if(""!==f){const p=dN.exec(f);if(!p)return n.debug&&console.error("!!!",_d(l)),void s.reject(new Error("unexpected response from server"));try{(function lL(t,e){const{proto:n,tls_required:r,tls_available:i}=t;if((void 0===n||n<1)&&e.noEcho)throw new We("noEcho",Re.ServerOptionNotAvailable);if(e.tls&&!r&&!i)throw new We("tls",Re.ServerOptionNotAvailable)})(JSON.parse(p[1]),r.options),r.peeked=!0,r.connected=!0,r.signal.resolve(),s.resolve()}catch(m){return void s.reject(m)}}},r.socket.onclose=a=>{let l;r.socketClosed=!0,r.done||(a.wasClean||(l=new Error(a.reason)),r._closed(l))},r.socket.onerror=a=>{const f=new We(a.message,Re.Unknown,new Error(a.error));s.reject(f)},s})()}disconnect(){this._closed(void 0,!0)}_closed(e,n=!0){var r=this;return Oe(function*(){if(r.connected&&!r.done){if(r.closeError=e,!e)for(;!r.socketClosed&&r.socket.bufferedAmount>0;)console.log(r.socket.bufferedAmount),yield Tg(100);r.done=!0;try{r.socket.close(e?1002:1e3,e?e.message:void 0)}catch(i){}n&&r.closedNotification.resolve(e)}})()}get isClosed(){return this.done}[Symbol.asyncIterator](){return this.iterate()}iterate(){var e=this;return Fg(function*(){for(;;){0===e.yields.length&&(yield pd(e.signal));const n=e.yields;e.yields=[];for(let r=0;r<n.length;r++)e.options.debug&&console.info(`> ${_d(n[r])}`),yield n[r];if(e.done)break;0===e.yields.length&&(n.length=0,e.yields=n,e.signal=an())}})()}isEncrypted(){return this.connected&&this.encrypted}send(e){if(!this.done)try{return this.socket.send(e.buffer),void(this.options.debug&&console.info(`< ${_d(e)}`))}catch(n){this.options.debug&&console.error(`!!! ${_d(e)}: ${n}`)}}close(e){return this._closed(e,!1)}closed(){return this.closedNotification}}function SL(t){/^(.*:\/\/)(.*)/.test(t)||(t=`https://${t}`);let n=new URL(t);const r=n.protocol.toLowerCase();let i,s;"https:"!==r&&"http"!==r&&(t=t.replace(/^(.*:\/\/)(.*)/gm,"$2"),n=new URL(`http://${t}`));const o=n.hostname,a=n.pathname,l=n.search||"";switch(r){case"http:":case"ws:":case"nats:":s=n.port||"80",i="ws:";break;default:s=n.port||"443",i="wss:"}return`${i}//${o}:${s}${a}${l}`}let jS=(()=>{class t{constructor(){this.nc=this.establishConnection(),this.sc=J1(),this._boardSubject=new Bt,this.board$=this._boardSubject.asObservable(),this._openGameSubject=new Bt,this.openGame$=this._openGameSubject.asObservable(),this._gameStatusSubject=new Bt,this.gameStatus$=this._gameStatusSubject.asObservable()}start(n){var r=this;this.nc.then(i=>{const s=i.subscribe(`games.${n}.moves.*`);Oe(function*(){var o,a;try{for(var f,l=Ag(s);!(f=yield l.next()).done;){const m=JSON.parse(r.sc.decode(f.value.data));r._boardSubject.next(m)}}catch(p){o={error:p}}finally{try{f&&!f.done&&(a=l.return)&&(yield a.call(l))}finally{if(o)throw o.error}}console.log("subscription closed")})()})}watchOpenGame(){var n=this;this.nc.then(r=>{const i=r.subscribe("game.*.open.*");Oe(function*(){var s,o;try{for(var l,a=Ag(i);!(l=yield a.next()).done;){const p=JSON.parse(n.sc.decode(l.value.data));n._openGameSubject.next(p)}}catch(f){s={error:f}}finally{try{l&&!l.done&&(o=a.return)&&(yield o.call(a))}finally{if(s)throw s.error}}console.log("subscription closed")})()})}watchGameStatus(){var n=this;this.nc.then(r=>{const i=r.subscribe("games.*.status");Oe(function*(){var s,o;try{for(var l,a=Ag(i);!(l=yield a.next()).done;){const p=JSON.parse(n.sc.decode(l.value.data));n._gameStatusSubject.next(p)}}catch(f){s={error:f}}finally{try{l&&!l.done&&(o=a.return)&&(yield o.call(a))}finally{if(s)throw s.error}}console.log("subscription closed")})()})}establishConnection(){return Oe(function*(){return yield function EL(t={}){return function GO(t){Ur=t}({defaultPort:443,urlParseFn:SL,factory:()=>new wL}),Gg.connect(t)}({servers:["wss://api.si4b.com/nats"]})})()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var xL=O(497);let yo=(()=>{class t{constructor(){this._loginChangedSubject=new Bt,this.loginChanged=this._loginChangedSubject.asObservable();const n=window.location.hostname;this._userManager=new xL.UserManager({authority:Er.stsAuthority,client_id:n,redirect_uri:`${Er.clientRoot}signin-callback`,scope:"openid profile",response_type:"code",post_logout_redirect_uri:`${Er.clientRoot}signout-callback`,automaticSilentRenew:!0,silent_redirect_uri:`${Er.clientRoot}assets/silent-callback.html`}),this._userManager.events.addAccessTokenExpired(i=>{this._loginChangedSubject.next(!1)})}login(){return this._userManager.signinRedirect()}isLoggedIn(){return this._userManager.getUser().then(n=>{const r=!!n&&!n.expired;return n!==this._user&&this._loginChangedSubject.next(r),this._user=n,r})}completeLogin(){return this._userManager.signinRedirectCallback().then(n=>(this._user=n,this._loginChangedSubject.next(!!n&&!n.expired),n))}logout(){this._userManager.signoutRedirect()}completeLogout(){return this._user=null,this._loginChangedSubject.next(!1),this._userManager.signoutRedirectCallback()}getAccessToken(){return this._userManager.getUser().then(n=>n&&!n.expired?n.access_token:null)}getIdToken(){return this._userManager.getUser().then(n=>n&&!n.expired?n.id_token:null)}getTokens(){return this._userManager.getUser().then(n=>n&&!n.expired?{accessToken:n.access_token,idToken:n.id_token}:null)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})();function zg(t){this.message=t}(zg.prototype=new Error).name="InvalidCharacterError";var BS="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new zg("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,s=0,o="";r=e.charAt(s++);~r&&(n=i%4?64*n+r:r,i++%4)?o+=String.fromCharCode(255&n>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o};function Od(t){this.message=t}(Od.prototype=new Error).name="InvalidTokenError";let Nd=(()=>{class t{constructor(){}decode(n){return function DL(t,e){if("string"!=typeof t)throw new Od("Invalid token specified");var n=!0===(e=e||{}).header?0:1;try{return JSON.parse(function CL(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(BS(e).replace(/(.)/g,function(r,i){var s=i.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}catch(n){return BS(e)}}(t.split(".")[n]))}catch(r){throw new Od("Invalid token specified: "+r.message)}}(n)}resourceDomain(n){const r=this.decode(n).aud;return Array.isArray(r)?r[0]:r}userId(n){return this.decode(n).sub}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),FL=(()=>{class t{constructor(n,r,i,s,o){this._route=n,this._gameService=r,this._natsService=i,this._authService=s,this._jwtService=o,this.klass=!0,this.game={},this.userId="",this.gameId=0}ngOnInit(){this._route.queryParams.subscribe(n=>{this.gameId=n.gameId,setTimeout(()=>this.setupGame(),500)})}ngOnDestroy(){this._bdSubscription&&this._bdSubscription.unsubscribe()}onCellClick(n){this.game[n]||this.makeMove(n)}makeMove(n){const i=this._gameService.makeMove(this.gameId,{coordinate:n});this._moveSubscription=i.subscribe({error:s=>console.error(s),complete:()=>this._moveSubscription.unsubscribe()})}get state(){return this.isOpponentMissing?"Wait for opponent to join...":"tie"===this.game.state?"Tie game!":"in_progress"!==this.game.state?`${this.winner} won the game!`:this.playerName}get isOpponentMissing(){return!this.game.x_player_id||!this.game.o_player_id}get playerName(){var n,r;const i=null===(n=this.game.x_player_id)||void 0===n?void 0:n.toString(),s=null===(r=this.game.o_player_id)||void 0===r?void 0:r.toString();return this.isX&&i===this.userId?"(X) Your turn!":this.isO&&s===this.userId?"(O) Your turn!":this.isX?`(X) ${this.xPlayer}'s turn...`:this.isO?`(O) ${this.oPlayer}'s turn...`:""}get isX(){return"X"===this.game.next_turn}get isO(){return"O"===this.game.next_turn}get winner(){return"x_won"===this.game.state?"X"===this.piceces?"You":this.xPlayer:"o_won"===this.game.state?"O"===this.piceces?"You":this.oPlayer:""}get xPlayer(){return"Human"===this.game.x_player_type?this.game.x_player_name||"":this.game.x_player_type||""}get oPlayer(){return"Human"===this.game.o_player_type?this.game.o_player_name||"":this.game.o_player_type||""}setupGame(){this._authService.getIdToken().then(n=>{if(!n)return;this._bdSubscription=this._natsService.board$.subscribe({next:s=>this.game=s}),this._natsService.start(this.gameId);const i=this._gameService.getGame(this.gameId);this._gameSubscription=i.subscribe({next:s=>{var o,a;this.userId=this._jwtService.userId(n);const l=null===(o=s.x_player_id)||void 0===o?void 0:o.toString(),f=null===(a=s.o_player_id)||void 0===a?void 0:a.toString();l===this.userId?this.piceces="X":f===this.userId&&(this.piceces="O"),this.game=s},error:s=>console.error(s)})})}}return t.\u0275fac=function(n){return new(n||t)(He(co),He(Cg),He(jS),He(yo),He(Nd))},t.\u0275cmp=_r({type:t,selectors:[["app-board"]],hostVars:2,hostBindings:function(n,r){2&n&&Fs("board-page",r.klass)},decls:21,vars:10,consts:[[1,"state"],[1,"board"],[1,"cell",3,"click"]],template:function(n,r){1&n&&(pt(0,"div",0),Xt(1),gt(),pt(2,"div",1),pt(3,"div",2),tn("click",function(){return r.onCellClick("a1")}),Xt(4),gt(),pt(5,"div",2),tn("click",function(){return r.onCellClick("a2")}),Xt(6),gt(),pt(7,"div",2),tn("click",function(){return r.onCellClick("a3")}),Xt(8),gt(),pt(9,"div",2),tn("click",function(){return r.onCellClick("b1")}),Xt(10),gt(),pt(11,"div",2),tn("click",function(){return r.onCellClick("b2")}),Xt(12),gt(),pt(13,"div",2),tn("click",function(){return r.onCellClick("b3")}),Xt(14),gt(),pt(15,"div",2),tn("click",function(){return r.onCellClick("c1")}),Xt(16),gt(),pt(17,"div",2),tn("click",function(){return r.onCellClick("c2")}),Xt(18),gt(),pt(19,"div",2),tn("click",function(){return r.onCellClick("c3")}),Xt(20),gt(),gt()),2&n&&(Wt(1),zn(r.state),Wt(3),zn(r.game.a1),Wt(2),zn(r.game.a2),Wt(2),zn(r.game.a3),Wt(2),zn(r.game.b1),Wt(2),zn(r.game.b2),Wt(2),zn(r.game.b3),Wt(2),zn(r.game.c1),Wt(2),zn(r.game.c2),Wt(2),zn(r.game.c3))},styles:[".board-page .board{display:grid;grid-template-columns:1fr 1fr 1fr;width:300px}.board-page .board .cell{display:flex;height:98px;background-color:#d3d3d3;justify-content:center;align-items:center;border:solid 1px black;cursor:pointer}.board-page .state{font-size:24px;margin-top:29px;color:#fff}\n"],encapsulation:2}),t})(),US=(()=>{class t{constructor(){this.label="",this.onClick=new Dn}get klass(){let n=["button"];return this.styleModifier&&n.push(this.styleModifier),n}onClk(n){"disabled"!==this.styleModifier&&this.onClick.emit()}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_r({type:t,selectors:[["atoms-button"]],hostVars:2,hostBindings:function(n,r){1&n&&tn("click",function(s){return r.onClk(s.target)}),2&n&&Bh(r.klass)},inputs:{styleModifier:"styleModifier",label:"label"},outputs:{onClick:"onClick"},decls:1,vars:1,template:function(n,r){1&n&&Xt(0),2&n&&vl("",r.label,"\n")},styles:[".button{display:block;background-color:#f26d33;color:#fff;border:1px solid #F26D33!important;border-radius:5px!important;font-size:14px!important;font-weight:600!important;min-width:-moz-fit-content;min-width:fit-content;padding:13px 30px 11px;text-decoration:none;cursor:pointer}.button.disabled{opacity:50%}\n"],encapsulation:2}),t})(),IL=(()=>{class t{constructor(){this.klass=!0,this.game={},this.onAction=new Dn}ngOnInit(){}playerName(n,r){return n?"Human"===n?r||"":n:""}get state(){return this.game&&"ongoing"===this.game.state||"joined"===this.game.state?"Ongoing":this.game&&"closed"===this.game.state?"Closed":"Open"}get player1(){return this.game.x_player_id?this.playerName(this.game.x_player_type,this.game.x_player_name):this.game.o_player_id?this.playerName(this.game.o_player_type,this.game.o_player_name):""}get player2(){return this.game.x_player_id&&this.game.o_player_id?this.playerName(this.game.o_player_type,this.game.o_player_name):""}get joinButtonStyle(){return this.isMyGame||"Open"!==this.state?"disabled":void 0}get viewButtonStyle(){if("Ongoing"!==this.state&&!this.isMyGame)return"disabled"}get isMyGame(){var n,r;const i=null===(n=this.game.x_player_id)||void 0===n?void 0:n.toString(),s=null===(r=this.game.o_player_id)||void 0===r?void 0:r.toString();return i===this.userId||s===this.userId}onJoinClick(){this.onAction.emit("join")}onViewClick(){this.onAction.emit("view")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_r({type:t,selectors:[["molecules-game-list-item"]],hostVars:2,hostBindings:function(n,r){2&n&&Fs("game-list-item",r.klass)},inputs:{game:"game",userId:"userId"},outputs:{onAction:"onAction"},decls:9,vars:5,consts:[[1,"container"],["label","Join",3,"styleModifier","onClick"],["label","View",3,"styleModifier","onClick"]],template:function(n,r){1&n&&(pt(0,"div"),Xt(1),gt(),pt(2,"div"),Xt(3),gt(),pt(4,"div"),Xt(5),gt(),pt(6,"div",0),pt(7,"atoms-button",1),tn("onClick",function(){return r.onJoinClick()}),gt(),pt(8,"atoms-button",2),tn("onClick",function(){return r.onViewClick()}),gt(),gt()),2&n&&(Wt(1),zn(r.player1),Wt(2),zn(r.player2),Wt(2),zn(r.state),Wt(2),Or("styleModifier",r.joinButtonStyle),Wt(1),Or("styleModifier",r.viewButtonStyle))},directives:[US],styles:[".game-list-item{display:grid;grid-template-columns:5fr 5fr 4fr 1fr;height:52px;justify-items:baseline;padding:12px 15px;color:#fff;background-color:#c61e1e99;font-size:15px;border:2px solid ivory;border-radius:15px 15px 51px;font-weight:600;grid-gap:10px;gap:10px}.game-list-item .container{display:flex;font-size:12px;height:20px;gap:6px}.game-list-item .button{font-size:11px!important;padding:2px 10px}.game-list-item .disabled{opacity:50%}@media (max-width: 480px){.game-list-item{font-size:11px}}@media (max-width: 414px){.game-list-item{height:44px;padding:10px 14px;font-size:10px}.game-list-item container{gap:4px}.game-list-item .button{font-size:8px!important;padding:4px 10px}}\n"],encapsulation:2}),t})();function TL(t,e){if(1&t){const n=gl();hl(0),pt(1,"molecules-game-list-item",4),tn("onAction",function(i){const o=Mc(n).$implicit;return Eu().onActionEvent(i,o.id)}),gt(),pl()}if(2&t){const n=e.$implicit,r=Eu();Wt(1),Or("game",n)("userId",r.userId)}}let PL=(()=>{class t{constructor(){this.klasses=["panel","game-list-panel"],this.games=[],this.onAction=new Dn,this.onNewGame=new Dn}ngOnInit(){}onActionEvent(n,r){this.onAction.emit({action:n,gameId:r})}onNewGameClick(){this.onNewGame.emit()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_r({type:t,selectors:[["organisms-game-list-panel"]],hostVars:2,hostBindings:function(n,r){2&n&&Bh(r.klasses)},inputs:{games:"games",userId:"userId"},outputs:{onAction:"onAction",onNewGame:"onNewGame"},decls:5,vars:1,consts:[[1,"header"],[1,"list"],[4,"ngFor","ngForOf"],["label","New Game","styleModifier","create",3,"onClick"],[3,"game","userId","onAction"]],template:function(n,r){1&n&&(pt(0,"div",0),Xt(1,"Join Game"),gt(),pt(2,"div",1),fa(3,TL,2,2,"ng-container",2),gt(),pt(4,"atoms-button",3),tn("onClick",function(){return r.onNewGameClick()}),gt()),2&n&&(Wt(3),Or("ngForOf",r.games))},directives:[Op,IL,US],styles:[".panel{cursor:default;color:#2a5350;background-color:fff;border-radius:10px;box-shadow:#959da533 0 2px 6px;font-family:sans-serif;width:100%;padding:16px}.panel .panel-header{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:16px;min-height:40px}.panel .panel-header .left-side .title{font-size:18px;font-weight:400}.panel .panel-header .left-side counter{font-weight:700}.panel .panel-header .action{font-size:14px;font-weight:700;color:#f26d33}.game-list-panel{display:flex;flex-direction:column;align-items:center;background-color:#eeebe0;padding:20px 50px;text-align:center;border:1px solid #1C2F2F;max-width:665px}.game-list-panel .header{font-size:24px;font-weight:600;margin-bottom:10px}.game-list-panel .list{display:flex;flex-direction:column;gap:12px;background-color:#1c2f2f;padding:20px 12px;border-radius:10px;height:566px;overflow:auto}.game-list-panel .create{width:120px;margin:15px auto auto;font-size:18px!important;padding:10px 30px}@media (max-width: 480px){.game-list-panel{padding:20px 17px}}\n"],encapsulation:2}),t})(),kL=(()=>{class t{constructor(n,r,i,s,o){this._gameService=n,this._router=r,this._natsService=i,this._authService=s,this._jwtService=o,this.klass=!0,this.games=[]}ngOnInit(){const n=this._gameService.getGames();this._gameSubscription=n.subscribe({next:r=>this.setupGames(r),error:r=>console.error(r)})}ngOnDestroy(){this._gameSubscription&&this._gameSubscription.unsubscribe(),this._openGameSubscription&&this._openGameSubscription.unsubscribe(),this._gameStatusSubscription&&this._gameStatusSubscription.unsubscribe()}onAction(n){"join"===n.action?this.joinGame(n.gameId):"view"===n.action&&this.viewGame(n.gameId)}setupGames(n){this._authService.getIdToken().then(r=>{r&&(this.userId=this._jwtService.userId(r),this.games=n,this._openGameSubscription=this._natsService.openGame$.subscribe({next:o=>this.games.unshift(o)}),this._gameStatusSubscription=this._natsService.gameStatus$.subscribe({next:o=>{const a=this.games.find(l=>l.id===o.id);!a||(a.state=o.state,"joined"===o.state&&(a.x_player_id=o.x_player_id,a.x_player_type=o.x_player_type,a.x_player_name=o.x_player_name,a.o_player_id=o.o_player_id,a.o_player_type=o.o_player_type,a.o_player_name=o.o_player_name))}}),this._natsService.watchOpenGame(),this._natsService.watchGameStatus())})}joinGame(n){const i=this._gameService.join(n).subscribe({next:()=>{this._router.navigate(["/board"],{queryParams:{gameId:n}})},error:s=>console.error(s),complete:()=>i.unsubscribe()})}viewGame(n){this._router.navigate(["/board"],{queryParams:{gameId:n}})}onCreateGame(){this._router.navigate(["/new-game"])}}return t.\u0275fac=function(n){return new(n||t)(He(Cg),He(Jn),He(jS),He(yo),He(Nd))},t.\u0275cmp=_r({type:t,selectors:[["lobby"]],hostVars:2,hostBindings:function(n,r){2&n&&Fs("body",r.klass)},decls:1,vars:2,consts:[[3,"games","userId","onAction","onNewGame"]],template:function(n,r){1&n&&(pt(0,"organisms-game-list-panel",0),tn("onAction",function(s){return r.onAction(s)})("onNewGame",function(){return r.onCreateGame()}),gt()),2&n&&Or("games",r.games)("userId",r.userId)},directives:[PL],styles:[".page-template .game-list-panel{justify-self:center;max-height:710px}\n"],encapsulation:2}),t})(),ML=(()=>{class t{constructor(n){this._httpClient=n,this._httpOptions={headers:new ti({"Content-Type":"application/json"})}}getUsers(){return this._httpClient.get(`${Er.resourceRootDomain}/users`,this._httpOptions)}getPlayerTypes(){return this._httpClient.get(`${Er.resourceRootDomain}/player_types`,this._httpOptions)}}return t.\u0275fac=function(n){return new(n||t)(Qe(Qp))},t.\u0275prov=ze({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function RL(t,e){if(1&t&&(hl(0),pt(1,"option",3),Xt(2),gt(),pl()),2&t){const n=e.$implicit;Wt(1),Lh("value",n.id),Wt(1),zn(n.name)}}const OL=[{path:"",redirectTo:"/lobby",pathMatch:"full"},{path:"signin-callback",component:(()=>{class t{constructor(n,r){this._authService=n,this._router=r}ngOnInit(){this._authService.completeLogin().then(n=>{this._router.navigate(["/"],{replaceUrl:!0})})}}return t.\u0275fac=function(n){return new(n||t)(He(yo),He(Jn))},t.\u0275cmp=_r({type:t,selectors:[["app-signin-callback"]],decls:1,vars:0,template:function(n,r){1&n&&Hi(0,"div")},encapsulation:2}),t})()},{path:"signout-callback",component:(()=>{class t{constructor(n,r){this._authService=n,this._router=r}ngOnInit(){this._authService.completeLogout().then(n=>{this._router.navigate(["/"],{replaceUrl:!0})})}}return t.\u0275fac=function(n){return new(n||t)(He(yo),He(Jn))},t.\u0275cmp=_r({type:t,selectors:[["app-signout-callback"]],decls:1,vars:0,template:function(n,r){1&n&&Hi(0,"div")},encapsulation:2}),t})()},{path:"lobby",component:kL},{path:"new-game",component:(()=>{class t{constructor(n,r,i){this._userService=n,this._gameService=r,this._router=i,this.klass=!0,this.playerTypes=[]}ngOnInit(){const n=this._userService.getPlayerTypes();this._playerTypesSubscription=n.subscribe({next:r=>{this.playerTypes=r,this.playerTypes.unshift({name:"Select Opponent Type..."})},error:r=>console.error(r)})}ngOnDestroy(){this._playerTypesSubscription&&this._playerTypesSubscription.unsubscribe()}onOpponentChange(n){const r=n.target.value;this.opponentType=this.playerTypes.find(i=>i.id===+r)}onCreateGame(){if(this.opponentType){const n=this._gameService.create({opponent_type:this.opponentType.name});this._gameSubscription=n.subscribe({next:r=>{this._router.navigate(["/board"],{queryParams:{gameId:r.id}})},error:r=>console.error(r),complete:()=>this._gameSubscription.unsubscribe()})}}}return t.\u0275fac=function(n){return new(n||t)(He(ML),He(Cg),He(Jn))},t.\u0275cmp=_r({type:t,selectors:[["new-game"]],hostVars:2,hostBindings:function(n,r){2&n&&Fs("new-game",r.klass)},decls:4,vars:2,consts:[[3,"change"],[4,"ngFor","ngForOf"],[1,"button",3,"disabled","click"],[3,"value"]],template:function(n,r){1&n&&(pt(0,"select",0),tn("change",function(s){return r.onOpponentChange(s)}),fa(1,RL,3,2,"ng-container",1),gt(),pt(2,"button",2),tn("click",function(){return r.onCreateGame()}),Xt(3,"Start Game"),gt()),2&n&&(Wt(1),Or("ngForOf",r.playerTypes),Wt(1),Or("disabled",!r.opponentType))},directives:[Op],styles:[".new-game{display:flex;flex-direction:column;gap:20px;width:300px}.new-game select,.new-game .button{cursor:pointer}\n"],encapsulation:2}),t})()},{path:"board",component:FL}];let NL=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({imports:[[O1.forRoot(OL)],O1]}),t})();function LL(t,e){if(1&t){const n=gl();pt(0,"button",10),tn("click",function(){return Mc(n),Eu().onLoginClick()}),Xt(1,"Sign In"),gt()}}function jL(t,e){if(1&t){const n=gl();pt(0,"button",10),tn("click",function(){return Mc(n),Eu().onLogoutClick()}),Xt(1,"Sign Out"),gt()}}function BL(t,e){1&t&&Hi(0,"img",11)}let UL=(()=>{class t{constructor(){this.isLoggedIn=!1,this.onLogin=new Dn,this.klass=!0,this.amount=120}ngOnInit(){}onLoginClick(){this.onLogin.emit(!0)}onLogoutClick(){this.onLogin.emit(!1)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_r({type:t,selectors:[["atoms-header"]],hostVars:2,hostBindings:function(n,r){2&n&&Fs("menu-header",r.klass)},inputs:{isLoggedIn:"isLoggedIn"},outputs:{onLogin:"onLogin"},decls:20,vars:4,consts:[["id","container"],[1,"dropdown"],["id","tic-tac-toe-img","src","../../assets/tic-tac-toe.png"],[1,"dropdown-content"],["id","separator"],[1,"title"],[3,"click",4,"ngIf"],["id","user-icon","src","../../assets/user.png",4,"ngIf"],[1,"amount"],["id","coin-icon","src","../../assets/coin-icon.png"],[3,"click"],["id","user-icon","src","../../assets/user.png"]],template:function(n,r){1&n&&(pt(0,"div",0),pt(1,"div",1),Hi(2,"img",2),pt(3,"div",3),pt(4,"a"),Xt(5,"Lobby"),gt(),pt(6,"a"),Xt(7,"Tournament"),gt(),pt(8,"a"),Xt(9,"Tournament Schedules"),gt(),gt(),gt(),Hi(10,"div",4),pt(11,"div",5),Xt(12,"Tic Tac Toe"),gt(),gt(),pt(13,"div",0),fa(14,LL,2,0,"button",6),fa(15,jL,2,0,"button",6),fa(16,BL,1,0,"img",7),pt(17,"div",8),Xt(18),gt(),Hi(19,"img",9),gt()),2&n&&(Wt(14),Or("ngIf",!r.isLoggedIn),Wt(1),Or("ngIf",r.isLoggedIn),Wt(1),Or("ngIf",r.isLoggedIn),Wt(2),zn(r.amount))},directives:[iw],styles:[".menu-header{display:flex;align-content:center;background-color:#2f4f4f;height:50px;justify-content:space-between;padding-right:16px;font-weight:600}.menu-header .dropdown #tic-tac-toe-img{width:40px;height:40px;margin:5px 0}.menu-header .dropdown .dropdown-content{display:none;flex-direction:column;background-color:#2f4f4f;box-shadow:0 8px 16px;width:500px;position:absolute;top:50px;font-weight:600;font-size:larger}.menu-header .dropdown .dropdown-content a{padding:15px;color:ivory}.menu-header .dropdown .dropdown-content a:hover{background-color:ivory;color:#2f4f4f}.menu-header .dropdown:hover .dropdown-content{display:flex}.menu-header #separator{border-right:5px solid #FCFCDD;padding-left:8px;margin-right:40px}.menu-header #container{display:flex}.menu-header #user-icon{width:33;height:33;margin:9px 13px 9px 0}.menu-header #coin-icon{width:14px;height:14px;margin:18px 0}.menu-header .title{color:ivory;font-size:29px;margin:auto}.menu-header .amount{margin:auto 3px auto auto;font-size:13px;color:#fff}@media (max-width: 414px){.menu-header #separator{margin-right:20px}.menu-header .title{font-size:24px}}\n"],encapsulation:2}),t})();const HL=["*"];let VL=(()=>{class t{constructor(n){this._authService=n,this.klass=!0,this.isLoggedIn=!1,this._authService.loginChanged.subscribe(r=>{this.isLoggedIn=r})}ngOnInit(){this._authService.isLoggedIn().then(n=>{this.isLoggedIn=n})}loginOrLogout(n){n?this._authService.login():this._authService.logout()}}return t.\u0275fac=function(n){return new(n||t)(He(yo))},t.\u0275cmp=_r({type:t,selectors:[["templates-page-template"]],hostVars:2,hostBindings:function(n,r){2&n&&Fs("page-template",r.klass)},ngContentSelectors:HL,decls:3,vars:1,consts:[[3,"isLoggedIn","onLogin"],["id","footer"]],template:function(n,r){1&n&&(function mv(t){const e=Pe()[16][6];if(!e.projection){const r=e.projection=ou(t?t.length:1,null),i=r.slice();let s=e.child;for(;null!==s;){const o=t?TA(s,t):0;null!==o&&(i[o]?i[o].projectionNext=s:r[o]=s,i[o]=s),s=s.next}}}(),pt(0,"atoms-header",0),tn("onLogin",function(s){return r.loginOrLogout(s)}),gt(),function yv(t,e=0,n){const r=Pe(),i=Tt(),s=Qo(i,20+t,16,null,n||null);null===s.projection&&(s.projection=e),hf(),64!=(64&s.flags)&&function IC(t,e,n){V0(e[11],0,e,n,k0(t,n,e),N0(n.parent||e[6],n,e))}(i,r,s)}(1),Hi(2,"div",1)),2&n&&Or("isLoggedIn",r.isLoggedIn)},directives:[UL],styles:[".page-template{display:block;background-image:url(background.cb6155ea1d1d9a4d.svg);background-repeat:no-repeat;background-size:250%;background-color:#f6f6f2}.page-template .body{padding:56px 0;display:grid;height:100vh}.page-template #footer{height:52px;background-color:#2f4f4f}\n"],encapsulation:2}),t})(),$L=(()=>{class t{constructor(){this.title="tic-tac-toe-v2-front-end"}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_r({type:t,selectors:[["app-root"]],decls:2,vars:0,consts:[["amount","200"]],template:function(n,r){1&n&&(pt(0,"templates-page-template",0),Hi(1,"router-outlet"),gt())},directives:[VL,mg],styles:[""]}),t})(),KL=(()=>{class t{constructor(n,r){this._authService=n,this._jwtService=r}intercept(n,r){return n.url.startsWith(Er.resourceRootDomain)?bn(this._authService.getTokens().then(i=>{if(i){const s=(new ti).set("Authorization",`Bearer ${i.accessToken}`);s.set("Content-Type","application/json");const o=this._jwtService.resourceDomain(i.idToken),a=n.url.replace(Er.resourceRootDomain,o+Er.resourceApiRoot),l=n.clone({headers:s,url:a});return function qL(t,e){const n="object"==typeof e;return new Promise((r,i)=>{let o,s=!1;t.subscribe({next:a=>{o=a,s=!0},error:i,complete:()=>{s?r(o):n?r(e.defaultValue):i(new Hu)}})})}(r.handle(l))}throw new Jp({error:"Tokens invalid or expired!",headers:n.headers,status:419,statusText:"Error",url:n.url})})):r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(Qe(yo),Qe(Nd))},t.\u0275prov=ze({token:t,factory:t.\u0275fac}),t})(),GL=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=ki({type:t}),t.\u0275inj=Lt({providers:[yo,Nd,{provide:Zp,useClass:KL,multi:!0}],imports:[[]]}),t})(),zL=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=ki({type:t,bootstrap:[$L]}),t.\u0275inj=Lt({providers:[],imports:[[mk,NL,Uk,GL]]}),t})();(function G2(){Tb=!1})(),pk().bootstrapModule(zL).catch(t=>console.error(t))},497:function(ai){ai.exports=function(qe){var O={};function ne(Z){if(O[Z])return O[Z].exports;var C=O[Z]={i:Z,l:!1,exports:{}};return qe[Z].call(C.exports,C,C.exports,ne),C.l=!0,C.exports}return ne.m=qe,ne.c=O,ne.d=function(Z,C,Q){ne.o(Z,C)||Object.defineProperty(Z,C,{enumerable:!0,get:Q})},ne.r=function(Z){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Z,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Z,"__esModule",{value:!0})},ne.t=function(Z,C){if(1&C&&(Z=ne(Z)),8&C||4&C&&"object"==typeof Z&&Z&&Z.__esModule)return Z;var Q=Object.create(null);if(ne.r(Q),Object.defineProperty(Q,"default",{enumerable:!0,value:Z}),2&C&&"string"!=typeof Z)for(var M in Z)ne.d(Q,M,function(_){return Z[_]}.bind(null,M));return Q},ne.n=function(Z){var C=Z&&Z.__esModule?function(){return Z.default}:function(){return Z};return ne.d(C,"a",C),C},ne.o=function(Z,C){return Object.prototype.hasOwnProperty.call(Z,C)},ne.p="",ne(ne.s=22)}([function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0});var Z=function(){function _(b,v){for(var T=0;T<v.length;T++){var G=v[T];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(b,G.key,G)}}return function(b,v,T){return v&&_(b.prototype,v),T&&_(b,T),b}}(),C={debug:function(){},info:function(){},warn:function(){},error:function(){}},Q=void 0,M=void 0;(O.Log=function(){function _(){!function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}(this,_)}return _.reset=function(){M=3,Q=C},_.debug=function(){if(M>=4){for(var v=arguments.length,T=Array(v),G=0;G<v;G++)T[G]=arguments[G];Q.debug.apply(Q,Array.from(T))}},_.info=function(){if(M>=3){for(var v=arguments.length,T=Array(v),G=0;G<v;G++)T[G]=arguments[G];Q.info.apply(Q,Array.from(T))}},_.warn=function(){if(M>=2){for(var v=arguments.length,T=Array(v),G=0;G<v;G++)T[G]=arguments[G];Q.warn.apply(Q,Array.from(T))}},_.error=function(){if(M>=1){for(var v=arguments.length,T=Array(v),G=0;G<v;G++)T[G]=arguments[G];Q.error.apply(Q,Array.from(T))}},Z(_,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return M},set:function(v){if(!(0<=v&&v<=4))throw new Error("Invalid log level");M=v}},{key:"logger",get:function(){return Q},set:function(v){if(!v.debug&&v.info&&(v.debug=v.info),!(v.debug&&v.info&&v.warn&&v.error))throw new Error("Invalid logger");Q=v}}]),_}()).reset()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0});var Z=function(){function _(b,v){for(var T=0;T<v.length;T++){var G=v[T];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(b,G.key,G)}}return function(b,v,T){return v&&_(b.prototype,v),T&&_(b,T),b}}(),C={setInterval:function(_){function b(v,T){return _.apply(this,arguments)}return b.toString=function(){return _.toString()},b}(function(_,b){return setInterval(_,b)}),clearInterval:function(_){function b(v){return _.apply(this,arguments)}return b.toString=function(){return _.toString()},b}(function(_){return clearInterval(_)})},Q=!1,M=null;O.Global=function(){function _(){!function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}(this,_)}return _._testing=function(){Q=!0},_.setXMLHttpRequest=function(v){M=v},Z(_,null,[{key:"location",get:function(){if(!Q)return location}},{key:"localStorage",get:function(){if(!Q&&"undefined"!=typeof window)return localStorage}},{key:"sessionStorage",get:function(){if(!Q&&"undefined"!=typeof window)return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!Q&&"undefined"!=typeof window)return M||XMLHttpRequest}},{key:"timer",get:function(){if(!Q)return C}}]),_}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.MetadataService=void 0;var Z=function(){function b(v,T){for(var G=0;G<T.length;G++){var V=T[G];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(v,V.key,V)}}return function(v,T,G){return T&&b(v.prototype,T),G&&b(v,G),v}}(),C=ne(0),Q=ne(7);function M(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}var _=".well-known/openid-configuration";O.MetadataService=function(){function b(v){var T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.JsonService;if(M(this,b),!v)throw C.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=v,this._jsonService=new T(["application/jwk-set+json"])}return b.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},b.prototype.getMetadata=function(){var T=this;return this._settings.metadata?(C.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(C.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then(function(G){return C.Log.debug("MetadataService.getMetadata: json received"),T._settings.metadata=Object.assign({},T._settings.metadataSeed||{},G),T._settings.metadata})):(C.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},b.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},b.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},b.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},b.prototype.getTokenEndpoint=function(){return this._getMetadataProperty("token_endpoint",!(arguments.length>0&&void 0!==arguments[0])||arguments[0])},b.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},b.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},b.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},b.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},b.prototype._getMetadataProperty=function(T){var G=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return C.Log.debug("MetadataService.getMetadataProperty for: "+T),this.getMetadata().then(function(V){if(C.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===V[T]){if(!0===G)return void C.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+T);throw C.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+T),new Error("Metadata does not contain property "+T)}return V[T]})},b.prototype.getSigningKeys=function(){var T=this;return this._settings.signingKeys?(C.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then(function(G){return C.Log.debug("MetadataService.getSigningKeys: jwks_uri received",G),T._jsonService.getJson(G).then(function(V){if(C.Log.debug("MetadataService.getSigningKeys: key set received",V),!V.keys)throw C.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return T._settings.signingKeys=V.keys,T._settings.signingKeys})})},Z(b,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(_)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=_))),this._metadataUrl}}]),b}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UrlUtility=void 0;var Z=ne(0),C=ne(1);O.UrlUtility=function(){function Q(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Q)}return Q.addQueryParam=function(_,b,v){return _.indexOf("?")<0&&(_+="?"),"?"!==_[_.length-1]&&(_+="&"),_+=encodeURIComponent(b),(_+="=")+encodeURIComponent(v)},Q.parseUrlFragment=function(_){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";"string"!=typeof _&&(_=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:C.Global).location.href);var T=_.lastIndexOf(b);T>=0&&(_=_.substr(T+1)),"?"===b&&(T=_.indexOf("#"))>=0&&(_=_.substr(0,T));for(var G,V={},oe=/([^&=]+)=([^&]*)/g,J=0;G=oe.exec(_);)if(V[decodeURIComponent(G[1])]=decodeURIComponent(G[2].replace(/\+/g," ")),J++>50)return Z.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",_),{error:"Response exceeded expected number of parameters"};for(var K in V)return V;return{}},Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.JoseUtil=void 0;var M,Z=ne(26),C=(M=ne(33))&&M.__esModule?M:{default:M};O.JoseUtil=(0,C.default)({jws:Z.jws,KeyUtil:Z.KeyUtil,X509:Z.X509,crypto:Z.crypto,hextob64u:Z.hextob64u,b64tohex:Z.b64tohex,AllowedSigningAlgs:Z.AllowedSigningAlgs})},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.OidcClientSettings=void 0;var Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(K){return typeof K}:function(K){return K&&"function"==typeof Symbol&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},C=function(){function K($,re){for(var me=0;me<re.length;me++){var se=re[me];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty($,se.key,se)}}return function($,re,me){return re&&K($.prototype,re),me&&K($,me),$}}(),Q=ne(0),M=ne(23),_=ne(6),b=ne(24),v=ne(2);function T(K,$){if(!(K instanceof $))throw new TypeError("Cannot call a class as a function")}var G=".well-known/openid-configuration",V="id_token",J="client_secret_post";O.OidcClientSettings=function(){function K(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},re=$.authority,me=$.metadataUrl,se=$.metadata,le=$.signingKeys,ie=$.metadataSeed,Fe=$.client_id,Ie=$.client_secret,Be=$.response_type,ae=void 0===Be?V:Be,Ye=$.scope,Ot=void 0===Ye?"openid":Ye,Pt=$.redirect_uri,$n=$.post_logout_redirect_uri,Gt=$.client_authentication,_t=void 0===Gt?J:Gt,nn=$.prompt,bt=$.display,wt=$.max_age,Yt=$.ui_locales,Bt=$.acr_values,Bn=$.resource,qn=$.response_mode,Mt=$.filterProtocolClaims,Vt=void 0===Mt||Mt,ct=$.loadUserInfo,mn=void 0===ct||ct,or=$.staleStateAge,Un=void 0===or?900:or,te=$.clockSkew,w=void 0===te?300:te,S=$.clockService,ee=void 0===S?new M.ClockService:S,ce=$.userInfoJwtIssuer,he=void 0===ce?"OP":ce,Ce=$.mergeClaims,Ke=void 0!==Ce&&Ce,it=$.stateStore,kt=void 0===it?new _.WebStorageStateStore:it,Et=$.ResponseValidatorCtor,rn=void 0===Et?b.ResponseValidator:Et,Kn=$.MetadataServiceCtor,cn=void 0===Kn?v.MetadataService:Kn,Fr=$.extraQueryParams,et=void 0===Fr?{}:Fr,Qt=$.extraTokenParams,At=void 0===Qt?{}:Qt;T(this,K),this._authority=re,this._metadataUrl=me,this._metadata=se,this._metadataSeed=ie,this._signingKeys=le,this._client_id=Fe,this._client_secret=Ie,this._response_type=ae,this._scope=Ot,this._redirect_uri=Pt,this._post_logout_redirect_uri=$n,this._client_authentication=_t,this._prompt=nn,this._display=bt,this._max_age=wt,this._ui_locales=Yt,this._acr_values=Bt,this._resource=Bn,this._response_mode=qn,this._filterProtocolClaims=!!Vt,this._loadUserInfo=!!mn,this._staleStateAge=Un,this._clockSkew=w,this._clockService=ee,this._userInfoJwtIssuer=he,this._mergeClaims=!!Ke,this._stateStore=kt,this._validator=new rn(this),this._metadataService=new cn(this),this._extraQueryParams="object"===(void 0===et?"undefined":Z(et))?et:{},this._extraTokenParams="object"===(void 0===At?"undefined":Z(At))?At:{}}return K.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},C(K,[{key:"client_id",get:function(){return this._client_id},set:function(re){if(this._client_id)throw Q.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=re}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(re){if(this._authority)throw Q.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=re}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(G)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=G)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(re){this._metadata=re}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(re){this._metadataSeed=re}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(re){this._signingKeys=re}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(re){this._extraQueryParams="object"===(void 0===re?"undefined":Z(re))?re:{}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(re){this._extraTokenParams="object"===(void 0===re?"undefined":Z(re))?re:{}}}]),K}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.WebStorageStateStore=void 0;var Z=ne(0),C=ne(1);function Q(M,_){if(!(M instanceof _))throw new TypeError("Cannot call a class as a function")}O.WebStorageStateStore=function(){function M(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=_.prefix,v=void 0===b?"oidc.":b,T=_.store,G=void 0===T?C.Global.localStorage:T;Q(this,M),this._store=G,this._prefix=v}return M.prototype.set=function(b,v){return Z.Log.debug("WebStorageStateStore.set",b),this._store.setItem(b=this._prefix+b,v),Promise.resolve()},M.prototype.get=function(b){Z.Log.debug("WebStorageStateStore.get",b);var v=this._store.getItem(b=this._prefix+b);return Promise.resolve(v)},M.prototype.remove=function(b){Z.Log.debug("WebStorageStateStore.remove",b);var v=this._store.getItem(b=this._prefix+b);return this._store.removeItem(b),Promise.resolve(v)},M.prototype.getAllKeys=function(){Z.Log.debug("WebStorageStateStore.getAllKeys");for(var b=[],v=0;v<this._store.length;v++){var T=this._store.key(v);0===T.indexOf(this._prefix)&&b.push(T.substr(this._prefix.length))}return Promise.resolve(b)},M}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.JsonService=void 0;var Z=ne(0),C=ne(1);function Q(M,_){if(!(M instanceof _))throw new TypeError("Cannot call a class as a function")}O.JsonService=function(){function M(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C.Global.XMLHttpRequest,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Q(this,M),this._contentTypes=_&&Array.isArray(_)?_.slice():[],this._contentTypes.push("application/json"),v&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=b,this._jwtHandler=v}return M.prototype.getJson=function(b,v){var T=this;if(!b)throw Z.Log.error("JsonService.getJson: No url passed"),new Error("url");return Z.Log.debug("JsonService.getJson, url: ",b),new Promise(function(G,V){var oe=new T._XMLHttpRequest;oe.open("GET",b);var J=T._contentTypes,K=T._jwtHandler;oe.onload=function(){if(Z.Log.debug("JsonService.getJson: HTTP response received, status",oe.status),200===oe.status){var $=oe.getResponseHeader("Content-Type");if($){var re=J.find(function(me){if($.startsWith(me))return!0});if("application/jwt"==re)return void K(oe).then(G,V);if(re)try{return void G(JSON.parse(oe.responseText))}catch(me){return Z.Log.error("JsonService.getJson: Error parsing JSON response",me.message),void V(me)}}V(Error("Invalid response Content-Type: "+$+", from URL: "+b))}else V(Error(oe.statusText+" ("+oe.status+")"))},oe.onerror=function(){Z.Log.error("JsonService.getJson: network error"),V(Error("Network Error"))},v&&(Z.Log.debug("JsonService.getJson: token passed, setting Authorization header"),oe.setRequestHeader("Authorization","Bearer "+v)),oe.send()})},M.prototype.postForm=function(b,v,T){var G=this;if(!b)throw Z.Log.error("JsonService.postForm: No url passed"),new Error("url");return Z.Log.debug("JsonService.postForm, url: ",b),new Promise(function(V,oe){var J=new G._XMLHttpRequest;J.open("POST",b);var K=G._contentTypes;J.onload=function(){if(Z.Log.debug("JsonService.postForm: HTTP response received, status",J.status),200!==J.status){if(400===J.status&&(le=J.getResponseHeader("Content-Type"))&&K.find(function(ie){if(le.startsWith(ie))return!0}))try{var se=JSON.parse(J.responseText);if(se&&se.error)return Z.Log.error("JsonService.postForm: Error from server: ",se.error),void oe(new Error(se.error))}catch(ie){return Z.Log.error("JsonService.postForm: Error parsing JSON response",ie.message),void oe(ie)}oe(Error(J.statusText+" ("+J.status+")"))}else{var le;if((le=J.getResponseHeader("Content-Type"))&&K.find(function(ie){if(le.startsWith(ie))return!0}))try{return void V(JSON.parse(J.responseText))}catch(ie){return Z.Log.error("JsonService.postForm: Error parsing JSON response",ie.message),void oe(ie)}oe(Error("Invalid response Content-Type: "+le+", from URL: "+b))}},J.onerror=function(){Z.Log.error("JsonService.postForm: network error"),oe(Error("Network Error"))};var $="";for(var re in v){var me=v[re];me&&($.length>0&&($+="&"),$+=encodeURIComponent(re),$+="=",$+=encodeURIComponent(me))}J.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),void 0!==T&&J.setRequestHeader("Authorization","Basic "+btoa(T)),J.send($)})},M}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SigninRequest=void 0;var Z=ne(0),C=ne(3),Q=ne(13);O.SigninRequest=function(){function M(_){var b=_.url,v=_.client_id,T=_.redirect_uri,G=_.response_type,V=_.scope,oe=_.authority,J=_.data,K=_.prompt,$=_.display,re=_.max_age,me=_.ui_locales,se=_.id_token_hint,le=_.login_hint,ie=_.acr_values,Fe=_.resource,Ie=_.response_mode,Be=_.request,ae=_.request_uri,Ye=_.extraQueryParams,Ot=_.request_type,Pt=_.client_secret,$n=_.extraTokenParams,Gt=_.skipUserInfo;if(function(Bn,qn){if(!(Bn instanceof qn))throw new TypeError("Cannot call a class as a function")}(this,M),!b)throw Z.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!v)throw Z.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!T)throw Z.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!G)throw Z.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!V)throw Z.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!oe)throw Z.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var _t=M.isOidc(G),nn=M.isCode(G);Ie||(Ie=M.isCode(G)?"query":null),this.state=new Q.SigninState({nonce:_t,data:J,client_id:v,authority:oe,redirect_uri:T,code_verifier:nn,request_type:Ot,response_mode:Ie,client_secret:Pt,scope:V,extraTokenParams:$n,skipUserInfo:Gt}),b=C.UrlUtility.addQueryParam(b,"client_id",v),b=C.UrlUtility.addQueryParam(b,"redirect_uri",T),b=C.UrlUtility.addQueryParam(b,"response_type",G),b=C.UrlUtility.addQueryParam(b,"scope",V),b=C.UrlUtility.addQueryParam(b,"state",this.state.id),_t&&(b=C.UrlUtility.addQueryParam(b,"nonce",this.state.nonce)),nn&&(b=C.UrlUtility.addQueryParam(b,"code_challenge",this.state.code_challenge),b=C.UrlUtility.addQueryParam(b,"code_challenge_method","S256"));var bt={prompt:K,display:$,max_age:re,ui_locales:me,id_token_hint:se,login_hint:le,acr_values:ie,resource:Fe,request:Be,request_uri:ae,response_mode:Ie};for(var wt in bt)bt[wt]&&(b=C.UrlUtility.addQueryParam(b,wt,bt[wt]));for(var Yt in Ye)b=C.UrlUtility.addQueryParam(b,Yt,Ye[Yt]);this.url=b}return M.isOidc=function(b){return!!b.split(/\s+/g).filter(function(v){return"id_token"===v})[0]},M.isOAuth=function(b){return!!b.split(/\s+/g).filter(function(v){return"token"===v})[0]},M.isCode=function(b){return!!b.split(/\s+/g).filter(function(v){return"code"===v})[0]},M}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.State=void 0;var b,Z=function(){function _(b,v){for(var T=0;T<v.length;T++){var G=v[T];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(b,G.key,G)}}return function(b,v,T){return v&&_(b.prototype,v),T&&_(b,T),b}}(),C=ne(0),Q=(b=ne(14))&&b.__esModule?b:{default:b};function M(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}O.State=function(){function _(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},v=b.id,T=b.data,G=b.created,V=b.request_type;M(this,_),this._id=v||(0,Q.default)(),this._data=T,this._created="number"==typeof G&&G>0?G:parseInt(Date.now()/1e3),this._request_type=V}return _.prototype.toStorageString=function(){return C.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},_.fromStorageString=function(v){return C.Log.debug("State.fromStorageString"),new _(JSON.parse(v))},_.clearStaleState=function(v,T){var G=Date.now()/1e3-T;return v.getAllKeys().then(function(V){C.Log.debug("State.clearStaleState: got keys",V);for(var oe=[],J=function(me){var se=V[me];$=v.get(se).then(function(le){var ie=!1;if(le)try{var Fe=_.fromStorageString(le);C.Log.debug("State.clearStaleState: got item from key: ",se,Fe.created),Fe.created<=G&&(ie=!0)}catch(Ie){C.Log.error("State.clearStaleState: Error parsing state for key",se,Ie.message),ie=!0}else C.Log.debug("State.clearStaleState: no item in storage for key: ",se),ie=!0;if(ie)return C.Log.debug("State.clearStaleState: removed item for key: ",se),v.remove(se)}),oe.push($)},K=0;K<V.length;K++){var $;J(K)}return C.Log.debug("State.clearStaleState: waiting on promise count:",oe.length),Promise.all(oe)})},Z(_,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),_}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.OidcClient=void 0;var Z=function(){function J(K,$){for(var re=0;re<$.length;re++){var me=$[re];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(K,me.key,me)}}return function(K,$,re){return $&&J(K.prototype,$),re&&J(K,re),K}}(),C=ne(0),Q=ne(5),M=ne(12),_=ne(8),b=ne(34),v=ne(35),T=ne(36),G=ne(13),V=ne(9);function oe(J,K){if(!(J instanceof K))throw new TypeError("Cannot call a class as a function")}O.OidcClient=function(){function J(){var K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};oe(this,J),this._settings=K instanceof Q.OidcClientSettings?K:new Q.OidcClientSettings(K)}return J.prototype.createSigninRequest=function(){var $=this,re=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},me=re.response_type,se=re.scope,le=re.redirect_uri,ie=re.data,Fe=re.state,Ie=re.prompt,Be=re.display,ae=re.max_age,Ye=re.ui_locales,Ot=re.id_token_hint,Pt=re.login_hint,$n=re.acr_values,Gt=re.resource,_t=re.request,nn=re.request_uri,bt=re.response_mode,wt=re.extraQueryParams,Yt=re.extraTokenParams,Bt=re.request_type,Bn=re.skipUserInfo,qn=arguments[1];C.Log.debug("OidcClient.createSigninRequest");var Mt=this._settings.client_id;se=se||this._settings.scope,le=le||this._settings.redirect_uri,Ie=Ie||this._settings.prompt,Be=Be||this._settings.display,ae=ae||this._settings.max_age,Ye=Ye||this._settings.ui_locales,$n=$n||this._settings.acr_values,Gt=Gt||this._settings.resource,bt=bt||this._settings.response_mode,wt=wt||this._settings.extraQueryParams,Yt=Yt||this._settings.extraTokenParams;var Vt=this._settings.authority;return _.SigninRequest.isCode(me=me||this._settings.response_type)&&"code"!==me?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then(function(ct){C.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",ct);var mn=new _.SigninRequest({url:ct,client_id:Mt,redirect_uri:le,response_type:me,scope:se,data:ie||Fe,authority:Vt,prompt:Ie,display:Be,max_age:ae,ui_locales:Ye,id_token_hint:Ot,login_hint:Pt,acr_values:$n,resource:Gt,request:_t,request_uri:nn,extraQueryParams:wt,extraTokenParams:Yt,request_type:Bt,response_mode:bt,client_secret:$._settings.client_secret,skipUserInfo:Bn}),or=mn.state;return(qn=qn||$._stateStore).set(or.id,or.toStorageString()).then(function(){return mn})})},J.prototype.readSigninResponseState=function($,re){var me=arguments.length>2&&void 0!==arguments[2]&&arguments[2];C.Log.debug("OidcClient.readSigninResponseState");var se="query"===this._settings.response_mode||!this._settings.response_mode&&_.SigninRequest.isCode(this._settings.response_type),ie=new b.SigninResponse($,se?"?":"#");return ie.state?(re=re||this._stateStore,(me?re.remove.bind(re):re.get.bind(re))(ie.state).then(function(Ie){if(!Ie)throw C.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:G.SigninState.fromStorageString(Ie),response:ie}})):(C.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response")))},J.prototype.processSigninResponse=function($,re){var me=this;return C.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState($,re,!0).then(function(se){var le=se.state,ie=se.response;return C.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),me._validator.validateSigninResponse(le,ie)})},J.prototype.createSignoutRequest=function(){var $=this,re=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},me=re.id_token_hint,se=re.data,le=re.state,ie=re.post_logout_redirect_uri,Fe=re.extraQueryParams,Ie=re.request_type,Be=arguments[1];return C.Log.debug("OidcClient.createSignoutRequest"),ie=ie||this._settings.post_logout_redirect_uri,Fe=Fe||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then(function(ae){if(!ae)throw C.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");C.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",ae);var Ye=new v.SignoutRequest({url:ae,id_token_hint:me,post_logout_redirect_uri:ie,data:se||le,extraQueryParams:Fe,request_type:Ie}),Ot=Ye.state;return Ot&&(C.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(Be=Be||$._stateStore).set(Ot.id,Ot.toStorageString())),Ye})},J.prototype.readSignoutResponseState=function($,re){var me=arguments.length>2&&void 0!==arguments[2]&&arguments[2];C.Log.debug("OidcClient.readSignoutResponseState");var se=new T.SignoutResponse($);if(!se.state)return C.Log.debug("OidcClient.readSignoutResponseState: No state in response"),se.error?(C.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",se.error),Promise.reject(new M.ErrorResponse(se))):Promise.resolve({state:void 0,response:se});var le=se.state;return re=re||this._stateStore,(me?re.remove.bind(re):re.get.bind(re))(le).then(function(Fe){if(!Fe)throw C.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:V.State.fromStorageString(Fe),response:se}})},J.prototype.processSignoutResponse=function($,re){var me=this;return C.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState($,re,!0).then(function(se){var le=se.state,ie=se.response;return le?(C.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),me._validator.validateSignoutResponse(le,ie)):(C.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),ie)})},J.prototype.clearStaleState=function($){return C.Log.debug("OidcClient.clearStaleState"),V.State.clearStaleState($=$||this._stateStore,this.settings.staleStateAge)},Z(J,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),J}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.TokenClient=void 0;var Z=ne(7),C=ne(2),Q=ne(0);function M(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}O.TokenClient=function(){function _(b){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.JsonService,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C.MetadataService;if(M(this,_),!b)throw Q.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=b,this._jsonService=new v,this._metadataService=new T(this._settings)}return _.prototype.exchangeCode=function(){var v=this,T=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(T=Object.assign({},T)).grant_type=T.grant_type||"authorization_code",T.client_id=T.client_id||this._settings.client_id,T.client_secret=T.client_secret||this._settings.client_secret,T.redirect_uri=T.redirect_uri||this._settings.redirect_uri;var G=void 0,V=T._client_authentication||this._settings._client_authentication;return delete T._client_authentication,T.code?T.redirect_uri?T.code_verifier?T.client_id?T.client_secret||"client_secret_basic"!=V?("client_secret_basic"==V&&(G=T.client_id+":"+T.client_secret,delete T.client_id,delete T.client_secret),this._metadataService.getTokenEndpoint(!1).then(function(oe){return Q.Log.debug("TokenClient.exchangeCode: Received token endpoint"),v._jsonService.postForm(oe,T,G).then(function(J){return Q.Log.debug("TokenClient.exchangeCode: response received"),J})})):(Q.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(Q.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(Q.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(Q.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(Q.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},_.prototype.exchangeRefreshToken=function(){var v=this,T=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(T=Object.assign({},T)).grant_type=T.grant_type||"refresh_token",T.client_id=T.client_id||this._settings.client_id,T.client_secret=T.client_secret||this._settings.client_secret;var G=void 0,V=T._client_authentication||this._settings._client_authentication;return delete T._client_authentication,T.refresh_token?T.client_id?("client_secret_basic"==V&&(G=T.client_id+":"+T.client_secret,delete T.client_id,delete T.client_secret),this._metadataService.getTokenEndpoint(!1).then(function(oe){return Q.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),v._jsonService.postForm(oe,T,G).then(function(J){return Q.Log.debug("TokenClient.exchangeRefreshToken: response received"),J})})):(Q.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(Q.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},_}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.ErrorResponse=void 0;var Z=ne(0);function C(M,_){if(!(M instanceof _))throw new TypeError("Cannot call a class as a function")}function Q(M,_){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!_||"object"!=typeof _&&"function"!=typeof _?M:_}O.ErrorResponse=function(M){function _(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},v=b.error,T=b.error_description,G=b.error_uri,V=b.state,oe=b.session_state;if(C(this,_),!v)throw Z.Log.error("No error passed to ErrorResponse"),new Error("error");var J=Q(this,M.call(this,T||v));return J.name="ErrorResponse",J.error=v,J.error_description=T,J.error_uri=G,J.state=V,J.session_state=oe,J}return function(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Super expression must either be null or a function, not "+typeof T);v.prototype=Object.create(T&&T.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(v,T):v.__proto__=T)}(_,M),_}(Error)},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SigninState=void 0;var G,Z=function(){function T(G,V){for(var oe=0;oe<V.length;oe++){var J=V[oe];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(G,J.key,J)}}return function(G,V,oe){return V&&T(G.prototype,V),oe&&T(G,oe),G}}(),C=ne(0),Q=ne(9),M=ne(4),_=(G=ne(14))&&G.__esModule?G:{default:G};function b(T,G){if(!(T instanceof G))throw new TypeError("Cannot call a class as a function")}function v(T,G){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!G||"object"!=typeof G&&"function"!=typeof G?T:G}O.SigninState=function(T){function G(){var V=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},oe=V.nonce,J=V.authority,K=V.client_id,$=V.redirect_uri,re=V.code_verifier,me=V.response_mode,se=V.client_secret,le=V.scope,ie=V.extraTokenParams,Fe=V.skipUserInfo;b(this,G);var Ie=v(this,T.call(this,arguments[0]));if(!0===oe?Ie._nonce=(0,_.default)():oe&&(Ie._nonce=oe),!0===re?Ie._code_verifier=(0,_.default)()+(0,_.default)()+(0,_.default)():re&&(Ie._code_verifier=re),Ie.code_verifier){var Be=M.JoseUtil.hashString(Ie.code_verifier,"SHA256");Ie._code_challenge=M.JoseUtil.hexToBase64Url(Be)}return Ie._redirect_uri=$,Ie._authority=J,Ie._client_id=K,Ie._response_mode=me,Ie._client_secret=se,Ie._scope=le,Ie._extraTokenParams=ie,Ie._skipUserInfo=Fe,Ie}return function(oe,J){if("function"!=typeof J&&null!==J)throw new TypeError("Super expression must either be null or a function, not "+typeof J);oe.prototype=Object.create(J&&J.prototype,{constructor:{value:oe,enumerable:!1,writable:!0,configurable:!0}}),J&&(Object.setPrototypeOf?Object.setPrototypeOf(oe,J):oe.__proto__=J)}(G,T),G.prototype.toStorageString=function(){return C.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},G.fromStorageString=function(oe){return C.Log.debug("SigninState.fromStorageString"),new G(JSON.parse(oe))},Z(G,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),G}(Q.State)},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(){return("undefined"!=Z&&null!==Z&&void 0!==Z.getRandomValues?C:Q)().replace(/-/g,"")};var Z="undefined"!=typeof window?window.crypto||window.msCrypto:null;function C(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(M){return(M^Z.getRandomValues(new Uint8Array(1))[0]&15>>M/4).toString(16)})}function Q(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(M){return(M^16*Math.random()>>M/4).toString(16)})}qe.exports=O.default},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.User=void 0;var Z=function(){function Q(M,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(M,v.key,v)}}return function(M,_,b){return _&&Q(M.prototype,_),b&&Q(M,b),M}}(),C=ne(0);O.User=function(){function Q(M){var _=M.id_token,b=M.session_state,v=M.access_token,T=M.refresh_token,G=M.token_type,V=M.scope,oe=M.profile,J=M.expires_at,K=M.state;(function(re,me){if(!(re instanceof me))throw new TypeError("Cannot call a class as a function")})(this,Q),this.id_token=_,this.session_state=b,this.access_token=v,this.refresh_token=T,this.token_type=G,this.scope=V,this.profile=oe,this.expires_at=J,this.state=K}return Q.prototype.toStorageString=function(){return C.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},Q.fromStorageString=function(_){return C.Log.debug("User.fromStorageString"),new Q(JSON.parse(_))},Z(Q,[{key:"expires_in",get:function(){if(this.expires_at){var _=parseInt(Date.now()/1e3);return this.expires_at-_}},set:function(_){var b=parseInt(_);if("number"==typeof b&&b>0){var v=parseInt(Date.now()/1e3);this.expires_at=v+b}}},{key:"expired",get:function(){var _=this.expires_in;if(void 0!==_)return _<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.AccessTokenEvents=void 0;var Z=ne(0),C=ne(46);function Q(M,_){if(!(M instanceof _))throw new TypeError("Cannot call a class as a function")}O.AccessTokenEvents=function(){function M(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=_.accessTokenExpiringNotificationTime,v=void 0===b?60:b,T=_.accessTokenExpiringTimer,G=void 0===T?new C.Timer("Access token expiring"):T,V=_.accessTokenExpiredTimer,oe=void 0===V?new C.Timer("Access token expired"):V;Q(this,M),this._accessTokenExpiringNotificationTime=v,this._accessTokenExpiring=G,this._accessTokenExpired=oe}return M.prototype.load=function(b){if(b.access_token&&void 0!==b.expires_in){var v=b.expires_in;if(Z.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",v),v>0){var T=v-this._accessTokenExpiringNotificationTime;T<=0&&(T=1),Z.Log.debug("AccessTokenEvents.load: registering expiring timer in:",T),this._accessTokenExpiring.init(T)}else Z.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var G=v+1;Z.Log.debug("AccessTokenEvents.load: registering expired timer in:",G),this._accessTokenExpired.init(G)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},M.prototype.unload=function(){Z.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},M.prototype.addAccessTokenExpiring=function(b){this._accessTokenExpiring.addHandler(b)},M.prototype.removeAccessTokenExpiring=function(b){this._accessTokenExpiring.removeHandler(b)},M.prototype.addAccessTokenExpired=function(b){this._accessTokenExpired.addHandler(b)},M.prototype.removeAccessTokenExpired=function(b){this._accessTokenExpired.removeHandler(b)},M}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Event=void 0;var Z=ne(0);O.Event=function(){function C(Q){(function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")})(this,C),this._name=Q,this._callbacks=[]}return C.prototype.addHandler=function(M){this._callbacks.push(M)},C.prototype.removeHandler=function(M){var _=this._callbacks.findIndex(function(b){return b===M});_>=0&&this._callbacks.splice(_,1)},C.prototype.raise=function(){Z.Log.debug("Event: Raising event: "+this._name);for(var M=0;M<this._callbacks.length;M++){var _;(_=this._callbacks)[M].apply(_,arguments)}},C}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SessionMonitor=void 0;var Z=function(){function b(v,T){for(var G=0;G<T.length;G++){var V=T[G];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(v,V.key,V)}}return function(v,T,G){return T&&b(v.prototype,T),G&&b(v,G),v}}(),C=ne(0),Q=ne(19),M=ne(1);function _(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}O.SessionMonitor=function(){function b(v){var T=this,G=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.CheckSessionIFrame,V=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M.Global.timer;if(_(this,b),!v)throw C.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=v,this._CheckSessionIFrameCtor=G,this._timer=V,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then(function(oe){oe?T._start(oe):T._settings.monitorAnonymousSession&&T._userManager.querySessionStatus().then(function(J){var K={session_state:J.session_state};J.sub&&J.sid&&(K.profile={sub:J.sub,sid:J.sid}),T._start(K)}).catch(function(J){C.Log.error("SessionMonitor ctor: error from querySessionStatus:",J.message)})}).catch(function(oe){C.Log.error("SessionMonitor ctor: error from getUser:",oe.message)}))}return b.prototype._start=function(T){var G=this,V=T.session_state;V&&(T.profile?(this._sub=T.profile.sub,this._sid=T.profile.sid,C.Log.debug("SessionMonitor._start: session_state:",V,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,C.Log.debug("SessionMonitor._start: session_state:",V,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(V):this._metadataService.getCheckSessionIframe().then(function(oe){if(oe){C.Log.debug("SessionMonitor._start: Initializing check session iframe");var J=G._client_id,K=G._checkSessionInterval,$=G._stopCheckSessionOnError;G._checkSessionIFrame=new G._CheckSessionIFrameCtor(G._callback.bind(G),J,oe,K,$),G._checkSessionIFrame.load().then(function(){G._checkSessionIFrame.start(V)})}else C.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")}).catch(function(oe){C.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",oe.message)}))},b.prototype._stop=function(){var T=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(C.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var G=this._timer.setInterval(function(){T._timer.clearInterval(G),T._userManager.querySessionStatus().then(function(V){var oe={session_state:V.session_state};V.sub&&V.sid&&(oe.profile={sub:V.sub,sid:V.sid}),T._start(oe)}).catch(function(V){C.Log.error("SessionMonitor: error from querySessionStatus:",V.message)})},1e3)},b.prototype._callback=function(){var T=this;this._userManager.querySessionStatus().then(function(G){var V=!0;G?G.sub===T._sub?(V=!1,T._checkSessionIFrame.start(G.session_state),G.sid===T._sid?C.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",G.session_state):(C.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",G.session_state),T._userManager.events._raiseUserSessionChanged())):C.Log.debug("SessionMonitor._callback: Different subject signed into OP:",G.sub):C.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),V&&(T._sub?(C.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),T._userManager.events._raiseUserSignedOut()):(C.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),T._userManager.events._raiseUserSignedIn()))}).catch(function(G){T._sub&&(C.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",G.message),T._userManager.events._raiseUserSignedOut())})},Z(b,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),b}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CheckSessionIFrame=void 0;var Z=ne(0);function C(Q,M){if(!(Q instanceof M))throw new TypeError("Cannot call a class as a function")}O.CheckSessionIFrame=function(){function Q(M,_,b,v){var T=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];C(this,Q),this._callback=M,this._client_id=_,this._url=b,this._interval=v||2e3,this._stopOnError=T;var G=b.indexOf("/",b.indexOf("//")+2);this._frame_origin=b.substr(0,G),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=b}return Q.prototype.load=function(){var _=this;return new Promise(function(b){_._frame.onload=function(){b()},window.document.body.appendChild(_._frame),_._boundMessageEvent=_._message.bind(_),window.addEventListener("message",_._boundMessageEvent,!1)})},Q.prototype._message=function(_){_.origin===this._frame_origin&&_.source===this._frame.contentWindow&&("error"===_.data?(Z.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===_.data?(Z.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):Z.Log.debug("CheckSessionIFrame: "+_.data+" message from check session op iframe"))},Q.prototype.start=function(_){var b=this;if(this._session_state!==_){Z.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=_;var v=function(){b._frame.contentWindow.postMessage(b._client_id+" "+b._session_state,b._frame_origin)};v(),this._timer=window.setInterval(v,this._interval)}},Q.prototype.stop=function(){this._session_state=null,this._timer&&(Z.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.TokenRevocationClient=void 0;var Z=ne(0),C=ne(2),Q=ne(1);function M(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}var _="access_token",b="refresh_token";O.TokenRevocationClient=function(){function v(T){var G=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.Global.XMLHttpRequest,V=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C.MetadataService;if(M(this,v),!T)throw Z.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=T,this._XMLHttpRequestCtor=G,this._metadataService=new V(this._settings)}return v.prototype.revoke=function(G,V){var oe=this,J=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"access_token";if(!G)throw Z.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(J!==_&&J!=b)throw Z.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then(function(K){if(K)return Z.Log.debug("TokenRevocationClient.revoke: Revoking "+J),oe._revoke(K,oe._settings.client_id,oe._settings.client_secret,G,J);if(V)throw Z.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")})},v.prototype._revoke=function(G,V,oe,J,K){var $=this;return new Promise(function(re,me){var se=new $._XMLHttpRequestCtor;se.open("POST",G),se.onload=function(){Z.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",se.status),200===se.status?re():me(Error(se.statusText+" ("+se.status+")"))},se.onerror=function(){Z.Log.debug("TokenRevocationClient.revoke: Network Error."),me("Network Error")};var le="client_id="+encodeURIComponent(V);oe&&(le+="&client_secret="+encodeURIComponent(oe)),le+="&token_type_hint="+encodeURIComponent(K),le+="&token="+encodeURIComponent(J),se.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),se.send(le)})},v}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CordovaPopupWindow=void 0;var Z=function(){function Q(M,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(M,v.key,v)}}return function(M,_,b){return _&&Q(M.prototype,_),b&&Q(M,b),M}}(),C=ne(0);O.CordovaPopupWindow=function(){function Q(M){var _=this;(function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")})(this,Q),this._promise=new Promise(function(b,v){_._resolve=b,_._reject=v}),this.features=M.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=M.popupWindowTarget||"_blank",this.redirect_uri=M.startUrl,C.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return Q.prototype._isInAppBrowserInstalled=function(_){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some(function(b){return _.hasOwnProperty(b)})},Q.prototype.navigate=function(_){if(_&&_.url){if(!window.cordova)return this._error("cordova is undefined");var b=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(b))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(_.url,this.target,this.features),this._popup?(C.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},Q.prototype._loadStartCallback=function(_){0===_.url.indexOf(this.redirect_uri)&&this._success({url:_.url})},Q.prototype._exitCallback=function(_){this._error(_)},Q.prototype._success=function(_){this._cleanup(),C.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(_)},Q.prototype._error=function(_){this._cleanup(),C.Log.error(_),this._reject(new Error(_))},Q.prototype.close=function(){this._cleanup()},Q.prototype._cleanup=function(){this._popup&&(C.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},Z(Q,[{key:"promise",get:function(){return this._promise}}]),Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0});var Z=ne(0),C=ne(10),Q=ne(5),M=ne(6),_=ne(37),b=ne(38),v=ne(16),T=ne(2),G=ne(48),V=ne(49),oe=ne(19),J=ne(20),K=ne(18),$=ne(1),re=ne(15),me=ne(50);O.default={Version:me.Version,Log:Z.Log,OidcClient:C.OidcClient,OidcClientSettings:Q.OidcClientSettings,WebStorageStateStore:M.WebStorageStateStore,InMemoryWebStorage:_.InMemoryWebStorage,UserManager:b.UserManager,AccessTokenEvents:v.AccessTokenEvents,MetadataService:T.MetadataService,CordovaPopupNavigator:G.CordovaPopupNavigator,CordovaIFrameNavigator:V.CordovaIFrameNavigator,CheckSessionIFrame:oe.CheckSessionIFrame,TokenRevocationClient:J.TokenRevocationClient,SessionMonitor:K.SessionMonitor,Global:$.Global,User:re.User},qe.exports=O.default},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.ClockService=function(){function Z(){!function(Q,M){if(!(Q instanceof M))throw new TypeError("Cannot call a class as a function")}(this,Z)}return Z.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},Z}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.ResponseValidator=void 0;var Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(V){return typeof V}:function(V){return V&&"function"==typeof Symbol&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},C=ne(0),Q=ne(2),M=ne(25),_=ne(11),b=ne(12),v=ne(4);function T(V,oe){if(!(V instanceof oe))throw new TypeError("Cannot call a class as a function")}var G=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];O.ResponseValidator=function(){function V(oe){var J=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.MetadataService,K=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M.UserInfoService,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v.JoseUtil,re=arguments.length>4&&void 0!==arguments[4]?arguments[4]:_.TokenClient;if(T(this,V),!oe)throw C.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=oe,this._metadataService=new J(this._settings),this._userInfoService=new K(this._settings),this._joseUtil=$,this._tokenClient=new re(this._settings)}return V.prototype.validateSigninResponse=function(J,K){var $=this;return C.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(J,K).then(function(re){return C.Log.debug("ResponseValidator.validateSigninResponse: state processed"),$._validateTokens(J,re).then(function(me){return C.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),$._processClaims(J,me).then(function(se){return C.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),se})})})},V.prototype.validateSignoutResponse=function(J,K){return J.id!==K.state?(C.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(C.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),K.state=J.data,K.error?(C.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",K.error),Promise.reject(new b.ErrorResponse(K))):Promise.resolve(K))},V.prototype._processSigninParams=function(J,K){if(J.id!==K.state)return C.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!J.client_id)return C.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!J.authority)return C.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==J.authority)return C.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=J.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==J.client_id)return C.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=J.client_id;return C.Log.debug("ResponseValidator._processSigninParams: state validated"),K.state=J.data,K.error?(C.Log.warn("ResponseValidator._processSigninParams: Response was error",K.error),Promise.reject(new b.ErrorResponse(K))):J.nonce&&!K.id_token?(C.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!J.nonce&&K.id_token?(C.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):J.code_verifier&&!K.code?(C.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!J.code_verifier&&K.code?(C.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(K.scope||(K.scope=J.scope),Promise.resolve(K))},V.prototype._processClaims=function(J,K){var $=this;if(K.isOpenIdConnect){if(C.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),K.profile=this._filterProtocolClaims(K.profile),!0!==J.skipUserInfo&&this._settings.loadUserInfo&&K.access_token)return C.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(K.access_token).then(function(re){return C.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),re.sub!==K.profile.sub?(C.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(K.profile=$._mergeClaims(K.profile,re),C.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",K.profile),K)});C.Log.debug("ResponseValidator._processClaims: not loading user info")}else C.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(K)},V.prototype._mergeClaims=function(J,K){var $=Object.assign({},J);for(var re in K){var me=K[re];Array.isArray(me)||(me=[me]);for(var se=0;se<me.length;se++){var le=me[se];$[re]?Array.isArray($[re])?$[re].indexOf(le)<0&&$[re].push(le):$[re]!==le&&($[re]="object"===(void 0===le?"undefined":Z(le))&&this._settings.mergeClaims?this._mergeClaims($[re],le):[$[re],le]):$[re]=le}}return $},V.prototype._filterProtocolClaims=function(J){C.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",J);var K=Object.assign({},J);return this._settings._filterProtocolClaims?(G.forEach(function($){delete K[$]}),C.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",K)):C.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),K},V.prototype._validateTokens=function(J,K){return K.code?(C.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(J,K)):K.id_token?K.access_token?(C.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(J,K)):(C.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(J,K)):(C.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(K))},V.prototype._processCode=function(J,K){var $=this,re={client_id:J.client_id,client_secret:J.client_secret,code:K.code,redirect_uri:J.redirect_uri,code_verifier:J.code_verifier};return J.extraTokenParams&&"object"===Z(J.extraTokenParams)&&Object.assign(re,J.extraTokenParams),this._tokenClient.exchangeCode(re).then(function(me){for(var se in me)K[se]=me[se];return K.id_token?(C.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),$._validateIdTokenAttributes(J,K)):(C.Log.debug("ResponseValidator._processCode: token response successful, returning response"),K)})},V.prototype._validateIdTokenAttributes=function(J,K){var $=this;return this._metadataService.getIssuer().then(function(re){var me=J.client_id,se=$._settings.clockSkew;return C.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",se),$._settings.getEpochTime().then(function(le){return $._joseUtil.validateJwtAttributes(K.id_token,re,me,se,le).then(function(ie){return J.nonce&&J.nonce!==ie.nonce?(C.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):ie.sub?(K.profile=ie,K):(C.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})})},V.prototype._validateIdTokenAndAccessToken=function(J,K){var $=this;return this._validateIdToken(J,K).then(function(re){return $._validateAccessToken(re)})},V.prototype._getSigningKeyForJwt=function(J){var K=this;return this._metadataService.getSigningKeys().then(function($){var re=J.header.kid;if(!$)return C.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));C.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var me=void 0;if(re)me=$.filter(function(se){return se.kid===re})[0];else{if(($=K._filterByAlg($,J.header.alg)).length>1)return C.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));me=$[0]}return Promise.resolve(me)})},V.prototype._getSigningKeyForJwtWithSingleRetry=function(J){var K=this;return this._getSigningKeyForJwt(J).then(function($){return $?Promise.resolve($):(K._metadataService.resetSigningKeys(),K._getSigningKeyForJwt(J))})},V.prototype._validateIdToken=function(J,K){var $=this;if(!J.nonce)return C.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var re=this._joseUtil.parseJwt(K.id_token);return re&&re.header&&re.payload?J.nonce!==re.payload.nonce?(C.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then(function(me){return C.Log.debug("ResponseValidator._validateIdToken: Received issuer"),$._getSigningKeyForJwtWithSingleRetry(re).then(function(se){if(!se)return C.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var le=J.client_id,ie=$._settings.clockSkew;return C.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",ie),$._joseUtil.validateJwt(K.id_token,se,me,le,ie).then(function(){return C.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),re.payload.sub?(K.profile=re.payload,K):(C.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})}):(C.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",re),Promise.reject(new Error("Failed to parse id_token")))},V.prototype._filterByAlg=function(J,K){var $=null;if(K.startsWith("RS"))$="RSA";else if(K.startsWith("PS"))$="PS";else{if(!K.startsWith("ES"))return C.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",K),[];$="EC"}return C.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",$),J=J.filter(function(re){return re.kty===$}),C.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",$,J.length),J},V.prototype._validateAccessToken=function(J){if(!J.profile)return C.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!J.profile.at_hash)return C.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!J.id_token)return C.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var K=this._joseUtil.parseJwt(J.id_token);if(!K||!K.header)return C.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",K),Promise.reject(new Error("Failed to parse id_token"));var $=K.header.alg;if(!$||5!==$.length)return C.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",$),Promise.reject(new Error("Unsupported alg: "+$));var re=$.substr(2,3);if(!re)return C.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",$,re),Promise.reject(new Error("Unsupported alg: "+$));if(256!==(re=parseInt(re))&&384!==re&&512!==re)return C.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",$,re),Promise.reject(new Error("Unsupported alg: "+$));var me="sha"+re,se=this._joseUtil.hashString(J.access_token,me);if(!se)return C.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",me),Promise.reject(new Error("Failed to validate at_hash"));var le=se.substr(0,se.length/2),ie=this._joseUtil.hexToBase64Url(le);return ie!==J.profile.at_hash?(C.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",ie,J.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(C.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(J))},V}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserInfoService=void 0;var Z=ne(7),C=ne(2),Q=ne(0),M=ne(4);function _(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}O.UserInfoService=function(){function b(v){var T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.JsonService,G=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C.MetadataService,V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M.JoseUtil;if(_(this,b),!v)throw Q.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=v,this._jsonService=new T(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new G(this._settings),this._joseUtil=V}return b.prototype.getClaims=function(T){var G=this;return T?this._metadataService.getUserInfoEndpoint().then(function(V){return Q.Log.debug("UserInfoService.getClaims: received userinfo url",V),G._jsonService.getJson(V,T).then(function(oe){return Q.Log.debug("UserInfoService.getClaims: claims received",oe),oe})}):(Q.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},b.prototype._getClaimsFromJwt=function(T){var G=this;try{var V=this._joseUtil.parseJwt(T.responseText);if(!V||!V.header||!V.payload)return Q.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",V),Promise.reject(new Error("Failed to parse id_token"));var oe=V.header.kid,J=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":J=this._metadataService.getIssuer();break;case"ANY":J=Promise.resolve(V.payload.iss);break;default:J=Promise.resolve(this._settings.userInfoJwtIssuer)}return J.then(function(K){return Q.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+K),G._metadataService.getSigningKeys().then(function($){if(!$)return Q.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));Q.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var re=void 0;if(oe)re=$.filter(function(le){return le.kid===oe})[0];else{if(($=G._filterByAlg($,V.header.alg)).length>1)return Q.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));re=$[0]}if(!re)return Q.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var me=G._settings.client_id,se=G._settings.clockSkew;return Q.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",se),G._joseUtil.validateJwt(T.responseText,re,K,me,se,void 0,!0).then(function(){return Q.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),V.payload})})})}catch(K){return Q.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",K.message),void reject(K)}},b.prototype._filterByAlg=function(T,G){var V=null;if(G.startsWith("RS"))V="RSA";else if(G.startsWith("PS"))V="PS";else{if(!G.startsWith("ES"))return Q.Log.debug("UserInfoService._filterByAlg: alg not supported: ",G),[];V="EC"}return Q.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",V),T=T.filter(function(oe){return oe.kty===V}),Q.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",V,T.length),T},b}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.AllowedSigningAlgs=O.b64tohex=O.hextob64u=O.crypto=O.X509=O.KeyUtil=O.jws=void 0;var Z=ne(27);O.jws=Z.jws,O.KeyUtil=Z.KEYUTIL,O.X509=Z.X509,O.crypto=Z.crypto,O.hextob64u=Z.hextob64u,O.b64tohex=Z.b64tohex,O.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(qe,O,ne){"use strict";(function(Z){Object.defineProperty(O,"__esModule",{value:!0});var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Q={userAgent:!1},M={};if(void 0===_)var _={};_.lang={extend:function(u,d,h){if(!d||!u)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var g=function(){};if(g.prototype=d.prototype,u.prototype=new g,u.prototype.constructor=u,u.superclass=d.prototype,d.prototype.constructor==Object.prototype.constructor&&(d.prototype.constructor=d),h){var y;for(y in h)u.prototype[y]=h[y];var D=function(){},B=["toString","valueOf"];try{/MSIE/.test(Q.userAgent)&&(D=function(N,P){for(y=0;y<B.length;y+=1){var U=B[y],X=P[U];"function"==typeof X&&X!=Object.prototype[U]&&(N[U]=X)}})}catch(F){}D(u.prototype,h)}}};var b,v,T,G,V,oe,J,K,$,re,me,u,d,h,g,se=se||(b=Math,T=(v={}).lib={},G=T.Base=function(){function c(){}return{extend:function(d){c.prototype=this;var h=new c;return d&&h.mixIn(d),h.hasOwnProperty("init")||(h.init=function(){h.$super.init.apply(this,arguments)}),h.init.prototype=h,h.$super=this,h},create:function(){var d=this.extend();return d.init.apply(d,arguments),d},init:function(){},mixIn:function(d){for(var h in d)d.hasOwnProperty(h)&&(this[h]=d[h]);d.hasOwnProperty("toString")&&(this.toString=d.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),V=T.WordArray=G.extend({init:function(u,d){u=this.words=u||[],this.sigBytes=null!=d?d:4*u.length},toString:function(u){return(u||J).stringify(this)},concat:function(u){var d=this.words,h=u.words,g=this.sigBytes,y=u.sigBytes;if(this.clamp(),g%4)for(var D=0;D<y;D++)d[g+D>>>2]|=(h[D>>>2]>>>24-D%4*8&255)<<24-(g+D)%4*8;else for(D=0;D<y;D+=4)d[g+D>>>2]=h[D>>>2];return this.sigBytes+=y,this},clamp:function(){var u=this.words,d=this.sigBytes;u[d>>>2]&=4294967295<<32-d%4*8,u.length=b.ceil(d/4)},clone:function(){var u=G.clone.call(this);return u.words=this.words.slice(0),u},random:function(u){for(var d=[],h=0;h<u;h+=4)d.push(4294967296*b.random()|0);return new V.init(d,u)}}),oe=v.enc={},J=oe.Hex={stringify:function(u){for(var d=u.words,h=u.sigBytes,g=[],y=0;y<h;y++){var D=d[y>>>2]>>>24-y%4*8&255;g.push((D>>>4).toString(16)),g.push((15&D).toString(16))}return g.join("")},parse:function(u){for(var d=u.length,h=[],g=0;g<d;g+=2)h[g>>>3]|=parseInt(u.substr(g,2),16)<<24-g%8*4;return new V.init(h,d/2)}},K=oe.Latin1={stringify:function(u){for(var d=u.words,h=u.sigBytes,g=[],y=0;y<h;y++)g.push(String.fromCharCode(d[y>>>2]>>>24-y%4*8&255));return g.join("")},parse:function(u){for(var d=u.length,h=[],g=0;g<d;g++)h[g>>>2]|=(255&u.charCodeAt(g))<<24-g%4*8;return new V.init(h,d)}},$=oe.Utf8={stringify:function(u){try{return decodeURIComponent(escape(K.stringify(u)))}catch(d){throw new Error("Malformed UTF-8 data")}},parse:function(u){return K.parse(unescape(encodeURIComponent(u)))}},re=T.BufferedBlockAlgorithm=G.extend({reset:function(){this._data=new V.init,this._nDataBytes=0},_append:function(u){"string"==typeof u&&(u=$.parse(u)),this._data.concat(u),this._nDataBytes+=u.sigBytes},_process:function(u){var d=this._data,h=d.words,g=d.sigBytes,y=this.blockSize,D=g/(4*y),B=(D=u?b.ceil(D):b.max((0|D)-this._minBufferSize,0))*y,F=b.min(4*B,g);if(B){for(var N=0;N<B;N+=y)this._doProcessBlock(h,N);var P=h.splice(0,B);d.sigBytes-=F}return new V.init(P,F)},clone:function(){var u=G.clone.call(this);return u._data=this._data.clone(),u},_minBufferSize:0}),T.Hasher=re.extend({cfg:G.extend(),init:function(u){this.cfg=this.cfg.extend(u),this.reset()},reset:function(){re.reset.call(this),this._doReset()},update:function(u){return this._append(u),this._process(),this},finalize:function(u){return u&&this._append(u),this._doFinalize()},blockSize:16,_createHelper:function(u){return function(d,h){return new u.init(h).finalize(d)}},_createHmacHelper:function(u){return function(d,h){return new me.HMAC.init(u,h).finalize(d)}}}),me=v.algo={},v);d=(u=se).lib,h=d.Base,g=d.WordArray,(u=u.x64={}).Word=h.extend({init:function(D,B){this.high=D,this.low=B}}),u.WordArray=h.extend({init:function(D,B){D=this.words=D||[],this.sigBytes=null!=B?B:8*D.length},toX32:function(){for(var D=this.words,B=D.length,F=[],N=0;N<B;N++){var P=D[N];F.push(P.high),F.push(P.low)}return g.create(F,this.sigBytes)},clone:function(){for(var D=h.clone.call(this),B=D.words=this.words.slice(0),F=B.length,N=0;N<F;N++)B[N]=B[N].clone();return D}}),function(){var u=se.lib.WordArray;se.enc.Base64={stringify:function(h){var g=h.words,y=h.sigBytes,D=this._map;h.clamp(),h=[];for(var B=0;B<y;B+=3)for(var F=(g[B>>>2]>>>24-B%4*8&255)<<16|(g[B+1>>>2]>>>24-(B+1)%4*8&255)<<8|g[B+2>>>2]>>>24-(B+2)%4*8&255,N=0;4>N&&B+.75*N<y;N++)h.push(D.charAt(F>>>6*(3-N)&63));if(g=D.charAt(64))for(;h.length%4;)h.push(g);return h.join("")},parse:function(h){var g=h.length,y=this._map;(D=y.charAt(64))&&-1!=(D=h.indexOf(D))&&(g=D);for(var D=[],B=0,F=0;F<g;F++)if(F%4){var N=y.indexOf(h.charAt(F-1))<<F%4*2,P=y.indexOf(h.charAt(F))>>>6-F%4*2;D[B>>>2]|=(N|P)<<24-B%4*8,B++}return u.create(D,B)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(c){for(var u=se,d=(g=u.lib).WordArray,h=g.Hasher,g=u.algo,y=[],D=[],B=function(be){return 4294967296*(be-(0|be))|0},F=2,N=0;64>N;){var P;e:{for(var U=c.sqrt(P=F),X=2;X<=U;X++)if(!(P%X)){P=!1;break e}P=!0}P&&(8>N&&(y[N]=B(c.pow(F,.5))),D[N]=B(c.pow(F,1/3)),N++),F++}var ue=[];g=g.SHA256=h.extend({_doReset:function(){this._hash=new d.init(y.slice(0))},_doProcessBlock:function(be,_e){for(var A=this._hash.words,q=A[0],Y=A[1],W=A[2],ve=A[3],Ee=A[4],Ge=A[5],Te=A[6],ht=A[7],$e=0;64>$e;$e++){if(16>$e)ue[$e]=0|be[_e+$e];else{var Xe=ue[$e-15],qt=ue[$e-2];ue[$e]=((Xe<<25|Xe>>>7)^(Xe<<14|Xe>>>18)^Xe>>>3)+ue[$e-7]+((qt<<15|qt>>>17)^(qt<<13|qt>>>19)^qt>>>10)+ue[$e-16]}Xe=ht+((Ee<<26|Ee>>>6)^(Ee<<21|Ee>>>11)^(Ee<<7|Ee>>>25))+(Ee&Ge^~Ee&Te)+D[$e]+ue[$e],qt=((q<<30|q>>>2)^(q<<19|q>>>13)^(q<<10|q>>>22))+(q&Y^q&W^Y&W),ht=Te,Te=Ge,Ge=Ee,Ee=ve+Xe|0,ve=W,W=Y,Y=q,q=Xe+qt|0}A[0]=A[0]+q|0,A[1]=A[1]+Y|0,A[2]=A[2]+W|0,A[3]=A[3]+ve|0,A[4]=A[4]+Ee|0,A[5]=A[5]+Ge|0,A[6]=A[6]+Te|0,A[7]=A[7]+ht|0},_doFinalize:function(){var be=this._data,_e=be.words,A=8*this._nDataBytes,q=8*be.sigBytes;return _e[q>>>5]|=128<<24-q%32,_e[14+(q+64>>>9<<4)]=c.floor(A/4294967296),_e[15+(q+64>>>9<<4)]=A,be.sigBytes=4*_e.length,this._process(),this._hash},clone:function(){var be=h.clone.call(this);return be._hash=this._hash.clone(),be}}),u.SHA256=h._createHelper(g),u.HmacSHA256=h._createHmacHelper(g)}(Math),function(){function c(){return h.create.apply(h,arguments)}for(var u=se,d=u.lib.Hasher,h=(y=u.x64).Word,g=y.WordArray,y=u.algo,D=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],B=[],F=0;80>F;F++)B[F]=c();y=y.SHA512=d.extend({_doReset:function(){this._hash=new g.init([new h.init(1779033703,4089235720),new h.init(3144134277,2227873595),new h.init(1013904242,4271175723),new h.init(2773480762,1595750129),new h.init(1359893119,2917565137),new h.init(2600822924,725511199),new h.init(528734635,4215389547),new h.init(1541459225,327033209)])},_doProcessBlock:function(P,U){for(var X=(Y=this._hash.words)[0],ue=Y[1],pe=Y[2],be=Y[3],_e=Y[4],A=Y[5],q=Y[6],Y=Y[7],W=X.high,ve=X.low,Ee=ue.high,Ge=ue.low,Te=pe.high,ht=pe.low,$e=be.high,Xe=be.low,qt=_e.high,mt=_e.low,tt=A.high,ur=A.low,Gn=q.high,Qn=q.low,ze=Y.high,wn=Y.low,Lt=W,Pn=ve,ms=Ee,ys=Ge,zs=Te,Ji=ht,vs=$e,Yi=Xe,mr=qt,yr=mt,st=tt,Qi=ur,Fo=Gn,vr=Qn,Io=ze,To=wn,Sn=0;80>Sn;Sn++){var kn=B[Sn];if(16>Sn)var Pi=kn.high=0|P[U+2*Sn],Zt=kn.low=0|P[U+2*Sn+1];else{Pi=((Zt=(Pi=B[Sn-15]).high)>>>1|(En=Pi.low)<<31)^(Zt>>>8|En<<24)^Zt>>>7;var En=(En>>>1|Zt<<31)^(En>>>8|Zt<<24)^(En>>>7|Zt<<25),_s=((Zt=(_s=B[Sn-2]).high)>>>19|(yn=_s.low)<<13)^(Zt<<3|yn>>>29)^Zt>>>6,yn=(yn>>>19|Zt<<13)^(yn<<3|Zt>>>29)^(yn>>>6|Zt<<26),za=(Zt=B[Sn-7]).high,bs=(xt=B[Sn-16]).high,xt=xt.low;Pi=(Pi=(Pi=Pi+za+((Zt=En+Zt.low)>>>0<En>>>0?1:0))+_s+((Zt+=yn)>>>0<yn>>>0?1:0))+bs+((Zt+=xt)>>>0<xt>>>0?1:0),kn.high=Pi,kn.low=Zt}za=mr&st^~mr&Fo,xt=yr&Qi^~yr&vr,kn=Lt&ms^Lt&zs^ms&zs;var am=Pn&ys^Pn&Ji^ys&Ji,um=(En=(Lt>>>28|Pn<<4)^(Lt<<30|Pn>>>2)^(Lt<<25|Pn>>>7),_s=(Pn>>>28|Lt<<4)^(Pn<<30|Lt>>>2)^(Pn<<25|Lt>>>7),(yn=D[Sn]).high),Zi=yn.low;bs=Io+((mr>>>14|yr<<18)^(mr>>>18|yr<<14)^(mr<<23|yr>>>9))+((yn=To+((yr>>>14|mr<<18)^(yr>>>18|mr<<14)^(yr<<23|mr>>>9)))>>>0<To>>>0?1:0),Io=Fo,To=vr,Fo=st,vr=Qi,st=mr,Qi=yr,mr=vs+(bs=(bs=(bs=bs+za+((yn+=xt)>>>0<xt>>>0?1:0))+um+((yn+=Zi)>>>0<Zi>>>0?1:0))+Pi+((yn+=Zt)>>>0<Zt>>>0?1:0))+((yr=Yi+yn|0)>>>0<Yi>>>0?1:0)|0,vs=zs,Yi=Ji,zs=ms,Ji=ys,ms=Lt,ys=Pn,Lt=bs+(kn=En+kn+((Zt=_s+am)>>>0<_s>>>0?1:0))+((Pn=yn+Zt|0)>>>0<yn>>>0?1:0)|0}ve=X.low=ve+Pn,X.high=W+Lt+(ve>>>0<Pn>>>0?1:0),Ge=ue.low=Ge+ys,ue.high=Ee+ms+(Ge>>>0<ys>>>0?1:0),ht=pe.low=ht+Ji,pe.high=Te+zs+(ht>>>0<Ji>>>0?1:0),Xe=be.low=Xe+Yi,be.high=$e+vs+(Xe>>>0<Yi>>>0?1:0),mt=_e.low=mt+yr,_e.high=qt+mr+(mt>>>0<yr>>>0?1:0),ur=A.low=ur+Qi,A.high=tt+st+(ur>>>0<Qi>>>0?1:0),Qn=q.low=Qn+vr,q.high=Gn+Fo+(Qn>>>0<vr>>>0?1:0),wn=Y.low=wn+To,Y.high=ze+Io+(wn>>>0<To>>>0?1:0)},_doFinalize:function(){var P=this._data,U=P.words,X=8*this._nDataBytes,ue=8*P.sigBytes;return U[ue>>>5]|=128<<24-ue%32,U[30+(ue+128>>>10<<5)]=Math.floor(X/4294967296),U[31+(ue+128>>>10<<5)]=X,P.sigBytes=4*U.length,this._process(),this._hash.toX32()},clone:function(){var P=d.clone.call(this);return P._hash=this._hash.clone(),P},blockSize:32}),u.SHA512=d._createHelper(y),u.HmacSHA512=d._createHmacHelper(y)}(),function(){var c=se,u=(g=c.x64).Word,d=g.WordArray,h=(g=c.algo).SHA512,g=g.SHA384=h.extend({_doReset:function(){this._hash=new d.init([new u.init(3418070365,3238371032),new u.init(1654270250,914150663),new u.init(2438529370,812702999),new u.init(355462360,4144912697),new u.init(1731405415,4290775857),new u.init(2394180231,1750603025),new u.init(3675008525,1694076839),new u.init(1203062813,3204075428)])},_doFinalize:function(){var D=h._doFinalize.call(this);return D.sigBytes-=16,D}});c.SHA384=h._createHelper(g),c.HmacSHA384=h._createHmacHelper(g)}();var le,ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Fe(c){var u,d,h="";for(u=0;u+3<=c.length;u+=3)d=parseInt(c.substring(u,u+3),16),h+=ie.charAt(d>>6)+ie.charAt(63&d);for(u+1==c.length?(d=parseInt(c.substring(u,u+1),16),h+=ie.charAt(d<<2)):u+2==c.length&&(d=parseInt(c.substring(u,u+2),16),h+=ie.charAt(d>>2)+ie.charAt((3&d)<<4));(3&h.length)>0;)h+="=";return h}function Ie(c){var u,d,h,g="",y=0;for(u=0;u<c.length&&"="!=c.charAt(u);++u)(h=ie.indexOf(c.charAt(u)))<0||(0==y?(g+=Gt(h>>2),d=3&h,y=1):1==y?(g+=Gt(d<<2|h>>4),d=15&h,y=2):2==y?(g+=Gt(d),g+=Gt(h>>2),d=3&h,y=3):(g+=Gt(d<<2|h>>4),g+=Gt(15&h),y=0));return 1==y&&(g+=Gt(d<<2)),g}function Be(c){var u,d=Ie(c),h=new Array;for(u=0;2*u<d.length;++u)h[u]=parseInt(d.substring(2*u,2*u+2),16);return h}function ae(c,u,d){null!=c&&("number"==typeof c?this.fromNumber(c,u,d):this.fromString(c,null==u&&"string"!=typeof c?256:u))}function Ye(){return new ae(null)}"Microsoft Internet Explorer"==Q.appName?(ae.prototype.am=function(u,d,h,g,y,D){for(var B=32767&d,F=d>>15;--D>=0;){var N=32767&this[u],P=this[u++]>>15,U=F*N+P*B;y=((N=B*N+((32767&U)<<15)+h[g]+(1073741823&y))>>>30)+(U>>>15)+F*P+(y>>>30),h[g++]=1073741823&N}return y},le=30):"Netscape"!=Q.appName?(ae.prototype.am=function(u,d,h,g,y,D){for(;--D>=0;){var B=d*this[u++]+h[g]+y;y=Math.floor(B/67108864),h[g++]=67108863&B}return y},le=26):(ae.prototype.am=function(u,d,h,g,y,D){for(var B=16383&d,F=d>>14;--D>=0;){var N=16383&this[u],P=this[u++]>>14,U=F*N+P*B;y=((N=B*N+((16383&U)<<14)+h[g]+y)>>28)+(U>>14)+F*P,h[g++]=268435455&N}return y},le=28),ae.prototype.DB=le,ae.prototype.DM=(1<<le)-1,ae.prototype.DV=1<<le,ae.prototype.FV=Math.pow(2,52),ae.prototype.F1=52-le,ae.prototype.F2=2*le-52;var Ot,Pt,$n=new Array;for(Ot="0".charCodeAt(0),Pt=0;Pt<=9;++Pt)$n[Ot++]=Pt;for(Ot="a".charCodeAt(0),Pt=10;Pt<36;++Pt)$n[Ot++]=Pt;for(Ot="A".charCodeAt(0),Pt=10;Pt<36;++Pt)$n[Ot++]=Pt;function Gt(c){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(c)}function _t(c,u){var d=$n[c.charCodeAt(u)];return null==d?-1:d}function nn(c){var u=Ye();return u.fromInt(c),u}function bt(c){var u,d=1;return 0!=(u=c>>>16)&&(c=u,d+=16),0!=(u=c>>8)&&(c=u,d+=8),0!=(u=c>>4)&&(c=u,d+=4),0!=(u=c>>2)&&(c=u,d+=2),0!=(u=c>>1)&&(c=u,d+=1),d}function wt(c){this.m=c}function Yt(c){this.m=c,this.mp=c.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<c.DB-15)-1,this.mt2=2*c.t}function Bt(c,u){return c&u}function Bn(c,u){return c|u}function qn(c,u){return c^u}function Mt(c,u){return c&~u}function Vt(c){if(0==c)return-1;var u=0;return 0==(65535&c)&&(c>>=16,u+=16),0==(255&c)&&(c>>=8,u+=8),0==(15&c)&&(c>>=4,u+=4),0==(3&c)&&(c>>=2,u+=2),0==(1&c)&&++u,u}function ct(c){for(var u=0;0!=c;)c&=c-1,++u;return u}function mn(){}function or(c){return c}function Un(c){this.r2=Ye(),this.q3=Ye(),ae.ONE.dlShiftTo(2*c.t,this.r2),this.mu=this.r2.divide(c),this.m=c}wt.prototype.convert=function(u){return u.s<0||u.compareTo(this.m)>=0?u.mod(this.m):u},wt.prototype.revert=function(u){return u},wt.prototype.reduce=function(u){u.divRemTo(this.m,null,u)},wt.prototype.mulTo=function(u,d,h){u.multiplyTo(d,h),this.reduce(h)},wt.prototype.sqrTo=function(u,d){u.squareTo(d),this.reduce(d)},Yt.prototype.convert=function(u){var d=Ye();return u.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),u.s<0&&d.compareTo(ae.ZERO)>0&&this.m.subTo(d,d),d},Yt.prototype.revert=function(u){var d=Ye();return u.copyTo(d),this.reduce(d),d},Yt.prototype.reduce=function(u){for(;u.t<=this.mt2;)u[u.t++]=0;for(var d=0;d<this.m.t;++d){var h=32767&u[d],g=h*this.mpl+((h*this.mph+(u[d]>>15)*this.mpl&this.um)<<15)&u.DM;for(u[h=d+this.m.t]+=this.m.am(0,g,u,d,0,this.m.t);u[h]>=u.DV;)u[h]-=u.DV,u[++h]++}u.clamp(),u.drShiftTo(this.m.t,u),u.compareTo(this.m)>=0&&u.subTo(this.m,u)},Yt.prototype.mulTo=function(u,d,h){u.multiplyTo(d,h),this.reduce(h)},Yt.prototype.sqrTo=function(u,d){u.squareTo(d),this.reduce(d)},ae.prototype.copyTo=function(u){for(var d=this.t-1;d>=0;--d)u[d]=this[d];u.t=this.t,u.s=this.s},ae.prototype.fromInt=function(u){this.t=1,this.s=u<0?-1:0,u>0?this[0]=u:u<-1?this[0]=u+this.DV:this.t=0},ae.prototype.fromString=function(u,d){var h;if(16==d)h=4;else if(8==d)h=3;else if(256==d)h=8;else if(2==d)h=1;else if(32==d)h=5;else{if(4!=d)return void this.fromRadix(u,d);h=2}this.t=0,this.s=0;for(var g=u.length,y=!1,D=0;--g>=0;){var B=8==h?255&u[g]:_t(u,g);B<0?"-"==u.charAt(g)&&(y=!0):(y=!1,0==D?this[this.t++]=B:D+h>this.DB?(this[this.t-1]|=(B&(1<<this.DB-D)-1)<<D,this[this.t++]=B>>this.DB-D):this[this.t-1]|=B<<D,(D+=h)>=this.DB&&(D-=this.DB))}8==h&&0!=(128&u[0])&&(this.s=-1,D>0&&(this[this.t-1]|=(1<<this.DB-D)-1<<D)),this.clamp(),y&&ae.ZERO.subTo(this,this)},ae.prototype.clamp=function(){for(var u=this.s&this.DM;this.t>0&&this[this.t-1]==u;)--this.t},ae.prototype.dlShiftTo=function(u,d){var h;for(h=this.t-1;h>=0;--h)d[h+u]=this[h];for(h=u-1;h>=0;--h)d[h]=0;d.t=this.t+u,d.s=this.s},ae.prototype.drShiftTo=function(u,d){for(var h=u;h<this.t;++h)d[h-u]=this[h];d.t=Math.max(this.t-u,0),d.s=this.s},ae.prototype.lShiftTo=function(u,d){var h,g=u%this.DB,y=this.DB-g,D=(1<<y)-1,B=Math.floor(u/this.DB),F=this.s<<g&this.DM;for(h=this.t-1;h>=0;--h)d[h+B+1]=this[h]>>y|F,F=(this[h]&D)<<g;for(h=B-1;h>=0;--h)d[h]=0;d[B]=F,d.t=this.t+B+1,d.s=this.s,d.clamp()},ae.prototype.rShiftTo=function(u,d){d.s=this.s;var h=Math.floor(u/this.DB);if(h>=this.t)d.t=0;else{var g=u%this.DB,y=this.DB-g,D=(1<<g)-1;d[0]=this[h]>>g;for(var B=h+1;B<this.t;++B)d[B-h-1]|=(this[B]&D)<<y,d[B-h]=this[B]>>g;g>0&&(d[this.t-h-1]|=(this.s&D)<<y),d.t=this.t-h,d.clamp()}},ae.prototype.subTo=function(u,d){for(var h=0,g=0,y=Math.min(u.t,this.t);h<y;)g+=this[h]-u[h],d[h++]=g&this.DM,g>>=this.DB;if(u.t<this.t){for(g-=u.s;h<this.t;)g+=this[h],d[h++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;h<u.t;)g-=u[h],d[h++]=g&this.DM,g>>=this.DB;g-=u.s}d.s=g<0?-1:0,g<-1?d[h++]=this.DV+g:g>0&&(d[h++]=g),d.t=h,d.clamp()},ae.prototype.multiplyTo=function(u,d){var h=this.abs(),g=u.abs(),y=h.t;for(d.t=y+g.t;--y>=0;)d[y]=0;for(y=0;y<g.t;++y)d[y+h.t]=h.am(0,g[y],d,y,0,h.t);d.s=0,d.clamp(),this.s!=u.s&&ae.ZERO.subTo(d,d)},ae.prototype.squareTo=function(u){for(var d=this.abs(),h=u.t=2*d.t;--h>=0;)u[h]=0;for(h=0;h<d.t-1;++h){var g=d.am(h,d[h],u,2*h,0,1);(u[h+d.t]+=d.am(h+1,2*d[h],u,2*h+1,g,d.t-h-1))>=d.DV&&(u[h+d.t]-=d.DV,u[h+d.t+1]=1)}u.t>0&&(u[u.t-1]+=d.am(h,d[h],u,2*h,0,1)),u.s=0,u.clamp()},ae.prototype.divRemTo=function(u,d,h){var g=u.abs();if(!(g.t<=0)){var y=this.abs();if(y.t<g.t)return null!=d&&d.fromInt(0),void(null!=h&&this.copyTo(h));null==h&&(h=Ye());var D=Ye(),B=this.s,F=u.s,N=this.DB-bt(g[g.t-1]);N>0?(g.lShiftTo(N,D),y.lShiftTo(N,h)):(g.copyTo(D),y.copyTo(h));var P=D.t,U=D[P-1];if(0!=U){var X=U*(1<<this.F1)+(P>1?D[P-2]>>this.F2:0),ue=this.FV/X,pe=(1<<this.F1)/X,be=1<<this.F2,_e=h.t,A=_e-P,q=null==d?Ye():d;for(D.dlShiftTo(A,q),h.compareTo(q)>=0&&(h[h.t++]=1,h.subTo(q,h)),ae.ONE.dlShiftTo(P,q),q.subTo(D,D);D.t<P;)D[D.t++]=0;for(;--A>=0;){var Y=h[--_e]==U?this.DM:Math.floor(h[_e]*ue+(h[_e-1]+be)*pe);if((h[_e]+=D.am(0,Y,h,A,0,P))<Y)for(D.dlShiftTo(A,q),h.subTo(q,h);h[_e]<--Y;)h.subTo(q,h)}null!=d&&(h.drShiftTo(P,d),B!=F&&ae.ZERO.subTo(d,d)),h.t=P,h.clamp(),N>0&&h.rShiftTo(N,h),B<0&&ae.ZERO.subTo(h,h)}}},ae.prototype.invDigit=function(){if(this.t<1)return 0;var u=this[0];if(0==(1&u))return 0;var d=3&u;return(d=(d=(d=(d=d*(2-(15&u)*d)&15)*(2-(255&u)*d)&255)*(2-((65535&u)*d&65535))&65535)*(2-u*d%this.DV)%this.DV)>0?this.DV-d:-d},ae.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},ae.prototype.exp=function(u,d){if(u>4294967295||u<1)return ae.ONE;var h=Ye(),g=Ye(),y=d.convert(this),D=bt(u)-1;for(y.copyTo(h);--D>=0;)if(d.sqrTo(h,g),(u&1<<D)>0)d.mulTo(g,y,h);else{var B=h;h=g,g=B}return d.revert(h)},ae.prototype.toString=function(u){if(this.s<0)return"-"+this.negate().toString(u);var d;if(16==u)d=4;else if(8==u)d=3;else if(2==u)d=1;else if(32==u)d=5;else{if(4!=u)return this.toRadix(u);d=2}var h,g=(1<<d)-1,y=!1,D="",B=this.t,F=this.DB-B*this.DB%d;if(B-- >0)for(F<this.DB&&(h=this[B]>>F)>0&&(y=!0,D=Gt(h));B>=0;)F<d?(h=(this[B]&(1<<F)-1)<<d-F,h|=this[--B]>>(F+=this.DB-d)):(h=this[B]>>(F-=d)&g,F<=0&&(F+=this.DB,--B)),h>0&&(y=!0),y&&(D+=Gt(h));return y?D:"0"},ae.prototype.negate=function(){var u=Ye();return ae.ZERO.subTo(this,u),u},ae.prototype.abs=function(){return this.s<0?this.negate():this},ae.prototype.compareTo=function(u){var d=this.s-u.s;if(0!=d)return d;var h=this.t;if(0!=(d=h-u.t))return this.s<0?-d:d;for(;--h>=0;)if(0!=(d=this[h]-u[h]))return d;return 0},ae.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+bt(this[this.t-1]^this.s&this.DM)},ae.prototype.mod=function(u){var d=Ye();return this.abs().divRemTo(u,null,d),this.s<0&&d.compareTo(ae.ZERO)>0&&u.subTo(d,d),d},ae.prototype.modPowInt=function(u,d){var h;return h=u<256||d.isEven()?new wt(d):new Yt(d),this.exp(u,h)},ae.ZERO=nn(0),ae.ONE=nn(1),mn.prototype.convert=or,mn.prototype.revert=or,mn.prototype.mulTo=function(u,d,h){u.multiplyTo(d,h)},mn.prototype.sqrTo=function(u,d){u.squareTo(d)},Un.prototype.convert=function(u){if(u.s<0||u.t>2*this.m.t)return u.mod(this.m);if(u.compareTo(this.m)<0)return u;var d=Ye();return u.copyTo(d),this.reduce(d),d},Un.prototype.revert=function(u){return u},Un.prototype.reduce=function(u){for(u.drShiftTo(this.m.t-1,this.r2),u.t>this.m.t+1&&(u.t=this.m.t+1,u.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);u.compareTo(this.r2)<0;)u.dAddOffset(1,this.m.t+1);for(u.subTo(this.r2,u);u.compareTo(this.m)>=0;)u.subTo(this.m,u)},Un.prototype.mulTo=function(u,d,h){u.multiplyTo(d,h),this.reduce(h)},Un.prototype.sqrTo=function(u,d){u.squareTo(d),this.reduce(d)};var ee,ce,he,te=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],w=(1<<26)/te[te.length-1];function S(){this.i=0,this.j=0,this.S=new Array}function Ce(){!function(u){ce[he++]^=255&u,ce[he++]^=u>>8&255,ce[he++]^=u>>16&255,ce[he++]^=u>>24&255,he>=256&&(he-=256)}((new Date).getTime())}if(ae.prototype.chunkSize=function(u){return Math.floor(Math.LN2*this.DB/Math.log(u))},ae.prototype.toRadix=function(u){if(null==u&&(u=10),0==this.signum()||u<2||u>36)return"0";var d=this.chunkSize(u),h=Math.pow(u,d),g=nn(h),y=Ye(),D=Ye(),B="";for(this.divRemTo(g,y,D);y.signum()>0;)B=(h+D.intValue()).toString(u).substr(1)+B,y.divRemTo(g,y,D);return D.intValue().toString(u)+B},ae.prototype.fromRadix=function(u,d){this.fromInt(0),null==d&&(d=10);for(var h=this.chunkSize(d),g=Math.pow(d,h),y=!1,D=0,B=0,F=0;F<u.length;++F){var N=_t(u,F);N<0?"-"==u.charAt(F)&&0==this.signum()&&(y=!0):(B=d*B+N,++D>=h&&(this.dMultiply(g),this.dAddOffset(B,0),D=0,B=0))}D>0&&(this.dMultiply(Math.pow(d,D)),this.dAddOffset(B,0)),y&&ae.ZERO.subTo(this,this)},ae.prototype.fromNumber=function(u,d,h){if("number"==typeof d)if(u<2)this.fromInt(1);else for(this.fromNumber(u,h),this.testBit(u-1)||this.bitwiseTo(ae.ONE.shiftLeft(u-1),Bn,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(d);)this.dAddOffset(2,0),this.bitLength()>u&&this.subTo(ae.ONE.shiftLeft(u-1),this);else{var g=new Array,y=7&u;g.length=1+(u>>3),d.nextBytes(g),y>0?g[0]&=(1<<y)-1:g[0]=0,this.fromString(g,256)}},ae.prototype.bitwiseTo=function(u,d,h){var g,y,D=Math.min(u.t,this.t);for(g=0;g<D;++g)h[g]=d(this[g],u[g]);if(u.t<this.t){for(y=u.s&this.DM,g=D;g<this.t;++g)h[g]=d(this[g],y);h.t=this.t}else{for(y=this.s&this.DM,g=D;g<u.t;++g)h[g]=d(y,u[g]);h.t=u.t}h.s=d(this.s,u.s),h.clamp()},ae.prototype.changeBit=function(u,d){var h=ae.ONE.shiftLeft(u);return this.bitwiseTo(h,d,h),h},ae.prototype.addTo=function(u,d){for(var h=0,g=0,y=Math.min(u.t,this.t);h<y;)g+=this[h]+u[h],d[h++]=g&this.DM,g>>=this.DB;if(u.t<this.t){for(g+=u.s;h<this.t;)g+=this[h],d[h++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;h<u.t;)g+=u[h],d[h++]=g&this.DM,g>>=this.DB;g+=u.s}d.s=g<0?-1:0,g>0?d[h++]=g:g<-1&&(d[h++]=this.DV+g),d.t=h,d.clamp()},ae.prototype.dMultiply=function(u){this[this.t]=this.am(0,u-1,this,0,0,this.t),++this.t,this.clamp()},ae.prototype.dAddOffset=function(u,d){if(0!=u){for(;this.t<=d;)this[this.t++]=0;for(this[d]+=u;this[d]>=this.DV;)this[d]-=this.DV,++d>=this.t&&(this[this.t++]=0),++this[d]}},ae.prototype.multiplyLowerTo=function(u,d,h){var g,y=Math.min(this.t+u.t,d);for(h.s=0,h.t=y;y>0;)h[--y]=0;for(g=h.t-this.t;y<g;++y)h[y+this.t]=this.am(0,u[y],h,y,0,this.t);for(g=Math.min(u.t,d);y<g;++y)this.am(0,u[y],h,y,0,d-y);h.clamp()},ae.prototype.multiplyUpperTo=function(u,d,h){--d;var g=h.t=this.t+u.t-d;for(h.s=0;--g>=0;)h[g]=0;for(g=Math.max(d-this.t,0);g<u.t;++g)h[this.t+g-d]=this.am(d-g,u[g],h,0,0,this.t+g-d);h.clamp(),h.drShiftTo(1,h)},ae.prototype.modInt=function(u){if(u<=0)return 0;var d=this.DV%u,h=this.s<0?u-1:0;if(this.t>0)if(0==d)h=this[0]%u;else for(var g=this.t-1;g>=0;--g)h=(d*h+this[g])%u;return h},ae.prototype.millerRabin=function(u){var d=this.subtract(ae.ONE),h=d.getLowestSetBit();if(h<=0)return!1;var g=d.shiftRight(h);(u=u+1>>1)>te.length&&(u=te.length);for(var y=Ye(),D=0;D<u;++D){y.fromInt(te[Math.floor(Math.random()*te.length)]);var B=y.modPow(g,this);if(0!=B.compareTo(ae.ONE)&&0!=B.compareTo(d)){for(var F=1;F++<h&&0!=B.compareTo(d);)if(0==(B=B.modPowInt(2,this)).compareTo(ae.ONE))return!1;if(0!=B.compareTo(d))return!1}}return!0},ae.prototype.clone=function(){var u=Ye();return this.copyTo(u),u},ae.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},ae.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},ae.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},ae.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},ae.prototype.toByteArray=function(){var u=this.t,d=new Array;d[0]=this.s;var h,g=this.DB-u*this.DB%8,y=0;if(u-- >0)for(g<this.DB&&(h=this[u]>>g)!=(this.s&this.DM)>>g&&(d[y++]=h|this.s<<this.DB-g);u>=0;)g<8?(h=(this[u]&(1<<g)-1)<<8-g,h|=this[--u]>>(g+=this.DB-8)):(h=this[u]>>(g-=8)&255,g<=0&&(g+=this.DB,--u)),0!=(128&h)&&(h|=-256),0==y&&(128&this.s)!=(128&h)&&++y,(y>0||h!=this.s)&&(d[y++]=h);return d},ae.prototype.equals=function(u){return 0==this.compareTo(u)},ae.prototype.min=function(u){return this.compareTo(u)<0?this:u},ae.prototype.max=function(u){return this.compareTo(u)>0?this:u},ae.prototype.and=function(u){var d=Ye();return this.bitwiseTo(u,Bt,d),d},ae.prototype.or=function(u){var d=Ye();return this.bitwiseTo(u,Bn,d),d},ae.prototype.xor=function(u){var d=Ye();return this.bitwiseTo(u,qn,d),d},ae.prototype.andNot=function(u){var d=Ye();return this.bitwiseTo(u,Mt,d),d},ae.prototype.not=function(){for(var u=Ye(),d=0;d<this.t;++d)u[d]=this.DM&~this[d];return u.t=this.t,u.s=~this.s,u},ae.prototype.shiftLeft=function(u){var d=Ye();return u<0?this.rShiftTo(-u,d):this.lShiftTo(u,d),d},ae.prototype.shiftRight=function(u){var d=Ye();return u<0?this.lShiftTo(-u,d):this.rShiftTo(u,d),d},ae.prototype.getLowestSetBit=function(){for(var u=0;u<this.t;++u)if(0!=this[u])return u*this.DB+Vt(this[u]);return this.s<0?this.t*this.DB:-1},ae.prototype.bitCount=function(){for(var u=0,d=this.s&this.DM,h=0;h<this.t;++h)u+=ct(this[h]^d);return u},ae.prototype.testBit=function(u){var d=Math.floor(u/this.DB);return d>=this.t?0!=this.s:0!=(this[d]&1<<u%this.DB)},ae.prototype.setBit=function(u){return this.changeBit(u,Bn)},ae.prototype.clearBit=function(u){return this.changeBit(u,Mt)},ae.prototype.flipBit=function(u){return this.changeBit(u,qn)},ae.prototype.add=function(u){var d=Ye();return this.addTo(u,d),d},ae.prototype.subtract=function(u){var d=Ye();return this.subTo(u,d),d},ae.prototype.multiply=function(u){var d=Ye();return this.multiplyTo(u,d),d},ae.prototype.divide=function(u){var d=Ye();return this.divRemTo(u,d,null),d},ae.prototype.remainder=function(u){var d=Ye();return this.divRemTo(u,null,d),d},ae.prototype.divideAndRemainder=function(u){var d=Ye(),h=Ye();return this.divRemTo(u,d,h),new Array(d,h)},ae.prototype.modPow=function(u,d){var h,g,y=u.bitLength(),D=nn(1);if(y<=0)return D;h=y<18?1:y<48?3:y<144?4:y<768?5:6,g=y<8?new wt(d):d.isEven()?new Un(d):new Yt(d);var B=new Array,F=3,N=h-1,P=(1<<h)-1;if(B[1]=g.convert(this),h>1){var U=Ye();for(g.sqrTo(B[1],U);F<=P;)B[F]=Ye(),g.mulTo(U,B[F-2],B[F]),F+=2}var X,ue,pe=u.t-1,be=!0,_e=Ye();for(y=bt(u[pe])-1;pe>=0;){for(y>=N?X=u[pe]>>y-N&P:(X=(u[pe]&(1<<y+1)-1)<<N-y,pe>0&&(X|=u[pe-1]>>this.DB+y-N)),F=h;0==(1&X);)X>>=1,--F;if((y-=F)<0&&(y+=this.DB,--pe),be)B[X].copyTo(D),be=!1;else{for(;F>1;)g.sqrTo(D,_e),g.sqrTo(_e,D),F-=2;F>0?g.sqrTo(D,_e):(ue=D,D=_e,_e=ue),g.mulTo(_e,B[X],D)}for(;pe>=0&&0==(u[pe]&1<<y);)g.sqrTo(D,_e),ue=D,D=_e,_e=ue,--y<0&&(y=this.DB-1,--pe)}return g.revert(D)},ae.prototype.modInverse=function(u){var d=u.isEven();if(this.isEven()&&d||0==u.signum())return ae.ZERO;for(var h=u.clone(),g=this.clone(),y=nn(1),D=nn(0),B=nn(0),F=nn(1);0!=h.signum();){for(;h.isEven();)h.rShiftTo(1,h),d?(y.isEven()&&D.isEven()||(y.addTo(this,y),D.subTo(u,D)),y.rShiftTo(1,y)):D.isEven()||D.subTo(u,D),D.rShiftTo(1,D);for(;g.isEven();)g.rShiftTo(1,g),d?(B.isEven()&&F.isEven()||(B.addTo(this,B),F.subTo(u,F)),B.rShiftTo(1,B)):F.isEven()||F.subTo(u,F),F.rShiftTo(1,F);h.compareTo(g)>=0?(h.subTo(g,h),d&&y.subTo(B,y),D.subTo(F,D)):(g.subTo(h,g),d&&B.subTo(y,B),F.subTo(D,F))}return 0!=g.compareTo(ae.ONE)?ae.ZERO:F.compareTo(u)>=0?F.subtract(u):F.signum()<0?(F.addTo(u,F),F.signum()<0?F.add(u):F):F},ae.prototype.pow=function(u){return this.exp(u,new mn)},ae.prototype.gcd=function(u){var d=this.s<0?this.negate():this.clone(),h=u.s<0?u.negate():u.clone();if(d.compareTo(h)<0){var g=d;d=h,h=g}var y=d.getLowestSetBit(),D=h.getLowestSetBit();if(D<0)return d;for(y<D&&(D=y),D>0&&(d.rShiftTo(D,d),h.rShiftTo(D,h));d.signum()>0;)(y=d.getLowestSetBit())>0&&d.rShiftTo(y,d),(y=h.getLowestSetBit())>0&&h.rShiftTo(y,h),d.compareTo(h)>=0?(d.subTo(h,d),d.rShiftTo(1,d)):(h.subTo(d,h),h.rShiftTo(1,h));return D>0&&h.lShiftTo(D,h),h},ae.prototype.isProbablePrime=function(u){var d,h=this.abs();if(1==h.t&&h[0]<=te[te.length-1]){for(d=0;d<te.length;++d)if(h[0]==te[d])return!0;return!1}if(h.isEven())return!1;for(d=1;d<te.length;){for(var g=te[d],y=d+1;y<te.length&&g<w;)g*=te[y++];for(g=h.modInt(g);d<y;)if(g%te[d++]==0)return!1}return h.millerRabin(u)},ae.prototype.square=function(){var u=Ye();return this.squareTo(u),u},S.prototype.init=function(u){var d,h,g;for(d=0;d<256;++d)this.S[d]=d;for(h=0,d=0;d<256;++d)g=this.S[d],this.S[d]=this.S[h=h+this.S[d]+u[d%u.length]&255],this.S[h]=g;this.i=0,this.j=0},S.prototype.next=function(){var u;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,u=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=u,this.S[u+this.S[this.i]&255]},null==ce){var Ke;if(ce=new Array,he=0,void 0!==M&&(void 0!==M.crypto||void 0!==M.msCrypto)){var it=M.crypto||M.msCrypto;if(it.getRandomValues){var kt=new Uint8Array(32);for(it.getRandomValues(kt),Ke=0;Ke<32;++Ke)ce[he++]=kt[Ke]}else if("Netscape"==Q.appName&&Q.appVersion<"5"){var Et=M.crypto.random(32);for(Ke=0;Ke<Et.length;++Ke)ce[he++]=255&Et.charCodeAt(Ke)}}for(;he<256;)Ke=Math.floor(65536*Math.random()),ce[he++]=Ke>>>8,ce[he++]=255&Ke;he=0,Ce()}function rn(){if(null==ee){for(Ce(),(ee=new S).init(ce),he=0;he<ce.length;++he)ce[he]=0;he=0}return ee.next()}function Kn(){}function cn(c,u){return new ae(c,u)}function Fr(c,u,d){for(var h="",g=0;h.length<u;)h+=d(String.fromCharCode.apply(String,c.concat([(4278190080&g)>>24,(16711680&g)>>16,(65280&g)>>8,255&g]))),g+=1;return h}function et(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Qt(c,u){this.x=u,this.q=c}function At(c,u,d,h){this.curve=c,this.x=u,this.y=d,this.z=null==h?ae.ONE:h,this.zinv=null}function Ii(c,u,d){this.q=c,this.a=this.fromBigInteger(u),this.b=this.fromBigInteger(d),this.infinity=new At(this,null,null)}Kn.prototype.nextBytes=function(u){var d;for(d=0;d<u.length;++d)u[d]=rn()},et.prototype.doPublic=function(u){return u.modPowInt(this.e,this.n)},et.prototype.setPublic=function(u,d){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof u)this.n=u,this.e=d;else{if(!(null!=u&&null!=d&&u.length>0&&d.length>0))throw"Invalid RSA public key";this.n=cn(u,16),this.e=parseInt(d,16)}},et.prototype.encrypt=function(u){var d=function(D,B){if(B<D.length+11)throw"Message too long for RSA";for(var F=new Array,N=D.length-1;N>=0&&B>0;){var P=D.charCodeAt(N--);P<128?F[--B]=P:P>127&&P<2048?(F[--B]=63&P|128,F[--B]=P>>6|192):(F[--B]=63&P|128,F[--B]=P>>6&63|128,F[--B]=P>>12|224)}F[--B]=0;for(var U=new Kn,X=new Array;B>2;){for(X[0]=0;0==X[0];)U.nextBytes(X);F[--B]=X[0]}return F[--B]=2,F[--B]=0,new ae(F)}(u,this.n.bitLength()+7>>3);if(null==d)return null;var h=this.doPublic(d);if(null==h)return null;var g=h.toString(16);return 0==(1&g.length)?g:"0"+g},et.prototype.encryptOAEP=function(u,d,h){var g=function(F,N,P,U){var X=k.crypto.MessageDigest,ue=k.crypto.Util,pe=null;if(P||(P="sha1"),"string"==typeof P&&(pe=X.getCanonicalAlgName(P),U=X.getHashLength(pe),P=function(Te){return ar(ue.hashHex(qr(Te),pe))}),F.length+2*U+2>N)throw"Message too long for RSA";var be,_e="";for(be=0;be<N-F.length-2*U-2;be+=1)_e+="\0";var A=P("")+_e+"\x01"+F,q=new Array(U);(new Kn).nextBytes(q);var Y=Fr(q,A.length,P),W=[];for(be=0;be<A.length;be+=1)W[be]=A.charCodeAt(be)^Y.charCodeAt(be);var ve=Fr(W,q.length,P),Ee=[0];for(be=0;be<q.length;be+=1)Ee[be+1]=q[be]^ve.charCodeAt(be);return new ae(Ee.concat(W))}(u,this.n.bitLength()+7>>3,d,h);if(null==g)return null;var y=this.doPublic(g);if(null==y)return null;var D=y.toString(16);return 0==(1&D.length)?D:"0"+D},et.prototype.type="RSA",Qt.prototype.equals=function(u){return u==this||this.q.equals(u.q)&&this.x.equals(u.x)},Qt.prototype.toBigInteger=function(){return this.x},Qt.prototype.negate=function(){return new Qt(this.q,this.x.negate().mod(this.q))},Qt.prototype.add=function(u){return new Qt(this.q,this.x.add(u.toBigInteger()).mod(this.q))},Qt.prototype.subtract=function(u){return new Qt(this.q,this.x.subtract(u.toBigInteger()).mod(this.q))},Qt.prototype.multiply=function(u){return new Qt(this.q,this.x.multiply(u.toBigInteger()).mod(this.q))},Qt.prototype.square=function(){return new Qt(this.q,this.x.square().mod(this.q))},Qt.prototype.divide=function(u){return new Qt(this.q,this.x.multiply(u.toBigInteger().modInverse(this.q)).mod(this.q))},At.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},At.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},At.prototype.equals=function(u){return u==this||(this.isInfinity()?u.isInfinity():u.isInfinity()?this.isInfinity():!!u.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(u.z)).mod(this.curve.q).equals(ae.ZERO)&&u.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(u.z)).mod(this.curve.q).equals(ae.ZERO))},At.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(ae.ZERO)&&!this.y.toBigInteger().equals(ae.ZERO)},At.prototype.negate=function(){return new At(this.curve,this.x,this.y.negate(),this.z)},At.prototype.add=function(u){if(this.isInfinity())return u;if(u.isInfinity())return this;var d=u.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(u.z)).mod(this.curve.q),h=u.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(u.z)).mod(this.curve.q);if(ae.ZERO.equals(h))return ae.ZERO.equals(d)?this.twice():this.curve.getInfinity();var g=new ae("3"),y=this.x.toBigInteger(),D=this.y.toBigInteger(),B=(u.x.toBigInteger(),u.y.toBigInteger(),h.square()),F=B.multiply(h),N=y.multiply(B),P=d.square().multiply(this.z),U=P.subtract(N.shiftLeft(1)).multiply(u.z).subtract(F).multiply(h).mod(this.curve.q),X=N.multiply(g).multiply(d).subtract(D.multiply(F)).subtract(P.multiply(d)).multiply(u.z).add(d.multiply(F)).mod(this.curve.q),ue=F.multiply(this.z).multiply(u.z).mod(this.curve.q);return new At(this.curve,this.curve.fromBigInteger(U),this.curve.fromBigInteger(X),ue)},At.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var u=new ae("3"),d=this.x.toBigInteger(),h=this.y.toBigInteger(),g=h.multiply(this.z),y=g.multiply(h).mod(this.curve.q),D=this.curve.a.toBigInteger(),B=d.square().multiply(u);ae.ZERO.equals(D)||(B=B.add(this.z.square().multiply(D)));var F=(B=B.mod(this.curve.q)).square().subtract(d.shiftLeft(3).multiply(y)).shiftLeft(1).multiply(g).mod(this.curve.q),N=B.multiply(u).multiply(d).subtract(y.shiftLeft(1)).shiftLeft(2).multiply(y).subtract(B.square().multiply(B)).mod(this.curve.q),P=g.square().multiply(g).shiftLeft(3).mod(this.curve.q);return new At(this.curve,this.curve.fromBigInteger(F),this.curve.fromBigInteger(N),P)},At.prototype.multiply=function(u){if(this.isInfinity())return this;if(0==u.signum())return this.curve.getInfinity();var d,h=u,g=h.multiply(new ae("3")),y=this.negate(),D=this,B=this.curve.q.subtract(u),F=B.multiply(new ae("3")),N=new At(this.curve,this.x,this.y),P=N.negate();for(d=g.bitLength()-2;d>0;--d){D=D.twice();var U=g.testBit(d);U!=h.testBit(d)&&(D=D.add(U?this:y))}for(d=F.bitLength()-2;d>0;--d){N=N.twice();var X=F.testBit(d);X!=B.testBit(d)&&(N=N.add(X?N:P))}return D},At.prototype.multiplyTwo=function(u,d,h){var g;g=u.bitLength()>h.bitLength()?u.bitLength()-1:h.bitLength()-1;for(var y=this.curve.getInfinity(),D=this.add(d);g>=0;)y=y.twice(),u.testBit(g)?y=h.testBit(g)?y.add(D):y.add(this):h.testBit(g)&&(y=y.add(d)),--g;return y},Ii.prototype.getQ=function(){return this.q},Ii.prototype.getA=function(){return this.a},Ii.prototype.getB=function(){return this.b},Ii.prototype.equals=function(u){return u==this||this.q.equals(u.q)&&this.a.equals(u.a)&&this.b.equals(u.b)},Ii.prototype.getInfinity=function(){return this.infinity},Ii.prototype.fromBigInteger=function(u){return new Qt(this.q,u)},Ii.prototype.decodePointHex=function(u){switch(parseInt(u.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:default:return null;case 4:case 6:case 7:var d=(u.length-2)/2,h=u.substr(2,d),g=u.substr(d+2,d);return new At(this,this.fromBigInteger(new ae(h,16)),this.fromBigInteger(new ae(g,16)))}},Qt.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},At.prototype.getEncoded=function(c){var u=function(D,B){var F=D.toByteArrayUnsigned();if(B<F.length)F=F.slice(F.length-B);else for(;B>F.length;)F.unshift(0);return F},d=this.getX().toBigInteger(),h=this.getY().toBigInteger(),g=u(d,32);return c?h.isEven()?g.unshift(2):g.unshift(3):(g.unshift(4),g=g.concat(u(h,32))),g},At.decodeFrom=function(c,u){var d=u.length-1,h=u.slice(1,1+d/2),g=u.slice(1+d/2,1+d);h.unshift(0),g.unshift(0);var y=new ae(h),D=new ae(g);return new At(c,c.fromBigInteger(y),c.fromBigInteger(D))},At.decodeFromHex=function(c,u){u.substr(0,2);var d=u.length-2,h=u.substr(2,d/2),g=u.substr(2+d/2,d/2),y=new ae(h,16),D=new ae(g,16);return new At(c,c.fromBigInteger(y),c.fromBigInteger(D))},At.prototype.add2D=function(c){if(this.isInfinity())return c;if(c.isInfinity())return this;if(this.x.equals(c.x))return this.y.equals(c.y)?this.twice():this.curve.getInfinity();var u=c.x.subtract(this.x),d=c.y.subtract(this.y).divide(u),h=d.square().subtract(this.x).subtract(c.x),g=d.multiply(this.x.subtract(h)).subtract(this.y);return new At(this.curve,h,g)},At.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var c=this.curve.fromBigInteger(ae.valueOf(2)),u=this.curve.fromBigInteger(ae.valueOf(3)),d=this.x.square().multiply(u).add(this.curve.a).divide(this.y.multiply(c)),h=d.square().subtract(this.x.multiply(c)),g=d.multiply(this.x.subtract(h)).subtract(this.y);return new At(this.curve,h,g)},At.prototype.multiply2D=function(c){if(this.isInfinity())return this;if(0==c.signum())return this.curve.getInfinity();var u,d=c,h=d.multiply(new ae("3")),g=this.negate(),y=this;for(u=h.bitLength()-2;u>0;--u){y=y.twice();var D=h.testBit(u);D!=d.testBit(u)&&(y=y.add2D(D?this:g))}return y},At.prototype.isOnCurve=function(){var c=this.getX().toBigInteger(),u=this.getY().toBigInteger(),d=this.curve.getA().toBigInteger(),h=this.curve.getB().toBigInteger(),g=this.curve.getQ(),y=u.multiply(u).mod(g),D=c.multiply(c).multiply(c).add(d.multiply(c)).add(h).mod(g);return y.equals(D)},At.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},At.prototype.validate=function(){var c=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var u=this.getX().toBigInteger(),d=this.getY().toBigInteger();if(u.compareTo(ae.ONE)<0||u.compareTo(c.subtract(ae.ONE))>0)throw new Error("x coordinate out of bounds");if(d.compareTo(ae.ONE)<0||d.compareTo(c.subtract(ae.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(c).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Gd=function(){var c=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),u=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),d={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function h(D,B,F){return B?d[B]:String.fromCharCode(parseInt(F,16))}var g=new String(""),y=Object.hasOwnProperty;return function(D,B){var F,N,P=D.match(c),U=P[0],X=!1;"{"===U?F={}:"["===U?F=[]:(F=[],X=!0);for(var ue=[F],pe=1-X,be=P.length;pe<be;++pe){var _e;switch((U=P[pe]).charCodeAt(0)){default:(_e=ue[0])[N||_e.length]=+U,N=void 0;break;case 34:if(-1!==(U=U.substring(1,U.length-1)).indexOf("\\")&&(U=U.replace(u,h)),_e=ue[0],!N){if(!(_e instanceof Array)){N=U||g;break}N=_e.length}_e[N]=U,N=void 0;break;case 91:ue.unshift((_e=ue[0])[N||_e.length]=[]),N=void 0;break;case 93:case 125:ue.shift();break;case 102:(_e=ue[0])[N||_e.length]=!1,N=void 0;break;case 110:(_e=ue[0])[N||_e.length]=null,N=void 0;break;case 116:(_e=ue[0])[N||_e.length]=!0,N=void 0;break;case 123:ue.unshift((_e=ue[0])[N||_e.length]={}),N=void 0}}if(X){if(1!==ue.length)throw new Error;F=F[0]}else if(ue.length)throw new Error;return B&&(F=function A(q,Y){var W=q[Y];if(W&&"object"===(void 0===W?"undefined":C(W))){var ve=null;for(var Ee in W)if(y.call(W,Ee)&&W!==q){var Ge=A(W,Ee);void 0!==Ge?W[Ee]=Ge:(ve||(ve=[]),ve.push(Ee))}if(ve)for(var Te=ve.length;--Te>=0;)delete W[ve[Te]]}return B.call(q,Y,W)}({"":F},"")),F}}();void 0!==k&&k||(O.KJUR=k={}),void 0!==k.asn1&&k.asn1||(k.asn1={}),k.asn1.ASN1Util=new function(){this.integerToByteHex=function(c){var u=c.toString(16);return u.length%2==1&&(u="0"+u),u},this.bigIntToMinTwosComplementsHex=function(c){var u=c.toString(16);if("-"!=u.substr(0,1))u.length%2==1?u="0"+u:u.match(/^[0-7]/)||(u="00"+u);else{var d=u.substr(1).length;d%2==1?d+=1:u.match(/^[0-7]/)||(d+=2);for(var h="",g=0;g<d;g++)h+="f";u=new ae(h,16).xor(c).add(ae.ONE).toString(16).replace(/^-/,"")}return u},this.getPEMStringFromHex=function(c,u){return Yn(c,u)},this.newObject=function(c){var u=k.asn1,d=u.ASN1Object,h=u.DERBoolean,g=u.DERInteger,y=u.DERBitString,D=u.DEROctetString,B=u.DERNull,F=u.DERObjectIdentifier,N=u.DEREnumerated,P=u.DERUTF8String,U=u.DERNumericString,X=u.DERPrintableString,ue=u.DERTeletexString,pe=u.DERIA5String,be=u.DERUTCTime,_e=u.DERGeneralizedTime,A=u.DERVisibleString,q=u.DERBMPString,Y=u.DERSequence,W=u.DERSet,ve=u.DERTaggedObject,Ee=u.ASN1Util.newObject;if(c instanceof u.ASN1Object)return c;var Ge=Object.keys(c);if(1!=Ge.length)throw new Error("key of param shall be only one.");var Te=Ge[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+Te+":"))throw new Error("undefined key: "+Te);if("bool"==Te)return new h(c[Te]);if("int"==Te)return new g(c[Te]);if("bitstr"==Te)return new y(c[Te]);if("octstr"==Te)return new D(c[Te]);if("null"==Te)return new B(c[Te]);if("oid"==Te)return new F(c[Te]);if("enum"==Te)return new N(c[Te]);if("utf8str"==Te)return new P(c[Te]);if("numstr"==Te)return new U(c[Te]);if("prnstr"==Te)return new X(c[Te]);if("telstr"==Te)return new ue(c[Te]);if("ia5str"==Te)return new pe(c[Te]);if("utctime"==Te)return new be(c[Te]);if("gentime"==Te)return new _e(c[Te]);if("visstr"==Te)return new A(c[Te]);if("bmpstr"==Te)return new q(c[Te]);if("asn1"==Te)return new d(c[Te]);if("seq"==Te){for(var ht=c[Te],$e=[],Xe=0;Xe<ht.length;Xe++){var qt=Ee(ht[Xe]);$e.push(qt)}return new Y({array:$e})}if("set"==Te){for(ht=c[Te],$e=[],Xe=0;Xe<ht.length;Xe++)qt=Ee(ht[Xe]),$e.push(qt);return new W({array:$e})}if("tag"==Te){var mt=c[Te];if("[object Array]"===Object.prototype.toString.call(mt)&&3==mt.length){var tt=Ee(mt[2]);return new ve({tag:mt[0],explicit:mt[1],obj:tt})}return new ve(mt)}},this.jsonToASN1HEX=function(c){return this.newObject(c).getEncodedHex()}},k.asn1.ASN1Util.oidHexToInt=function(c){for(var u="",d=parseInt(c.substr(0,2),16),h=(u=Math.floor(d/40)+"."+d%40,""),g=2;g<c.length;g+=2){var y=("00000000"+parseInt(c.substr(g,2),16).toString(2)).slice(-8);h+=y.substr(1,7),"0"==y.substr(0,1)&&(u=u+"."+new ae(h,2).toString(10),h="")}return u},k.asn1.ASN1Util.oidIntToHex=function(c){var u=function(F){var N=F.toString(16);return 1==N.length&&(N="0"+N),N},d=function(F){var N="",P=new ae(F,10).toString(2),U=7-P.length%7;7==U&&(U=0);for(var X="",ue=0;ue<U;ue++)X+="0";for(P=X+P,ue=0;ue<P.length-1;ue+=7){var pe=P.substr(ue,7);ue!=P.length-7&&(pe="1"+pe),N+=u(parseInt(pe,2))}return N};if(!c.match(/^[0-9.]+$/))throw"malformed oid string: "+c;var h="",g=c.split("."),y=40*parseInt(g[0])+parseInt(g[1]);h+=u(y),g.splice(0,2);for(var D=0;D<g.length;D++)h+=d(g[D]);return h},k.asn1.ASN1Object=function(c){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+"".length+",v="+this.hV);var u=this.hV.length/2,d=u.toString(16);if(d.length%2==1&&(d="0"+d),u<128)return d;var h=d.length/2;if(h>15)throw"ASN.1 length too long to represent by 8x: n = "+u.toString(16);return(128+h).toString(16)+d},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(u){this.params=u},null!=c&&null!=c.tlv&&(this.hTLV=c.tlv,this.isModified=!1)},k.asn1.DERAbstractString=function(c){k.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.s=u,this.hV=xo(this.s).toLowerCase()},this.setStringHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.getFreshValueHex=function(){return this.hV},void 0!==c&&("string"==typeof c?this.setString(c):void 0!==c.str?this.setString(c.str):void 0!==c.hex&&this.setStringHex(c.hex))},_.lang.extend(k.asn1.DERAbstractString,k.asn1.ASN1Object),k.asn1.DERAbstractTime=function(c){k.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(u){var d=u.getTime()+6e4*u.getTimezoneOffset();return new Date(d)},this.formatDate=function(u,d,h){var g=this.zeroPadding,y=this.localDateToUTC(u),D=String(y.getFullYear());"utc"==d&&(D=D.substr(2,2));var B=D+g(String(y.getMonth()+1),2)+g(String(y.getDate()),2)+g(String(y.getHours()),2)+g(String(y.getMinutes()),2)+g(String(y.getSeconds()),2);if(!0===h){var F=y.getMilliseconds();if(0!=F){var N=g(String(F),3);B=B+"."+(N=N.replace(/[0]+$/,""))}}return B+"Z"},this.zeroPadding=function(u,d){return u.length>=d?u:new Array(d-u.length+1).join("0")+u},this.getString=function(){return this.s},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.s=u,this.hV=$r(u)},this.setByDateValue=function(u,d,h,g,y,D){var B=new Date(Date.UTC(u,d-1,h,g,y,D,0));this.setByDate(B)},this.getFreshValueHex=function(){return this.hV}},_.lang.extend(k.asn1.DERAbstractTime,k.asn1.ASN1Object),k.asn1.DERAbstractStructured=function(c){k.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array=u},this.appendASN1Object=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array.push(u)},this.asn1Array=new Array,void 0!==c&&void 0!==c.array&&(this.asn1Array=c.array)},_.lang.extend(k.asn1.DERAbstractStructured,k.asn1.ASN1Object),k.asn1.DERBoolean=function(c){k.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==c?"010100":"0101ff"},_.lang.extend(k.asn1.DERBoolean,k.asn1.ASN1Object),k.asn1.DERInteger=function(c){k.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(u){this.hTLV=null,this.isModified=!0,this.hV=k.asn1.ASN1Util.bigIntToMinTwosComplementsHex(u)},this.setByInteger=function(u){var d=new ae(String(u),10);this.setByBigInteger(d)},this.setValueHex=function(u){this.hV=u},this.getFreshValueHex=function(){return this.hV},void 0!==c&&(void 0!==c.bigint?this.setByBigInteger(c.bigint):void 0!==c.int?this.setByInteger(c.int):"number"==typeof c?this.setByInteger(c):void 0!==c.hex&&this.setValueHex(c.hex))},_.lang.extend(k.asn1.DERInteger,k.asn1.ASN1Object),k.asn1.DERBitString=function(c){if(void 0!==c&&void 0!==c.obj){var u=k.asn1.ASN1Util.newObject(c.obj);c.hex="00"+u.getEncodedHex()}k.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(d){this.hTLV=null,this.isModified=!0,this.hV=d},this.setUnusedBitsAndHexValue=function(d,h){if(d<0||7<d)throw"unused bits shall be from 0 to 7: u = "+d;var g="0"+d;this.hTLV=null,this.isModified=!0,this.hV=g+h},this.setByBinaryString=function(d){var h=8-(d=d.replace(/0+$/,"")).length%8;8==h&&(h=0);for(var g=0;g<=h;g++)d+="0";var y="";for(g=0;g<d.length-1;g+=8){var D=d.substr(g,8),B=parseInt(D,2).toString(16);1==B.length&&(B="0"+B),y+=B}this.hTLV=null,this.isModified=!0,this.hV="0"+h+y},this.setByBooleanArray=function(d){for(var h="",g=0;g<d.length;g++)h+=1==d[g]?"1":"0";this.setByBinaryString(h)},this.newFalseArray=function(d){for(var h=new Array(d),g=0;g<d;g++)h[g]=!1;return h},this.getFreshValueHex=function(){return this.hV},void 0!==c&&("string"==typeof c&&c.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(c):void 0!==c.hex?this.setHexValueIncludingUnusedBits(c.hex):void 0!==c.bin?this.setByBinaryString(c.bin):void 0!==c.array&&this.setByBooleanArray(c.array))},_.lang.extend(k.asn1.DERBitString,k.asn1.ASN1Object),k.asn1.DEROctetString=function(c){if(void 0!==c&&void 0!==c.obj){var u=k.asn1.ASN1Util.newObject(c.obj);c.hex=u.getEncodedHex()}k.asn1.DEROctetString.superclass.constructor.call(this,c),this.hT="04"},_.lang.extend(k.asn1.DEROctetString,k.asn1.DERAbstractString),k.asn1.DERNull=function(){k.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},_.lang.extend(k.asn1.DERNull,k.asn1.ASN1Object),k.asn1.DERObjectIdentifier=function(c){k.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.setValueOidString=function(u){var d=function(g){var y=function(X){var ue=X.toString(16);return 1==ue.length&&(ue="0"+ue),ue},D=function(X){var ue="",pe=parseInt(X,10).toString(2),be=7-pe.length%7;7==be&&(be=0);for(var _e="",A=0;A<be;A++)_e+="0";for(pe=_e+pe,A=0;A<pe.length-1;A+=7){var q=pe.substr(A,7);A!=pe.length-7&&(q="1"+q),ue+=y(parseInt(q,2))}return ue};try{if(!g.match(/^[0-9.]+$/))return null;var B="",F=g.split("."),N=40*parseInt(F[0],10)+parseInt(F[1],10);B+=y(N),F.splice(0,2);for(var P=0;P<F.length;P++)B+=D(F[P]);return B}catch(U){return null}}(u);if(null==d)throw new Error("malformed oid string: "+u);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=d},this.setValueName=function(u){var d=k.asn1.x509.OID.name2oid(u);if(""===d)throw new Error("DERObjectIdentifier oidName undefined: "+u);this.setValueOidString(d)},this.setValueNameOrOid=function(u){u.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(u):this.setValueName(u)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(u){"string"==typeof u?this.setValueNameOrOid(u):void 0!==u.oid?this.setValueNameOrOid(u.oid):void 0!==u.name?this.setValueNameOrOid(u.name):void 0!==u.hex&&this.setValueHex(u.hex)},void 0!==c&&this.setByParam(c)},_.lang.extend(k.asn1.DERObjectIdentifier,k.asn1.ASN1Object),k.asn1.DEREnumerated=function(c){k.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(u){this.hTLV=null,this.isModified=!0,this.hV=k.asn1.ASN1Util.bigIntToMinTwosComplementsHex(u)},this.setByInteger=function(u){var d=new ae(String(u),10);this.setByBigInteger(d)},this.setValueHex=function(u){this.hV=u},this.getFreshValueHex=function(){return this.hV},void 0!==c&&(void 0!==c.int?this.setByInteger(c.int):"number"==typeof c?this.setByInteger(c):void 0!==c.hex&&this.setValueHex(c.hex))},_.lang.extend(k.asn1.DEREnumerated,k.asn1.ASN1Object),k.asn1.DERUTF8String=function(c){k.asn1.DERUTF8String.superclass.constructor.call(this,c),this.hT="0c"},_.lang.extend(k.asn1.DERUTF8String,k.asn1.DERAbstractString),k.asn1.DERNumericString=function(c){k.asn1.DERNumericString.superclass.constructor.call(this,c),this.hT="12"},_.lang.extend(k.asn1.DERNumericString,k.asn1.DERAbstractString),k.asn1.DERPrintableString=function(c){k.asn1.DERPrintableString.superclass.constructor.call(this,c),this.hT="13"},_.lang.extend(k.asn1.DERPrintableString,k.asn1.DERAbstractString),k.asn1.DERTeletexString=function(c){k.asn1.DERTeletexString.superclass.constructor.call(this,c),this.hT="14"},_.lang.extend(k.asn1.DERTeletexString,k.asn1.DERAbstractString),k.asn1.DERIA5String=function(c){k.asn1.DERIA5String.superclass.constructor.call(this,c),this.hT="16"},_.lang.extend(k.asn1.DERIA5String,k.asn1.DERAbstractString),k.asn1.DERVisibleString=function(c){k.asn1.DERIA5String.superclass.constructor.call(this,c),this.hT="1a"},_.lang.extend(k.asn1.DERVisibleString,k.asn1.DERAbstractString),k.asn1.DERBMPString=function(c){k.asn1.DERBMPString.superclass.constructor.call(this,c),this.hT="1e"},_.lang.extend(k.asn1.DERBMPString,k.asn1.DERAbstractString),k.asn1.DERUTCTime=function(c){k.asn1.DERUTCTime.superclass.constructor.call(this,c),this.hT="17",this.setByDate=function(u){this.hTLV=null,this.isModified=!0,this.date=u,this.s=this.formatDate(this.date,"utc"),this.hV=$r(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=$r(this.s)),this.hV},void 0!==c&&(void 0!==c.str?this.setString(c.str):"string"==typeof c&&c.match(/^[0-9]{12}Z$/)?this.setString(c):void 0!==c.hex?this.setStringHex(c.hex):void 0!==c.date&&this.setByDate(c.date))},_.lang.extend(k.asn1.DERUTCTime,k.asn1.DERAbstractTime),k.asn1.DERGeneralizedTime=function(c){k.asn1.DERGeneralizedTime.superclass.constructor.call(this,c),this.hT="18",this.withMillis=!1,this.setByDate=function(u){this.hTLV=null,this.isModified=!0,this.date=u,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=$r(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=$r(this.s)),this.hV},void 0!==c&&(void 0!==c.str?this.setString(c.str):"string"==typeof c&&c.match(/^[0-9]{14}Z$/)?this.setString(c):void 0!==c.hex?this.setStringHex(c.hex):void 0!==c.date&&this.setByDate(c.date),!0===c.millis&&(this.withMillis=!0))},_.lang.extend(k.asn1.DERGeneralizedTime,k.asn1.DERAbstractTime),k.asn1.DERSequence=function(c){k.asn1.DERSequence.superclass.constructor.call(this,c),this.hT="30",this.getFreshValueHex=function(){for(var u="",d=0;d<this.asn1Array.length;d++)u+=this.asn1Array[d].getEncodedHex();return this.hV=u,this.hV}},_.lang.extend(k.asn1.DERSequence,k.asn1.DERAbstractStructured),k.asn1.DERSet=function(c){k.asn1.DERSet.superclass.constructor.call(this,c),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var u=new Array,d=0;d<this.asn1Array.length;d++)u.push(this.asn1Array[d].getEncodedHex());return 1==this.sortFlag&&u.sort(),this.hV=u.join(""),this.hV},void 0!==c&&void 0!==c.sortflag&&0==c.sortflag&&(this.sortFlag=!1)},_.lang.extend(k.asn1.DERSet,k.asn1.DERAbstractStructured),k.asn1.DERTaggedObject=function(c){k.asn1.DERTaggedObject.superclass.constructor.call(this);var u=k.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(d,h,g){this.hT=h,this.isExplicit=d,this.asn1Object=g,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=g.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,h),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(d){null!=d.tag&&(this.hT=d.tag),null!=d.explicit&&(this.isExplicit=d.explicit),null!=d.tage&&(this.hT=d.tage,this.isExplicit=!0),null!=d.tagi&&(this.hT=d.tagi,this.isExplicit=!1),null!=d.obj&&(d.obj instanceof u.ASN1Object?(this.asn1Object=d.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):"object"==C(d.obj)&&(this.asn1Object=u.ASN1Util.newObject(d.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},null!=c&&this.setByParam(c)},_.lang.extend(k.asn1.DERTaggedObject,k.asn1.ASN1Object);var k,So,Vr,Ne=new function(){};function Ua(c){for(var u=new Array,d=0;d<c.length;d++)u[d]=c.charCodeAt(d);return u}function Ha(c){for(var u="",d=0;d<c.length;d++)u+=String.fromCharCode(c[d]);return u}function Gs(c){for(var u="",d=0;d<c.length;d++){var h=c[d].toString(16);1==h.length&&(h="0"+h),u+=h}return u}function $r(c){return Gs(Ua(c))}function Eo(c){return(c=(c=c.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function ps(c){return c.length%4==2?c+="==":c.length%4==3&&(c+="="),(c=c.replace(/-/g,"+")).replace(/_/g,"/")}function ln(c){return c.length%2==1&&(c="0"+c),Eo(Fe(c))}function Ut(c){return Ie(ps(c))}function xo(c){return sn(Co(c))}function $t(c){return decodeURIComponent(Ti(c))}function ar(c){for(var u="",d=0;d<c.length-1;d+=2)u+=String.fromCharCode(parseInt(c.substr(d,2),16));return u}function qr(c){for(var u="",d=0;d<c.length;d++)u+=("0"+c.charCodeAt(d).toString(16)).slice(-2);return u}function _c(c){return Fe(c)}function bc(c){return _c(c).replace(/(.{64})/g,"$1\r\n").replace(/\r\n$/,"")}function Va(c){return Ie(c.replace(/[^0-9A-Za-z\/+=]*/g,""))}function Yn(c,u){return"-----BEGIN "+u+"-----\r\n"+bc(c)+"\r\n-----END "+u+"-----\r\n"}function Kr(c,u){if(-1==c.indexOf("-----BEGIN "))throw"can't find PEM header: "+u;return Va(c=void 0!==u?(c=c.replace(new RegExp("^[^]*-----BEGIN "+u+"-----"),"")).replace(new RegExp("-----END "+u+"-----[^]*$"),""):(c=c.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function Ir(c){var u,d,h,g,y,D,B,F,N,P,U;if(U=c.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return F=U[1],u=parseInt(F),2===F.length&&(50<=u&&u<100?u=1900+u:0<=u&&u<50&&(u=2e3+u)),d=parseInt(U[2])-1,h=parseInt(U[3]),g=parseInt(U[4]),y=parseInt(U[5]),D=parseInt(U[6]),B=0,""!==(N=U[7])&&(P=(N.substr(1)+"00").substr(0,3),B=parseInt(P)),Date.UTC(u,d,h,g,y,D,B);throw"unsupported zulu format: "+c}function wc(c){return~~(Ir(c)/1e3)}function sn(c){return c.replace(/%/g,"")}function Ti(c){return c.replace(/(..)/g,"%$1")}function Gr(c){var u="malformed IPv6 address";if(!c.match(/^[0-9A-Fa-f:]+$/))throw u;var d=(c=c.toLowerCase()).split(":").length-1;if(d<2)throw u;var h=":".repeat(7-d+2),g=(c=c.replace("::",h)).split(":");if(8!=g.length)throw u;for(var y=0;y<8;y++)g[y]=("0000"+g[y]).slice(-4);return g.join("")}function zd(c){if(!c.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var u=(c=c.toLowerCase()).match(/.{1,4}/g),d=0;d<8;d++)u[d]=u[d].replace(/^0+/,""),""==u[d]&&(u[d]="0");var h=(c=":"+u.join(":")+":").match(/:(0:){2,}/g);if(null===h)return c.slice(1,-1);var g="";for(d=0;d<h.length;d++)h[d].length>g.length&&(g=h[d]);return(c=c.replace(g,"::")).slice(1,-1)}function $a(c){var u="malformed hex value";if(!c.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw u;if(8!=c.length)return 32==c.length?zd(c):c;try{return parseInt(c.substr(0,2),16)+"."+parseInt(c.substr(2,2),16)+"."+parseInt(c.substr(4,2),16)+"."+parseInt(c.substr(6,2),16)}catch(d){throw u}}function Co(c){for(var u=encodeURIComponent(c),d="",h=0;h<u.length;h++)"%"==u[h]?(d+=u.substr(h,3),h+=2):d=d+"%"+$r(u[h]);return d}function Do(c){return!(c.length%2!=0||!c.match(/^[0-9a-f]+$/)&&!c.match(/^[0-9A-F]+$/))}function qa(c){return c.length%2==1?"0"+c:c.substr(0,1)>"7"?"00"+c:c}Ne.getLblen=function(c,u){if("8"!=c.substr(u+2,1))return 1;var d=parseInt(c.substr(u+3,1));return 0==d?-1:0<d&&d<10?d+1:-2},Ne.getL=function(c,u){var d=Ne.getLblen(c,u);return d<1?"":c.substr(u+2,2*d)},Ne.getVblen=function(c,u){var d;return""==(d=Ne.getL(c,u))?-1:("8"===d.substr(0,1)?new ae(d.substr(2),16):new ae(d,16)).intValue()},Ne.getVidx=function(c,u){var d=Ne.getLblen(c,u);return d<0?d:u+2*(d+1)},Ne.getV=function(c,u){var d=Ne.getVidx(c,u),h=Ne.getVblen(c,u);return c.substr(d,2*h)},Ne.getTLV=function(c,u){return c.substr(u,2)+Ne.getL(c,u)+Ne.getV(c,u)},Ne.getTLVblen=function(c,u){return 2+2*Ne.getLblen(c,u)+2*Ne.getVblen(c,u)},Ne.getNextSiblingIdx=function(c,u){return Ne.getVidx(c,u)+2*Ne.getVblen(c,u)},Ne.getChildIdx=function(c,u){var d,h,g,y=Ne,D=[];d=y.getVidx(c,u),h=2*y.getVblen(c,u),"03"==c.substr(u,2)&&(d+=2,h-=2),g=0;for(var B=d;g<=h;){var F=y.getTLVblen(c,B);if((g+=F)<=h&&D.push(B),B+=F,g>=h)break}return D},Ne.getNthChildIdx=function(c,u,d){return Ne.getChildIdx(c,u)[d]},Ne.getIdxbyList=function(c,u,d,h){var g,y,D=Ne;return 0==d.length?void 0!==h&&c.substr(u,2)!==h?-1:u:(g=d.shift())>=(y=D.getChildIdx(c,u)).length?-1:D.getIdxbyList(c,y[g],d,h)},Ne.getIdxbyListEx=function(c,u,d,h){var g,y,D=Ne;if(0==d.length)return void 0!==h&&c.substr(u,2)!==h?-1:u;g=d.shift(),y=D.getChildIdx(c,u);for(var B=0,F=0;F<y.length;F++){var N=c.substr(y[F],2);if("number"==typeof g&&!D.isContextTag(N)&&B==g||"string"==typeof g&&D.isContextTag(N,g))return D.getIdxbyListEx(c,y[F],d,h);D.isContextTag(N)||B++}return-1},Ne.getTLVbyList=function(c,u,d,h){var g=Ne,y=g.getIdxbyList(c,u,d,h);return-1==y||y>=c.length?null:g.getTLV(c,y)},Ne.getTLVbyListEx=function(c,u,d,h){var g=Ne,y=g.getIdxbyListEx(c,u,d,h);return-1==y?null:g.getTLV(c,y)},Ne.getVbyList=function(c,u,d,h,g){var y,D,B=Ne;return-1==(y=B.getIdxbyList(c,u,d,h))||y>=c.length?null:(D=B.getV(c,y),!0===g&&(D=D.substr(2)),D)},Ne.getVbyListEx=function(c,u,d,h,g){var y,D,B=Ne;return-1==(y=B.getIdxbyListEx(c,u,d,h))?null:(D=B.getV(c,y),"03"==c.substr(y,2)&&!1!==g&&(D=D.substr(2)),D)},Ne.getInt=function(c,u,d){null==d&&(d=-1);try{var h=c.substr(u,2);if("02"!=h&&"03"!=h)return d;var g=Ne.getV(c,u);return"02"==h?parseInt(g,16):function(D){try{var B=D.substr(0,2);if("00"==B)return parseInt(D.substr(2),16);var F=parseInt(B,16),N=D.substr(2),P=parseInt(N,16).toString(2);return"0"==P&&(P="00000000"),P=P.slice(0,0-F),parseInt(P,2)}catch(U){return-1}}(g)}catch(y){return d}},Ne.getOID=function(c,u,d){null==d&&(d=null);try{return"06"!=c.substr(u,2)?d:function(g){if(!Do(g))return null;try{var y=[],D=g.substr(0,2),B=parseInt(D,16);y[0]=new String(Math.floor(B/40)),y[1]=new String(B%40);for(var F=g.substr(2),N=[],P=0;P<F.length/2;P++)N.push(parseInt(F.substr(2*P,2),16));var U=[],X="";for(P=0;P<N.length;P++)128&N[P]?X+=gs((127&N[P]).toString(2),7):(X+=gs((127&N[P]).toString(2),7),U.push(new String(parseInt(X,2))),X="");var ue=y.join(".");return U.length>0&&(ue=ue+"."+U.join(".")),ue}catch(pe){return null}}(Ne.getV(c,u))}catch(h){return d}},Ne.getOIDName=function(c,u,d){null==d&&(d=null);try{var h=Ne.getOID(c,u,d);if(h==d)return d;var g=k.asn1.x509.OID.oid2name(h);return""==g?h:g}catch(y){return d}},Ne.getString=function(c,u,d){null==d&&(d=null);try{return ar(Ne.getV(c,u))}catch(h){return d}},Ne.hextooidstr=function(c){var u=function(X,ue){return X.length>=ue?X:new Array(ue-X.length+1).join("0")+X},d=[],h=c.substr(0,2),g=parseInt(h,16);d[0]=new String(Math.floor(g/40)),d[1]=new String(g%40);for(var y=c.substr(2),D=[],B=0;B<y.length/2;B++)D.push(parseInt(y.substr(2*B,2),16));var F=[],N="";for(B=0;B<D.length;B++)128&D[B]?N+=u((127&D[B]).toString(2),7):(N+=u((127&D[B]).toString(2),7),F.push(new String(parseInt(N,2))),N="");var P=d.join(".");return F.length>0&&(P=P+"."+F.join(".")),P},Ne.dump=function(c,u,d,h){var g=Ne,y=g.getV,D=g.dump,B=g.getChildIdx,F=c;c instanceof k.asn1.ASN1Object&&(F=c.getEncodedHex());var N=function(Te,ht){return Te.length<=2*ht?Te:Te.substr(0,ht)+"..(total "+Te.length/2+"bytes).."+Te.substr(Te.length-ht,ht)};void 0===u&&(u={ommit_long_octet:32}),void 0===d&&(d=0),void 0===h&&(h="");var P,U=u.ommit_long_octet;if("01"==(P=F.substr(d,2)))return"00"==(X=y(F,d))?h+"BOOLEAN FALSE\n":h+"BOOLEAN TRUE\n";if("02"==P)return h+"INTEGER "+N(X=y(F,d),U)+"\n";if("03"==P){var X=y(F,d);return g.isASN1HEX(X.substr(2))?(ue=h+"BITSTRING, encapsulates\n")+D(X.substr(2),u,0,h+"  "):h+"BITSTRING "+N(X,U)+"\n"}if("04"==P)return X=y(F,d),g.isASN1HEX(X)?(ue=h+"OCTETSTRING, encapsulates\n",ue+=D(X,u,0,h+"  ")):h+"OCTETSTRING "+N(X,U)+"\n";if("05"==P)return h+"NULL\n";if("06"==P){var pe=y(F,d),be=k.asn1.ASN1Util.oidHexToInt(pe),_e=k.asn1.x509.OID.oid2name(be),A=be.replace(/\./g," ");return""!=_e?h+"ObjectIdentifier "+_e+" ("+A+")\n":h+"ObjectIdentifier ("+A+")\n"}if("0a"==P)return h+"ENUMERATED "+parseInt(y(F,d))+"\n";if("0c"==P)return h+"UTF8String '"+$t(y(F,d))+"'\n";if("13"==P)return h+"PrintableString '"+$t(y(F,d))+"'\n";if("14"==P)return h+"TeletexString '"+$t(y(F,d))+"'\n";if("16"==P)return h+"IA5String '"+$t(y(F,d))+"'\n";if("17"==P)return h+"UTCTime "+$t(y(F,d))+"\n";if("18"==P)return h+"GeneralizedTime "+$t(y(F,d))+"\n";if("1a"==P)return h+"VisualString '"+$t(y(F,d))+"'\n";if("1e"==P)return h+"BMPString '"+$t(y(F,d))+"'\n";if("30"==P){if("3000"==F.substr(d,4))return h+"SEQUENCE {}\n";ue=h+"SEQUENCE\n";var q=u;if((2==(ve=B(F,d)).length||3==ve.length)&&"06"==F.substr(ve[0],2)&&"04"==F.substr(ve[ve.length-1],2)){_e=g.oidname(y(F,ve[0]));var Y=JSON.parse(JSON.stringify(u));Y.x509ExtName=_e,q=Y}for(var W=0;W<ve.length;W++)ue+=D(F,q,ve[W],h+"  ");return ue}if("31"==P){ue=h+"SET\n";var ve=B(F,d);for(W=0;W<ve.length;W++)ue+=D(F,u,ve[W],h+"  ");return ue}if(0!=(128&(P=parseInt(P,16)))){var ue,Ee=31&P;if(0!=(32&P)){for(ue=h+"["+Ee+"]\n",ve=B(F,d),W=0;W<ve.length;W++)ue+=D(F,u,ve[W],h+"  ");return ue}return X=y(F,d),Ne.isASN1HEX(X)?(ue=h+"["+Ee+"]\n")+D(X,u,0,h+"  "):(("68747470"==X.substr(0,8)||"subjectAltName"===u.x509ExtName&&2==Ee)&&(X=$t(X)),h+"["+Ee+"] "+X+"\n")}return h+"UNKNOWN("+P+") "+y(F,d)+"\n"},Ne.isContextTag=function(c,u){var d,h;c=c.toLowerCase();try{d=parseInt(c,16)}catch(g){return-1}if(void 0===u)return 128==(192&d);try{return null!=u.match(/^\[[0-9]+\]$/)&&!((h=parseInt(u.substr(1,u.length-1),10))>31)&&128==(192&d)&&(31&d)==h}catch(g){return!1}},Ne.isASN1HEX=function(c){var u=Ne;if(c.length%2==1)return!1;var d=u.getVblen(c,0),h=c.substr(0,2),g=u.getL(c,0);return c.length-h.length-g.length==2*d},Ne.checkStrictDER=function(c,u,d,h,g){var y=Ne;if(void 0===d){if("string"!=typeof c)throw new Error("not hex string");if(c=c.toLowerCase(),!k.lang.String.isHex(c))throw new Error("not hex string");d=c.length,g=(h=c.length/2)<128?1:Math.ceil(h.toString(16))+1}if(y.getL(c,u).length>2*g)throw new Error("L of TLV too long: idx="+u);var D=y.getVblen(c,u);if(D>h)throw new Error("value of L too long than hex: idx="+u);var B=y.getTLV(c,u),F=B.length-2-y.getL(c,u).length;if(F!==2*D)throw new Error("V string length and L's value not the same:"+F+"/"+2*D);if(0===u&&c.length!=B.length)throw new Error("total length and TLV length unmatch:"+c.length+"!="+B.length);var N=c.substr(u,2);if("02"===N){var P=y.getVidx(c,u);if("00"==c.substr(P,2)&&c.charCodeAt(P+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(N,16)){for(var U=y.getVblen(c,u),X=0,ue=y.getChildIdx(c,u),pe=0;pe<ue.length;pe++)X+=y.getTLV(c,ue[pe]).length,y.checkStrictDER(c,ue[pe],d,h,g);if(2*U!=X)throw new Error("sum of children's TLV length and L unmatch: "+2*U+"!="+X)}},Ne.oidname=function(c){var u=k.asn1;k.lang.String.isHex(c)&&(c=u.ASN1Util.oidHexToInt(c));var d=u.x509.OID.oid2name(c);return""===d&&(d=c),d},void 0!==k&&k||(O.KJUR=k={}),void 0!==k.lang&&k.lang||(k.lang={}),k.lang.String=function(){},"function"==typeof Z?(O.utf8tob64u=So=function(u){return Eo(Z.from(u,"utf8").toString("base64"))},O.b64utoutf8=Vr=function(u){return Z.from(ps(u),"base64").toString("utf8")}):(O.utf8tob64u=So=function(u){return ln(sn(Co(u)))},O.b64utoutf8=Vr=function(u){return decodeURIComponent(Ti(Ut(u)))}),k.lang.String.isInteger=function(c){return!!c.match(/^[0-9]+$/)||!!c.match(/^-[0-9]+$/)},k.lang.String.isHex=function(c){return Do(c)},k.lang.String.isBase64=function(c){return!(!(c=c.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||c.length%4!=0)},k.lang.String.isBase64URL=function(c){return!c.match(/[+/=]/)&&(c=ps(c),k.lang.String.isBase64(c))},k.lang.String.isIntegerArray=function(c){return!!(c=c.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},k.lang.String.isPrintable=function(c){return null!==c.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},k.lang.String.isIA5=function(c){return null!==c.match(/^[\x20-\x21\x23-\x7f]*$/)},k.lang.String.isMail=function(c){return null!==c.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var gs=function(u,d,h){return null==h&&(h="0"),u.length>=d?u:new Array(d-u.length+1).join(h)+u};void 0!==k&&k||(O.KJUR=k={}),void 0!==k.crypto&&k.crypto||(k.crypto={}),k.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:se.algo.MD5,sha1:se.algo.SHA1,sha224:se.algo.SHA224,sha256:se.algo.SHA256,sha384:se.algo.SHA384,sha512:se.algo.SHA512,ripemd160:se.algo.RIPEMD160},this.getDigestInfoHex=function(c,u){if(void 0===this.DIGESTINFOHEAD[u])throw"alg not supported in Util.DIGESTINFOHEAD: "+u;return this.DIGESTINFOHEAD[u]+c},this.getPaddedDigestInfoHex=function(c,u,d){var h=this.getDigestInfoHex(c,u),g=d/4;if(h.length+22>g)throw"key is too short for SigAlg: keylen="+d+","+u;for(var y="0001",D="00"+h,B="",F=g-y.length-D.length,N=0;N<F;N+=2)B+="ff";return y+B+D},this.hashString=function(c,u){return new k.crypto.MessageDigest({alg:u}).digestString(c)},this.hashHex=function(c,u){return new k.crypto.MessageDigest({alg:u}).digestHex(c)},this.sha1=function(c){return this.hashString(c,"sha1")},this.sha256=function(c){return this.hashString(c,"sha256")},this.sha256Hex=function(c){return this.hashHex(c,"sha256")},this.sha512=function(c){return this.hashString(c,"sha512")},this.sha512Hex=function(c){return this.hashHex(c,"sha512")},this.isKey=function(c){return c instanceof et||c instanceof k.crypto.DSA||c instanceof k.crypto.ECDSA}},k.crypto.Util.md5=function(c){return new k.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(c)},k.crypto.Util.ripemd160=function(c){return new k.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(c)},k.crypto.Util.SECURERANDOMGEN=new Kn,k.crypto.Util.getRandomHexOfNbytes=function(c){var u=new Array(c);return k.crypto.Util.SECURERANDOMGEN.nextBytes(u),Gs(u)},k.crypto.Util.getRandomBigIntegerOfNbytes=function(c){return new ae(k.crypto.Util.getRandomHexOfNbytes(c),16)},k.crypto.Util.getRandomHexOfNbits=function(c){var u=c%8,d=new Array((c-u)/8+1);return k.crypto.Util.SECURERANDOMGEN.nextBytes(d),d[0]=(255<<u&255^255)&d[0],Gs(d)},k.crypto.Util.getRandomBigIntegerOfNbits=function(c){return new ae(k.crypto.Util.getRandomHexOfNbits(c),16)},k.crypto.Util.getRandomBigIntegerZeroToMax=function(c){for(var u=c.bitLength();;){var d=k.crypto.Util.getRandomBigIntegerOfNbits(u);if(-1!=c.compareTo(d))return d}},k.crypto.Util.getRandomBigIntegerMinToMax=function(c,u){var d=c.compareTo(u);if(1==d)throw"biMin is greater than biMax";if(0==d)return c;var h=u.subtract(c);return k.crypto.Util.getRandomBigIntegerZeroToMax(h).add(c)},k.crypto.MessageDigest=function(c){this.setAlgAndProvider=function(u,d){if(null!==(u=k.crypto.MessageDigest.getCanonicalAlgName(u))&&void 0===d&&(d=k.crypto.Util.DEFAULTPROVIDER[u]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(u)&&"cryptojs"==d){try{this.md=k.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[u].create()}catch(h){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+h}this.updateString=function(h){this.md.update(h)},this.updateHex=function(h){var g=se.enc.Hex.parse(h);this.md.update(g)},this.digest=function(){return this.md.finalize().toString(se.enc.Hex)},this.digestString=function(h){return this.updateString(h),this.digest()},this.digestHex=function(h){return this.updateHex(h),this.digest()}}if(-1!=":sha256:".indexOf(u)&&"sjcl"==d){try{this.md=new sjcl.hash.sha256}catch(h){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+h}this.updateString=function(h){this.md.update(h)},this.updateHex=function(h){var g=sjcl.codec.hex.toBits(h);this.md.update(g)},this.digest=function(){var h=this.md.finalize();return sjcl.codec.hex.fromBits(h)},this.digestString=function(h){return this.updateString(h),this.digest()},this.digestHex=function(h){return this.updateHex(h),this.digest()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==c&&void 0!==c.alg&&(this.algName=c.alg,void 0===c.prov&&(this.provName=k.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},k.crypto.MessageDigest.getCanonicalAlgName=function(c){return"string"==typeof c&&(c=(c=c.toLowerCase()).replace(/-/,"")),c},k.crypto.MessageDigest.getHashLength=function(c){var u=k.crypto.MessageDigest,d=u.getCanonicalAlgName(c);if(void 0===u.HASHLENGTH[d])throw"not supported algorithm: "+c;return u.HASHLENGTH[d]},k.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},k.crypto.Mac=function(c){this.setAlgAndProvider=function(u,d){if(null==(u=u.toLowerCase())&&(u="hmacsha1"),"hmac"!=(u=u.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+u;void 0===d&&(d=k.crypto.Util.DEFAULTPROVIDER[u]),this.algProv=u+"/"+d;var h=u.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(h)&&"cryptojs"==d){try{this.mac=se.algo.HMAC.create(k.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[h],this.pass)}catch(y){throw"setAlgAndProvider hash alg set fail hashAlg="+h+"/"+y}this.updateString=function(y){this.mac.update(y)},this.updateHex=function(y){var D=se.enc.Hex.parse(y);this.mac.update(D)},this.doFinal=function(){return this.mac.finalize().toString(se.enc.Hex)},this.doFinalString=function(y){return this.updateString(y),this.doFinal()},this.doFinalHex=function(y){return this.updateHex(y),this.doFinal()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(u){if("string"==typeof u){var d=u;return u.length%2!=1&&u.match(/^[0-9A-Fa-f]+$/)||(d=qr(u)),void(this.pass=se.enc.Hex.parse(d))}if("object"!=(void 0===u?"undefined":C(u)))throw"KJUR.crypto.Mac unsupported password type: "+u;if(d=null,void 0!==u.hex){if(u.hex.length%2!=0||!u.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+u.hex;d=u.hex}if(void 0!==u.utf8&&(d=xo(u.utf8)),void 0!==u.rstr&&(d=qr(u.rstr)),void 0!==u.b64&&(d=Ie(u.b64)),void 0!==u.b64u&&(d=Ut(u.b64u)),null==d)throw"KJUR.crypto.Mac unsupported password type: "+u;this.pass=se.enc.Hex.parse(d)},void 0!==c&&(void 0!==c.pass&&this.setPassword(c.pass),void 0!==c.alg&&(this.algName=c.alg,void 0===c.prov&&(this.provName=k.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},k.crypto.Signature=function(c){var u=null;if(this._setAlgNames=function(){var d=this.algName.match(/^(.+)with(.+)$/);d&&(this.mdAlgName=d[1].toLowerCase(),this.pubkeyAlgName=d[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(d,h){for(var g="",y=h/4-d.length,D=0;D<y;D++)g+="0";return g+d},this.setAlgAndProvider=function(d,h){if(this._setAlgNames(),"cryptojs/jsrsa"!=h)throw new Error("provider not supported: "+h);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new k.crypto.MessageDigest({alg:this.mdAlgName})}catch(g){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+g)}this.init=function(g,y){var D=null;try{D=void 0===y?dn.getKey(g):dn.getKey(g,y)}catch(B){throw"init failed:"+B}if(!0===D.isPrivate)this.prvKey=D,this.state="SIGN";else{if(!0!==D.isPublic)throw"init failed.:"+D;this.pubKey=D,this.state="VERIFY"}},this.updateString=function(g){this.md.updateString(g)},this.updateHex=function(g){this.md.updateHex(g)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==k.crypto.ECDSA&&(this.prvKey=new k.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof et&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof et&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof k.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof k.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(g){return this.updateString(g),this.sign()},this.signHex=function(g){return this.updateHex(g),this.sign()},this.verify=function(g){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==k.crypto.ECDSA&&(this.pubKey=new k.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof et&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,g,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof et&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,g);if(void 0!==k.crypto.ECDSA&&this.pubKey instanceof k.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,g);if(void 0!==k.crypto.DSA&&this.pubKey instanceof k.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,g);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(d,h){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(d){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(d){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(d){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(d){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(d){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=c,void 0!==c&&(void 0!==c.alg&&(this.algName=c.alg,this.provName=void 0===c.prov?k.crypto.Util.DEFAULTPROVIDER[this.algName]:c.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==c.psssaltlen&&(this.pssSaltLen=c.psssaltlen),void 0!==c.prvkeypem)){if(void 0!==c.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{u=dn.getKey(c.prvkeypem),this.init(u)}catch(d){throw"fatal error to load pem private key: "+d}}},k.crypto.Cipher=function(c){},k.crypto.Cipher.encrypt=function(c,u,d){if(u instanceof et&&u.isPublic){var h=k.crypto.Cipher.getAlgByKeyAndName(u,d);if("RSA"===h)return u.encrypt(c);if("RSAOAEP"===h)return u.encryptOAEP(c,"sha1");var g=h.match(/^RSAOAEP(\d+)$/);if(null!==g)return u.encryptOAEP(c,"sha"+g[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+d}throw"Cipher.encrypt: unsupported key or algorithm"},k.crypto.Cipher.decrypt=function(c,u,d){if(u instanceof et&&u.isPrivate){var h=k.crypto.Cipher.getAlgByKeyAndName(u,d);if("RSA"===h)return u.decrypt(c);if("RSAOAEP"===h)return u.decryptOAEP(c,"sha1");var g=h.match(/^RSAOAEP(\d+)$/);if(null!==g)return u.decryptOAEP(c,"sha"+g[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+d}throw"Cipher.decrypt: unsupported key or algorithm"},k.crypto.Cipher.getAlgByKeyAndName=function(c,u){if(c instanceof et){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(u))return u;if(null==u)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+u}throw"getAlgByKeyAndName: not supported algorithm name: "+u},k.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==k&&k||(O.KJUR=k={}),void 0!==k.crypto&&k.crypto||(k.crypto={}),k.crypto.ECDSA=function(c){var u=Error,d=ae,h=At,g=k.crypto.ECDSA,y=k.crypto.ECParameterDB,D=g.getName,F=Ne.getVbyListEx,N=Ne.isASN1HEX,P=new Kn;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(U){return new d(U.bitLength(),P).mod(U.subtract(d.ONE)).add(d.ONE)},this.setNamedCurve=function(U){this.ecparams=y.getByName(U),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=U},this.setPrivateKeyHex=function(U){this.isPrivate=!0,this.prvKeyHex=U},this.setPublicKeyHex=function(U){this.isPublic=!0,this.pubKeyHex=U},this.getPublicKeyXYHex=function(){var U=this.pubKeyHex;if("04"!==U.substr(0,2))throw"this method supports uncompressed format(04) only";var X=this.ecparams.keylen/4;if(U.length!==2+2*X)throw"malformed public key hex length";var ue={};return ue.x=U.substr(2,X),ue.y=U.substr(2+X),ue},this.getShortNISTPCurveName=function(){var U=this.curveName;return"secp256r1"===U||"NIST P-256"===U||"P-256"===U||"prime256v1"===U?"P-256":"secp384r1"===U||"NIST P-384"===U||"P-384"===U?"P-384":null},this.generateKeyPairHex=function(){var X=this.getBigRandom(this.ecparams.n),ue=this.ecparams.G.multiply(X),pe=ue.getX().toBigInteger(),be=ue.getY().toBigInteger(),_e=this.ecparams.keylen/4,A=("0000000000"+X.toString(16)).slice(-_e),q="04"+("0000000000"+pe.toString(16)).slice(-_e)+("0000000000"+be.toString(16)).slice(-_e);return this.setPrivateKeyHex(A),this.setPublicKeyHex(q),{ecprvhex:A,ecpubhex:q}},this.signWithMessageHash=function(U){return this.signHex(U,this.prvKeyHex)},this.signHex=function(U,X){var ue=new d(X,16),pe=this.ecparams.n,be=new d(U.substring(0,this.ecparams.keylen/4),16);do{var _e=this.getBigRandom(pe),A=this.ecparams.G.multiply(_e).getX().toBigInteger().mod(pe)}while(A.compareTo(d.ZERO)<=0);var q=_e.modInverse(pe).multiply(be.add(ue.multiply(A))).mod(pe);return g.biRSSigToASN1Sig(A,q)},this.sign=function(U,X){var ue=X,pe=this.ecparams.n,be=d.fromByteArrayUnsigned(U);do{var _e=this.getBigRandom(pe),A=this.ecparams.G.multiply(_e).getX().toBigInteger().mod(pe)}while(A.compareTo(ae.ZERO)<=0);var q=_e.modInverse(pe).multiply(be.add(ue.multiply(A))).mod(pe);return this.serializeSig(A,q)},this.verifyWithMessageHash=function(U,X){return this.verifyHex(U,X,this.pubKeyHex)},this.verifyHex=function(U,X,ue){try{var pe,be,_e=g.parseSigHex(X);pe=_e.r,be=_e.s;var A=h.decodeFromHex(this.ecparams.curve,ue),q=new d(U.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(q,pe,be,A)}catch(Y){return!1}},this.verify=function(U,X,ue){var pe,be,_e;if(Bitcoin.Util.isArray(X)){var A=this.parseSig(X);pe=A.r,be=A.s}else{if("object"!==(void 0===X?"undefined":C(X))||!X.r||!X.s)throw"Invalid value for signature";pe=X.r,be=X.s}if(ue instanceof At)_e=ue;else{if(!Bitcoin.Util.isArray(ue))throw"Invalid format for pubkey value, must be byte array or ECPointFp";_e=h.decodeFrom(this.ecparams.curve,ue)}var q=d.fromByteArrayUnsigned(U);return this.verifyRaw(q,pe,be,_e)},this.verifyRaw=function(U,X,ue,pe){var be=this.ecparams.n,_e=this.ecparams.G;if(X.compareTo(d.ONE)<0||X.compareTo(be)>=0||ue.compareTo(d.ONE)<0||ue.compareTo(be)>=0)return!1;var A=ue.modInverse(be),q=U.multiply(A).mod(be),Y=X.multiply(A).mod(be);return _e.multiply(q).add(pe.multiply(Y)).getX().toBigInteger().mod(be).equals(X)},this.serializeSig=function(U,X){var ue=U.toByteArraySigned(),pe=X.toByteArraySigned(),be=[];return be.push(2),be.push(ue.length),(be=be.concat(ue)).push(2),be.push(pe.length),(be=be.concat(pe)).unshift(be.length),be.unshift(48),be},this.parseSig=function(U){var X;if(48!=U[0])throw new Error("Signature not a valid DERSequence");if(2!=U[X=2])throw new Error("First element in signature must be a DERInteger");var ue=U.slice(X+2,X+2+U[X+1]);if(2!=U[X+=2+U[X+1]])throw new Error("Second element in signature must be a DERInteger");var pe=U.slice(X+2,X+2+U[X+1]);return X+=2+U[X+1],{r:d.fromByteArrayUnsigned(ue),s:d.fromByteArrayUnsigned(pe)}},this.parseSigCompact=function(U){if(65!==U.length)throw"Signature has the wrong length";var X=U[0]-27;if(X<0||X>7)throw"Invalid signature type";var ue=this.ecparams.n;return{r:d.fromByteArrayUnsigned(U.slice(1,33)).mod(ue),s:d.fromByteArrayUnsigned(U.slice(33,65)).mod(ue),i:X}},this.readPKCS5PrvKeyHex=function(U){if(!1===N(U))throw new Error("not ASN.1 hex string");var X,ue,pe;try{X=F(U,0,["[0]",0],"06"),ue=F(U,0,[1],"04");try{pe=F(U,0,["[1]",0],"03")}catch(be){}}catch(be){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=D(X),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(pe),this.setPrivateKeyHex(ue),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(U){if(!1===N(U))throw new u("not ASN.1 hex string");var X,ue,pe;try{F(U,0,[1,0],"06"),X=F(U,0,[1,1],"06"),ue=F(U,0,[2,0,1],"04");try{pe=F(U,0,[2,0,"[1]",0],"03")}catch(be){}}catch(be){throw new u("malformed PKCS#8 plain ECC private key")}if(this.curveName=D(X),void 0===this.curveName)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(pe),this.setPrivateKeyHex(ue),this.isPublic=!1},this.readPKCS8PubKeyHex=function(U){if(!1===N(U))throw new u("not ASN.1 hex string");var X,ue;try{F(U,0,[0,0],"06"),X=F(U,0,[0,1],"06"),ue=F(U,0,[1],"03")}catch(pe){throw new u("malformed PKCS#8 ECC public key")}if(this.curveName=D(X),null===this.curveName)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(ue)},this.readCertPubKeyHex=function(U,X){if(!1===N(U))throw new u("not ASN.1 hex string");var ue,pe;try{ue=F(U,0,[0,5,0,1],"06"),pe=F(U,0,[0,5,1],"03")}catch(be){throw new u("malformed X.509 certificate ECC public key")}if(this.curveName=D(ue),null===this.curveName)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(pe)},void 0!==c&&void 0!==c.curve&&(this.curveName=c.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==c&&(void 0!==c.prv&&this.setPrivateKeyHex(c.prv),void 0!==c.pub&&this.setPublicKeyHex(c.pub))},k.crypto.ECDSA.parseSigHex=function(c){var u=k.crypto.ECDSA.parseSigHexInHexRS(c);return{r:new ae(u.r,16),s:new ae(u.s,16)}},k.crypto.ECDSA.parseSigHexInHexRS=function(c){var d=Ne.getChildIdx,h=Ne.getV;if(Ne.checkStrictDER(c,0),"30"!=c.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var g=d(c,0);if(2!=g.length)throw new Error("signature shall have two elements");var y=g[0],D=g[1];if("02"!=c.substr(y,2))throw new Error("1st item not ASN.1 integer");if("02"!=c.substr(D,2))throw new Error("2nd item not ASN.1 integer");return{r:h(c,y),s:h(c,D)}},k.crypto.ECDSA.asn1SigToConcatSig=function(c){var u=k.crypto.ECDSA.parseSigHexInHexRS(c),d=u.r,h=u.s;if("00"==d.substr(0,2)&&d.length%32==2&&(d=d.substr(2)),"00"==h.substr(0,2)&&h.length%32==2&&(h=h.substr(2)),d.length%32==30&&(d="00"+d),h.length%32==30&&(h="00"+h),d.length%32!=0)throw"unknown ECDSA sig r length error";if(h.length%32!=0)throw"unknown ECDSA sig s length error";return d+h},k.crypto.ECDSA.concatSigToASN1Sig=function(c){if(c.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var u=c.substr(0,c.length/2),d=c.substr(c.length/2);return k.crypto.ECDSA.hexRSSigToASN1Sig(u,d)},k.crypto.ECDSA.hexRSSigToASN1Sig=function(c,u){var d=new ae(c,16),h=new ae(u,16);return k.crypto.ECDSA.biRSSigToASN1Sig(d,h)},k.crypto.ECDSA.biRSSigToASN1Sig=function(c,u){var d=k.asn1,h=new d.DERInteger({bigint:c}),g=new d.DERInteger({bigint:u});return new d.DERSequence({array:[h,g]}).getEncodedHex()},k.crypto.ECDSA.getName=function(c){return"2b8104001f"===c?"secp192k1":"2a8648ce3d030107"===c?"secp256r1":"2b8104000a"===c?"secp256k1":"2b81040021"===c?"secp224r1":"2b81040022"===c?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(c)?"secp256r1":-1!=="|secp256k1|".indexOf(c)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(c)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(c)?"secp384r1":null},void 0!==k&&k||(O.KJUR=k={}),void 0!==k.crypto&&k.crypto||(k.crypto={}),k.crypto.ECParameterDB=new function(){var c={},u={};function d(h){return new ae(h,16)}this.getByName=function(h){var g=h;if(void 0!==u[g]&&(g=u[h]),void 0!==c[g])return c[g];throw"unregistered EC curve name: "+g},this.regist=function(h,g,y,D,B,F,N,P,U,X,ue,pe){c[h]={};var be=d(y),_e=d(D),A=d(B),q=d(F),Y=d(N),W=new Ii(be,_e,A),ve=W.decodePointHex("04"+P+U);c[h].name=h,c[h].keylen=g,c[h].curve=W,c[h].G=ve,c[h].n=q,c[h].h=Y,c[h].oid=ue,c[h].info=pe;for(var Ee=0;Ee<X.length;Ee++)u[X[Ee]]=h}},k.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),k.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),k.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),k.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),k.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),k.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),k.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),k.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),k.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),k.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var dn=function(){var c=function(N,P,U){return u(se.AES,N,P,U)},u=function(N,P,U,X){var ue=se.enc.Hex.parse(P),pe=se.enc.Hex.parse(U),be=se.enc.Hex.parse(X),_e={};_e.key=pe,_e.iv=be,_e.ciphertext=ue;var A=N.decrypt(_e,pe,{iv:be});return se.enc.Hex.stringify(A)},d=function(N,P,U){return h(se.AES,N,P,U)},h=function(N,P,U,X){var ue=se.enc.Hex.parse(P),pe=se.enc.Hex.parse(U),be=se.enc.Hex.parse(X),_e=N.encrypt(ue,pe,{iv:be}),A=se.enc.Hex.parse(_e.toString());return se.enc.Base64.stringify(A)},g={"AES-256-CBC":{proc:c,eproc:d,keylen:32,ivlen:16},"AES-192-CBC":{proc:c,eproc:d,keylen:24,ivlen:16},"AES-128-CBC":{proc:c,eproc:d,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(N,P,U){return u(se.TripleDES,N,P,U)},eproc:function(N,P,U){return h(se.TripleDES,N,P,U)},keylen:24,ivlen:8},"DES-CBC":{proc:function(N,P,U){return u(se.DES,N,P,U)},eproc:function(N,P,U){return h(se.DES,N,P,U)},keylen:8,ivlen:8}},y=function(N){var P={},U=N.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));U&&(P.cipher=U[1],P.ivsalt=U[2]);var X=N.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));X&&(P.type=X[1]);var ue=-1,pe=0;-1!=N.indexOf("\r\n\r\n")&&(ue=N.indexOf("\r\n\r\n"),pe=2),-1!=N.indexOf("\n\n")&&(ue=N.indexOf("\n\n"),pe=1);var be=N.indexOf("-----END");if(-1!=ue&&-1!=be){var _e=N.substring(ue+2*pe,be-pe);_e=_e.replace(/\s+/g,""),P.data=_e}return P},D=function(N,P,U){for(var X=U.substring(0,16),ue=se.enc.Hex.parse(X),pe=se.enc.Utf8.parse(P),be=g[N].keylen+g[N].ivlen,_e="",A=null;;){var q=se.algo.MD5.create();if(null!=A&&q.update(A),q.update(pe),q.update(ue),A=q.finalize(),(_e+=se.enc.Hex.stringify(A)).length>=2*be)break}var Y={};return Y.keyhex=_e.substr(0,2*g[N].keylen),Y.ivhex=_e.substr(2*g[N].keylen,2*g[N].ivlen),Y},B=function(N,P,U,X){var ue=se.enc.Base64.parse(N),pe=se.enc.Hex.stringify(ue);return(0,g[P].proc)(pe,U,X)};return{version:"1.0.0",parsePKCS5PEM:function(N){return y(N)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(N,P,U){return D(N,P,U)},decryptKeyB64:function(N,P,U,X){return B(N,P,U,X)},getDecryptedKeyHex:function(N,P){var U=y(N),X=U.cipher,ue=U.ivsalt,pe=U.data,be=D(X,P,ue).keyhex;return B(pe,X,be,ue)},getEncryptedPKCS5PEMFromPrvKeyHex:function(N,P,U,X,ue){var A,q,pe="";if(void 0!==X&&null!=X||(X="AES-256-CBC"),void 0===g[X])throw"KEYUTIL unsupported algorithm: "+X;void 0!==ue&&null!=ue||(ue=(A=g[X].ivlen,q=se.lib.WordArray.random(A),se.enc.Hex.stringify(q)).toUpperCase());var be=function(A,q,Y,W){return(0,g[q].eproc)(A,Y,W)}(P,X,D(X,U,ue).keyhex,ue);return pe="-----BEGIN "+N+" PRIVATE KEY-----\r\n",pe+="Proc-Type: 4,ENCRYPTED\r\n",pe+="DEK-Info: "+X+","+ue+"\r\n",pe+="\r\n",(pe+=be.replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+N+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(N){var U=Ne.getChildIdx,X=Ne.getV,ue={},pe=U(N,0);if(2!=pe.length)throw"malformed format: SEQUENCE(0).items != 2: "+pe.length;ue.ciphertext=X(N,pe[1]);var be=U(N,pe[0]);if(2!=be.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+be.length;if("2a864886f70d01050d"!=X(N,be[0]))throw"this only supports pkcs5PBES2";var _e=U(N,be[1]);if(2!=be.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+_e.length;var A=U(N,_e[1]);if(2!=A.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+A.length;if("2a864886f70d0307"!=X(N,A[0]))throw"this only supports TripleDES";ue.encryptionSchemeAlg="TripleDES",ue.encryptionSchemeIV=X(N,A[1]);var q=U(N,_e[0]);if(2!=q.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+q.length;if("2a864886f70d01050c"!=X(N,q[0]))throw"this only supports pkcs5PBKDF2";var Y=U(N,q[1]);if(Y.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+Y.length;ue.pbkdf2Salt=X(N,Y[0]);var W=X(N,Y[1]);try{ue.pbkdf2Iter=parseInt(W,16)}catch(ve){throw"malformed format pbkdf2Iter: "+W}return ue},getPBKDF2KeyHexFromParam:function(N,P){var U=se.enc.Hex.parse(N.pbkdf2Salt),ue=se.PBKDF2(P,U,{keySize:6,iterations:N.pbkdf2Iter});return se.enc.Hex.stringify(ue)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(N,P){var U=Kr(N,"ENCRYPTED PRIVATE KEY"),X=this.parseHexOfEncryptedPKCS8(U),ue=dn.getPBKDF2KeyHexFromParam(X,P),pe={};pe.ciphertext=se.enc.Hex.parse(X.ciphertext);var be=se.enc.Hex.parse(ue),_e=se.enc.Hex.parse(X.encryptionSchemeIV),A=se.TripleDES.decrypt(pe,be,{iv:_e});return se.enc.Hex.stringify(A)},getKeyFromEncryptedPKCS8PEM:function(N,P){var U=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(N,P);return this.getKeyFromPlainPrivatePKCS8Hex(U)},parsePlainPrivatePKCS8Hex:function(N){var P=Ne,U=P.getChildIdx,X=P.getV,ue={algparam:null};if("30"!=N.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var pe=U(N,0);if(3!=pe.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=N.substr(pe[1],2))throw"malformed PKCS8 private key(code:003)";var be=U(N,pe[1]);if(2!=be.length)throw"malformed PKCS8 private key(code:004)";if("06"!=N.substr(be[0],2))throw"malformed PKCS8 private key(code:005)";if(ue.algoid=X(N,be[0]),"06"==N.substr(be[1],2)&&(ue.algparam=X(N,be[1])),"04"!=N.substr(pe[2],2))throw"malformed PKCS8 private key(code:006)";return ue.keyidx=P.getVidx(N,pe[2]),ue},getKeyFromPlainPrivatePKCS8PEM:function(N){var P=Kr(N,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(P)},getKeyFromPlainPrivatePKCS8Hex:function(N){var P,U=this.parsePlainPrivatePKCS8Hex(N);if("2a864886f70d010101"==U.algoid)P=new et;else if("2a8648ce380401"==U.algoid)P=new k.crypto.DSA;else{if("2a8648ce3d0201"!=U.algoid)throw"unsupported private key algorithm";P=new k.crypto.ECDSA}return P.readPKCS8PrvKeyHex(N),P},_getKeyFromPublicPKCS8Hex:function(N){var P,U=Ne.getVbyList(N,0,[0,0],"06");if("2a864886f70d010101"===U)P=new et;else if("2a8648ce380401"===U)P=new k.crypto.DSA;else{if("2a8648ce3d0201"!==U)throw"unsupported PKCS#8 public key hex";P=new k.crypto.ECDSA}return P.readPKCS8PubKeyHex(N),P},parsePublicRawRSAKeyHex:function(N){var U=Ne.getChildIdx,X=Ne.getV,ue={};if("30"!=N.substr(0,2))throw"malformed RSA key(code:001)";var pe=U(N,0);if(2!=pe.length)throw"malformed RSA key(code:002)";if("02"!=N.substr(pe[0],2))throw"malformed RSA key(code:003)";if(ue.n=X(N,pe[0]),"02"!=N.substr(pe[1],2))throw"malformed RSA key(code:004)";return ue.e=X(N,pe[1]),ue},parsePublicPKCS8Hex:function(N){var P=Ne,U=P.getChildIdx,X=P.getV,ue={algparam:null},pe=U(N,0);if(2!=pe.length)throw"outer DERSequence shall have 2 elements: "+pe.length;var be=pe[0];if("30"!=N.substr(be,2))throw"malformed PKCS8 public key(code:001)";var _e=U(N,be);if(2!=_e.length)throw"malformed PKCS8 public key(code:002)";if("06"!=N.substr(_e[0],2))throw"malformed PKCS8 public key(code:003)";if(ue.algoid=X(N,_e[0]),"06"==N.substr(_e[1],2)?ue.algparam=X(N,_e[1]):"30"==N.substr(_e[1],2)&&(ue.algparam={},ue.algparam.p=P.getVbyList(N,_e[1],[0],"02"),ue.algparam.q=P.getVbyList(N,_e[1],[1],"02"),ue.algparam.g=P.getVbyList(N,_e[1],[2],"02")),"03"!=N.substr(pe[1],2))throw"malformed PKCS8 public key(code:004)";return ue.key=X(N,pe[1]).substr(2),ue}}}();dn.getKey=function(c,u,d){var tt,h=(_e=Ne).getChildIdx,g=_e.getVbyList,y=k.crypto,D=y.ECDSA,B=y.DSA,F=et,N=Kr,P=dn;if(void 0!==F&&c instanceof F||void 0!==D&&c instanceof D||void 0!==B&&c instanceof B)return c;if(void 0!==c.curve&&void 0!==c.xy&&void 0===c.d)return new D({pub:c.xy,curve:c.curve});if(void 0!==c.curve&&void 0!==c.d)return new D({prv:c.d,curve:c.curve});if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0===c.d)return(Xe=new F).setPublic(c.n,c.e),Xe;if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0!==c.p&&void 0!==c.q&&void 0!==c.dp&&void 0!==c.dq&&void 0!==c.co&&void 0===c.qi)return(Xe=new F).setPrivateEx(c.n,c.e,c.d,c.p,c.q,c.dp,c.dq,c.co),Xe;if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0===c.p)return(Xe=new F).setPrivate(c.n,c.e,c.d),Xe;if(void 0!==c.p&&void 0!==c.q&&void 0!==c.g&&void 0!==c.y&&void 0===c.x)return(Xe=new B).setPublic(c.p,c.q,c.g,c.y),Xe;if(void 0!==c.p&&void 0!==c.q&&void 0!==c.g&&void 0!==c.y&&void 0!==c.x)return(Xe=new B).setPrivate(c.p,c.q,c.g,c.y,c.x),Xe;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0===c.d)return(Xe=new F).setPublic(Ut(c.n),Ut(c.e)),Xe;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0!==c.p&&void 0!==c.q&&void 0!==c.dp&&void 0!==c.dq&&void 0!==c.qi)return(Xe=new F).setPrivateEx(Ut(c.n),Ut(c.e),Ut(c.d),Ut(c.p),Ut(c.q),Ut(c.dp),Ut(c.dq),Ut(c.qi)),Xe;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d)return(Xe=new F).setPrivate(Ut(c.n),Ut(c.e),Ut(c.d)),Xe;if("EC"===c.kty&&void 0!==c.crv&&void 0!==c.x&&void 0!==c.y&&void 0===c.d){var U=($e=new D({curve:c.crv})).ecparams.keylen/4,X="04"+("0000000000"+Ut(c.x)).slice(-U)+("0000000000"+Ut(c.y)).slice(-U);return $e.setPublicKeyHex(X),$e}if("EC"===c.kty&&void 0!==c.crv&&void 0!==c.x&&void 0!==c.y&&void 0!==c.d){U=($e=new D({curve:c.crv})).ecparams.keylen/4,X="04"+("0000000000"+Ut(c.x)).slice(-U)+("0000000000"+Ut(c.y)).slice(-U);var ue=("0000000000"+Ut(c.d)).slice(-U);return $e.setPublicKeyHex(X),$e.setPrivateKeyHex(ue),$e}if("pkcs5prv"===d){var pe,be=c,_e=Ne;if(9===(pe=h(be,0)).length)(Xe=new F).readPKCS5PrvKeyHex(be);else if(6===pe.length)(Xe=new B).readPKCS5PrvKeyHex(be);else{if(!(pe.length>2&&"04"===be.substr(pe[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(Xe=new D).readPKCS5PrvKeyHex(be)}return Xe}if("pkcs8prv"===d)return P.getKeyFromPlainPrivatePKCS8Hex(c);if("pkcs8pub"===d)return P._getKeyFromPublicPKCS8Hex(c);if("x509pub"===d)return fn.getPublicKeyFromCertHex(c);if(-1!=c.indexOf("-END CERTIFICATE-",0)||-1!=c.indexOf("-END X509 CERTIFICATE-",0)||-1!=c.indexOf("-END TRUSTED CERTIFICATE-",0))return fn.getPublicKeyFromCertPEM(c);if(-1!=c.indexOf("-END PUBLIC KEY-")){var A=Kr(c,"PUBLIC KEY");return P._getKeyFromPublicPKCS8Hex(A)}if(-1!=c.indexOf("-END RSA PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED")){var q=N(c,"RSA PRIVATE KEY");return P.getKey(q,null,"pkcs5prv")}if(-1!=c.indexOf("-END DSA PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED")){var Y=g(tt=N(c,"DSA PRIVATE KEY"),0,[1],"02"),W=g(tt,0,[2],"02"),ve=g(tt,0,[3],"02"),Ee=g(tt,0,[4],"02"),Ge=g(tt,0,[5],"02");return(Xe=new B).setPrivate(new ae(Y,16),new ae(W,16),new ae(ve,16),new ae(Ee,16),new ae(Ge,16)),Xe}if(-1!=c.indexOf("-END EC PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED"))return q=N(c,"EC PRIVATE KEY"),P.getKey(q,null,"pkcs5prv");if(-1!=c.indexOf("-END PRIVATE KEY-"))return P.getKeyFromPlainPrivatePKCS8PEM(c);if(-1!=c.indexOf("-END RSA PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED")){var Te=P.getDecryptedKeyHex(c,u),ht=new et;return ht.readPKCS5PrvKeyHex(Te),ht}if(-1!=c.indexOf("-END EC PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED")){var $e,Xe=g(tt=P.getDecryptedKeyHex(c,u),0,[1],"04"),qt=g(tt,0,[2,0],"06"),mt=g(tt,0,[3,0],"03").substr(2);if(void 0===k.crypto.OID.oidhex2name[qt])throw"undefined OID(hex) in KJUR.crypto.OID: "+qt;return($e=new D({curve:k.crypto.OID.oidhex2name[qt]})).setPublicKeyHex(mt),$e.setPrivateKeyHex(Xe),$e.isPublic=!1,$e}if(-1!=c.indexOf("-END DSA PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED"))return Y=g(tt=P.getDecryptedKeyHex(c,u),0,[1],"02"),W=g(tt,0,[2],"02"),ve=g(tt,0,[3],"02"),Ee=g(tt,0,[4],"02"),Ge=g(tt,0,[5],"02"),(Xe=new B).setPrivate(new ae(Y,16),new ae(W,16),new ae(ve,16),new ae(Ee,16),new ae(Ge,16)),Xe;if(-1!=c.indexOf("-END ENCRYPTED PRIVATE KEY-"))return P.getKeyFromEncryptedPKCS8PEM(c,u);throw new Error("not supported argument")},dn.generateKeypair=function(c,u){if("RSA"==c){var d=u;(D=new et).generate(d,"10001"),D.isPrivate=!0,D.isPublic=!0;var h=new et,g=D.n.toString(16),y=D.e.toString(16);return h.setPublic(g,y),h.isPrivate=!1,h.isPublic=!0,(B={}).prvKeyObj=D,B.pubKeyObj=h,B}if("EC"==c){var D,B,F=u,N=new k.crypto.ECDSA({curve:F}).generateKeyPairHex();return(D=new k.crypto.ECDSA({curve:F})).setPublicKeyHex(N.ecpubhex),D.setPrivateKeyHex(N.ecprvhex),D.isPrivate=!0,D.isPublic=!1,(h=new k.crypto.ECDSA({curve:F})).setPublicKeyHex(N.ecpubhex),h.isPrivate=!1,h.isPublic=!0,(B={}).prvKeyObj=D,B.pubKeyObj=h,B}throw"unknown algorithm: "+c},dn.getPEM=function(c,u,d,h,g,y){var B=k.asn1,F=B.DERObjectIdentifier,N=B.DERInteger,P=B.ASN1Util.newObject,X=k.crypto,ue=X.DSA,pe=X.ECDSA,be=et;function _e($e){return P({seq:[{int:0},{int:{bigint:$e.n}},{int:$e.e},{int:{bigint:$e.d}},{int:{bigint:$e.p}},{int:{bigint:$e.q}},{int:{bigint:$e.dmp1}},{int:{bigint:$e.dmq1}},{int:{bigint:$e.coeff}}]})}function A($e){return P({seq:[{int:1},{octstr:{hex:$e.prvKeyHex}},{tag:["a0",!0,{oid:{name:$e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+$e.pubKeyHex}}]}]})}function q($e){return P({seq:[{int:0},{int:{bigint:$e.p}},{int:{bigint:$e.q}},{int:{bigint:$e.g}},{int:{bigint:$e.y}},{int:{bigint:$e.x}}]})}if((void 0!==be&&c instanceof be||void 0!==ue&&c instanceof ue||void 0!==pe&&c instanceof pe)&&1==c.isPublic&&(void 0===u||"PKCS8PUB"==u))return Yn(Ee=new(0,B.x509.SubjectPublicKeyInfo)(c).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==u&&void 0!==be&&c instanceof be&&(void 0===d||null==d)&&1==c.isPrivate)return Yn(Ee=_e(c).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==u&&void 0!==pe&&c instanceof pe&&(void 0===d||null==d)&&1==c.isPrivate){var Y=new F({name:c.curveName}).getEncodedHex(),W=A(c).getEncodedHex(),ve="";return(ve+=Yn(Y,"EC PARAMETERS"))+Yn(W,"EC PRIVATE KEY")}if("PKCS1PRV"==u&&void 0!==ue&&c instanceof ue&&(void 0===d||null==d)&&1==c.isPrivate)return Yn(Ee=q(c).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==u&&void 0!==be&&c instanceof be&&void 0!==d&&null!=d&&1==c.isPrivate){var Ee=_e(c).getEncodedHex();return void 0===h&&(h="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",Ee,d,h,y)}if("PKCS5PRV"==u&&void 0!==pe&&c instanceof pe&&void 0!==d&&null!=d&&1==c.isPrivate)return Ee=A(c).getEncodedHex(),void 0===h&&(h="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",Ee,d,h,y);if("PKCS5PRV"==u&&void 0!==ue&&c instanceof ue&&void 0!==d&&null!=d&&1==c.isPrivate)return Ee=q(c).getEncodedHex(),void 0===h&&(h="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",Ee,d,h,y);var Ge=function(Xe,qt){var mt=Te(Xe,qt);return new P({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:mt.pbkdf2Salt}},{int:mt.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:mt.encryptionSchemeIV}}]}]}]},{octstr:{hex:mt.ciphertext}}]}).getEncodedHex()},Te=function(Xe,qt){var mt=se.lib.WordArray.random(8),tt=se.lib.WordArray.random(8),ur=se.PBKDF2(qt,mt,{keySize:6,iterations:100}),Gn=se.enc.Hex.parse(Xe),Qn=se.TripleDES.encrypt(Gn,ur,{iv:tt})+"",ze={};return ze.ciphertext=Qn,ze.pbkdf2Salt=se.enc.Hex.stringify(mt),ze.pbkdf2Iter=100,ze.encryptionSchemeAlg="DES-EDE3-CBC",ze.encryptionSchemeIV=se.enc.Hex.stringify(tt),ze};if("PKCS8PRV"==u&&null!=be&&c instanceof be&&1==c.isPrivate){var ht=_e(c).getEncodedHex();return Ee=P({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:ht}}]}).getEncodedHex(),void 0===d||null==d?Yn(Ee,"PRIVATE KEY"):Yn(W=Ge(Ee,d),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==u&&void 0!==pe&&c instanceof pe&&1==c.isPrivate)return ht=new P({seq:[{int:1},{octstr:{hex:c.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+c.pubKeyHex}}]}]}).getEncodedHex(),Ee=P({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:c.curveName}}]},{octstr:{hex:ht}}]}).getEncodedHex(),void 0===d||null==d?Yn(Ee,"PRIVATE KEY"):Yn(W=Ge(Ee,d),"ENCRYPTED PRIVATE KEY");if("PKCS8PRV"==u&&void 0!==ue&&c instanceof ue&&1==c.isPrivate)return ht=new N({bigint:c.x}).getEncodedHex(),Ee=P({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:c.p}},{int:{bigint:c.q}},{int:{bigint:c.g}}]}]},{octstr:{hex:ht}}]}).getEncodedHex(),void 0===d||null==d?Yn(Ee,"PRIVATE KEY"):Yn(W=Ge(Ee,d),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},dn.getKeyFromCSRPEM=function(c){var u=Kr(c,"CERTIFICATE REQUEST");return dn.getKeyFromCSRHex(u)},dn.getKeyFromCSRHex=function(c){var u=dn.parseCSRHex(c);return dn.getKey(u.p8pubkeyhex,null,"pkcs8pub")},dn.parseCSRHex=function(c){var d=Ne.getChildIdx,h=Ne.getTLV,g={},y=c;if("30"!=y.substr(0,2))throw"malformed CSR(code:001)";var D=d(y,0);if(D.length<1)throw"malformed CSR(code:002)";if("30"!=y.substr(D[0],2))throw"malformed CSR(code:003)";var B=d(y,D[0]);if(B.length<3)throw"malformed CSR(code:004)";return g.p8pubkeyhex=h(y,B[2]),g},dn.getKeyID=function(c){var u=dn,d=Ne;"string"==typeof c&&-1!=c.indexOf("BEGIN ")&&(c=u.getKey(c));var h=Kr(u.getPEM(c)),g=d.getIdxbyList(h,0,[1]),y=d.getV(h,g).substring(2);return k.crypto.Util.hashHex(y,"sha1")},dn.getJWKFromKey=function(c){var u={};if(c instanceof et&&c.isPrivate)return u.kty="RSA",u.n=ln(c.n.toString(16)),u.e=ln(c.e.toString(16)),u.d=ln(c.d.toString(16)),u.p=ln(c.p.toString(16)),u.q=ln(c.q.toString(16)),u.dp=ln(c.dmp1.toString(16)),u.dq=ln(c.dmq1.toString(16)),u.qi=ln(c.coeff.toString(16)),u;if(c instanceof et&&c.isPublic)return u.kty="RSA",u.n=ln(c.n.toString(16)),u.e=ln(c.e.toString(16)),u;if(c instanceof k.crypto.ECDSA&&c.isPrivate){if("P-256"!==(h=c.getShortNISTPCurveName())&&"P-384"!==h)throw"unsupported curve name for JWT: "+h;var d=c.getPublicKeyXYHex();return u.kty="EC",u.crv=h,u.x=ln(d.x),u.y=ln(d.y),u.d=ln(c.prvKeyHex),u}if(c instanceof k.crypto.ECDSA&&c.isPublic){var h;if("P-256"!==(h=c.getShortNISTPCurveName())&&"P-384"!==h)throw"unsupported curve name for JWT: "+h;return d=c.getPublicKeyXYHex(),u.kty="EC",u.crv=h,u.x=ln(d.x),u.y=ln(d.y),u}throw"not supported key object"},et.getPosArrayOfChildrenFromHex=function(c){return Ne.getChildIdx(c,0)},et.getHexValueArrayOfChildrenFromHex=function(c){var u,d=Ne.getV,h=d(c,(u=et.getPosArrayOfChildrenFromHex(c))[0]),g=d(c,u[1]),y=d(c,u[2]),D=d(c,u[3]),B=d(c,u[4]),F=d(c,u[5]),N=d(c,u[6]),P=d(c,u[7]),U=d(c,u[8]);return(u=new Array).push(h,g,y,D,B,F,N,P,U),u},et.prototype.readPrivateKeyFromPEMString=function(c){var u=Kr(c),d=et.getHexValueArrayOfChildrenFromHex(u);this.setPrivateEx(d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},et.prototype.readPKCS5PrvKeyHex=function(c){var u=et.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8])},et.prototype.readPKCS8PrvKeyHex=function(c){var u,d,h,g,y,D,B,F,P=Ne.getVbyListEx;if(!1===Ne.isASN1HEX(c))throw new Error("not ASN.1 hex string");try{u=P(c,0,[2,0,1],"02"),d=P(c,0,[2,0,2],"02"),h=P(c,0,[2,0,3],"02"),g=P(c,0,[2,0,4],"02"),y=P(c,0,[2,0,5],"02"),D=P(c,0,[2,0,6],"02"),B=P(c,0,[2,0,7],"02"),F=P(c,0,[2,0,8],"02")}catch(U){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(u,d,h,g,y,D,B,F)},et.prototype.readPKCS5PubKeyHex=function(c){var u=Ne,d=u.getV;if(!1===u.isASN1HEX(c))throw new Error("keyHex is not ASN.1 hex string");var h=u.getChildIdx(c,0);if(2!==h.length||"02"!==c.substr(h[0],2)||"02"!==c.substr(h[1],2))throw new Error("wrong hex for PKCS#5 public key");var g=d(c,h[0]),y=d(c,h[1]);this.setPublic(g,y)},et.prototype.readPKCS8PubKeyHex=function(c){var u=Ne;if(!1===u.isASN1HEX(c))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==u.getTLVbyListEx(c,0,[0,0]))throw new Error("not PKCS8 RSA public key");var d=u.getTLVbyListEx(c,0,[1,0]);this.readPKCS5PubKeyHex(d)},et.prototype.readCertPubKeyHex=function(c,u){var d,h;(d=new fn).readCertHex(c),h=d.getPublicKeyHex(),this.readPKCS8PubKeyHex(h)};var Sc=new RegExp("[^0-9a-f]","gi");function Ka(c,u){for(var d="",h=u/4-c.length,g=0;g<h;g++)d+="0";return d+c}function Ec(c,u,d){for(var h="",g=0;h.length<u;)h+=ar(d(qr(c+String.fromCharCode.apply(String,[(4278190080&g)>>24,(16711680&g)>>16,(65280&g)>>8,255&g])))),g+=1;return h}function xc(c){for(var u in k.crypto.Util.DIGESTINFOHEAD){var d=k.crypto.Util.DIGESTINFOHEAD[u],h=d.length;if(c.substring(0,h)==d)return[u,c.substring(h)]}return[]}function fn(c){var u,d=Ne,h=d.getChildIdx,g=d.getV,y=d.getTLV,D=d.getVbyList,B=d.getVbyListEx,F=d.getTLVbyList,N=d.getTLVbyListEx,P=d.getIdxbyList,U=d.getIdxbyListEx,X=d.getVidx,ue=d.oidname,pe=d.hextooidstr,be=fn,_e=Kr;try{u=k.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(A){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==F(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return B(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var A=N(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(A)},this.getAlgorithmIdentifierName=function(A){for(var q in u)if(A===u[q])return q;return ue(B(A,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return F(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return be.hex2dn(this.getIssuerHex())},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return F(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return be.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var A=D(this.hex,0,[0,4+this.foffset,0]);return A=A.replace(/(..)/g,"%$1"),decodeURIComponent(A)},this.getNotAfter=function(){var A=D(this.hex,0,[0,4+this.foffset,1]);return A=A.replace(/(..)/g,"%$1"),decodeURIComponent(A)},this.getPublicKeyHex=function(){return d.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return P(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var A=this.getPublicKeyIdx();return P(this.hex,A,[1,0],"30")},this.getPublicKey=function(){return dn.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var A=F(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(A)},this.getSignatureValueHex=function(){return D(this.hex,0,[2],"03",!0)},this.verifySignature=function(A){var q=this.getSignatureAlgorithmField(),Y=this.getSignatureValueHex(),W=F(this.hex,0,[0],"30"),ve=new k.crypto.Signature({alg:q});return ve.init(A),ve.updateHex(W),ve.verify(Y)},this.parseExt=function(A){var q,Y,W;if(void 0===A){if(3!==this.version)return-1;q=P(W=this.hex,0,[0,7,0],"30"),Y=h(W,q)}else{W=Kr(A);var ve=P(W,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=g(W,ve))return void(this.aExtInfo=new Array);q=P(W,0,[0,3,0,1,0],"30"),Y=h(W,q),this.hex=W}this.aExtInfo=new Array;for(var Ee=0;Ee<Y.length;Ee++){var Ge={critical:!1},Te=0;3===h(W,Y[Ee]).length&&(Ge.critical=!0,Te=1),Ge.oid=d.hextooidstr(D(W,Y[Ee],[0],"06"));var ht=P(W,Y[Ee],[1+Te]);Ge.vidx=X(W,ht),this.aExtInfo.push(Ge)}},this.getExtInfo=function(A){var q=this.aExtInfo,Y=A;if(A.match(/^[0-9.]+$/)||(Y=k.asn1.x509.OID.name2oid(A)),""!==Y)for(var W=0;W<q.length;W++)if(q[W].oid===Y)return q[W]},this.getExtBasicConstraints=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("basicConstraints");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"basicConstraints"};if(q&&(W.critical=!0),"3000"===A)return W;if("30030101ff"===A)return W.cA=!0,W;if("30060101ff02"===A.substr(0,12)){var ve=g(A,10),Ee=parseInt(ve,16);return W.cA=!0,W.pathLen=Ee,W}throw new Error("hExtV parse error: "+A)},this.getExtKeyUsage=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("keyUsage");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"keyUsage"};return q&&(W.critical=!0),W.names=this.getExtKeyUsageString(A).split(","),W},this.getExtKeyUsageBin=function(A){if(void 0===A){var q=this.getExtInfo("keyUsage");if(void 0===q)return"";A=y(this.hex,q.vidx)}if(8!=A.length&&10!=A.length)throw new Error("malformed key usage value: "+A);var Y="000000000000000"+parseInt(A.substr(6),16).toString(2);return 8==A.length&&(Y=Y.slice(-8)),10==A.length&&(Y=Y.slice(-16)),""==(Y=Y.replace(/0+$/,""))&&(Y="0"),Y},this.getExtKeyUsageString=function(A){for(var q=this.getExtKeyUsageBin(A),Y=new Array,W=0;W<q.length;W++)"1"==q.substr(W,1)&&Y.push(fn.KEYUSAGE_NAME[W]);return Y.join(",")},this.getExtSubjectKeyIdentifier=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("subjectKeyIdentifier");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"subjectKeyIdentifier"};q&&(W.critical=!0);var ve=g(A,0);return W.kid={hex:ve},W},this.getExtAuthorityKeyIdentifier=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("authorityKeyIdentifier");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"authorityKeyIdentifier"};q&&(W.critical=!0);for(var ve=h(A,0),Ee=0;Ee<ve.length;Ee++){var Ge=A.substr(ve[Ee],2);if("80"===Ge&&(W.kid={hex:g(A,ve[Ee])}),"a1"===Ge){var Te=y(A,ve[Ee]),ht=this.getGeneralNames(Te);W.issuer=ht[0].dn}"82"===Ge&&(W.sn={hex:g(A,ve[Ee])})}return W},this.getExtExtKeyUsage=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("extKeyUsage");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"extKeyUsage",array:[]};q&&(W.critical=!0);for(var ve=h(A,0),Ee=0;Ee<ve.length;Ee++)W.array.push(ue(g(A,ve[Ee])));return W},this.getExtExtKeyUsageName=function(){var A=this.getExtInfo("extKeyUsage");if(void 0===A)return A;var q=new Array,Y=y(this.hex,A.vidx);if(""===Y)return q;for(var W=h(Y,0),ve=0;ve<W.length;ve++)q.push(ue(g(Y,W[ve])));return q},this.getExtSubjectAltName=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("subjectAltName");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"subjectAltName",array:[]};return q&&(W.critical=!0),W.array=this.getGeneralNames(A),W},this.getExtIssuerAltName=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("issuerAltName");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"issuerAltName",array:[]};return q&&(W.critical=!0),W.array=this.getGeneralNames(A),W},this.getGeneralNames=function(A){for(var q=h(A,0),Y=[],W=0;W<q.length;W++){var ve=this.getGeneralName(y(A,q[W]));void 0!==ve&&Y.push(ve)}return Y},this.getGeneralName=function(A){var q=A.substr(0,2),Y=g(A,0),W=ar(Y);return"81"==q?{rfc822:W}:"82"==q?{dns:W}:"86"==q?{uri:W}:"87"==q?{ip:$a(Y)}:"a4"==q?{dn:this.getX500Name(Y)}:void 0},this.getExtSubjectAltName2=function(){var A,q,Y,W=this.getExtInfo("subjectAltName");if(void 0===W)return W;for(var ve=new Array,Ee=y(this.hex,W.vidx),Ge=h(Ee,0),Te=0;Te<Ge.length;Te++)Y=Ee.substr(Ge[Te],2),A=g(Ee,Ge[Te]),"81"===Y&&(q=$t(A),ve.push(["MAIL",q])),"82"===Y&&(q=$t(A),ve.push(["DNS",q])),"84"===Y&&(q=fn.hex2dn(A,0),ve.push(["DN",q])),"86"===Y&&(q=$t(A),ve.push(["URI",q])),"87"===Y&&(q=$a(A),ve.push(["IP",q]));return ve},this.getExtCRLDistributionPoints=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("cRLDistributionPoints");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"cRLDistributionPoints",array:[]};q&&(W.critical=!0);for(var ve=h(A,0),Ee=0;Ee<ve.length;Ee++){var Ge=y(A,ve[Ee]);W.array.push(this.getDistributionPoint(Ge))}return W},this.getDistributionPoint=function(A){for(var q={},Y=h(A,0),W=0;W<Y.length;W++){var ve=A.substr(Y[W],2),Ee=y(A,Y[W]);"a0"==ve&&(q.dpname=this.getDistributionPointName(Ee))}return q},this.getDistributionPointName=function(A){for(var q={},Y=h(A,0),W=0;W<Y.length;W++){var ve=A.substr(Y[W],2),Ee=y(A,Y[W]);"a0"==ve&&(q.full=this.getGeneralNames(Ee))}return q},this.getExtCRLDistributionPointsURI=function(){var A=this.getExtInfo("cRLDistributionPoints");if(void 0===A)return A;for(var q=new Array,Y=h(this.hex,A.vidx),W=0;W<Y.length;W++)try{var ve=$t(D(this.hex,Y[W],[0,0,0],"86"));q.push(ve)}catch(Ee){}return q},this.getExtAIAInfo=function(){var A=this.getExtInfo("authorityInfoAccess");if(void 0===A)return A;for(var q={ocsp:[],caissuer:[]},Y=h(this.hex,A.vidx),W=0;W<Y.length;W++){var ve=D(this.hex,Y[W],[0],"06"),Ee=D(this.hex,Y[W],[1],"86");"2b06010505073001"===ve&&q.ocsp.push($t(Ee)),"2b06010505073002"===ve&&q.caissuer.push($t(Ee))}return q},this.getExtAuthorityInfoAccess=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("authorityInfoAccess");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"authorityInfoAccess",array:[]};q&&(W.critical=!0);for(var ve=h(A,0),Ee=0;Ee<ve.length;Ee++){var Ge=B(A,ve[Ee],[0],"06"),Te=$t(D(A,ve[Ee],[1],"86"));if("2b06010505073001"==Ge)W.array.push({ocsp:Te});else{if("2b06010505073002"!=Ge)throw new Error("unknown method: "+Ge);W.array.push({caissuer:Te})}}return W},this.getExtCertificatePolicies=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("certificatePolicies");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"certificatePolicies",array:[]};q&&(W.critical=!0);for(var ve=h(A,0),Ee=0;Ee<ve.length;Ee++){var Ge=y(A,ve[Ee]),Te=this.getPolicyInformation(Ge);W.array.push(Te)}return W},this.getPolicyInformation=function(A){var q={},Y=D(A,0,[0],"06");q.policyoid=ue(Y);var W=U(A,0,[1],"30");if(-1!=W){q.array=[];for(var ve=h(A,W),Ee=0;Ee<ve.length;Ee++){var Ge=y(A,ve[Ee]),Te=this.getPolicyQualifierInfo(Ge);q.array.push(Te)}}return q},this.getPolicyQualifierInfo=function(A){var q={},Y=D(A,0,[0],"06");if("2b06010505070201"===Y){var W=B(A,0,[1],"16");q.cps=ar(W)}else if("2b06010505070202"===Y){var ve=F(A,0,[1],"30");q.unotice=this.getUserNotice(ve)}return q},this.getUserNotice=function(A){for(var q={},Y=h(A,0),W=0;W<Y.length;W++){var ve=y(A,Y[W]);"30"!=ve.substr(0,2)&&(q.exptext=this.getDisplayText(ve))}return q},this.getDisplayText=function(A){var q={};return q.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[A.substr(0,2)],q.str=ar(g(A,0)),q},this.getExtCRLNumber=function(A,q){var Y={extname:"cRLNumber"};if(q&&(Y.critical=!0),"02"==A.substr(0,2))return Y.num={hex:g(A,0)},Y;throw new Error("hExtV parse error: "+A)},this.getExtCRLReason=function(A,q){var Y={extname:"cRLReason"};if(q&&(Y.critical=!0),"0a"==A.substr(0,2))return Y.code=parseInt(g(A,0),16),Y;throw new Error("hExtV parse error: "+A)},this.getExtOcspNonce=function(A,q){var Y={extname:"ocspNonce"};q&&(Y.critical=!0);var W=g(A,0);return Y.hex=W,Y},this.getExtOcspNoCheck=function(A,q){var Y={extname:"ocspNoCheck"};return q&&(Y.critical=!0),Y},this.getExtAdobeTimeStamp=function(A,q){if(void 0===A&&void 0===q){var Y=this.getExtInfo("adobeTimeStamp");if(void 0===Y)return;A=y(this.hex,Y.vidx),q=Y.critical}var W={extname:"adobeTimeStamp"};q&&(W.critical=!0);var ve=h(A,0);if(ve.length>1){var Ee=y(A,ve[1]),Ge=this.getGeneralName(Ee);null!=Ge.uri&&(W.uri=Ge.uri)}if(ve.length>2){var Te=y(A,ve[2]);"0101ff"==Te&&(W.reqauth=!0),"010100"==Te&&(W.reqauth=!1)}return W},this.getX500NameRule=function(A){for(var q=null,Y=[],W=0;W<A.length;W++)for(var ve=A[W],Ee=0;Ee<ve.length;Ee++)Y.push(ve[Ee]);for(W=0;W<Y.length;W++){var Ge=Y[W],Te=Ge.ds,$e=Ge.type;if("prn"!=Te&&"utf8"!=Te&&"ia5"!=Te)return"mixed";if("ia5"==Te){if("CN"!=$e)return"mixed";if(k.lang.String.isMail(Ge.value))continue;return"mixed"}if("C"==$e){if("prn"==Te)continue;return"mixed"}if(null==q)q=Te;else if(q!==Te)return"mixed"}return null==q?"prn":q},this.getX500Name=function(A){var q=this.getX500NameArray(A);return{array:q,str:this.dnarraytostr(q)}},this.getX500NameArray=function(A){for(var q=[],Y=h(A,0),W=0;W<Y.length;W++)q.push(this.getRDN(y(A,Y[W])));return q},this.getRDN=function(A){for(var q=[],Y=h(A,0),W=0;W<Y.length;W++)q.push(this.getAttrTypeAndValue(y(A,Y[W])));return q},this.getAttrTypeAndValue=function(A){var q={type:null,value:null,ds:null},Y=h(A,0),W=D(A,Y[0],[],"06"),ve=D(A,Y[1],[]),Ee=k.asn1.ASN1Util.oidHexToInt(W);return q.type=k.asn1.x509.OID.oid2atype(Ee),q.value=ar(ve),q.ds=this.HEX2STAG[A.substr(Y[1],2)],q},this.readCertPEM=function(A){this.readCertHex(_e(A))},this.readCertHex=function(A){this.hex=A,this.getVersion();try{P(this.hex,0,[0,7],"a3"),this.parseExt()}catch(q){}},this.getParam=function(){var A={};return A.version=this.getVersion(),A.serial={hex:this.getSerialNumberHex()},A.sigalg=this.getSignatureAlgorithmField(),A.issuer=this.getIssuer(),A.notbefore=this.getNotBefore(),A.notafter=this.getNotAfter(),A.subject=this.getSubject(),A.sbjpubkey=Yn(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(A.ext=this.getExtParamArray()),A.sighex=this.getSignatureValueHex(),A},this.getExtParamArray=function(A){null==A&&-1!=U(this.hex,0,[0,"[3]"])&&(A=N(this.hex,0,[0,"[3]",0],"30"));for(var q=[],Y=h(A,0),W=0;W<Y.length;W++){var ve=y(A,Y[W]),Ee=this.getExtParam(ve);null!=Ee&&q.push(Ee)}return q},this.getExtParam=function(A){var q=h(A,0).length;if(2!=q&&3!=q)throw new Error("wrong number elements in Extension: "+q+" "+A);var Y=pe(D(A,0,[0],"06")),W=!1;3==q&&"0101ff"==F(A,0,[1])&&(W=!0);var ve=F(A,0,[q-1,0]),Ee=void 0;if("2.5.29.14"==Y?Ee=this.getExtSubjectKeyIdentifier(ve,W):"2.5.29.15"==Y?Ee=this.getExtKeyUsage(ve,W):"2.5.29.17"==Y?Ee=this.getExtSubjectAltName(ve,W):"2.5.29.18"==Y?Ee=this.getExtIssuerAltName(ve,W):"2.5.29.19"==Y?Ee=this.getExtBasicConstraints(ve,W):"2.5.29.31"==Y?Ee=this.getExtCRLDistributionPoints(ve,W):"2.5.29.32"==Y?Ee=this.getExtCertificatePolicies(ve,W):"2.5.29.35"==Y?Ee=this.getExtAuthorityKeyIdentifier(ve,W):"2.5.29.37"==Y?Ee=this.getExtExtKeyUsage(ve,W):"1.3.6.1.5.5.7.1.1"==Y?Ee=this.getExtAuthorityInfoAccess(ve,W):"2.5.29.20"==Y?Ee=this.getExtCRLNumber(ve,W):"2.5.29.21"==Y?Ee=this.getExtCRLReason(ve,W):"1.3.6.1.5.5.7.48.1.2"==Y?Ee=this.getExtOcspNonce(ve,W):"1.3.6.1.5.5.7.48.1.5"==Y?Ee=this.getExtOcspNoCheck(ve,W):"1.2.840.113583.1.1.9.1"==Y&&(Ee=this.getExtAdobeTimeStamp(ve,W)),null!=Ee)return Ee;var Ge={extname:Y,extn:ve};return W&&(Ge.critical=!0),Ge},this.findExt=function(A,q){for(var Y=0;Y<A.length;Y++)if(A[Y].extname==q)return A[Y];return null},this.updateExtCDPFullURI=function(A,q){var Y=this.findExt(A,"cRLDistributionPoints");if(null!=Y&&null!=Y.array)for(var W=Y.array,ve=0;ve<W.length;ve++)if(null!=W[ve].dpname&&null!=W[ve].dpname.full)for(var Ee=W[ve].dpname.full,Ge=0;Ge<Ee.length;Ge++){var Te=Ee[ve];null!=Te.uri&&(Te.uri=q)}},this.updateExtAIAOCSP=function(A,q){var Y=this.findExt(A,"authorityInfoAccess");if(null!=Y&&null!=Y.array)for(var W=Y.array,ve=0;ve<W.length;ve++)null!=W[ve].ocsp&&(W[ve].ocsp=q)},this.updateExtAIACAIssuer=function(A,q){var Y=this.findExt(A,"authorityInfoAccess");if(null!=Y&&null!=Y.array)for(var W=Y.array,ve=0;ve<W.length;ve++)null!=W[ve].caissuer&&(W[ve].caissuer=q)},this.dnarraytostr=function(A){return"/"+A.map(function(q){return q.map(function(ve){return(Ge=ve).type+"="+Ge.value;var Ge}).join("+")}).join("/")},this.getInfo=function(){var A,q,Y,ur,ve=function(ur){for(var Gn="",Qn=ur.array,ze=0;ze<Qn.length;ze++){var wn=Qn[ze];if(Gn+="    policy oid: "+wn.policyoid+"\n",void 0!==wn.array)for(var Lt=0;Lt<wn.array.length;Lt++){var Pn=wn.array[Lt];void 0!==Pn.cps&&(Gn+="    cps: "+Pn.cps+"\n")}}return Gn},Ee=function(ur){for(var Gn="",Qn=ur.array,ze=0;ze<Qn.length;ze++){var wn=Qn[ze];try{void 0!==wn.dpname.full[0].uri&&(Gn+="    "+wn.dpname.full[0].uri+"\n")}catch(Lt){}try{void 0!==wn.dname.full[0].dn.hex&&(Gn+="    "+fn.hex2dn(wn.dpname.full[0].dn.hex)+"\n")}catch(Lt){}}return Gn},Ge=function(ur){for(var Gn="",Qn=ur.array,ze=0;ze<Qn.length;ze++){var wn=Qn[ze];void 0!==wn.caissuer&&(Gn+="    caissuer: "+wn.caissuer+"\n"),void 0!==wn.ocsp&&(Gn+="    ocsp: "+wn.ocsp+"\n")}return Gn};if(A="Basic Fields\n",A+="  serial number: "+this.getSerialNumberHex()+"\n",A+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",A+="  issuer: "+this.getIssuerString()+"\n",A+="  notBefore: "+this.getNotBefore()+"\n",A+="  notAfter: "+this.getNotAfter()+"\n",A+="  subject: "+this.getSubjectString()+"\n",A+="  subject public key info: \n",A+="    key algorithm: "+(q=this.getPublicKey()).type+"\n","RSA"===q.type&&(A+="    n="+qa(q.n.toString(16)).substr(0,16)+"...\n",A+="    e="+qa(q.e.toString(16))+"\n"),null!=(Y=this.aExtInfo)){A+="X509v3 Extensions:\n";for(var Te=0;Te<Y.length;Te++){var ht=Y[Te],$e=k.asn1.x509.OID.oid2name(ht.oid);""===$e&&($e=ht.oid);var Xe="";if(!0===ht.critical&&(Xe="CRITICAL"),A+="  "+$e+" "+Xe+":\n","basicConstraints"===$e){var qt=this.getExtBasicConstraints();void 0===qt.cA?A+="    {}\n":(A+="    cA=true",void 0!==qt.pathLen&&(A+=", pathLen="+qt.pathLen),A+="\n")}else if("keyUsage"===$e)A+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===$e)A+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"===$e){var mt=this.getExtAuthorityKeyIdentifier();void 0!==mt.kid&&(A+="    kid="+mt.kid.hex+"\n")}else"extKeyUsage"===$e?A+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"===$e?A+="    "+(ur=this.getExtSubjectAltName(),JSON.stringify(ur.array).replace(/[\[\]\{\}\"]/g,"")+"\n"):"cRLDistributionPoints"===$e?A+=Ee(this.getExtCRLDistributionPoints()):"authorityInfoAccess"===$e?A+=Ge(this.getExtAuthorityInfoAccess()):"certificatePolicies"===$e&&(A+=ve(this.getExtCertificatePolicies()))}}return(A+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof c&&(-1!=c.indexOf("-----BEGIN")?this.readCertPEM(c):k.lang.String.isHex(c)&&this.readCertHex(c))}et.prototype.sign=function(c,u){var d=function(g){return k.crypto.Util.hashString(g,u)}(c);return this.signWithMessageHash(d,u)},et.prototype.signWithMessageHash=function(c,u){var d=cn(k.crypto.Util.getPaddedDigestInfoHex(c,u,this.n.bitLength()),16);return Ka(this.doPrivate(d).toString(16),this.n.bitLength())},et.prototype.signPSS=function(c,u,d){var y,h=(y=qr(c),k.crypto.Util.hashHex(y,u));return void 0===d&&(d=-1),this.signWithMessageHashPSS(h,u,d)},et.prototype.signWithMessageHashPSS=function(c,u,d){var h,g=ar(c),y=g.length,D=this.n.bitLength()-1,B=Math.ceil(D/8),F=function(A){return k.crypto.Util.hashHex(A,u)};if(-1===d||void 0===d)d=y;else if(-2===d)d=B-y-2;else if(d<-2)throw new Error("invalid salt length");if(B<y+d+2)throw new Error("data too long");var N="";d>0&&(N=new Array(d),(new Kn).nextBytes(N),N=String.fromCharCode.apply(String,N));var P=ar(F(qr("\0\0\0\0\0\0\0\0"+g+N))),U=[];for(h=0;h<B-d-y-2;h+=1)U[h]=0;var X=String.fromCharCode.apply(String,U)+"\x01"+N,ue=Ec(P,X.length,F),pe=[];for(h=0;h<X.length;h+=1)pe[h]=X.charCodeAt(h)^ue.charCodeAt(h);for(pe[0]&=~(65280>>8*B-D&255),h=0;h<y;h++)pe.push(P.charCodeAt(h));return pe.push(188),Ka(this.doPrivate(new ae(pe)).toString(16),this.n.bitLength())},et.prototype.verify=function(c,u){var d=cn(u=(u=u.replace(Sc,"")).replace(/[ \n]+/g,""),16);if(d.bitLength()>this.n.bitLength())return 0;var h=xc(this.doPublic(d).toString(16).replace(/^1f+00/,""));return 0!=h.length&&h[1]==k.crypto.Util.hashString(c,h[0])},et.prototype.verifyWithMessageHash=function(c,u){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var d=cn(u,16);if(d.bitLength()>this.n.bitLength())return 0;var h=xc(this.doPublic(d).toString(16).replace(/^1f+00/,""));return 0!=h.length&&h[1]==c},et.prototype.verifyPSS=function(c,u,d,h){var D,g=(D=qr(c),k.crypto.Util.hashHex(D,d));return void 0===h&&(h=-1),this.verifyWithMessageHashPSS(g,u,d,h)},et.prototype.verifyWithMessageHashPSS=function(c,u,d,h){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var g,y=new ae(u,16),D=function(Y){return k.crypto.Util.hashHex(Y,d)},B=ar(c),F=B.length,N=this.n.bitLength()-1,P=Math.ceil(N/8);if(-1===h||void 0===h)h=F;else if(-2===h)h=P-F-2;else if(h<-2)throw new Error("invalid salt length");if(P<F+h+2)throw new Error("data too long");var U=this.doPublic(y).toByteArray();for(g=0;g<U.length;g+=1)U[g]&=255;for(;U.length<P;)U.unshift(0);if(188!==U[P-1])throw new Error("encoded message does not end in 0xbc");var X=(U=String.fromCharCode.apply(String,U)).substr(0,P-F-1),ue=U.substr(X.length,F),pe=65280>>8*P-N&255;if(0!=(X.charCodeAt(0)&pe))throw new Error("bits beyond keysize not zero");var be=Ec(ue,X.length,D),_e=[];for(g=0;g<X.length;g+=1)_e[g]=X.charCodeAt(g)^be.charCodeAt(g);_e[0]&=~pe;var A=P-F-h-2;for(g=0;g<A;g+=1)if(0!==_e[g])throw new Error("leftmost octets not zero");if(1!==_e[A])throw new Error("0x01 marker not found");return ue===ar(D(qr("\0\0\0\0\0\0\0\0"+B+String.fromCharCode.apply(String,_e.slice(-h)))))},et.SALT_LEN_HLEN=-1,et.SALT_LEN_MAX=-2,et.SALT_LEN_RECOVER=-2,fn.hex2dn=function(c,u){if(void 0===u&&(u=0),"30"!==c.substr(u,2))throw new Error("malformed DN");for(var d=new Array,h=Ne.getChildIdx(c,u),g=0;g<h.length;g++)d.push(fn.hex2rdn(c,h[g]));return"/"+(d=d.map(function(y){return y.replace("/","\\/")})).join("/")},fn.hex2rdn=function(c,u){if(void 0===u&&(u=0),"31"!==c.substr(u,2))throw new Error("malformed RDN");for(var d=new Array,h=Ne.getChildIdx(c,u),g=0;g<h.length;g++)d.push(fn.hex2attrTypeValue(c,h[g]));return(d=d.map(function(y){return y.replace("+","\\+")})).join("+")},fn.hex2attrTypeValue=function(c,u){var d=Ne,h=d.getV;if(void 0===u&&(u=0),"30"!==c.substr(u,2))throw new Error("malformed attribute type and value");var g=d.getChildIdx(c,u);2!==g.length||c.substr(g[0],2);var y=h(c,g[0]),D=k.asn1.ASN1Util.oidHexToInt(y);return k.asn1.x509.OID.oid2atype(D)+"="+ar(h(c,g[1]))},fn.getPublicKeyFromCertHex=function(c){var u=new fn;return u.readCertHex(c),u.getPublicKey()},fn.getPublicKeyFromCertPEM=function(c){var u=new fn;return u.readCertPEM(c),u.getPublicKey()},fn.getPublicKeyInfoPropOfCertPEM=function(c){var u,d,h=Ne.getVbyList,g={algparam:null};return(u=new fn).readCertPEM(c),d=u.getPublicKeyHex(),g.keyhex=h(d,0,[1],"03").substr(2),g.algoid=h(d,0,[0,0],"06"),"2a8648ce3d0201"===g.algoid&&(g.algparam=h(d,0,[0,1],"06")),g},fn.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==k&&k||(O.KJUR=k={}),void 0!==k.jws&&k.jws||(k.jws={}),k.jws.JWS=function(){var c=k.jws.JWS.isSafeJSONString;this.parseJWS=function(u,d){if(void 0===this.parsedJWS||!d&&void 0===this.parsedJWS.sigvalH){var h=u.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==h)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var g=h[1],y=h[2],D=h[3],B=g+"."+y;if(this.parsedJWS={},this.parsedJWS.headB64U=g,this.parsedJWS.payloadB64U=y,this.parsedJWS.sigvalB64U=D,this.parsedJWS.si=B,!d){var F=Ut(D),N=cn(F,16);this.parsedJWS.sigvalH=F,this.parsedJWS.sigvalBI=N}var P=Vr(g),U=Vr(y);if(this.parsedJWS.headS=P,this.parsedJWS.payloadS=U,!c(P,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+P}}},k.jws.JWS.sign=function(c,u,d,h,g){var y,D,B,N=k.jws.JWS,P=N.readSafeJSONString,U=N.isSafeJSONString,X=k.crypto,ue=X.Mac,pe=X.Signature,be=JSON;if("string"!=typeof u&&"object"!=(void 0===u?"undefined":C(u)))throw"spHeader must be JSON string or object: "+u;if("object"==(void 0===u?"undefined":C(u))&&(y=be.stringify(D=u)),"string"==typeof u){if(!U(y=u))throw"JWS Head is not safe JSON string: "+y;D=P(y)}if(B=d,"object"==(void 0===d?"undefined":C(d))&&(B=be.stringify(d)),""!=c&&null!=c||void 0===D.alg||(c=D.alg),""!=c&&null!=c&&void 0===D.alg&&(D.alg=c,y=be.stringify(D)),c!==D.alg)throw"alg and sHeader.alg doesn't match: "+c+"!="+D.alg;var _e=null;if(void 0===N.jwsalg2sigalg[c])throw"unsupported alg name: "+c;_e=N.jwsalg2sigalg[c];var A=So(y)+"."+So(B),q="";if("Hmac"==_e.substr(0,4)){if(void 0===h)throw"mac key shall be specified for HS* alg";var Y=new ue({alg:_e,prov:"cryptojs",pass:h});Y.updateString(A),q=Y.doFinal()}else if(-1!=_e.indexOf("withECDSA")){(ve=new pe({alg:_e})).init(h,g),ve.updateString(A);var W=ve.sign();q=k.crypto.ECDSA.asn1SigToConcatSig(W)}else{var ve;"none"!=_e&&((ve=new pe({alg:_e})).init(h,g),ve.updateString(A),q=ve.sign())}return A+"."+ln(q)},k.jws.JWS.verify=function(c,u,d){var h,y=k.jws.JWS,D=y.readSafeJSONString,B=k.crypto,F=B.ECDSA,N=B.Mac,P=B.Signature;void 0!==C(et)&&(h=et);var U=c.split(".");if(3!==U.length)return!1;var _e,X=U[0]+"."+U[1],ue=Ut(U[2]),pe=D(Vr(U[0])),be=null;if(void 0===pe.alg)throw"algorithm not specified in header";if(_e=(be=pe.alg).substr(0,2),null!=d&&"[object Array]"===Object.prototype.toString.call(d)&&d.length>0&&-1==(":"+d.join(":")+":").indexOf(":"+be+":"))throw"algorithm '"+be+"' not accepted in the list";if("none"!=be&&null===u)throw"key shall be specified to verify.";if("string"==typeof u&&-1!=u.indexOf("-----BEGIN ")&&(u=dn.getKey(u)),!("RS"!=_e&&"PS"!=_e||u instanceof h))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==_e&&!(u instanceof F))throw"key shall be a ECDSA obj for ES* algs";var A=null;if(void 0===y.jwsalg2sigalg[pe.alg])throw"unsupported alg name: "+be;if("none"==(A=y.jwsalg2sigalg[be]))throw"not supported";if("Hmac"==A.substr(0,4)){if(void 0===u)throw"hexadecimal key shall be specified for HMAC";var q=new N({alg:A,pass:u});return q.updateString(X),ue==q.doFinal()}if(-1!=A.indexOf("withECDSA")){var Y,W=null;try{W=F.concatSigToASN1Sig(ue)}catch(ve){return!1}return(Y=new P({alg:A})).init(u),Y.updateString(X),Y.verify(W)}return(Y=new P({alg:A})).init(u),Y.updateString(X),Y.verify(ue)},k.jws.JWS.parse=function(c){var d,h,g=c.split("."),y={};if(2!=g.length&&3!=g.length)throw"malformed sJWS: wrong number of '.' splitted elements";return d=g[1],3==g.length&&(h=g[2]),y.headerObj=k.jws.JWS.readSafeJSONString(Vr(g[0])),y.payloadObj=k.jws.JWS.readSafeJSONString(Vr(d)),y.headerPP=JSON.stringify(y.headerObj,null,"  "),y.payloadPP=null==y.payloadObj?Vr(d):JSON.stringify(y.payloadObj,null,"  "),void 0!==h&&(y.sigHex=Ut(h)),y},k.jws.JWS.verifyJWT=function(c,u,d){var h=k.jws,g=h.JWS,y=g.readSafeJSONString,D=g.inArray,B=g.includedArray,F=c.split("."),N=F[0],P=F[1],U=(Ut(F[2]),y(Vr(N))),X=y(Vr(P));if(void 0===U.alg)return!1;if(void 0===d.alg)throw"acceptField.alg shall be specified";if(!D(U.alg,d.alg)||void 0!==X.iss&&"object"===C(d.iss)&&!D(X.iss,d.iss)||void 0!==X.sub&&"object"===C(d.sub)&&!D(X.sub,d.sub))return!1;if(void 0!==X.aud&&"object"===C(d.aud))if("string"==typeof X.aud){if(!D(X.aud,d.aud))return!1}else if("object"==C(X.aud)&&!B(X.aud,d.aud))return!1;var ue=h.IntDate.getNow();return void 0!==d.verifyAt&&"number"==typeof d.verifyAt&&(ue=d.verifyAt),void 0!==d.gracePeriod&&"number"==typeof d.gracePeriod||(d.gracePeriod=0),!(void 0!==X.exp&&"number"==typeof X.exp&&X.exp+d.gracePeriod<ue||void 0!==X.nbf&&"number"==typeof X.nbf&&ue<X.nbf-d.gracePeriod||void 0!==X.iat&&"number"==typeof X.iat&&ue<X.iat-d.gracePeriod||void 0!==X.jti&&void 0!==d.jti&&X.jti!==d.jti||!g.verify(c,u,d.alg))},k.jws.JWS.includedArray=function(c,u){var d=k.jws.JWS.inArray;if(null===c||"object"!==(void 0===c?"undefined":C(c))||"number"!=typeof c.length)return!1;for(var h=0;h<c.length;h++)if(!d(c[h],u))return!1;return!0},k.jws.JWS.inArray=function(c,u){if(null===u||"object"!==(void 0===u?"undefined":C(u))||"number"!=typeof u.length)return!1;for(var d=0;d<u.length;d++)if(u[d]==c)return!0;return!1},k.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},k.jws.JWS.isSafeJSONString=function(c,u,d){var h=null;try{return"object"!=(void 0===(h=Gd(c))?"undefined":C(h))||h.constructor===Array?0:(u&&(u[d]=h),1)}catch(g){return 0}},k.jws.JWS.readSafeJSONString=function(c){var u=null;try{return"object"!=(void 0===(u=Gd(c))?"undefined":C(u))||u.constructor===Array?null:u}catch(d){return null}},k.jws.JWS.getEncodedSignatureValueFromJWS=function(c){var u=c.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==u)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return u[1]},k.jws.JWS.getJWKthumbprint=function(c){if("RSA"!==c.kty&&"EC"!==c.kty&&"oct"!==c.kty)throw"unsupported algorithm for JWK Thumprint";var u="{";if("RSA"===c.kty){if("string"!=typeof c.n||"string"!=typeof c.e)throw"wrong n and e value for RSA key";u+='"e":"'+c.e+'",',u+='"kty":"'+c.kty+'",',u+='"n":"'+c.n+'"}'}else if("EC"===c.kty){if("string"!=typeof c.crv||"string"!=typeof c.x||"string"!=typeof c.y)throw"wrong crv, x and y value for EC key";u+='"crv":"'+c.crv+'",',u+='"kty":"'+c.kty+'",',u+='"x":"'+c.x+'",',u+='"y":"'+c.y+'"}'}else if("oct"===c.kty){if("string"!=typeof c.k)throw"wrong k value for oct(symmetric) key";u+='"kty":"'+c.kty+'",',u+='"k":"'+c.k+'"}'}var d=qr(u);return ln(k.crypto.Util.hashHex(d,"sha256"))},k.jws.IntDate={},k.jws.IntDate.get=function(c){var u=k.jws.IntDate,d=u.getNow,h=u.getZulu;if("now"==c)return d();if("now + 1hour"==c)return d()+3600;if("now + 1day"==c)return d()+86400;if("now + 1month"==c)return d()+2592e3;if("now + 1year"==c)return d()+31536e3;if(c.match(/Z$/))return h(c);if(c.match(/^[0-9]+$/))return parseInt(c);throw"unsupported format: "+c},k.jws.IntDate.getZulu=function(c){return wc(c)},k.jws.IntDate.getNow=function(){return~~(new Date/1e3)},k.jws.IntDate.intDate2UTCString=function(c){return new Date(1e3*c).toUTCString()},k.jws.IntDate.intDate2Zulu=function(c){var u=new Date(1e3*c);return("0000"+u.getUTCFullYear()).slice(-4)+("00"+(u.getUTCMonth()+1)).slice(-2)+("00"+u.getUTCDate()).slice(-2)+("00"+u.getUTCHours()).slice(-2)+("00"+u.getUTCMinutes()).slice(-2)+("00"+u.getUTCSeconds()).slice(-2)+"Z"},O.SecureRandom=Kn,O.rng_seed_time=Ce,O.BigInteger=ae,O.RSAKey=et,O.EDSA=k.crypto.EDSA,O.DSA=k.crypto.DSA,O.Signature=k.crypto.Signature,O.MessageDigest=k.crypto.MessageDigest,O.Mac=k.crypto.Mac,O.Cipher=k.crypto.Cipher,O.KEYUTIL=dn,O.ASN1HEX=Ne,O.X509=fn,O.CryptoJS=se,O.b64tohex=Ie,O.b64toBA=Be,O.stoBA=Ua,O.BAtos=Ha,O.BAtohex=Gs,O.stohex=$r,O.stob64=function(u){return Fe($r(u))},O.stob64u=function(u){return Eo(Fe($r(u)))},O.b64utos=function(u){return Ha(Be(ps(u)))},O.b64tob64u=Eo,O.b64utob64=ps,O.hex2b64=Fe,O.hextob64u=ln,O.b64utohex=Ut,O.utf8tob64u=So,O.b64utoutf8=Vr,O.utf8tob64=function(u){return Fe(sn(Co(u)))},O.b64toutf8=function(u){return decodeURIComponent(Ti(Ie(u)))},O.utf8tohex=xo,O.hextoutf8=$t,O.hextorstr=ar,O.rstrtohex=qr,O.hextob64=_c,O.hextob64nl=bc,O.b64nltohex=Va,O.hextopem=Yn,O.pemtohex=Kr,O.hextoArrayBuffer=function(u){if(u.length%2!=0)throw"input is not even length";if(null==u.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var d=new ArrayBuffer(u.length/2),h=new DataView(d),g=0;g<u.length/2;g++)h.setUint8(g,parseInt(u.substr(2*g,2),16));return d},O.ArrayBuffertohex=function(u){for(var d="",h=new DataView(u),g=0;g<u.byteLength;g++)d+=("00"+h.getUint8(g).toString(16)).slice(-2);return d},O.zulutomsec=Ir,O.zulutosec=wc,O.zulutodate=function(u){return new Date(Ir(u))},O.datetozulu=function(u,d,h){var g,y=u.getUTCFullYear();if(d){if(y<1950||2049<y)throw"not proper year for UTCTime: "+y;g=(""+y).slice(-2)}else g=("000"+y).slice(-4);if(g+=("0"+(u.getUTCMonth()+1)).slice(-2),g+=("0"+u.getUTCDate()).slice(-2),g+=("0"+u.getUTCHours()).slice(-2),g+=("0"+u.getUTCMinutes()).slice(-2),g+=("0"+u.getUTCSeconds()).slice(-2),h){var D=u.getUTCMilliseconds();0!==D&&(g+="."+(D=(D=("00"+D).slice(-3)).replace(/0+$/g,"")))}return g+"Z"},O.uricmptohex=sn,O.hextouricmp=Ti,O.ipv6tohex=Gr,O.hextoipv6=zd,O.hextoip=$a,O.iptohex=function(u){var d="malformed IP address";if(!(u=u.toLowerCase(u)).match(/^[0-9.]+$/)){if(u.match(/^[0-9a-f:]+$/)&&-1!==u.indexOf(":"))return Gr(u);throw d}var h=u.split(".");if(4!==h.length)throw d;var g="";try{for(var y=0;y<4;y++)g+=("0"+parseInt(h[y]).toString(16)).slice(-2);return g}catch(D){throw d}},O.encodeURIComponentAll=Co,O.newline_toUnix=function(u){return u.replace(/\r\n/gm,"\n")},O.newline_toDos=function(u){return(u=u.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},O.hextoposhex=qa,O.intarystrtohex=function(u){u=(u=(u=u.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return u.split(/,/).map(function(d,h,g){var y=parseInt(d);if(y<0||255<y)throw"integer not in range 0-255";return("00"+y.toString(16)).slice(-2)}).join("")}catch(d){throw"malformed integer array string: "+d}},O.strdiffidx=function(u,d){var h=u.length;u.length>d.length&&(h=d.length);for(var g=0;g<h;g++)if(u.charCodeAt(g)!=d.charCodeAt(g))return g;return u.length!=d.length?h:-1},O.KJUR=k,O.crypto=k.crypto,O.asn1=k.asn1,O.jws=k.jws,O.lang=k.lang}).call(this,ne(28).Buffer)},function(qe,O,ne){"use strict";(function(Z){var C=ne(30),Q=ne(31),M=ne(32);function _(){return v.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function b(te,w){if(_()<w)throw new RangeError("Invalid typed array length");return v.TYPED_ARRAY_SUPPORT?(te=new Uint8Array(w)).__proto__=v.prototype:(null===te&&(te=new v(w)),te.length=w),te}function v(te,w,S){if(!(v.TYPED_ARRAY_SUPPORT||this instanceof v))return new v(te,w,S);if("number"==typeof te){if("string"==typeof w)throw new Error("If encoding is specified then the first argument must be a string");return V(this,te)}return T(this,te,w,S)}function T(te,w,S,ee){if("number"==typeof w)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&w instanceof ArrayBuffer?function(he,Ce,Ke,it){if(Ke<0||Ce.byteLength<Ke)throw new RangeError("'offset' is out of bounds");if(Ce.byteLength<Ke+(it||0))throw new RangeError("'length' is out of bounds");return Ce=void 0===Ke&&void 0===it?new Uint8Array(Ce):void 0===it?new Uint8Array(Ce,Ke):new Uint8Array(Ce,Ke,it),v.TYPED_ARRAY_SUPPORT?(he=Ce).__proto__=v.prototype:he=oe(he,Ce),he}(te,w,S,ee):"string"==typeof w?function(he,Ce,Ke){if("string"==typeof Ke&&""!==Ke||(Ke="utf8"),!v.isEncoding(Ke))throw new TypeError('"encoding" must be a valid string encoding');var it=0|K(Ce,Ke),kt=(he=b(he,it)).write(Ce,Ke);return kt!==it&&(he=he.slice(0,kt)),he}(te,w,S):function(he,Ce){if(v.isBuffer(Ce)){var Ke=0|J(Ce.length);return 0===(he=b(he,Ke)).length||Ce.copy(he,0,0,Ke),he}if(Ce){if("undefined"!=typeof ArrayBuffer&&Ce.buffer instanceof ArrayBuffer||"length"in Ce)return"number"!=typeof Ce.length||(kt=Ce.length)!=kt?b(he,0):oe(he,Ce);if("Buffer"===Ce.type&&M(Ce.data))return oe(he,Ce.data)}var kt;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(te,w)}function G(te){if("number"!=typeof te)throw new TypeError('"size" argument must be a number');if(te<0)throw new RangeError('"size" argument must not be negative')}function V(te,w){if(G(w),te=b(te,w<0?0:0|J(w)),!v.TYPED_ARRAY_SUPPORT)for(var S=0;S<w;++S)te[S]=0;return te}function oe(te,w){var S=w.length<0?0:0|J(w.length);te=b(te,S);for(var ee=0;ee<S;ee+=1)te[ee]=255&w[ee];return te}function J(te){if(te>=_())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_().toString(16)+" bytes");return 0|te}function K(te,w){if(v.isBuffer(te))return te.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(te)||te instanceof ArrayBuffer))return te.byteLength;"string"!=typeof te&&(te=""+te);var S=te.length;if(0===S)return 0;for(var ee=!1;;)switch(w){case"ascii":case"latin1":case"binary":return S;case"utf8":case"utf-8":case void 0:return mn(te).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*S;case"hex":return S>>>1;case"base64":return or(te).length;default:if(ee)return mn(te).length;w=(""+w).toLowerCase(),ee=!0}}function $(te,w,S){var ee=!1;if((void 0===w||w<0)&&(w=0),w>this.length||((void 0===S||S>this.length)&&(S=this.length),S<=0)||(S>>>=0)<=(w>>>=0))return"";for(te||(te="utf8");;)switch(te){case"hex":return _t(this,w,S);case"utf8":case"utf-8":return Ot(this,w,S);case"ascii":return $n(this,w,S);case"latin1":case"binary":return Gt(this,w,S);case"base64":return Ye(this,w,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nn(this,w,S);default:if(ee)throw new TypeError("Unknown encoding: "+te);te=(te+"").toLowerCase(),ee=!0}}function re(te,w,S){var ee=te[w];te[w]=te[S],te[S]=ee}function me(te,w,S,ee,ce){if(0===te.length)return-1;if("string"==typeof S?(ee=S,S=0):S>2147483647?S=2147483647:S<-2147483648&&(S=-2147483648),S=+S,isNaN(S)&&(S=ce?0:te.length-1),S<0&&(S=te.length+S),S>=te.length){if(ce)return-1;S=te.length-1}else if(S<0){if(!ce)return-1;S=0}if("string"==typeof w&&(w=v.from(w,ee)),v.isBuffer(w))return 0===w.length?-1:se(te,w,S,ee,ce);if("number"==typeof w)return w&=255,v.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?ce?Uint8Array.prototype.indexOf.call(te,w,S):Uint8Array.prototype.lastIndexOf.call(te,w,S):se(te,[w],S,ee,ce);throw new TypeError("val must be string, number or Buffer")}function se(te,w,S,ee,ce){var he,Ce=1,Ke=te.length,it=w.length;if(void 0!==ee&&("ucs2"===(ee=String(ee).toLowerCase())||"ucs-2"===ee||"utf16le"===ee||"utf-16le"===ee)){if(te.length<2||w.length<2)return-1;Ce=2,Ke/=2,it/=2,S/=2}function kt(cn,Fr){return 1===Ce?cn[Fr]:cn.readUInt16BE(Fr*Ce)}if(ce){var Et=-1;for(he=S;he<Ke;he++)if(kt(te,he)===kt(w,-1===Et?0:he-Et)){if(-1===Et&&(Et=he),he-Et+1===it)return Et*Ce}else-1!==Et&&(he-=he-Et),Et=-1}else for(S+it>Ke&&(S=Ke-it),he=S;he>=0;he--){for(var rn=!0,Kn=0;Kn<it;Kn++)if(kt(te,he+Kn)!==kt(w,Kn)){rn=!1;break}if(rn)return he}return-1}function le(te,w,S,ee){S=Number(S)||0;var ce=te.length-S;ee?(ee=Number(ee))>ce&&(ee=ce):ee=ce;var he=w.length;if(he%2!=0)throw new TypeError("Invalid hex string");ee>he/2&&(ee=he/2);for(var Ce=0;Ce<ee;++Ce){var Ke=parseInt(w.substr(2*Ce,2),16);if(isNaN(Ke))return Ce;te[S+Ce]=Ke}return Ce}function ie(te,w,S,ee){return Un(mn(w,te.length-S),te,S,ee)}function Fe(te,w,S,ee){return Un(function(he){for(var Ce=[],Ke=0;Ke<he.length;++Ke)Ce.push(255&he.charCodeAt(Ke));return Ce}(w),te,S,ee)}function Ie(te,w,S,ee){return Fe(te,w,S,ee)}function Be(te,w,S,ee){return Un(or(w),te,S,ee)}function ae(te,w,S,ee){return Un(function(he,Ce){for(var Ke,it,Et=[],rn=0;rn<he.length&&!((Ce-=2)<0);++rn)it=(Ke=he.charCodeAt(rn))>>8,Et.push(Ke%256),Et.push(it);return Et}(w,te.length-S),te,S,ee)}function Ye(te,w,S){return C.fromByteArray(0===w&&S===te.length?te:te.slice(w,S))}function Ot(te,w,S){S=Math.min(te.length,S);for(var ee=[],ce=w;ce<S;){var he,Ce,Ke,it,kt=te[ce],Et=null,rn=kt>239?4:kt>223?3:kt>191?2:1;if(ce+rn<=S)switch(rn){case 1:kt<128&&(Et=kt);break;case 2:128==(192&(he=te[ce+1]))&&(it=(31&kt)<<6|63&he)>127&&(Et=it);break;case 3:Ce=te[ce+2],128==(192&(he=te[ce+1]))&&128==(192&Ce)&&(it=(15&kt)<<12|(63&he)<<6|63&Ce)>2047&&(it<55296||it>57343)&&(Et=it);break;case 4:Ce=te[ce+2],Ke=te[ce+3],128==(192&(he=te[ce+1]))&&128==(192&Ce)&&128==(192&Ke)&&(it=(15&kt)<<18|(63&he)<<12|(63&Ce)<<6|63&Ke)>65535&&it<1114112&&(Et=it)}null===Et?(Et=65533,rn=1):Et>65535&&(ee.push((Et-=65536)>>>10&1023|55296),Et=56320|1023&Et),ee.push(Et),ce+=rn}return function(cn){var Fr=cn.length;if(Fr<=Pt)return String.fromCharCode.apply(String,cn);for(var et="",Qt=0;Qt<Fr;)et+=String.fromCharCode.apply(String,cn.slice(Qt,Qt+=Pt));return et}(ee)}O.Buffer=v,O.SlowBuffer=function(w){return+w!=w&&(w=0),v.alloc(+w)},O.INSPECT_MAX_BYTES=50,v.TYPED_ARRAY_SUPPORT=void 0!==Z.TYPED_ARRAY_SUPPORT?Z.TYPED_ARRAY_SUPPORT:function(){try{var w=new Uint8Array(1);return w.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===w.foo()&&"function"==typeof w.subarray&&0===w.subarray(1,1).byteLength}catch(S){return!1}}(),O.kMaxLength=_(),v.poolSize=8192,v._augment=function(te){return te.__proto__=v.prototype,te},v.from=function(te,w,S){return T(null,te,w,S)},v.TYPED_ARRAY_SUPPORT&&(v.prototype.__proto__=Uint8Array.prototype,v.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&v[Symbol.species]===v&&Object.defineProperty(v,Symbol.species,{value:null,configurable:!0})),v.alloc=function(te,w,S){return null,Ce=w,Ke=S,G(he=te),he<=0?b(null,he):void 0!==Ce?"string"==typeof Ke?b(null,he).fill(Ce,Ke):b(null,he).fill(Ce):b(null,he);var he,Ce,Ke},v.allocUnsafe=function(te){return V(null,te)},v.allocUnsafeSlow=function(te){return V(null,te)},v.isBuffer=function(w){return!(null==w||!w._isBuffer)},v.compare=function(w,S){if(!v.isBuffer(w)||!v.isBuffer(S))throw new TypeError("Arguments must be Buffers");if(w===S)return 0;for(var ee=w.length,ce=S.length,he=0,Ce=Math.min(ee,ce);he<Ce;++he)if(w[he]!==S[he]){ee=w[he],ce=S[he];break}return ee<ce?-1:ce<ee?1:0},v.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(w,S){if(!M(w))throw new TypeError('"list" argument must be an Array of Buffers');if(0===w.length)return v.alloc(0);var ee;if(void 0===S)for(S=0,ee=0;ee<w.length;++ee)S+=w[ee].length;var ce=v.allocUnsafe(S),he=0;for(ee=0;ee<w.length;++ee){var Ce=w[ee];if(!v.isBuffer(Ce))throw new TypeError('"list" argument must be an Array of Buffers');Ce.copy(ce,he),he+=Ce.length}return ce},v.byteLength=K,v.prototype._isBuffer=!0,v.prototype.swap16=function(){var w=this.length;if(w%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var S=0;S<w;S+=2)re(this,S,S+1);return this},v.prototype.swap32=function(){var w=this.length;if(w%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var S=0;S<w;S+=4)re(this,S,S+3),re(this,S+1,S+2);return this},v.prototype.swap64=function(){var w=this.length;if(w%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var S=0;S<w;S+=8)re(this,S,S+7),re(this,S+1,S+6),re(this,S+2,S+5),re(this,S+3,S+4);return this},v.prototype.toString=function(){var w=0|this.length;return 0===w?"":0===arguments.length?Ot(this,0,w):$.apply(this,arguments)},v.prototype.equals=function(w){if(!v.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w||0===v.compare(this,w)},v.prototype.inspect=function(){var w="",S=O.INSPECT_MAX_BYTES;return this.length>0&&(w=this.toString("hex",0,S).match(/.{2}/g).join(" "),this.length>S&&(w+=" ... ")),"<Buffer "+w+">"},v.prototype.compare=function(w,S,ee,ce,he){if(!v.isBuffer(w))throw new TypeError("Argument must be a Buffer");if(void 0===S&&(S=0),void 0===ee&&(ee=w?w.length:0),void 0===ce&&(ce=0),void 0===he&&(he=this.length),S<0||ee>w.length||ce<0||he>this.length)throw new RangeError("out of range index");if(ce>=he&&S>=ee)return 0;if(ce>=he)return-1;if(S>=ee)return 1;if(this===w)return 0;for(var Ce=(he>>>=0)-(ce>>>=0),Ke=(ee>>>=0)-(S>>>=0),it=Math.min(Ce,Ke),kt=this.slice(ce,he),Et=w.slice(S,ee),rn=0;rn<it;++rn)if(kt[rn]!==Et[rn]){Ce=kt[rn],Ke=Et[rn];break}return Ce<Ke?-1:Ke<Ce?1:0},v.prototype.includes=function(w,S,ee){return-1!==this.indexOf(w,S,ee)},v.prototype.indexOf=function(w,S,ee){return me(this,w,S,ee,!0)},v.prototype.lastIndexOf=function(w,S,ee){return me(this,w,S,ee,!1)},v.prototype.write=function(w,S,ee,ce){if(void 0===S)ce="utf8",ee=this.length,S=0;else if(void 0===ee&&"string"==typeof S)ce=S,ee=this.length,S=0;else{if(!isFinite(S))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");S|=0,isFinite(ee)?(ee|=0,void 0===ce&&(ce="utf8")):(ce=ee,ee=void 0)}var he=this.length-S;if((void 0===ee||ee>he)&&(ee=he),w.length>0&&(ee<0||S<0)||S>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");for(var Ce=!1;;)switch(ce){case"hex":return le(this,w,S,ee);case"utf8":case"utf-8":return ie(this,w,S,ee);case"ascii":return Fe(this,w,S,ee);case"latin1":case"binary":return Ie(this,w,S,ee);case"base64":return Be(this,w,S,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,w,S,ee);default:if(Ce)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),Ce=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Pt=4096;function $n(te,w,S){var ee="";S=Math.min(te.length,S);for(var ce=w;ce<S;++ce)ee+=String.fromCharCode(127&te[ce]);return ee}function Gt(te,w,S){var ee="";S=Math.min(te.length,S);for(var ce=w;ce<S;++ce)ee+=String.fromCharCode(te[ce]);return ee}function _t(te,w,S){var ee=te.length;(!w||w<0)&&(w=0),(!S||S<0||S>ee)&&(S=ee);for(var ce="",he=w;he<S;++he)ce+=ct(te[he]);return ce}function nn(te,w,S){for(var ee=te.slice(w,S),ce="",he=0;he<ee.length;he+=2)ce+=String.fromCharCode(ee[he]+256*ee[he+1]);return ce}function bt(te,w,S){if(te%1!=0||te<0)throw new RangeError("offset is not uint");if(te+w>S)throw new RangeError("Trying to access beyond buffer length")}function wt(te,w,S,ee,ce,he){if(!v.isBuffer(te))throw new TypeError('"buffer" argument must be a Buffer instance');if(w>ce||w<he)throw new RangeError('"value" argument is out of bounds');if(S+ee>te.length)throw new RangeError("Index out of range")}function Yt(te,w,S,ee){w<0&&(w=65535+w+1);for(var ce=0,he=Math.min(te.length-S,2);ce<he;++ce)te[S+ce]=(w&255<<8*(ee?ce:1-ce))>>>8*(ee?ce:1-ce)}function Bt(te,w,S,ee){w<0&&(w=4294967295+w+1);for(var ce=0,he=Math.min(te.length-S,4);ce<he;++ce)te[S+ce]=w>>>8*(ee?ce:3-ce)&255}function Bn(te,w,S,ee,ce,he){if(S+ee>te.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("Index out of range")}function qn(te,w,S,ee,ce){return ce||Bn(te,0,S,4),Q.write(te,w,S,ee,23,4),S+4}function Mt(te,w,S,ee,ce){return ce||Bn(te,0,S,8),Q.write(te,w,S,ee,52,8),S+8}v.prototype.slice=function(w,S){var ee,ce=this.length;if((w=~~w)<0?(w+=ce)<0&&(w=0):w>ce&&(w=ce),(S=void 0===S?ce:~~S)<0?(S+=ce)<0&&(S=0):S>ce&&(S=ce),S<w&&(S=w),v.TYPED_ARRAY_SUPPORT)(ee=this.subarray(w,S)).__proto__=v.prototype;else{var he=S-w;ee=new v(he,void 0);for(var Ce=0;Ce<he;++Ce)ee[Ce]=this[Ce+w]}return ee},v.prototype.readUIntLE=function(w,S,ee){w|=0,S|=0,ee||bt(w,S,this.length);for(var ce=this[w],he=1,Ce=0;++Ce<S&&(he*=256);)ce+=this[w+Ce]*he;return ce},v.prototype.readUIntBE=function(w,S,ee){w|=0,S|=0,ee||bt(w,S,this.length);for(var ce=this[w+--S],he=1;S>0&&(he*=256);)ce+=this[w+--S]*he;return ce},v.prototype.readUInt8=function(w,S){return S||bt(w,1,this.length),this[w]},v.prototype.readUInt16LE=function(w,S){return S||bt(w,2,this.length),this[w]|this[w+1]<<8},v.prototype.readUInt16BE=function(w,S){return S||bt(w,2,this.length),this[w]<<8|this[w+1]},v.prototype.readUInt32LE=function(w,S){return S||bt(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+16777216*this[w+3]},v.prototype.readUInt32BE=function(w,S){return S||bt(w,4,this.length),16777216*this[w]+(this[w+1]<<16|this[w+2]<<8|this[w+3])},v.prototype.readIntLE=function(w,S,ee){w|=0,S|=0,ee||bt(w,S,this.length);for(var ce=this[w],he=1,Ce=0;++Ce<S&&(he*=256);)ce+=this[w+Ce]*he;return ce>=(he*=128)&&(ce-=Math.pow(2,8*S)),ce},v.prototype.readIntBE=function(w,S,ee){w|=0,S|=0,ee||bt(w,S,this.length);for(var ce=S,he=1,Ce=this[w+--ce];ce>0&&(he*=256);)Ce+=this[w+--ce]*he;return Ce>=(he*=128)&&(Ce-=Math.pow(2,8*S)),Ce},v.prototype.readInt8=function(w,S){return S||bt(w,1,this.length),128&this[w]?-1*(255-this[w]+1):this[w]},v.prototype.readInt16LE=function(w,S){S||bt(w,2,this.length);var ee=this[w]|this[w+1]<<8;return 32768&ee?4294901760|ee:ee},v.prototype.readInt16BE=function(w,S){S||bt(w,2,this.length);var ee=this[w+1]|this[w]<<8;return 32768&ee?4294901760|ee:ee},v.prototype.readInt32LE=function(w,S){return S||bt(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},v.prototype.readInt32BE=function(w,S){return S||bt(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},v.prototype.readFloatLE=function(w,S){return S||bt(w,4,this.length),Q.read(this,w,!0,23,4)},v.prototype.readFloatBE=function(w,S){return S||bt(w,4,this.length),Q.read(this,w,!1,23,4)},v.prototype.readDoubleLE=function(w,S){return S||bt(w,8,this.length),Q.read(this,w,!0,52,8)},v.prototype.readDoubleBE=function(w,S){return S||bt(w,8,this.length),Q.read(this,w,!1,52,8)},v.prototype.writeUIntLE=function(w,S,ee,ce){w=+w,S|=0,ee|=0,ce||wt(this,w,S,ee,Math.pow(2,8*ee)-1,0);var he=1,Ce=0;for(this[S]=255&w;++Ce<ee&&(he*=256);)this[S+Ce]=w/he&255;return S+ee},v.prototype.writeUIntBE=function(w,S,ee,ce){w=+w,S|=0,ee|=0,ce||wt(this,w,S,ee,Math.pow(2,8*ee)-1,0);var he=ee-1,Ce=1;for(this[S+he]=255&w;--he>=0&&(Ce*=256);)this[S+he]=w/Ce&255;return S+ee},v.prototype.writeUInt8=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,1,255,0),v.TYPED_ARRAY_SUPPORT||(w=Math.floor(w)),this[S]=255&w,S+1},v.prototype.writeUInt16LE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[S]=255&w,this[S+1]=w>>>8):Yt(this,w,S,!0),S+2},v.prototype.writeUInt16BE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>8,this[S+1]=255&w):Yt(this,w,S,!1),S+2},v.prototype.writeUInt32LE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[S+3]=w>>>24,this[S+2]=w>>>16,this[S+1]=w>>>8,this[S]=255&w):Bt(this,w,S,!0),S+4},v.prototype.writeUInt32BE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>24,this[S+1]=w>>>16,this[S+2]=w>>>8,this[S+3]=255&w):Bt(this,w,S,!1),S+4},v.prototype.writeIntLE=function(w,S,ee,ce){if(w=+w,S|=0,!ce){var he=Math.pow(2,8*ee-1);wt(this,w,S,ee,he-1,-he)}var Ce=0,Ke=1,it=0;for(this[S]=255&w;++Ce<ee&&(Ke*=256);)w<0&&0===it&&0!==this[S+Ce-1]&&(it=1),this[S+Ce]=(w/Ke>>0)-it&255;return S+ee},v.prototype.writeIntBE=function(w,S,ee,ce){if(w=+w,S|=0,!ce){var he=Math.pow(2,8*ee-1);wt(this,w,S,ee,he-1,-he)}var Ce=ee-1,Ke=1,it=0;for(this[S+Ce]=255&w;--Ce>=0&&(Ke*=256);)w<0&&0===it&&0!==this[S+Ce+1]&&(it=1),this[S+Ce]=(w/Ke>>0)-it&255;return S+ee},v.prototype.writeInt8=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,1,127,-128),v.TYPED_ARRAY_SUPPORT||(w=Math.floor(w)),w<0&&(w=255+w+1),this[S]=255&w,S+1},v.prototype.writeInt16LE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[S]=255&w,this[S+1]=w>>>8):Yt(this,w,S,!0),S+2},v.prototype.writeInt16BE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>8,this[S+1]=255&w):Yt(this,w,S,!1),S+2},v.prototype.writeInt32LE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,4,2147483647,-2147483648),v.TYPED_ARRAY_SUPPORT?(this[S]=255&w,this[S+1]=w>>>8,this[S+2]=w>>>16,this[S+3]=w>>>24):Bt(this,w,S,!0),S+4},v.prototype.writeInt32BE=function(w,S,ee){return w=+w,S|=0,ee||wt(this,w,S,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>24,this[S+1]=w>>>16,this[S+2]=w>>>8,this[S+3]=255&w):Bt(this,w,S,!1),S+4},v.prototype.writeFloatLE=function(w,S,ee){return qn(this,w,S,!0,ee)},v.prototype.writeFloatBE=function(w,S,ee){return qn(this,w,S,!1,ee)},v.prototype.writeDoubleLE=function(w,S,ee){return Mt(this,w,S,!0,ee)},v.prototype.writeDoubleBE=function(w,S,ee){return Mt(this,w,S,!1,ee)},v.prototype.copy=function(w,S,ee,ce){if(ee||(ee=0),ce||0===ce||(ce=this.length),S>=w.length&&(S=w.length),S||(S=0),ce>0&&ce<ee&&(ce=ee),ce===ee||0===w.length||0===this.length)return 0;if(S<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("sourceStart out of bounds");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),w.length-S<ce-ee&&(ce=w.length-S+ee);var he,Ce=ce-ee;if(this===w&&ee<S&&S<ce)for(he=Ce-1;he>=0;--he)w[he+S]=this[he+ee];else if(Ce<1e3||!v.TYPED_ARRAY_SUPPORT)for(he=0;he<Ce;++he)w[he+S]=this[he+ee];else Uint8Array.prototype.set.call(w,this.subarray(ee,ee+Ce),S);return Ce},v.prototype.fill=function(w,S,ee,ce){if("string"==typeof w){if("string"==typeof S?(ce=S,S=0,ee=this.length):"string"==typeof ee&&(ce=ee,ee=this.length),1===w.length){var he=w.charCodeAt(0);he<256&&(w=he)}if(void 0!==ce&&"string"!=typeof ce)throw new TypeError("encoding must be a string");if("string"==typeof ce&&!v.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce)}else"number"==typeof w&&(w&=255);if(S<0||this.length<S||this.length<ee)throw new RangeError("Out of range index");if(ee<=S)return this;var Ce;if(S>>>=0,ee=void 0===ee?this.length:ee>>>0,w||(w=0),"number"==typeof w)for(Ce=S;Ce<ee;++Ce)this[Ce]=w;else{var Ke=v.isBuffer(w)?w:mn(new v(w,ce).toString()),it=Ke.length;for(Ce=0;Ce<ee-S;++Ce)this[Ce+S]=Ke[Ce%it]}return this};var Vt=/[^+\/0-9A-Za-z-_]/g;function ct(te){return te<16?"0"+te.toString(16):te.toString(16)}function mn(te,w){var S;w=w||1/0;for(var ee=te.length,ce=null,he=[],Ce=0;Ce<ee;++Ce){if((S=te.charCodeAt(Ce))>55295&&S<57344){if(!ce){if(S>56319){(w-=3)>-1&&he.push(239,191,189);continue}if(Ce+1===ee){(w-=3)>-1&&he.push(239,191,189);continue}ce=S;continue}if(S<56320){(w-=3)>-1&&he.push(239,191,189),ce=S;continue}S=65536+(ce-55296<<10|S-56320)}else ce&&(w-=3)>-1&&he.push(239,191,189);if(ce=null,S<128){if((w-=1)<0)break;he.push(S)}else if(S<2048){if((w-=2)<0)break;he.push(S>>6|192,63&S|128)}else if(S<65536){if((w-=3)<0)break;he.push(S>>12|224,S>>6&63|128,63&S|128)}else{if(!(S<1114112))throw new Error("Invalid code point");if((w-=4)<0)break;he.push(S>>18|240,S>>12&63|128,S>>6&63|128,63&S|128)}}return he}function or(te){return C.toByteArray(function(S){if((S=(ce=S,ce.trim?ce.trim():ce.replace(/^\s+|\s+$/g,"")).replace(Vt,"")).length<2)return"";for(var ce;S.length%4!=0;)S+="=";return S}(te))}function Un(te,w,S,ee){for(var ce=0;ce<ee&&!(ce+S>=w.length||ce>=te.length);++ce)w[ce+S]=te[ce];return ce}}).call(this,ne(29))},function(qe,O){var ne;ne=function(){return this}();try{ne=ne||new Function("return this")()}catch(Z){"object"==typeof window&&(ne=window)}qe.exports=ne},function(qe,O,ne){"use strict";O.byteLength=function(V){var oe=v(V),K=oe[1];return 3*(oe[0]+K)/4-K},O.toByteArray=function(V){var oe,J,Be,K=v(V),$=K[0],re=K[1],me=new Q(3*($+(Be=re))/4-Be),se=0,le=re>0?$-4:$;for(J=0;J<le;J+=4)oe=C[V.charCodeAt(J)]<<18|C[V.charCodeAt(J+1)]<<12|C[V.charCodeAt(J+2)]<<6|C[V.charCodeAt(J+3)],me[se++]=oe>>16&255,me[se++]=oe>>8&255,me[se++]=255&oe;return 2===re&&(oe=C[V.charCodeAt(J)]<<2|C[V.charCodeAt(J+1)]>>4,me[se++]=255&oe),1===re&&(oe=C[V.charCodeAt(J)]<<10|C[V.charCodeAt(J+1)]<<4|C[V.charCodeAt(J+2)]>>2,me[se++]=oe>>8&255,me[se++]=255&oe),me},O.fromByteArray=function(V){for(var oe,J=V.length,K=J%3,$=[],me=0,se=J-K;me<se;me+=16383)$.push(T(V,me,me+16383>se?se:me+16383));return 1===K?$.push(Z[(oe=V[J-1])>>2]+Z[oe<<4&63]+"=="):2===K&&$.push(Z[(oe=(V[J-2]<<8)+V[J-1])>>10]+Z[oe>>4&63]+Z[oe<<2&63]+"="),$.join("")};for(var Z=[],C=[],Q="undefined"!=typeof Uint8Array?Uint8Array:Array,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_=0,b=M.length;_<b;++_)Z[_]=M[_],C[M.charCodeAt(_)]=_;function v(G){var V=G.length;if(V%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var oe=G.indexOf("=");return-1===oe&&(oe=V),[oe,oe===V?0:4-oe%4]}function T(G,V,oe){for(var K,$=[],re=V;re<oe;re+=3)$.push(Z[(K=(G[re]<<16&16711680)+(G[re+1]<<8&65280)+(255&G[re+2]))>>18&63]+Z[K>>12&63]+Z[K>>6&63]+Z[63&K]);return $.join("")}C["-".charCodeAt(0)]=62,C["_".charCodeAt(0)]=63},function(qe,O){O.read=function(ne,Z,C,Q,M){var _,b,v=8*M-Q-1,T=(1<<v)-1,G=T>>1,V=-7,oe=C?M-1:0,J=C?-1:1,K=ne[Z+oe];for(oe+=J,_=K&(1<<-V)-1,K>>=-V,V+=v;V>0;_=256*_+ne[Z+oe],oe+=J,V-=8);for(b=_&(1<<-V)-1,_>>=-V,V+=Q;V>0;b=256*b+ne[Z+oe],oe+=J,V-=8);if(0===_)_=1-G;else{if(_===T)return b?NaN:1/0*(K?-1:1);b+=Math.pow(2,Q),_-=G}return(K?-1:1)*b*Math.pow(2,_-Q)},O.write=function(ne,Z,C,Q,M,_){var b,v,T,G=8*_-M-1,V=(1<<G)-1,oe=V>>1,J=23===M?Math.pow(2,-24)-Math.pow(2,-77):0,K=Q?0:_-1,$=Q?1:-1,re=Z<0||0===Z&&1/Z<0?1:0;for(Z=Math.abs(Z),isNaN(Z)||Z===1/0?(v=isNaN(Z)?1:0,b=V):(b=Math.floor(Math.log(Z)/Math.LN2),Z*(T=Math.pow(2,-b))<1&&(b--,T*=2),(Z+=b+oe>=1?J/T:J*Math.pow(2,1-oe))*T>=2&&(b++,T/=2),b+oe>=V?(v=0,b=V):b+oe>=1?(v=(Z*T-1)*Math.pow(2,M),b+=oe):(v=Z*Math.pow(2,oe-1)*Math.pow(2,M),b=0));M>=8;ne[C+K]=255&v,K+=$,v/=256,M-=8);for(b=b<<M|v,G+=M;G>0;ne[C+K]=255&b,K+=$,b/=256,G-=8);ne[C+K-$]|=128*re}},function(qe,O){var ne={}.toString;qe.exports=Array.isArray||function(Z){return"[object Array]"==ne.call(Z)}},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(Q){var M=Q.jws,_=Q.KeyUtil,b=Q.X509,v=Q.crypto,T=Q.hextob64u,G=Q.b64tohex,V=Q.AllowedSigningAlgs;return function(){function oe(){!function(K,$){if(!(K instanceof $))throw new TypeError("Cannot call a class as a function")}(this,oe)}return oe.parseJwt=function(K){Z.Log.debug("JoseUtil.parseJwt");try{var $=M.JWS.parse(K);return{header:$.headerObj,payload:$.payloadObj}}catch(re){Z.Log.error(re)}},oe.validateJwt=function(K,$,re,me,se,le,ie){Z.Log.debug("JoseUtil.validateJwt");try{if("RSA"===$.kty)if($.e&&$.n)$=_.getKey($);else{if(!$.x5c||!$.x5c.length)return Z.Log.error("JoseUtil.validateJwt: RSA key missing key material",$),Promise.reject(new Error("RSA key missing key material"));var Fe=G($.x5c[0]);$=b.getPublicKeyFromCertHex(Fe)}else{if("EC"!==$.kty)return Z.Log.error("JoseUtil.validateJwt: Unsupported key type",$&&$.kty),Promise.reject(new Error($.kty));if(!($.crv&&$.x&&$.y))return Z.Log.error("JoseUtil.validateJwt: EC key missing key material",$),Promise.reject(new Error("EC key missing key material"));$=_.getKey($)}return oe._validateJwt(K,$,re,me,se,le,ie)}catch(Ie){return Z.Log.error(Ie&&Ie.message||Ie),Promise.reject("JWT validation failed")}},oe.validateJwtAttributes=function(K,$,re,me,se,le){me||(me=0),se||(se=parseInt(Date.now()/1e3));var ie=oe.parseJwt(K).payload;if(!ie.iss)return Z.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(ie.iss!==$)return Z.Log.error("JoseUtil._validateJwt: Invalid issuer in token",ie.iss),Promise.reject(new Error("Invalid issuer in token: "+ie.iss));if(!ie.aud)return Z.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(ie.aud===re||Array.isArray(ie.aud)&&ie.aud.indexOf(re)>=0))return Z.Log.error("JoseUtil._validateJwt: Invalid audience in token",ie.aud),Promise.reject(new Error("Invalid audience in token: "+ie.aud));if(ie.azp&&ie.azp!==re)return Z.Log.error("JoseUtil._validateJwt: Invalid azp in token",ie.azp),Promise.reject(new Error("Invalid azp in token: "+ie.azp));if(!le){var Fe=se+me,Ie=se-me;if(!ie.iat)return Z.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(Fe<ie.iat)return Z.Log.error("JoseUtil._validateJwt: iat is in the future",ie.iat),Promise.reject(new Error("iat is in the future: "+ie.iat));if(ie.nbf&&Fe<ie.nbf)return Z.Log.error("JoseUtil._validateJwt: nbf is in the future",ie.nbf),Promise.reject(new Error("nbf is in the future: "+ie.nbf));if(!ie.exp)return Z.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(ie.exp<Ie)return Z.Log.error("JoseUtil._validateJwt: exp is in the past",ie.exp),Promise.reject(new Error("exp is in the past:"+ie.exp))}return Promise.resolve(ie)},oe._validateJwt=function(K,$,re,me,se,le,ie){return oe.validateJwtAttributes(K,re,me,se,le,ie).then(function(Fe){try{return M.JWS.verify(K,$,V)?Fe:(Z.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(Ie){return Z.Log.error(Ie&&Ie.message||Ie),Promise.reject(new Error("signature validation failed"))}})},oe.hashString=function(K,$){try{return v.Util.hashString(K,$)}catch(re){Z.Log.error(re)}},oe.hexToBase64Url=function(K){try{return T(K)}catch($){Z.Log.error($)}},oe}()};var Z=ne(0);qe.exports=O.default},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SigninResponse=void 0;var Z=function(){function M(_,b){for(var v=0;v<b.length;v++){var T=b[v];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(_,T.key,T)}}return function(_,b,v){return b&&M(_.prototype,b),v&&M(_,v),_}}(),C=ne(3);function Q(M,_){if(!(M instanceof _))throw new TypeError("Cannot call a class as a function")}O.SigninResponse=function(){function M(_){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";Q(this,M);var v=C.UrlUtility.parseUrlFragment(_,b);this.error=v.error,this.error_description=v.error_description,this.error_uri=v.error_uri,this.code=v.code,this.state=v.state,this.id_token=v.id_token,this.session_state=v.session_state,this.access_token=v.access_token,this.token_type=v.token_type,this.scope=v.scope,this.profile=void 0,this.expires_in=v.expires_in}return Z(M,[{key:"expires_in",get:function(){if(this.expires_at){var b=parseInt(Date.now()/1e3);return this.expires_at-b}},set:function(b){var v=parseInt(b);if("number"==typeof v&&v>0){var T=parseInt(Date.now()/1e3);this.expires_at=T+v}}},{key:"expired",get:function(){var b=this.expires_in;if(void 0!==b)return b<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),M}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SignoutRequest=void 0;var Z=ne(0),C=ne(3),Q=ne(9);O.SignoutRequest=function M(_){var b=_.url,v=_.id_token_hint,T=_.post_logout_redirect_uri,G=_.data,V=_.extraQueryParams,oe=_.request_type;if(function($,re){if(!($ instanceof re))throw new TypeError("Cannot call a class as a function")}(this,M),!b)throw Z.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var J in v&&(b=C.UrlUtility.addQueryParam(b,"id_token_hint",v)),T&&(b=C.UrlUtility.addQueryParam(b,"post_logout_redirect_uri",T),G&&(this.state=new Q.State({data:G,request_type:oe}),b=C.UrlUtility.addQueryParam(b,"state",this.state.id))),V)b=C.UrlUtility.addQueryParam(b,J,V[J]);this.url=b}},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SignoutResponse=void 0;var Z=ne(3);O.SignoutResponse=function C(Q){!function(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}(this,C);var M=Z.UrlUtility.parseUrlFragment(Q,"?");this.error=M.error,this.error_description=M.error_description,this.error_uri=M.error_uri,this.state=M.state}},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.InMemoryWebStorage=void 0;var Z=function(){function Q(M,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(M,v.key,v)}}return function(M,_,b){return _&&Q(M.prototype,_),b&&Q(M,b),M}}(),C=ne(0);O.InMemoryWebStorage=function(){function Q(){(function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")})(this,Q),this._data={}}return Q.prototype.getItem=function(_){return C.Log.debug("InMemoryWebStorage.getItem",_),this._data[_]},Q.prototype.setItem=function(_,b){C.Log.debug("InMemoryWebStorage.setItem",_),this._data[_]=b},Q.prototype.removeItem=function(_){C.Log.debug("InMemoryWebStorage.removeItem",_),delete this._data[_]},Q.prototype.key=function(_){return Object.getOwnPropertyNames(this._data)[_]},Z(Q,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserManager=void 0;var Z=function(){function re(me,se){for(var le=0;le<se.length;le++){var ie=se[le];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(me,ie.key,ie)}}return function(me,se,le){return se&&re(me.prototype,se),le&&re(me,le),me}}(),C=ne(0),Q=ne(10),M=ne(39),_=ne(15),b=ne(45),v=ne(47),T=ne(18),G=ne(8),V=ne(20),oe=ne(11),J=ne(4);function K(re,me){if(!(re instanceof me))throw new TypeError("Cannot call a class as a function")}function $(re,me){if(!re)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!me||"object"!=typeof me&&"function"!=typeof me?re:me}O.UserManager=function(re){function me(){var se=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},le=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.SilentRenewService,ie=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T.SessionMonitor,Fe=arguments.length>3&&void 0!==arguments[3]?arguments[3]:V.TokenRevocationClient,Ie=arguments.length>4&&void 0!==arguments[4]?arguments[4]:oe.TokenClient,Be=arguments.length>5&&void 0!==arguments[5]?arguments[5]:J.JoseUtil;K(this,me),se instanceof M.UserManagerSettings||(se=new M.UserManagerSettings(se));var ae=$(this,re.call(this,se));return ae._events=new b.UserManagerEvents(se),ae._silentRenewService=new le(ae),ae.settings.automaticSilentRenew&&(C.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),ae.startSilentRenew()),ae.settings.monitorSession&&(C.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),ae._sessionMonitor=new ie(ae)),ae._tokenRevocationClient=new Fe(ae._settings),ae._tokenClient=new Ie(ae._settings),ae._joseUtil=Be,ae}return function(le,ie){if("function"!=typeof ie&&null!==ie)throw new TypeError("Super expression must either be null or a function, not "+typeof ie);le.prototype=Object.create(ie&&ie.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),ie&&(Object.setPrototypeOf?Object.setPrototypeOf(le,ie):le.__proto__=ie)}(me,re),me.prototype.getUser=function(){var le=this;return this._loadUser().then(function(ie){return ie?(C.Log.info("UserManager.getUser: user loaded"),le._events.load(ie,!1),ie):(C.Log.info("UserManager.getUser: user not found in storage"),null)})},me.prototype.removeUser=function(){var le=this;return this.storeUser(null).then(function(){C.Log.info("UserManager.removeUser: user removed from storage"),le._events.unload()})},me.prototype.signinRedirect=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(le=Object.assign({},le)).request_type="si:r",this._signinStart(le,this._redirectNavigator,{useReplaceToNavigate:le.useReplaceToNavigate}).then(function(){C.Log.info("UserManager.signinRedirect: successful")})},me.prototype.signinRedirectCallback=function(le){return this._signinEnd(le||this._redirectNavigator.url).then(function(ie){return ie.profile&&ie.profile.sub?C.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",ie.profile.sub):C.Log.info("UserManager.signinRedirectCallback: no sub"),ie})},me.prototype.signinPopup=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(le=Object.assign({},le)).request_type="si:p";var ie=le.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return ie?(le.redirect_uri=ie,le.display="popup",this._signin(le,this._popupNavigator,{startUrl:ie,popupWindowFeatures:le.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:le.popupWindowTarget||this.settings.popupWindowTarget}).then(function(Fe){return Fe&&(Fe.profile&&Fe.profile.sub?C.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",Fe.profile.sub):C.Log.info("UserManager.signinPopup: no sub")),Fe})):(C.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},me.prototype.signinPopupCallback=function(le){return this._signinCallback(le,this._popupNavigator).then(function(ie){return ie&&(ie.profile&&ie.profile.sub?C.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",ie.profile.sub):C.Log.info("UserManager.signinPopupCallback: no sub")),ie}).catch(function(ie){C.Log.error(ie.message)})},me.prototype.signinSilent=function(){var le=this,ie=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ie=Object.assign({},ie),this._loadUser().then(function(Fe){return Fe&&Fe.refresh_token?(ie.refresh_token=Fe.refresh_token,le._useRefreshToken(ie)):(ie.request_type="si:s",ie.id_token_hint=ie.id_token_hint||le.settings.includeIdTokenInSilentRenew&&Fe&&Fe.id_token,Fe&&le._settings.validateSubOnSilentRenew&&(C.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",Fe.profile.sub),ie.current_sub=Fe.profile.sub),le._signinSilentIframe(ie))})},me.prototype._useRefreshToken=function(){var le=this;return this._tokenClient.exchangeRefreshToken(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).then(function(Fe){return Fe?Fe.access_token?le._loadUser().then(function(Ie){if(Ie){var Be=Promise.resolve();return Fe.id_token&&(Be=le._validateIdTokenFromTokenRefreshToken(Ie.profile,Fe.id_token)),Be.then(function(){return C.Log.debug("UserManager._useRefreshToken: refresh token response success"),Ie.id_token=Fe.id_token||Ie.id_token,Ie.access_token=Fe.access_token,Ie.refresh_token=Fe.refresh_token||Ie.refresh_token,Ie.expires_in=Fe.expires_in,le.storeUser(Ie).then(function(){return le._events.load(Ie),Ie})})}return null}):(C.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(C.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))})},me.prototype._validateIdTokenFromTokenRefreshToken=function(le,ie){var Fe=this;return this._metadataService.getIssuer().then(function(Ie){return Fe.settings.getEpochTime().then(function(Be){return Fe._joseUtil.validateJwtAttributes(ie,Ie,Fe._settings.client_id,Fe._settings.clockSkew,Be).then(function(ae){return ae?ae.sub!==le.sub?(C.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):ae.auth_time&&ae.auth_time!==le.auth_time?(C.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):ae.azp&&ae.azp!==le.azp?(C.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!ae.azp&&le.azp?(C.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(C.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))})})})},me.prototype._signinSilentIframe=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ie=le.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return ie?(le.redirect_uri=ie,le.prompt=le.prompt||"none",this._signin(le,this._iframeNavigator,{startUrl:ie,silentRequestTimeout:le.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(Fe){return Fe&&(Fe.profile&&Fe.profile.sub?C.Log.info("UserManager.signinSilent: successful, signed in sub: ",Fe.profile.sub):C.Log.info("UserManager.signinSilent: no sub")),Fe})):(C.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},me.prototype.signinSilentCallback=function(le){return this._signinCallback(le,this._iframeNavigator).then(function(ie){return ie&&(ie.profile&&ie.profile.sub?C.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",ie.profile.sub):C.Log.info("UserManager.signinSilentCallback: no sub")),ie})},me.prototype.signinCallback=function(le){var ie=this;return this.readSigninResponseState(le).then(function(Fe){var Ie=Fe.state;return"si:r"===Ie.request_type?ie.signinRedirectCallback(le):"si:p"===Ie.request_type?ie.signinPopupCallback(le):"si:s"===Ie.request_type?ie.signinSilentCallback(le):Promise.reject(new Error("invalid response_type in state"))})},me.prototype.signoutCallback=function(le,ie){var Fe=this;return this.readSignoutResponseState(le).then(function(Ie){var Be=Ie.state,ae=Ie.response;return Be?"so:r"===Be.request_type?Fe.signoutRedirectCallback(le):"so:p"===Be.request_type?Fe.signoutPopupCallback(le,ie):Promise.reject(new Error("invalid response_type in state")):ae})},me.prototype.querySessionStatus=function(){var le=this,ie=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(ie=Object.assign({},ie)).request_type="si:s";var Fe=ie.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return Fe?(ie.redirect_uri=Fe,ie.prompt="none",ie.response_type=ie.response_type||this.settings.query_status_response_type,ie.scope=ie.scope||"openid",ie.skipUserInfo=!0,this._signinStart(ie,this._iframeNavigator,{startUrl:Fe,silentRequestTimeout:ie.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(Ie){return le.processSigninResponse(Ie.url).then(function(Be){if(C.Log.debug("UserManager.querySessionStatus: got signin response"),Be.session_state&&Be.profile.sub)return C.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",Be.profile.sub),{session_state:Be.session_state,sub:Be.profile.sub,sid:Be.profile.sid};C.Log.info("querySessionStatus successful, user not authenticated")}).catch(function(Be){if(Be.session_state&&le.settings.monitorAnonymousSession&&("login_required"==Be.message||"consent_required"==Be.message||"interaction_required"==Be.message||"account_selection_required"==Be.message))return C.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:Be.session_state};throw Be})})):(C.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},me.prototype._signin=function(le,ie){var Fe=this;return this._signinStart(le,ie,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).then(function(Be){return Fe._signinEnd(Be.url,le)})},me.prototype._signinStart=function(le,ie){var Fe=this,Ie=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ie.prepare(Ie).then(function(Be){return C.Log.debug("UserManager._signinStart: got navigator window handle"),Fe.createSigninRequest(le).then(function(ae){return C.Log.debug("UserManager._signinStart: got signin request"),Ie.url=ae.url,Ie.id=ae.state.id,Be.navigate(Ie)}).catch(function(ae){throw Be.close&&(C.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),Be.close()),ae})})},me.prototype._signinEnd=function(le){var ie=this,Fe=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processSigninResponse(le).then(function(Ie){C.Log.debug("UserManager._signinEnd: got signin response");var Be=new _.User(Ie);if(Fe.current_sub){if(Fe.current_sub!==Be.profile.sub)return C.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",Be.profile.sub),Promise.reject(new Error("login_required"));C.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return ie.storeUser(Be).then(function(){return C.Log.debug("UserManager._signinEnd: user stored"),ie._events.load(Be),Be})})},me.prototype._signinCallback=function(le,ie){C.Log.debug("UserManager._signinCallback");var Fe="query"===this._settings.response_mode||!this._settings.response_mode&&G.SigninRequest.isCode(this._settings.response_type)?"?":"#";return ie.callback(le,void 0,Fe)},me.prototype.signoutRedirect=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(le=Object.assign({},le)).request_type="so:r";var ie=le.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return ie&&(le.post_logout_redirect_uri=ie),this._signoutStart(le,this._redirectNavigator,{useReplaceToNavigate:le.useReplaceToNavigate}).then(function(){C.Log.info("UserManager.signoutRedirect: successful")})},me.prototype.signoutRedirectCallback=function(le){return this._signoutEnd(le||this._redirectNavigator.url).then(function(ie){return C.Log.info("UserManager.signoutRedirectCallback: successful"),ie})},me.prototype.signoutPopup=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(le=Object.assign({},le)).request_type="so:p";var ie=le.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return le.post_logout_redirect_uri=ie,le.display="popup",le.post_logout_redirect_uri&&(le.state=le.state||{}),this._signout(le,this._popupNavigator,{startUrl:ie,popupWindowFeatures:le.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:le.popupWindowTarget||this.settings.popupWindowTarget}).then(function(){C.Log.info("UserManager.signoutPopup: successful")})},me.prototype.signoutPopupCallback=function(le,ie){return void 0===ie&&"boolean"==typeof le&&(ie=le,le=null),this._popupNavigator.callback(le,ie,"?").then(function(){C.Log.info("UserManager.signoutPopupCallback: successful")})},me.prototype._signout=function(le,ie){var Fe=this;return this._signoutStart(le,ie,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).then(function(Be){return Fe._signoutEnd(Be.url)})},me.prototype._signoutStart=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ie=this,Ie=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return arguments[1].prepare(Ie).then(function(Be){return C.Log.debug("UserManager._signoutStart: got navigator window handle"),ie._loadUser().then(function(ae){return C.Log.debug("UserManager._signoutStart: loaded current user from storage"),(ie._settings.revokeAccessTokenOnSignout?ie._revokeInternal(ae):Promise.resolve()).then(function(){var Ye=le.id_token_hint||ae&&ae.id_token;return Ye&&(C.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),le.id_token_hint=Ye),ie.removeUser().then(function(){return C.Log.debug("UserManager._signoutStart: user removed, creating signout request"),ie.createSignoutRequest(le).then(function(Ot){return C.Log.debug("UserManager._signoutStart: got signout request"),Ie.url=Ot.url,Ot.state&&(Ie.id=Ot.state.id),Be.navigate(Ie)})})})}).catch(function(ae){throw Be.close&&(C.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),Be.close()),ae})})},me.prototype._signoutEnd=function(le){return this.processSignoutResponse(le).then(function(ie){return C.Log.debug("UserManager._signoutEnd: got signout response"),ie})},me.prototype.revokeAccessToken=function(){var le=this;return this._loadUser().then(function(ie){return le._revokeInternal(ie,!0).then(function(Fe){if(Fe)return C.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),ie.access_token=null,ie.refresh_token=null,ie.expires_at=null,ie.token_type=null,le.storeUser(ie).then(function(){C.Log.debug("UserManager.revokeAccessToken: user stored"),le._events.load(ie)})})}).then(function(){C.Log.info("UserManager.revokeAccessToken: access token revoked successfully")})},me.prototype._revokeInternal=function(le,ie){var Fe=this;if(le){var Be=le.refresh_token;return this._revokeAccessTokenInternal(le.access_token,ie).then(function(ae){return Fe._revokeRefreshTokenInternal(Be,ie).then(function(Ye){return ae||Ye||C.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),ae||Ye})})}return Promise.resolve(!1)},me.prototype._revokeAccessTokenInternal=function(le,ie){return!le||le.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(le,ie).then(function(){return!0})},me.prototype._revokeRefreshTokenInternal=function(le,ie){return le?this._tokenRevocationClient.revoke(le,ie,"refresh_token").then(function(){return!0}):Promise.resolve(!1)},me.prototype.startSilentRenew=function(){this._silentRenewService.start()},me.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},me.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then(function(le){return le?(C.Log.debug("UserManager._loadUser: user storageString loaded"),_.User.fromStorageString(le)):(C.Log.debug("UserManager._loadUser: no user storageString"),null)})},me.prototype.storeUser=function(le){if(le){C.Log.debug("UserManager.storeUser: storing user");var ie=le.toStorageString();return this._userStore.set(this._userStoreKey,ie)}return C.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},Z(me,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),me}(Q.OidcClient)},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserManagerSettings=void 0;var Z=function(){function oe(J,K){for(var $=0;$<K.length;$++){var re=K[$];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(J,re.key,re)}}return function(J,K,$){return K&&oe(J.prototype,K),$&&oe(J,$),J}}(),C=(ne(0),ne(5)),Q=ne(40),M=ne(41),_=ne(43),b=ne(6),v=ne(1),T=ne(8);function G(oe,J){if(!(oe instanceof J))throw new TypeError("Cannot call a class as a function")}function V(oe,J){if(!oe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!J||"object"!=typeof J&&"function"!=typeof J?oe:J}O.UserManagerSettings=function(oe){function J(){var K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},$=K.popup_redirect_uri,re=K.popup_post_logout_redirect_uri,me=K.popupWindowFeatures,se=K.popupWindowTarget,le=K.silent_redirect_uri,ie=K.silentRequestTimeout,Fe=K.automaticSilentRenew,Ie=void 0!==Fe&&Fe,Be=K.validateSubOnSilentRenew,ae=void 0!==Be&&Be,Ye=K.includeIdTokenInSilentRenew,Ot=void 0===Ye||Ye,Pt=K.monitorSession,$n=void 0===Pt||Pt,Gt=K.monitorAnonymousSession,_t=void 0!==Gt&&Gt,nn=K.checkSessionInterval,bt=void 0===nn?2e3:nn,wt=K.stopCheckSessionOnError,Yt=void 0===wt||wt,Bt=K.query_status_response_type,Bn=K.revokeAccessTokenOnSignout,qn=void 0!==Bn&&Bn,Mt=K.accessTokenExpiringNotificationTime,Vt=void 0===Mt?60:Mt,ct=K.redirectNavigator,mn=void 0===ct?new Q.RedirectNavigator:ct,or=K.popupNavigator,Un=void 0===or?new M.PopupNavigator:or,te=K.iframeNavigator,w=void 0===te?new _.IFrameNavigator:te,S=K.userStore,ee=void 0===S?new b.WebStorageStateStore({store:v.Global.sessionStorage}):S;G(this,J);var ce=V(this,oe.call(this,arguments[0]));return ce._popup_redirect_uri=$,ce._popup_post_logout_redirect_uri=re,ce._popupWindowFeatures=me,ce._popupWindowTarget=se,ce._silent_redirect_uri=le,ce._silentRequestTimeout=ie,ce._automaticSilentRenew=Ie,ce._validateSubOnSilentRenew=ae,ce._includeIdTokenInSilentRenew=Ot,ce._accessTokenExpiringNotificationTime=Vt,ce._monitorSession=$n,ce._monitorAnonymousSession=_t,ce._checkSessionInterval=bt,ce._stopCheckSessionOnError=Yt,ce._query_status_response_type=Bt||(arguments[0]&&arguments[0].response_type?T.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":"id_token"),ce._revokeAccessTokenOnSignout=qn,ce._redirectNavigator=mn,ce._popupNavigator=Un,ce._iframeNavigator=w,ce._userStore=ee,ce}return function($,re){if("function"!=typeof re&&null!==re)throw new TypeError("Super expression must either be null or a function, not "+typeof re);$.prototype=Object.create(re&&re.prototype,{constructor:{value:$,enumerable:!1,writable:!0,configurable:!0}}),re&&(Object.setPrototypeOf?Object.setPrototypeOf($,re):$.__proto__=re)}(J,oe),Z(J,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),J}(C.OidcClientSettings)},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.RedirectNavigator=void 0;var Z=function(){function Q(M,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(M,v.key,v)}}return function(M,_,b){return _&&Q(M.prototype,_),b&&Q(M,b),M}}(),C=ne(0);O.RedirectNavigator=function(){function Q(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Q)}return Q.prototype.prepare=function(){return Promise.resolve(this)},Q.prototype.navigate=function(_){return _&&_.url?(_.useReplaceToNavigate?window.location.replace(_.url):window.location=_.url,Promise.resolve()):(C.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},Z(Q,[{key:"url",get:function(){return window.location.href}}]),Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.PopupNavigator=void 0;var Z=ne(0),C=ne(42);O.PopupNavigator=function(){function Q(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Q)}return Q.prototype.prepare=function(_){var b=new C.PopupWindow(_);return Promise.resolve(b)},Q.prototype.callback=function(_,b,v){Z.Log.debug("PopupNavigator.callback");try{return C.PopupWindow.notifyOpener(_,b,v),Promise.resolve()}catch(T){return Promise.reject(T)}},Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.PopupWindow=void 0;var Z=function(){function M(_,b){for(var v=0;v<b.length;v++){var T=b[v];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(_,T.key,T)}}return function(_,b,v){return b&&M(_.prototype,b),v&&M(_,v),_}}(),C=ne(0),Q=ne(3);O.PopupWindow=function(){function M(_){var b=this;(function(V,oe){if(!(V instanceof oe))throw new TypeError("Cannot call a class as a function")})(this,M),this._promise=new Promise(function(G,V){b._resolve=G,b._reject=V}),this._popup=window.open("",_.popupWindowTarget||"_blank",_.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;"),this._popup&&(C.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return M.prototype.navigate=function(b){return this._popup?b&&b.url?(C.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=b.id,this._id&&(window["popupCallback_"+b.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=b.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},M.prototype._success=function(b){C.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(b)},M.prototype._error=function(b){C.Log.error("PopupWindow.error: ",b),this._cleanup(),this._reject(new Error(b))},M.prototype.close=function(){this._cleanup(!1)},M.prototype._cleanup=function(b){C.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!b&&this._popup.close(),this._popup=null},M.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},M.prototype._callback=function(b,v){this._cleanup(v),b?(C.Log.debug("PopupWindow.callback success"),this._success({url:b})):(C.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},M.notifyOpener=function(b,v,T){if(window.opener){if(b=b||window.location.href){var G=Q.UrlUtility.parseUrlFragment(b,T);if(G.state){var oe=window.opener["popupCallback_"+G.state];oe?(C.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),oe(b,v)):C.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else C.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else C.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},Z(M,[{key:"promise",get:function(){return this._promise}}]),M}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.IFrameNavigator=void 0;var Z=ne(0),C=ne(44);O.IFrameNavigator=function(){function Q(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Q)}return Q.prototype.prepare=function(_){var b=new C.IFrameWindow(_);return Promise.resolve(b)},Q.prototype.callback=function(_){Z.Log.debug("IFrameNavigator.callback");try{return C.IFrameWindow.notifyParent(_),Promise.resolve()}catch(b){return Promise.reject(b)}},Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.IFrameWindow=void 0;var Z=function(){function Q(M,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(M,v.key,v)}}return function(M,_,b){return _&&Q(M.prototype,_),b&&Q(M,b),M}}(),C=ne(0);O.IFrameWindow=function(){function Q(M){var _=this;(function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")})(this,Q),this._promise=new Promise(function(b,v){_._resolve=b,_._reject=v}),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return Q.prototype.navigate=function(_){if(_&&_.url){var b=_.silentRequestTimeout||1e4;C.Log.debug("IFrameWindow.navigate: Using timeout of:",b),this._timer=window.setTimeout(this._timeout.bind(this),b),this._frame.src=_.url}else this._error("No url provided");return this.promise},Q.prototype._success=function(_){this._cleanup(),C.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(_)},Q.prototype._error=function(_){this._cleanup(),C.Log.error(_),this._reject(new Error(_))},Q.prototype.close=function(){this._cleanup()},Q.prototype._cleanup=function(){this._frame&&(C.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},Q.prototype._timeout=function(){C.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},Q.prototype._message=function(_){if(C.Log.debug("IFrameWindow.message"),this._timer&&_.origin===this._origin&&_.source===this._frame.contentWindow&&"string"==typeof _.data&&(_.data.startsWith("http://")||_.data.startsWith("https://"))){var b=_.data;b?this._success({url:b}):this._error("Invalid response from frame")}},Q.notifyParent=function(_){C.Log.debug("IFrameWindow.notifyParent"),(_=_||window.location.href)&&(C.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(_,location.protocol+"//"+location.host))},Z(Q,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),Q}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserManagerEvents=void 0;var Z=ne(0),C=ne(16),Q=ne(17);O.UserManagerEvents=function(M){function _(b){!function(G,V){if(!(G instanceof V))throw new TypeError("Cannot call a class as a function")}(this,_);var v=function(G,V){if(!G)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!V||"object"!=typeof V&&"function"!=typeof V?G:V}(this,M.call(this,b));return v._userLoaded=new Q.Event("User loaded"),v._userUnloaded=new Q.Event("User unloaded"),v._silentRenewError=new Q.Event("Silent renew error"),v._userSignedIn=new Q.Event("User signed in"),v._userSignedOut=new Q.Event("User signed out"),v._userSessionChanged=new Q.Event("User session changed"),v}return function(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Super expression must either be null or a function, not "+typeof T);v.prototype=Object.create(T&&T.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(v,T):v.__proto__=T)}(_,M),_.prototype.load=function(v){var T=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Z.Log.debug("UserManagerEvents.load"),M.prototype.load.call(this,v),T&&this._userLoaded.raise(v)},_.prototype.unload=function(){Z.Log.debug("UserManagerEvents.unload"),M.prototype.unload.call(this),this._userUnloaded.raise()},_.prototype.addUserLoaded=function(v){this._userLoaded.addHandler(v)},_.prototype.removeUserLoaded=function(v){this._userLoaded.removeHandler(v)},_.prototype.addUserUnloaded=function(v){this._userUnloaded.addHandler(v)},_.prototype.removeUserUnloaded=function(v){this._userUnloaded.removeHandler(v)},_.prototype.addSilentRenewError=function(v){this._silentRenewError.addHandler(v)},_.prototype.removeSilentRenewError=function(v){this._silentRenewError.removeHandler(v)},_.prototype._raiseSilentRenewError=function(v){Z.Log.debug("UserManagerEvents._raiseSilentRenewError",v.message),this._silentRenewError.raise(v)},_.prototype.addUserSignedIn=function(v){this._userSignedIn.addHandler(v)},_.prototype.removeUserSignedIn=function(v){this._userSignedIn.removeHandler(v)},_.prototype._raiseUserSignedIn=function(){Z.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},_.prototype.addUserSignedOut=function(v){this._userSignedOut.addHandler(v)},_.prototype.removeUserSignedOut=function(v){this._userSignedOut.removeHandler(v)},_.prototype._raiseUserSignedOut=function(){Z.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},_.prototype.addUserSessionChanged=function(v){this._userSessionChanged.addHandler(v)},_.prototype.removeUserSessionChanged=function(v){this._userSessionChanged.removeHandler(v)},_.prototype._raiseUserSessionChanged=function(){Z.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},_}(C.AccessTokenEvents)},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Timer=void 0;var Z=function(){function v(T,G){for(var V=0;V<G.length;V++){var oe=G[V];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(T,oe.key,oe)}}return function(T,G,V){return G&&v(T.prototype,G),V&&v(T,V),T}}(),C=ne(0),Q=ne(1),M=ne(17);function _(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}function b(v,T){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!T||"object"!=typeof T&&"function"!=typeof T?v:T}O.Timer=function(v){function T(G){var V=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.Global.timer,oe=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;_(this,T);var J=b(this,v.call(this,G));return J._timer=V,J._nowFunc=oe||function(){return Date.now()/1e3},J}return function(V,oe){if("function"!=typeof oe&&null!==oe)throw new TypeError("Super expression must either be null or a function, not "+typeof oe);V.prototype=Object.create(oe&&oe.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}),oe&&(Object.setPrototypeOf?Object.setPrototypeOf(V,oe):V.__proto__=oe)}(T,v),T.prototype.init=function(V){V<=0&&(V=1),V=parseInt(V);var oe=this.now+V;if(this.expiration===oe&&this._timerHandle)C.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),C.Log.debug("Timer.init timer "+this._name+" for duration:",V),this._expiration=oe;var J=5;V<J&&(J=V),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*J)}},T.prototype.cancel=function(){this._timerHandle&&(C.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},T.prototype._callback=function(){C.Log.debug("Timer.callback; "+this._name+" timer expires in:",this._expiration-this.now),this._expiration<=this.now&&(this.cancel(),v.prototype.raise.call(this))},Z(T,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),T}(M.Event)},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SilentRenewService=void 0;var Z=ne(0);O.SilentRenewService=function(){function C(Q){(function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")})(this,C),this._userManager=Q}return C.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then(function(M){}).catch(function(M){Z.Log.error("SilentRenewService.start: Error from getUser:",M.message)}))},C.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},C.prototype._tokenExpiring=function(){var M=this;this._userManager.signinSilent().then(function(_){Z.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")},function(_){Z.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",_.message),M._userManager.events._raiseSilentRenewError(_)})},C}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CordovaPopupNavigator=void 0;var Z=ne(21);O.CordovaPopupNavigator=function(){function C(){!function(M,_){if(!(M instanceof _))throw new TypeError("Cannot call a class as a function")}(this,C)}return C.prototype.prepare=function(M){var _=new Z.CordovaPopupWindow(M);return Promise.resolve(_)},C}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CordovaIFrameNavigator=void 0;var Z=ne(21);O.CordovaIFrameNavigator=function(){function C(){!function(M,_){if(!(M instanceof _))throw new TypeError("Cannot call a class as a function")}(this,C)}return C.prototype.prepare=function(M){M.popupWindowFeatures="hidden=yes";var _=new Z.CordovaPopupWindow(M);return Promise.resolve(_)},C}()},function(qe,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Version="1.11.5"}])}},ai=>{ai(ai.s=158)}]);