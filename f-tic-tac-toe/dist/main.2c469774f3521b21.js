var dB=Object.defineProperty,hB=(Si,Ge,O)=>Ge in Si?dB(Si,Ge,{enumerable:!0,configurable:!0,writable:!0,value:O}):Si[Ge]=O,R=(Si,Ge,O)=>(hB(Si,"symbol"!=typeof Ge?Ge+"":Ge,O),O);(self.webpackChunktic_tac_toe_v2_front_end=self.webpackChunktic_tac_toe_v2_front_end||[]).push([[179],{784:(Si,Ge,O)=>{"use strict";function ne(t){return"function"==typeof t}function Q(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const x=Q(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function Z(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class k{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const o of n)o.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(ne(r))try{r()}catch(o){e=o instanceof x?o.errors:[o]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const o of i)try{v(o)}catch(s){e=e??[],s instanceof x?e=[...e,...s.errors]:e.push(s)}}if(e)throw new x(e)}}add(e){var n;if(e&&e!==this)if(this.closed)v(e);else{if(e instanceof k){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Z(n,e)}remove(e){const{_teardowns:n}=this;n&&Z(n,e),e instanceof k&&e._removeParent(this)}}k.EMPTY=(()=>{const t=new k;return t.closed=!0,t})();const _=k.EMPTY;function b(t){return t instanceof k||t&&"closed"in t&&ne(t.remove)&&ne(t.add)&&ne(t.unsubscribe)}function v(t){ne(t)?t():t.unsubscribe()}const T={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},z={setTimeout(...t){const{delegate:e}=z;return(e?.setTimeout||setTimeout)(...t)},clearTimeout(t){const{delegate:e}=z;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function U(t){z.setTimeout(()=>{const{onUnhandledError:e}=T;if(!e)throw t;e(t)})}function se(){}const J=re("C",void 0,void 0);function re(t,e,n){return{kind:t,value:e,error:n}}let me=null;function oe(t){if(T.useDeprecatedSynchronousErrorHandling){const e=!me;if(e&&(me={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=me;if(me=null,n)throw r}}else t()}class ie extends k{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,b(e)&&e.add(this)):this.destination=Qe}static create(e,n,r){return new Te(e,n,r)}next(e){this.isStopped?ae(function H(t){return re("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?ae(function G(t){return re("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ae(J,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Te extends ie{constructor(e,n,r){let i;if(super(),ne(e))i=e;else if(e){let o;({next:i,error:n,complete:r}=e),this&&T.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe()):o=e,i=i?.bind(o),n=n?.bind(o),r=r?.bind(o)}this.destination={next:i?Pe(i):se,error:Pe(n??Ue),complete:r?Pe(r):se}}}function Pe(t,e){return(...n)=>{try{t(...n)}catch(r){T.useDeprecatedSynchronousErrorHandling?function le(t){T.useDeprecatedSynchronousErrorHandling&&me&&(me.errorThrown=!0,me.error=t)}(r):U(r)}}}function Ue(t){throw t}function ae(t,e){const{onStoppedNotification:n}=T;n&&z.setTimeout(()=>n(t,e))}const Qe={closed:!0,next:se,error:Ue,complete:se},Ht="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ot(t){return t}function en(t){return 0===t.length?Ot:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}let It=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const o=function xt(t){return t&&t instanceof ie||function Et(t){return t&&ne(t.next)&&ne(t.error)&&ne(t.complete)}(t)&&b(t)}(n)?n:new Te(n,r,i);return oe(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=dn(r))((i,o)=>{let s;s=this.subscribe(a=>{try{n(a)}catch(l){o(l),s?.unsubscribe()}},o,i)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[Ht](){return this}pipe(...n){return en(n)(this)}toPromise(n){return new(n=dn(n))((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return t.create=e=>new t(e),t})();function dn(t){var e;return null!==(e=t??T.Promise)&&void 0!==e?e:Promise}const rn=Q(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let $t=(()=>{class t extends It{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new Kn(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new rn}next(n){oe(()=>{if(this._throwIfClosed(),!this.isStopped){const r=this.observers.slice();for(const i of r)i.next(n)}})}error(n){oe(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){oe(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:o}=this;return r||i?_:(o.push(n),new k(()=>Z(o,n)))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:o}=this;r?n.error(i):o&&n.complete()}asObservable(){const n=new It;return n.source=this,n}}return t.create=(e,n)=>new Kn(e,n),t})();class Kn extends $t{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:_}}function Zn(t){return ne(t?.lift)}function Lt(t){return e=>{if(Zn(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}class qt extends ie{constructor(e,n,r,i,o){super(e),this.onFinalize=o,this._next=n?function(s){try{n(s)}catch(a){e.error(a)}}:super._next,this._error=i?function(s){try{i(s)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(s){e.error(s)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function at(t,e){return Lt((n,r)=>{let i=0;n.subscribe(new qt(r,o=>{r.next(t.call(e,o,i++))}))})}function bn(t){return this instanceof bn?(this.v=t,this):new bn(t)}function Hr(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(C){r[C]&&(i[C]=function(D){return new Promise(function(q,he){o.push([C,D,q,he])>1||a(C,D)})})}function a(C,D){try{!function l(C){C.value instanceof bn?Promise.resolve(C.value.v).then(h,g):m(o[0][2],C)}(r[C](D))}catch(q){m(o[0][3],q)}}function h(C){a("next",C)}function g(C){a("throw",C)}function m(C,D){C(D),o.shift(),o.length&&a(o[0][0],o[0][1])}}function on(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function lt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){!function i(o,s,a,l){Promise.resolve(l).then(function(h){o({value:h,done:a})},s)}(a,l,(s=t[o](s)).done,s.value)})}}}const Le=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function lu(t){return ne(t?.then)}function du(t){return ne(t[Ht])}function fs(t){return Symbol.asyncIterator&&ne(t?.[Symbol.asyncIterator])}function si(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Ro=function Js(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function wn(t){return ne(t?.[Ro])}function Yt(t){return Hr(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield bn(n.read());if(i)return yield bn(void 0);yield yield bn(r)}}finally{n.releaseLock()}})}function Ys(t){return ne(t?.getReader)}function Zt(t){if(t instanceof It)return t;if(null!=t){if(du(t))return function vr(t){return new It(e=>{const n=t[Ht]();if(ne(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Le(t))return function ai(t){return new It(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(lu(t))return function el(t){return new It(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,U)})}(t);if(fs(t))return hu(t);if(wn(t))return function tl(t){return new It(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(Ys(t))return function rr(t){return hu(Yt(t))}(t)}throw si(t)}function hu(t){return new It(e=>{(function ui(t,e){var n,r,i,o;return function ce(t,e,n,r){return new(n||(n=Promise))(function(o,s){function a(g){try{h(r.next(g))}catch(m){s(m)}}function l(g){try{h(r.throw(g))}catch(m){s(m)}}function h(g){g.done?o(g.value):function i(o){return o instanceof n?o:new n(function(s){s(o)})}(g.value).then(a,l)}h((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=on(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function $r(t,e,n,r=0,i=!1){const o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function Sn(t,e,n=1/0){return ne(e)?Sn((r,i)=>at((o,s)=>e(r,o,i,s))(Zt(t(r,i))),n):("number"==typeof e&&(n=e),Lt((r,i)=>function nl(t,e,n,r,i,o,s,a){const l=[];let h=0,g=0,m=!1;const C=()=>{m&&!l.length&&!h&&e.complete()},D=he=>h<r?q(he):l.push(he),q=he=>{o&&e.next(he),h++;let Se=!1;Zt(n(he,g++)).subscribe(new qt(e,xe=>{i?.(xe),o?D(xe):e.next(xe)},()=>{Se=!0},void 0,()=>{if(Se)try{for(h--;l.length&&h<r;){const xe=l.shift();s?$r(e,s,()=>q(xe)):q(xe)}C()}catch(xe){e.error(xe)}}))};return t.subscribe(new qt(e,D,()=>{m=!0,C()})),()=>{a?.()}}(r,i,t,n)))}function Ci(t=1/0){return Sn(Ot,t)}const ci=new It(t=>t.complete());function Qs(t){return t[t.length-1]}function Xs(t){return ne(Qs(t))?t.pop():void 0}function No(t){return function Zs(t){return t&&ne(t.schedule)}(Qs(t))?t.pop():void 0}function rl(t,e=0){return Lt((n,r)=>{n.subscribe(new qt(r,i=>$r(r,t,()=>r.next(i),e),()=>$r(r,t,()=>r.complete(),e),i=>$r(r,t,()=>r.error(i),e)))})}function pu(t,e=0){return Lt((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function sl(t,e){if(!t)throw new Error("Iterable cannot be null");return new It(n=>{$r(n,e,()=>{const r=t[Symbol.asyncIterator]();$r(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function un(t,e){return e?function Qh(t,e){if(null!=t){if(du(t))return function il(t,e){return Zt(t).pipe(pu(e),rl(e))}(t,e);if(Le(t))return function En(t,e){return new It(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(lu(t))return function ol(t,e){return Zt(t).pipe(pu(e),rl(e))}(t,e);if(fs(t))return sl(t,e);if(wn(t))return function Yh(t,e){return new It(n=>{let r;return $r(n,e,()=>{r=t[Ro](),$r(n,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){return void n.error(s)}o?n.complete():n.next(i)},0,!0)}),()=>ne(r?.return)&&r.return()})}(t,e);if(Ys(t))return function Zh(t,e){return sl(Yt(t),e)}(t,e)}throw si(t)}(t,e):Zt(t)}function Oo(t){return t<=0?()=>ci:Lt((e,n)=>{let r=0;e.subscribe(new qt(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function gu(t,e,...n){return!0===e?(t(),null):!1===e?null:e(...n).pipe(Oo(1)).subscribe(()=>t())}function Gt(t){for(let e in t)if(t[e]===Gt)return e;throw Error("Could not find renamed property on target object.")}function c(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function u(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(u).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function d(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const f=Gt({__forward_ref__:Gt});function p(t){return t.__forward_ref__=p,t.toString=function(){return u(this())},t}function y(t){return A(t)?t():t}function A(t){return"function"==typeof t&&t.hasOwnProperty(f)&&t.__forward_ref__===p}class E extends Error{constructor(e,n){super(function L(t,e){return`NG0${Math.abs(t)}${e?": "+e.trim():""}`}(e,n)),this.code=e}}function M(t){return"string"==typeof t?t:null==t?"":String(t)}function _e(t,e){throw new E(-201,!1)}function St(t,e){null==t&&function nt(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function Ve(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Bt(t){return{providers:t.providers||[],imports:t.imports||[]}}function kn(t){return co(t,zi)||co(t,wr)}function co(t,e){return t.hasOwnProperty(e)?t[e]:null}function ea(t){return t&&(t.hasOwnProperty(br)||t.hasOwnProperty(ta))?t[br]:null}const zi=Gt({\u0275prov:Gt}),br=Gt({\u0275inj:Gt}),wr=Gt({ngInjectableDef:Gt}),ta=Gt({ngInjectorDef:Gt});var rt=(()=>((rt=rt||{})[rt.Default=0]="Default",rt[rt.Host=1]="Host",rt[rt.Self=2]="Self",rt[rt.SkipSelf=4]="SkipSelf",rt[rt.Optional=8]="Optional",rt))();let jo;function or(t){const e=jo;return jo=t,e}function Bo(t,e,n){const r=kn(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&rt.Optional?null:void 0!==e?e:void _e(u(t))}function sr(t){return{toString:t}.toString()}var Fn=(()=>((Fn=Fn||{})[Fn.OnPush=0]="OnPush",Fn[Fn.Default=1]="Default",Fn))(),er=(()=>{return(t=er||(er={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",er;var t})();const ht=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Pr={},Nt=[],na=Gt({\u0275cmp:Gt}),ra=Gt({\u0275dir:Gt}),tf=Gt({\u0275pipe:Gt}),Yy=Gt({\u0275mod:Gt}),lo=Gt({\u0275fac:Gt}),mu=Gt({__NG_ELEMENT_ID__:Gt});let _D=0;function xn(t){return sr(()=>{const n=!0===t.standalone,r={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Fn.OnPush,directiveDefs:null,pipeDefs:null,standalone:n,dependencies:n&&t.dependencies||null,getStandaloneInjector:null,selectors:t.selectors||Nt,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||er.Emulated,id:"c"+_D++,styles:t.styles||Nt,_:null,setInput:null,schemas:t.schemas||null,tView:null},o=t.dependencies,s=t.features;return i.inputs=Xy(t.inputs,r),i.outputs=Xy(t.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=o?()=>("function"==typeof o?o():o).map(Zy).filter(Qy):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(Cr).filter(Qy):null,i})}function Zy(t){return zt(t)||Sr(t)}function Qy(t){return null!==t}function qr(t){return sr(()=>({type:t.type,bootstrap:t.bootstrap||Nt,declarations:t.declarations||Nt,imports:t.imports||Nt,exports:t.exports||Nt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Xy(t,e){if(null==t)return Pr;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}const dt=xn;function zt(t){return t[na]||null}function Sr(t){return t[ra]||null}function Cr(t){return t[tf]||null}function Gr(t,e){const n=t[Yy]||null;if(!n&&!0===e)throw new Error(`Type ${u(t)} does not have '\u0275mod' property.`);return n}function Rr(t){return Array.isArray(t)&&"object"==typeof t[1]}function xi(t){return Array.isArray(t)&&!0===t[1]}function sf(t){return 0!=(8&t.flags)}function dl(t){return 2==(2&t.flags)}function hl(t){return 1==(1&t.flags)}function Di(t){return null!==t.template}function xD(t){return 0!=(256&t[2])}function ws(t,e){return t.hasOwnProperty(lo)?t[lo]:null}class ID{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function hi(){return n0}function n0(t){return t.type.prototype.ngOnChanges&&(t.setInput=TD),FD}function FD(){const t=o0(this),e=t?.current;if(e){const n=t.previous;if(n===Pr)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function TD(t,e,n,r){const i=o0(t)||function MD(t,e){return t[r0]=e}(t,{previous:Pr,current:null}),o=i.current||(i.current={}),s=i.previous,a=this.declaredInputs[n],l=s[a];o[a]=new ID(l&&l.currentValue,e,s===Pr),t[r]=e}hi.ngInherit=!0;const r0="__ngSimpleChanges__";function o0(t){return t[r0]||null}function Rn(t){for(;Array.isArray(t);)t=t[0];return t}function fl(t,e){return Rn(e[t])}function Kr(t,e){return Rn(e[t.index])}function df(t,e){return t.data[e]}function Wr(t,e){const n=e[t];return Rr(n)?n:n[0]}function pl(t){return 64==(64&t[2])}function Uo(t,e){return null==e?null:t[e]}function s0(t){t[18]=0}function hf(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const ft={lFrame:m0(null),bindingsEnabled:!0};function u0(){return ft.bindingsEnabled}function Me(){return ft.lFrame.lView}function Pt(){return ft.lFrame.tView}function Ss(t){return ft.lFrame.contextLView=t,t[8]}function Cs(t){return ft.lFrame.contextLView=null,t}function Bn(){let t=c0();for(;null!==t&&64===t.type;)t=t.parent;return t}function c0(){return ft.lFrame.currentTNode}function Wi(t,e){const n=ft.lFrame;n.currentTNode=t,n.isParent=e}function ff(){return ft.lFrame.isParent}function pf(){ft.lFrame.isParent=!1}function ca(){return ft.lFrame.bindingIndex++}function fo(t){const e=ft.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function zD(t,e){const n=ft.lFrame;n.bindingIndex=n.bindingRootIndex=t,gf(e)}function gf(t){ft.lFrame.currentDirectiveIndex=t}function yf(t){ft.lFrame.currentQueryIndex=t}function WD(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function p0(t,e,n){if(n&rt.SkipSelf){let i=e,o=t;for(;!(i=i.parent,null!==i||n&rt.Host||(i=WD(o),null===i||(o=o[15],10&i.type))););if(null===i)return!1;e=i,t=o}const r=ft.lFrame=g0();return r.currentTNode=e,r.lView=t,!0}function vf(t){const e=g0(),n=t[1];ft.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function g0(){const t=ft.lFrame,e=null===t?null:t.child;return null===e?m0(t):e}function m0(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function y0(){const t=ft.lFrame;return ft.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const v0=y0;function _f(){const t=y0();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function xr(){return ft.lFrame.selectedIndex}function Ho(t){ft.lFrame.selectedIndex=t}function gl(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const o=t.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:h,ngOnDestroy:g}=o;s&&(t.contentHooks||(t.contentHooks=[])).push(-n,s),a&&((t.contentHooks||(t.contentHooks=[])).push(n,a),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,a)),l&&(t.viewHooks||(t.viewHooks=[])).push(-n,l),h&&((t.viewHooks||(t.viewHooks=[])).push(n,h),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,h)),null!=g&&(t.destroyHooks||(t.destroyHooks=[])).push(n,g)}}function ml(t,e,n){_0(t,e,3,n)}function yl(t,e,n,r){(3&t[2])===n&&_0(t,e,n,r)}function bf(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function _0(t,e,n,r){const o=r??-1,s=e.length-1;let a=0;for(let l=void 0!==r?65535&t[18]:0;l<s;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=r&&a>=r)break}else e[l]<0&&(t[18]+=65536),(a<o||-1==o)&&(rA(t,n,e,l),t[18]=(4294901760&t[18])+l+2),l++}function rA(t,e,n,r){const i=n[r]<0,o=n[r+1],a=t[i?-n[r]:n[r]];if(i){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class Su{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function vl(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const o=n[r++],s=n[r++],a=n[r++];t.setAttribute(e,s,a,o)}else{const o=i,s=n[++r];w0(o)?t.setProperty(e,o,s):t.setAttribute(e,o,s),r++}}return r}function b0(t){return 3===t||4===t||6===t}function w0(t){return 64===t.charCodeAt(0)}function _l(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||S0(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function S0(t,e,n,r,i){let o=0,s=t.length;if(-1===e)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==s&&(t.splice(s,0,e),o=s+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function C0(t){return-1!==t}function la(t){return 32767&t}function da(t,e){let n=function uA(t){return t>>16}(t),r=e;for(;n>0;)r=r[15],n--;return r}let Sf=!0;function bl(t){const e=Sf;return Sf=t,e}let cA=0;const Ji={};function Eu(t,e){const n=Ef(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Cf(r.data,t),Cf(e,null),Cf(r.blueprint,null));const i=wl(t,e),o=t.injectorIndex;if(C0(i)){const s=la(i),a=da(i,e),l=a[1].data;for(let h=0;h<8;h++)e[o+h]=a[s+h]|l[s+h]}return e[o+8]=i,o}function Cf(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Ef(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function wl(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=P0(i),null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Sl(t,e,n){!function lA(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(mu)&&(r=n[mu]),null==r&&(r=n[mu]=cA++);const i=255&r;e.data[t+(i>>5)]|=1<<i}(t,e,n)}function D0(t,e,n){if(n&rt.Optional||void 0!==t)return t;_e()}function A0(t,e,n,r){if(n&rt.Optional&&void 0===r&&(r=null),0==(n&(rt.Self|rt.Host))){const i=t[9],o=or(void 0);try{return i?i.get(e,r,n&rt.Optional):Bo(e,r,n&rt.Optional)}finally{or(o)}}return D0(r,0,n)}function I0(t,e,n,r=rt.Default,i){if(null!==t){if(1024&e[2]){const s=function gA(t,e,n,r,i){let o=t,s=e;for(;null!==o&&null!==s&&1024&s[2]&&!(256&s[2]);){const a=F0(o,s,n,r|rt.Self,Ji);if(a!==Ji)return a;let l=o.parent;if(!l){const h=s[21];if(h){const g=h.get(n,Ji,r);if(g!==Ji)return g}l=P0(s),s=s[15]}o=l}return i}(t,e,n,r,Ji);if(s!==Ji)return s}const o=F0(t,e,n,r,Ji);if(o!==Ji)return o}return A0(e,n,r,i)}function F0(t,e,n,r,i){const o=function fA(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(mu)?t[mu]:void 0;return"number"==typeof e?e>=0?255&e:pA:e}(n);if("function"==typeof o){if(!p0(e,t,r))return r&rt.Host?D0(i,0,r):A0(e,n,r,i);try{const s=o(r);if(null!=s||r&rt.Optional)return s;_e()}finally{v0()}}else if("number"==typeof o){let s=null,a=Ef(t,e),l=-1,h=r&rt.Host?e[16][6]:null;for((-1===a||r&rt.SkipSelf)&&(l=-1===a?wl(t,e):e[a+8],-1!==l&&M0(r,!1)?(s=e[1],a=la(l),e=da(l,e)):a=-1);-1!==a;){const g=e[1];if(T0(o,a,g.data)){const m=hA(a,e,n,s,r,h);if(m!==Ji)return m}l=e[a+8],-1!==l&&M0(r,e[1].data[a+8]===h)&&T0(o,a,e)?(s=g,a=la(l),e=da(l,e)):a=-1}}return i}function hA(t,e,n,r,i,o){const s=e[1],a=s.data[t+8],g=function Cl(t,e,n,r,i){const o=t.providerIndexes,s=e.data,a=1048575&o,l=t.directiveStart,g=o>>20,C=i?a+g:t.directiveEnd;for(let D=r?a:a+g;D<C;D++){const q=s[D];if(D<l&&n===q||D>=l&&q.type===n)return D}if(i){const D=s[l];if(D&&Di(D)&&D.type===n)return l}return null}(a,s,n,null==r?dl(a)&&Sf:r!=s&&0!=(3&a.type),i&rt.Host&&o===a);return null!==g?xu(e,s,g,a):Ji}function xu(t,e,n,r){let i=t[n];const o=e.data;if(function iA(t){return t instanceof Su}(i)){const s=i;s.resolving&&function X(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new E(-200,`Circular dependency in DI detected for ${t}${n}`)}(function N(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():M(t)}(o[n]));const a=bl(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?or(s.injectImpl):null;p0(t,r,rt.Default);try{i=t[n]=s.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function nA(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){const s=n0(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{null!==l&&or(l),bl(a),s.resolving=!1,v0()}}return i}function T0(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function M0(t,e){return!(t&rt.Self||t&rt.Host&&e)}class ha{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return I0(this._tNode,this._lView,e,r,n)}}function pA(){return new ha(Bn(),Me())}function cr(t){return sr(()=>{const e=t.prototype.constructor,n=e[lo]||xf(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const o=i[lo]||xf(i);if(o&&o!==n)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function xf(t){return A(t)?()=>{const e=xf(y(t));return e&&e()}:ws(t)}function P0(t){const e=t[1],n=e.type;return 2===n?e.declTNode:1===n?t[6]:null}const pa="__parameters__";function ma(t,e,n){return sr(()=>{const r=function Df(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;const s=new i(...o);return a.annotation=s,a;function a(l,h,g){const m=l.hasOwnProperty(pa)?l[pa]:Object.defineProperty(l,pa,{value:[]})[pa];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(s),l}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class ot{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ve({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function po(t,e){t.forEach(n=>Array.isArray(n)?po(n,e):e(n))}function R0(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function El(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Fu(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function Yr(t,e,n){let r=ya(t,e);return r>=0?t[1|r]=n:(r=~r,function _A(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function If(t,e){const n=ya(t,e);if(n>=0)return t[1|n]}function ya(t,e){return function L0(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){const o=r+(i-r>>1),s=t[o<<n];if(e===s)return o<<n;s>e?i=o:r=o+1}return~(i<<n)}(t,e,1)}const Tu={},Tf="__NG_DI_FLAG__",Dl="ngTempTokenPath",AA=/\n/gm,j0="__source";let Mu;function va(t){const e=Mu;return Mu=t,e}function FA(t,e=rt.Default){if(void 0===Mu)throw new E(-203,!1);return null===Mu?Bo(t,void 0,e):Mu.get(t,e&rt.Optional?null:void 0,e)}function Je(t,e=rt.Default){return(function ms(){return jo}()||FA)(y(t),e)}function pn(t,e=rt.Default){return"number"!=typeof e&&(e=0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)),Je(t,e)}function Mf(t){const e=[];for(let n=0;n<t.length;n++){const r=y(t[n]);if(Array.isArray(r)){if(0===r.length)throw new E(900,!1);let i,o=rt.Default;for(let s=0;s<r.length;s++){const a=r[s],l=TA(a);"number"==typeof l?-1===l?i=a.token:o|=l:i=a}e.push(Je(i,o))}else e.push(Je(r))}return e}function Pu(t,e){return t[Tf]=e,t.prototype[Tf]=e,t}function TA(t){return t[Tf]}const ku=Pu(ma("Optional"),8),Ru=Pu(ma("SkipSelf"),4);var Nr=(()=>((Nr=Nr||{})[Nr.Important=1]="Important",Nr[Nr.DashCase=2]="DashCase",Nr))();const Of=new Map;let WA=0;const jf="__ngContext__";function lr(t,e){Rr(e)?(t[jf]=e[20],function YA(t){Of.set(t[20],t)}(e)):t[jf]=e}function Vf(t,e){return undefined(t,e)}function ju(t){const e=t[3];return xi(e)?e[3]:e}function Uf(t){return ov(t[13])}function Hf(t){return ov(t[4])}function ov(t){for(;null!==t&&!xi(t);)t=t[4];return t}function ba(t,e,n,r,i){if(null!=r){let o,s=!1;xi(r)?o=r:Rr(r)&&(s=!0,r=r[0]);const a=Rn(r);0===t&&null!==n?null==i?dv(e,n,a):Es(e,n,a,i||null,!0):1===t&&null!==n?Es(e,n,a,i||null,!0):2===t?function Jf(t,e,n){const r=Fl(t,e);r&&function vI(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,s):3===t&&e.destroyNode(a),null!=o&&function wI(t,e,n,r,i){const o=n[7];o!==Rn(n)&&ba(e,t,r,o,i);for(let a=10;a<n.length;a++){const l=n[a];Bu(l[1],l,t,e,r,o)}}(e,t,o,n,i)}}function qf(t,e,n){return t.createElement(e,n)}function av(t,e){const n=t[9],r=n.indexOf(e),i=e[3];512&e[2]&&(e[2]&=-513,hf(i,-1)),n.splice(r,1)}function Gf(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&av(i,r),e>0&&(t[n-1][4]=r[4]);const o=El(t,10+e);!function lI(t,e){Bu(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const s=o[19];null!==s&&s.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function uv(t,e){if(!(128&e[2])){const n=e[11];n.destroyNode&&Bu(t,e,n,3,null,null),function fI(t){let e=t[13];if(!e)return zf(t[1],t);for(;e;){let n=null;if(Rr(e))n=e[13];else{const r=e[10];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)Rr(e)&&zf(e[1],e),e=e[3];null===e&&(e=t),Rr(e)&&zf(e[1],e),n=e&&e[4]}e=n}}(e)}}function zf(t,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function yI(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Su)){const o=n[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=i[o[s]],l=o[s+1];try{l.call(a)}finally{}}else try{o.call(i)}finally{}}}}(t,e),function mI(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const s=n[o+1],a="function"==typeof s?s(e):Rn(e[s]),l=r[i=n[o+2]],h=n[o+3];"boolean"==typeof h?a.removeEventListener(n[o],l,h):h>=0?r[i=h]():r[i=-h].unsubscribe(),o+=2}else{const s=r[i=n[o+1]];n[o].call(s)}if(null!==r){for(let o=i+1;o<r.length;o++)(0,r[o])();e[7]=null}}(t,e),1===e[1].type&&e[11].destroy();const n=e[17];if(null!==n&&xi(e[3])){n!==e[3]&&av(n,e);const r=e[19];null!==r&&r.detachView(t)}!function ZA(t){Of.delete(t[20])}(e)}}function cv(t,e,n){return function lv(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const i=t.data[r.directiveStart].encapsulation;if(i===er.None||i===er.Emulated)return null}return Kr(r,n)}(t,e.parent,n)}function Es(t,e,n,r,i){t.insertBefore(e,n,r,i)}function dv(t,e,n){t.appendChild(e,n)}function hv(t,e,n,r,i){null!==r?Es(t,e,n,r,i):dv(t,e,n)}function Fl(t,e){return t.parentNode(e)}function fv(t,e,n){return gv(t,e,n)}let Xf,gv=function pv(t,e,n){return 40&t.type?Kr(t,n):null};function Tl(t,e,n,r){const i=cv(t,r,e),o=e[11],a=fv(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(n))for(let l=0;l<n.length;l++)hv(o,i,n[l],a,!1);else hv(o,i,n,a,!1)}function Ml(t,e){if(null!==e){const n=e.type;if(3&n)return Kr(e,t);if(4&n)return Wf(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return Ml(t,r);{const i=t[e.index];return xi(i)?Wf(-1,i):Rn(i)}}if(32&n)return Vf(e,t)()||Rn(t[e.index]);{const r=yv(t,e);return null!==r?Array.isArray(r)?r[0]:Ml(ju(t[16]),r):Ml(t,e.next)}}return null}function yv(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Wf(t,e){const n=10+t+1;if(n<e.length){const r=e[n],i=r[1].firstChild;if(null!==i)return Ml(r,i)}return e[7]}function Yf(t,e,n,r,i,o,s){for(;null!=n;){const a=r[n.index],l=n.type;if(s&&0===e&&(a&&lr(Rn(a),r),n.flags|=4),64!=(64&n.flags))if(8&l)Yf(t,e,n.child,r,i,o,!1),ba(e,t,i,a,o);else if(32&l){const h=Vf(n,r);let g;for(;g=h();)ba(e,t,i,g,o);ba(e,t,i,a,o)}else 16&l?vv(t,e,r,n,i,o):ba(e,t,i,a,o);n=s?n.projectionNext:n.next}}function Bu(t,e,n,r,i,o){Yf(n,r,t.firstChild,e,i,o,!1)}function vv(t,e,n,r,i,o){const s=n[16],l=s[6].projection[r.projection];if(Array.isArray(l))for(let h=0;h<l.length;h++)ba(e,t,i,l[h],o);else Yf(t,e,l,s[3],i,o,!0)}function _v(t,e,n){t.setAttribute(e,"style",n)}function Zf(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function qo(t){return t instanceof class Ev{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?t.changingThisBreaksApplicationSecurity:t}const sp=new ot("ENVIRONMENT_INITIALIZER"),Pv=new ot("INJECTOR",-1),kv=new ot("INJECTOR_DEF_TYPES");class Rv{get(e,n=Tu){if(n===Tu){const r=new Error(`NullInjectorError: No provider for ${u(e)}!`);throw r.name="NullInjectorError",r}return n}}function YI(...t){return{\u0275providers:Nv(0,t)}}function Nv(t,...e){const n=[],r=new Set;let i;return po(e,o=>{const s=o;ap(s,n,[],r)&&(i||(i=[]),i.push(s))}),void 0!==i&&Ov(i,n),n}function Ov(t,e){for(let n=0;n<t.length;n++){const{providers:i}=t[n];po(i,o=>{e.push(o)})}}function ap(t,e,n,r){if(!(t=y(t)))return!1;let i=null,o=ea(t);const s=!o&&zt(t);if(o||s){if(s&&!s.standalone)return!1;i=t}else{const l=t.ngModule;if(o=ea(l),!o)return!1;i=l}const a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){const l="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const h of l)ap(h,e,n,r)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let h;r.add(i);try{po(o.imports,g=>{ap(g,e,n,r)&&(h||(h=[]),h.push(g))})}finally{}void 0!==h&&Ov(h,e)}if(!a){const h=ws(i)||(()=>new i);e.push({provide:i,useFactory:h,deps:Nt},{provide:kv,useValue:i,multi:!0},{provide:sp,useValue:()=>Je(i),multi:!0})}const l=o.providers;null==l||a||po(l,g=>{e.push(g)})}}return i!==t&&void 0!==t.providers}const ZI=Gt({provide:String,useValue:Gt});function up(t){return null!==t&&"object"==typeof t&&ZI in t}function Ds(t){return"function"==typeof t}const cp=new ot("Set Injector scope."),Nl={},XI={};let lp;function Ol(){return void 0===lp&&(lp=new Rv),lp}class Go{}class Bv extends Go{constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,hp(e,s=>this.processProvider(s)),this.records.set(Pv,wa(void 0,this)),i.has("environment")&&this.records.set(Go,wa(void 0,this));const o=this.records.get(cp);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(kv.multi,Nt,rt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const n=va(this),r=or(void 0);try{return e()}finally{va(n),or(r)}}get(e,n=Tu,r=rt.Default){this.assertNotDestroyed();const i=va(this),o=or(void 0);try{if(!(r&rt.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function iF(t){return"function"==typeof t||"object"==typeof t&&t instanceof ot}(e)&&kn(e);a=l&&this.injectableDefInScope(l)?wa(dp(e),Nl):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(r&rt.Self?Ol():this.parent).get(e,n=r&rt.Optional&&n===Tu?null:n)}catch(s){if("NullInjectorError"===s.name){if((s[Dl]=s[Dl]||[]).unshift(u(e)),i)throw s;return function MA(t,e,n,r){const i=t[Dl];throw e[j0]&&i.unshift(e[j0]),t.message=function PA(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=u(e);if(Array.isArray(e))i=e.map(u).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):u(a)))}i=`{${o.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(AA,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[Dl]=null,t}(s,e,"R3InjectorError",this.source)}throw s}finally{or(o),va(i)}}resolveInjectorInitializers(){const e=va(this),n=or(void 0);try{const r=this.get(sp.multi,Nt,rt.Self);for(const i of r)i()}finally{va(e),or(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(u(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new E(205,!1)}processProvider(e){let n=Ds(e=y(e))?e:y(e&&e.provide);const r=function tF(t){return up(t)?wa(void 0,t.useValue):wa(Vv(t),Nl)}(e);if(Ds(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=wa(void 0,Nl,!0),i.factory=()=>Mf(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===Nl&&(n.value=XI,n.value=n.factory()),"object"==typeof n.value&&n.value&&function rF(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=y(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}}function dp(t){const e=kn(t),n=null!==e?e.factory:ws(t);if(null!==n)return n;if(t instanceof ot)throw new E(204,!1);if(t instanceof Function)return function eF(t){const e=t.length;if(e>0)throw Fu(e,"?"),new E(204,!1);const n=function gs(t){const e=t&&(t[zi]||t[wr]);if(e){const n=function Lo(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new E(204,!1)}function Vv(t,e,n){let r;if(Ds(t)){const i=y(t);return ws(i)||dp(i)}if(up(t))r=()=>y(t.useValue);else if(function jv(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Mf(t.deps||[]));else if(function Lv(t){return!(!t||!t.useExisting)}(t))r=()=>Je(y(t.useExisting));else{const i=y(t&&(t.useClass||t.provide));if(!function nF(t){return!!t.deps}(t))return ws(i)||dp(i);r=()=>new i(...Mf(t.deps))}return r}function wa(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function oF(t){return!!t.\u0275providers}function hp(t,e){for(const n of t)Array.isArray(n)?hp(n,e):oF(n)?hp(n.\u0275providers,e):e(n)}class Uv{}class uF{resolveComponentFactory(e){throw function aF(t){const e=Error(`No component factory found for ${u(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(e)}}let $u=(()=>{class t{}return t.NULL=new uF,t})();function cF(){return Sa(Bn(),Me())}function Sa(t,e){return new Zr(Kr(t,e))}let Zr=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=cF,t})();class $v{}let mo=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function dF(){const t=Me(),n=Wr(Bn().index,t);return(Rr(n)?n:t)[11]}(),t})(),hF=(()=>{class t{}return t.\u0275prov=Ve({token:t,providedIn:"root",factory:()=>null}),t})();class qu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const fF=new qu("14.3.0"),fp={};function gp(t){return t.ngOriginalError}class Ca{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&gp(e);for(;n&&gp(n);)n=gp(n);return n||null}}function yo(t){return t instanceof Function?t():t}function Gv(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const o=e.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}n=i+1}}const zv="ng-template";function EF(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==Gv(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function Kv(t){return 4===t.type&&t.value!==zv}function xF(t,e,n){return e===(4!==t.type||n?t.value:zv)}function DF(t,e,n){let r=4;const i=t.attrs||[],o=function FF(t){for(let e=0;e<t.length;e++)if(b0(t[e]))return e;return t.length}(i);let s=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!s)if(4&r){if(r=2|1&r,""!==l&&!xF(t,l,n)||""===l&&1===e.length){if(Ai(r))return!1;s=!0}}else{const h=8&r?l:e[++a];if(8&r&&null!==t.attrs){if(!EF(t.attrs,h,n)){if(Ai(r))return!1;s=!0}continue}const m=AF(8&r?"class":l,i,Kv(t),n);if(-1===m){if(Ai(r))return!1;s=!0;continue}if(""!==h){let C;C=m>o?"":i[m+1].toLowerCase();const D=8&r?C:null;if(D&&-1!==Gv(D,h,0)||2&r&&h!==C){if(Ai(r))return!1;s=!0}}}}else{if(!s&&!Ai(r)&&!Ai(l))return!1;if(s&&Ai(l))continue;s=!1,r=l|1&r}}return Ai(r)||s}function Ai(t){return 0==(1&t)}function AF(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let o=!1;for(;i<e.length;){const s=e[i];if(s===t)return i;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===s)break;if(0===s){i+=4;continue}}i+=o?1:2}return-1}return function TF(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function Wv(t,e,n=!1){for(let r=0;r<e.length;r++)if(DF(t,e[r],n))return!0;return!1}function MF(t,e){e:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let i=0;i<t.length;i++)if(t[i]!==r[i])continue e;return!0}}return!1}function Jv(t,e){return t?":not("+e.trim()+")":e}function PF(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let s=t[n];if("string"==typeof s)if(2&r){const a=t[++n];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""!==i&&!Ai(s)&&(e+=Jv(o,i),i=""),r=s,o=o||!Ai(r);n++}return""!==i&&(e+=Jv(o,i)),e}const pt={};function kt(t){Yv(Pt(),Me(),xr()+t,!1)}function Yv(t,e,n,r){if(!r)if(3==(3&e[2])){const o=t.preOrderCheckHooks;null!==o&&ml(e,o,n)}else{const o=t.preOrderHooks;null!==o&&yl(e,o,0,n)}Ho(n)}function e_(t,e=null,n=null,r){const i=t_(t,e,n,r);return i.resolveInjectorInitializers(),i}function t_(t,e=null,n=null,r,i=new Set){const o=[n||Nt,YI(t)];return r=r||("object"==typeof t?void 0:u(t)),new Bv(o,e||Ol(),r||null,i)}let Qr=(()=>{class t{static create(n,r){if(Array.isArray(n))return e_({name:""},r,n,"");{const i=n.name??"";return e_({name:i},n.parent,n.providers,i)}}}return t.THROW_IF_NOT_FOUND=Tu,t.NULL=new Rv,t.\u0275prov=Ve({token:t,providedIn:"any",factory:()=>Je(Pv)}),t.__NG_ELEMENT_ID__=-1,t})();function De(t,e=rt.Default){const n=Me();return null===n?Je(t,e):I0(Bn(),n,y(t),e)}function bp(){throw new Error("invalid")}function jl(t,e){return t<<17|e<<2}function Ii(t){return t>>17&32767}function wp(t){return 2|t}function vo(t){return(131068&t)>>2}function Sp(t,e){return-131069&t|e<<2}function Cp(t){return 1|t}function v_(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const s=t.data[o];yf(i),s.contentQueries(2,e[o],o)}}}function Ul(t,e,n,r,i,o,s,a,l,h,g){const m=e.blueprint.slice();return m[0]=i,m[2]=76|r,(null!==g||t&&1024&t[2])&&(m[2]|=1024),s0(m),m[3]=m[15]=t,m[8]=n,m[10]=s||t&&t[10],m[11]=a||t&&t[11],m[12]=l||t&&t[12]||null,m[9]=h||t&&t[9]||null,m[6]=o,m[20]=function JA(){return WA++}(),m[21]=g,m[16]=2==e.type?t[16]:m,m}function Da(t,e,n,r,i){let o=t.data[e];if(null===o)o=function Mp(t,e,n,r,i){const o=c0(),s=ff(),l=t.data[e]=function pT(t,e,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=l),null!==o&&(s?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l)),l}(t,e,n,r,i),function GD(){return ft.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const s=function wu(){const t=ft.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return Wi(o,!0),o}function Aa(t,e,n,r){if(0===n)return-1;const i=e.length;for(let o=0;o<n;o++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Pp(t,e,n){vf(e);try{const r=t.viewQuery;null!==r&&Vp(1,r,n);const i=t.template;null!==i&&__(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&v_(t,e),t.staticViewQueries&&Vp(2,t.viewQuery,n);const o=t.components;null!==o&&function dT(t,e){for(let n=0;n<e.length;n++)TT(t,e[n])}(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,_f()}}function Hl(t,e,n,r){const i=e[2];if(128!=(128&i)){vf(e);try{s0(e),function d0(t){return ft.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&__(t,e,n,2,r);const s=3==(3&i);if(s){const h=t.preOrderCheckHooks;null!==h&&ml(e,h,null)}else{const h=t.preOrderHooks;null!==h&&yl(e,h,0,null),bf(e,0)}if(function IT(t){for(let e=Uf(t);null!==e;e=Hf(e)){if(!e[2])continue;const n=e[9];for(let r=0;r<n.length;r++){const i=n[r],o=i[3];0==(512&i[2])&&hf(o,1),i[2]|=512}}}(e),function AT(t){for(let e=Uf(t);null!==e;e=Hf(e))for(let n=10;n<e.length;n++){const r=e[n],i=r[1];pl(r)&&Hl(i,r,i.template,r[8])}}(e),null!==t.contentQueries&&v_(t,e),s){const h=t.contentCheckHooks;null!==h&&ml(e,h)}else{const h=t.contentHooks;null!==h&&yl(e,h,1),bf(e,1)}!function cT(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)Ho(~i);else{const o=i,s=n[++r],a=n[++r];zD(s,o),a(2,e[o])}}}finally{Ho(-1)}}(t,e);const a=t.components;null!==a&&function lT(t,e){for(let n=0;n<e.length;n++)FT(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&Vp(2,l,r),s){const h=t.viewCheckHooks;null!==h&&ml(e,h)}else{const h=t.viewHooks;null!==h&&yl(e,h,2),bf(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,hf(e[3],-1))}finally{_f()}}}function __(t,e,n,r,i){const o=xr(),s=2&r;try{Ho(-1),s&&e.length>22&&Yv(t,e,22,!1),n(r,i)}finally{Ho(o)}}function b_(t,e,n){if(sf(e)){const i=e.directiveEnd;for(let o=e.directiveStart;o<i;o++){const s=t.data[o];s.contentQueries&&s.contentQueries(1,n[o],o)}}}function kp(t,e,n){!u0()||(function _T(t,e,n,r){const i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||Eu(n,e),lr(r,e);const s=n.initialInputs;for(let a=i;a<o;a++){const l=t.data[a],h=Di(l);h&&ET(e,n,l);const g=xu(e,t,a,n);lr(g,e),null!==s&&xT(0,a-i,g,l,0,s),h&&(Wr(n.index,e)[8]=g)}}(t,e,n,Kr(n,e)),128==(128&n.flags)&&function bT(t,e,n){const r=n.directiveStart,i=n.directiveEnd,o=n.index,s=function KD(){return ft.lFrame.currentDirectiveIndex}();try{Ho(o);for(let a=r;a<i;a++){const l=t.data[a],h=e[a];gf(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&A_(l,h)}}finally{Ho(-1),gf(s)}}(t,e,n))}function Rp(t,e,n=Kr){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],a=-1===s?n(e,t):t[s];t[i++]=a}}}function w_(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Np(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Np(t,e,n,r,i,o,s,a,l,h){const g=22+r,m=g+i,C=function hT(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:pt);return n}(g,m),D="function"==typeof h?h():h;return C[1]={type:t,blueprint:C,template:n,queries:null,viewQuery:a,declTNode:e,data:C.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:D,incompleteFirstPass:!1}}function C_(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function E_(t,e){const r=e.directiveEnd,i=t.data,o=e.attrs,s=[];let a=null,l=null;for(let h=e.directiveStart;h<r;h++){const g=i[h],m=g.inputs,C=null===o||Kv(e)?null:DT(m,o);s.push(C),a=C_(m,h,a),l=C_(g.outputs,h,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=a,e.outputs=l}function x_(t,e){const n=Wr(e,t);16&n[2]||(n[2]|=32)}function Op(t,e,n,r){let i=!1;if(u0()){const o=function wT(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];Wv(n,s.selectors,!1)&&(i||(i=[]),Sl(Eu(n,e),t,s.type),Di(s)?(I_(t,n),i.unshift(s)):i.push(s))}return i}(t,e,n),s=null===r?null:{"":-1};if(null!==o){i=!0,F_(n,t.data.length,o.length);for(let g=0;g<o.length;g++){const m=o[g];m.providersResolver&&m.providersResolver(m)}let a=!1,l=!1,h=Aa(t,e,o.length,null);for(let g=0;g<o.length;g++){const m=o[g];n.mergedAttrs=_l(n.mergedAttrs,m.hostAttrs),T_(t,n,e,h,m),CT(h,m,s),null!==m.contentQueries&&(n.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(n.flags|=128);const C=m.type.prototype;!a&&(C.ngOnChanges||C.ngOnInit||C.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),a=!0),!l&&(C.ngOnChanges||C.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),l=!0),h++}E_(t,n)}s&&function ST(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const o=n[e[i+1]];if(null==o)throw new E(-301,!1);r.push(e[i],o)}}}(n,r,s)}return n.mergedAttrs=_l(n.mergedAttrs,n.attrs),i}function D_(t,e,n,r,i,o){const s=o.hostBindings;if(s){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const l=~e.index;(function vT(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(a)!=l&&a.push(l),a.push(r,i,s)}}function A_(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function I_(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function CT(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Di(e)&&(n[""]=t)}}function F_(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function T_(t,e,n,r,i){t.data[r]=i;const o=i.factory||(i.factory=ws(i.type)),s=new Su(o,Di(i),De);t.blueprint[r]=s,n[r]=s,D_(t,e,0,r,Aa(t,n,i.hostVars,pt),i)}function ET(t,e,n){const r=Kr(e,t),i=w_(n),o=t[10],s=$l(t,Ul(t,i,null,n.onPush?32:16,r,e,o,o.createRenderer(r,n),null,null,null));t[e.index]=s}function xT(t,e,n,r,i,o){const s=o[e];if(null!==s){const a=r.setInput;for(let l=0;l<s.length;){const h=s[l++],g=s[l++],m=s[l++];null!==a?r.setInput(n,m,h,g):n[g]=m}}}function DT(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function M_(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function FT(t,e){const n=Wr(e,t);if(pl(n)){const r=n[1];48&n[2]?Hl(r,n,r.template,n[8]):n[5]>0&&jp(n)}}function jp(t){for(let r=Uf(t);null!==r;r=Hf(r))for(let i=10;i<r.length;i++){const o=r[i];if(pl(o))if(512&o[2]){const s=o[1];Hl(s,o,s.template,o[8])}else o[5]>0&&jp(o)}const n=t[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=Wr(n[r],t);pl(i)&&i[5]>0&&jp(i)}}function TT(t,e){const n=Wr(e,t),r=n[1];(function MT(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(r,n),Pp(r,n,n[8])}function $l(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Bp(t){for(;t;){t[2]|=32;const e=ju(t);if(xD(t)&&!e)return t;t=e}return null}function ql(t,e,n,r=!0){const i=e[10];i.begin&&i.begin();try{Hl(t,e,t.template,n)}catch(s){throw r&&N_(e,s),s}finally{i.end&&i.end()}}function Vp(t,e,n){yf(0),e(t,n)}function P_(t){return t[7]||(t[7]=[])}function k_(t){return t.cleanup||(t.cleanup=[])}function N_(t,e){const n=t[9],r=n?n.get(Ca,null):null;r&&r.handleError(e)}function Up(t,e,n,r,i){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],l=e[s],h=t.data[s];null!==h.setInput?h.setInput(l,i,r,a):l[a]=i}}function Gl(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?o=a:1==o?i=d(i,a):2==o&&(r=d(r,a+": "+e[++s]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}function zl(t,e,n,r,i=!1){for(;null!==n;){const o=e[n.index];if(null!==o&&r.push(Rn(o)),xi(o))for(let a=10;a<o.length;a++){const l=o[a],h=l[1].firstChild;null!==h&&zl(l[1],l,h,r)}const s=n.type;if(8&s)zl(t,e,n.child,r);else if(32&s){const a=Vf(n,e);let l;for(;l=a();)r.push(l)}else if(16&s){const a=yv(e,n);if(Array.isArray(a))r.push(...a);else{const l=ju(e[16]);zl(l[1],l,a,r,!0)}}n=i?n.projectionNext:n.next}return r}class Gu{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return zl(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(xi(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(Gf(e,r),El(n,r))}this._attachedToViewContainer=!1}uv(this._lView[1],this._lView)}onDestroy(e){!function S_(t,e,n,r){const i=P_(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&k_(t).push(r,i.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){Bp(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){ql(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new E(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function hI(t,e){Bu(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new E(902,!1);this._appRef=e}}class PT extends Gu{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;ql(e[1],e,e[8],!1)}checkNoChanges(){}get context(){return null}}class Hp extends $u{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=zt(e);return new zu(n,this.ngModule)}}function O_(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class RT{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){const i=this.injector.get(e,fp,r);return i!==fp||n===fp?i:this.parentInjector.get(e,n,r)}}class zu extends Uv{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function kF(t){return t.map(PF).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return O_(this.componentDef.inputs)}get outputs(){return O_(this.componentDef.outputs)}create(e,n,r,i){let o=(i=i||this.ngModule)instanceof Go?i:i?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new RT(e,o):e,a=s.get($v,null);if(null===a)throw new E(407,!1);const l=s.get(hF,null),h=a.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=r?function fT(t,e,n){return t.selectRootElement(e,n===er.ShadowDom)}(h,r,this.componentDef.encapsulation):qf(h,g,function kT(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(g)),C=this.componentDef.onPush?288:272,D=Np(0,null,null,1,0,null,null,null,null,null),q=Ul(null,D,null,C,null,null,a,h,l,s,null);let he,Se;vf(q);try{const xe=function LT(t,e,n,r,i,o){const s=n[1];n[22]=t;const l=Da(s,22,2,"#host",null),h=l.mergedAttrs=e.hostAttrs;null!==h&&(Gl(l,h,!0),null!==t&&(vl(i,t,h),null!==l.classes&&Zf(i,t,l.classes),null!==l.styles&&_v(i,t,l.styles)));const g=r.createRenderer(t,e),m=Ul(n,w_(e),null,e.onPush?32:16,n[22],l,r,g,o||null,null,null);return s.firstCreatePass&&(Sl(Eu(l,n),s,e.type),I_(s,l),F_(l,n.length,1)),$l(n,m),n[22]=m}(m,this.componentDef,q,a,h);if(m)if(r)vl(h,m,["ng-version",fF.full]);else{const{attrs:Fe,classes:Ce}=function RF(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!Ai(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);Fe&&vl(h,m,Fe),Ce&&Ce.length>0&&Zf(h,m,Ce.join(" "))}if(Se=df(D,22),void 0!==n){const Fe=Se.projection=[];for(let Ce=0;Ce<this.ngContentSelectors.length;Ce++){const We=n[Ce];Fe.push(null!=We?Array.from(We):null)}}he=function jT(t,e,n,r){const i=n[1],o=function yT(t,e,n){const r=Bn();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),T_(t,r,e,Aa(t,e,1,null),n),E_(t,r));const i=xu(e,t,r.directiveStart,r);lr(i,e);const o=Kr(r,e);return o&&lr(o,e),i}(i,n,e);if(t[8]=n[8]=o,null!==r)for(const a of r)a(o,e);if(e.contentQueries){const a=Bn();e.contentQueries(1,o,a.directiveStart)}const s=Bn();return!i.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Ho(s.index),D_(n[1],s,0,s.directiveStart,s.directiveEnd,e),A_(e,o)),o}(xe,this.componentDef,q,[BT]),Pp(D,q,null)}finally{_f()}return new OT(this.componentType,he,Sa(Se,q),q,Se)}}class OT extends class sF{}{constructor(e,n,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=n,this.hostView=this.changeDetectorRef=new PT(i),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){const o=this._rootLView;Up(o[1],o,i,e,n),x_(o,this._tNode.index)}}get injector(){return new ha(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function BT(){const t=Bn();gl(Me()[1],t)}function Kt(t){let e=function L_(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const r=[t];for(;e;){let i;if(Di(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new E(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);const s=t;s.inputs=$p(t.inputs),s.declaredInputs=$p(t.declaredInputs),s.outputs=$p(t.outputs);const a=i.hostBindings;a&&$T(t,a);const l=i.viewQuery,h=i.contentQueries;if(l&&UT(t,l),h&&HT(t,h),c(t.inputs,i.inputs),c(t.declaredInputs,i.declaredInputs),c(t.outputs,i.outputs),Di(i)&&i.data.animation){const g=t.data;g.animation=(g.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===Kt&&(n=!1)}}e=Object.getPrototypeOf(e)}!function VT(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=_l(i.hostAttrs,n=_l(n,i.hostAttrs))}}(r)}function $p(t){return t===Pr?{}:t===Nt?[]:t}function UT(t,e){const n=t.viewQuery;t.viewQuery=n?(r,i)=>{e(r,i),n(r,i)}:e}function HT(t,e){const n=t.contentQueries;t.contentQueries=n?(r,i,o)=>{e(r,i,o),n(r,i,o)}:e}function $T(t,e){const n=t.hostBindings;t.hostBindings=n?(r,i)=>{e(r,i),n(r,i)}:e}let Kl=null;function As(){if(!Kl){const t=ht.Symbol;if(t&&t.iterator)Kl=t.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<e.length;++n){const r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Kl=r)}}}return Kl}function Ku(t){return!!function qp(t){return null!==t&&("function"==typeof t||"object"==typeof t)}(t)&&(Array.isArray(t)||!(t instanceof Map)&&As()in t)}function dr(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function gi(t,e,n,r,i,o,s,a){const l=Me(),h=Pt(),g=t+22,m=h.firstCreatePass?function ZT(t,e,n,r,i,o,s,a,l){const h=e.consts,g=Da(e,t,4,s||null,Uo(h,a));Op(e,n,g,Uo(h,l)),gl(e,g);const m=g.tViews=Np(2,g,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,h);return null!==e.queries&&(e.queries.template(e,g),m.queries=e.queries.embeddedTView(g)),g}(g,h,l,e,n,r,i,o,s):h.data[g];Wi(m,!1);const C=l[11].createComment("");Tl(h,l,C,m),lr(C,l),$l(l,l[g]=M_(C,l,C,m)),hl(m)&&kp(h,l,m),null!=s&&Rp(l,m,a)}function an(t,e,n){const r=Me();return dr(r,ca(),e)&&function Xr(t,e,n,r,i,o,s,a){const l=Kr(e,n);let g,h=e.inputs;!a&&null!=h&&(g=h[r])?(Up(t,n,g,r,i),dl(e)&&x_(n,e.index)):3&e.type&&(r=function gT(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=s?s(i,e.value||"",r):i,o.setProperty(l,r,i))}(Pt(),function fn(){const t=ft.lFrame;return df(t.tView,t.selectedIndex)}(),r,t,e,r[11],n,!1),an}function Gp(t,e,n,r,i){const s=i?"class":"style";Up(t,n,e.inputs[s],s,r)}function tt(t,e,n,r){const i=Me(),o=Pt(),s=22+t,a=i[11],l=i[s]=qf(a,e,function tA(){return ft.lFrame.currentNamespace}()),h=o.firstCreatePass?function e2(t,e,n,r,i,o,s){const a=e.consts,h=Da(e,t,2,i,Uo(a,o));return Op(e,n,h,Uo(a,s)),null!==h.attrs&&Gl(h,h.attrs,!1),null!==h.mergedAttrs&&Gl(h,h.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,h),h}(s,o,i,0,e,n,r):o.data[s];Wi(h,!0);const g=h.mergedAttrs;null!==g&&vl(a,l,g);const m=h.classes;null!==m&&Zf(a,l,m);const C=h.styles;return null!==C&&_v(a,l,C),64!=(64&h.flags)&&Tl(o,i,l,h),0===function BD(){return ft.lFrame.elementDepthCount}()&&lr(l,i),function VD(){ft.lFrame.elementDepthCount++}(),hl(h)&&(kp(o,i,h),b_(o,h,i)),null!==r&&Rp(i,h),tt}function Xe(){let t=Bn();ff()?pf():(t=t.parent,Wi(t,!1));const e=t;!function UD(){ft.lFrame.elementDepthCount--}();const n=Pt();return n.firstCreatePass&&(gl(n,t),sf(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function sA(t){return 0!=(16&t.flags)}(e)&&Gp(n,e,Me(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function aA(t){return 0!=(32&t.flags)}(e)&&Gp(n,e,Me(),e.stylesWithoutHost,!1),Xe}function tr(t,e,n,r){return tt(t,e,n,r),Xe(),tr}function Ju(t,e,n){const r=Me(),i=Pt(),o=t+22,s=i.firstCreatePass?function t2(t,e,n,r,i){const o=e.consts,s=Uo(o,r),a=Da(e,t,8,"ng-container",s);return null!==s&&Gl(a,s,!0),Op(e,n,a,Uo(o,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(o,i,r,e,n):i.data[o];Wi(s,!0);const a=r[o]=r[11].createComment("");return Tl(i,r,a,s),lr(a,r),hl(s)&&(kp(i,r,s),b_(i,s,r)),null!=n&&Rp(r,s),Ju}function Yu(){let t=Bn();const e=Pt();return ff()?pf():(t=t.parent,Wi(t,!1)),e.firstCreatePass&&(gl(e,t),sf(t)&&e.queries.elementEnd(t)),Yu}function La(){return Me()}function Zu(t){return!!t&&"function"==typeof t.then}const zp=function W_(t){return!!t&&"function"==typeof t.subscribe};function mt(t,e,n,r){const i=Me(),o=Pt(),s=Bn();return function Y_(t,e,n,r,i,o,s,a){const l=hl(r),g=t.firstCreatePass&&k_(t),m=e[8],C=P_(e);let D=!0;if(3&r.type||a){const Se=Kr(r,e),xe=a?a(Se):Se,Fe=C.length,Ce=a?bt=>a(Rn(bt[r.index])):r.index;let We=null;if(!a&&l&&(We=function n2(t,e,n,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const s=i[o];if(s===n&&i[o+1]===r){const a=e[7],l=i[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(t,e,i,r.index)),null!==We)(We.__ngLastListenerFn__||We).__ngNextListenerFn__=o,We.__ngLastListenerFn__=o,D=!1;else{o=Q_(r,e,m,o,!1);const bt=n.listen(xe,i,o);C.push(o,bt),g&&g.push(i,Ce,Fe,Fe+1)}}else o=Q_(r,e,m,o,!1);const q=r.outputs;let he;if(D&&null!==q&&(he=q[i])){const Se=he.length;if(Se)for(let xe=0;xe<Se;xe+=2){const Ut=e[he[xe]][he[xe+1]].subscribe(o),mr=C.length;C.push(o,Ut),g&&g.push(i,r.index,mr,-(mr+1))}}}(o,i,i[11],s,t,e,0,r),mt}function Z_(t,e,n,r){try{return!1!==n(r)}catch(i){return N_(t,i),!1}}function Q_(t,e,n,r,i){return function o(s){if(s===Function)return r;Bp(2&t.flags?Wr(t.index,e):e);let l=Z_(e,0,r,s),h=o.__ngNextListenerFn__;for(;h;)l=Z_(e,0,h,s)&&l,h=h.__ngNextListenerFn__;return i&&!1===l&&(s.preventDefault(),s.returnValue=!1),l}}function bo(t=1){return function JD(t){return(ft.lFrame.contextLView=function YD(t,e){for(;t>0;)e=e[15],t--;return e}(t,ft.lFrame.contextLView))[8]}(t)}function r2(t,e){let n=null;const r=function IF(t){const e=t.attrs;if(null!=e){const n=e.indexOf(5);if(0==(1&n))return e[n+1]}return null}(t);for(let i=0;i<e.length;i++){const o=e[i];if("*"!==o){if(null===r?Wv(t,o,!0):MF(r,o))return i}else n=i}return n}function Kp(t){const e=Me()[16][6];if(!e.projection){const r=e.projection=Fu(t?t.length:1,null),i=r.slice();let o=e.child;for(;null!==o;){const s=t?r2(o,t):0;null!==s&&(i[s]?i[s].projectionNext=o:r[s]=o,i[s]=o),o=o.next}}}function Wp(t,e=0,n){const r=Me(),i=Pt(),o=Da(i,22+t,16,null,n||null);null===o.projection&&(o.projection=e),pf(),64!=(64&o.flags)&&function bI(t,e,n){vv(e[11],0,e,n,cv(t,n,e),fv(n.parent||e[6],n,e))}(i,r,o)}function ub(t,e,n,r,i){const o=t[n+1],s=null===e;let a=r?Ii(o):vo(o),l=!1;for(;0!==a&&(!1===l||s);){const g=t[a+1];s2(t[a],e)&&(l=!0,t[a+1]=r?Cp(g):wp(g)),a=r?Ii(g):vo(g)}l&&(t[n+1]=r?wp(o):Cp(o))}function s2(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ya(t,e)>=0}const Un={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function cb(t){return t.substring(Un.key,Un.keyEnd)}function lb(t,e){const n=Un.textEnd;return n===e?-1:(e=Un.keyEnd=function l2(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,Un.key=e,n),ja(t,e,n))}function ja(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function Or(t,e){return function Fi(t,e,n,r){const i=Me(),o=Pt(),s=fo(2);o.firstUpdatePass&&yb(o,t,s,r),e!==pt&&dr(i,s,e)&&_b(o,o.data[xr()],i,i[11],t,i[s+1]=function b2(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=u(qo(t)))),t}(e,n),r,s)}(t,e,null,!0),Or}function Ba(t){!function Ti(t,e,n,r){const i=Pt(),o=fo(2);i.firstUpdatePass&&yb(i,null,o,r);const s=Me();if(n!==pt&&dr(s,o,n)){const a=i.data[xr()];if(wb(a,r)&&!mb(i,o)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(n=d(l,n||"")),Gp(i,a,s,n,r)}else!function _2(t,e,n,r,i,o,s,a){i===pt&&(i=Nt);let l=0,h=0,g=0<i.length?i[0]:null,m=0<o.length?o[0]:null;for(;null!==g||null!==m;){const C=l<i.length?i[l+1]:void 0,D=h<o.length?o[h+1]:void 0;let he,q=null;g===m?(l+=2,h+=2,C!==D&&(q=m,he=D)):null===m||null!==g&&g<m?(l+=2,q=g):(h+=2,q=m,he=D),null!==q&&_b(t,e,n,r,q,he,s,a),g=l<i.length?i[l]:null,m=h<o.length?o[h]:null}}(i,a,s,s[11],s[o+1],s[o+1]=function v2(t,e,n){if(null==n||""===n)return Nt;const r=[],i=qo(n);if(Array.isArray(i))for(let o=0;o<i.length;o++)t(r,i[o],!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&t(r,o,i[o]);else"string"==typeof i&&e(r,i);return r}(t,e,n),r,o)}}(Yr,eo,t,!0)}function eo(t,e){for(let n=function u2(t){return function hb(t){Un.key=0,Un.keyEnd=0,Un.value=0,Un.valueEnd=0,Un.textEnd=t.length}(t),lb(t,ja(t,0,Un.textEnd))}(e);n>=0;n=lb(e,n))Yr(t,cb(e),!0)}function mb(t,e){return e>=t.expandoStartIndex}function yb(t,e,n,r){const i=t.data;if(null===i[n+1]){const o=i[xr()],s=mb(t,n);wb(o,r)&&null===e&&!s&&(e=!1),e=function p2(t,e,n,r){const i=function mf(t){const e=ft.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let o=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=Qu(n=Yp(null,t,e,n,r),e.attrs,r),o=null);else{const s=e.directiveStylingLast;if(-1===s||t[s]!==i)if(n=Yp(i,t,e,n,r),null===o){let l=function g2(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==vo(r))return t[Ii(r)]}(t,e,r);void 0!==l&&Array.isArray(l)&&(l=Yp(null,t,e,l[1],r),l=Qu(l,e.attrs,r),function m2(t,e,n,r){t[Ii(n?e.classBindings:e.styleBindings)]=r}(t,e,r,l))}else o=function y2(t,e,n){let r;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)r=Qu(r,t[o].hostAttrs,n);return Qu(r,e.attrs,n)}(t,e,r)}return void 0!==o&&(r?e.residualClasses=o:e.residualStyles=o),n}(i,o,e,r),function i2(t,e,n,r,i,o){let s=o?e.classBindings:e.styleBindings,a=Ii(s),l=vo(s);t[r]=n;let g,h=!1;if(Array.isArray(n)){const m=n;g=m[1],(null===g||ya(m,g)>0)&&(h=!0)}else g=n;if(i)if(0!==l){const C=Ii(t[a+1]);t[r+1]=jl(C,a),0!==C&&(t[C+1]=Sp(t[C+1],r)),t[a+1]=function XF(t,e){return 131071&t|e<<17}(t[a+1],r)}else t[r+1]=jl(a,0),0!==a&&(t[a+1]=Sp(t[a+1],r)),a=r;else t[r+1]=jl(l,0),0===a?a=r:t[l+1]=Sp(t[l+1],r),l=r;h&&(t[r+1]=wp(t[r+1])),ub(t,g,r,!0),ub(t,g,r,!1),function o2(t,e,n,r,i){const o=i?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof e&&ya(o,e)>=0&&(n[r+1]=Cp(n[r+1]))}(e,g,t,r,o),s=jl(a,l),o?e.classBindings=s:e.styleBindings=s}(i,o,e,n,s,r)}}function Yp(t,e,n,r,i){let o=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(o=e[a],r=Qu(r,o.hostAttrs,i),o!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function Qu(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?i=s:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Yr(t,s,!!n||e[++o]))}return void 0===t?null:t}function _b(t,e,n,r,i,o,s,a){if(!(3&e.type))return;const l=t.data,h=l[a+1];Jl(function l_(t){return 1==(1&t)}(h)?bb(l,e,n,i,vo(h),s):void 0)||(Jl(o)||function c_(t){return 2==(2&t)}(h)&&(o=bb(l,null,n,i,a,s)),function SI(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let o=-1===r.indexOf("-")?void 0:Nr.DashCase;null==i?t.removeStyle(n,r,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Nr.Important),t.setStyle(n,r,i,o))}}(r,s,fl(xr(),n),i,o))}function bb(t,e,n,r,i,o){const s=null===e;let a;for(;i>0;){const l=t[i],h=Array.isArray(l),g=h?l[1]:l,m=null===g;let C=n[i+1];C===pt&&(C=m?Nt:void 0);let D=m?If(C,r):g===r?C:void 0;if(h&&!Jl(D)&&(D=If(l,r)),Jl(D)&&(a=D,s))return a;const q=t[i+1];i=s?Ii(q):vo(q)}if(null!==e){let l=o?e.residualClasses:e.residualStyles;null!=l&&(a=If(l,r))}return a}function Jl(t){return void 0!==t}function wb(t,e){return 0!=(t.flags&(e?16:32))}function Wt(t,e=""){const n=Me(),r=Pt(),i=t+22,o=r.firstCreatePass?Da(r,i,1,e,null):r.data[i],s=n[i]=function $f(t,e){return t.createText(e)}(n[11],e);Tl(r,n,s,o),Wi(o,!1)}function Hn(t){return Yl("",t,""),Hn}function Yl(t,e,n){const r=Me(),i=function Fa(t,e,n,r){return dr(t,ca(),n)?e+M(n)+r:pt}(r,t,e,n);return i!==pt&&function _o(t,e,n){const r=fl(e,t);!function sv(t,e,n){t.setValue(e,n)}(t[11],r,n)}(r,xr(),i),Yl}const Ua="en-US";let $b=Ua;function Xp(t,e,n,r,i){if(t=y(t),Array.isArray(t))for(let o=0;o<t.length;o++)Xp(t[o],e,n,r,i);else{const o=Pt(),s=Me();let a=Ds(t)?t:y(t.provide),l=Vv(t);const h=Bn(),g=1048575&h.providerIndexes,m=h.directiveStart,C=h.providerIndexes>>20;if(Ds(t)||!t.multi){const D=new Su(l,i,De),q=tg(a,e,i?g:g+C,m);-1===q?(Sl(Eu(h,s),o,a),eg(o,t,e.length),e.push(a),h.directiveStart++,h.directiveEnd++,i&&(h.providerIndexes+=1048576),n.push(D),s.push(D)):(n[q]=D,s[q]=D)}else{const D=tg(a,e,g+C,m),q=tg(a,e,g,g+C),he=D>=0&&n[D],Se=q>=0&&n[q];if(i&&!Se||!i&&!he){Sl(Eu(h,s),o,a);const xe=function jM(t,e,n,r,i){const o=new Su(t,n,De);return o.multi=[],o.index=e,o.componentProviders=0,pw(o,i,r&&!n),o}(i?LM:OM,n.length,i,r,l);!i&&Se&&(n[q].providerFactory=xe),eg(o,t,e.length,0),e.push(a),h.directiveStart++,h.directiveEnd++,i&&(h.providerIndexes+=1048576),n.push(xe),s.push(xe)}else eg(o,t,D>-1?D:q,pw(n[i?q:D],l,!i&&r));!i&&r&&Se&&n[q].componentProviders++}}}function eg(t,e,n,r){const i=Ds(e),o=function QI(t){return!!t.useClass}(e);if(i||o){const l=(o?y(e.useClass):e).prototype.ngOnDestroy;if(l){const h=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const g=h.indexOf(n);-1===g?h.push(n,[r,l]):h[g+1].push(r,l)}else h.push(n,l)}}}function pw(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function tg(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function OM(t,e,n,r){return ng(this.multi,[])}function LM(t,e,n,r){const i=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=xu(n,n[1],this.providerFactory.index,r);o=a.slice(0,s),ng(i,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],ng(i,o);return o}function ng(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function ln(t,e=[]){return n=>{n.providersResolver=(r,i)=>function NM(t,e,n){const r=Pt();if(r.firstCreatePass){const i=Di(t);Xp(n,r.data,r.blueprint,i,!0),Xp(e,r.data,r.blueprint,i,!1)}}(r,i?i(t):t,e)}}class Ts{}class gw{}class mw extends Ts{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Hp(this);const r=Gr(e);this._bootstrapComponents=yo(r.bootstrap),this._r3Injector=t_(e,n,[{provide:Ts,useValue:this},{provide:$u,useValue:this.componentFactoryResolver}],u(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class rg extends gw{constructor(e){super(),this.moduleType=e}create(e){return new mw(this.moduleType,e)}}class VM extends Ts{constructor(e,n,r){super(),this.componentFactoryResolver=new Hp(this),this.instance=null;const i=new Bv([...e,{provide:Ts,useValue:this},{provide:$u,useValue:this.componentFactoryResolver}],n||Ol(),r,new Set(["environment"]));this.injector=i,i.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function td(t,e,n=null){return new VM(t,e,n).injector}let UM=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n.id)){const r=Nv(0,n.type),i=r.length>0?td([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n.id,i)}return this.cachedInjectors.get(n.id)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return t.\u0275prov=Ve({token:t,providedIn:"environment",factory:()=>new t(Je(Go))}),t})();function yw(t){t.getStandaloneInjector=e=>e.get(UM).getOrCreateStandaloneInjector(t)}function og(t){return e=>{setTimeout(t,void 0,e)}}const Rt=class fP extends $t{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,o=n||(()=>null),s=r;if(e&&"object"==typeof e){const l=e;i=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=og(o),i&&(i=og(i)),s&&(s=og(s)));const a=super.subscribe({next:i,error:o,complete:s});return e instanceof k&&e.add(a),a}};let wo=(()=>{class t{}return t.__NG_ELEMENT_ID__=yP,t})();const gP=wo,mP=class extends gP{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(e,n){const r=this._declarationTContainer.tViews,i=Ul(this._declarationLView,r,e,16,null,r.declTNode,null,null,null,null,n||null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(r)),Pp(r,i,e),new Gu(i)}};function yP(){return function nd(t,e){return 4&t.type?new mP(e,t,Sa(t,e)):null}(Bn(),Me())}let Mi=(()=>{class t{}return t.__NG_ELEMENT_ID__=vP,t})();function vP(){return function Mw(t,e){let n;const r=e[t.index];if(xi(r))n=r;else{let i;if(8&t.type)i=Rn(r);else{const o=e[11];i=o.createComment("");const s=Kr(t,e);Es(o,Fl(o,s),i,function _I(t,e){return t.nextSibling(e)}(o,s),!1)}e[t.index]=n=M_(r,e,i,t),$l(e,n)}return new Fw(n,t,e)}(Bn(),Me())}const _P=Mi,Fw=class extends _P{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Sa(this._hostTNode,this._hostLView)}get injector(){return new ha(this._hostTNode,this._hostLView)}get parentInjector(){const e=wl(this._hostTNode,this._hostLView);if(C0(e)){const n=da(e,this._hostLView),r=la(e);return new ha(n[1].data[r+8],n)}return new ha(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=Tw(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,r){let i,o;"number"==typeof r?i=r:null!=r&&(i=r.index,o=r.injector);const s=e.createEmbeddedView(n||{},o);return this.insert(s,i),s}createComponent(e,n,r,i,o){const s=e&&!function Iu(t){return"function"==typeof t}(e);let a;if(s)a=n;else{const m=n||{};a=m.index,r=m.injector,i=m.projectableNodes,o=m.environmentInjector||m.ngModuleRef}const l=s?e:new zu(zt(e)),h=r||this.parentInjector;if(!o&&null==l.ngModule){const C=(s?h:this.parentInjector).get(Go,null);C&&(o=C)}const g=l.create(h,i,void 0,o);return this.insert(g.hostView,a),g}insert(e,n){const r=e._lView,i=r[1];if(function jD(t){return xi(t[3])}(r)){const g=this.indexOf(e);if(-1!==g)this.detach(g);else{const m=r[3],C=new Fw(m,m[6],m[3]);C.detach(C.indexOf(e))}}const o=this._adjustIndex(n),s=this._lContainer;!function pI(t,e,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-10?(e[4]=n[i],R0(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const s=e[17];null!==s&&n!==s&&function gI(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(s,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=64}(i,r,s,o);const a=Wf(o,s),l=r[11],h=Fl(l,s[7]);return null!==h&&function dI(t,e,n,r,i,o){r[0]=i,r[6]=e,Bu(t,r,n,1,i,o)}(i,s[6],l,r,h,a),e.attachToViewContainerRef(),R0(ag(s),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=Tw(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=Gf(this._lContainer,n);r&&(El(ag(this._lContainer),n),uv(r[1],r))}detach(e){const n=this._adjustIndex(e,-1),r=Gf(this._lContainer,n);return r&&null!=El(ag(this._lContainer),n)?new Gu(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function Tw(t){return t[8]}function ag(t){return t[8]||(t[8]=[])}function id(...t){}const od=new ot("Application Initializer");let sd=(()=>{class t{constructor(n){this.appInits=n,this.resolve=id,this.reject=id,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const o=this.appInits[i]();if(Zu(o))n.push(o);else if(zp(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});n.push(s)}}Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(Je(od,8))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ac=new ot("AppId",{providedIn:"root",factory:function tS(){return`${bg()}${bg()}${bg()}`}});function bg(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const nS=new ot("Platform Initializer"),wg=new ot("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),rS=new ot("appBootstrapListener");let JP=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const So=new ot("LocaleId",{providedIn:"root",factory:()=>pn(So,rt.Optional|rt.SkipSelf)||function YP(){return typeof $localize<"u"&&$localize.locale||Ua}()});class QP{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let Sg=(()=>{class t{compileModuleSync(n){return new rg(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),o=yo(Gr(n).declarations).reduce((s,a)=>{const l=zt(a);return l&&s.push(new zu(l)),s},[]);return new QP(r,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const tk=(()=>Promise.resolve(0))();function Cg(t){typeof Zone>"u"?tk.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class $n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Rt(!1),this.onMicrotaskEmpty=new Rt(!1),this.onStable=new Rt(!1),this.onError=new Rt(!1),typeof Zone>"u")throw new E(908,!1);Zone.assertZonePatched();const i=this;if(i._nesting=0,i._outer=i._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const o=Zone.AsyncStackTaggingZoneSpec;i._inner=i._inner.fork(new o("Angular"))}Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function nk(){let t=ht.requestAnimationFrame,e=ht.cancelAnimationFrame;if(typeof Zone<"u"&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function ok(t){const e=()=>{!function ik(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ht,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,xg(t),t.isCheckStableRunning=!0,Eg(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),xg(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,o,s,a)=>{try{return sS(t),n.invokeTask(i,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&e(),aS(t)}},onInvoke:(n,r,i,o,s,a,l)=>{try{return sS(t),n.invoke(i,o,s,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),aS(t)}},onHasTask:(n,r,i,o)=>{n.hasTask(i,o),r===i&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,xg(t),Eg(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,i,o)=>(n.handleError(i,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!$n.isInAngularZone())throw new E(909,!1)}static assertNotInAngularZone(){if($n.isInAngularZone())throw new E(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,rk,id,id);try{return o.runTask(s,n,r)}finally{o.cancelTask(s)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const rk={};function Eg(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function xg(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function sS(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function aS(t){t._nesting--,Eg(t)}class sk{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Rt,this.onMicrotaskEmpty=new Rt,this.onStable=new Rt,this.onError=new Rt}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}const uS=new ot(""),ad=new ot("");let Ig,Dg=(()=>{class t{constructor(n,r,i){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Ig||(function ak(t){Ig=t}(i),i.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$n.assertNotInAngularZone(),Cg(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Cg(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,i){return[]}}return t.\u0275fac=function(n){return new(n||t)(Je($n),Je(Ag),Je(ad))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),Ag=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return Ig?.findTestabilityInTree(this,n,r)??null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})(),Wo=null;const cS=new ot("AllowMultipleToken"),Fg=new ot("PlatformDestroyListeners");class lS{constructor(e,n){this.name=e,this.token=n}}function hS(t,e,n=[]){const r=`Platform: ${e}`,i=new ot(r);return(o=[])=>{let s=Tg();if(!s||s.injector.get(cS,!1)){const a=[...n,...o,{provide:i,useValue:!0}];t?t(a):function lk(t){if(Wo&&!Wo.get(cS,!1))throw new E(400,!1);Wo=t;const e=t.get(pS);(function dS(t){const e=t.get(nS,null);e&&e.forEach(n=>n())})(t)}(function fS(t=[],e){return Qr.create({name:e,providers:[{provide:cp,useValue:"platform"},{provide:Fg,useValue:new Set([()=>Wo=null])},...t]})}(a,r))}return function hk(t){const e=Tg();if(!e)throw new E(401,!1);return e}()}}function Tg(){return Wo?.get(pS)??null}let pS=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const i=function mS(t,e){let n;return n="noop"===t?new sk:("zone.js"===t?void 0:t)||new $n(e),n}(r?.ngZone,function gS(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(r)),o=[{provide:$n,useValue:i}];return i.run(()=>{const s=Qr.create({providers:o,parent:this.injector,name:n.moduleType.name}),a=n.create(s),l=a.injector.get(Ca,null);if(!l)throw new E(402,!1);return i.runOutsideAngular(()=>{const h=i.onError.subscribe({next:g=>{l.handleError(g)}});a.onDestroy(()=>{cd(this._modules,a),h.unsubscribe()})}),function yS(t,e,n){try{const r=n();return Zu(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(l,i,()=>{const h=a.injector.get(sd);return h.runInitializers(),h.donePromise.then(()=>(function qb(t){St(t,"Expected localeId to be defined"),"string"==typeof t&&($b=t.toLowerCase().replace(/_/g,"-"))}(a.injector.get(So,Ua)||Ua),this._moduleDoBootstrap(a),a))})})}bootstrapModule(n,r=[]){const i=vS({},r);return function uk(t,e,n){const r=new rg(n);return Promise.resolve(r)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(n){const r=n.injector.get(ud);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new E(403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new E(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(Fg,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(Je(Qr))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function vS(t,e){return Array.isArray(e)?e.reduce(vS,t):{...t,...e}}let ud=(()=>{class t{constructor(n,r,i){this._zone=n,this._injector=r,this._exceptionHandler=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new It(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),s=new It(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{$n.assertNotInAngularZone(),Cg(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{$n.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),h.unsubscribe()}});this.isStable=function Xh(...t){const e=No(t),n=function Cn(t,e){return"number"==typeof Qs(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?Zt(r[0]):Ci(n)(un(r,e)):ci}(o,s.pipe(function ef(t={}){const{connector:e=(()=>new $t),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return o=>{let s=null,a=null,l=null,h=0,g=!1,m=!1;const C=()=>{a?.unsubscribe(),a=null},D=()=>{C(),s=l=null,g=m=!1},q=()=>{const he=s;D(),he?.unsubscribe()};return Lt((he,Se)=>{h++,!m&&!g&&C();const xe=l=l??e();Se.add(()=>{h--,0===h&&!m&&!g&&(a=gu(q,i))}),xe.subscribe(Se),s||(s=new Te({next:Fe=>xe.next(Fe),error:Fe=>{m=!0,C(),a=gu(D,n,Fe),xe.error(Fe)},complete:()=>{g=!0,C(),a=gu(D,r),xe.complete()}}),un(he).subscribe(s))})(o)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const i=n instanceof Uv;if(!this._injector.get(sd).done)throw!i&&function ia(t){const e=zt(t)||Sr(t)||Cr(t);return null!==e&&e.standalone}(n),new E(405,false);let s;s=i?n:this._injector.get($u).resolveComponentFactory(n),this.componentTypes.push(s.componentType);const a=function ck(t){return t.isBoundToModule}(s)?void 0:this._injector.get(Ts),h=s.create(Qr.NULL,[],r||s.selector,a),g=h.location.nativeElement,m=h.injector.get(uS,null);return m?.registerApplication(g),h.onDestroy(()=>{this.detachView(h.hostView),cd(this.components,h),m?.unregisterApplication(g)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new E(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;cd(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(rS,[]).concat(this._bootstrapListeners).forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>cd(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new E(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(n){return new(n||t)(Je($n),Je(Go),Je(Ca))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function cd(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}let bS=!0,ld=(()=>{class t{}return t.__NG_ELEMENT_ID__=gk,t})();function gk(t){return function mk(t,e,n){if(dl(t)&&!n){const r=Wr(t.index,e);return new Gu(r,r)}return 47&t.type?new Gu(e[16],e):null}(Bn(),Me(),16==(16&t))}class xS{constructor(){}supports(e){return Ku(e)}create(e){return new Sk(e)}}const wk=(t,e)=>e;class Sk{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||wk}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,o=null;for(;n||r;){const s=!r||n&&n.currentIndex<AS(r,i,o)?n:r,a=AS(s,i,o),l=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(n=n._next,null==s.previousIndex)i++;else{o||(o=[]);const h=a-i,g=l-i;if(h!=g){for(let C=0;C<h;C++){const D=C<o.length?o[C]:o[C]=0,q=D+C;g<=q&&q<h&&(o[C]=D+1)}o[s.previousIndex]=g-h}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!Ku(e))throw new E(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,o,s,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,o,s,a)),Object.is(n.item,o)||this._addIdentityChange(n,o)):(n=this._mismatch(n,o,s,a),r=!0),n=n._next}else i=0,function WT(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[As()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,a=>{s=this._trackByFn(i,a),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,a,s,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,s,i),r=!0),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,o,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,o,i)):e=this._addAfter(new Ck(n,r),o,i),e}_verifyReinsertion(e,n,r,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==o?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,o=e._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const i=null===n?this._itHead:n._next;return e._next=i,e._prev=n,null===i?this._itTail=e:i._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new DS),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new DS),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Ck{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Ek{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class DS{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new Ek,this.map.set(n,r)),r.add(e)}get(e,n){const i=this.map.get(e);return i?i.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function AS(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function FS(){return new fd([new xS])}let fd=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(null!=r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||FS()),deps:[[t,new Ru,new ku]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(null!=r)return r;throw new E(901,!1)}}return t.\u0275prov=Ve({token:t,providedIn:"root",factory:FS}),t})();const Fk=hS(null,"core",[]);let Tk=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(Je(ud))},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({}),t})(),pd=null;function to(){return pd}const Fr=new ot("DocumentToken");let Ng=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:function(){return function Rk(){return Je(MS)}()},providedIn:"platform"}),t})();const Nk=new ot("Location Initialized");let MS=(()=>{class t extends Ng{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return to().getBaseHref(this._doc)}onPopState(n){const r=to().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=to().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,r,i){PS()?this._history.pushState(n,r,i):this.location.hash=i}replaceState(n,r,i){PS()?this._history.replaceState(n,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return t.\u0275fac=function(n){return new(n||t)(Je(Fr))},t.\u0275prov=Ve({token:t,factory:function(){return function Ok(){return new MS(Je(Fr))}()},providedIn:"platform"}),t})();function PS(){return!!window.history.pushState}function Og(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function kS(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function xo(t){return t&&"?"!==t[0]?"?"+t:t}let Ps=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:function(){return pn(NS)},providedIn:"root"}),t})();const RS=new ot("appBaseHref");let NS=(()=>{class t extends Ps{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??pn(Fr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Og(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+xo(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,o){const s=this.prepareExternalUrl(i+xo(o));this._platformLocation.pushState(n,r,s)}replaceState(n,r,i,o){const s=this.prepareExternalUrl(i+xo(o));this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return t.\u0275fac=function(n){return new(n||t)(Je(Ng),Je(RS,8))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Lk=(()=>{class t extends Ps{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=Og(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,o){let s=this.prepareExternalUrl(i+xo(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(n,r,s)}replaceState(n,r,i,o){let s=this.prepareExternalUrl(i+xo(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return t.\u0275fac=function(n){return new(n||t)(Je(Ng),Je(RS,8))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),Lg=(()=>{class t{constructor(n){this._subject=new Rt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._baseHref=kS(OS(r)),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+xo(r))}normalize(n){return t.stripTrailingSlash(function Bk(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,OS(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xo(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xo(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}}return t.normalizeQueryParams=xo,t.joinWithSlash=Og,t.stripTrailingSlash=kS,t.\u0275fac=function(n){return new(n||t)(Je(Ps))},t.\u0275prov=Ve({token:t,factory:function(){return function jk(){return new Lg(Je(Ps))}()},providedIn:"root"}),t})();function OS(t){return t.replace(/\/index.html$/,"")}function GS(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,o]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}class ER{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Kg=(()=>{class t{constructor(n,r,i){this._viewContainer=n,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((i,o,s)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new ER(i.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)r.remove(null===o?void 0:o);else if(null!==o){const a=r.get(o);r.move(a,s),WS(a,i)}});for(let i=0,o=r.length;i<o;i++){const a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}n.forEachIdentityChange(i=>{WS(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(De(Mi),De(wo),De(fd))},t.\u0275dir=dt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function WS(t,e){t.context.$implicit=e.item}let Wg=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new DR,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){JS("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){JS("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(De(Mi),De(wo))},t.\u0275dir=dt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class DR{constructor(){this.$implicit=null,this.ngIf=null}}function JS(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${u(e)}'.`)}let XR=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({}),t})();let rN=(()=>{class t{}return t.\u0275prov=Ve({token:t,providedIn:"root",factory:()=>new iN(Je(Fr),window)}),t})();class iN{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function oN(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const o=i.shadowRoot;if(o){const s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=e)}}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=XS(this.window.history)||XS(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function XS(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class e1{}class tm extends class PN extends class kk{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Pk(t){pd||(pd=t)}(new tm)}onAndCancel(e,n,r){return e.addEventListener(n,r,!1),()=>{e.removeEventListener(n,r,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function kN(){return hc=hc||document.querySelector("base"),hc?hc.getAttribute("href"):null}();return null==n?null:function RN(t){Dd=Dd||document.createElement("a"),Dd.setAttribute("href",t);const e=Dd.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){hc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return GS(document.cookie,e)}}let Dd,hc=null;const o1=new ot("TRANSITION_ID"),ON=[{provide:od,useFactory:function NN(t,e,n){return()=>{n.get(sd).donePromise.then(()=>{const r=to(),i=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<i.length;o++)r.remove(i[o])})}},deps:[o1,Fr,Qr],multi:!0}];let jN=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();const Ad=new ot("EventManagerPlugins");let Id=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>i.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}addGlobalEventListener(n,r,i){return this._findPluginFor(r).addGlobalEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const i=this._plugins;for(let o=0;o<i.length;o++){const s=i[o];if(s.supports(n))return this._eventNameToPlugin.set(n,s),s}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(Je(Ad),Je($n))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();class s1{constructor(e){this._doc=e}addGlobalEventListener(e,n,r){const i=to().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${n}`);return this.addEventListener(i,n,r)}}let a1=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),fc=(()=>{class t extends a1{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,i){n.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,i.push(r.appendChild(s))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(u1),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(n,i,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(u1))}}return t.\u0275fac=function(n){return new(n||t)(Je(Fr))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();function u1(t){to().remove(t)}const nm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},rm=/%COMP%/g;function Fd(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Fd(t,i,n):(i=i.replace(rm,t),n.push(i))}return n}function d1(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let im=(()=>{class t{constructor(n,r,i){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new om(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case er.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new qN(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(n),i}case 1:case er.ShadowDom:return new GN(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const i=Fd(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(Je(Id),Je(fc),Je(ac))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();class om{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?document.createElementNS(nm[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){(f1(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(f1(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const o=nm[i];o?e.setAttributeNS(o,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=nm[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Nr.DashCase|Nr.Important)?e.style.setProperty(n,r,i&Nr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Nr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,d1(r)):this.eventManager.addEventListener(e,n,d1(r))}}function f1(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class qN extends om{constructor(e,n,r,i){super(e),this.component=r;const o=Fd(i+"-"+r.id,r.styles,[]);n.addStyles(o),this.contentAttr=function UN(t){return"_ngcontent-%COMP%".replace(rm,t)}(i+"-"+r.id),this.hostAttr=function HN(t){return"_nghost-%COMP%".replace(rm,t)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}class GN extends om{constructor(e,n,r,i){super(e),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=Fd(i.id,i.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let zN=(()=>{class t extends s1{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}}return t.\u0275fac=function(n){return new(n||t)(Je(Fr))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();const p1=["alt","control","meta","shift"],KN={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},WN={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let JN=(()=>{class t extends s1{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const o=t.parseEventName(r),s=t.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>to().onAndCancel(n,o.domEventName,s))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=t._normalizeKey(r.pop());let s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),p1.forEach(h=>{const g=r.indexOf(h);g>-1&&(r.splice(g,1),s+=h+".")}),s+=o,0!=r.length||0===o.length)return null;const l={};return l.domEventName=i,l.fullKey=s,l}static matchEventFullKeyCode(n,r){let i=KN[n.key]||n.key,o="";return r.indexOf("code.")>-1&&(i=n.code,o="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),p1.forEach(s=>{s!==i&&(0,WN[s])(n)&&(o+=s+".")}),o+=i,o===r)}static eventCallback(n,r,i){return o=>{t.matchEventFullKeyCode(o,n)&&i.runGuarded(()=>r(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return t.\u0275fac=function(n){return new(n||t)(Je(Fr))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();const XN=hS(Fk,"browser",[{provide:wg,useValue:"browser"},{provide:nS,useValue:function YN(){tm.makeCurrent()},multi:!0},{provide:Fr,useFactory:function QN(){return function DI(t){Xf=t}(document),document},deps:[]}]),y1=new ot(""),v1=[{provide:ad,useClass:class LN{addToWindow(e){ht.getAngularTestability=(r,i=!0)=>{const o=e.findTestabilityInTree(r,i);if(null==o)throw new Error("Could not find testability for element.");return o},ht.getAllAngularTestabilities=()=>e.getAllTestabilities(),ht.getAllAngularRootElements=()=>e.getAllRootElements(),ht.frameworkStabilizers||(ht.frameworkStabilizers=[]),ht.frameworkStabilizers.push(r=>{const i=ht.getAllAngularTestabilities();let o=i.length,s=!1;const a=function(l){s=s||l,o--,0==o&&r(s)};i.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?to().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:uS,useClass:Dg,deps:[$n,Ag,ad]},{provide:Dg,useClass:Dg,deps:[$n,Ag,ad]}],_1=[{provide:cp,useValue:"root"},{provide:Ca,useFactory:function ZN(){return new Ca},deps:[]},{provide:Ad,useClass:zN,multi:!0,deps:[Fr,$n,wg]},{provide:Ad,useClass:JN,multi:!0,deps:[Fr]},{provide:im,useClass:im,deps:[Id,fc,ac]},{provide:$v,useExisting:im},{provide:a1,useExisting:fc},{provide:fc,useClass:fc,deps:[Fr]},{provide:Id,useClass:Id,deps:[Ad,$n]},{provide:e1,useClass:jN,deps:[]},[]];let eO=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:ac,useValue:n.appId},{provide:o1,useExisting:ac},ON]}}}return t.\u0275fac=function(n){return new(n||t)(Je(y1,12))},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({providers:[..._1,...v1],imports:[XR,Tk]}),t})(),b1=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return t.\u0275fac=function(n){return new(n||t)(Je(Fr))},t.\u0275prov=Ve({token:t,factory:function(n){let r=null;return r=n?new n:function nO(){return new b1(Je(Fr))}(),r},providedIn:"root"}),t})();function st(...t){return un(t,No(t))}function Yo(t,e){return ne(e)?Sn(t,e,1):Sn(t,1)}function Ao(t,e){return Lt((n,r)=>{let i=0;n.subscribe(new qt(r,o=>t.call(e,o,i++)&&r.next(o)))})}typeof window<"u"&&window;class C1{}class E1{}class ei{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(n=>{const r=n.indexOf(":");if(r>0){const i=n.slice(0,r),o=i.toLowerCase(),s=n.slice(r+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(n=>{let r=e[n];const i=n.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(i,r),this.maybeSetNormalizedName(n,i))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof ei?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){const n=new ei;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof ei?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){const n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,n);const i=("a"===e.op?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":const o=e.value;if(o){let s=this.headers.get(n);if(!s)return;s=s.filter(a=>-1===o.indexOf(a)),0===s.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,s)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}}class lO{encodeKey(e){return x1(e)}encodeValue(e){return x1(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const hO=/%(\d[a-f0-9])/gi,fO={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function x1(t){return encodeURIComponent(t).replace(hO,(e,n)=>fO[n]??e)}function Td(t){return`${t}`}class Zo{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new lO,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function dO(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[s,a]=-1==o?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],l=n.get(s)||[];l.push(a),n.set(s,l)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{const r=e.fromObject[n],i=Array.isArray(r)?r.map(Td):[Td(r)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){const n=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(o=>{n.push({param:r,value:o,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const n=new Zo({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const n=("a"===e.op?this.map.get(e.param):void 0)||[];n.push(Td(e.value)),this.map.set(e.param,n);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(Td(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class pO{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function D1(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function A1(t){return typeof Blob<"u"&&t instanceof Blob}function I1(t){return typeof FormData<"u"&&t instanceof FormData}class pc{constructor(e,n,r,i){let o;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function gO(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new ei),this.context||(this.context=new pO),this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+s}}else this.params=new Zo,this.urlWithParams=n}serializeBody(){return null===this.body?null:D1(this.body)||A1(this.body)||I1(this.body)||function mO(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Zo?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||I1(this.body)?null:A1(this.body)?this.body.type||null:D1(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Zo?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,s=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,h=e.params||this.params;const g=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((m,C)=>m.set(C,e.setHeaders[C]),l)),e.setParams&&(h=Object.keys(e.setParams).reduce((m,C)=>m.set(C,e.setParams[C]),h)),new pc(n,r,o,{params:h,headers:l,context:g,reportProgress:a,responseType:i,withCredentials:s})}}var jn=(()=>((jn=jn||{})[jn.Sent=0]="Sent",jn[jn.UploadProgress=1]="UploadProgress",jn[jn.ResponseHeader=2]="ResponseHeader",jn[jn.DownloadProgress=3]="DownloadProgress",jn[jn.Response=4]="Response",jn[jn.User=5]="User",jn))();class um{constructor(e,n=200,r="OK"){this.headers=e.headers||new ei,this.status=void 0!==e.status?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class cm extends um{constructor(e={}){super(e),this.type=jn.ResponseHeader}clone(e={}){return new cm({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Md extends um{constructor(e={}){super(e),this.type=jn.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Md({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class lm extends um{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function dm(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Pd=(()=>{class t{constructor(n){this.handler=n}request(n,r,i={}){let o;if(n instanceof pc)o=n;else{let l,h;l=i.headers instanceof ei?i.headers:new ei(i.headers),i.params&&(h=i.params instanceof Zo?i.params:new Zo({fromObject:i.params})),o=new pc(n,r,void 0!==i.body?i.body:null,{headers:l,context:i.context,params:h,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const s=st(o).pipe(Yo(l=>this.handler.handle(l)));if(n instanceof pc||"events"===i.observe)return s;const a=s.pipe(Ao(l=>l instanceof Md));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(at(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(at(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(at(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(at(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(n,r={}){return this.request("DELETE",n,r)}get(n,r={}){return this.request("GET",n,r)}head(n,r={}){return this.request("HEAD",n,r)}jsonp(n,r){return this.request("JSONP",n,{params:(new Zo).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,r={}){return this.request("OPTIONS",n,r)}patch(n,r,i={}){return this.request("PATCH",n,dm(i,r))}post(n,r,i={}){return this.request("POST",n,dm(i,r))}put(n,r,i={}){return this.request("PUT",n,dm(i,r))}}return t.\u0275fac=function(n){return new(n||t)(Je(C1))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();class F1{constructor(e,n){this.next=e,this.interceptor=n}handle(e){return this.interceptor.intercept(e,this.next)}}const hm=new ot("HTTP_INTERCEPTORS");let yO=(()=>{class t{intercept(n,r){return r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();const vO=/^\)\]\}',?\n/;let T1=(()=>{class t{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new It(r=>{const i=this.xhrFactory.build();if(i.open(n.method,n.urlWithParams),n.withCredentials&&(i.withCredentials=!0),n.headers.forEach((D,q)=>i.setRequestHeader(D,q.join(","))),n.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const D=n.detectContentTypeHeader();null!==D&&i.setRequestHeader("Content-Type",D)}if(n.responseType){const D=n.responseType.toLowerCase();i.responseType="json"!==D?D:"text"}const o=n.serializeBody();let s=null;const a=()=>{if(null!==s)return s;const D=i.statusText||"OK",q=new ei(i.getAllResponseHeaders()),he=function _O(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(i)||n.url;return s=new cm({headers:q,status:i.status,statusText:D,url:he}),s},l=()=>{let{headers:D,status:q,statusText:he,url:Se}=a(),xe=null;204!==q&&(xe=typeof i.response>"u"?i.responseText:i.response),0===q&&(q=xe?200:0);let Fe=q>=200&&q<300;if("json"===n.responseType&&"string"==typeof xe){const Ce=xe;xe=xe.replace(vO,"");try{xe=""!==xe?JSON.parse(xe):null}catch(We){xe=Ce,Fe&&(Fe=!1,xe={error:We,text:xe})}}Fe?(r.next(new Md({body:xe,headers:D,status:q,statusText:he,url:Se||void 0})),r.complete()):r.error(new lm({error:xe,headers:D,status:q,statusText:he,url:Se||void 0}))},h=D=>{const{url:q}=a(),he=new lm({error:D,status:i.status||0,statusText:i.statusText||"Unknown Error",url:q||void 0});r.error(he)};let g=!1;const m=D=>{g||(r.next(a()),g=!0);let q={type:jn.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(q.total=D.total),"text"===n.responseType&&!!i.responseText&&(q.partialText=i.responseText),r.next(q)},C=D=>{let q={type:jn.UploadProgress,loaded:D.loaded};D.lengthComputable&&(q.total=D.total),r.next(q)};return i.addEventListener("load",l),i.addEventListener("error",h),i.addEventListener("timeout",h),i.addEventListener("abort",h),n.reportProgress&&(i.addEventListener("progress",m),null!==o&&i.upload&&i.upload.addEventListener("progress",C)),i.send(o),r.next({type:jn.Sent}),()=>{i.removeEventListener("error",h),i.removeEventListener("abort",h),i.removeEventListener("load",l),i.removeEventListener("timeout",h),n.reportProgress&&(i.removeEventListener("progress",m),null!==o&&i.upload&&i.upload.removeEventListener("progress",C)),i.readyState!==i.DONE&&i.abort()}})}}return t.\u0275fac=function(n){return new(n||t)(Je(e1))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();const fm=new ot("XSRF_COOKIE_NAME"),pm=new ot("XSRF_HEADER_NAME");class M1{}let bO=(()=>{class t{constructor(n,r,i){this.doc=n,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=GS(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return t.\u0275fac=function(n){return new(n||t)(Je(Fr),Je(wg),Je(fm))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),gm=(()=>{class t{constructor(n,r){this.tokenService=n,this.headerName=r}intercept(n,r){const i=n.url.toLowerCase();if("GET"===n.method||"HEAD"===n.method||i.startsWith("http://")||i.startsWith("https://"))return r.handle(n);const o=this.tokenService.getToken();return null!==o&&!n.headers.has(this.headerName)&&(n=n.clone({headers:n.headers.set(this.headerName,o)})),r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(Je(M1),Je(pm))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),wO=(()=>{class t{constructor(n,r){this.backend=n,this.injector=r,this.chain=null}handle(n){if(null===this.chain){const r=this.injector.get(hm,[]);this.chain=r.reduceRight((i,o)=>new F1(i,o),this.backend)}return this.chain.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(Je(E1),Je(Qr))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),SO=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:gm,useClass:yO}]}}static withOptions(n={}){return{ngModule:t,providers:[n.cookieName?{provide:fm,useValue:n.cookieName}:[],n.headerName?{provide:pm,useValue:n.headerName}:[]]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({providers:[gm,{provide:hm,useExisting:gm,multi:!0},{provide:M1,useClass:bO},{provide:fm,useValue:"XSRF-TOKEN"},{provide:pm,useValue:"X-XSRF-TOKEN"}]}),t})(),CO=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({providers:[Pd,{provide:C1,useClass:wO},T1,{provide:E1,useExisting:T1}],imports:[SO.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),t})();class Ni extends $t{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const gc=Q(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:EO}=Array,{getPrototypeOf:xO,prototype:DO,keys:AO}=Object;function P1(t){if(1===t.length){const e=t[0];if(EO(e))return{args:e,keys:null};if(function IO(t){return t&&"object"==typeof t&&xO(t)===DO}(e)){const n=AO(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}const{isArray:FO}=Array;function k1(t){return at(e=>function TO(t,e){return FO(e)?t(...e):t(e)}(t,e))}function R1(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function N1(...t){const e=No(t),n=Xs(t),{args:r,keys:i}=P1(t);if(0===r.length)return un([],e);const o=new It(function MO(t,e,n=Ot){return r=>{O1(e,()=>{const{length:i}=t,o=new Array(i);let s=i,a=i;for(let l=0;l<i;l++)O1(e,()=>{const h=un(t[l],e);let g=!1;h.subscribe(new qt(r,m=>{o[l]=m,g||(g=!0,a--),a||r.next(n(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}(r,e,i?s=>R1(i,s):Ot));return n?o.pipe(k1(n)):o}function O1(t,e,n){t?$r(n,t,e):e()}function mm(...t){return function PO(){return Ci(1)}()(un(t,No(t)))}function L1(t){return new It(e=>{Zt(t()).subscribe(e)})}function mc(t,e){const n=ne(t)?t:()=>t,r=i=>i.error(n());return new It(e?i=>e.schedule(r,0,i):r)}function ym(){return Lt((t,e)=>{let n=null;t._refCount++;const r=new qt(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const i=t._connection,o=n;n=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}class j1 extends It{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Zn(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new k;const n=this.getSubject();e.add(this.source.subscribe(new qt(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=k.EMPTY)}return e}refCount(){return ym()(this)}}function no(t,e){return Lt((n,r)=>{let i=null,o=0,s=!1;const a=()=>s&&!i&&r.complete();n.subscribe(new qt(r,l=>{i?.unsubscribe();let h=0;const g=o++;Zt(t(l,g)).subscribe(i=new qt(r,m=>r.next(e?e(l,m,g,h++):m),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function kd(t){return Lt((e,n)=>{let r=!1;e.subscribe(new qt(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function B1(t=RO){return Lt((e,n)=>{let r=!1;e.subscribe(new qt(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function RO(){return new gc}function Qo(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Ao((i,o)=>t(i,o,r)):Ot,Oo(1),n?kd(e):B1(()=>new gc))}function hr(t,e,n){const r=ne(t)||e||n?{next:t,error:e,complete:n}:t;return r?Lt((i,o)=>{var s;null===(s=r.subscribe)||void 0===s||s.call(r);let a=!0;i.subscribe(new qt(o,l=>{var h;null===(h=r.next)||void 0===h||h.call(r,l),o.next(l)},()=>{var l;a=!1,null===(l=r.complete)||void 0===l||l.call(r),o.complete()},l=>{var h;a=!1,null===(h=r.error)||void 0===h||h.call(r,l),o.error(l)},()=>{var l,h;a&&(null===(l=r.unsubscribe)||void 0===l||l.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):Ot}function Xo(t){return Lt((e,n)=>{let o,r=null,i=!1;r=e.subscribe(new qt(n,void 0,void 0,s=>{o=Zt(t(s,Xo(t)(e))),r?(r.unsubscribe(),r=null,o.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(n))})}function NO(t,e,n,r,i){return(o,s)=>{let a=n,l=e,h=0;o.subscribe(new qt(s,g=>{const m=h++;l=a?t(l,g,m):(a=!0,g),r&&s.next(l)},i&&(()=>{a&&s.next(l),s.complete()})))}}function V1(t,e){return Lt(NO(t,e,arguments.length>=2,!0))}function vm(t){return t<=0?()=>ci:Lt((e,n)=>{let r=[];e.subscribe(new qt(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function U1(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Ao((i,o)=>t(i,o,r)):Ot,vm(1),n?kd(e):B1(()=>new gc))}function _m(t){return Lt((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}const wt="primary",yc=Symbol("RouteTitle");class jO{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function qa(t){return new jO(t)}function BO(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const s=r[o],a=t[o];if(s.startsWith(":"))i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function ro(t,e){const n=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!H1(t[i],e[i]))return!1;return!0}function H1(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((i,o)=>r[o]===i)}return t===e}function $1(t){return Array.prototype.concat.apply([],t)}function q1(t){return t.length>0?t[t.length-1]:null}function nr(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function es(t){return zp(t)?t:Zu(t)?un(Promise.resolve(t)):st(t)}const HO={exact:function K1(t,e,n){if(!Rs(t.segments,e.segments)||!Rd(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!K1(t.children[r],e.children[r],n))return!1;return!0},subset:W1},G1={exact:function $O(t,e){return ro(t,e)},subset:function qO(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>H1(t[n],e[n]))},ignored:()=>!0};function z1(t,e,n){return HO[n.paths](t.root,e.root,n.matrixParams)&&G1[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function W1(t,e,n){return J1(t,e,e.segments,n)}function J1(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!(!Rs(i,n)||e.hasChildren()||!Rd(i,n,r))}if(t.segments.length===n.length){if(!Rs(t.segments,n)||!Rd(t.segments,n,r))return!1;for(const i in e.children)if(!t.children[i]||!W1(t.children[i],e.children[i],r))return!1;return!0}{const i=n.slice(0,t.segments.length),o=n.slice(t.segments.length);return!!(Rs(t.segments,i)&&Rd(t.segments,i,r)&&t.children[wt])&&J1(t.children[wt],e,o,r)}}function Rd(t,e,n){return e.every((r,i)=>G1[n](t[i].parameters,r.parameters))}class ks{constructor(e,n,r){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=qa(this.queryParams)),this._queryParamMap}toString(){return KO.serialize(this)}}class Ct{constructor(e,n){this.segments=e,this.children=n,this.parent=null,nr(n,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Nd(this)}}class vc{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=qa(this.parameters)),this._parameterMap}toString(){return X1(this)}}function Rs(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}let Y1=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:function(){return new wm},providedIn:"root"}),t})();class wm{parse(e){const n=new nL(e);return new ks(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${_c(e.root,!0)}`,r=function YO(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(i=>`${Od(n)}=${Od(i)}`).join("&"):`${Od(n)}=${Od(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${r}${"string"==typeof e.fragment?`#${function WO(t){return encodeURI(t)}(e.fragment)}`:""}`}}const KO=new wm;function Nd(t){return t.segments.map(e=>X1(e)).join("/")}function _c(t,e){if(!t.hasChildren())return Nd(t);if(e){const n=t.children[wt]?_c(t.children[wt],!1):"",r=[];return nr(t.children,(i,o)=>{o!==wt&&r.push(`${o}:${_c(i,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function zO(t,e){let n=[];return nr(t.children,(r,i)=>{i===wt&&(n=n.concat(e(r,i)))}),nr(t.children,(r,i)=>{i!==wt&&(n=n.concat(e(r,i)))}),n}(t,(r,i)=>i===wt?[_c(t.children[wt],!1)]:[`${i}:${_c(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[wt]?`${Nd(t)}/${n[0]}`:`${Nd(t)}/(${n.join("//")})`}}function Z1(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Od(t){return Z1(t).replace(/%3B/gi,";")}function Sm(t){return Z1(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ld(t){return decodeURIComponent(t)}function Q1(t){return Ld(t.replace(/\+/g,"%20"))}function X1(t){return`${Sm(t.path)}${function JO(t){return Object.keys(t).map(e=>`;${Sm(e)}=${Sm(t[e])}`).join("")}(t.parameters)}`}const ZO=/^[^\/()?;=#]+/;function jd(t){const e=t.match(ZO);return e?e[0]:""}const QO=/^[^=?&#]+/,eL=/^[^&#]+/;class nL{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ct([],{}):new Ct([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[wt]=new Ct(e,n)),r}parseSegment(){const e=jd(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new E(4009,!1);return this.capture(e),new vc(Ld(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=jd(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=jd(this.remaining);i&&(r=i,this.capture(r))}e[Ld(n)]=Ld(r)}parseQueryParam(e){const n=function XO(t){const e=t.match(QO);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const s=function tL(t){const e=t.match(eL);return e?e[0]:""}(this.remaining);s&&(r=s,this.capture(r))}const i=Q1(n),o=Q1(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=jd(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new E(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=wt);const s=this.parseChildren();n[o]=1===Object.keys(s).length?s[wt]:new Ct([],s),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new E(4011,!1)}}function Cm(t){return t.segments.length>0?new Ct([],{[wt]:t}):t}function Bd(t){const e={};for(const r of Object.keys(t.children)){const o=Bd(t.children[r]);(o.segments.length>0||o.hasChildren())&&(e[r]=o)}return function rL(t){if(1===t.numberOfChildren&&t.children[wt]){const e=t.children[wt];return new Ct(t.segments.concat(e.segments),e.children)}return t}(new Ct(t.segments,e))}function Ns(t){return t instanceof ks}function sL(t,e,n,r,i){if(0===n.length)return Ga(e.root,e.root,e.root,r,i);const o=function nC(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new tC(!0,0,t);let e=0,n=!1;const r=t.reduce((i,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return nr(o.outlets,(l,h)=>{a[h]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===s?(o.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?n=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,o]},[]);return new tC(n,e,r)}(n);return o.toRoot()?Ga(e.root,e.root,new Ct([],{}),r,i):function s(l){const h=function uL(t,e,n,r){if(t.isAbsolute)return new za(e.root,!0,0);if(-1===r)return new za(n,n===e.root,0);return function rC(t,e,n){let r=t,i=e,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new E(4005,!1);i=r.segments.length}return new za(r,!1,i-o)}(n,r+(bc(t.commands[0])?0:1),t.numberOfDoubleDots)}(o,e,t.snapshot?._urlSegment,l),g=h.processChildren?Sc(h.segmentGroup,h.index,o.commands):xm(h.segmentGroup,h.index,o.commands);return Ga(e.root,h.segmentGroup,g,r,i)}(t.snapshot?._lastPathIndex)}function bc(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function wc(t){return"object"==typeof t&&null!=t&&t.outlets}function Ga(t,e,n,r,i){let s,o={};r&&nr(r,(l,h)=>{o[h]=Array.isArray(l)?l.map(g=>`${g}`):`${l}`}),s=t===e?n:eC(t,e,n);const a=Cm(Bd(s));return new ks(a,o,i)}function eC(t,e,n){const r={};return nr(t.children,(i,o)=>{r[o]=i===e?n:eC(i,e,n)}),new Ct(t.segments,r)}class tC{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&bc(r[0]))throw new E(4003,!1);const i=r.find(wc);if(i&&i!==q1(r))throw new E(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class za{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function xm(t,e,n){if(t||(t=new Ct([],{})),0===t.segments.length&&t.hasChildren())return Sc(t,e,n);const r=function lL(t,e,n){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;const s=t.segments[i],a=n[r];if(wc(a))break;const l=`${a}`,h=r<n.length-1?n[r+1]:null;if(i>0&&void 0===l)break;if(l&&h&&"object"==typeof h&&void 0===h.outlets){if(!oC(l,h,s))return o;r+=2}else{if(!oC(l,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const o=new Ct(t.segments.slice(0,r.pathIndex),{});return o.children[wt]=new Ct(t.segments.slice(r.pathIndex),t.children),Sc(o,0,i)}return r.match&&0===i.length?new Ct(t.segments,{}):r.match&&!t.hasChildren()?Dm(t,e,n):r.match?Sc(t,0,i):Dm(t,e,n)}function Sc(t,e,n){if(0===n.length)return new Ct(t.segments,{});{const r=function cL(t){return wc(t[0])?t[0].outlets:{[wt]:t}}(n),i={};return nr(r,(o,s)=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=xm(t.children[s],e,o))}),nr(t.children,(o,s)=>{void 0===r[s]&&(i[s]=o)}),new Ct(t.segments,i)}}function Dm(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const o=n[i];if(wc(o)){const l=dL(o.outlets);return new Ct(r,l)}if(0===i&&bc(n[0])){r.push(new vc(t.segments[e].path,iC(n[0]))),i++;continue}const s=wc(o)?o.outlets[wt]:`${o}`,a=i<n.length-1?n[i+1]:null;s&&a&&bc(a)?(r.push(new vc(s,iC(a))),i+=2):(r.push(new vc(s,{})),i++)}return new Ct(r,{})}function dL(t){const e={};return nr(t,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(e[r]=Dm(new Ct([],{}),0,n))}),e}function iC(t){const e={};return nr(t,(n,r)=>e[r]=`${n}`),e}function oC(t,e,n){return t==n.path&&ro(e,n.parameters)}class Io{constructor(e,n){this.id=e,this.url=n}}class Am extends Io{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Os extends Io{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Vd extends Io{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class sC extends Io{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class hL extends Io{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fL extends Io{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pL extends Io{constructor(e,n,r,i,o){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class gL extends Io{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mL extends Io{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yL{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class vL{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class _L{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bL{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wL{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class SL{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class aC{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class uC{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=Im(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=Im(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=Fm(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Fm(e,this._root).map(n=>n.value)}}function Im(t,e){if(t===e.value)return e;for(const n of e.children){const r=Im(t,n);if(r)return r}return null}function Fm(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Fm(t,n);if(r.length)return r.unshift(e),r}return[]}class Fo{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Ka(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class cC extends uC{constructor(e,n){super(e),this.snapshot=n,Tm(this,e)}toString(){return this.snapshot.toString()}}function lC(t,e){const n=function EL(t,e){const s=new Ud([],{},{},"",{},wt,e,null,t.root,-1,{});return new hC("",new Fo(s,[]))}(t,e),r=new Ni([new vc("",{})]),i=new Ni({}),o=new Ni({}),s=new Ni({}),a=new Ni(""),l=new ts(r,i,s,a,o,wt,e,n.root);return l.snapshot=n.root,new cC(new Fo(l,[]),n)}class ts{constructor(e,n,r,i,o,s,a,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.title=this.data?.pipe(at(h=>h[yc]))??st(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(at(e=>qa(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(at(e=>qa(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function dC(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const i=n[r],o=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function xL(t){return t.reduce((e,n)=>({params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.resolve,...n.routeConfig?.data,...n._resolvedData}}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Ud{constructor(e,n,r,i,o,s,a,l,h,g,m,C){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.title=this.data?.[yc],this.routeConfig=l,this._urlSegment=h,this._lastPathIndex=g,this._correctedLastPathIndex=C??g,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=qa(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=qa(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class hC extends uC{constructor(e,n){super(n),this.url=e,Tm(this,n)}toString(){return fC(this._root)}}function Tm(t,e){e.value._routerState=t,e.children.forEach(n=>Tm(t,n))}function fC(t){const e=t.children.length>0?` { ${t.children.map(fC).join(", ")} } `:"";return`${t.value}${e}`}function Mm(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,ro(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),ro(e.params,n.params)||t.params.next(n.params),function VO(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!ro(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),ro(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Pm(t,e){const n=ro(t.params,e.params)&&function GO(t,e){return Rs(t,e)&&t.every((n,r)=>ro(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||Pm(t.parent,e.parent))}function Cc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function AL(t,e,n){return e.children.map(r=>{for(const i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Cc(t,r,i);return Cc(t,r)})}(t,e,n);return new Fo(r,i)}{if(t.shouldAttach(e.value)){const o=t.retrieve(e.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Cc(t,a)),s}}const r=function IL(t){return new ts(new Ni(t.url),new Ni(t.params),new Ni(t.queryParams),new Ni(t.fragment),new Ni(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(o=>Cc(t,o));return new Fo(r,i)}}const km="ngNavigationCancelingError";function pC(t,e){const{redirectTo:n,navigationBehaviorOptions:r}=Ns(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=gC(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function gC(t,e,n){const r=new Error("NavigationCancelingError: "+(t||""));return r[km]=!0,r.cancellationCode=e,n&&(r.url=n),r}function mC(t){return yC(t)&&Ns(t.url)}function yC(t){return t&&t[km]}class FL{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ec,this.attachRef=null}}let Ec=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new FL,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Hd=!1;let Rm=(()=>{class t{constructor(n,r,i,o,s){this.parentContexts=n,this.location=r,this.changeDetector=o,this.environmentInjector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new Rt,this.deactivateEvents=new Rt,this.attachEvents=new Rt,this.detachEvents=new Rt,this.name=i||wt,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new E(4012,Hd);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new E(4012,Hd);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new E(4012,Hd);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new E(4013,Hd);this._activatedRoute=n;const i=this.location,s=n._futureSnapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new TL(n,a,i.injector);if(r&&function ML(t){return!!t.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(s);this.activated=i.createComponent(h,i.length,l)}else this.activated=i.createComponent(s,{index:i.length,injector:l,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(n){return new(n||t)(De(Ec),De(Mi),function Du(t){return function dA(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const r=n.length;let i=0;for(;i<r;){const o=n[i];if(b0(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(o===e)return n[i+1];i+=2}}}return null}(Bn(),t)}("name"),De(ld),De(Go))},t.\u0275dir=dt({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),t})();class TL{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===ts?this.route:e===Ec?this.childContexts:this.parent.get(e,n)}}let Nm=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["ng-component"]],standalone:!0,features:[yw],decls:1,vars:0,template:function(n,r){1&n&&tr(0,"router-outlet")},dependencies:[Rm],encapsulation:2}),t})();function vC(t,e){return t.providers&&!t._injector&&(t._injector=td(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Lm(t){const e=t.children&&t.children.map(Lm),n=e?{...t,children:e}:{...t};return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==wt&&(n.component=Nm),n}function vi(t){return t.outlet||wt}function _C(t,e){const n=t.filter(r=>vi(r)===e);return n.push(...t.filter(r=>vi(r)!==e)),n}function xc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class OL{constructor(e,n,r,i){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Mm(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const i=Ka(n);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),nr(i,(o,s)=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,n,r){const i=e.value,o=n?n.value:null;if(i===o)if(i.component){const s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,n,s.children)}else this.deactivateChildRoutes(e,n,r);else o&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,o=Ka(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);if(r&&r.outlet){const s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,o=Ka(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,n,r){const i=Ka(n);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new SL(o.value.snapshot))}),e.children.length&&this.forwardEvent(new bL(e.value.snapshot))}activateRoutes(e,n,r){const i=e.value,o=n?n.value:null;if(Mm(i),i===o)if(i.component){const s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,s.children)}else this.activateChildRoutes(e,n,r);else if(i.component){const s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Mm(a.route.value),this.activateChildRoutes(e,null,s.children)}else{const a=xc(i.snapshot),l=a?.get($u)??null;s.attachRef=null,s.route=i,s.resolver=l,s.injector=a,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,r)}}class bC{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class $d{constructor(e,n){this.component=e,this.route=n}}function LL(t,e,n){const r=t._root;return Dc(r,e?e._root:null,n,[r.value])}function Wa(t,e){const n=Symbol(),r=e.get(t,n);return r===n?"function"!=typeof t||function ps(t){return null!==kn(t)}(t)?e.get(t):t:r}function Dc(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=Ka(e);return t.children.forEach(s=>{(function BL(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=t.value,s=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const l=function VL(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Rs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Rs(t.url,e.url)||!ro(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Pm(t,e)||!ro(t.queryParams,e.queryParams);default:return!Pm(t,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new bC(r)):(o.data=s.data,o._resolvedData=s._resolvedData),Dc(t,e,o.component?a?a.children:null:n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new $d(a.outlet.component,s))}else s&&Ac(e,a,i),i.canActivateChecks.push(new bC(r)),Dc(t,null,o.component?a?a.children:null:n,r,i)})(s,o[s.value.outlet],n,r.concat([s.value]),i),delete o[s.value.outlet]}),nr(o,(s,a)=>Ac(s,n.getContext(a),i)),i}function Ac(t,e,n){const r=Ka(t),i=t.value;nr(r,(o,s)=>{Ac(o,i.component?e?e.children.getContext(s):null:e,n)}),n.canDeactivateChecks.push(new $d(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Ic(t){return"function"==typeof t}function jm(t){return t instanceof gc||"EmptyError"===t?.name}const qd=Symbol("INITIAL_VALUE");function Ja(){return no(t=>N1(t.map(e=>e.pipe(Oo(1),function kO(...t){const e=No(t);return Lt((n,r)=>{(e?mm(t,n,e):mm(t,n)).subscribe(r)})}(qd)))).pipe(at(e=>{for(const n of e)if(!0!==n){if(n===qd)return qd;if(!1===n||n instanceof ks)return n}return!0}),Ao(e=>e!==qd),Oo(1)))}function wC(t){return function zn(...t){return en(t)}(hr(e=>{if(Ns(e))throw pC(0,e)}),at(e=>!0===e))}const Bm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function SC(t,e,n,r,i){const o=Vm(t,e,n);return o.matched?function r3(t,e,n,r){const i=e.canMatch;return i&&0!==i.length?st(i.map(s=>{const a=Wa(s,t);return es(function zL(t){return t&&Ic(t.canMatch)}(a)?a.canMatch(e,n):t.runInContext(()=>a(e,n)))})).pipe(Ja(),wC()):st(!0)}(r=vC(e,r),e,n).pipe(at(s=>!0===s?o:{...Bm})):st(o)}function Vm(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{...Bm}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const i=(e.matcher||BO)(n,t,e);if(!i)return{...Bm};const o={};nr(i.posParams,(a,l)=>{o[l]=a.path});const s=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function Gd(t,e,n,r,i="corrected"){if(n.length>0&&function s3(t,e,n){return n.some(r=>zd(t,e,r)&&vi(r)!==wt)}(t,n,r)){const s=new Ct(e,function o3(t,e,n,r){const i={};i[wt]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&vi(o)!==wt){const s=new Ct([],{});s._sourceSegment=t,s._segmentIndexShift=e.length,i[vi(o)]=s}return i}(t,e,r,new Ct(n,t.children)));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===n.length&&function a3(t,e,n){return n.some(r=>zd(t,e,r))}(t,n,r)){const s=new Ct(t.segments,function i3(t,e,n,r,i,o){const s={};for(const a of r)if(zd(t,n,a)&&!i[vi(a)]){const l=new Ct([],{});l._sourceSegment=t,l._segmentIndexShift="legacy"===o?t.segments.length:e.length,s[vi(a)]=l}return{...i,...s}}(t,e,n,r,t.children,i));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}const o=new Ct(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}function zd(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function CC(t,e,n,r){return!!(vi(t)===r||r!==wt&&zd(e,n,t))&&("**"===t.path||Vm(e,t,n).matched)}function EC(t,e,n){return 0===e.length&&!t.children[n]}const Kd=!1;class Wd{constructor(e){this.segmentGroup=e||null}}class xC{constructor(e){this.urlTree=e}}function Fc(t){return mc(new Wd(t))}function DC(t){return mc(new xC(t))}class d3{constructor(e,n,r,i,o){this.injector=e,this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0}apply(){const e=Gd(this.urlTree.root,[],[],this.config).segmentGroup,n=new Ct(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,n,wt).pipe(at(o=>this.createUrlTree(Bd(o),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Xo(o=>{if(o instanceof xC)return this.allowRedirects=!1,this.match(o.urlTree);throw o instanceof Wd?this.noMatchError(o):o}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,wt).pipe(at(i=>this.createUrlTree(Bd(i),e.queryParams,e.fragment))).pipe(Xo(i=>{throw i instanceof Wd?this.noMatchError(i):i}))}noMatchError(e){return new E(4002,Kd)}createUrlTree(e,n,r){const i=Cm(e);return new ks(i,n,r)}expandSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,n,r).pipe(at(o=>new Ct([],o))):this.expandSegment(e,r,n,r.segments,i,!0)}expandChildren(e,n,r){const i=[];for(const o of Object.keys(r.children))"primary"===o?i.unshift(o):i.push(o);return un(i).pipe(Yo(o=>{const s=r.children[o],a=_C(n,o);return this.expandSegmentGroup(e,a,s,o).pipe(at(l=>({segment:l,outlet:o})))}),V1((o,s)=>(o[s.outlet]=s.segment,o),{}),U1())}expandSegment(e,n,r,i,o,s){return un(r).pipe(Yo(a=>this.expandSegmentAgainstRoute(e,n,r,a,i,o,s).pipe(Xo(h=>{if(h instanceof Wd)return st(null);throw h}))),Qo(a=>!!a),Xo((a,l)=>{if(jm(a))return EC(n,i,o)?st(new Ct([],{})):Fc(n);throw a}))}expandSegmentAgainstRoute(e,n,r,i,o,s,a){return CC(i,n,o,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,n,i,o,s):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,n,r,i,o,s):Fc(n):Fc(n)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,o,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,o,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,i){const o=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?DC(o):this.lineralizeSegments(r,o).pipe(Sn(s=>{const a=new Ct(s,{});return this.expandSegment(e,a,n,s,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,o,s){const{matched:a,consumedSegments:l,remainingSegments:h,positionalParamSegments:g}=Vm(n,i,o);if(!a)return Fc(n);const m=this.applyRedirectCommands(l,i.redirectTo,g);return i.redirectTo.startsWith("/")?DC(m):this.lineralizeSegments(i,m).pipe(Sn(C=>this.expandSegment(e,n,r,C.concat(h),s,!1)))}matchSegmentAgainstRoute(e,n,r,i,o){return"**"===r.path?(e=vC(r,e),r.loadChildren?(r._loadedRoutes?st({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe(at(a=>(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,new Ct(i,{})))):st(new Ct(i,{}))):SC(n,r,i,e).pipe(no(({matched:s,consumedSegments:a,remainingSegments:l})=>s?this.getChildConfig(e=r._injector??e,r,i).pipe(Sn(g=>{const m=g.injector??e,C=g.routes,{segmentGroup:D,slicedSegments:q}=Gd(n,a,l,C),he=new Ct(D.segments,D.children);if(0===q.length&&he.hasChildren())return this.expandChildren(m,C,he).pipe(at(Ce=>new Ct(a,Ce)));if(0===C.length&&0===q.length)return st(new Ct(a,{}));const Se=vi(r)===o;return this.expandSegment(m,he,C,q,Se?wt:o,!0).pipe(at(Fe=>new Ct(a.concat(Fe.segments),Fe.children)))})):Fc(n)))}getChildConfig(e,n,r){return n.children?st({routes:n.children,injector:e}):n.loadChildren?void 0!==n._loadedRoutes?st({routes:n._loadedRoutes,injector:n._loadedInjector}):function n3(t,e,n,r){const i=e.canLoad;return void 0===i||0===i.length?st(!0):st(i.map(s=>{const a=Wa(s,t);return es(function HL(t){return t&&Ic(t.canLoad)}(a)?a.canLoad(e,n):t.runInContext(()=>a(e,n)))})).pipe(Ja(),wC())}(e,n,r).pipe(Sn(i=>i?this.configLoader.loadChildren(e,n).pipe(hr(o=>{n._loadedRoutes=o.routes,n._loadedInjector=o.injector})):function c3(t){return mc(gC(Kd,3))}())):st({routes:[],injector:e})}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return st(r);if(i.numberOfChildren>1||!i.children[wt])return mc(new E(4e3,Kd));i=i.children[wt]}}applyRedirectCommands(e,n,r){return this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r)}applyRedirectCreateUrlTree(e,n,r,i){const o=this.createSegmentGroup(e,n.root,r,i);return new ks(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return nr(e,(i,o)=>{if("string"==typeof i&&i.startsWith(":")){const a=i.substring(1);r[o]=n[a]}else r[o]=i}),r}createSegmentGroup(e,n,r,i){const o=this.createSegments(e,n.segments,r,i);let s={};return nr(n.children,(a,l)=>{s[l]=this.createSegmentGroup(e,a,r,i)}),new Ct(o,s)}createSegments(e,n,r,i){return n.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,n,r){const i=r[n.path.substring(1)];if(!i)throw new E(4001,Kd);return i}findOrReturn(e,n){let r=0;for(const i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}}class f3{}class m3{constructor(e,n,r,i,o,s,a,l){this.injector=e,this.rootComponentType=n,this.config=r,this.urlTree=i,this.url=o,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=a,this.urlSerializer=l}recognize(){const e=Gd(this.urlTree.root,[],[],this.config.filter(n=>void 0===n.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,wt).pipe(at(n=>{if(null===n)return null;const r=new Ud([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},wt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Fo(r,n),o=new hC(this.url,i);return this.inheritParamsAndData(o._root),o}))}inheritParamsAndData(e){const n=e.value,r=dC(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i)}processChildren(e,n,r){return un(Object.keys(r.children)).pipe(Yo(i=>{const o=r.children[i],s=_C(n,i);return this.processSegmentGroup(e,s,o,i)}),V1((i,o)=>i&&o?(i.push(...o),i):null),function OO(t,e=!1){return Lt((n,r)=>{let i=0;n.subscribe(new qt(r,o=>{const s=t(o,i++);(s||e)&&r.next(o),!s&&r.complete()}))})}(i=>null!==i),kd(null),U1(),at(i=>{if(null===i)return null;const o=AC(i);return function y3(t){t.sort((e,n)=>e.value.outlet===wt?-1:n.value.outlet===wt?1:e.value.outlet.localeCompare(n.value.outlet))}(o),o}))}processSegment(e,n,r,i,o){return un(n).pipe(Yo(s=>this.processSegmentAgainstRoute(s._injector??e,s,r,i,o)),Qo(s=>!!s),Xo(s=>{if(jm(s))return EC(r,i,o)?st([]):st(null);throw s}))}processSegmentAgainstRoute(e,n,r,i,o){if(n.redirectTo||!CC(n,r,i,o))return st(null);let s;if("**"===n.path){const a=i.length>0?q1(i).parameters:{},l=FC(r)+i.length;s=st({snapshot:new Ud(i,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,MC(n),vi(n),n.component??n._loadedComponent??null,n,IC(r),l,PC(n),l),consumedSegments:[],remainingSegments:[]})}else s=SC(r,n,i,e).pipe(at(({matched:a,consumedSegments:l,remainingSegments:h,parameters:g})=>{if(!a)return null;const m=FC(r)+l.length;return{snapshot:new Ud(l,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,MC(n),vi(n),n.component??n._loadedComponent??null,n,IC(r),m,PC(n),m),consumedSegments:l,remainingSegments:h}}));return s.pipe(no(a=>{if(null===a)return st(null);const{snapshot:l,consumedSegments:h,remainingSegments:g}=a;e=n._injector??e;const m=n._loadedInjector??e,C=function v3(t){return t.children?t.children:t.loadChildren?t._loadedRoutes:[]}(n),{segmentGroup:D,slicedSegments:q}=Gd(r,h,g,C.filter(Se=>void 0===Se.redirectTo),this.relativeLinkResolution);if(0===q.length&&D.hasChildren())return this.processChildren(m,C,D).pipe(at(Se=>null===Se?null:[new Fo(l,Se)]));if(0===C.length&&0===q.length)return st([new Fo(l,[])]);const he=vi(n)===o;return this.processSegment(m,C,D,q,he?wt:o).pipe(at(Se=>null===Se?null:[new Fo(l,Se)]))}))}}function _3(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function AC(t){const e=[],n=new Set;for(const r of t){if(!_3(r)){e.push(r);continue}const i=e.find(o=>r.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):e.push(r)}for(const r of n){const i=AC(r.children);e.push(new Fo(r.value,i))}return e.filter(r=>!n.has(r))}function IC(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function FC(t){let e=t,n=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift??0;return n-1}function MC(t){return t.data||{}}function PC(t){return t.resolve||{}}function kC(t){return"string"==typeof t.title||null===t.title}function Um(t){return no(e=>{const n=t(e);return n?un(n).pipe(at(()=>e)):st(e)})}let RC=(()=>{class t{buildTitle(n){let r,i=n.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===wt);return r}getResolvedTitleForRoute(n){return n.data[yc]}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:function(){return pn(NC)},providedIn:"root"}),t})(),NC=(()=>{class t extends RC{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}}return t.\u0275fac=function(n){return new(n||t)(Je(b1))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class A3{}class F3 extends class I3{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}{}const Yd=new ot("",{providedIn:"root",factory:()=>({})}),Hm=new ot("ROUTES");let $m=(()=>{class t{constructor(n,r){this.injector=n,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return st(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=es(n.loadComponent()).pipe(hr(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),_m(()=>{this.componentLoaders.delete(n)})),i=new j1(r,()=>new $t).pipe(ym());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return st({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const o=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(at(a=>{this.onLoadEndListener&&this.onLoadEndListener(r);let l,h,g=!1;Array.isArray(a)?h=a:(l=a.create(n).injector,h=$1(l.get(Hm,[],rt.Self|rt.Optional)));return{routes:h.map(Lm),injector:l}}),_m(()=>{this.childrenLoaders.delete(r)})),s=new j1(o,()=>new $t).pipe(ym());return this.childrenLoaders.set(r,s),s}loadModuleFactoryOrRoutes(n){return es(n()).pipe(Sn(r=>r instanceof gw||Array.isArray(r)?st(r):un(this.compiler.compileModuleAsync(r))))}}return t.\u0275fac=function(n){return new(n||t)(Je(Qr),Je(Sg))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class M3{}class P3{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}}function k3(t){throw t}function R3(t,e,n){return e.parse("/")}const N3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},O3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function LC(){const t=pn(Y1),e=pn(Ec),n=pn(Lg),r=pn(Qr),i=pn(Sg),o=pn(Hm,{optional:!0})??[],s=pn(Yd,{optional:!0})??{},a=pn(NC),l=pn(RC,{optional:!0}),h=pn(M3,{optional:!0}),g=pn(A3,{optional:!0}),m=new mn(null,t,e,n,r,i,$1(o));return h&&(m.urlHandlingStrategy=h),g&&(m.routeReuseStrategy=g),m.titleStrategy=l??a,function L3(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(e.canceledNavigationResolution=t.canceledNavigationResolution)}(s,m),m}let mn=(()=>{class t{constructor(n,r,i,o,s,a,l){this.rootComponentType=n,this.urlSerializer=r,this.rootContexts=i,this.location=o,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new $t,this.errorHandler=k3,this.malformedUriErrorHandler=R3,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>st(void 0),this.urlHandlingStrategy=new P3,this.routeReuseStrategy=new F3,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=s.get($m),this.configLoader.onLoadEndListener=C=>this.triggerEvent(new vL(C)),this.configLoader.onLoadStartListener=C=>this.triggerEvent(new yL(C)),this.ngModule=s.get(Ts),this.console=s.get(JP);const m=s.get($n);this.isNgZoneEnabled=m instanceof $n&&$n.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function UO(){return new ks(new Ct([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=lC(this.currentUrlTree,this.rootComponentType),this.transitions=new Ni({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(n){const r=this.events;return n.pipe(Ao(i=>0!==i.id),at(i=>({...i,extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),no(i=>{let o=!1,s=!1;return st(i).pipe(hr(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),no(a=>{const l=this.browserUrlTree.toString(),h=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return jC(a.source)&&(this.browserUrlTree=a.extractedUrl),st(a).pipe(no(m=>{const C=this.transitions.getValue();return r.next(new Am(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),C!==this.transitions.getValue()?ci:Promise.resolve(m)}),function h3(t,e,n,r){return no(i=>function l3(t,e,n,r,i){return new d3(t,e,n,r,i).apply()}(t,e,n,i.extractedUrl,r).pipe(at(o=>({...i,urlAfterRedirects:o}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),hr(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},i.urlAfterRedirects=m.urlAfterRedirects}),function w3(t,e,n,r,i,o){return Sn(s=>function g3(t,e,n,r,i,o,s="emptyOnly",a="legacy"){return new m3(t,e,n,r,i,s,a,o).recognize().pipe(no(l=>null===l?function p3(t){return new It(e=>e.error(t))}(new f3):st(l)))}(t,e,n,s.urlAfterRedirects,r.serialize(s.urlAfterRedirects),r,i,o).pipe(at(a=>({...s,targetSnapshot:a}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),hr(m=>{if(i.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const D=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(D,m)}this.browserUrlTree=m.urlAfterRedirects}const C=new hL(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(C)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:C,extractedUrl:D,source:q,restoredState:he,extras:Se}=a,xe=new Am(C,this.serializeUrl(D),q,he);r.next(xe);const Fe=lC(D,this.rootComponentType).snapshot;return st(i={...a,targetSnapshot:Fe,urlAfterRedirects:D,extras:{...Se,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=a.rawUrl,a.resolve(null),ci}),hr(a=>{const l=new fL(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),at(a=>i={...a,guards:LL(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function WL(t,e){return Sn(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?st({...n,guardsResult:!0}):function JL(t,e,n,r){return un(t).pipe(Sn(i=>function t3(t,e,n,r,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?st(o.map(a=>{const l=xc(e)??i,h=Wa(a,l);return es(function GL(t){return t&&Ic(t.canDeactivate)}(h)?h.canDeactivate(t,e,n,r):l.runInContext(()=>h(t,e,n,r))).pipe(Qo())})).pipe(Ja()):st(!0)}(i.component,i.route,n,e,r)),Qo(i=>!0!==i,!0))}(s,r,i,t).pipe(Sn(a=>a&&function UL(t){return"boolean"==typeof t}(a)?function YL(t,e,n,r){return un(e).pipe(Yo(i=>mm(function QL(t,e){return null!==t&&e&&e(new _L(t)),st(!0)}(i.route.parent,r),function ZL(t,e){return null!==t&&e&&e(new wL(t)),st(!0)}(i.route,r),function e3(t,e,n){const r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function jL(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(s)).filter(s=>null!==s).map(s=>L1(()=>st(s.guards.map(l=>{const h=xc(s.node)??n,g=Wa(l,h);return es(function qL(t){return t&&Ic(t.canActivateChild)}(g)?g.canActivateChild(r,t):h.runInContext(()=>g(r,t))).pipe(Qo())})).pipe(Ja())));return st(o).pipe(Ja())}(t,i.path,n),function XL(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return st(!0);const i=r.map(o=>L1(()=>{const s=xc(e)??n,a=Wa(o,s);return es(function $L(t){return t&&Ic(t.canActivate)}(a)?a.canActivate(e,t):s.runInContext(()=>a(e,t))).pipe(Qo())}));return st(i).pipe(Ja())}(t,i.route,n))),Qo(i=>!0!==i,!0))}(r,o,t,e):st(a)),at(a=>({...n,guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),hr(a=>{if(i.guardsResult=a.guardsResult,Ns(a.guardsResult))throw pC(0,a.guardsResult);const l=new pL(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),Ao(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),Um(a=>{if(a.guards.canActivateChecks.length)return st(a).pipe(hr(l=>{const h=new gL(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(h)}),no(l=>{let h=!1;return st(l).pipe(function S3(t,e){return Sn(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return st(n);let o=0;return un(i).pipe(Yo(s=>function C3(t,e,n,r){const i=t.routeConfig,o=t._resolve;return void 0!==i?.title&&!kC(i)&&(o[yc]=i.title),function E3(t,e,n,r){const i=function x3(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===i.length)return st({});const o={};return un(i).pipe(Sn(s=>function D3(t,e,n,r){const i=xc(e)??r,o=Wa(t,i);return es(o.resolve?o.resolve(e,n):i.runInContext(()=>o(e,n)))}(t[s],e,n,r).pipe(Qo(),hr(a=>{o[s]=a}))),vm(1),function LO(t){return at(()=>t)}(o),Xo(s=>jm(s)?ci:mc(s)))}(o,t,e,r).pipe(at(s=>(t._resolvedData=s,t.data=dC(t,n).resolve,i&&kC(i)&&(t.data[yc]=i.title),null)))}(s.route,r,t,e)),hr(()=>o++),vm(1),Sn(s=>o===i.length?st(n):ci))})}(this.paramsInheritanceStrategy,this.ngModule.injector),hr({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(l),this.cancelNavigationTransition(l,"",2))}}))}),hr(l=>{const h=new mL(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(h)}))}),Um(a=>{const l=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(hr(m=>{h.component=m}),at(()=>{})));for(const m of h.children)g.push(...l(m));return g};return N1(l(a.targetSnapshot.root)).pipe(kd(),Oo(1))}),Um(()=>this.afterPreactivation()),at(a=>{const l=function DL(t,e,n){const r=Cc(t,e._root,n?n._root:void 0);return new cC(r,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return i={...a,targetRouterState:l}}),hr(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((t,e,n)=>at(r=>(new OL(e,r.targetRouterState,r.currentRouterState,n).activate(t),r)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),hr({next(){o=!0},complete(){o=!0}}),_m(()=>{o||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Xo(a=>{if(s=!0,yC(a)){mC(a)||(this.navigated=!0,this.restoreHistory(i,!0));const l=new Vd(i.id,this.serializeUrl(i.extractedUrl),a.message,a.cancellationCode);if(r.next(l),mC(a)){const h=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),g={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||jC(i.source)};this.scheduleNavigation(h,"imperative",null,g,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{this.restoreHistory(i,!0);const l=new sC(i.id,this.serializeUrl(i.extractedUrl),a,i.targetSnapshot??void 0);r.next(l);try{i.resolve(this.errorHandler(a))}catch(h){i.reject(h)}}return ci}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next({...this.transitions.value,...n})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const i={replaceUrl:!0},o=n.state?.navigationId?n.state:null;if(o){const a={...o};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(i.state=a)}const s=this.parseUrl(n.url);this.scheduleNavigation(s,r,o,i)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){this.config=n.map(Lm),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,r={}){const{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=r,h=i||this.routerState.root,g=l?this.currentUrlTree.fragment:s;let m=null;switch(a){case"merge":m={...this.currentUrlTree.queryParams,...o};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=o||null}return null!==m&&(m=this.removeEmptyProps(m)),sL(h,this.currentUrlTree,n,m,g??null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=Ns(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,"imperative",null,r)}navigate(n,r={skipLocationChange:!1}){return function j3(t){for(let e=0;e<t.length;e++){if(null==t[e])throw new E(4008,false)}}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,n)}return r}isActive(n,r){let i;if(i=!0===r?{...N3}:!1===r?{...O3}:r,Ns(n))return z1(this.currentUrlTree,n,i);const o=this.parseUrl(n);return z1(this.currentUrlTree,o,i)}removeEmptyProps(n){return Object.keys(n).reduce((r,i)=>{const o=n[i];return null!=o&&(r[i]=o),r},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new Os(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,h;s?(a=s.resolve,l=s.reject,h=s.promise):h=new Promise((C,D)=>{a=C,l=D});const g=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),m=i&&i.\u0275routerPageId?i.\u0275routerPageId:o.replaceUrl||o.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:g,targetPageId:m,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:o,resolve:a,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(C=>Promise.reject(C))}setBrowserUrl(n,r){const i=this.urlSerializer.serialize(n),o={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",o):this.location.go(i,"",o)}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===i?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===i&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,r,i){const o=new Vd(n.id,this.serializeUrl(n.extractedUrl),r,i);this.triggerEvent(o),n.resolve(!1)}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}}return t.\u0275fac=function(n){bp()},t.\u0275prov=Ve({token:t,factory:function(){return LC()},providedIn:"root"}),t})();function jC(t){return"imperative"!==t}class BC{}let U3=(()=>{class t{constructor(n,r,i,o,s){this.router=n,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Ao(n=>n instanceof Os),Yo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const o of r){o.providers&&!o._injector&&(o._injector=td(o.providers,n,`Route: ${o.path}`));const s=o._injector??n,a=o._loadedInjector??s;o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent?i.push(this.preloadConfig(s,o)):(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return un(i).pipe(Ci())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):st(null);const o=i.pipe(Sn(s=>null===s?st(void 0):(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,this.processRoutes(s.injector??n,s.routes))));return r.loadComponent&&!r._loadedComponent?un([o,this.loader.loadComponent(r)]).pipe(Ci()):o})}}return t.\u0275fac=function(n){return new(n||t)(Je(mn),Je(Sg),Je(Go),Je(BC),Je($m))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const zm=new ot("");let VC=(()=>{class t{constructor(n,r,i={}){this.router=n,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof Am?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Os&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof aC&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.router.triggerEvent(new aC(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(n){bp()},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();function Ya(t,e){return{\u0275kind:t,\u0275providers:e}}function Km(t){return[{provide:Hm,multi:!0,useValue:t}]}function HC(){const t=pn(Qr);return e=>{const n=t.get(ud);if(e!==n.components[0])return;const r=t.get(mn),i=t.get($C);1===t.get(Wm)&&r.initialNavigation(),t.get(qC,null,rt.Optional)?.setUpPreloading(),t.get(zm,null,rt.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.unsubscribe())}}const $C=new ot("",{factory:()=>new $t}),Wm=new ot("",{providedIn:"root",factory:()=>1});const qC=new ot("");function G3(t){return Ya(0,[{provide:qC,useExisting:U3},{provide:BC,useExisting:t}])}const GC=new ot("ROUTER_FORROOT_GUARD"),z3=[Lg,{provide:Y1,useClass:wm},{provide:mn,useFactory:LC},Ec,{provide:ts,useFactory:function UC(t){return t.routerState.root},deps:[mn]},$m];function K3(){return new lS("Router",mn)}let zC=(()=>{class t{constructor(n){}static forRoot(n,r){return{ngModule:t,providers:[z3,[],Km(n),{provide:GC,useFactory:Z3,deps:[[mn,new ku,new Ru]]},{provide:Yd,useValue:r||{}},r?.useHash?{provide:Ps,useClass:Lk}:{provide:Ps,useClass:NS},{provide:zm,useFactory:()=>{const t=pn(mn),e=pn(rN),n=pn(Yd);return n.scrollOffset&&e.setOffset(n.scrollOffset),new VC(t,e,n)}},r?.preloadingStrategy?G3(r.preloadingStrategy).\u0275providers:[],{provide:lS,multi:!0,useFactory:K3},r?.initialNavigation?Q3(r):[],[{provide:KC,useFactory:HC},{provide:rS,multi:!0,useExisting:KC}]]}}static forChild(n){return{ngModule:t,providers:[Km(n)]}}}return t.\u0275fac=function(n){return new(n||t)(Je(GC,8))},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({imports:[Nm]}),t})();function Z3(t){return"guarded"}function Q3(t){return["disabled"===t.initialNavigation?Ya(3,[{provide:od,multi:!0,useFactory:()=>{const e=pn(mn);return()=>{e.setUpLocationChangeListener()}}},{provide:Wm,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Ya(2,[{provide:Wm,useValue:0},{provide:od,multi:!0,deps:[Qr],useFactory:e=>{const n=e.get(Nk,Promise.resolve());let r=!1;return()=>n.then(()=>new Promise(o=>{const s=e.get(mn),a=e.get($C);(function i(o){e.get(mn).events.pipe(Ao(a=>a instanceof Os||a instanceof Vd||a instanceof sC),at(a=>a instanceof Os||a instanceof Vd&&(0===a.code||1===a.code)&&null),Ao(a=>null!==a),Oo(1)).subscribe(()=>{o()})})(()=>{o(!0),r=!0}),s.afterPreactivation=()=>(o(!0),r||a.closed?st(void 0):a),s.initialNavigation()}))}}]).\u0275providers:[]]}const KC=new ot("");let yn=(()=>{class t{}return t.clientRoot="https://tic-tac-toe.codeplaza.dev/",t.stsAuthority="https://identity.codeplaza.dev/",t.playerAccounDomain="https://player-account.codeplaza.dev",t.tttApiTarget="ttt-api",t.playerAccounTarget="player-account",t.resourceApiRoot="/api",t})(),Jm=(()=>{class t{constructor(n){this._httpClient=n,this._httpOptions={headers:new ei({"Content-Type":"application/json"})}}getGames(){return this._httpClient.get(`${yn.tttApiTarget}/games`)}getGame(n){return this._httpClient.get(`${yn.tttApiTarget}/games/${n}`)}create(n){return this._httpClient.post(`${yn.tttApiTarget}/games`,n,this._httpOptions)}makeMove(n,r){return this._httpClient.post(`${yn.tttApiTarget}/games/${n}/moves`,r,this._httpOptions)}join(n){return this._httpClient.post(`${yn.tttApiTarget}/games/${n}/join`,{},this._httpOptions)}}return t.\u0275fac=function(n){return new(n||t)(Je(Pd))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function WC(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(h){return void n(h)}a.done?e(l):Promise.resolve(l).then(r,i)}function Oe(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function s(l){WC(o,r,i,s,a,"next",l)}function a(l){WC(o,r,i,s,a,"throw",l)}s(void 0)})}}function Oi(t){var e,n,r,i=2;for(typeof Symbol<"u"&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(e=t[n]))return e.call(t);if(r&&null!=(e=t[r]))return new eh(e.call(t));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function eh(t){function e(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var r=n.done;return Promise.resolve(n.value).then(function(i){return{value:i,done:r}})}return(eh=function(r){this.s=r,this.n=r.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(r){var i=this.s.return;return void 0===i?Promise.resolve({value:r,done:!0}):e(i.apply(this.s,arguments))},throw:function(r){var i=this.s.return;return void 0===i?Promise.reject(r):e(i.apply(this.s,arguments))}},new eh(t)}function JC(t){this.wrapped=t}function th(t){return new JC(t)}function Tc(t){var e,n;function i(s,a){try{var l=t[s](a),h=l.value,g=h instanceof JC;Promise.resolve(g?h.wrapped:h).then(function(m){g?i("return"===s?"return":"next",m):o(l.done?"return":"normal",m)},function(m){i("throw",m)})}catch(m){o("throw",m)}}function o(s,a){switch(s){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?i(e.key,e.arg):n=null}this._invoke=function r(s,a){return new Promise(function(l,h){var g={key:s,arg:a,resolve:l,reject:h,next:null};n?n=n.next=g:(e=n=g,i(s,a))})},"function"!=typeof t.return&&(this.return=void 0)}function Ym(t){return function(){return new Tc(t.apply(this,arguments))}}Tc.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Tc.prototype.next=function(t){return this._invoke("next",t)},Tc.prototype.throw=function(t){return this._invoke("throw",t)},Tc.prototype.return=function(t){return this._invoke("return",t)};var Ne=(()=>{return(t=Ne||(Ne={})).ApiError="BAD API",t.BadAuthentication="BAD_AUTHENTICATION",t.BadCreds="BAD_CREDS",t.BadHeader="BAD_HEADER",t.BadJson="BAD_JSON",t.BadPayload="BAD_PAYLOAD",t.BadSubject="BAD_SUBJECT",t.Cancelled="CANCELLED",t.ConnectionClosed="CONNECTION_CLOSED",t.ConnectionDraining="CONNECTION_DRAINING",t.ConnectionRefused="CONNECTION_REFUSED",t.ConnectionTimeout="CONNECTION_TIMEOUT",t.Disconnect="DISCONNECT",t.InvalidOption="INVALID_OPTION",t.InvalidPayload="INVALID_PAYLOAD",t.MaxPayloadExceeded="MAX_PAYLOAD_EXCEEDED",t.NoResponders="503",t.NotFunction="NOT_FUNC",t.RequestError="REQUEST_ERROR",t.ServerOptionNotAvailable="SERVER_OPT_NA",t.SubClosed="SUB_CLOSED",t.SubDraining="SUB_DRAINING",t.Timeout="TIMEOUT",t.Tls="TLS",t.Unknown="UNKNOWN_ERROR",t.WssRequired="WSS_REQUIRED",t.JetStreamInvalidAck="JESTREAM_INVALID_ACK",t.JetStream404NoMessages="404",t.JetStream408RequestTimeout="408",t.JetStream409MaxAckPendingExceeded="409",t.JetStream409="409",t.JetStreamNotEnabled="503",t.JetStreamIdleHeartBeat="IDLE_HEARTBEAT",t.AuthorizationViolation="AUTHORIZATION_VIOLATION",t.AuthenticationExpired="AUTHENTICATION_EXPIRED",t.ProtocolError="NATS_PROTOCOL_ERR",t.PermissionsViolation="PERMISSIONS_VIOLATION",Ne;var t})();class YC{constructor(){R(this,"messages"),this.messages=new Map,this.messages.set(Ne.InvalidPayload,"Invalid payload type - payloads can be 'binary', 'string', or 'json'"),this.messages.set(Ne.BadJson,"Bad JSON"),this.messages.set(Ne.WssRequired,"TLS is required, therefore a secure websocket connection is also required")}static getMessage(e){return e6.getMessage(e)}getMessage(e){return this.messages.get(e)||e}}const e6=new YC;class Ye extends Error{constructor(n,r,i){super(n),R(this,"name"),R(this,"message"),R(this,"code"),R(this,"permissionContext"),R(this,"chainedError"),R(this,"api_error"),this.name="NatsError",this.message=n,this.code=r,this.chainedError=i}static errorForCode(n,r){const i=YC.getMessage(n);return new Ye(i,n,r)}isAuthError(){return this.code===Ne.AuthenticationExpired||this.code===Ne.AuthorizationViolation}isPermissionError(){return this.code===Ne.PermissionsViolation}isProtocolError(){return this.code===Ne.ProtocolError}isJetStreamError(){return void 0!==this.api_error}jsError(){return this.api_error?this.api_error:null}}const fr=new Uint8Array(0);var ns=(()=>{return(t=ns||(ns={})).Disconnect="disconnect",t.Reconnect="reconnect",t.Update="update",t.LDM="ldm",t.Error="error",ns;var t})(),Za=(()=>{return(t=Za||(Za={})).Reconnecting="reconnecting",t.PingTimer="pingTimer",t.StaleConnection="staleConnection",Za;var t})();const Zm="127.0.0.1";var Li=(()=>{return(t=Li||(Li={})).Timer="timer",t.Count="count",t.JitterTimer="jitterTimer",t.SentinelMsg="sentinelMsg",Li;var t})(),nh=(()=>{return(t=nh||(nh={})).Limits="limits",t.Interest="interest",t.Workqueue="workqueue",nh;var t})(),Qa=(()=>{return(t=Qa||(Qa={})).Old="old",t.New="new",Qa;var t})(),rh=(()=>{return(t=rh||(rh={})).File="file",t.Memory="memory",rh;var t})(),jr=(()=>{return(t=jr||(jr={})).All="all",t.Last="last",t.New="new",t.StartSequence="by_start_sequence",t.StartTime="by_start_time",t.LastPerSubject="last_per_subject",jr;var t})(),Yn=(()=>{return(t=Yn||(Yn={})).None="none",t.All="all",t.Explicit="explicit",t.NotSet="",Yn;var t})(),Ls=(()=>{return(t=Ls||(Ls={})).Instant="instant",t.Original="original",Ls;var t})(),_i=(()=>{return(t=_i||(_i={})).StreamSourceHdr="Nats-Stream-Source",t.LastConsumerSeqHdr="Nats-Last-Consumer",t.LastStreamSeqHdr="Nats-Last-Stream",t.ConsumerStalledHdr="Nats-Consumer-Stalled",t.MessageSizeHdr="Nats-Msg-Size",t.RollupHdr="Nats-Rollup",t.RollupValueSubject="sub",t.RollupValueAll="all",_i;var t})(),js=(()=>{return(t=js||(js={})).Stream="Nats-Stream",t.Sequence="Nats-Sequence",t.TimeStamp="Nats-Time-Stamp",t.Subject="Nats-Subject",js;var t})();const rs=new TextEncoder,ji=new TextDecoder;function Mc(...t){const e=[];for(let n=0;n<t.length;n++)e.push(rs.encode(t[n]));return 0===e.length?fr:1===e.length?e[0]:function r6(...t){let e=0;for(let i=0;i<t.length;i++)e+=t[i].length;const n=new Uint8Array(e);let r=0;for(let i=0;i<t.length;i++)n.set(t[i],r),r+=t[i].length;return n}(...e)}function XC(t){return t&&0!==t.length?ji.decode(t):""}class Pc{constructor(){R(this,"buffers"),R(this,"byteLength"),this.buffers=[],this.byteLength=0}static concat(...e){let n=0;for(let o=0;o<e.length;o++)n+=e[o].length;const r=new Uint8Array(n);let i=0;for(let o=0;o<e.length;o++)r.set(e[o],i),i+=e[o].length;return r}static fromAscii(e){return e||(e=""),rs.encode(e)}static toAscii(e){return ji.decode(e)}reset(){this.buffers.length=0,this.byteLength=0}pack(){if(this.buffers.length>1){const e=new Uint8Array(this.byteLength);let n=0;for(let r=0;r<this.buffers.length;r++)e.set(this.buffers[r],n),n+=this.buffers[r].length;this.buffers.length=0,this.buffers.push(e)}}shift(){if(this.buffers.length){const e=this.buffers.shift();if(e)return this.byteLength-=e.length,e}return new Uint8Array(0)}drain(e){if(this.buffers.length){this.pack();const n=this.buffers.pop();if(n){const r=this.byteLength;(void 0===e||e>r)&&(e=r);const i=n.subarray(0,e);return r>e&&this.buffers.push(n.subarray(e)),this.byteLength=r-e,i}}return new Uint8Array(0)}fill(e,...n){e&&(this.buffers.push(e),this.byteLength+=e.length);for(let r=0;r<n.length;r++)n[r]&&n[r].length&&(this.buffers.push(n[r]),this.byteLength+=n[r].length)}peek(){return this.buffers.length?(this.pack(),this.buffers[0]):new Uint8Array(0)}size(){return this.byteLength}length(){return this.buffers.length}}const ih=Pc.fromAscii("\r\n"),i6=new Uint8Array(ih)[0],o6=new Uint8Array(ih)[1];function oh(t,...e){for(let n=0;n<e.length;n++){const r=e[n];Object.keys(r).forEach(function(i){t[i]=r[i]})}return t}function sh(t){return ji.decode(t).replace(/\n/g,"\u240a").replace(/\r/g,"\u240d")}function ah(t){const e=Ye.errorForCode(Ne.Timeout);let n,r;const i=new Promise((o,s)=>{n={cancel:()=>{r&&clearTimeout(r)}},r=setTimeout(()=>{s(e)},t)});return Object.assign(i,n)}function Qm(t=0){return new Promise(e=>{setTimeout(()=>{e()},t)})}function vn(){let t={};const e=new Promise((n,r)=>{t={resolve:n,reject:r}});return Object.assign(e,t)}function eE(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}class Br{constructor(){R(this,"inflight"),R(this,"processed"),R(this,"received"),R(this,"noIterator"),R(this,"iterClosed"),R(this,"done"),R(this,"signal"),R(this,"yields"),R(this,"filtered"),R(this,"pendingFiltered"),R(this,"ingestionFilterFn"),R(this,"protocolFilterFn"),R(this,"dispatchedFn"),R(this,"ctx"),R(this,"_data"),R(this,"err"),R(this,"time"),this.inflight=0,this.filtered=0,this.pendingFiltered=0,this.processed=0,this.received=0,this.noIterator=!1,this.done=!1,this.signal=vn(),this.yields=[],this.iterClosed=vn(),this.time=0}[Symbol.asyncIterator](){return this.iterate()}push(e){if(this.done)return;if("function"==typeof e)return this.yields.push(e),void this.signal.resolve();const{ingest:n,protocol:r}=this.ingestionFilterFn?this.ingestionFilterFn(e,this.ctx||this):{ingest:!0,protocol:!1};n&&(r&&(this.filtered++,this.pendingFiltered++),this.yields.push(e),this.signal.resolve())}iterate(){var e=this;return Ym(function*(){if(e.noIterator)throw new Ye("unsupported iterator",Ne.ApiError);try{for(;;){if(0===e.yields.length&&(yield th(e.signal)),e.err)throw e.err;const n=e.yields;e.inflight=n.length,e.yields=[];for(let r=0;r<n.length;r++)if("function"!=typeof n[r]){if(!e.protocolFilterFn||e.protocolFilterFn(n[r])){e.processed++;const o=Date.now();yield n[r],e.time=Date.now()-o,e.dispatchedFn&&n[r]&&e.dispatchedFn(n[r])}else e.pendingFiltered--;e.inflight--}else{const o=n[r];try{o()}catch(s){throw s}if(e.err)throw e.err}if(e.done)break;0===e.yields.length&&(n.length=0,e.yields=n,e.signal=vn())}}finally{e.stop()}})()}stop(e){this.done||(this.err=e,this.done=!0,this.signal.resolve(),this.iterClosed.resolve())}getProcessed(){return this.noIterator?this.received:this.processed}getPending(){return this.yields.length+this.inflight-this.pendingFiltered}getReceived(){return this.received-this.filtered}}function tE(t){let r=!0;const i=new Array(t.length);for(let o=0;o<t.length;o++){let s=t.charCodeAt(o);if(58===s||s<33||s>126)throw new Ye(`'${t[o]}' is not a valid character for a header key`,Ne.BadHeader);r&&97<=s&&s<=122?s-=32:!r&&65<=s&&s<=90&&(s+=32),i[o]=s,r=45==s}return String.fromCharCode(...i)}function To(t=0,e=""){if(0===t&&""!==e||t>0&&""===e)throw new Error("setting status requires both code and description");return new os(t,e)}const Xm="NATS/1.0";var ti=(()=>{return(t=ti||(ti={}))[t.Exact=0]="Exact",t[t.CanonicalMIME=1]="CanonicalMIME",t[t.IgnoreCase=2]="IgnoreCase",ti;var t})();class os{constructor(e=0,n=""){R(this,"_code"),R(this,"headers"),R(this,"_description"),this._code=e,this._description=n,this.headers=new Map}[Symbol.iterator](){return this.headers.entries()}size(){return this.headers.size}equals(e){if(e&&this.headers.size===e.headers.size&&this._code===e._code){for(const[n,r]of this.headers){const i=e.values(n);if(r.length!==i.length)return!1;const o=[...r].sort(),s=[...i].sort();for(let a=0;a<o.length;a++)if(o[a]!==s[a])return!1}return!0}return!1}static decode(e){const n=new os,i=ji.decode(e).split("\r\n"),o=i[0];if(o!==Xm){let s=o.replace(Xm,"");n._code=parseInt(s,10);const a=n._code.toString();s=s.replace(a,""),n._description=s.trim()}return i.length>=1&&i.slice(1).map(s=>{if(s){const a=s.indexOf(":");if(a>-1){const l=s.slice(0,a),h=s.slice(a+1).trim();n.append(l,h)}}}),n}toString(){if(0===this.headers.size&&0===this._code)return"";let e=Xm;this._code>0&&""!==this._description&&(e+=` ${this._code} ${this._description}`);for(const[n,r]of this.headers)for(let i=0;i<r.length;i++)e=`${e}\r\n${n}: ${r[i]}`;return`${e}\r\n\r\n`}encode(){return rs.encode(this.toString())}static validHeaderValue(e){if(/[\r\n]/.test(e))throw new Ye("invalid header value - \\r and \\n are not allowed.",Ne.BadHeader);return e.trim()}keys(){const e=[];for(const n of this.headers.keys())e.push(n);return e}findKeys(e,n=ti.Exact){const r=this.keys();switch(n){case ti.Exact:return r.filter(i=>i===e);case ti.CanonicalMIME:return e=tE(e),r.filter(i=>i===e);default:{const i=e.toLowerCase();return r.filter(o=>i===o.toLowerCase())}}}get(e,n=ti.Exact){const r=this.findKeys(e,n);if(r.length){const i=this.headers.get(r[0]);if(i)return Array.isArray(i)?i[0]:i}return""}has(e,n=ti.Exact){return this.findKeys(e,n).length>0}set(e,n,r=ti.Exact){this.delete(e,r),this.append(e,n,r)}append(e,n,r=ti.Exact){const i=tE(e);r===ti.CanonicalMIME&&(e=i);const o=this.findKeys(e,r);e=o.length>0?o[0]:e;const s=os.validHeaderValue(n);let a=this.headers.get(e);a||(a=[],this.headers.set(e,a)),a.push(s)}values(e,n=ti.Exact){const r=[];return this.findKeys(e,n).forEach(o=>{const s=this.headers.get(o);s&&r.push(...s)}),r}delete(e,n=ti.Exact){this.findKeys(e,n).forEach(i=>{this.headers.delete(i)})}get hasError(){return this._code>=300}get status(){return`${this._code} ${this._description}`.trim()}toRecord(){const e={};return this.keys().forEach(n=>{e[n]=this.values(n)}),e}get code(){return this._code}get description(){return this._description}static fromRecord(e){const n=new os;for(const r in e)n.headers.set(r,e[r]);return n}}function nE(){return{encode:t=>rs.encode(t),decode:t=>ji.decode(t)}}function io(t){return{encode(e){try{return void 0===e&&(e=null),rs.encode(JSON.stringify(e))}catch(n){throw Ye.errorForCode(Ne.BadJson,n)}},decode(e){try{return JSON.parse(ji.decode(e),t)}catch(n){throw Ye.errorForCode(Ne.BadJson,n)}}}}const rE="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";const kc=new class p6{constructor(){R(this,"buf"),R(this,"seq"),R(this,"inc"),this.buf=new Uint8Array(22),this.init()}init(){this.setPre(),this.initSeqAndInc(),this.fillSeq()}initSeqAndInc(){this.seq=Math.floor(0xcfd41b9100000*Math.random()),this.inc=Math.floor(300*Math.random()+33)}setPre(){const e=new Uint8Array(12);!function f6(t){globalThis?.crypto?.getRandomValues?globalThis.crypto.getRandomValues(t):function h6(t){for(let e=0;e<t.length;e++)t[e]=Math.floor(255*Math.random())}(t)}(e);for(let n=0;n<12;n++)this.buf[n]=rE.charCodeAt(e[n]%36)}fillSeq(){let e=this.seq;for(let n=21;n>=12;n--)this.buf[n]=rE.charCodeAt(e%36),e=Math.floor(e/36)}next(){return this.seq+=this.inc,this.seq>0xcfd41b9100000&&(this.setPre(),this.initSeqAndInc()),this.fillSeq(),String.fromCharCode.apply(String,this.buf)}reset(){this.init()}};function aE(t){return t&&0===t.data.length&&503===t.headers?.code?Ye.errorForCode(Ne.NoResponders):null}class uE{constructor(e,n,r){R(this,"_headers"),R(this,"_msg"),R(this,"_rdata"),R(this,"_reply"),R(this,"_subject"),R(this,"publisher"),this._msg=e,this._rdata=n,this.publisher=r}get subject(){return this._subject||(this._subject=ji.decode(this._msg.subject)),this._subject}get reply(){return this._reply||(this._reply=ji.decode(this._msg.reply)),this._reply}get sid(){return this._msg.sid}get headers(){if(this._msg.hdr>-1&&!this._headers){const e=this._rdata.subarray(0,this._msg.hdr);this._headers=os.decode(e)}return this._headers}get data(){return this._rdata?this._msg.hdr>-1?this._rdata.subarray(this._msg.hdr):this._rdata:new Uint8Array(0)}respond(e=fr,n){return!!this.reply&&(this.publisher.publish(this.reply,e,n),!0)}size(){return this._msg.subject.length+(this._msg.reply?.length||0)+(-1===this._msg.size?0:this._msg.size)}}function Xa(t){return cE("durable",t)}function Vr(t){return cE("stream",t)}function cE(t,e=""){if(""===e)throw Error(`${t} name required`);return[".","*",">","/","\\"].forEach(r=>{if(-1!==e.indexOf(r))throw Error(`invalid ${t} name - ${t} name cannot contain '${r}'`)}),""}function uh(t,e=""){if(""===e)throw Error(`${t} name required`);const n=lE(e);if(n.length)throw new Error(`invalid ${t} name - ${t} name ${n}`)}function lE(t=""){if(""===t)throw Error("name required");const e=/^[-\w]+$/g;if(null===t.match(e))for(const r of t.split(""))if(null===r.match(e))return`cannot contain '${r}'`;return""}function Gn(t){return 1e6*t}function ey(t){return Math.floor(t/1e6)}function ty(t){if(t.data.length>0)return!1;const e=t.headers;return!!e&&e.code>=100&&e.code<200}function dE(t){return ty(t)&&"Idle Heartbeat"===t.headers?.description}function eu(t){if(0!==t.data.length)return null;const e=t.headers;return e?hE(e.code,e.description):null}var ni=(()=>{return(t=ni||(ni={})).MaxBatchExceeded="exceeded maxrequestbatch of",t.MaxExpiresExceeded="exceeded maxrequestexpires of",t.MaxBytesExceeded="exceeded maxrequestmaxbytes of",t.MaxMessageSizeExceeded="message size exceeds maxbytes",t.PushConsumer="consumer is push based",t.MaxWaitingExceeded="exceeded maxwaiting",t.IdleHeartbeatMissed="`idle heartbeats missed`",ni;var t})();function hE(t,e=""){if(t<300)return null;switch(e=e.toLowerCase(),t){case 404:return new Ye(e,Ne.JetStream404NoMessages);case 408:return new Ye(e,Ne.JetStream408RequestTimeout);case 409:{const n=e.startsWith(ni.IdleHeartbeatMissed)?Ne.JetStreamIdleHeartBeat:Ne.JetStream409;return new Ye(e,n)}case 503:return Ye.errorForCode(Ne.JetStreamNotEnabled,new Error(e));default:return""===e&&(e=Ne.Unknown),new Ye(e,`${t}`)}}function Bs(t=""){const e=t.match(/(\d+).(\d+).(\d+)/);if(e)return{major:parseInt(e[1]),minor:parseInt(e[2]),micro:parseInt(e[3])};throw new Error(`'${t}' is not a semver value`)}function ny(t,e){return t.major<e.major?-1:t.major>e.major?1:t.minor<e.minor?-1:t.minor>e.minor?1:t.micro<e.micro?-1:t.micro>e.micro?1:0}var Ur=(()=>{return(t=Ur||(Ur={})).JS_KV="js_kv",t.JS_OBJECTSTORE="js_objectstore",t.JS_PULL_MAX_BYTES="js_pull_max_bytes",t.JS_NEW_CONSUMER_CREATE_API="js_new_consumer_create",t.JS_ALLOW_DIRECT="js_allow_direct",Ur;var t})();class _6{constructor(e){R(this,"server"),R(this,"features"),R(this,"disabled"),this.features=new Map,this.disabled=[],this.update(e)}resetDisabled(){this.disabled.length=0,this.update(this.server)}disable(e){this.disabled.push(e),this.update(this.server)}isDisabled(e){return-1!==this.disabled.indexOf(e)}update(e){"string"==typeof e&&(e=Bs(e)),this.server=e,this.set(Ur.JS_KV,"2.6.2"),this.set(Ur.JS_OBJECTSTORE,"2.6.3"),this.set(Ur.JS_PULL_MAX_BYTES,"2.8.3"),this.set(Ur.JS_NEW_CONSUMER_CREATE_API,"2.9.0"),this.set(Ur.JS_ALLOW_DIRECT,"2.9.0"),this.disabled.forEach(n=>{this.features.delete(n)})}set(e,n){this.features.set(e,{min:n,ok:ny(this.server,Bs(n))>=0})}get(e){return this.features.get(e)||{min:"unknown",ok:!1}}supports(e){return this.get(e)?.ok||!1}require(e){return"string"==typeof e&&(e=Bs(e)),ny(this.server,e)>=0}}const ch="Nats-Service-Error",lh="Nats-Service-Error-Code";var Bi=(()=>{return(t=Bi||(Bi={})).PING="PING",t.STATS="STATS",t.INFO="INFO",t.SCHEMA="SCHEMA",Bi;var t})(),Vs=(()=>{return(t=Vs||(Vs={})).STATS="io.nats.micro.v1.stats_response",t.INFO="io.nats.micro.v1.info_response",t.PING="io.nats.micro.v1.ping_response",t.SCHEMA="io.nats.micro.v1.schema_response",Vs;var t})();class fE{constructor(e){R(this,"msg"),this.msg=e}get data(){return this.msg.data}get sid(){return this.msg.sid}get subject(){return this.msg.subject}respond(e,n){return this.msg.respond(e,n)}respondError(e,n,r,i){return(i=i||{}).headers=i.headers||To(),i.headers?.set(lh,`${e}`),i.headers?.set(ch,n),this.msg.respond(r,i)}}class Rc{constructor(e,n=""){R(this,"subject"),R(this,"srv"),""!==n&&function S6(t,e){if(-1!==e.indexOf(" "))throw new Error(`${t} cannot contain spaces: '${e}'`);e.split(".").forEach(r=>{if(">"===r)throw new Error(`${t} name cannot contain internal '>': '${e}'`)})}("service group",n);let r="";if(e instanceof Nc)this.srv=e,r="";else{if(!(e instanceof Rc))throw new Error("unknown ServiceGroup type");{const i=e;this.srv=i.srv,r=i.subject}}this.subject=this.calcSubject(r,n)}calcSubject(e,n=""){return""===n?e:""!==e?`${e}.${n}`:n}addEndpoint(e="",n){const r="function"==typeof(n=n||{subject:e})?{handler:n,subject:e}:n;uh("endpoint",e);let{subject:i,handler:o,schema:s}=r;return i=i||e,function w6(t,e){if(""===e)throw new Error(`${t} cannot be empty`);if(-1!==e.indexOf(" "))throw new Error(`${t} cannot contain spaces: '${e}'`);const n=e.split(".");n.forEach((r,i)=>{if(">"===r&&i!==n.length-1)throw new Error(`${t} cannot have internal '>': '${e}'`)})}("endpoint subject",i),i=this.calcSubject(this.subject,i),this.srv._addEndpoint({name:e,subject:i,handler:o,schema:s})}addGroup(e=""){return new Rc(this,e)}}class dh extends Error{constructor(n,r){super(r),R(this,"code"),this.code=n}static isServiceError(n){return null!==dh.toServiceError(n)}static toServiceError(n){const r=n?.headers?.get(lh)||"";if(""!==r){const i=parseInt(r)||400,o=n?.headers?.get(ch)||"";return new dh(i,o.length?o:r)}return null}}class Nc extends Br{constructor(n,r={name:"",version:""}){super(),R(this,"nc"),R(this,"_id"),R(this,"config"),R(this,"handlers"),R(this,"internal"),R(this,"_stopped"),R(this,"_done"),R(this,"_schema"),R(this,"started"),this.nc=n,this.config=r,uh("name",this.config.name),Bs(this.config.version),this._id=kc.next(),this.internal=[],this._done=vn(),this._stopped=!1,this.handlers=[],this.noIterator=!0,this.started=(new Date).toISOString(),this.reset(),this.config.endpoint&&this._addEndpoint({name:"default",subject:this.config.endpoint?.subject,handler:this.config.endpoint?.handler,schema:this.config.endpoint?.schema},!0),this.nc.closed().then(()=>{this.close().catch()}).catch(i=>{this.close(i).catch()})}static controlSubject(n,r="",i="",o){const s=o??"$SRV";return""===r&&""===i?`${s}.${n}`:(uh("control subject name",r),""!==i?(uh("control subject id",i),`${s}.${n}.${r}.${i}`):`${s}.${n}.${r}`)}get subjects(){return this.handlers.filter(n=>!1===n.internal).map(n=>n.subject)}get id(){return this._id}get name(){return this.config.name}get description(){return this.config.description??""}get version(){return this.config.version}errorToHeader(n){const r=To();if(n instanceof dh){const i=n;r.set(ch,i.message),r.set(lh,`${i.code}`)}else r.set(ch,n.message),r.set(lh,"500");return r}setupHandler(n,r=!1){const i=r?"":"q",{name:o,subject:s,handler:a,schema:l}=n,h=n;h.internal=r,r&&this.internal.push(h),h.stats=new C6(o,s),h.schema=l;const g=a?(m,C)=>{if(m)return void this.close(m);const D=Date.now();try{a(m,new fE(C))}catch(q){h.stats.countError(q),C?.respond(fr,{headers:this.errorToHeader(q)})}finally{h.stats.countLatency(D)}}:void 0;return h.sub=this.nc.subscribe(s,{callback:g,queue:i}),h.sub.closed.then(()=>{this._stopped||this.close(new Error(`required subscription ${n.subject} stopped`)).catch()}).catch(m=>{if(!this._stopped){const C=new Error(`required subscription ${n.subject} errored: ${m.message}`);C.stack=m.stack,this.close(C).catch()}}),h}info(){return{type:Vs.INFO,name:this.name,id:this.id,version:this.version,description:this.description,subjects:this.subjects}}stats(){var n=this;return Oe(function*(){const r=[];for(const i of n.handlers){if("function"==typeof n.config.statsHandler)try{i.stats.data=yield n.config.statsHandler(i)}catch(o){i.stats.countError(o)}r.push(i.stats.stats(i.qi))}return{type:Vs.STATS,name:n.name,id:n.id,version:n.version,started:n.started,endpoints:r}})()}addInternalHandler(n,r){const i=`${n}`.toUpperCase();this._doAddInternalHandler(`${i}-all`,n,r),this._doAddInternalHandler(`${i}-kind`,n,r,this.name),this._doAddInternalHandler(`${i}`,n,r,this.name,this.id)}_doAddInternalHandler(n,r,i,o="",s=""){const a={};a.name=n,a.subject=Nc.controlSubject(r,o,s),a.handler=i,this.setupHandler(a,!0)}start(){const n=io(),o=n.encode({type:Vs.PING,name:this.name,id:this.id,version:this.version});return this.addInternalHandler(Bi.PING,(l,h)=>l?(this.close(l).then().catch(),Promise.reject(l)):(h.respond(o),Promise.resolve())),this.addInternalHandler(Bi.STATS,(l,h)=>l?(this.close(l),Promise.reject(l)):this.stats().then(g=>(h?.respond(n.encode(g)),Promise.resolve()))),this.addInternalHandler(Bi.INFO,(l,h)=>l?(this.close(l),Promise.reject(l)):(h?.respond(n.encode(this.info())),Promise.resolve())),this.addInternalHandler(Bi.SCHEMA,(l,h)=>l?(this.close(l),Promise.reject(l)):(h?.respond(io().encode(this.schema())),Promise.resolve())),this.handlers.forEach(l=>{const{subject:h}=l;"string"==typeof h&&null!==l.handler&&this.setupHandler(l)}),Promise.resolve(this)}close(n){if(this._stopped)return this._done;this._stopped=!0;let r=[];return this.nc.isClosed()||(r=this.handlers.concat(this.internal).map(i=>i.sub.drain())),Promise.allSettled(r).then(()=>{this._done.resolve(n||null)}),this._done}get stopped(){return this._done}get isStopped(){return this._stopped}stop(n){return this.close(n)}schema(){const n={type:Vs.SCHEMA,name:this.name,id:this.id,version:this.version,api_url:this.config.apiURL,endpoints:[]};return n.endpoints=this.handlers.map(r=>{const{schema:i,subject:o,name:s}=r;return{schema:i,subject:o,name:s}}),n}reset(){if(this.started=(new Date).toISOString(),this.handlers)for(const n of this.handlers)n.stats.reset(n.qi)}addGroup(n){return new Rc(this,n)}addEndpoint(n,r){return new Rc(this).addEndpoint(n,r)}_addEndpoint(n,r=!1){const i=r?this:new Br;i.noIterator="function"==typeof n.handler,i.noIterator||(n.handler=(s,a)=>{s?this.stop(s).catch():i.push(new fE(a))},i.iterClosed.then(()=>{this.close().catch()}));const o=this.setupHandler(n,!1);return o.qi=i,this.handlers.push(o),i}}class C6{constructor(e,n){R(this,"name"),R(this,"subject"),R(this,"average_processing_time"),R(this,"num_requests"),R(this,"processing_time"),R(this,"num_errors"),R(this,"last_error"),R(this,"data"),this.name=e,this.subject=n,this.average_processing_time=0,this.num_errors=0,this.num_requests=0,this.processing_time=0}reset(e){this.num_requests=0,this.processing_time=0,this.average_processing_time=0,this.num_errors=0,this.last_error=void 0,this.data=void 0;const n=e;n&&(n.time=0,n.processed=0)}countLatency(e){this.num_requests++,this.processing_time+=Gn(Date.now()-e),this.average_processing_time=Math.round(this.processing_time/this.num_requests)}countError(e){this.num_errors++,this.last_error=e.message}_stats(){const{name:e,subject:n,average_processing_time:r,num_errors:i,num_requests:o,processing_time:s,last_error:a,data:l}=this;return{name:e,subject:n,average_processing_time:r,num_errors:i,num_requests:o,processing_time:s,last_error:a,data:l}}stats(e){const n=e;return!1===n?.noIterator&&(this.processing_time=n.time,this.num_requests=n.processed,this.average_processing_time=this.processing_time>0&&this.num_requests>0?this.processing_time/this.num_requests:0),this._stats()}}class Oc{constructor(e,n){R(this,"nc"),R(this,"opts"),R(this,"prefix"),R(this,"timeout"),R(this,"jc"),this.nc=e,this.opts=function x6(t){return(t=t||{}).domain&&(t.apiPrefix=`$JS.${t.domain}.API`,delete t.domain),oh({apiPrefix:"$JS.API",timeout:5e3},t)}(n),this._parseOpts(),this.prefix=this.opts.apiPrefix,this.timeout=this.opts.timeout,this.jc=io()}_parseOpts(){let e=this.opts.apiPrefix;if(!e||0===e.length)throw new Error("invalid empty prefix");"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),this.opts.apiPrefix=e}_request(e,n=null,r){var i=this;return Oe(function*(){(r=r||{}).timeout=i.timeout;let o=fr;n&&(o=i.jc.encode(n));const s=yield i.nc.request(e,o,r);return i.parseJsResponse(s)})()}findStream(e){var n=this;return Oe(function*(){const r={subject:e},o=yield n._request(`${n.prefix}.STREAM.NAMES`,r);if(!o.streams||1!==o.streams.length)throw new Error("no stream matches subject");return o.streams[0]})()}parseJsResponse(e){const n=this.jc.decode(e.data),r=n;if(r.error){const i=hE(r.error.code,r.error.description);if(null!==i)throw i.api_error=r.error,i}return n}}class Lc{constructor(e,n,r,i){if(R(this,"err"),R(this,"offset"),R(this,"pageInfo"),R(this,"subject"),R(this,"jsm"),R(this,"filter"),R(this,"payload"),!e)throw new Error("subject is required");this.subject=e,this.jsm=r,this.offset=0,this.pageInfo={},this.filter=n,this.payload=i||{}}next(){var e=this;return Oe(function*(){if(e.err)return[];if(e.pageInfo&&e.offset>=e.pageInfo.total)return[];const n={offset:e.offset};e.payload&&Object.assign(n,e.payload);try{const r=yield e.jsm._request(e.subject,n,{timeout:e.jsm.timeout});return e.pageInfo=r,e.offset+=e.countResponse(r),e.filter(r)}catch(r){throw e.err=r,r}})()}countResponse(e){switch(e?.type){case"io.nats.jetstream.api.v1.stream_names_response":case"io.nats.jetstream.api.v1.stream_list_response":return e.streams.length;case"io.nats.jetstream.api.v1.consumer_list_response":return e.consumers.length;default:return console.error(`jslister.ts: unknown API response for paged output: ${e?.type}`),e.streams?.length||0}return 0}[Symbol.asyncIterator](){var e=this;return Ym(function*(){let n=yield th(e.next());for(;n.length>0;){for(const r of n)yield r;n=yield th(e.next())}})()}}class pE extends Oc{constructor(e,n){super(e,n)}add(e,n){var r=this;return Oe(function*(){if(Vr(e),n.deliver_group&&n.flow_control)throw new Error("jetstream flow control is not supported with queue groups");if(n.deliver_group&&n.idle_heartbeat)throw new Error("jetstream idle heartbeat is not supported with queue groups");const i={};i.config=n,i.stream_name=e,i.config.durable_name&&Xa(i.config.durable_name);const o=r.nc,{min:s,ok:a}=o.features.get(Ur.JS_NEW_CONSUMER_CREATE_API),l=""===n.name?void 0:n.name;if(l&&!a)throw new Error(`consumer 'name' requires server ${s}`);if(l){const C=lE(l);if(C.length)throw new Error(`consumer 'name' ${C}`)}let h,g="";if(a&&(g=n.name??n.durable_name??""),""!==g){let C=n.filter_subject??void 0;">"===C&&(C=void 0),h=void 0!==C?`${r.prefix}.CONSUMER.CREATE.${e}.${g}.${C}`:`${r.prefix}.CONSUMER.CREATE.${e}.${g}`}else h=n.durable_name?`${r.prefix}.CONSUMER.DURABLE.CREATE.${e}.${n.durable_name}`:`${r.prefix}.CONSUMER.CREATE.${e}`;return yield r._request(h,i)})()}update(e,n,r){var i=this;return Oe(function*(){const o=yield i.info(e,n);return i.add(e,Object.assign(o.config,r))})()}info(e,n){var r=this;return Oe(function*(){return Vr(e),Xa(n),yield r._request(`${r.prefix}.CONSUMER.INFO.${e}.${n}`)})()}delete(e,n){var r=this;return Oe(function*(){return Vr(e),Xa(n),(yield r._request(`${r.prefix}.CONSUMER.DELETE.${e}.${n}`)).success})()}list(e){return Vr(e),new Lc(`${this.prefix}.CONSUMER.LIST.${e}`,i=>i.consumers,this)}}class gE{constructor(e,n){R(this,"token"),R(this,"received"),R(this,"ctx"),R(this,"requestSubject"),R(this,"mux"),this.mux=e,this.requestSubject=n,this.received=0,this.token=kc.next(),this.ctx=new Error}}class D6 extends gE{constructor(n,r,i={maxWait:1e3}){if(super(n,r),R(this,"callback"),R(this,"done"),R(this,"timer"),R(this,"max"),R(this,"opts"),this.opts=i,"function"!=typeof this.opts.callback)throw new Error("callback is required");this.callback=this.opts.callback,this.max="number"==typeof i.maxMessages&&i.maxMessages>0?i.maxMessages:-1,this.done=vn(),this.done.then(()=>{this.callback(null,null)}),this.timer=setTimeout(()=>{this.cancel()},i.maxWait)}cancel(n){n&&this.callback(n,null),clearTimeout(this.timer),this.mux.cancel(this),this.done.resolve()}resolver(n,r){n?(n.stack+=`\n\n${this.ctx.stack}`,this.cancel(n)):(this.callback(null,r),this.opts.strategy===Li.Count&&(this.max--,0===this.max&&this.cancel()),this.opts.strategy===Li.JitterTimer&&(clearTimeout(this.timer),this.timer=setTimeout(()=>{this.cancel()},this.opts.jitter||300)),this.opts.strategy===Li.SentinelMsg&&r&&0===r.data.length&&this.cancel())}}class mE extends gE{constructor(n,r,i={timeout:1e3}){super(n,r),R(this,"deferred"),R(this,"timer"),this.deferred=vn(),this.timer=ah(i.timeout)}resolver(n,r){this.timer&&this.timer.cancel(),n?(n.stack+=`\n\n${this.ctx.stack}`,this.deferred.reject(n)):this.deferred.resolve(r),this.cancel()}cancel(n){this.timer&&this.timer.cancel(),this.mux.cancel(this),this.deferred.reject(n||Ye.errorForCode(Ne.Cancelled))}}const yE=Uint8Array.of(43,65,67,75),A6=Uint8Array.of(45,78,65,75),jc=Uint8Array.of(43,87,80,73),I6=Uint8Array.of(43,78,88,84),F6=Uint8Array.of(43,84,69,82,77),T6=Uint8Array.of(32);function hh(t){return new P6(t)}class P6{constructor(e){R(this,"msg"),R(this,"di"),R(this,"didAck"),this.msg=e,this.didAck=!1}get subject(){return this.msg.subject}get sid(){return this.msg.sid}get data(){return this.msg.data}get headers(){return this.msg.headers}get info(){return this.di||(this.di=function M6(t){const e=t.split(".");if(9===e.length&&e.splice(2,0,"_",""),e.length<11||"$JS"!==e[0]||"ACK"!==e[1])throw new Error("not js message");const n={};return n.domain="_"===e[2]?"":e[2],n.account_hash=e[3],n.stream=e[4],n.consumer=e[5],n.redeliveryCount=parseInt(e[6],10),n.redelivered=n.redeliveryCount>1,n.streamSequence=parseInt(e[7],10),n.deliverySequence=parseInt(e[8],10),n.timestampNanos=parseInt(e[9],10),n.pending=parseInt(e[10],10),n}(this.reply)),this.di}get redelivered(){return this.info.redeliveryCount>1}get reply(){return this.msg.reply||""}get seq(){return this.info.streamSequence}doAck(e){this.didAck||(this.didAck=!this.isWIP(e),this.msg.respond(e))}isWIP(e){return 4===e.length&&e[0]===jc[0]&&e[1]===jc[1]&&e[2]===jc[2]&&e[3]===jc[3]}ackAck(){var e=this;return Oe(function*(){if(!e.didAck&&(e.didAck=!0,e.msg.reply)){const r=e.msg.publisher,i=new mE(r.muxSubscriptions,e.msg.reply);r.request(i);try{r.publish(e.msg.reply,yE,{reply:`${r.muxSubscriptions.baseInbox}${i.token}`})}catch(o){i.cancel(o)}try{return yield Promise.race([i.timer,i.deferred]),!0}catch(o){i.cancel(o)}}return!1})()}ack(){this.doAck(yE)}nak(e){let n=A6;e&&(n=nE().encode(`-NAK ${JSON.stringify({delay:Gn(e)})}`)),this.doAck(n)}working(){this.doAck(jc)}next(e,n={batch:1}){const r={};r.batch=n.batch||1,r.no_wait=n.no_wait||!1,n.expires&&n.expires>0&&(r.expires=Gn(n.expires));const i=io().encode(r),o=Pc.concat(I6,T6,i);this.msg.respond(o,e?{reply:e}:void 0)}term(){this.doAck(F6)}}function tu(t,e,n=!1){if(!0===n&&!t)throw Ye.errorForCode(Ne.ApiError,new Error(`${e} is not a function`));if(t&&"function"!=typeof t)throw Ye.errorForCode(Ne.ApiError,new Error(`${e} is not a function`))}class k6 extends Br{constructor(n,r,i){var o;super(),R(this,"sub"),R(this,"adapter"),R(this,"subIterDone"),o=this,tu(i.adapter,"adapter",!0),this.adapter=i.adapter,i.callback&&tu(i.callback,"callback"),this.noIterator="function"==typeof i.callback,i.ingestionFilterFn&&(tu(i.ingestionFilterFn,"ingestionFilterFn"),this.ingestionFilterFn=i.ingestionFilterFn),i.protocolFilterFn&&(tu(i.protocolFilterFn,"protocolFilterFn"),this.protocolFilterFn=i.protocolFilterFn),i.dispatchedFn&&(tu(i.dispatchedFn,"dispatchedFn"),this.dispatchedFn=i.dispatchedFn),i.cleanupFn&&tu(i.cleanupFn,"cleanupFn");let s=(m,C)=>{this.callback(m,C)};if(i.callback){const m=i.callback;s=(C,D)=>{const[q,he]=this.adapter(C,D);if(q)return void m(q,null);const{ingest:Se}=this.ingestionFilterFn?this.ingestionFilterFn(he,this):{ingest:!0};Se&&(!this.protocolFilterFn||this.protocolFilterFn(he))&&(m(q,he),this.dispatchedFn&&he&&this.dispatchedFn(he))}}const{max:a,queue:l,timeout:h}=i,g={queue:l,timeout:h,callback:s};var m;a&&a>0&&(g.max=a),this.sub=n.subscribe(r,g),i.cleanupFn&&(this.sub.cleanupFn=i.cleanupFn),this.noIterator||this.iterClosed.then(()=>{this.unsubscribe()}),this.subIterDone=vn(),Promise.all([this.sub.closed,this.iterClosed]).then(()=>{this.subIterDone.resolve()}).catch(()=>{this.subIterDone.resolve()}),(m=Oe(function*(C){yield C.closed,o.stop()}),function(C){return m.apply(this,arguments)})(this.sub).then().catch()}unsubscribe(n){this.sub.unsubscribe(n)}drain(){return this.sub.drain()}isDraining(){return this.sub.isDraining()}isClosed(){return this.sub.isClosed()}callback(n,r){this.sub.cancelTimeout();const[i,o]=this.adapter(n,r);i&&this.stop(i),o&&this.push(o)}getSubject(){return this.sub.getSubject()}getReceived(){return this.sub.getReceived()}getProcessed(){return this.sub.getProcessed()}getPending(){return this.sub.getPending()}getID(){return this.sub.getID()}getMax(){return this.sub.getMax()}get closed(){return this.sub.closed}}let ri;function vE(){return void 0!==ri&&void 0!==ri.defaultPort?ri.defaultPort:4222}function ry(){return void 0!==ri&&ri.urlParseFn?ri.urlParseFn:void 0}function _E(){return void 0!==ri&&ri.dnsResolveFn?ri.dnsResolveFn:void 0}function iy(t){return void 0!==function V6(t){for(let e=0;e<t.length;e++)switch(t[e]){case".":return wE(t);case":":return U6(t)}}(t)}function wE(t){const e=new Uint8Array(4);for(let n=0;n<4;n++){if(0===t.length)return;if(n>0){if("."!==t[0])return;t=t.substring(1)}const{n:r,c:i,ok:o}=H6(t);if(!o||r>255)return;t=t.substring(i),e[n]=r}return function B6(t,e,n,r){const i=new Uint8Array(16);return[0,0,0,0,0,0,0,0,0,0,255,255].forEach((s,a)=>{i[a]=s}),i[12]=t,i[13]=e,i[14]=n,i[15]=r,i}(e[0],e[1],e[2],e[3])}function U6(t){const e=new Uint8Array(16);let n=-1;if(t.length>=2&&":"===t[0]&&":"===t[1]&&(n=0,0===(t=t.substring(2)).length))return e;let r=0;for(;r<16;){const{n:i,c:o,ok:s}=$6(t);if(!s||i>65535)return;if(o<t.length&&"."===t[o]){if(n<0&&12!=r||r+4>16)return;const a=wE(t);if(void 0===a)return;e[r]=a[12],e[r+1]=a[13],e[r+2]=a[14],e[r+3]=a[15],t="",r+=4;break}if(e[r]=i>>8,e[r+1]=i,r+=2,0===(t=t.substring(o)).length)break;if(":"!==t[0]||1==t.length)return;if(":"===(t=t.substring(1))[0]){if(n>=0)return;if(n=r,0===(t=t.substring(1)).length)break}}if(0===t.length){if(r<16){if(n<0)return;const i=16-r;for(let o=r-1;o>=n;o--)e[o+i]=e[o];for(let o=n+i-1;o>=n;o--)e[o]=0}else if(n>=0)return;return e}}function H6(t){let e=0,n=0;for(e=0;e<t.length&&48<=t.charCodeAt(e)&&t.charCodeAt(e)<=57;e++)if(n=10*n+(t.charCodeAt(e)-48),n>=16777215)return{n:16777215,c:e,ok:!1};return 0===e?{n:0,c:0,ok:!1}:{n,c:e,ok:!0}}function $6(t){let e=0,n=0;for(n=0;n<t.length;n++){if(48<=t.charCodeAt(n)&&t.charCodeAt(n)<=57)e*=16,e+=t.charCodeAt(n)-48;else if(97<=t.charCodeAt(n)&&t.charCodeAt(n)<=102)e*=16,e+=t.charCodeAt(n)-97+10;else{if(!(65<=t.charCodeAt(n)&&t.charCodeAt(n)<=70))break;e*=16,e+=t.charCodeAt(n)-65+10}if(e>=16777215)return{n:0,c:n,ok:!1}}return 0===n?{n:0,c:n,ok:!1}:{n:e,c:n,ok:!0}}function oy(t){return!function q6(t){return-1!==t.indexOf(".")||-1===t.indexOf("[")&&-1===t.indexOf("::")&&t.split(":").length<=2}(t)}class Bc{constructor(e,n=!1){R(this,"src"),R(this,"listen"),R(this,"hostname"),R(this,"port"),R(this,"didConnect"),R(this,"reconnects"),R(this,"lastConnect"),R(this,"gossiped"),R(this,"tlsName"),R(this,"resolves"),this.src=e,this.tlsName="";const r=function G6(t){(t=t.trim()).match(/^(.*:\/\/)(.*)/m)&&(t=t.replace(/^(.*:\/\/)(.*)/gm,"$2")),oy(t)&&-1===t.indexOf("[")&&(t=`[${t}]`);const e=oy(t)?t.match(/(]:)(\d+)/):t.match(/(:)(\d+)/),n=e&&3===e.length&&e[1]&&e[2]?parseInt(e[2]):4222,i=new URL(`${80===n?"https":"http"}://${t}`);i.port=`${n}`;let o=i.hostname;return"["===o.charAt(0)&&(o=o.substring(1,o.length-1)),{listen:i.host,hostname:o,port:n}}(e);this.listen=r.listen,this.hostname=r.hostname,this.port=r.port,this.didConnect=!1,this.reconnects=0,this.lastConnect=0,this.gossiped=n}toString(){return this.listen}resolve(e){var n=this;return Oe(function*(){if(!e.fn)return[n];const r=[];if(iy(n.hostname))return[n];{const i=yield e.fn(n.hostname);e.debug&&console.log(`resolve ${n.hostname} = ${i.join(",")}`);for(const o of i){const a=new URL(`${80===n.port?"https":"http"}://${oy(o)?"["+o+"]":o}`);a.port=`${n.port}`;const l=new Bc(a.host,!1);l.tlsName=n.hostname,r.push(l)}}return e.randomize&&eE(r),n.resolves=r,r})()}}class z6{constructor(e=[],n={}){R(this,"firstSelect"),R(this,"servers"),R(this,"currentServer"),R(this,"tlsName"),R(this,"randomize"),this.firstSelect=!0,this.servers=[],this.tlsName="",this.randomize=n.randomize||!1;const r=ry();e&&(e.forEach(i=>{i=r?r(i):i,this.servers.push(new Bc(i))}),this.randomize&&(this.servers=eE(this.servers))),0===this.servers.length&&this.addServer(`${Zm}:${vE()}`,!1),this.currentServer=this.servers[0]}clear(){this.servers.length=0}updateTLSName(){const e=this.getCurrentServer();iy(e.hostname)||(this.tlsName=e.hostname,this.servers.forEach(n=>{n.gossiped&&(n.tlsName=this.tlsName)}))}getCurrentServer(){return this.currentServer}addServer(e,n=!1){const r=ry();e=r?r(e):e;const i=new Bc(e,n);iy(i.hostname)&&(i.tlsName=this.tlsName),this.servers.push(i)}selectServer(){if(this.firstSelect)return this.firstSelect=!1,this.currentServer;const e=this.servers.shift();return e&&(this.servers.push(e),this.currentServer=e),e}removeCurrentServer(){this.removeServer(this.currentServer)}removeServer(e){if(e){const n=this.servers.indexOf(e);this.servers.splice(n,1)}}length(){return this.servers.length}next(){return this.servers.length?this.servers[0]:void 0}getServers(){return this.servers}update(e){const n=[];let r=[];const i=ry(),o=new Map;e.connect_urls&&e.connect_urls.length>0&&e.connect_urls.forEach(a=>{a=i?i(a):a;const l=new Bc(a,!0);o.set(a,l)});const s=[];return this.servers.forEach((a,l)=>{const h=a.listen;a.gossiped&&this.currentServer.listen!==h&&void 0===o.get(h)&&s.push(l),o.delete(h)}),s.reverse(),s.forEach(a=>{const l=this.servers.splice(a,1);r=r.concat(l[0].listen)}),o.forEach((a,l)=>{this.servers.push(a),n.push(l)}),{added:n,deleted:r}}}class SE extends Br{constructor(n,r,i={}){super(),R(this,"sid"),R(this,"queue"),R(this,"draining"),R(this,"max"),R(this,"subject"),R(this,"drained"),R(this,"protocol"),R(this,"timer"),R(this,"info"),R(this,"cleanupFn"),R(this,"closed"),R(this,"requestSubject"),oh(this,i),this.protocol=n,this.subject=r,this.draining=!1,this.noIterator="function"==typeof i.callback,this.closed=vn(),i.timeout&&(this.timer=ah(i.timeout),this.timer.then(()=>{this.timer=void 0}).catch(o=>{this.stop(o),this.noIterator&&this.callback(o,{})})),this.noIterator||this.iterClosed.then(()=>{this.closed.resolve(),this.unsubscribe()})}setPrePostHandlers(n){if(this.noIterator){const r=this.callback,i=n.ingestionFilterFn?n.ingestionFilterFn:()=>({ingest:!0,protocol:!1}),o=n.protocolFilterFn?n.protocolFilterFn:()=>!0,s=n.dispatchedFn?n.dispatchedFn:()=>{};this.callback=(a,l)=>{const{ingest:h}=i(l);!h||o(l)&&(r(a,l),s(l))}}else this.protocolFilterFn=n.protocolFilterFn,this.dispatchedFn=n.dispatchedFn}callback(n,r){this.cancelTimeout(),n?this.stop(n):this.push(r)}close(){if(!this.isClosed()){this.cancelTimeout();const n=()=>{if(this.stop(),this.cleanupFn)try{this.cleanupFn(this,this.info)}catch{}this.closed.resolve()};this.noIterator?n():this.push(n)}}unsubscribe(n){this.protocol.unsubscribe(this,n)}cancelTimeout(){this.timer&&(this.timer.cancel(),this.timer=void 0)}drain(){return this.protocol.isClosed()?Promise.reject(Ye.errorForCode(Ne.ConnectionClosed)):this.isClosed()?Promise.reject(Ye.errorForCode(Ne.SubClosed)):(this.drained||(this.protocol.unsub(this),this.drained=this.protocol.flush(vn()).then(()=>{this.protocol.subscriptions.cancel(this)}).catch(()=>{this.protocol.subscriptions.cancel(this)})),this.drained)}isDraining(){return this.draining}isClosed(){return this.done}getSubject(){return this.subject}getMax(){return this.max}getID(){return this.sid}}class K6{constructor(){R(this,"mux"),R(this,"subs"),R(this,"sidCounter"),this.sidCounter=0,this.mux=null,this.subs=new Map}size(){return this.subs.size}add(e){return this.sidCounter++,e.sid=this.sidCounter,this.subs.set(e.sid,e),e}setMux(e){return this.mux=e,e}getMux(){return this.mux}get(e){return this.subs.get(e)}resub(e){return this.sidCounter++,this.subs.delete(e.sid),e.sid=this.sidCounter,this.subs.set(e.sid,e),e}all(){return Array.from(this.subs.values())}cancel(e){e&&(e.close(),this.subs.delete(e.sid))}handleError(e){if(e&&e.permissionContext){const n=e.permissionContext,r=this.all();let i;if("subscription"===n.operation&&(i=r.find(o=>o.subject===n.subject)),"publish"===n.operation&&(i=r.find(o=>o.requestSubject===n.subject)),i)return i.callback(e,{}),i.close(),this.subs.delete(i.sid),i!==this.mux}return!1}close(){this.subs.forEach(e=>{e.close()})}}class W6{constructor(e,n,r){R(this,"ph"),R(this,"interval"),R(this,"maxOut"),R(this,"timer"),R(this,"pendings"),this.ph=e,this.interval=n,this.maxOut=r,this.pendings=[]}start(){this.cancel(),this._schedule()}cancel(e){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this._reset(),e&&this.ph.disconnect()}_schedule(){this.timer=setTimeout(()=>{if(this.ph.dispatchStatus({type:Za.PingTimer,data:`${this.pendings.length+1}`}),this.pendings.length===this.maxOut)return void this.cancel(!0);const e=vn();this.ph.flush(e).then(()=>{this._reset()}).catch(()=>{this.cancel()}),this.pendings.push(e),this._schedule()},this.interval)}_reset(){this.pendings=this.pendings.filter(e=>(e.resolve(),!1))}}class J6 extends Error{constructor(e){super(e),this.name="AssertionError"}}const sy=2**32-2;function fh(t,e,n=0){const r=e.byteLength-n;return t.byteLength>r&&(t=t.subarray(0,r)),e.set(t,n),t.byteLength}class ay{constructor(e){R(this,"_buf"),R(this,"_off"),this._off=0,this._buf=null!=e?new Uint8Array(e):new Uint8Array(0)}bytes(e={copy:!0}){return!1===e.copy?this._buf.subarray(this._off):this._buf.slice(this._off)}empty(){return this._buf.byteLength<=this._off}get length(){return this._buf.byteLength-this._off}get capacity(){return this._buf.buffer.byteLength}truncate(e){if(0!==e){if(e<0||e>this.length)throw Error("bytes.Buffer: truncation out of range");this._reslice(this._off+e)}else this.reset()}reset(){this._reslice(0),this._off=0}_tryGrowByReslice(e){const n=this._buf.byteLength;return e<=this.capacity-n?(this._reslice(n+e),n):-1}_reslice(e){(function Y6(t,e="Assertion failed."){if(!t)throw new J6(e)})(e<=this._buf.buffer.byteLength),this._buf=new Uint8Array(this._buf.buffer,0,e)}readByte(){const e=new Uint8Array(1);return this.read(e)?e[0]:null}read(e){if(this.empty())return this.reset(),0===e.byteLength?0:null;const n=fh(this._buf.subarray(this._off),e);return this._off+=n,n}writeByte(e){return this.write(Uint8Array.of(e))}writeString(e){return this.write(rs.encode(e))}write(e){const n=this._grow(e.byteLength);return fh(e,this._buf,n)}_grow(e){const n=this.length;0===n&&0!==this._off&&this.reset();const r=this._tryGrowByReslice(e);if(r>=0)return r;const i=this.capacity;if(e<=Math.floor(i/2)-n)fh(this._buf.subarray(this._off),this._buf);else{if(i+e>sy)throw new Error("The buffer cannot be grown beyond the maximum size.");{const o=new Uint8Array(Math.min(2*i+e,sy));fh(this._buf.subarray(this._off),o),this._buf=o}}return this._off=0,this._reslice(Math.min(n+e,sy)),n}grow(e){if(e<0)throw Error("Buffer._grow: negative count");const n=this._grow(e);this._reslice(n)}readFrom(e){let n=0;const r=new Uint8Array(32768);for(;;){const i=this.capacity-this.length<32768,o=i?r:new Uint8Array(this._buf.buffer,this.length),s=e.read(o);if(null===s)return n;i?this.write(o.subarray(0,s)):this._reslice(this.length+s),n+=s}}}var pr=(()=>{return(t=pr||(pr={}))[t.OK=0]="OK",t[t.ERR=1]="ERR",t[t.MSG=2]="MSG",t[t.INFO=3]="INFO",t[t.PING=4]="PING",t[t.PONG=5]="PONG",pr;var t})();class xE{constructor(e){R(this,"dispatcher"),R(this,"state"),R(this,"as"),R(this,"drop"),R(this,"hdr"),R(this,"ma"),R(this,"argBuf"),R(this,"msgBuf"),this.dispatcher=e,this.state=je.OP_START,this.as=0,this.drop=0,this.hdr=0}parse(e){let n;for(n=0;n<e.length;n++){const r=e[n];switch(this.state){case je.OP_START:switch(r){case Be.M:case Be.m:this.state=je.OP_M,this.hdr=-1,this.ma={sid:-1,hdr:-1,size:-1};break;case Be.H:case Be.h:this.state=je.OP_H,this.hdr=0,this.ma={sid:-1,hdr:-1,size:-1};break;case Be.P:case Be.p:this.state=je.OP_P;break;case Be.PLUS:this.state=je.OP_PLUS;break;case Be.MINUS:this.state=je.OP_MINUS;break;case Be.I:case Be.i:this.state=je.OP_I;break;default:throw this.fail(e.subarray(n))}break;case je.OP_H:switch(r){case Be.M:case Be.m:this.state=je.OP_M;break;default:throw this.fail(e.subarray(n))}break;case je.OP_M:switch(r){case Be.S:case Be.s:this.state=je.OP_MS;break;default:throw this.fail(e.subarray(n))}break;case je.OP_MS:switch(r){case Be.G:case Be.g:this.state=je.OP_MSG;break;default:throw this.fail(e.subarray(n))}break;case je.OP_MSG:switch(r){case Be.SPACE:case Be.TAB:this.state=je.OP_MSG_SPC;break;default:throw this.fail(e.subarray(n))}break;case je.OP_MSG_SPC:switch(r){case Be.SPACE:case Be.TAB:continue;default:this.state=je.MSG_ARG,this.as=n}break;case je.MSG_ARG:switch(r){case Be.CR:this.drop=1;break;case Be.NL:{const i=this.argBuf?this.argBuf.bytes():e.subarray(this.as,n-this.drop);this.processMsgArgs(i),this.drop=0,this.as=n+1,this.state=je.MSG_PAYLOAD,n=this.as+this.ma.size-1;break}default:this.argBuf&&this.argBuf.writeByte(r)}break;case je.MSG_PAYLOAD:if(this.msgBuf)if(this.msgBuf.length>=this.ma.size){const i=this.msgBuf.bytes({copy:!1});this.dispatcher.push({kind:pr.MSG,msg:this.ma,data:i}),this.argBuf=void 0,this.msgBuf=void 0,this.state=je.MSG_END}else{let i=this.ma.size-this.msgBuf.length;const o=e.length-n;o<i&&(i=o),i>0?(this.msgBuf.write(e.subarray(n,n+i)),n=n+i-1):this.msgBuf.writeByte(r)}else n-this.as>=this.ma.size&&(this.dispatcher.push({kind:pr.MSG,msg:this.ma,data:e.subarray(this.as,n)}),this.argBuf=void 0,this.msgBuf=void 0,this.state=je.MSG_END);break;case je.MSG_END:if(r!==Be.NL)continue;this.drop=0,this.as=n+1,this.state=je.OP_START;break;case je.OP_PLUS:switch(r){case Be.O:case Be.o:this.state=je.OP_PLUS_O;break;default:throw this.fail(e.subarray(n))}break;case je.OP_PLUS_O:switch(r){case Be.K:case Be.k:this.state=je.OP_PLUS_OK;break;default:throw this.fail(e.subarray(n))}break;case je.OP_PLUS_OK:r===Be.NL&&(this.dispatcher.push({kind:pr.OK}),this.drop=0,this.state=je.OP_START);break;case je.OP_MINUS:switch(r){case Be.E:case Be.e:this.state=je.OP_MINUS_E;break;default:throw this.fail(e.subarray(n))}break;case je.OP_MINUS_E:switch(r){case Be.R:case Be.r:this.state=je.OP_MINUS_ER;break;default:throw this.fail(e.subarray(n))}break;case je.OP_MINUS_ER:switch(r){case Be.R:case Be.r:this.state=je.OP_MINUS_ERR;break;default:throw this.fail(e.subarray(n))}break;case je.OP_MINUS_ERR:switch(r){case Be.SPACE:case Be.TAB:this.state=je.OP_MINUS_ERR_SPC;break;default:throw this.fail(e.subarray(n))}break;case je.OP_MINUS_ERR_SPC:switch(r){case Be.SPACE:case Be.TAB:continue;default:this.state=je.MINUS_ERR_ARG,this.as=n}break;case je.MINUS_ERR_ARG:switch(r){case Be.CR:this.drop=1;break;case Be.NL:{let i;this.argBuf?(i=this.argBuf.bytes(),this.argBuf=void 0):i=e.subarray(this.as,n-this.drop),this.dispatcher.push({kind:pr.ERR,data:i}),this.drop=0,this.as=n+1,this.state=je.OP_START;break}default:this.argBuf&&this.argBuf.write(Uint8Array.of(r))}break;case je.OP_P:switch(r){case Be.I:case Be.i:this.state=je.OP_PI;break;case Be.O:case Be.o:this.state=je.OP_PO;break;default:throw this.fail(e.subarray(n))}break;case je.OP_PO:switch(r){case Be.N:case Be.n:this.state=je.OP_PON;break;default:throw this.fail(e.subarray(n))}break;case je.OP_PON:switch(r){case Be.G:case Be.g:this.state=je.OP_PONG;break;default:throw this.fail(e.subarray(n))}break;case je.OP_PONG:r===Be.NL&&(this.dispatcher.push({kind:pr.PONG}),this.drop=0,this.state=je.OP_START);break;case je.OP_PI:switch(r){case Be.N:case Be.n:this.state=je.OP_PIN;break;default:throw this.fail(e.subarray(n))}break;case je.OP_PIN:switch(r){case Be.G:case Be.g:this.state=je.OP_PING;break;default:throw this.fail(e.subarray(n))}break;case je.OP_PING:r===Be.NL&&(this.dispatcher.push({kind:pr.PING}),this.drop=0,this.state=je.OP_START);break;case je.OP_I:switch(r){case Be.N:case Be.n:this.state=je.OP_IN;break;default:throw this.fail(e.subarray(n))}break;case je.OP_IN:switch(r){case Be.F:case Be.f:this.state=je.OP_INF;break;default:throw this.fail(e.subarray(n))}break;case je.OP_INF:switch(r){case Be.O:case Be.o:this.state=je.OP_INFO;break;default:throw this.fail(e.subarray(n))}break;case je.OP_INFO:switch(r){case Be.SPACE:case Be.TAB:this.state=je.OP_INFO_SPC;break;default:throw this.fail(e.subarray(n))}break;case je.OP_INFO_SPC:switch(r){case Be.SPACE:case Be.TAB:continue;default:this.state=je.INFO_ARG,this.as=n}break;case je.INFO_ARG:switch(r){case Be.CR:this.drop=1;break;case Be.NL:{let i;this.argBuf?(i=this.argBuf.bytes(),this.argBuf=void 0):i=e.subarray(this.as,n-this.drop),this.dispatcher.push({kind:pr.INFO,data:i}),this.drop=0,this.as=n+1,this.state=je.OP_START;break}default:this.argBuf&&this.argBuf.writeByte(r)}break;default:throw this.fail(e.subarray(n))}}(this.state===je.MSG_ARG||this.state===je.MINUS_ERR_ARG||this.state===je.INFO_ARG)&&!this.argBuf&&(this.argBuf=new ay(e.subarray(this.as,n-this.drop))),this.state===je.MSG_PAYLOAD&&!this.msgBuf&&(this.argBuf||this.cloneMsgArg(),this.msgBuf=new ay(e.subarray(this.as)))}cloneMsgArg(){const e=this.ma.subject.length,r=new Uint8Array(e+(this.ma.reply?this.ma.reply.length:0));r.set(this.ma.subject),this.ma.reply&&r.set(this.ma.reply,e),this.argBuf=new ay(r),this.ma.subject=r.subarray(0,e),this.ma.reply&&(this.ma.reply=r.subarray(e))}processMsgArgs(e){if(this.hdr>=0)return this.processHeaderMsgArgs(e);const n=[];let r=-1;for(let i=0;i<e.length;i++)switch(e[i]){case Be.SPACE:case Be.TAB:case Be.CR:case Be.NL:r>=0&&(n.push(e.subarray(r,i)),r=-1);break;default:r<0&&(r=i)}switch(r>=0&&n.push(e.subarray(r)),n.length){case 3:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=void 0,this.ma.size=this.protoParseInt(n[2]);break;case 4:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=n[2],this.ma.size=this.protoParseInt(n[3]);break;default:throw this.fail(e,"processMsgArgs Parse Error")}if(this.ma.sid<0)throw this.fail(e,"processMsgArgs Bad or Missing Sid Error");if(this.ma.size<0)throw this.fail(e,"processMsgArgs Bad or Missing Size Error")}fail(e,n=""){return n=n?`${n} [${this.state}]`:`parse error [${this.state}]`,new Error(`${n}: ${ji.decode(e)}`)}processHeaderMsgArgs(e){const n=[];let r=-1;for(let i=0;i<e.length;i++)switch(e[i]){case Be.SPACE:case Be.TAB:case Be.CR:case Be.NL:r>=0&&(n.push(e.subarray(r,i)),r=-1);break;default:r<0&&(r=i)}switch(r>=0&&n.push(e.subarray(r)),n.length){case 4:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=void 0,this.ma.hdr=this.protoParseInt(n[2]),this.ma.size=this.protoParseInt(n[3]);break;case 5:this.ma.subject=n[0],this.ma.sid=this.protoParseInt(n[1]),this.ma.reply=n[2],this.ma.hdr=this.protoParseInt(n[3]),this.ma.size=this.protoParseInt(n[4]);break;default:throw this.fail(e,"processHeaderMsgArgs Parse Error")}if(this.ma.sid<0)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Sid Error");if(this.ma.hdr<0||this.ma.hdr>this.ma.size)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Header Size Error");if(this.ma.size<0)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Size Error")}protoParseInt(e){if(0===e.length)return-1;let n=0;for(let r=0;r<e.length;r++){if(e[r]<48||e[r]>57)return-1;n=10*n+(e[r]-48)}return n}}var je=(()=>{return(t=je||(je={}))[t.OP_START=0]="OP_START",t[t.OP_PLUS=1]="OP_PLUS",t[t.OP_PLUS_O=2]="OP_PLUS_O",t[t.OP_PLUS_OK=3]="OP_PLUS_OK",t[t.OP_MINUS=4]="OP_MINUS",t[t.OP_MINUS_E=5]="OP_MINUS_E",t[t.OP_MINUS_ER=6]="OP_MINUS_ER",t[t.OP_MINUS_ERR=7]="OP_MINUS_ERR",t[t.OP_MINUS_ERR_SPC=8]="OP_MINUS_ERR_SPC",t[t.MINUS_ERR_ARG=9]="MINUS_ERR_ARG",t[t.OP_M=10]="OP_M",t[t.OP_MS=11]="OP_MS",t[t.OP_MSG=12]="OP_MSG",t[t.OP_MSG_SPC=13]="OP_MSG_SPC",t[t.MSG_ARG=14]="MSG_ARG",t[t.MSG_PAYLOAD=15]="MSG_PAYLOAD",t[t.MSG_END=16]="MSG_END",t[t.OP_H=17]="OP_H",t[t.OP_P=18]="OP_P",t[t.OP_PI=19]="OP_PI",t[t.OP_PIN=20]="OP_PIN",t[t.OP_PING=21]="OP_PING",t[t.OP_PO=22]="OP_PO",t[t.OP_PON=23]="OP_PON",t[t.OP_PONG=24]="OP_PONG",t[t.OP_I=25]="OP_I",t[t.OP_IN=26]="OP_IN",t[t.OP_INF=27]="OP_INF",t[t.OP_INFO=28]="OP_INFO",t[t.OP_INFO_SPC=29]="OP_INFO_SPC",t[t.INFO_ARG=30]="INFO_ARG",je;var t})(),Be=(()=>{return(t=Be||(Be={}))[t.CR="\r".charCodeAt(0)]="CR",t[t.E="E".charCodeAt(0)]="E",t[t.e="e".charCodeAt(0)]="e",t[t.F="F".charCodeAt(0)]="F",t[t.f="f".charCodeAt(0)]="f",t[t.G="G".charCodeAt(0)]="G",t[t.g="g".charCodeAt(0)]="g",t[t.H="H".charCodeAt(0)]="H",t[t.h="h".charCodeAt(0)]="h",t[t.I="I".charCodeAt(0)]="I",t[t.i="i".charCodeAt(0)]="i",t[t.K="K".charCodeAt(0)]="K",t[t.k="k".charCodeAt(0)]="k",t[t.M="M".charCodeAt(0)]="M",t[t.m="m".charCodeAt(0)]="m",t[t.MINUS="-".charCodeAt(0)]="MINUS",t[t.N="N".charCodeAt(0)]="N",t[t.n="n".charCodeAt(0)]="n",t[t.NL="\n".charCodeAt(0)]="NL",t[t.O="O".charCodeAt(0)]="O",t[t.o="o".charCodeAt(0)]="o",t[t.P="P".charCodeAt(0)]="P",t[t.p="p".charCodeAt(0)]="p",t[t.PLUS="+".charCodeAt(0)]="PLUS",t[t.R="R".charCodeAt(0)]="R",t[t.r="r".charCodeAt(0)]="r",t[t.S="S".charCodeAt(0)]="S",t[t.s="s".charCodeAt(0)]="s",t[t.SPACE=" ".charCodeAt(0)]="SPACE",t[t.TAB="\t".charCodeAt(0)]="TAB",Be;var t})();const X6=/^INFO\s+([^\r\n]+)\r\n/i;function ss(t=""){if("string"!=typeof(t=t||"_INBOX"))throw new Error("prefix must be a string");return`${t}.${kc.next()}`}class ej{constructor(){R(this,"baseInbox"),R(this,"reqs"),this.reqs=new Map}size(){return this.reqs.size}init(e){return this.baseInbox=`${ss(e)}.`,this.baseInbox}add(e){isNaN(e.received)||(e.received=0),this.reqs.set(e.token,e)}get(e){return this.reqs.get(e)}cancel(e){this.reqs.delete(e.token)}getToken(e){const n=e.subject||"";return 0===n.indexOf(this.baseInbox)?n.substring(this.baseInbox.length):null}all(){return Array.from(this.reqs.values())}handleError(e,n){if(n&&n.permissionContext){if(e)return this.all().forEach(i=>{i.resolver(n,{})}),!0;const r=n.permissionContext;if("publish"===r.operation){const i=this.all().find(o=>o.requestSubject===r.subject);if(i)return i.resolver(n,{}),!0}}return!1}dispatcher(){return(e,n)=>{const r=this.getToken(n);if(r){const i=this.get(r);i&&(null===e&&n.headers&&(e=aE(n)),i.resolver(e,n))}}}close(){const e=Ye.errorForCode(Ne.Timeout);this.reqs.forEach(n=>{n.resolver(e,{})})}}const tj=Mc("PONG\r\n"),DE=Mc("PING\r\n");class nj{constructor(e,n,r){R(this,"echo"),R(this,"no_responders"),R(this,"protocol"),R(this,"verbose"),R(this,"pedantic"),R(this,"jwt"),R(this,"nkey"),R(this,"sig"),R(this,"user"),R(this,"pass"),R(this,"auth_token"),R(this,"tls_required"),R(this,"name"),R(this,"lang"),R(this,"version"),R(this,"headers"),this.protocol=1,this.version=e.version,this.lang=e.lang,this.echo=!n.noEcho&&void 0,this.verbose=n.verbose,this.pedantic=n.pedantic,this.tls_required=!!n.tls||void 0,this.name=n.name,oh(this,(n&&n.authenticator?n.authenticator(r):{})||{})}}class ph{constructor(e,n){R(this,"connected"),R(this,"connectedOnce"),R(this,"infoReceived"),R(this,"info"),R(this,"muxSubscriptions"),R(this,"options"),R(this,"outbound"),R(this,"pongs"),R(this,"subscriptions"),R(this,"transport"),R(this,"noMorePublishing"),R(this,"connectError"),R(this,"publisher"),R(this,"_closed"),R(this,"closed"),R(this,"listeners"),R(this,"heartbeats"),R(this,"parser"),R(this,"outMsgs"),R(this,"inMsgs"),R(this,"outBytes"),R(this,"inBytes"),R(this,"pendingLimit"),R(this,"lastError"),R(this,"abortReconnect"),R(this,"servers"),R(this,"server"),R(this,"features"),this._closed=!1,this.connected=!1,this.connectedOnce=!1,this.infoReceived=!1,this.noMorePublishing=!1,this.abortReconnect=!1,this.listeners=[],this.pendingLimit=32768,this.outMsgs=0,this.inMsgs=0,this.outBytes=0,this.inBytes=0,this.options=e,this.publisher=n,this.subscriptions=new K6,this.muxSubscriptions=new ej,this.outbound=new Pc,this.pongs=[],this.pendingLimit=e.pendingLimit||this.pendingLimit,this.features=new _6({major:0,minor:0,micro:0}),this.servers=new z6("string"==typeof e.servers?[e.servers]:e.servers,{randomize:!e.noRandomize}),this.closed=vn(),this.parser=new xE(this),this.heartbeats=new W6(this,this.options.pingInterval||12e4,this.options.maxPingOut||2)}resetOutbound(){this.outbound.reset();const e=this.pongs;this.pongs=[];const n=Ye.errorForCode(Ne.Disconnect);n.stack="",e.forEach(r=>{r.reject(n)}),this.parser=new xE(this),this.infoReceived=!1}dispatchStatus(e){this.listeners.forEach(n=>{n.push(e)})}status(){const e=new Br;return this.listeners.push(e),e}prepare(){var e=this;this.info=void 0,this.resetOutbound();const n=vn();return n.catch(()=>{}),this.pongs.unshift(n),this.connectError=r=>{n.reject(r)},this.transport=function N6(){if(!ri||"function"!=typeof ri.factory)throw new Error("transport fn is not set");return ri.factory()}(),this.transport.closed().then(function(){var r=Oe(function*(i){e.connected=!1,e.isClosed()||(yield e.disconnected(e.transport.closeError||e.lastError))});return function(i){return r.apply(this,arguments)}}()),n}disconnect(){this.dispatchStatus({type:Za.StaleConnection,data:""}),this.transport.disconnect()}disconnected(e){var n=this;return Oe(function*(){n.dispatchStatus({type:ns.Disconnect,data:n.servers.getCurrentServer().toString()}),n.options.reconnect?yield n.dialLoop().then(()=>{n.dispatchStatus({type:ns.Reconnect,data:n.servers.getCurrentServer().toString()}),n.lastError?.code===Ne.AuthenticationExpired&&(n.lastError=void 0)}).catch(r=>{n._close(r)}):yield n._close(e)})()}dial(e){var n=this;return Oe(function*(){const r=n.prepare();let i;try{i=ah(n.options.timeout||2e4);const o=n.transport.connect(e,n.options);yield Promise.race([o,i]),Oe(function*(){try{var l,s=!1,a=!1;try{for(var g,h=Oi(n.transport);s=!(g=yield h.next()).done;s=!1)n.parser.parse(g.value)}catch(m){a=!0,l=m}finally{try{s&&null!=h.return&&(yield h.return())}finally{if(a)throw l}}}catch(m){console.log("reader closed",m)}})().then()}catch(o){r.reject(o)}try{yield Promise.race([i,r]),i&&i.cancel(),n.connected=!0,n.connectError=void 0,n.sendSubscriptions(),n.connectedOnce=!0,n.server.didConnect=!0,n.server.reconnects=0,n.flushPending(),n.heartbeats.start()}catch(o){throw i&&i.cancel(),yield n.transport.close(o),o}})()}_doDial(e){var n=this;return Oe(function*(){const r=yield e.resolve({fn:_E(),debug:n.options.debug,randomize:!n.options.noRandomize});let i=null;for(const o of r)try{return i=null,n.dispatchStatus({type:Za.Reconnecting,data:o.toString()}),void(yield n.dial(o))}catch(s){i=s}throw i})()}dialLoop(){var e=this;return Oe(function*(){let n;for(;;){e._closed&&e.servers.clear();const r=e.options.reconnectDelayHandler?e.options.reconnectDelayHandler():2e3;let i=r;const o=e.selectServer();if(!o||e.abortReconnect)throw n||(e.lastError?e.lastError:Ye.errorForCode(Ne.ConnectionRefused));const s=Date.now();if(0===o.lastConnect||o.lastConnect+r<=s){o.lastConnect=Date.now();try{yield e._doDial(o);break}catch(a){if(n=a,!e.connectedOnce){if(e.options.waitOnFirstConnect)continue;e.servers.removeCurrentServer()}o.reconnects++;const l=e.options.maxReconnectAttempts||0;-1!==l&&o.reconnects>=l&&e.servers.removeCurrentServer()}}else i=Math.min(i,o.lastConnect+r-s),yield Qm(i)}})()}static connect(e,n){return Oe(function*(){const r=new ph(e,n);return yield r.dialLoop(),r})()}static toError(e){const n=e?e.toLowerCase():"";if(-1!==n.indexOf("permissions violation")){const r=new Ye(e,Ne.PermissionsViolation),i=e.match(/(Publish|Subscription) to "(\S+)"/);return i&&(r.permissionContext={operation:i[1].toLowerCase(),subject:i[2]}),r}return-1!==n.indexOf("authorization violation")?new Ye(e,Ne.AuthorizationViolation):-1!==n.indexOf("user authentication expired")?new Ye(e,Ne.AuthenticationExpired):new Ye(e,Ne.ProtocolError)}processMsg(e,n){if(this.inMsgs++,this.inBytes+=n.length,!this.subscriptions.sidCounter)return;const r=this.subscriptions.get(e.sid);!r||(r.received+=1,r.callback&&r.callback(null,new uE(e,n,this)),void 0!==r.max&&r.received>=r.max&&r.unsubscribe())}processError(e){const n=XC(e),r=ph.toError(n),i={type:ns.Error,data:r.code};if(r.isPermissionError()){let o=!1;r.permissionContext&&(i.permissionContext=r.permissionContext,o=this.subscriptions.getMux()?.subject===r.permissionContext.subject),this.subscriptions.handleError(r),this.muxSubscriptions.handleError(o,r),o&&this.subscriptions.setMux(null)}this.dispatchStatus(i),this.handleError(r)}handleError(e){e.isAuthError()&&this.handleAuthError(e),e.isProtocolError()&&(this.lastError=e),e.isPermissionError()||(this.lastError=e)}handleAuthError(e){this.lastError&&e.code===this.lastError.code&&!1===this.options.ignoreAuthErrorAbort&&(this.abortReconnect=!0),this.connectError?this.connectError(e):this.disconnect()}processPing(){this.transport.send(tj)}processPong(){const e=this.pongs.shift();e&&e.resolve()}processInfo(e){const n=JSON.parse(XC(e));this.info=n;const r=this.options&&this.options.ignoreClusterUpdates?void 0:this.servers.update(n);if(!this.infoReceived){this.features.update(Bs(n.version)),this.infoReceived=!0,this.transport.isEncrypted()&&this.servers.updateTLSName();const{version:o,lang:s}=this.transport;try{const a=new nj({version:o,lang:s},this.options,n.nonce);n.headers&&(a.headers=!0,a.no_responders=!0);const l=JSON.stringify(a);this.transport.send(Mc(`CONNECT ${l}\r\n`)),this.transport.send(DE)}catch(a){this._close(a)}}r&&this.dispatchStatus({type:ns.Update,data:r}),void 0!==n.ldm&&n.ldm&&this.dispatchStatus({type:ns.LDM,data:this.servers.getCurrentServer().toString()})}push(e){switch(e.kind){case pr.MSG:{const{msg:n,data:r}=e;this.processMsg(n,r);break}case pr.OK:break;case pr.ERR:this.processError(e.data);break;case pr.PING:this.processPing();break;case pr.PONG:this.processPong();break;case pr.INFO:this.processInfo(e.data)}}sendCommand(e,...n){const r=this.outbound.length();let i;i="string"==typeof e?Mc(e):e,this.outbound.fill(i,...n),0===r?setTimeout(()=>{this.flushPending()}):this.outbound.size()>=this.pendingLimit&&this.flushPending()}publish(e,n,r){let i=n.length;(r=r||{}).reply=r.reply||"";let a,o=fr,s=0;if(r.headers){if(this.info&&!this.info.headers)throw new Ye("headers",Ne.ServerOptionNotAvailable);o=r.headers.encode(),s=o.length,i=n.length+s}if(this.info&&i>this.info.max_payload)throw Ye.errorForCode(Ne.MaxPayloadExceeded);this.outBytes+=i,this.outMsgs++,r.headers?(a=r.reply?`HPUB ${e} ${r.reply} ${s} ${i}\r\n`:`HPUB ${e} ${s} ${i}\r\n`,this.sendCommand(a,o,n,ih)):(a=r.reply?`PUB ${e} ${r.reply} ${i}\r\n`:`PUB ${e} ${i}\r\n`,this.sendCommand(a,n,ih))}request(e){return this.initMux(),this.muxSubscriptions.add(e),e}subscribe(e){return this.subscriptions.add(e),this._subunsub(e),e}_sub(e){this.sendCommand(e.queue?`SUB ${e.subject} ${e.queue} ${e.sid}\r\n`:`SUB ${e.subject} ${e.sid}\r\n`)}_subunsub(e){return this._sub(e),e.max&&this.unsubscribe(e,e.max),e}unsubscribe(e,n){this.unsub(e,n),(void 0===e.max||e.received>=e.max)&&this.subscriptions.cancel(e)}unsub(e,n){!e||this.isClosed()||(this.sendCommand(n?`UNSUB ${e.sid} ${n}\r\n`:`UNSUB ${e.sid}\r\n`),e.max=n)}resub(e,n){!e||this.isClosed()||(e.subject=n,this.subscriptions.resub(e),this._sub(e))}flush(e){return e||(e=vn()),this.pongs.push(e),this.sendCommand(DE),e}sendSubscriptions(){const e=[];this.subscriptions.all().forEach(n=>{e.push(n.queue?`SUB ${n.subject} ${n.queue} ${n.sid}\r\n`:`SUB ${n.subject} ${n.sid}\r\n`)}),e.length&&this.transport.send(Mc(e.join("")))}_close(e){var n=this;return Oe(function*(){n._closed||(n.heartbeats.cancel(),n.connectError&&(n.connectError(e),n.connectError=void 0),n.muxSubscriptions.close(),n.subscriptions.close(),n.listeners.forEach(r=>{r.stop()}),n._closed=!0,yield n.transport.close(e),yield n.closed.resolve(e))})()}close(){return this._close()}isClosed(){return this._closed}drain(){var e=this;const n=this.subscriptions.all(),r=[];return n.forEach(i=>{r.push(i.drain())}),Promise.all(r).then(Oe(function*(){return e.noMorePublishing=!0,yield e.flush(),e.close()})).catch(()=>{})}flushPending(){if(this.infoReceived&&this.connected&&this.outbound.size()){const e=this.outbound.drain();this.transport.send(e)}}initMux(){if(!this.subscriptions.getMux()){const n=this.muxSubscriptions.init(this.options.inboxPrefix),r=new SE(this,`${n}*`);r.callback=this.muxSubscriptions.dispatcher(),this.subscriptions.setMux(r),this.subscribe(r)}}selectServer(){const e=this.servers.selectServer();if(void 0!==e)return this.server=e,this.server}getServer(){return this.server}}function as(t){return new rj(t)}class rj{constructor(e){R(this,"config"),R(this,"ordered"),R(this,"mack"),R(this,"stream"),R(this,"callbackFn"),R(this,"max"),R(this,"qname"),R(this,"isBind"),this.stream="",this.mack=!1,this.ordered=!1,this.config=function g6(t,e={}){return Object.assign({name:t,deliver_policy:jr.All,ack_policy:Yn.Explicit,ack_wait:Gn(3e4),replay_policy:Ls.Instant},e)}("",e||{})}getOpts(){const e={};return e.config=this.config,e.mack=this.mack,e.stream=this.stream,e.callbackFn=this.callbackFn,e.max=this.max,e.queue=this.qname,e.ordered=this.ordered,e.config.ack_policy=e.ordered?Yn.None:e.config.ack_policy,e.isBind=e.isBind||!1,e}description(e){return this.config.description=e,this}deliverTo(e){return this.config.deliver_subject=e,this}durable(e){return Xa(e),this.config.durable_name=e,this}startSequence(e){if(e<=0)throw new Error("sequence must be greater than 0");return this.config.deliver_policy=jr.StartSequence,this.config.opt_start_seq=e,this}startTime(e){return this.config.deliver_policy=jr.StartTime,this.config.opt_start_time=e.toISOString(),this}deliverAll(){return this.config.deliver_policy=jr.All,this}deliverLastPerSubject(){return this.config.deliver_policy=jr.LastPerSubject,this}deliverLast(){return this.config.deliver_policy=jr.Last,this}deliverNew(){return this.config.deliver_policy=jr.New,this}startAtTimeDelta(e){return this.startTime(new Date(Date.now()-e)),this}headersOnly(){return this.config.headers_only=!0,this}ackNone(){return this.config.ack_policy=Yn.None,this}ackAll(){return this.config.ack_policy=Yn.All,this}ackExplicit(){return this.config.ack_policy=Yn.Explicit,this}ackWait(e){return this.config.ack_wait=Gn(e),this}maxDeliver(e){return this.config.max_deliver=e,this}filterSubject(e){return this.config.filter_subject=e,this}replayInstantly(){return this.config.replay_policy=Ls.Instant,this}replayOriginal(){return this.config.replay_policy=Ls.Original,this}sample(e){if((e=Math.trunc(e))<0||e>100)throw new Error("value must be between 0-100");return this.config.sample_freq=`${e}%`,this}limit(e){return this.config.rate_limit_bps=e,this}maxWaiting(e){return this.config.max_waiting=e,this}maxAckPending(e){return this.config.max_ack_pending=e,this}idleHeartbeat(e){return this.config.idle_heartbeat=Gn(e),this}flowControl(){return this.config.flow_control=!0,this}deliverGroup(e){return this.queue(e),this}manualAck(){return this.mack=!0,this}maxMessages(e){return this.max=e,this}callback(e){return this.callbackFn=e,this}queue(e){return this.qname=e,this.config.deliver_group=e,this}orderedConsumer(){return this.ordered=!0,this}bind(e,n){return this.stream=e,this.config.durable_name=n,this.isBind=!0,this}bindStream(e){return this.stream=e,this}inactiveEphemeralThreshold(e){return this.config.inactive_threshold=Gn(e),this}maxPullBatch(e){return this.config.max_batch=e,this}maxPullRequestExpires(e){return this.config.max_expires=Gn(e),this}memory(){return this.config.mem_storage=!0,this}numReplicas(e){return this.config.num_replicas=e,this}}function AE(t){return"function"==typeof t.getOpts}class IE{constructor(e,n,r={maxOut:2}){R(this,"interval"),R(this,"maxOut"),R(this,"cancelAfter"),R(this,"timer"),R(this,"autoCancelTimer"),R(this,"last"),R(this,"missed"),R(this,"count"),R(this,"callback"),this.interval=e,this.maxOut=r?.maxOut||2,this.cancelAfter=r?.cancelAfter||0,this.last=Date.now(),this.missed=0,this.count=0,this.callback=n,this._schedule()}cancel(){this.autoCancelTimer&&clearTimeout(this.autoCancelTimer),this.timer&&clearInterval(this.timer),this.timer=0,this.autoCancelTimer=0}work(){this.last=Date.now(),this.missed=0}_change(e,n=0,r=2){this.interval=e,this.maxOut=r,this.cancelAfter=n,this.restart()}restart(){this.cancel(),this._schedule()}_schedule(){this.cancelAfter>0&&(this.autoCancelTimer=setTimeout(()=>{this.cancel()},this.cancelAfter)),this.timer=setInterval(()=>{if(this.count++,Date.now()-this.interval>this.last&&this.missed++,this.missed>=this.maxOut)try{!0===this.callback(this.missed)&&this.cancel()}catch(e){console.log(e)}},this.interval)}}class Vc{static encode(e){return Vc.toB64URLEncoding(class ij{static encode(e){if("string"==typeof e)return btoa(e);const n=Array.from(e);return btoa(String.fromCharCode(...n))}static decode(e,n=!1){const r=atob(e);return n?Uint8Array.from(r,i=>i.charCodeAt(0)):r}}.encode(e))}static decode(e,n=!1){return Vc.decode(Vc.fromB64URLEncoding(e),n)}static toB64URLEncoding(e){return e.replace(/\+/g,"-").replace(/\//g,"_")}static fromB64URLEncoding(e){return e.replace(/_/g,"/").replace(/-/g,"+")}}function FE(t){const e=t.length;let n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}const TE=[],ME=[],uy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";for(let t=0,e=uy.length;t<e;++t)TE[t]=uy[t],ME[uy.charCodeAt(t)]=t;const{toUint8Array:sj,fromUint8Array:aj}=function oj(t,e,n=!1){function r(s,a){return Math.floor(3*(s+a)/4-a)}function i(s){return t[s>>18&63]+t[s>>12&63]+t[s>>6&63]+t[63&s]}function o(s,a,l){const h=new Array((l-a)/3);for(let g=a,m=0;g<l;g+=3)h[m++]=i((s[g]<<16)+(s[g+1]<<8)+s[g+2]);return h.join("")}return{byteLength:s=>r.apply(null,FE(s)),toUint8Array(s){const[a,l]=FE(s),h=new Uint8Array(r(a,l)),g=l?a-4:a;let m,D,C=0;for(D=0;D<g;D+=4)m=e[s.charCodeAt(D)]<<18|e[s.charCodeAt(D+1)]<<12|e[s.charCodeAt(D+2)]<<6|e[s.charCodeAt(D+3)],h[C++]=m>>16&255,h[C++]=m>>8&255,h[C++]=255&m;return 2===l?(m=e[s.charCodeAt(D)]<<2|e[s.charCodeAt(D+1)]>>4,h[C++]=255&m):1===l&&(m=e[s.charCodeAt(D)]<<10|e[s.charCodeAt(D+1)]<<4|e[s.charCodeAt(D+2)]>>2,h[C++]=m>>8&255,h[C++]=255&m),h},fromUint8Array(s){const l=s.length,h=l%3,g=l-h,m=new Array(Math.ceil(g/16383)+(h?1:0));let D,q,C=0;for(let he=0;he<g;he+=16383)D=he+16383,m[C++]=o(s,he,D>g?g:D);return 1===h?(q=s[g],m[C]=t[q>>2]+t[q<<4&63],n||(m[C]+="==")):2===h&&(q=s[g]<<8|255&s[g+1],m[C]=t[q>>10]+t[q>>4&63]+t[q<<2&63],n||(m[C]+="=")),m.join("")}}}(TE,ME,!0),uj=new TextDecoder,cj=new TextEncoder;class PE{constructor(){R(this,"hashSize",32),R(this,"_buf"),R(this,"_bufIdx"),R(this,"_count"),R(this,"_K"),R(this,"_H"),R(this,"_finalized"),this._buf=new Uint8Array(64),this._K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),this.init()}init(){return this._H=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),this._bufIdx=0,this._count=new Uint32Array(2),this._buf.fill(0),this._finalized=!1,this}update(e,n){if(null===e)throw new TypeError("msg must be a string or Uint8Array.");"string"==typeof e&&(e=function fj(t,e="utf8"){if(/^utf-?8$/i.test(e))return cj.encode(t);if(/^base64$/i.test(e))return sj(t);if(/^hex(?:adecimal)?$/i.test(e))return function dj(t){const e=t.length;if(e%2||!/^[0-9a-fA-F]+$/.test(t))throw new TypeError("Invalid hex string.");t=t.toLowerCase();const n=new Uint8Array(Math.floor(e/2)),r=e/2;for(let i=0;i<r;++i)n[i]=parseInt(t.substr(2*i,2),16);return n}(t);throw new TypeError("Unsupported string encoding.")}(e,n));for(let i=0,o=e.length;i<o;i++)this._buf[this._bufIdx++]=e[i],64===this._bufIdx&&(this._transform(),this._bufIdx=0);const r=this._count;return(r[0]+=e.length<<3)<e.length<<3&&r[1]++,r[1]+=e.length>>>29,this}digest(e){if(this._finalized)throw new Error("digest has already been called.");this._finalized=!0;const n=this._buf;let r=this._bufIdx;for(n[r++]=128;56!==r;)64===r&&(this._transform(),r=0),n[r++]=0;const i=this._count;n[56]=i[1]>>>24&255,n[57]=i[1]>>>16&255,n[58]=i[1]>>>8&255,n[59]=i[1]>>>0&255,n[60]=i[0]>>>24&255,n[61]=i[0]>>>16&255,n[62]=i[0]>>>8&255,n[63]=i[0]>>>0&255,this._transform();const o=new Uint8Array(32);for(let s=0;s<8;s++)o[0+(s<<2)]=this._H[s]>>>24&255,o[1+(s<<2)]=this._H[s]>>>16&255,o[2+(s<<2)]=this._H[s]>>>8&255,o[3+(s<<2)]=this._H[s]>>>0&255;return this.init(),e?function hj(t,e="utf8"){if(/^utf-?8$/i.test(e))return uj.decode(t);if(/^base64$/i.test(e))return aj(t);if(/^hex(?:adecimal)?$/i.test(e))return function lj(t){return t.reduce((e,n)=>`${e}${n<16?"0":""}${n.toString(16)}`,"")}(t);throw new TypeError("Unsupported string encoding.")}(o,e):o}_transform(){const e=this._H;let n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],h=e[7];const g=new Uint32Array(16);let m;for(m=0;m<16;m++)g[m]=this._buf[3+(m<<2)]|this._buf[2+(m<<2)]<<8|this._buf[1+(m<<2)]<<16|this._buf[m<<2]<<24;for(m=0;m<64;m++){let C;if(m<16)C=g[m];else{let D=g[m+1&15],q=g[m+14&15];C=g[15&m]=(D>>>7^D>>>18^D>>>3^D<<25^D<<14)+(q>>>17^q>>>19^q>>>10^q<<15^q<<13)+g[15&m]+g[m+9&15]|0}C=C+h+(s>>>6^s>>>11^s>>>25^s<<26^s<<21^s<<7)+(l^s&(a^l))+this._K[m]|0,h=l,l=a,a=s,s=o+C,o=i,i=r,r=n,n=C+(r&i^o&(r^i))+(r>>>2^r>>>13^r>>>22^r<<30^r<<19^r<<10)|0}e[0]=e[0]+n|0,e[1]=e[1]+r|0,e[2]=e[2]+i|0,e[3]=e[3]+o|0,e[4]=e[4]+s|0,e[5]=e[5]+a|0,e[6]=e[6]+l|0,e[7]=e[7]+h|0}}class pj extends Oc{constructor(e,n){super(e,n)}getMessage(e,n){var r=this;return Oe(function*(){Vr(e);let i=n;const{last_by_subj:o}=i;o&&(i=null);const s=i?r.jc.encode(i):fr,a=r.opts.apiPrefix||"$JS.API",l=o?`${a}.DIRECT.GET.${e}.${o}`:`${a}.DIRECT.GET.${e}`,h=yield r.nc.request(l,s),g=eu(h);if(g)return Promise.reject(g);const m=new gj(h);return Promise.resolve(m)})()}}class gj{constructor(e){if(R(this,"data"),R(this,"header"),!e.headers)throw new Error("headers expected");this.data=e.data,this.header=e.headers}get subject(){return this.header.get(js.Subject)}get seq(){const e=this.header.get(js.Sequence);return"string"==typeof e?parseInt(e):0}get time(){return new Date(Date.parse(this.header.get(js.TimeStamp)))}get stream(){return this.header.get(js.Stream)}}!function(t){var e=function(F,V){this.hi=0|F,this.lo=0|V},n=function(F){var V,j=new Float64Array(16);if(F)for(V=0;V<F.length;V++)j[V]=F[V];return j},r=function(){throw new Error("no PRNG")},i=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var s=n(),a=n([1]),l=n([56129,1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),C=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),D=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function q(F,V){return F<<V|F>>>32-V}function he(F,V){var j=255&F[V+3];return(j=(j=j<<8|255&F[V+2])<<8|255&F[V+1])<<8|255&F[V+0]}function Se(F,V){return new e(F[V]<<24|F[V+1]<<16|F[V+2]<<8|F[V+3],F[V+4]<<24|F[V+5]<<16|F[V+6]<<8|F[V+7])}function xe(F,V,j){var K;for(K=0;K<4;K++)F[V+K]=255&j,j>>>=8}function Fe(F,V,j){F[V]=j.hi>>24&255,F[V+1]=j.hi>>16&255,F[V+2]=j.hi>>8&255,F[V+3]=255&j.hi,F[V+4]=j.lo>>24&255,F[V+5]=j.lo>>16&255,F[V+6]=j.lo>>8&255,F[V+7]=255&j.lo}function Ce(F,V,j,K,de){var ge,Ie=0;for(ge=0;ge<de;ge++)Ie|=F[V+ge]^j[K+ge];return(1&Ie-1>>>8)-1}function We(F,V,j,K){return Ce(F,V,j,K,16)}function bt(F,V,j,K){return Ce(F,V,j,K,32)}function Ut(F,V,j,K,de){var Ae,Ze,Mt,ge=new Uint32Array(16),Ie=new Uint32Array(16),Re=new Uint32Array(16),be=new Uint32Array(4);for(Ae=0;Ae<4;Ae++)Ie[5*Ae]=he(K,4*Ae),Ie[1+Ae]=he(j,4*Ae),Ie[6+Ae]=he(V,4*Ae),Ie[11+Ae]=he(j,16+4*Ae);for(Ae=0;Ae<16;Ae++)Re[Ae]=Ie[Ae];for(Ae=0;Ae<20;Ae++){for(Ze=0;Ze<4;Ze++){for(Mt=0;Mt<4;Mt++)be[Mt]=Ie[(5*Ze+4*Mt)%16];for(be[1]^=q(be[0]+be[3]|0,7),be[2]^=q(be[1]+be[0]|0,9),be[3]^=q(be[2]+be[1]|0,13),be[0]^=q(be[3]+be[2]|0,18),Mt=0;Mt<4;Mt++)ge[4*Ze+(Ze+Mt)%4]=be[Mt]}for(Mt=0;Mt<16;Mt++)Ie[Mt]=ge[Mt]}if(de){for(Ae=0;Ae<16;Ae++)Ie[Ae]=Ie[Ae]+Re[Ae]|0;for(Ae=0;Ae<4;Ae++)Ie[5*Ae]=Ie[5*Ae]-he(K,4*Ae)|0,Ie[6+Ae]=Ie[6+Ae]-he(V,4*Ae)|0;for(Ae=0;Ae<4;Ae++)xe(F,4*Ae,Ie[5*Ae]),xe(F,16+4*Ae,Ie[6+Ae])}else for(Ae=0;Ae<16;Ae++)xe(F,4*Ae,Ie[Ae]+Re[Ae]|0)}function mr(F,V,j,K){return Ut(F,V,j,K,!1),0}function Vi(F,V,j,K){return Ut(F,V,j,K,!0),0}var Ui=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function so(F,V,j,K,de,ge,Ie){var Ae,Ze,Re=new Uint8Array(16),be=new Uint8Array(64);if(!de)return 0;for(Ze=0;Ze<16;Ze++)Re[Ze]=0;for(Ze=0;Ze<8;Ze++)Re[Ze]=ge[Ze];for(;de>=64;){for(mr(be,Re,Ie,Ui),Ze=0;Ze<64;Ze++)F[V+Ze]=(j?j[K+Ze]:0)^be[Ze];for(Ae=1,Ze=8;Ze<16;Ze++)Re[Ze]=255&(Ae=Ae+(255&Re[Ze])|0),Ae>>>=8;de-=64,V+=64,j&&(K+=64)}if(de>0)for(mr(be,Re,Ie,Ui),Ze=0;Ze<de;Ze++)F[V+Ze]=(j?j[K+Ze]:0)^be[Ze];return 0}function ao(F,V,j,K,de){return so(F,V,null,0,j,K,de)}function iu(F,V,j,K,de){var ge=new Uint8Array(32);return Vi(ge,K,de,Ui),ao(F,V,j,K.subarray(16),ge)}function $s(F,V,j,K,de,ge,Ie){var Re=new Uint8Array(32);return Vi(Re,ge,Ie,Ui),so(F,V,j,K,de,ge.subarray(16),Re)}function qs(F,V){var j,K=0;for(j=0;j<17;j++)F[j]=255&(K=K+(F[j]+V[j]|0)|0),K>>>=8}var Kc=new Uint32Array([5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252]);function Gs(F,V,j,K,de,ge){var Ie,Re,be,Ae,Ze=new Uint32Array(17),Mt=new Uint32Array(17),_n=new Uint32Array(17),qi=new Uint32Array(17),cu=new Uint32Array(17);for(be=0;be<17;be++)Mt[be]=_n[be]=0;for(be=0;be<16;be++)Mt[be]=ge[be];for(Mt[3]&=15,Mt[4]&=252,Mt[7]&=15,Mt[8]&=252,Mt[11]&=15,Mt[12]&=252,Mt[15]&=15;de>0;){for(be=0;be<17;be++)qi[be]=0;for(be=0;be<16&&be<de;++be)qi[be]=j[K+be];for(qi[be]=1,K+=be,de-=be,qs(_n,qi),Re=0;Re<17;Re++)for(Ze[Re]=0,be=0;be<17;be++)Ze[Re]=0|Ze[Re]+_n[be]*(be<=Re?Mt[Re-be]:320*Mt[Re+17-be]|0);for(Re=0;Re<17;Re++)_n[Re]=Ze[Re];for(Ae=0,be=0;be<16;be++)_n[be]=255&(Ae=Ae+_n[be]|0),Ae>>>=8;for(_n[16]=3&(Ae=Ae+_n[16]|0),Ae=5*(Ae>>>2)|0,be=0;be<16;be++)_n[be]=255&(Ae=Ae+_n[be]|0),Ae>>>=8;_n[16]=Ae=Ae+_n[16]|0}for(be=0;be<17;be++)cu[be]=_n[be];for(qs(_n,Kc),Ie=0|-(_n[16]>>>7),be=0;be<17;be++)_n[be]^=Ie&(cu[be]^_n[be]);for(be=0;be<16;be++)qi[be]=ge[be+16];for(qi[16]=0,qs(_n,qi),be=0;be<16;be++)F[V+be]=_n[be];return 0}function oD(F,V,j,K,de,ge){var Ie=new Uint8Array(16);return Gs(Ie,0,j,K,de,ge),We(F,V,Ie,0)}function Ly(F,V,j,K,de){var ge;if(j<32)return-1;for($s(F,0,V,0,j,K,de),Gs(F,16,F,32,j-32,F),ge=0;ge<16;ge++)F[ge]=0;return 0}function jy(F,V,j,K,de){var ge,Ie=new Uint8Array(32);if(j<32||(iu(Ie,0,32,K,de),0!==oD(V,16,V,32,j-32,Ie)))return-1;for($s(F,0,V,0,j,K,de),ge=0;ge<32;ge++)F[ge]=0;return 0}function Po(F,V){var j;for(j=0;j<16;j++)F[j]=0|V[j]}function Wc(F){var V,j;for(j=0;j<16;j++)F[j]+=65536,V=Math.floor(F[j]/65536),F[(j+1)*(j<15?1:0)]+=V-1+37*(V-1)*(15===j?1:0),F[j]-=65536*V}function ou(F,V,j){for(var K,de=~(j-1),ge=0;ge<16;ge++)F[ge]^=K=de&(F[ge]^V[ge]),V[ge]^=K}function su(F,V){var j,K,de,ge=n(),Ie=n();for(j=0;j<16;j++)Ie[j]=V[j];for(Wc(Ie),Wc(Ie),Wc(Ie),K=0;K<2;K++){for(ge[0]=Ie[0]-65517,j=1;j<15;j++)ge[j]=Ie[j]-65535-(ge[j-1]>>16&1),ge[j-1]&=65535;ge[15]=Ie[15]-32767-(ge[14]>>16&1),de=ge[15]>>16&1,ge[14]&=65535,ou(Ie,ge,1-de)}for(j=0;j<16;j++)F[2*j]=255&Ie[j],F[2*j+1]=Ie[j]>>8}function sD(F,V){var j=new Uint8Array(32),K=new Uint8Array(32);return su(j,F),su(K,V),bt(j,0,K,0)}function aD(F){var V=new Uint8Array(32);return su(V,F),1&V[0]}function By(F,V){var j;for(j=0;j<16;j++)F[j]=V[2*j]+(V[2*j+1]<<8);F[15]&=32767}function Hi(F,V,j){var K;for(K=0;K<16;K++)F[K]=V[K]+j[K]|0}function $i(F,V,j){var K;for(K=0;K<16;K++)F[K]=V[K]-j[K]|0}function Tt(F,V,j){var K,de,ge=new Float64Array(31);for(K=0;K<31;K++)ge[K]=0;for(K=0;K<16;K++)for(de=0;de<16;de++)ge[K+de]+=V[K]*j[de];for(K=0;K<15;K++)ge[K]+=38*ge[K+16];for(K=0;K<16;K++)F[K]=ge[K];Wc(F),Wc(F)}function wi(F,V){Tt(F,V,V)}function uD(F,V){var K,j=n();for(K=0;K<16;K++)j[K]=V[K];for(K=253;K>=0;K--)wi(j,j),2!==K&&4!==K&&Tt(j,j,V);for(K=0;K<16;K++)F[K]=j[K]}function cD(F,V){var K,j=n();for(K=0;K<16;K++)j[K]=V[K];for(K=250;K>=0;K--)wi(j,j),1!==K&&Tt(j,j,V);for(K=0;K<16;K++)F[K]=j[K]}function Bh(F,V,j){var ge,Ie,K=new Uint8Array(32),de=new Float64Array(80),Re=n(),be=n(),Ae=n(),Ze=n(),Mt=n(),_n=n();for(Ie=0;Ie<31;Ie++)K[Ie]=V[Ie];for(K[31]=127&V[31]|64,K[0]&=248,By(de,j),Ie=0;Ie<16;Ie++)be[Ie]=de[Ie],Ze[Ie]=Re[Ie]=Ae[Ie]=0;for(Re[0]=Ze[0]=1,Ie=254;Ie>=0;--Ie)ou(Re,be,ge=K[Ie>>>3]>>>(7&Ie)&1),ou(Ae,Ze,ge),Hi(Mt,Re,Ae),$i(Re,Re,Ae),Hi(Ae,be,Ze),$i(be,be,Ze),wi(Ze,Mt),wi(_n,Re),Tt(Re,Ae,Re),Tt(Ae,be,Mt),Hi(Mt,Re,Ae),$i(Re,Re,Ae),wi(be,Re),$i(Ae,Ze,_n),Tt(Re,Ae,l),Hi(Re,Re,Ze),Tt(Ae,Ae,Re),Tt(Re,Ze,_n),Tt(Ze,be,de),wi(be,Mt),ou(Re,be,ge),ou(Ae,Ze,ge);for(Ie=0;Ie<16;Ie++)de[Ie+16]=Re[Ie],de[Ie+32]=Ae[Ie],de[Ie+48]=be[Ie],de[Ie+64]=Ze[Ie];var qi=de.subarray(32),cu=de.subarray(16);return uD(qi,qi),Tt(cu,cu,qi),su(F,cu),0}function Vh(F,V){return Bh(F,V,o)}function lD(F,V){return r(V,32),Vh(F,V)}function Uh(F,V,j){var K=new Uint8Array(32);return Bh(K,j,V),Vi(F,i,K,Ui)}var dD=Ly,Y4=jy;function Jc(){var ge,Ie,Re,F=0,V=0,j=0,K=0,de=65535;for(Re=0;Re<arguments.length;Re++)F+=(ge=arguments[Re].lo)&de,V+=ge>>>16,j+=(Ie=arguments[Re].hi)&de,K+=Ie>>>16;return new e((j+=(V+=F>>>16)>>>16)&de|(K+=j>>>16)<<16,F&de|V<<16)}function hD(F,V){return new e(F.hi>>>V,F.lo>>>V|F.hi<<32-V)}function Hh(){var j,F=0,V=0;for(j=0;j<arguments.length;j++)F^=arguments[j].lo,V^=arguments[j].hi;return new e(V,F)}function uo(F,V){var j,K,de=32-V;return V<32?(j=F.hi>>>V|F.lo<<de,K=F.lo>>>V|F.hi<<de):V<64&&(j=F.lo>>>V|F.hi<<de,K=F.hi>>>V|F.lo<<de),new e(j,K)}function X4(F,V,j){return new e(F.hi&V.hi^~F.hi&j.hi,F.lo&V.lo^~F.lo&j.lo)}function eB(F,V,j){return new e(F.hi&V.hi^F.hi&j.hi^V.hi&j.hi,F.lo&V.lo^F.lo&j.lo^V.lo&j.lo)}function tB(F){return Hh(uo(F,28),uo(F,34),uo(F,39))}function nB(F){return Hh(uo(F,14),uo(F,18),uo(F,41))}function rB(F){return Hh(uo(F,1),uo(F,8),hD(F,7))}function iB(F){return Hh(uo(F,19),uo(F,61),hD(F,6))}var oB=[new e(1116352408,3609767458),new e(1899447441,602891725),new e(3049323471,3964484399),new e(3921009573,2173295548),new e(961987163,4081628472),new e(1508970993,3053834265),new e(2453635748,2937671579),new e(2870763221,3664609560),new e(3624381080,2734883394),new e(310598401,1164996542),new e(607225278,1323610764),new e(1426881987,3590304994),new e(1925078388,4068182383),new e(2162078206,991336113),new e(2614888103,633803317),new e(3248222580,3479774868),new e(3835390401,2666613458),new e(4022224774,944711139),new e(264347078,2341262773),new e(604807628,2007800933),new e(770255983,1495990901),new e(1249150122,1856431235),new e(1555081692,3175218132),new e(1996064986,2198950837),new e(2554220882,3999719339),new e(2821834349,766784016),new e(2952996808,2566594879),new e(3210313671,3203337956),new e(3336571891,1034457026),new e(3584528711,2466948901),new e(113926993,3758326383),new e(338241895,168717936),new e(666307205,1188179964),new e(773529912,1546045734),new e(1294757372,1522805485),new e(1396182291,2643833823),new e(1695183700,2343527390),new e(1986661051,1014477480),new e(2177026350,1206759142),new e(2456956037,344077627),new e(2730485921,1290863460),new e(2820302411,3158454273),new e(3259730800,3505952657),new e(3345764771,106217008),new e(3516065817,3606008344),new e(3600352804,1432725776),new e(4094571909,1467031594),new e(275423344,851169720),new e(430227734,3100823752),new e(506948616,1363258195),new e(659060556,3750685593),new e(883997877,3785050280),new e(958139571,3318307427),new e(1322822218,3812723403),new e(1537002063,2003034995),new e(1747873779,3602036899),new e(1955562222,1575990012),new e(2024104815,1125592928),new e(2227730452,2716904306),new e(2361852424,442776044),new e(2428436474,593698344),new e(2756734187,3733110249),new e(3204031479,2999351573),new e(3329325298,3815920427),new e(3391569614,3928383900),new e(3515267271,566280711),new e(3940187606,3454069534),new e(4118630271,4000239992),new e(116418474,1914138554),new e(174292421,2731055270),new e(289380356,3203993006),new e(460393269,320620315),new e(685471733,587496836),new e(852142971,1086792851),new e(1017036298,365543100),new e(1126000580,2618297676),new e(1288033470,3409855158),new e(1501505948,4234509866),new e(1607167915,987167468),new e(1816402316,1246189591)];function fD(F,V,j){var Re,be,Ae,K=[],de=[],ge=[],Ie=[];for(be=0;be<8;be++)K[be]=ge[be]=Se(F,8*be);for(var Ze=0;j>=128;){for(be=0;be<16;be++)Ie[be]=Se(V,8*be+Ze);for(be=0;be<80;be++){for(Ae=0;Ae<8;Ae++)de[Ae]=ge[Ae];for(Re=Jc(ge[7],nB(ge[4]),X4(ge[4],ge[5],ge[6]),oB[be],Ie[be%16]),de[7]=Jc(Re,tB(ge[0]),eB(ge[0],ge[1],ge[2])),de[3]=Jc(de[3],Re),Ae=0;Ae<8;Ae++)ge[(Ae+1)%8]=de[Ae];if(be%16==15)for(Ae=0;Ae<16;Ae++)Ie[Ae]=Jc(Ie[Ae],Ie[(Ae+9)%16],rB(Ie[(Ae+1)%16]),iB(Ie[(Ae+14)%16]))}for(be=0;be<8;be++)ge[be]=Jc(ge[be],K[be]),K[be]=ge[be];Ze+=128,j-=128}for(be=0;be<8;be++)Fe(F,8*be,K[be]);return j}var sB=new Uint8Array([106,9,230,103,243,188,201,8,187,103,174,133,132,202,167,59,60,110,243,114,254,148,248,43,165,79,245,58,95,29,54,241,81,14,82,127,173,230,130,209,155,5,104,140,43,62,108,31,31,131,217,171,251,65,189,107,91,224,205,25,19,126,33,121]);function zs(F,V,j){var ge,K=new Uint8Array(64),de=new Uint8Array(256),Ie=j;for(ge=0;ge<64;ge++)K[ge]=sB[ge];for(fD(K,V,j),j%=128,ge=0;ge<256;ge++)de[ge]=0;for(ge=0;ge<j;ge++)de[ge]=V[Ie-j+ge];for(de[j]=128,de[(j=256-128*(j<112?1:0))-9]=0,Fe(de,j-8,new e(Ie/536870912|0,Ie<<3)),fD(K,de,j),ge=0;ge<64;ge++)F[ge]=K[ge];return 0}function $h(F,V){var j=n(),K=n(),de=n(),ge=n(),Ie=n(),Re=n(),be=n(),Ae=n(),Ze=n();$i(j,F[1],F[0]),$i(Ze,V[1],V[0]),Tt(j,j,Ze),Hi(K,F[0],F[1]),Hi(Ze,V[0],V[1]),Tt(K,K,Ze),Tt(de,F[3],V[3]),Tt(de,de,g),Tt(ge,F[2],V[2]),Hi(ge,ge,ge),$i(Ie,K,j),$i(Re,ge,de),Hi(be,ge,de),Hi(Ae,K,j),Tt(F[0],Ie,Re),Tt(F[1],Ae,be),Tt(F[2],be,Re),Tt(F[3],Ie,Ae)}function pD(F,V,j){var K;for(K=0;K<4;K++)ou(F[K],V[K],j)}function Vy(F,V){var j=n(),K=n(),de=n();uD(de,V[2]),Tt(j,V[0],de),Tt(K,V[1],de),su(F,K),F[31]^=aD(j)<<7}function Uy(F,V,j){var K,de;for(Po(F[0],s),Po(F[1],a),Po(F[2],a),Po(F[3],s),de=255;de>=0;--de)pD(F,V,K=j[de/8|0]>>(7&de)&1),$h(V,F),$h(F,F),pD(F,V,K)}function qh(F,V){var j=[n(),n(),n(),n()];Po(j[0],m),Po(j[1],C),Po(j[2],a),Tt(j[3],m,C),Uy(F,j,V)}function Hy(F,V,j){var ge,K=new Uint8Array(64),de=[n(),n(),n(),n()];for(j||r(V,32),zs(K,V,32),K[0]&=248,K[31]&=127,K[31]|=64,qh(de,K),Vy(F,de),ge=0;ge<32;ge++)V[ge+32]=F[ge];return 0}var F,Gh=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function $y(F,V){var j,K,de,ge;for(K=63;K>=32;--K){for(j=0,de=K-32,ge=K-12;de<ge;++de)V[de]+=j-16*V[K]*Gh[de-(K-32)],j=Math.floor((V[de]+128)/256),V[de]-=256*j;V[de]+=j,V[K]=0}for(j=0,de=0;de<32;de++)V[de]+=j-(V[31]>>4)*Gh[de],j=V[de]>>8,V[de]&=255;for(de=0;de<32;de++)V[de]-=j*Gh[de];for(K=0;K<32;K++)V[K+1]+=V[K]>>8,F[K]=255&V[K]}function qy(F){var j,V=new Float64Array(64);for(j=0;j<64;j++)V[j]=F[j];for(j=0;j<64;j++)F[j]=0;$y(F,V)}function gD(F,V,j,K){var Re,be,de=new Uint8Array(64),ge=new Uint8Array(64),Ie=new Uint8Array(64),Ae=new Float64Array(64),Ze=[n(),n(),n(),n()];zs(de,K,32),de[0]&=248,de[31]&=127,de[31]|=64;var Mt=j+64;for(Re=0;Re<j;Re++)F[64+Re]=V[Re];for(Re=0;Re<32;Re++)F[32+Re]=de[32+Re];for(zs(Ie,F.subarray(32),j+32),qy(Ie),qh(Ze,Ie),Vy(F,Ze),Re=32;Re<64;Re++)F[Re]=K[Re];for(zs(ge,F,j+64),qy(ge),Re=0;Re<64;Re++)Ae[Re]=0;for(Re=0;Re<32;Re++)Ae[Re]=Ie[Re];for(Re=0;Re<32;Re++)for(be=0;be<32;be++)Ae[Re+be]+=ge[Re]*de[be];return $y(F.subarray(32),Ae),Mt}function Gy(F,V,j,K){var de,ge=new Uint8Array(32),Ie=new Uint8Array(64),Re=[n(),n(),n(),n()],be=[n(),n(),n(),n()];if(j<64||function aB(F,V){var j=n(),K=n(),de=n(),ge=n(),Ie=n(),Re=n(),be=n();return Po(F[2],a),By(F[1],V),wi(de,F[1]),Tt(ge,de,h),$i(de,de,F[2]),Hi(ge,F[2],ge),wi(Ie,ge),wi(Re,Ie),Tt(be,Re,Ie),Tt(j,be,de),Tt(j,j,ge),cD(j,j),Tt(j,j,de),Tt(j,j,ge),Tt(j,j,ge),Tt(F[0],j,ge),wi(K,F[0]),Tt(K,K,ge),sD(K,de)&&Tt(F[0],F[0],D),wi(K,F[0]),Tt(K,K,ge),sD(K,de)?-1:(aD(F[0])===V[31]>>7&&$i(F[0],s,F[0]),Tt(F[3],F[0],F[1]),0)}(be,K))return-1;for(de=0;de<j;de++)F[de]=V[de];for(de=0;de<32;de++)F[de+32]=K[de];if(zs(Ie,F,j),qy(Ie),Uy(Re,be,Ie),qh(be,V.subarray(32)),$h(Re,be),Vy(ge,Re),j-=64,bt(V,0,ge,0)){for(de=0;de<j;de++)F[de]=0;return-1}for(de=0;de<j;de++)F[de]=V[de+64];return j}function yD(F,V){if(32!==F.length)throw new Error("bad key size");if(24!==V.length)throw new Error("bad nonce size")}function ii(){for(var F=0;F<arguments.length;F++)if(!(arguments[F]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function vD(F){for(var V=0;V<F.length;V++)F[V]=0}t.lowlevel={crypto_core_hsalsa20:Vi,crypto_stream_xor:$s,crypto_stream:iu,crypto_stream_salsa20_xor:so,crypto_stream_salsa20:ao,crypto_onetimeauth:Gs,crypto_onetimeauth_verify:oD,crypto_verify_16:We,crypto_verify_32:bt,crypto_secretbox:Ly,crypto_secretbox_open:jy,crypto_scalarmult:Bh,crypto_scalarmult_base:Vh,crypto_box_beforenm:Uh,crypto_box_afternm:dD,crypto_box:function Z4(F,V,j,K,de,ge){var Ie=new Uint8Array(32);return Uh(Ie,de,ge),dD(F,V,j,K,Ie)},crypto_box_open:function Q4(F,V,j,K,de,ge){var Ie=new Uint8Array(32);return Uh(Ie,de,ge),Y4(F,V,j,K,Ie)},crypto_box_keypair:lD,crypto_hash:zs,crypto_sign:gD,crypto_sign_keypair:Hy,crypto_sign_open:Gy,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:n,D:h,L:Gh,pack25519:su,unpack25519:By,M:Tt,A:Hi,S:wi,Z:$i,pow2523:cD,add:$h,set25519:Po,modL:$y,scalarmult:Uy,scalarbase:qh},t.randomBytes=function(F){var V=new Uint8Array(F);return r(V,F),V},t.secretbox=function(F,V,j){ii(F,V,j),yD(j,V);for(var K=new Uint8Array(32+F.length),de=new Uint8Array(K.length),ge=0;ge<F.length;ge++)K[ge+32]=F[ge];return Ly(de,K,K.length,V,j),de.subarray(16)},t.secretbox.open=function(F,V,j){ii(F,V,j),yD(j,V);for(var K=new Uint8Array(16+F.length),de=new Uint8Array(K.length),ge=0;ge<F.length;ge++)K[ge+16]=F[ge];return K.length<32||0!==jy(de,K,K.length,V,j)?null:de.subarray(32)},t.secretbox.keyLength=32,t.secretbox.nonceLength=24,t.secretbox.overheadLength=16,t.scalarMult=function(F,V){if(ii(F,V),32!==F.length)throw new Error("bad n size");if(32!==V.length)throw new Error("bad p size");var j=new Uint8Array(32);return Bh(j,F,V),j},t.scalarMult.base=function(F){if(ii(F),32!==F.length)throw new Error("bad n size");var V=new Uint8Array(32);return Vh(V,F),V},t.scalarMult.scalarLength=32,t.scalarMult.groupElementLength=32,t.box=function(F,V,j,K){var de=t.box.before(j,K);return t.secretbox(F,V,de)},t.box.before=function(F,V){ii(F,V),function lB(F,V){if(32!==F.length)throw new Error("bad public key size");if(32!==V.length)throw new Error("bad secret key size")}(F,V);var j=new Uint8Array(32);return Uh(j,F,V),j},t.box.after=t.secretbox,t.box.open=function(F,V,j,K){var de=t.box.before(j,K);return t.secretbox.open(F,V,de)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var F=new Uint8Array(32),V=new Uint8Array(32);return lD(F,V),{publicKey:F,secretKey:V}},t.box.keyPair.fromSecretKey=function(F){if(ii(F),32!==F.length)throw new Error("bad secret key size");var V=new Uint8Array(32);return Vh(V,F),{publicKey:V,secretKey:new Uint8Array(F)}},t.box.publicKeyLength=32,t.box.secretKeyLength=32,t.box.sharedKeyLength=32,t.box.nonceLength=24,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(F,V){if(ii(F,V),64!==V.length)throw new Error("bad secret key size");var j=new Uint8Array(64+F.length);return gD(j,F,F.length,V),j},t.sign.open=function(F,V){if(ii(F,V),32!==V.length)throw new Error("bad public key size");var j=new Uint8Array(F.length),K=Gy(j,F,F.length,V);if(K<0)return null;for(var de=new Uint8Array(K),ge=0;ge<de.length;ge++)de[ge]=j[ge];return de},t.sign.detached=function(F,V){for(var j=t.sign(F,V),K=new Uint8Array(64),de=0;de<K.length;de++)K[de]=j[de];return K},t.sign.detached.verify=function(F,V,j){if(ii(F,V,j),64!==V.length)throw new Error("bad signature size");if(32!==j.length)throw new Error("bad public key size");var ge,K=new Uint8Array(64+F.length),de=new Uint8Array(64+F.length);for(ge=0;ge<64;ge++)K[ge]=V[ge];for(ge=0;ge<F.length;ge++)K[ge+64]=F[ge];return Gy(de,K,K.length,j)>=0},t.sign.keyPair=function(){var F=new Uint8Array(32),V=new Uint8Array(64);return Hy(F,V),{publicKey:F,secretKey:V}},t.sign.keyPair.fromSecretKey=function(F){if(ii(F),64!==F.length)throw new Error("bad secret key size");for(var V=new Uint8Array(32),j=0;j<V.length;j++)V[j]=F[32+j];return{publicKey:V,secretKey:new Uint8Array(F)}},t.sign.keyPair.fromSeed=function(F){if(ii(F),32!==F.length)throw new Error("bad seed size");for(var V=new Uint8Array(32),j=new Uint8Array(64),K=0;K<32;K++)j[K]=F[K];return Hy(V,j,!0),{publicKey:V,secretKey:j}},t.sign.publicKeyLength=32,t.sign.secretKeyLength=64,t.sign.seedLength=32,t.sign.signatureLength=64,t.hash=function(F){ii(F);var V=new Uint8Array(64);return zs(V,F,F.length),V},t.hash.hashLength=64,t.verify=function(F,V){return ii(F,V),0!==F.length&&0!==V.length&&F.length===V.length&&0===Ce(F,0,V,0,F.length)},t.setPRNG=function(F){r=F},(F=typeof globalThis<"u"?globalThis.crypto||globalThis.msCrypto:null)&&F.getRandomValues?t.setPRNG(function(j,K){var de,ge=new Uint8Array(K);for(de=0;de<K;de+=65536)F.getRandomValues(ge.subarray(de,de+Math.min(K-de,65536)));for(de=0;de<K;de++)j[de]=ge[de];vD(ge)}):typeof require<"u"&&(F=require("crypto"))&&F.randomBytes&&t.setPRNG(function(j,K){var de,ge=F.randomBytes(K);for(de=0;de<K;de++)j[de]=ge[de];vD(ge)})}(typeof module<"u"&&module.exports?module.exports:globalThis.nacl=globalThis.nacl||{});const gh=typeof module<"u"&&module.exports?module.exports:globalThis.nacl,mj={fromSeed:gh.sign.keyPair.fromSeed,sign:gh.sign.detached,verify:gh.sign.detached.verify,randomBytes:gh.randomBytes};let kE;new Uint16Array([0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920]),Error,function yj(t){kE=t}(mj);const _h="KV-Operation",bi="KV_",Bj=/^[-/=.\w]+$/,Vj=/^[-/=.>*\w]+$/,Uj=/^[-\w]+$/;function BE(t){if(t.startsWith(".")||t.endsWith(".")||!Bj.test(t))throw new Error(`invalid key: ${t}`)}function Hj(t){if(t.startsWith(".")||t.endsWith(".")||!Vj.test(t))throw new Error(`invalid key: ${t}`)}function $j(t){if(t.startsWith(".")||t.endsWith("."))throw new Error(`invalid key: ${t}`);const e=t.split(".");let n=!1;for(let r=0;r<e.length;r++)switch(e[r]){case"*":n=!0;break;case">":if(r!==e.length-1)throw new Error(`invalid key: ${t}`);n=!0}return n}function bh(t){if(!Uj.test(t))throw new Error(`invalid bucket name: ${t}`)}class Uc{constructor(e,n,r){R(this,"jsm"),R(this,"js"),R(this,"stream"),R(this,"bucket"),R(this,"direct"),R(this,"codec"),R(this,"prefix"),R(this,"editPrefix"),R(this,"useJsPrefix"),R(this,"_prefixLen"),R(this,"validateKey",BE),R(this,"validateSearchKey",Hj),R(this,"hasWildcards",$j),bh(e),this.jsm=n,this.js=r,this.bucket=e,this.prefix="$KV",this.editPrefix="",this.useJsPrefix=!1,this._prefixLen=0}static create(e,n,r={}){return Oe(function*(){const i=e,{ok:o,min:s}=i.nc.features.get(Ur.JS_KV);if(!o)return Promise.reject(new Error(`kv is only supported on servers ${s} or better`));bh(n);let l=i.opts||{};l=Object.assign(l,{timeout:r.timeout||2e3});const h=yield i.nc.jetstreamManager(l),g=new Uc(n,h,e);return yield g.init(r),g})()}static bind(e,n,r={}){return Oe(function*(){const o=yield e.nc.jetstreamManager(),s=yield o.streams.info(`KV_${n}`);bh(s.config.name);const a=new Uc(n,o,e);return Object.assign(a,s),a.codec=r.codec||{key:{encode:t=>t,decode:t=>t},value:{encode:t=>t,decode:t=>t}},a.direct=s.config.allow_direct??!1,a.initializePrefixes(s),a})()}init(e={}){var n=this;return Oe(function*(){const r=Object.assign(function jj(){return{replicas:1,history:1,timeout:2e3,maxBucketSize:-1,maxValueSize:-1,codec:{key:{encode:t=>t,decode:t=>t},value:{encode:t=>t,decode:t=>t}},storage:rh.File}}(),e);n.codec=r.codec;const i={};n.stream=i.name=e.streamName??n.bucketName(),i.retention=nh.Limits,i.max_msgs_per_subject=r.history,r.maxBucketSize&&(r.max_bytes=r.maxBucketSize),r.max_bytes&&(i.max_bytes=r.max_bytes),i.max_msg_size=r.maxValueSize,i.storage=r.storage;const o=e.placementCluster??"";if(o&&(e.placement={},e.placement.cluster=o,e.placement.tags=[]),e.placement&&(i.placement=e.placement),e.republish&&(i.republish=e.republish),e.description&&(i.description=e.description),e.mirror){const C=Object.assign({},e.mirror);C.name.startsWith(bi)||(C.name=`KV_${C.name}`),i.mirror=C,i.mirror_direct=!0}else if(e.sources){const C=e.sources.map(D=>{const q=Object.assign({},D);q.name.startsWith(bi)||(q.name=`KV_${q.name}`)});i.sources=C}else i.subjects=[n.subjectForBucket()];const s=n.js.nc,a=s.getServerVersion(),l=!!a&&ny(a,Bs("2.7.2"))>=0;i.discard=l?Qa.New:Qa.Old;const{ok:h,min:g}=s.features.get(Ur.JS_ALLOW_DIRECT);if(!h&&!0===e.allow_direct)return Promise.reject(new Error(`allow_direct is not available on server version ${a?`${a.major}.${a.minor}.${a.micro}`:"unknown"} - requires ${g}`));let m;e.allow_direct="boolean"==typeof e.allow_direct?e.allow_direct:h,i.allow_direct=e.allow_direct,n.direct=i.allow_direct,i.num_replicas=r.replicas,r.ttl&&(i.max_age=Gn(r.ttl)),i.allow_rollup_hdrs=!0;try{m=yield n.jsm.streams.info(i.name),!m.config.allow_direct&&!0===n.direct&&(n.direct=!1)}catch(C){if("stream not found"!==C.message)throw C;m=yield n.jsm.streams.add(i)}n.initializePrefixes(m)})()}initializePrefixes(e){this._prefixLen=0,this.prefix=`$KV.${this.bucket}`,this.useJsPrefix="$JS.API"!==this.js.opts.apiPrefix;const{mirror:n}=e.config;if(n){let r=n.name;if(r.startsWith(bi)&&(r=r.substring(bi.length)),n.external&&""!==n.external.api){const i=n.name.substring(bi.length);this.useJsPrefix=!1,this.prefix=`$KV.${i}`,this.editPrefix=`${n.external.api}.$KV.${r}`}else this.editPrefix=this.prefix}}bucketName(){return this.stream??`KV_${this.bucket}`}subjectForBucket(){return`${this.prefix}.${this.bucket}.>`}subjectForKey(e,n=!1){const r=[];return n?(this.useJsPrefix&&r.push(this.js.apiPrefix),r.push(""!==this.editPrefix?this.editPrefix:this.prefix)):this.prefix&&r.push(this.prefix),r.push(e),r.join(".")}fullKeyName(e){return""!==this.prefix?`${this.prefix}.${e}`:`$KV.${this.bucket}.${e}`}get prefixLen(){return 0===this._prefixLen&&(this._prefixLen=this.prefix.length+1),this._prefixLen}encodeKey(e){const n=[];for(const r of e.split("."))switch(r){case">":case"*":n.push(r);break;default:n.push(this.codec.key.encode(r))}return n.join(".")}decodeKey(e){const n=[];for(const r of e.split("."))switch(r){case">":case"*":n.push(r);break;default:n.push(this.codec.key.decode(r))}return n.join(".")}close(){return Promise.resolve()}dataLen(e,n){const r=n&&n.get(_i.MessageSizeHdr)||"";return""!==r?parseInt(r,10):e.length}smToEntry(e){return{bucket:this.bucket,key:e.subject.substring(this.prefixLen),value:e.data,delta:0,created:e.time,revision:e.seq,operation:e.header.get(_h)||"PUT",length:this.dataLen(e.data,e.header)}}jmToEntry(e){const n=this.decodeKey(e.subject.substring(this.prefixLen));return{bucket:this.bucket,key:n,value:e.data,created:new Date(ey(e.info.timestampNanos)),revision:e.seq,operation:e.headers?.get(_h)||"PUT",delta:e.info.pending,length:this.dataLen(e.data,e.headers)}}create(e,n){var r=this;return Oe(function*(){let i;try{const s=yield r.put(e,n,{previousSeq:0});return Promise.resolve(s)}catch(s){if(i=s,10071!==s?.api_error?.err_code)return Promise.reject(s)}let o=0;try{const s=yield r.get(e);return"DEL"===s?.operation||"PURGE"===s?.operation?(o=null!==s?s.revision:0,r.update(e,n,o)):Promise.reject(i)}catch(s){return Promise.reject(s)}})()}update(e,n,r){if(r<=0)throw new Error("version must be greater than 0");return this.put(e,n,{previousSeq:r})}put(e,n,r={}){var i=this;return Oe(function*(){const o=i.encodeKey(e);i.validateKey(o);const s={};if(void 0!==r.previousSeq){const a=To();s.headers=a,a.set("Nats-Expected-Last-Subject-Sequence",`${r.previousSeq}`)}try{return(yield i.js.publish(i.subjectForKey(o,!0),n,s)).seq}catch(a){const l=a;return l.isJetStreamError()?(l.message=l.api_error?.description,l.code=`${l.api_error?.code}`,Promise.reject(l)):Promise.reject(a)}})()}get(e,n){var r=this;return Oe(function*(){const i=r.encodeKey(e);r.validateKey(i);let s,o={last_by_subj:r.subjectForKey(i)};n&&n.revision>0&&(o={seq:n.revision});try{s=r.direct?yield r.jsm.direct.getMessage(r.bucketName(),o):yield r.jsm.streams.getMessage(r.bucketName(),o);const a=r.smToEntry(s);return a.key!==i?null:a}catch(a){if(a.code===Ne.JetStream404NoMessages)return null;throw a}})()}purge(e){return this._deleteOrPurge(e,"PURGE")}delete(e){return this._deleteOrPurge(e,"DEL")}purgeDeletes(e=18e5){var n=this;return Oe(function*(){const r=vn(),i=[],o=yield n.watch({key:">",initializedFn:()=>{r.resolve()}});Oe(function*(){var m,h=!1,g=!1;try{for(var D,C=Oi(o);h=!(D=yield C.next()).done;h=!1){const q=D.value;("DEL"===q.operation||"PURGE"===q.operation)&&i.push(q)}}catch(q){g=!0,m=q}finally{try{h&&null!=C.return&&(yield C.return())}finally{if(g)throw m}}})().then(),yield r,o.stop();const s=Date.now()-e,a=i.map(h=>{const g=n.subjectForKey(h.key);return h.created.getTime()>=s?n.jsm.streams.purge(n.stream,{filter:g,keep:1}):n.jsm.streams.purge(n.stream,{filter:g,keep:0})}),l=yield Promise.all(a);return l.unshift({success:!0,purged:0}),l.reduce((h,g)=>(h.purged+=g.purged,h))})()}_deleteOrPurge(e,n){var r=this;return Oe(function*(){if(!r.hasWildcards(e))return r._doDeleteOrPurge(e,n);const i=yield r.keys(e),o=[];var l,s=!1,a=!1;try{for(var g,h=Oi(i);s=!(g=yield h.next()).done;s=!1)o.push(r._doDeleteOrPurge(g.value,n)),100===o.length&&(yield Promise.all(o),o.length=0)}catch(m){a=!0,l=m}finally{try{s&&null!=h.return&&(yield h.return())}finally{if(a)throw l}}o.length>0&&(yield Promise.all(o))})()}_doDeleteOrPurge(e,n){var r=this;return Oe(function*(){const i=r.encodeKey(e);r.validateKey(i);const o=To();o.set(_h,n),"PURGE"===n&&o.set(_i.RollupHdr,_i.RollupValueSubject),yield r.js.publish(r.subjectForKey(i,!0),fr,{headers:o})})()}_buildCC(e,n=!1,r={}){const i=this.encodeKey(e);return this.validateSearchKey(e),Object.assign({deliver_policy:n?jr.All:jr.LastPerSubject,ack_policy:Yn.None,filter_subject:this.fullKeyName(i),flow_control:!0,idle_heartbeat:Gn(5e3)},r)}remove(e){return this.purge(e)}history(e={}){var n=this;return Oe(function*(){const r=e.key??">",i=new Br,o={};let s;o.headers_only=e.headers_only||!1,s=()=>{i.stop()};let a=0;const l=n._buildCC(r,!0,o),h=l.filter_subject,g=as(l);g.bindStream(n.stream),g.orderedConsumer(),g.callback((C,D)=>{if(C)i.stop(C);else if(D){const q=n.jmToEntry(D);i.push(q),i.received++,(s&&a>0&&i.received>=a||0===D.info.pending)&&(i.push(s),s=void 0)}});const m=yield n.js.subscribe(h,g);if(s){const{info:{last:C}}=m,D=C.num_pending+C.delivered.consumer_seq;if(0===D||i.received>=D)try{s()}catch(q){i.stop(q)}finally{s=void 0}else a=D}return i._data=m,i.iterClosed.then(()=>{m.unsubscribe()}),m.closed.then(()=>{i.stop()}).catch(C=>{i.stop(C)}),i})()}watch(e={}){var n=this;return Oe(function*(){const r=e.key??">",i=new Br,o={};o.headers_only=e.headers_only||!1;let s=e.initializedFn,a=0;const l=n._buildCC(r,!1,o),h=l.filter_subject,g=as(l);g.bindStream(n.stream),g.orderedConsumer(),g.callback((C,D)=>{if(C)i.stop(C);else if(D){const q=n.jmToEntry(D);i.push(q),i.received++,s&&(a>0&&i.received>=a||0===D.info.pending)&&(i.push(s),s=void 0)}});const m=yield n.js.subscribe(h,g);if(s){const{info:{last:C}}=m,D=C.num_pending+C.delivered.consumer_seq;if(0===D||i.received>=D)try{s()}catch(q){i.stop(q)}finally{s=void 0}else a=D}return i._data=m,i.iterClosed.then(()=>{m.unsubscribe()}),m.closed.then(()=>{i.stop()}).catch(C=>{i.stop(C)}),i})()}keys(e=">"){var n=this;return Oe(function*(){const r=new Br,i=n._buildCC(e,!1,{headers_only:!0}),o=i.filter_subject,s=as(i);s.bindStream(n.stream),s.orderedConsumer();const a=yield n.js.subscribe(o,s);return Oe(function*(){var m,h=!1,g=!1;try{for(var D,C=Oi(a);h=!(D=yield C.next()).done;h=!1){const q=D.value,he=q.headers?.get(_h);if("DEL"!==he&&"PURGE"!==he){const Se=n.decodeKey(q.subject.substring(n.prefixLen));r.push(Se)}0===q.info.pending&&a.unsubscribe()}}catch(q){g=!0,m=q}finally{try{h&&null!=C.return&&(yield C.return())}finally{if(g)throw m}}})().then(()=>{r.stop()}).catch(h=>{r.stop(h)}),0===a.info.last.num_pending&&a.unsubscribe(),r})()}purgeBucket(e){return this.jsm.streams.purge(this.bucketName(),e)}destroy(){return this.jsm.streams.delete(this.bucketName())}status(){var e=this;return Oe(function*(){const r=e.js.nc.info?.cluster??"",i=e.bucketName(),o=yield e.jsm.streams.info(i);return new VE(o,r)})()}}class VE{constructor(e,n=""){R(this,"si"),R(this,"cluster"),this.si=e,this.cluster=n}get bucket(){return this.si.config.name.startsWith(bi)?this.si.config.name.substring(bi.length):this.si.config.name}get values(){return this.si.state.messages}get history(){return this.si.config.max_msgs_per_subject}get ttl(){return ey(this.si.config.max_age)}get bucket_location(){return this.cluster}get backingStore(){return this.si.config.storage}get storage(){return this.si.config.storage}get replicas(){return this.si.config.num_replicas}get description(){return this.si.config.description??""}get maxBucketSize(){return this.si.config.max_bytes}get maxValueSize(){return this.si.config.max_msg_size}get max_bytes(){return this.si.config.max_bytes}get placement(){return this.si.config.placement||{cluster:"",tags:[]}}get placementCluster(){return this.si.config.placement?.cluster??""}get republish(){return this.si.config.republish??{src:"",dest:""}}get streamInfo(){return this.si}get size(){return this.si.state.bytes}}const UE="SHA-256=";class dy{constructor(e){R(this,"si"),R(this,"backingStore"),this.si=e,this.backingStore="JetStream"}get bucket(){return function Gj(t){return t.startsWith("OBJ_")?t.substring(4):t}(this.si.config.name)}get description(){return this.si.config.description??""}get ttl(){return this.si.config.max_age}get storage(){return this.si.config.storage}get replicas(){return this.si.config.num_replicas}get sealed(){return this.si.config.sealed}get size(){return this.si.state.bytes}get streamInfo(){return this.si}}function wh(t){if(void 0===t)return;const{domain:e}=t;if(void 0===e)return t;const n=Object.assign({},t);if(delete n.domain,""===e)return n;if(n.external)throw new Error("domain and external are both set");return n.external={api:`$JS.${e}.API`},n}class zj extends Oc{constructor(e,n){super(e,n)}add(e={}){var n=this;return Oe(function*(){Vr(e.name),e.mirror=wh(e.mirror),e.sources=e.sources?.map(wh);const i=yield n._request(`${n.prefix}.STREAM.CREATE.${e.name}`,e);return n._fixInfo(i),i})()}delete(e){var n=this;return Oe(function*(){return Vr(e),(yield n._request(`${n.prefix}.STREAM.DELETE.${e}`)).success})()}update(e,n={}){var r=this;return Oe(function*(){if("object"==typeof e){const l=e;e=l.name,n=l,console.trace("\x1b[33m >> streams.update(config: StreamConfig) api changed to streams.update(name: string, config: StreamUpdateConfig) - this shim will be removed - update your code.  \x1b[0m")}Vr(e);const i=yield r.info(e),o=Object.assign(i.config,n);o.mirror=wh(o.mirror),o.sources=o.sources?.map(wh);const a=yield r._request(`${r.prefix}.STREAM.UPDATE.${e}`,o);return r._fixInfo(a),a})()}info(e,n){var r=this;return Oe(function*(){Vr(e);const i=`${r.prefix}.STREAM.INFO.${e}`;let s=yield r._request(i,n),{total:a,limit:l}=s,h=s.state.subjects?Object.getOwnPropertyNames(s.state.subjects).length:1;if(a&&a>h){const g=[s],m=n||{};let C=0;for(;a>h;){C++,m.offset=l*C;const q=yield r._request(i,m);a=q.total,g.push(q);const he=Object.getOwnPropertyNames(q.state.subjects).length;if(h+=he,he<l)break}let D={};for(let q=0;q<g.length;q++)s=g[q],s.state.subjects&&(D=Object.assign(D,s.state.subjects));s.offset=0,s.total=0,s.limit=0,s.state.subjects=D}return r._fixInfo(s),s})()}list(e=""){return new Lc(`${this.prefix}.STREAM.LIST`,o=>{const s=o;return s.streams.forEach(a=>{this._fixInfo(a)}),s.streams},this,e?.length?{subject:e}:{})}_fixInfo(e){e.config.sealed=e.config.sealed||!1,e.config.deny_delete=e.config.deny_delete||!1,e.config.deny_purge=e.config.deny_purge||!1,e.config.allow_rollup_hdrs=e.config.allow_rollup_hdrs||!1}purge(e,n){var r=this;return Oe(function*(){if(n){const{keep:o,seq:s}=n;if("number"==typeof o&&"number"==typeof s)throw new Error("can specify one of keep or seq")}return Vr(e),yield r._request(`${r.prefix}.STREAM.PURGE.${e}`,n)})()}deleteMessage(e,n,r=!0){var i=this;return Oe(function*(){Vr(e);const o={seq:n};return r||(o.no_erase=!0),(yield i._request(`${i.prefix}.STREAM.MSG.DELETE.${e}`,o)).success})()}getMessage(e,n){var r=this;return Oe(function*(){Vr(e);const o=yield r._request(`${r.prefix}.STREAM.MSG.GET.${e}`,n);return new e8(o)})()}find(e){return this.findStream(e)}listKvs(){return new Lc(`${this.prefix}.STREAM.LIST`,r=>{const o=r.streams.filter(l=>l.config.name.startsWith(bi));o.forEach(l=>{this._fixInfo(l)});let s="";return o.length&&(s=this.nc.info?.cluster??""),o.map(l=>new VE(l,s))},this)}listObjectStores(){return new Lc(`${this.prefix}.STREAM.LIST`,r=>{const o=r.streams.filter(a=>a.config.name.startsWith("OBJ_"));return o.forEach(a=>{this._fixInfo(a)}),o.map(a=>new dy(a))},this)}names(e=""){return new Lc(`${this.prefix}.STREAM.NAMES`,o=>o.streams,this,e?.length?{subject:e}:{})}}class Kj extends Oc{constructor(n,r){super(n,r),R(this,"streams"),R(this,"consumers"),R(this,"direct"),this.streams=new zj(n,r),this.consumers=new pE(n,r),this.direct=new pj(n,r)}getAccountInfo(){var n=this;return Oe(function*(){return yield n._request(`${n.prefix}.INFO`)})()}advisories(){const n=new Br;return this.nc.subscribe("$JS.EVENT.ADVISORY.>",{callback:(r,i)=>{if(r)throw r;try{const o=this.parseJsResponse(i),s=o.type.split(".");n.push({kind:s[s.length-1],data:o})}catch(o){n.stop(o)}}}),n}}var cs=(()=>{return(t=cs||(cs={})).MsgIdHdr="Nats-Msg-Id",t.ExpectedStreamHdr="Nats-Expected-Stream",t.ExpectedLastSeqHdr="Nats-Expected-Last-Sequence",t.ExpectedLastMsgIdHdr="Nats-Expected-Last-Msg-Id",t.ExpectedLastSubjectSequenceHdr="Nats-Expected-Last-Subject-Sequence",cs;var t})();class hy{constructor(e){R(this,"info"),R(this,"hdrs"),this.info=e}get name(){return this.info.name}get description(){return this.info.description??""}get headers(){return this.hdrs||(this.hdrs=os.fromRecord(this.info.headers||{})),this.hdrs}get options(){return this.info.options}get bucket(){return this.info.bucket}get chunks(){return this.info.chunks}get deleted(){return this.info.deleted??!1}get digest(){return this.info.digest}get mtime(){return this.info.mtime}get nuid(){return this.info.nuid}get size(){return this.info.size}}function HE(t){const e={name:t.name,description:t.description??"",options:t.options};return t.headers&&(e.headers=t.headers.toRecord()),e}class Hc{constructor(e,n,r){R(this,"jsm"),R(this,"js"),R(this,"stream"),R(this,"name"),this.name=e,this.jsm=n,this.js=r}_sanitizeName(e){if(!e||0===e.length)return{name:e,error:new Error("name cannot be empty")};let n;e=e.replace(/[. ]/g,"_");try{BE(e)}catch(r){n=r}return{name:e,error:n}}info(e){var n=this;return Oe(function*(){const r=yield n.rawInfo(e);return r?new hy(r):null})()}list(){var e=this;return Oe(function*(){const n=[],r=yield e.watch({ignoreDeletes:!0,includeHistory:!0});var s,i=!1,o=!1;try{for(var l,a=Oi(r);i=!(l=yield a.next()).done;i=!1){const h=l.value;if(null===h)break;n.push(h)}}catch(h){o=!0,s=h}finally{try{i&&null!=a.return&&(yield a.return())}finally{if(o)throw s}}return Promise.resolve(n)})()}rawInfo(e){var n=this;return Oe(function*(){const{name:r,error:i}=n._sanitizeName(e);if(i)return Promise.reject(i);const o=n._metaSubject(r);try{const s=yield n.jsm.streams.getMessage(n.stream,{last_by_subj:o});return io().decode(s.data)}catch(s){return"404"===s.code?null:Promise.reject(s)}})()}_si(e){var n=this;return Oe(function*(){try{return yield n.jsm.streams.info(n.stream,e)}catch(r){return"404"===r.code?null:Promise.reject(r)}})()}seal(){var e=this;return Oe(function*(){let n=yield e._si();return null===n?Promise.reject(new Error("object store not found")):(n.config.sealed=!0,n=yield e.jsm.streams.update(e.stream,n.config),Promise.resolve(new dy(n)))})()}status(e){var n=this;return Oe(function*(){const r=yield n._si(e);return null===r?Promise.reject(new Error("object store not found")):Promise.resolve(new dy(r))})()}destroy(){return this.jsm.streams.delete(this.stream)}_put(e,n,r){var i=this;return Oe(function*(){const o=i.js;(r=r||{timeout:o.timeout}).timeout=r.timeout||1e3;const{timeout:s}=r,a=o.nc.info?.max_payload||1024;(e=e||{}).options=e.options||{};let l=e.options?.max_chunk_size||131072;l=l>a?a:l,e.options.max_chunk_size=l;const h=yield i.info(e.name),{name:g,error:m}=i._sanitizeName(e.name);if(m)return Promise.reject(m);const C=kc.next(),D=i._chunkSubject(C),q=i._metaSubject(g),he=Object.assign({bucket:i.name,nuid:C,size:0,chunks:0},HE(e)),Se=vn(),xe=[],Fe=new Pc;try{const Ce=n?n.getReader():null,We=new PE;for(;;){const{done:bt,value:Ut}=Ce?yield Ce.read():{done:!0,value:void 0};if(bt){if(Fe.size()>0){const ao=Fe.drain();We.update(ao),he.chunks++,he.size+=ao.length,xe.push(i.js.publish(D,ao,{timeout:s}))}he.mtime=(new Date).toISOString();const mr=We.digest("base64"),Vi=mr.length%3,Ui=Vi>0?"=".repeat(Vi):"";he.digest=`${UE}${mr}${Ui}`,he.deleted=!1;const so=To();so.set(_i.RollupHdr,_i.RollupValueSubject),xe.push(i.js.publish(q,io().encode(he),{headers:so,timeout:s})),h&&xe.push(i.jsm.streams.purge(i.stream,{filter:`$O.${i.name}.C.${h.nuid}`})),yield Promise.all(xe),Se.resolve(new hy(he));break}if(Ut)for(Fe.fill(Ut);Fe.size()>l;){he.chunks++,he.size+=l;const mr=Fe.drain(e.options.max_chunk_size);We.update(mr),xe.push(i.js.publish(D,mr,{timeout:s}))}}}catch(Ce){yield i.jsm.streams.purge(i.stream,{filter:D}),Se.reject(Ce)}return Se})()}put(e,n,r){return e?.options?.link?Promise.reject(new Error("link cannot be set when putting the object in bucket")):this._put(e,n,r)}get(e){var n=this;return Oe(function*(){const r=yield n.rawInfo(e);if(null===r||r.deleted)return Promise.resolve(null);if(r.options&&r.options.link){const m=r.options.link.name||"";if(""===m)throw new Error("link is a bucket");return(yield Hc.create(n.js,r.options.link.bucket)).get(m)}const i=vn(),o={info:new hy(r),error:i};if(0===r.size)return o.data=function Jj(){return new ReadableStream({pull(t){t.enqueue(new Uint8Array(0)),t.close()}})}(),i.resolve(null),Promise.resolve(o);let s;const a=as();a.orderedConsumer();const l=new PE,h=`$O.${n.name}.C.${r.nuid}`,g=yield n.js.subscribe(h,a);return Oe(function*(){var D,m=!1,C=!1;try{for(var he,q=Oi(g);m=!(he=yield q.next()).done;m=!1){const Se=he.value;if(Se.data.length>0&&(l.update(Se.data),s.enqueue(Se.data)),0===Se.info.pending){const xe=l.digest("base64"),Fe=xe.length%3,Ce=Fe>0?"=".repeat(Fe):"",We=`${UE}${xe}${Ce}`;We!==r.digest?s.error(new Error(`received a corrupt object, digests do not match received: ${r.digest} calculated ${We}`)):s.close(),g.unsubscribe()}}}catch(Se){C=!0,D=Se}finally{try{m&&null!=q.return&&(yield q.return())}finally{if(C)throw D}}})().then(()=>{i.resolve()}).catch(m=>{s.error(m),i.reject(m)}),o.data=new ReadableStream({start(m){s=m},cancel(){g.unsubscribe()}}),o})()}linkStore(e,n){if(!(n instanceof Hc))return Promise.reject("bucket required");const r=n,{name:i,error:o}=this._sanitizeName(e);return o?Promise.reject(o):this._put({name:i,options:{link:{bucket:r.name}}},null)}link(e,n){var r=this;return Oe(function*(){if(n.deleted)return Promise.reject(new Error("object is deleted"));const{name:i,error:o}=r._sanitizeName(e);if(o)return Promise.reject(o);if(r.name===n.bucket){const l=Object.assign({},function Wj(t){return{name:t.name,description:t.description,headers:t.headers,options:t.options}}(n));l.name=i;try{return yield r.update(n.name,l),yield r.info(i)}catch(h){return Promise.reject(h)}}return r._put({name:i,options:{link:{bucket:n.bucket,name:n.name}}},null)})()}delete(e){var n=this;return Oe(function*(){const r=yield n.rawInfo(e);if(null===r)return Promise.resolve({purged:0,success:!1});r.deleted=!0,r.size=0,r.chunks=0,r.digest="";const i=io(),o=To();return o.set(_i.RollupHdr,_i.RollupValueSubject),yield n.js.publish(n._metaSubject(r.name),i.encode(r),{headers:o}),n.jsm.streams.purge(n.stream,{filter:n._chunkSubject(r.nuid)})})()}update(e,n={}){var r=this;return Oe(function*(){const i=yield r.rawInfo(e);if(null===i)return Promise.reject(new Error("object not found"));if(i.deleted)return Promise.reject(new Error("cannot update meta for a deleted object"));n.name=n.name??i.name;const{name:o,error:s}=r._sanitizeName(n.name);if(s)return Promise.reject(s);if(e!==n.name){const h=yield r.info(n.name);if(h&&!h.deleted)return Promise.reject(new Error("an object already exists with that name"))}n.name=o;const a=Object.assign({},i,HE(n)),l=io();return r.js.publish(r._metaSubject(a.name),l.encode(a))})()}watch(e={}){var n=this;return Oe(function*(){e.includeHistory=e.includeHistory??!1,e.ignoreDeletes=e.ignoreDeletes??!1;let r=!1;const i=new Br,o=n._metaSubjectAll();try{yield n.jsm.streams.getMessage(n.stream,{last_by_subj:o})}catch(h){"404"===h.code?(i.push(null),r=!0):i.stop(h)}const s=io(),a=as();a.orderedConsumer(),e.includeHistory?a.deliverLastPerSubject():(r=!0,a.deliverNew()),a.callback((h,g)=>{if(h)i.stop(h);else if(null!==g){const m=s.decode(g.data);m.deleted&&!0===e.ignoreDeletes||i.push(m),0===g.info?.pending&&!r&&(r=!0,i.push(null))}});const l=yield n.js.subscribe(o,a);return i._data=l,i.iterClosed.then(()=>{l.unsubscribe()}),l.closed.then(()=>{i.stop()}).catch(h=>{i.stop(h)}),i})()}_chunkSubject(e){return`$O.${this.name}.C.${e}`}_metaSubject(e){return`$O.${this.name}.M.${Vc.encode(e)}`}_metaSubjectAll(){return`$O.${this.name}.M.>`}init(e={}){var n=this;return Oe(function*(){try{n.stream=function qj(t){return bh(t),`OBJ_${t}`}(n.name)}catch(i){return Promise.reject(i)}const r=Object.assign({},e);r.name=n.stream,r.allow_rollup_hdrs=!0,r.discard=Qa.New,r.subjects=[`$O.${n.name}.C.>`,`$O.${n.name}.M.>`],e.placement&&(r.placement=e.placement);try{yield n.jsm.streams.info(r.name)}catch(i){"stream not found"===i.message&&(yield n.jsm.streams.add(r))}})()}static create(e,n,r={}){return Oe(function*(){if("function"!=typeof crypto?.subtle?.digest)return Promise.reject(new Error("objectstore: unable to calculate hashes - crypto.subtle.digest with sha256 support is required"));const i=e,{ok:o,min:s}=i.nc.features.get(Ur.JS_OBJECTSTORE);if(!o)return Promise.reject(new Error(`objectstore is only supported on servers ${s} or better`));let a=i.opts||{};a=Object.assign(a,{timeout:a.timeout||2e3});const h=yield i.nc.jetstreamManager(a),g=new Hc(n,h,e);return yield g.init(r),Promise.resolve(g)})()}}class Yj{constructor(e){R(this,"js"),this.js=e}kv(e,n={}){return n.bindOnly?Uc.bind(this.js,e):Uc.create(this.js,e,n)}os(e,n={}){return s8(this.js.nc),Hc.create(this.js,e,n)}}class fy extends Oc{constructor(n,r){super(n,r),R(this,"api"),this.api=new pE(n,r)}get apiPrefix(){return this.prefix}get views(){return new Yj(this)}publish(n,r=fr,i){var o=this;return Oe(function*(){(i=i||{}).expect=i.expect||{};const s=i?.headers||To();i&&(i.msgID&&s.set(cs.MsgIdHdr,i.msgID),i.expect.lastMsgID&&s.set(cs.ExpectedLastMsgIdHdr,i.expect.lastMsgID),i.expect.streamName&&s.set(cs.ExpectedStreamHdr,i.expect.streamName),"number"==typeof i.expect.lastSequence&&s.set(cs.ExpectedLastSeqHdr,`${i.expect.lastSequence}`),"number"==typeof i.expect.lastSubjectSequence&&s.set(cs.ExpectedLastSubjectSequenceHdr,`${i.expect.lastSubjectSequence}`));const a=i.timeout||o.timeout,l={};a&&(l.timeout=a),i&&(l.headers=s);let m,{retries:h,retry_delay:g}=i;h=h||1,g=g||250;for(let D=0;D<h;D++)try{m=yield o.nc.request(n,r,l);break}catch(q){if(!("503"===q.code&&D+1<h))throw q;yield Qm(g)}const C=o.parseJsResponse(m);if(""===C.stream)throw Ye.errorForCode(Ne.JetStreamInvalidAck);return C.duplicate=!!C.duplicate&&C.duplicate,C})()}pull(n,r,i=0){var o=this;return Oe(function*(){Vr(n),Xa(r);let s=o.timeout;i>s&&(s=i);const a={batch:1,no_wait:0===(i=i<0?0:Gn(i)),expires:i},l=yield o.nc.request(`${o.prefix}.CONSUMER.MSG.NEXT.${n}.${r}`,o.jc.encode(a),{noMux:!0,timeout:s}),h=eu(l);if(h)throw h;return hh(l)})()}fetch(n,r,i={}){Vr(n),Xa(r);let o=null;const s=(i.max_bytes??0)>0;let a=0;const l=s?i.max_bytes:0;let h=null;const g={};if(g.batch=i.batch||1,l){const Fe=this.nc.features.get(Ur.JS_PULL_MAX_BYTES);if(!Fe.ok)throw new Error(`max_bytes is only supported on servers ${Fe.min} or better`);g.max_bytes=l}g.no_wait=i.no_wait||!1,g.no_wait&&g.expires&&(g.expires=0);const m=i.expires||0;if(m&&(g.expires=Gn(m)),0===m&&!1===g.no_wait)throw new Error("expires or no_wait is required");const C=i.idle_heartbeat||0;C&&(g.idle_heartbeat=Gn(C),!0===i.delay_heartbeat&&(g.idle_heartbeat=Gn(4*C)));const D=new Br,q=g.batch;let he=0;D.protocolFilterFn=(Fe,Ce=!1)=>!dE(Fe.msg)||(h?.work(),!1),D.dispatchedFn=Fe=>{if(Fe){if(s&&(a+=Fe.data.length),he++,o&&0===Fe.info.pending)return;(1===D.getPending()&&0===Fe.info.pending||q===he||l>0&&a>=l)&&D.stop()}};const Se=ss(this.nc.options.inboxPrefix),xe=this.nc.subscribe(Se,{max:i.batch,callback:(Fe,Ce)=>{null===Fe&&(Fe=eu(Ce)),null!==Fe?(o&&(o.cancel(),o=null),function t6(t){return"string"==typeof t.code}(Fe)?D.stop(null===qE(Fe)?void 0:Fe):D.stop(Fe)):(h?.work(),D.received++,D.push(hh(Ce)))}});return m&&(o=ah(m),o.catch(()=>{xe.isClosed()||(xe.drain().catch(()=>{}),o=null),h&&h.cancel()})),Oe(function*(){try{C&&(h=new IE(C,Fe=>(D.push(()=>{D.err=new Ye(`${ni.IdleHeartbeatMissed}: ${Fe}`,Ne.JetStreamIdleHeartBeat)}),!0)))}catch{}yield xe.closed,null!==o&&(o.cancel(),o=null),h&&h.cancel(),D.stop()})().catch(),this.nc.publish(`${this.prefix}.CONSUMER.MSG.NEXT.${n}.${r}`,this.jc.encode(g),{reply:Se}),D}pullSubscribe(n,r=as()){var i=this;return Oe(function*(){const o=yield i._processOptions(n,r);if(o.ordered)throw new Error("pull subscribers cannot be be ordered");if(o.attached||(o.config.filter_subject=n),o.config.deliver_subject)throw new Error("consumer info specifies deliver_subject - pull consumers cannot have deliver_subject set");const s=o.config.ack_policy;if(s===Yn.None||s===Yn.All)throw new Error("ack policy for pull consumers must be explicit");const a=i._buildTypedSubscriptionOpts(o),l=new t8(i,o.deliver,a);l.info=o;try{yield i._maybeCreateConsumer(o)}catch(h){throw l.unsubscribe(),h}return l})()}subscribe(n,r=as()){var i=this;return Oe(function*(){const o=yield i._processOptions(n,r);if(!o.isBind&&!o.config.deliver_subject)throw new Error("push consumer requires deliver_subject");const s=i._buildTypedSubscriptionOpts(o),a=new $E(i,o.deliver,s);a.info=o;try{yield i._maybeCreateConsumer(o)}catch(l){throw a.unsubscribe(),l}return a._maybeSetupHbMonitoring(),a})()}_processOptions(n,r=as()){var i=this;return Oe(function*(){const o=AE(r)?r.getOpts():r;if(o.isBind=!!AE(r)&&r.isBind,o.flow_control={heartbeat_count:0,fc_count:0,consumer_restarts:0},o.ordered){if(o.ordered_consumer_sequence={stream_seq:0,delivery_seq:0},o.config.ack_policy!==Yn.NotSet&&o.config.ack_policy!==Yn.None)throw new Ye("ordered consumer: ack_policy can only be set to 'none'",Ne.ApiError);if(o.config.durable_name&&o.config.durable_name.length>0)throw new Ye("ordered consumer: durable_name cannot be set",Ne.ApiError);if(o.config.deliver_subject&&o.config.deliver_subject.length>0)throw new Ye("ordered consumer: deliver_subject cannot be set",Ne.ApiError);if(void 0!==o.config.max_deliver&&o.config.max_deliver>1)throw new Ye("ordered consumer: max_deliver cannot be set",Ne.ApiError);if(o.config.deliver_group&&o.config.deliver_group.length>0)throw new Ye("ordered consumer: deliver_group cannot be set",Ne.ApiError);o.config.deliver_subject=ss(i.nc.options.inboxPrefix),o.config.ack_policy=Yn.None,o.config.max_deliver=1,o.config.flow_control=!0,o.config.idle_heartbeat=o.config.idle_heartbeat||Gn(5e3),o.config.ack_wait=Gn(792e5),o.config.mem_storage=!0,o.config.num_replicas=1}if(o.config.ack_policy===Yn.NotSet&&(o.config.ack_policy=Yn.All),o.api=i,o.config=o.config||{},o.stream=o.stream?o.stream:yield i.findStream(n),o.attached=!1,o.config.durable_name)try{const s=yield i.api.info(o.stream,o.config.durable_name);if(s){if(s.config.filter_subject&&s.config.filter_subject!==n)throw new Error("subject does not match consumer");const a=o.config.deliver_group??"";if(""===a&&!0===s.push_bound)throw new Error("duplicate subscription");const l=s.config.deliver_group??"";if(a!==l)throw""===l?new Error("durable requires no queue group"):new Error(`durable requires queue group '${l}'`);o.last=s,o.config=s.config,o.attached=!0,o.config.durable_name||(o.name=s.name)}}catch(s){if("404"!==s.code)throw s}return o.attached||(o.config.filter_subject=n),o.deliver=o.config.deliver_subject||ss(i.nc.options.inboxPrefix),o})()}_buildTypedSubscriptionOpts(n){const r={};return r.adapter=function n8(t){return t?i8:r8}(void 0===n.callbackFn),r.ingestionFilterFn=fy.ingestionFn(n.ordered),r.protocolFilterFn=(i,o=!1)=>{const s=i;return!ty(s.msg)||(o||s.msg.respond(),!1)},!n.mack&&n.config.ack_policy!==Yn.None&&(r.dispatchedFn=o8),n.callbackFn&&(r.callback=n.callbackFn),r.max=n.max||0,r.queue=n.queue,r}_maybeCreateConsumer(n){var r=this;return Oe(function*(){if(n.attached)return;if(n.isBind)throw new Error(`unable to bind - durable consumer ${n.config.durable_name} doesn't exist in ${n.stream}`);n.config=Object.assign({deliver_policy:jr.All,ack_policy:Yn.Explicit,ack_wait:Gn(3e4),replay_policy:Ls.Instant},n.config);const i=yield r.api.add(n.stream,n.config);n.name=i.name,n.config=i.config,n.last=i})()}static ingestionFn(n){return(r,i)=>{const o=i;if(!r)return{ingest:!1,protocol:!1};const s=r;if(eu(s.msg)||o.monitor?.work(),dE(s.msg)){const l=!n||o._checkHbOrderConsumer(s.msg);return n||o.info.flow_control.heartbeat_count++,{ingest:l,protocol:!0}}return ty(s.msg)?(o.info.flow_control.fc_count++,{ingest:!0,protocol:!0}):{ingest:!n||o._checkOrderedConsumer(r),protocol:!1}}}}class py{constructor(e){R(this,"options"),R(this,"protocol"),R(this,"draining"),R(this,"listeners"),R(this,"_services"),this.draining=!1,this.options=function Lj(t){const e=`${Zm}:${vE()}`;if((t=t||{servers:[e]}).servers=t.servers||[],"string"==typeof t.servers&&(t.servers=[t.servers]),t.servers.length>0&&t.port)throw new Ye("port and servers options are mutually exclusive",Ne.InvalidOption);0===t.servers.length&&t.port&&(t.servers=[`${Zm}:${t.port}`]),t.servers&&0===t.servers.length&&(t.servers=[e]);const n=oh({maxPingOut:2,maxReconnectAttempts:10,noRandomize:!1,pedantic:!1,pingInterval:12e4,reconnect:!0,reconnectJitter:100,reconnectJitterTLS:1e3,reconnectTimeWait:2e3,tls:void 0,verbose:!1,waitOnFirstConnect:!1,ignoreAuthErrorAbort:!1},t);if(t.user&&t.token||t.authenticator&&(t.token||t.user||t.pass))throw Ye.errorForCode(Ne.BadAuthentication);if(n.authenticator=function Aj(t){return t.authenticator?t.authenticator:t.token?function Tj(t){return()=>({auth_token:"function"==typeof t?t():t})}(t.token):t.user?function Fj(t,e){return()=>({user:"function"==typeof t?t():t,pass:"function"==typeof e?e():e})}(t.user,t.pass):()=>{}}(n),["reconnectDelayHandler","authenticator"].forEach(r=>{if(n[r]&&"function"!=typeof n[r])throw new Ye(`${r} option should be a function`,Ne.NotFunction)}),n.reconnectDelayHandler||(n.reconnectDelayHandler=()=>{let r=n.tls?n.reconnectJitterTLS:n.reconnectJitter;return r&&(r++,r=Math.floor(Math.random()*r)),n.reconnectTimeWait+r}),n.inboxPrefix)try{ss(n.inboxPrefix)}catch(r){throw new Ye(r.message,Ne.ApiError)}if(n.resolve&&"function"!=typeof _E())throw new Ye("'resolve' is not supported on this client",Ne.InvalidOption);return n}(e),this.listeners=[]}static connect(e={}){return new Promise((n,r)=>{const i=new py(e);ph.connect(i.options,i).then(o=>{i.protocol=o,Oe(function*(){var l,s=!1,a=!1;try{for(var g,h=Oi(o.status());s=!(g=yield h.next()).done;s=!1){const m=g.value;i.listeners.forEach(C=>{C.push(m)})}}catch(m){a=!0,l=m}finally{try{s&&null!=h.return&&(yield h.return())}finally{if(a)throw l}}})(),n(i)}).catch(o=>{r(o)})})}closed(){return this.protocol.closed}close(){var e=this;return Oe(function*(){yield e.protocol.close()})()}_check(e,n,r){if(this.isClosed())throw Ye.errorForCode(Ne.ConnectionClosed);if(n&&this.isDraining()||r&&this.protocol.noMorePublishing)throw Ye.errorForCode(Ne.ConnectionDraining);if(0===(e=e||"").length)throw Ye.errorForCode(Ne.BadSubject)}publish(e,n=fr,r){if(this._check(e,!1,!0),n&&!function s6(t){return t instanceof Uint8Array}(n))throw Ye.errorForCode(Ne.BadPayload);this.protocol.publish(e,n,r)}subscribe(e,n={}){this._check(e,!0,!1);const r=new SE(this.protocol,e,n);return this.protocol.subscribe(r),r}_resub(e,n,r){this._check(n,!0,!1);const i=e;i.max=r,r&&(i.max=r+i.received),this.protocol.resub(i,n)}requestMany(e,n=fr,r={maxWait:1e3,maxMessages:-1}){try{this._check(e,!0,!0)}catch(a){return Promise.reject(a)}if(r.strategy=r.strategy||Li.Timer,r.maxWait=r.maxWait||1e3,r.maxWait<1)return Promise.reject(new Ye("timeout",Ne.InvalidOption));const i=new Br;function o(a){i.push(()=>{i.stop(a)})}function s(a,l){a||null===l?o(null===a?void 0:a):i.push(l)}if(r.noMux){const a=(new Error).stack;let l="number"==typeof r.maxMessages&&r.maxMessages>0?r.maxMessages:-1;const h=this.subscribe(ss(this.options.inboxPrefix),{callback:(D,q)=>{if(0===q?.data?.length&&q?.headers?.status===Ne.NoResponders&&(D=Ye.errorForCode(Ne.NoResponders)),D)return D.stack+=`\n\n${a}`,void g(D);s(null,q),r.strategy===Li.Count&&(l--,0===l&&g()),r.strategy===Li.JitterTimer&&(C(),m=setTimeout(()=>{g()},300)),r.strategy===Li.SentinelMsg&&q&&0===q.data.length&&g()}});h.closed.then(()=>{o()}).catch(D=>{i.stop(D)});const g=D=>{D&&i.push(()=>{throw D}),C(),h.drain().then(()=>{o()}).catch(q=>{o()})};i.iterClosed.then(()=>{C(),h?.unsubscribe()}).catch(D=>{C(),h?.unsubscribe()});try{this.publish(e,fr,{reply:h.getSubject()})}catch(D){g(D)}let m=setTimeout(()=>{g()},r.maxWait);const C=()=>{m&&clearTimeout(m)}}else{const a=r;a.callback=s,i.iterClosed.then(()=>{l.cancel()}).catch(h=>{l.cancel(h)});const l=new D6(this.protocol.muxSubscriptions,e,a);this.protocol.request(l);try{this.publish(e,n,{reply:`${this.protocol.muxSubscriptions.baseInbox}${l.token}`,headers:r.headers})}catch(h){l.cancel(h)}}return Promise.resolve(i)}request(e,n=fr,r={timeout:1e3,noMux:!1}){try{this._check(e,!0,!0)}catch(i){return Promise.reject(i)}if(r.timeout=r.timeout||1e3,r.timeout<1)return Promise.reject(new Ye("timeout",Ne.InvalidOption));if(!r.noMux&&r.reply)return Promise.reject(new Ye("reply can only be used with noMux",Ne.InvalidOption));if(r.noMux){const i=r.reply?r.reply:ss(this.options.inboxPrefix),o=vn(),s=new Error;return this.subscribe(i,{max:1,timeout:r.timeout,callback:(l,h)=>{l?(l.code!==Ne.Timeout&&(l.stack+=`\n\n${s.stack}`),o.reject(l)):(l=aE(h))?(l.stack+=`\n\n${s.stack}`,o.reject(l)):o.resolve(h)}}).requestSubject=e,this.protocol.publish(e,n,{reply:i,headers:r.headers}),o}{const i=new mE(this.protocol.muxSubscriptions,e,r);this.protocol.request(i);try{this.publish(e,n,{reply:`${this.protocol.muxSubscriptions.baseInbox}${i.token}`,headers:r.headers})}catch(s){i.cancel(s)}const o=Promise.race([i.timer,i.deferred]);return o.catch(()=>{i.cancel()}),o}}flush(){return this.isClosed()?Promise.reject(Ye.errorForCode(Ne.ConnectionClosed)):this.protocol.flush()}drain(){return this.isClosed()?Promise.reject(Ye.errorForCode(Ne.ConnectionClosed)):this.isDraining()?Promise.reject(Ye.errorForCode(Ne.ConnectionDraining)):(this.draining=!0,this.protocol.drain())}isClosed(){return this.protocol.isClosed()}isDraining(){return this.draining}getServer(){const e=this.protocol.getServer();return e?e.listen:""}status(){const e=new Br;return this.listeners.push(e),e}get info(){return this.protocol.isClosed()?void 0:this.protocol.info}stats(){return{inBytes:this.protocol.inBytes,outBytes:this.protocol.outBytes,inMsgs:this.protocol.inMsgs,outMsgs:this.protocol.outMsgs}}jetstreamManager(e={}){var n=this;return Oe(function*(){const r=new Kj(n,e);try{yield r.getAccountInfo()}catch(i){const o=i;throw o.code===Ne.NoResponders&&(o.code=Ne.JetStreamNotEnabled),o}return r})()}jetstream(e={}){return new fy(this,e)}getServerVersion(){const e=this.info;return e?Bs(e.version):void 0}rtt(){var e=this;return Oe(function*(){if(!e.protocol._closed&&!e.protocol.connected)throw Ye.errorForCode(Ne.Disconnect);const n=Date.now();return yield e.flush(),Date.now()-n})()}get features(){return this.protocol.features}get services(){return this._services||(this._services=new Xj(this)),this._services}}class Zj{constructor(e,n={strategy:Li.JitterTimer,maxWait:2e3},r){R(this,"nc"),R(this,"prefix"),R(this,"opts"),this.nc=e,this.prefix=r,this.opts=n}ping(e="",n=""){return this.q(Bi.PING,e,n)}stats(e="",n=""){return this.q(Bi.STATS,e,n)}schema(e="",n=""){return this.q(Bi.SCHEMA,e,n)}info(e="",n=""){return this.q(Bi.INFO,e,n)}q(e,n="",r=""){var i=this;return Oe(function*(){const o=new Br,s=io(),a=Nc.controlSubject(e,n,r,i.prefix),l=yield i.nc.requestMany(a,fr,i.opts);return Oe(function*(){var m,h=!1,g=!1;try{for(var D,C=Oi(l);h=!(D=yield C.next()).done;h=!1){const q=D.value;try{const he=s.decode(q.data);o.push(he)}catch(he){o.push(()=>{o.stop(he)})}}}catch(q){g=!0,m=q}finally{try{h&&null!=C.return&&(yield C.return())}finally{if(g)throw m}}o.push(()=>{o.stop()})})().catch(h=>{o.stop(h)}),o})()}}class Xj{constructor(e){R(this,"nc"),this.nc=e,console.log("\x1b[33m >> service framework is beta functionality \x1b[0m")}add(e){try{return new Nc(this.nc,e).start()}catch(n){return Promise.reject(n)}}client(e,n){return new Zj(this.nc,e,n)}}class e8{constructor(e){if(R(this,"subject"),R(this,"seq"),R(this,"data"),R(this,"time"),R(this,"header"),this.subject=e.message.subject,this.seq=e.message.seq,this.time=new Date(Date.parse(e.message.time)),this.data=e.message.data?this._parse(e.message.data):fr,e.message.hdrs){const n=this._parse(e.message.hdrs);this.header=os.decode(n)}else this.header=To()}_parse(e){const n=atob(e),r=n.length,i=new Uint8Array(r);for(let o=0;o<r;o++)i[o]=n.charCodeAt(o);return i}}class $E extends k6{constructor(n,r,i){super(n.nc,r,i),R(this,"js"),R(this,"monitor"),this.js=n,this.monitor=null,this.sub.closed.then(()=>{this.monitor&&this.monitor.cancel()})}set info(n){this.sub.info=n}get info(){return this.sub.info}_resetOrderedConsumer(n){if(null===this.info||this.sub.isClosed())return;const r=ss(this.js.nc.options.inboxPrefix);this.js.nc._resub(this.sub,r);const o=this.info;o.ordered_consumer_sequence.delivery_seq=0,o.flow_control.heartbeat_count=0,o.flow_control.fc_count=0,o.flow_control.consumer_restarts++,o.deliver=r,o.config.deliver_subject=r,o.config.deliver_policy=jr.StartSequence,o.config.opt_start_seq=n;const s={};s.stream_name=this.info.stream,s.config=o.config,this.js._request(`${o.api.prefix}.CONSUMER.CREATE.${o.stream}`,s).then(l=>{const h=l;this.info.config=h.config,this.info.name=h.name}).catch(l=>{const h=new Ye(`unable to recreate ordered consumer ${o.stream} at seq ${n}`,Ne.RequestError,l);this.sub.callback(h,{})})}_maybeSetupHbMonitoring(){const n=this.info?.config?.idle_heartbeat||0;n&&this._setupHbMonitoring(ey(n))}_setupHbMonitoring(n,r=0){const i={cancelAfter:0,maxOut:2};r&&(i.cancelAfter=r);const o=this.sub;this.monitor=new IE(n,a=>{const l=function m6(t,e,n){const r=To(t,e),o=new uE({hdr:1,sid:0,size:0},fr,{});return o._headers=r,o._subject=n,o}(409,`${ni.IdleHeartbeatMissed}: ${a}`,this.sub.subject);return this.info?.ordered?!!this.js.nc.protocol.connected&&(this._resetOrderedConsumer((this.info?.ordered_consumer_sequence?.stream_seq||0)+1),!1):(this.sub.callback(null,l),!o.noIterator)},i)}_checkHbOrderConsumer(n){const r=n.headers.get(_i.ConsumerStalledHdr);""!==r&&this.js.nc.publish(r);const i=parseInt(n.headers.get(_i.LastConsumerSeqHdr),10),o=this.info.ordered_consumer_sequence;return this.info.flow_control.heartbeat_count++,i!==o.delivery_seq&&this._resetOrderedConsumer(o.stream_seq+1),!1}_checkOrderedConsumer(n){const r=this.info.ordered_consumer_sequence,i=n.info.streamSequence,o=n.info.deliverySequence;return o!=r.delivery_seq+1?(this._resetOrderedConsumer(r.stream_seq+1),!1):(r.delivery_seq=o,r.stream_seq=i,!0)}destroy(){var n=this;return Oe(function*(){n.isClosed()||(yield n.drain());const r=n.sub.info,o=`${r.api.prefix}.CONSUMER.DELETE.${r.stream}.${r.config.durable_name||r.name}`;yield r.api._request(o)})()}consumerInfo(){var n=this;return Oe(function*(){const r=n.sub.info,o=`${r.api.prefix}.CONSUMER.INFO.${r.stream}.${r.config.durable_name||r.name}`,s=yield r.api._request(o);return r.last=s,s})()}}class t8 extends $E{constructor(e,n,r){super(e,n,r)}pull(e={batch:1}){const{stream:n,config:r,name:i}=this.sub.info,o=r.durable_name??i,s={};if(s.batch=e.batch||1,s.no_wait=e.no_wait||!1,(e.max_bytes??0)>0){const h=this.js.nc.features.get(Ur.JS_PULL_MAX_BYTES);if(!h.ok)throw new Error(`max_bytes is only supported on servers ${h.min} or better`);s.max_bytes=e.max_bytes}let a=0;e.expires&&e.expires>0&&(a=e.expires,s.expires=Gn(a));let l=0;if(e.idle_heartbeat&&e.idle_heartbeat>0&&(l=e.idle_heartbeat,s.idle_heartbeat=Gn(l)),l&&0===a)throw new Error("idle_heartbeat requires expires");if(l>a)throw new Error("expires must be greater than idle_heartbeat");if(this.info){this.monitor&&this.monitor.cancel(),a&&l&&(this.monitor?this.monitor._change(l,a):this._setupHbMonitoring(l,a));const h=this.info.api,m=this.sub.subject;h.nc.publish(`${h.prefix}.CONSUMER.MSG.NEXT.${n}.${o}`,h.jc.encode(s),{reply:m})}}}function r8(t,e){return t||(t=eu(e))?[t,null]:[null,hh(e)]}function i8(t,e){if(t)return[t,null];const n=eu(e);return null!==n?[qE(n),null]:[null,hh(e)]}function qE(t){if(null!==t)switch(t.code){case Ne.JetStream404NoMessages:case Ne.JetStream408RequestTimeout:return null;case Ne.JetStream409:return function v6(t){return t.code===Ne.JetStream409&&void 0!==[ni.MaxBatchExceeded,ni.MaxExpiresExceeded,ni.MaxBytesExceeded,ni.MaxMessageSizeExceeded,ni.PushConsumer,ni.IdleHeartbeatMissed].find(n=>-1!==t.message.indexOf(n))}(t)?t:null;default:return t}return null}function o8(t){t&&t.ack()}const s8=(()=>{let t=!1;return e=>{if(!t){t=!0;const{lang:n}=e?.protocol?.transport;console.log(n?`\x1b[33m >> jetstream's materialized views object store functionality in ${n} is beta functionality \x1b[0m`:"\x1b[33m >> jetstream's materialized views object store functionality is beta functionality \x1b[0m")}}})();class c8{constructor(){R(this,"version"),R(this,"lang"),R(this,"closeError"),R(this,"connected"),R(this,"done"),R(this,"socket"),R(this,"options"),R(this,"socketClosed"),R(this,"encrypted"),R(this,"peeked"),R(this,"yields"),R(this,"signal"),R(this,"closedNotification"),this.version="1.14.0",this.lang="nats.ws",this.connected=!1,this.done=!1,this.socketClosed=!1,this.encrypted=!1,this.peeked=!1,this.yields=[],this.signal=vn(),this.closedNotification=vn()}connect(e,n){var r=this;return Oe(function*(){const o=vn();if(n.tls)return o.reject(new Ye("tls",Ne.InvalidOption)),o;r.options=n;const s=e.src;if(n.wsFactory){const{socket:a,encrypted:l}=yield n.wsFactory(e.src,n);r.socket=a,r.encrypted=l}else r.encrypted=0===s.indexOf("wss://"),r.socket=new WebSocket(s);return r.socket.binaryType="arraybuffer",r.socket.onopen=()=>{},r.socket.onmessage=a=>{if(r.yields.push(new Uint8Array(a.data)),r.peeked)return void r.signal.resolve();const l=Pc.concat(...r.yields),h=function u6(t){const e=function a6(t){for(let e=0;e<t.length;e++){const n=e+1;if(t.byteLength>n&&t[e]===i6&&t[n]===o6)return n+1}return 0}(t);if(e>0){const r=new Uint8Array(t).slice(0,e);return ji.decode(r)}return""}(l);if(""!==h){const g=X6.exec(h);if(!g)return n.debug&&console.error("!!!",sh(l)),void o.reject(new Error("unexpected response from server"));try{(function Qj(t,e){const{proto:n,tls_required:r,tls_available:i}=t;if((void 0===n||n<1)&&e.noEcho)throw new Ye("noEcho",Ne.ServerOptionNotAvailable);if(e.tls&&!r&&!i)throw new Ye("tls",Ne.ServerOptionNotAvailable)})(JSON.parse(g[1]),r.options),r.peeked=!0,r.connected=!0,r.signal.resolve(),o.resolve()}catch(m){return void o.reject(m)}}},r.socket.onclose=a=>{let l;r.socketClosed=!0,r.done||(a.wasClean||(l=new Error(a.reason)),r._closed(l))},r.socket.onerror=a=>{const h=new Ye(a.message,Ne.Unknown,new Error(a.error));o.reject(h)},o})()}disconnect(){this._closed(void 0,!0)}_closed(e,n=!0){var r=this;return Oe(function*(){if(r.connected&&!r.done){if(r.closeError=e,!e)for(;!r.socketClosed&&r.socket.bufferedAmount>0;)console.log(r.socket.bufferedAmount),yield Qm(100);r.done=!0;try{r.socket.close(e?1002:1e3,e?e.message:void 0)}catch{}n&&r.closedNotification.resolve(e)}})()}get isClosed(){return this.done}[Symbol.asyncIterator](){return this.iterate()}iterate(){var e=this;return Ym(function*(){for(;;){0===e.yields.length&&(yield th(e.signal));const n=e.yields;e.yields=[];for(let r=0;r<n.length;r++)e.options.debug&&console.info(`> ${sh(n[r])}`),yield n[r];if(e.done)break;0===e.yields.length&&(n.length=0,e.yields=n,e.signal=vn())}})()}isEncrypted(){return this.connected&&this.encrypted}send(e){if(!this.done)try{return this.socket.send(e.buffer),void(this.options.debug&&console.info(`< ${sh(e)}`))}catch(n){this.options.debug&&console.error(`!!! ${sh(e)}: ${n}`)}}close(e){return this._closed(e,!1)}closed(){return this.closedNotification}}function l8(t){/^(.*:\/\/)(.*)/.test(t)||(t=`https://${t}`);let n=new URL(t);const r=n.protocol.toLowerCase();let i,o;"https:"!==r&&"http"!==r&&(t=t.replace(/^(.*:\/\/)(.*)/gm,"$2"),n=new URL(`http://${t}`));const s=n.hostname,a=n.pathname,l=n.search||"";switch(r){case"http:":case"ws:":case"nats:":o=n.port||"80",i="ws:";break;default:o=n.port||"443",i="wss:"}return`${i}//${s}:${o}${a}${l}`}let GE=(()=>{class t{constructor(){this.nc=this.establishConnection(),this.sc=nE(),this._boardSubject=new $t,this.board$=this._boardSubject.asObservable(),this._openGameSubject=new $t,this.openGame$=this._openGameSubject.asObservable(),this._gameStatusSubject=new $t,this.gameStatus$=this._gameStatusSubject.asObservable()}start(n){var r=this;this.nc.then(i=>{const o=i.subscribe(`games.${n}.moves.*`);Oe(function*(){var l,s=!1,a=!1;try{for(var g,h=Oi(o);s=!(g=yield h.next()).done;s=!1){const C=JSON.parse(r.sc.decode(g.value.data));r._boardSubject.next(C)}}catch(m){a=!0,l=m}finally{try{s&&null!=h.return&&(yield h.return())}finally{if(a)throw l}}console.log("subscription closed")})()})}watchOpenGame(){var n=this;this.nc.then(r=>{const i=r.subscribe("game.*.open.*");Oe(function*(){var a,o=!1,s=!1;try{for(var h,l=Oi(i);o=!(h=yield l.next()).done;o=!1){const m=JSON.parse(n.sc.decode(h.value.data));n._openGameSubject.next(m)}}catch(g){s=!0,a=g}finally{try{o&&null!=l.return&&(yield l.return())}finally{if(s)throw a}}console.log("subscription closed")})()})}watchGameStatus(){var n=this;this.nc.then(r=>{const i=r.subscribe("games.*.status");Oe(function*(){var a,o=!1,s=!1;try{for(var h,l=Oi(i);o=!(h=yield l.next()).done;o=!1){const m=JSON.parse(n.sc.decode(h.value.data));n._gameStatusSubject.next(m)}}catch(g){s=!0,a=g}finally{try{o&&null!=l.return&&(yield l.return())}finally{if(s)throw a}}console.log("subscription closed")})()})}establishConnection(){return Oe(function*(){return yield function d8(t={}){return function R6(t){ri=t}({defaultPort:443,urlParseFn:l8,factory:()=>new c8}),py.connect(t)}({servers:["wss://ttt-api.codeplaza.dev/nats"]})})()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h8=O(497);let Mo=(()=>{class t{constructor(){this._loginChangedSubject=new $t,this.loginChanged=this._loginChangedSubject.asObservable();const n=window.location.hostname;this._userManager=new h8.UserManager({authority:yn.stsAuthority,client_id:n,redirect_uri:`${yn.clientRoot}signin-callback`,scope:"openid identity.openid identity.profile ttt_api.tic_tac_toe.play player_account.account",response_type:"code",post_logout_redirect_uri:`${yn.clientRoot}signout-callback`,automaticSilentRenew:!0,silent_redirect_uri:`${yn.clientRoot}assets/silent-callback.html`}),this._userManager.events.addAccessTokenExpired(i=>{this._loginChangedSubject.next(!1)})}login(){return this._userManager.signinRedirect()}isLoggedIn(){return this._userManager.getUser().then(n=>{const r=!!n&&!n.expired;return n!==this._user&&this._loginChangedSubject.next(r),this._user=n,r})}completeLogin(){return this._userManager.signinRedirectCallback().then(n=>(this._user=n,this._loginChangedSubject.next(!!n&&!n.expired),n))}logout(){this._userManager.signoutRedirect()}completeLogout(){return this._user=null,this._loginChangedSubject.next(!1),this._userManager.signoutRedirectCallback()}getAccessToken(){return this._userManager.getUser().then(n=>n&&!n.expired?n.access_token:null)}getIdToken(){return this._userManager.getUser().then(n=>n&&!n.expired?n.id_token:null)}getTokens(){return this._userManager.getUser().then(n=>n&&!n.expired?{accessToken:n.access_token,idToken:n.id_token}:null)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})();function gy(t){this.message=t}(gy.prototype=new Error).name="InvalidCharacterError";var zE=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new gy("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,o=0,s="";r=e.charAt(o++);~r&&(n=i%4?64*n+r:r,i++%4)?s+=String.fromCharCode(255&n>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return s};function Sh(t){this.message=t}(Sh.prototype=new Error).name="InvalidTokenError";let Ch=(()=>{class t{constructor(){}decode(n){return function p8(t,e){if("string"!=typeof t)throw new Sh("Invalid token specified");var n=!0===(e=e||{}).header?0:1;try{return JSON.parse(function f8(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(zE(e).replace(/(.)/g,function(r,i){var o=i.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}catch{return zE(e)}}(t.split(".")[n]))}catch(r){throw new Sh("Invalid token specified: "+r.message)}}(n)}resourceDomains(n){const r=this.decode(n).aud;return Array.isArray(r)?r:[r]}userId(n){return this.decode(n).sub}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),m8=(()=>{class t{constructor(){this.klass=!0,this.onMove=new Rt}ngOnInit(){}onCellClick(n){this.onMove.emit(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["molecules-board-grid"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("board",r.klass)},inputs:{state:"state",game:"game"},outputs:{onMove:"onMove"},decls:21,vars:10,consts:[[1,"turn"],[1,"board-content"],[1,"box",3,"click"],[1,"box","center-box",3,"click"],[1,"box","bottom-box",3,"click"],[1,"box","center-box","bottom-box",3,"click"]],template:function(n,r){1&n&&(tt(0,"div",0),Wt(1),Xe(),tt(2,"div",1)(3,"div",2),mt("click",function(){return r.onCellClick("a1")}),Wt(4),Xe(),tt(5,"div",3),mt("click",function(){return r.onCellClick("a2")}),Wt(6),Xe(),tt(7,"div",2),mt("click",function(){return r.onCellClick("a3")}),Wt(8),Xe(),tt(9,"div",2),mt("click",function(){return r.onCellClick("b1")}),Wt(10),Xe(),tt(11,"div",3),mt("click",function(){return r.onCellClick("b2")}),Wt(12),Xe(),tt(13,"div",2),mt("click",function(){return r.onCellClick("b3")}),Wt(14),Xe(),tt(15,"div",4),mt("click",function(){return r.onCellClick("c1")}),Wt(16),Xe(),tt(17,"div",5),mt("click",function(){return r.onCellClick("c2")}),Wt(18),Xe(),tt(19,"div",4),mt("click",function(){return r.onCellClick("c3")}),Wt(20),Xe()()),2&n&&(kt(1),Hn(r.state),kt(3),Hn(r.game.a1),kt(2),Hn(r.game.a2),kt(2),Hn(r.game.a3),kt(2),Hn(r.game.b1),kt(2),Hn(r.game.b2),kt(2),Hn(r.game.b3),kt(2),Hn(r.game.c1),kt(2),Hn(r.game.c2),kt(2),Hn(r.game.c3))},styles:[".board{display:flex;flex-direction:column}.board .turn{background-color:#1c2f2f;color:ivory;border-radius:10px 10px 0 0/10px 10px 0px 0px;padding:10px 20px;font-weight:700;font-size:24px}.board .board-content{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr 1fr 1fr;background-color:#fff;color:#2f4f4f;border:6px solid #2F4F4F;padding:20px;max-height:428px;min-height:428px;max-width:428px;min-width:428px;font-weight:700;font-size:78px;border-radius:0 0 5px 5px/0px 0px 5px 5px}.board .board-content .box{display:flex;justify-content:center;align-items:center;background-color:#fff;border-bottom:1px dashed #1C2F2F;cursor:pointer}.board .board-content .center-box{border-right:1px dashed #1C2F2F;border-left:1px dashed #1C2F2F}.board .board-content .bottom-box{border-bottom:none}@media (max-width: 480px){.board .turn{font-size:20px}.board .board-content{font-size:52px}}@media (max-width: 414px){.board .turn{font-size:15px}.board .board-content{font-size:42px}}\n"],encapsulation:2}),t})(),y8=(()=>{class t{constructor(){this.klasses=["panel","board-panel"],this.onMove=new Rt}ngOnInit(){}onMoveChanged(n){this.onMove.emit(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["organisms-board-panel"]],hostVars:2,hostBindings:function(n,r){2&n&&Ba(r.klasses)},inputs:{state:"state",game:"game"},outputs:{onMove:"onMove"},decls:1,vars:2,consts:[[3,"state","game","onMove"]],template:function(n,r){1&n&&(tt(0,"molecules-board-grid",0),mt("onMove",function(o){return r.onMoveChanged(o)}),Xe()),2&n&&an("state",r.state)("game",r.game)},dependencies:[m8],styles:[".panel{cursor:default;color:#2a5350;background-color:#eeebe0;border:1px solid #1C2F2F;border-radius:10px;box-shadow:#959da533 0 2px 6px;font-family:sans-serif;padding:16px}.panel .panel-header{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:16px;min-height:40px}.panel .panel-header .left-side .title{font-size:18px;font-weight:400}.panel .panel-header .left-side counter{font-weight:700}.panel .panel-header .action{font-size:14px;font-weight:700;color:#f26d33}.panel.board-panel{display:flex;padding:40px}@media (max-width: 480px){.panel.board-panel{padding:20px}}\n"],encapsulation:2}),t})(),v8=(()=>{class t{constructor(n,r,i,o,s){this._route=n,this._gameService=r,this._natsService=i,this._authService=o,this._jwtService=s,this.klass=!0,this.game={},this.userId="",this.gameId=0}ngOnInit(){this._route.queryParams.subscribe(n=>{this.gameId=n.gameId,setTimeout(()=>this.setupGame(),500)})}ngOnDestroy(){this._gameSubscription&&this._gameSubscription.unsubscribe(),this._bdSubscription&&this._bdSubscription.unsubscribe()}onMove(n){this.game[n]||this.makeMove(n)}makeMove(n){const i=this._gameService.makeMove(this.gameId,{coordinate:n});this._moveSubscription=i.subscribe({error:o=>console.error(o),complete:()=>this._moveSubscription.unsubscribe()})}get state(){return this.isOpponentMissing?"Wait for opponent to join...":"tie"===this.game.state?"Tie game!":"in_progress"!==this.game.state?`${this.winner} won the game!`:this.playerName}get isOpponentMissing(){return!this.game.x_player_id||!this.game.o_player_id}get playerName(){const n=this.game.x_player_id?.toString(),r=this.game.o_player_id?.toString();return this.isX&&n===this.userId?"(X) Your turn!":this.isO&&r===this.userId?"(O) Your turn!":this.isX?`(X) ${this.xPlayer}'s turn...`:this.isO?`(O) ${this.oPlayer}'s turn...`:""}get isX(){return"X"===this.game.next_turn}get isO(){return"O"===this.game.next_turn}get winner(){return"x_won"===this.game.state?"X"===this.piceces?"You":this.xPlayer:"o_won"===this.game.state?"O"===this.piceces?"You":this.oPlayer:""}get xPlayer(){return"Human"===this.game.x_player_type?this.game.x_player_name||"":this.game.x_player_type||""}get oPlayer(){return"Human"===this.game.o_player_type?this.game.o_player_name||"":this.game.o_player_type||""}setupGame(){this._authService.getIdToken().then(n=>{if(!n)return;this._bdSubscription=this._natsService.board$.subscribe({next:o=>this.game=o}),this._natsService.start(this.gameId);const i=this._gameService.getGame(this.gameId);this._gameSubscription=i.subscribe({next:o=>{this.userId=this._jwtService.userId(n);const s=o.x_player_id?.toString(),a=o.o_player_id?.toString();s===this.userId?this.piceces="X":a===this.userId&&(this.piceces="O"),this.game=o},error:o=>console.error(o)})})}}return t.\u0275fac=function(n){return new(n||t)(De(ts),De(Jm),De(GE),De(Mo),De(Ch))},t.\u0275cmp=xn({type:t,selectors:[["pages-board"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("body",r.klass)},decls:1,vars:2,consts:[[3,"state","game","onMove"]],template:function(n,r){1&n&&(tt(0,"organisms-board-panel",0),mt("onMove",function(o){return r.onMove(o)}),Xe()),2&n&&an("state",r.state)("game",r.game)},dependencies:[y8],encapsulation:2}),t})(),Eh=(()=>{class t{constructor(){this.label="",this.onClick=new Rt}get klass(){let n=["button"];return this.styleModifier&&n.push(this.styleModifier),n}onClk(n){"disabled"!==this.styleModifier&&this.onClick.emit()}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["atoms-button"]],hostVars:2,hostBindings:function(n,r){1&n&&mt("click",function(o){return r.onClk(o.target)}),2&n&&Ba(r.klass)},inputs:{styleModifier:"styleModifier",label:"label"},outputs:{onClick:"onClick"},decls:1,vars:1,template:function(n,r){1&n&&Wt(0),2&n&&Yl("",r.label,"\n")},styles:[".button{display:block;background-color:#f26d33;color:#fff;border:1px solid #F26D33!important;border-radius:5px!important;font-size:14px!important;font-weight:600!important;min-width:-moz-fit-content;min-width:fit-content;padding:13px 30px 11px;text-decoration:none;cursor:pointer}.button.disabled{opacity:50%}\n"],encapsulation:2}),t})(),_8=(()=>{class t{constructor(){this.klass=!0,this.game={},this.onAction=new Rt}ngOnInit(){}playerName(n,r){return n?"Human"===n?r||"":n:""}get state(){return this.game&&"ongoing"===this.game.state||"joined"===this.game.state?"Ongoing":this.game&&"closed"===this.game.state?"Closed":"Open"}get player1(){return this.game.x_player_id?this.playerName(this.game.x_player_type,this.game.x_player_name):this.game.o_player_id?this.playerName(this.game.o_player_type,this.game.o_player_name):""}get player2(){return this.game.x_player_id&&this.game.o_player_id?this.playerName(this.game.o_player_type,this.game.o_player_name):""}get joinButtonStyle(){return this.isMyGame||"Open"!==this.state?"disabled":void 0}get viewButtonStyle(){if("Ongoing"!==this.state&&!this.isMyGame)return"disabled"}get isMyGame(){const n=this.game.x_player_id?.toString(),r=this.game.o_player_id?.toString();return n===this.userId||r===this.userId}onJoinClick(){this.onAction.emit("join")}onViewClick(){this.onAction.emit("view")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["molecules-game-list-item"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("game-list-item",r.klass)},inputs:{game:"game",userId:"userId"},outputs:{onAction:"onAction"},decls:9,vars:5,consts:[[1,"container"],["label","Join",3,"styleModifier","onClick"],["label","View",3,"styleModifier","onClick"]],template:function(n,r){1&n&&(tt(0,"div"),Wt(1),Xe(),tt(2,"div"),Wt(3),Xe(),tt(4,"div"),Wt(5),Xe(),tt(6,"div",0)(7,"atoms-button",1),mt("onClick",function(){return r.onJoinClick()}),Xe(),tt(8,"atoms-button",2),mt("onClick",function(){return r.onViewClick()}),Xe()()),2&n&&(kt(1),Hn(r.player1),kt(2),Hn(r.player2),kt(2),Hn(r.state),kt(2),an("styleModifier",r.joinButtonStyle),kt(1),an("styleModifier",r.viewButtonStyle))},dependencies:[Eh],styles:[".game-list-item{display:grid;grid-template-columns:5fr 5fr 4fr 1fr;height:52px;justify-items:baseline;padding:12px 15px;color:#fff;background-color:#c61e1e99;font-size:15px;border:2px solid ivory;border-radius:15px 15px 51px;font-weight:600;gap:10px}.game-list-item .container{display:flex;font-size:12px;height:20px;gap:6px}.game-list-item .button{font-size:11px!important;padding:2px 10px}.game-list-item .disabled{opacity:50%}@media (max-width: 480px){.game-list-item{font-size:11px}}@media (max-width: 414px){.game-list-item{height:44px;padding:10px 14px;font-size:10px}.game-list-item container{gap:4px}.game-list-item .button{font-size:8px!important;padding:4px 10px}}\n"],encapsulation:2}),t})();function b8(t,e){if(1&t){const n=La();Ju(0),tt(1,"molecules-game-list-item",4),mt("onAction",function(i){const s=Ss(n).$implicit;return Cs(bo().onActionEvent(i,s.id))}),Xe(),Yu()}if(2&t){const n=e.$implicit,r=bo();kt(1),an("game",n)("userId",r.userId)}}let w8=(()=>{class t{constructor(){this.klasses=["panel","game-list-panel"],this.games=[],this.onAction=new Rt,this.onNewGame=new Rt}ngOnInit(){}onActionEvent(n,r){this.onAction.emit({action:n,gameId:r})}onNewGameClick(){this.onNewGame.emit()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["organisms-game-list-panel"]],hostVars:2,hostBindings:function(n,r){2&n&&Ba(r.klasses)},inputs:{games:"games",userId:"userId"},outputs:{onAction:"onAction",onNewGame:"onNewGame"},decls:5,vars:1,consts:[[1,"header"],[1,"list"],[4,"ngFor","ngForOf"],["label","New Game","styleModifier","create",3,"onClick"],[3,"game","userId","onAction"]],template:function(n,r){1&n&&(tt(0,"div",0),Wt(1,"Join Game"),Xe(),tt(2,"div",1),gi(3,b8,2,2,"ng-container",2),Xe(),tt(4,"atoms-button",3),mt("onClick",function(){return r.onNewGameClick()}),Xe()),2&n&&(kt(3),an("ngForOf",r.games))},dependencies:[Kg,_8,Eh],styles:[".panel{cursor:default;color:#2a5350;background-color:#eeebe0;border:1px solid #1C2F2F;border-radius:10px;box-shadow:#959da533 0 2px 6px;font-family:sans-serif;padding:16px}.panel .panel-header{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:16px;min-height:40px}.panel .panel-header .left-side .title{font-size:18px;font-weight:400}.panel .panel-header .left-side counter{font-weight:700}.panel .panel-header .action{font-size:14px;font-weight:700;color:#f26d33}.game-list-panel{display:flex;flex-direction:column;align-items:center;padding:20px 50px;text-align:center}.game-list-panel .header{font-size:24px;font-weight:600;margin-bottom:10px}.game-list-panel .list{display:flex;flex-direction:column;gap:12px;background-color:#1c2f2f;padding:20px 12px;border-radius:10px;height:566px;max-width:665px;min-width:372px;overflow:auto}.game-list-panel .create{width:120px;margin:15px auto auto;font-size:18px!important;padding:10px 30px}@media (max-height: 905px){.game-list-panel .list{height:283px}}@media (max-width: 480px){.game-list-panel{padding:20px 17px}}\n"],encapsulation:2}),t})(),S8=(()=>{class t{constructor(n,r,i,o,s){this._gameService=n,this._router=r,this._natsService=i,this._authService=o,this._jwtService=s,this.klass=!0,this.games=[]}ngOnInit(){const n=this._gameService.getGames();this._gameSubscription=n.subscribe({next:r=>this.setupGames(r),error:r=>console.error(r)})}ngOnDestroy(){this._gameSubscription&&this._gameSubscription.unsubscribe(),this._openGameSubscription&&this._openGameSubscription.unsubscribe(),this._gameStatusSubscription&&this._gameStatusSubscription.unsubscribe()}onAction(n){"join"===n.action?this.joinGame(n.gameId):"view"===n.action&&this.viewGame(n.gameId)}setupGames(n){this._authService.getIdToken().then(r=>{r&&(this.userId=this._jwtService.userId(r),this.games=n,this._openGameSubscription=this._natsService.openGame$.subscribe({next:s=>this.games.unshift(s)}),this._gameStatusSubscription=this._natsService.gameStatus$.subscribe({next:s=>{const a=this.games.find(l=>l.id===s.id);!a||(a.state=s.state,"joined"===s.state&&(a.x_player_id=s.x_player_id,a.x_player_type=s.x_player_type,a.x_player_name=s.x_player_name,a.o_player_id=s.o_player_id,a.o_player_type=s.o_player_type,a.o_player_name=s.o_player_name))}}),this._natsService.watchOpenGame(),this._natsService.watchGameStatus())})}joinGame(n){const i=this._gameService.join(n).subscribe({next:()=>{this._router.navigate(["/board"],{queryParams:{gameId:n}})},error:o=>console.error(o),complete:()=>i.unsubscribe()})}viewGame(n){this._router.navigate(["/board"],{queryParams:{gameId:n}})}onCreateGame(){this._router.navigate(["/new-game"])}}return t.\u0275fac=function(n){return new(n||t)(De(Jm),De(mn),De(GE),De(Mo),De(Ch))},t.\u0275cmp=xn({type:t,selectors:[["pages-lobby"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("body",r.klass)},decls:1,vars:2,consts:[[3,"games","userId","onAction","onNewGame"]],template:function(n,r){1&n&&(tt(0,"organisms-game-list-panel",0),mt("onAction",function(o){return r.onAction(o)})("onNewGame",function(){return r.onCreateGame()}),Xe()),2&n&&an("games",r.games)("userId",r.userId)},dependencies:[w8],encapsulation:2}),t})(),C8=(()=>{class t{constructor(n){this._httpClient=n,this._httpOptions={headers:new ei({"Content-Type":"application/json"})}}getUsers(){return this._httpClient.get(`${yn.tttApiTarget}/users`,this._httpOptions)}getPlayerTypes(){return this._httpClient.get(`${yn.tttApiTarget}/player_types`,this._httpOptions)}}return t.\u0275fac=function(n){return new(n||t)(Je(Pd))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const E8=["*"];let KE=(()=>{class t{constructor(){this.klass=!0,this.label=""}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["atoms-field"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("field",r.klass)},inputs:{label:"label"},ngContentSelectors:E8,decls:4,vars:1,consts:[[1,"field-content"]],template:function(n,r){1&n&&(Kp(),tt(0,"label"),Wt(1),Xe(),tt(2,"div",0),Wp(3),Xe()),2&n&&(kt(1),Hn(r.label))},styles:[".field{display:flex;flex-direction:column;gap:5px}.field label{font-size:14px;padding-bottom:.25rem}.field .field-content{font-size:12px}\n"],encapsulation:2}),t})(),WE=(()=>{class t{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return t.\u0275fac=function(n){return new(n||t)(De(mo),De(Zr))},t.\u0275dir=dt({type:t}),t})(),Us=(()=>{class t extends WE{}return t.\u0275fac=function(){let e;return function(r){return(e||(e=cr(t)))(r||t)}}(),t.\u0275dir=dt({type:t,features:[Kt]}),t})();const oo=new ot("NgValueAccessor"),A8={provide:oo,useExisting:p(()=>xh),multi:!0},F8=new ot("CompositionEventMode");let xh=(()=>{class t extends WE{constructor(n,r,i){super(n,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function I8(){const t=to()?to().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return t.\u0275fac=function(n){return new(n||t)(De(mo),De(Zr),De(F8,8))},t.\u0275dir=dt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){1&n&&mt("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[ln([A8]),Kt]}),t})();function ls(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function YE(t){return null!=t&&"number"==typeof t.length}const gr=new ot("NgValidators"),ds=new ot("NgAsyncValidators"),M8=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class my{static min(e){return function ZE(t){return e=>{if(ls(e.value)||ls(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}(e)}static max(e){return function QE(t){return e=>{if(ls(e.value)||ls(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}(e)}static required(e){return function XE(t){return ls(t.value)?{required:!0}:null}(e)}static requiredTrue(e){return function ex(t){return!0===t.value?null:{required:!0}}(e)}static email(e){return function tx(t){return ls(t.value)||M8.test(t.value)?null:{email:!0}}(e)}static minLength(e){return function nx(t){return e=>ls(e.value)||!YE(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function rx(t){return e=>YE(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}(e)}static pattern(e){return function ix(t){if(!t)return Dh;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(ls(r.value))return null;const i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return lx(e)}static composeAsync(e){return dx(e)}}function Dh(t){return null}function ox(t){return null!=t}function sx(t){return Zu(t)?un(t):t}function ax(t){let e={};return t.forEach(n=>{e=null!=n?{...e,...n}:e}),0===Object.keys(e).length?null:e}function ux(t,e){return e.map(n=>n(t))}function cx(t){return t.map(e=>function P8(t){return!t.validate}(e)?e:n=>e.validate(n))}function lx(t){if(!t)return null;const e=t.filter(ox);return 0==e.length?null:function(n){return ax(ux(n,e))}}function yy(t){return null!=t?lx(cx(t)):null}function dx(t){if(!t)return null;const e=t.filter(ox);return 0==e.length?null:function(n){return function x8(...t){const e=Xs(t),{args:n,keys:r}=P1(t),i=new It(o=>{const{length:s}=n;if(!s)return void o.complete();const a=new Array(s);let l=s,h=s;for(let g=0;g<s;g++){let m=!1;Zt(n[g]).subscribe(new qt(o,C=>{m||(m=!0,h--),a[g]=C},()=>l--,void 0,()=>{(!l||!m)&&(h||o.next(r?R1(r,a):a),o.complete())}))}});return e?i.pipe(k1(e)):i}(ux(n,e).map(sx)).pipe(at(ax))}}function vy(t){return null!=t?dx(cx(t)):null}function hx(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function fx(t){return t._rawValidators}function px(t){return t._rawAsyncValidators}function _y(t){return t?Array.isArray(t)?t:[t]:[]}function Ah(t,e){return Array.isArray(t)?t.includes(e):t===e}function gx(t,e){const n=_y(e);return _y(t).forEach(i=>{Ah(n,i)||n.push(i)}),n}function mx(t,e){return _y(e).filter(n=>!Ah(t,n))}class yx{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=yy(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=vy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,n){return!!this.control&&this.control.hasError(e,n)}getError(e,n){return this.control?this.control.getError(e,n):null}}class Mr extends yx{get formDirective(){return null}get path(){return null}}class hs extends yx{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class vx{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let _x=(()=>{class t extends vx{constructor(n){super(n)}}return t.\u0275fac=function(n){return new(n||t)(De(hs,2))},t.\u0275dir=dt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){2&n&&Or("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Kt]}),t})(),bx=(()=>{class t extends vx{constructor(n){super(n)}}return t.\u0275fac=function(n){return new(n||t)(De(Mr,10))},t.\u0275dir=dt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){2&n&&Or("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Kt]}),t})();const $c="VALID",Fh="INVALID",ru="PENDING",qc="DISABLED";function Cy(t){return(Th(t)?t.validators:t)||null}function Sx(t){return Array.isArray(t)?yy(t):t||null}function Ey(t,e){return(Th(e)?e.asyncValidators:t)||null}function Cx(t){return Array.isArray(t)?vy(t):t||null}function Th(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Dx{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=n,this._composedValidatorFn=Sx(this._rawValidators),this._composedAsyncValidatorFn=Cx(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===$c}get invalid(){return this.status===Fh}get pending(){return this.status==ru}get disabled(){return this.status===qc}get enabled(){return this.status!==qc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=Sx(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Cx(e)}addValidators(e){this.setValidators(gx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(gx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(mx(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(mx(e,this._rawAsyncValidators))}hasValidator(e){return Ah(this._rawValidators,e)}hasAsyncValidator(e){return Ah(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ru,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=qc,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=$c,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===$c||this.status===ru)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?qc:$c}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ru,this._hasOwnPendingAsyncValidator=!0;const n=sx(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(!1!==n.emitEvent)}get(e){let n=e;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Rt,this.statusChanges=new Rt}_calculateStatus(){return this._allControlsDisabled()?qc:this.errors?Fh:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ru)?ru:this._anyControlsHaveStatus(Fh)?Fh:$c}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Th(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}}const B8=class Mh extends Dx{constructor(e,n,r){super(Cy(n),Ey(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){(function xx(t,e,n){t._forEachChild((r,i)=>{if(void 0===n[i])throw new E(1002,"")})})(this,0,e),Object.keys(e).forEach(r=>{(function Ex(t,e,n){const r=t.controls;if(!(e?Object.keys(r):r).length)throw new E(1e3,"");if(!r[n])throw new E(1001,"")})(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){null!=e&&(Object.keys(e).forEach(r=>{const i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>!!r._syncPendingControls()||n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{const r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,o)=>{r=n(r,i,o)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};function Gc(t,e){xy(t,e),e.valueAccessor.writeValue(t.value),t.disabled&&e.valueAccessor.setDisabledState?.(!0),function H8(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Ax(t,e)})}(t,e),function q8(t,e){const n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function $8(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Ax(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function U8(t,e){if(e.valueAccessor.setDisabledState){const n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function kh(t,e,n=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Nh(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Rh(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function xy(t,e){const n=fx(t);null!==e.validator?t.setValidators(hx(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const r=px(t);null!==e.asyncValidator?t.setAsyncValidators(hx(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();Rh(e._rawValidators,i),Rh(e._rawAsyncValidators,i)}function Nh(t,e){let n=!1;if(null!==t){if(null!==e.validator){const i=fx(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.validator);o.length!==i.length&&(n=!0,t.setValidators(o))}}if(null!==e.asyncValidator){const i=px(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(n=!0,t.setAsyncValidators(o))}}}const r=()=>{};return Rh(e._rawValidators,r),Rh(e._rawAsyncValidators,r),n}function Ax(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Mx(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function Px(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const Fy=class extends Dx{constructor(e=null,n,r){super(Cy(n),Ey(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Th(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=Px(e)?e.value:e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Mx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Mx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){Px(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Oh=Fy;let Lx=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=dt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})(),Bx=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({}),t})();const Ty=new ot("NgModelWithFormControlWarning"),i4={provide:Mr,useExisting:p(()=>Lh)};let Lh=(()=>{class t extends Mr{constructor(n,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Rt,this._setValidators(n),this._setAsyncValidators(r)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Nh(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const r=this.form.get(n.path);return Gc(r,n),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),r}getControl(n){return this.form.get(n.path)}removeControl(n){kh(n.control||null,n,!1),function W8(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,r){this.form.get(n.path).setValue(r)}onSubmit(n){return this.submitted=!0,function Tx(t,e){t._syncPendingControls(),e.forEach(n=>{const r=n.control;"submit"===r.updateOn&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const r=n.control,i=this.form.get(n.path);r!==i&&(kh(r||null,n),(t=>t instanceof Fy)(i)&&(Gc(i,n),n.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const r=this.form.get(n.path);(function Ix(t,e){xy(t,e)})(r,n),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const r=this.form.get(n.path);r&&function G8(t,e){return Nh(t,e)}(r,n)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){xy(this.form,this),this._oldForm&&Nh(this._oldForm,this)}_checkFormPresent(){}}return t.\u0275fac=function(n){return new(n||t)(De(gr,10),De(ds,10))},t.\u0275dir=dt({type:t,selectors:[["","formGroup",""]],hostBindings:function(n,r){1&n&&mt("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ln([i4]),Kt,hi]}),t})();const a4={provide:hs,useExisting:p(()=>ky)};let ky=(()=>{class t extends hs{constructor(n,r,i,o,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.update=new Rt,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function Ay(t,e){if(!e)return null;let n,r,i;return Array.isArray(e),e.forEach(o=>{o.constructor===xh?n=o:function K8(t){return Object.getPrototypeOf(t.constructor)===Us}(o)?r=o:i=o}),i||r||n||null}(0,o)}set isDisabled(n){}ngOnChanges(n){this._added||this._setUpControl(),function Dy(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return function Ph(t,e){return[...e.path,t]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return t._ngModelWarningSentOnce=!1,t.\u0275fac=function(n){return new(n||t)(De(Mr,13),De(gr,10),De(ds,10),De(oo,10),De(Ty,8))},t.\u0275dir=dt({type:t,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[ln([a4]),Kt,hi]}),t})();const u4={provide:oo,useExisting:p(()=>Ry),multi:!0};function qx(t,e){return null==t?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let Ry=(()=>{class t extends Us{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const i=qx(this._getOptionId(n),n);this.setProperty("value",i)}registerOnChange(n){this.onChange=r=>{this.value=this._getOptionValue(r),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),n))return r;return null}_getOptionValue(n){const r=function c4(t){return t.split(":")[0]}(n);return this._optionMap.has(r)?this._optionMap.get(r):n}}return t.\u0275fac=function(){let e;return function(r){return(e||(e=cr(t)))(r||t)}}(),t.\u0275dir=dt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,r){1&n&&mt("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[ln([u4]),Kt]}),t})(),Gx=(()=>{class t{constructor(n,r,i){this._element=n,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(qx(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(n){return new(n||t)(De(Zr),De(mo),De(Ry,9))},t.\u0275dir=dt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const l4={provide:oo,useExisting:p(()=>Ny),multi:!0};function zx(t,e){return null==t?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let Ny=(()=>{class t extends Us{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let r;if(this.value=n,Array.isArray(n)){const i=n.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(n){this.onChange=r=>{const i=[],o=r.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const h=this._getOptionValue(s[a].value);i.push(h)}}else{const s=r.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const h=this._getOptionValue(l.value);i.push(h)}}}this.value=i,n(i)}}_registerOption(n){const r=(this._idCounter++).toString();return this._optionMap.set(r,n),r}_getOptionId(n){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,n))return r;return null}_getOptionValue(n){const r=function d4(t){return t.split(":")[0]}(n);return this._optionMap.has(r)?this._optionMap.get(r)._value:n}}return t.\u0275fac=function(){let e;return function(r){return(e||(e=cr(t)))(r||t)}}(),t.\u0275dir=dt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,r){1&n&&mt("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[ln([l4]),Kt]}),t})(),Kx=(()=>{class t{constructor(n,r,i){this._element=n,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(zx(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(zx(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(n){return new(n||t)(De(Zr),De(mo),De(Ny,9))},t.\u0275dir=dt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})(),b4=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({imports:[Bx]}),t})(),w4=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:Ty,useValue:n.warnOnNgModelWithFormControl}]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({imports:[b4]}),t})();function C4(t,e){if(1&t&&(Ju(0),tt(1,"option",3),Wt(2),Xe(),Yu()),2&t){const n=e.$implicit;kt(1),an("value",n.value),kt(1),Hn(n.label)}}let E4=(()=>{class t{constructor(){this.placeholder="",this.options=[],this.valueChanged=new Rt}ngOnInit(){}onValueChange(n){this.valueChanged.emit(n.target.value)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["atoms-dropdown"]],inputs:{placeholder:"placeholder",options:"options"},outputs:{valueChanged:"valueChanged"},decls:4,vars:2,consts:[[1,"drop-down",3,"change"],["disabled","","selected","",1,"placeholder"],[4,"ngFor","ngForOf"],[3,"value"]],template:function(n,r){1&n&&(tt(0,"select",0),mt("change",function(o){return r.onValueChange(o)}),tt(1,"option",1),Wt(2),Xe(),gi(3,C4,3,2,"ng-container",2),Xe()),2&n&&(kt(2),Hn(r.placeholder),kt(1),an("ngForOf",r.options))},dependencies:[Kg,Gx,Kx],styles:[".drop-down{display:flex;justify-content:space-between;align-items:center;width:100%;max-width:none;color:#2f4f4f;font-size:12px;border:1px solid rgba(118,118,118,.2);border-radius:6px;line-height:40px;padding:12px;text-decoration:none;background-color:#fff}.drop-down .select{font-weight:700}.drop-down .placeholder{font-weight:400;color:#878282}\n"],encapsulation:2}),t})(),x4=(()=>{class t{constructor(){this.klasses=["panel","new-game-panel"],this.playerTypeOptions=[],this.newGame=new Rt,this.playerType=""}set playerTypes(n){this.playerTypeOptions=n.map(r=>({value:r.id.toString(),label:r.name}))}ngOnInit(){}onNewGameClick(){this.newGame.emit(this.playerType)}onPlayerTypeSelected(n){this.playerType=n}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["organisms-new-game"]],hostVars:2,hostBindings:function(n,r){2&n&&Ba(r.klasses)},inputs:{playerTypes:"playerTypes"},outputs:{newGame:"newGame"},decls:7,vars:1,consts:[[1,"header"],[1,"content"],["label","Opponent Type"],["placeholder","Please Select",3,"options","valueChanged"],[1,"container"],["label","Start Game",3,"onClick"]],template:function(n,r){1&n&&(tt(0,"div",0),Wt(1,"New Game"),Xe(),tt(2,"div",1)(3,"atoms-field",2)(4,"atoms-dropdown",3),mt("valueChanged",function(o){return r.onPlayerTypeSelected(o)}),Xe()()(),tt(5,"div",4)(6,"atoms-button",5),mt("onClick",function(){return r.onNewGameClick()}),Xe()()),2&n&&(kt(4),an("options",r.playerTypeOptions))},dependencies:[Eh,KE,E4],styles:[".new-game-panel{display:flex;flex-direction:column;padding:20px 0;border:1px solid #1C2F2F;font-weight:700;color:#2f4f4f;max-width:473px;width:100%;gap:50px}.new-game-panel .header{text-align:center;font-size:24px;font-weight:600;margin-bottom:10px;border-bottom:1px solid #1C2F2F;width:100%}.new-game-panel .content{width:70%;align-self:center}.new-game-panel .container{margin:auto}.new-game-panel .container .loading{display:none;gap:8px}.new-game-panel .container .loading .loader{margin:auto;border:3px solid rgba(195,195,195,.7647058824);border-top:3px solid #F26D33;width:14px;height:14px}.new-game-panel .container .checkbox{display:none}.new-game-panel .container input:checked~.loading{display:flex}.new-game-panel .container input:checked~label{opacity:50%;width:75%;margin:20px auto auto;padding:0}\n"],encapsulation:2}),t})(),D4=(()=>{class t{constructor(n,r,i){this._userService=n,this._gameService=r,this._router=i,this.klass=!0,this.playerTypes=[]}ngOnInit(){const n=this._userService.getPlayerTypes();this._playerTypesSubscription=n.subscribe({next:r=>{this.playerTypes=r,this._playerTypesSubscription.unsubscribe()},error:r=>console.error(r)})}ngOnDestroy(){this._playerTypesSubscription&&this._playerTypesSubscription.unsubscribe()}onOpponentChange(n){this.opponentType=this.playerTypes.find(r=>r.id===+n)}onCreateGame(n){const r=this.playerTypes.find(o=>o.id===+n);if(!r)return;const i=this._gameService.create({opponent_type:r.name});this._gameSubscription=i.subscribe({next:o=>{this._router.navigate(["/board"],{queryParams:{gameId:o.id}})},error:o=>console.error(o),complete:()=>this._gameSubscription.unsubscribe()})}}return t.\u0275fac=function(n){return new(n||t)(De(C8),De(Jm),De(mn))},t.\u0275cmp=xn({type:t,selectors:[["pages-new-game"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("body",r.klass)},decls:1,vars:1,consts:[[3,"playerTypes","newGame"]],template:function(n,r){1&n&&(tt(0,"organisms-new-game",0),mt("newGame",function(o){return r.onCreateGame(o)}),Xe()),2&n&&an("playerTypes",r.playerTypes)},dependencies:[x4],styles:[".panel{cursor:default;color:#2a5350;background-color:#eeebe0;border:1px solid #1C2F2F;border-radius:10px;box-shadow:#959da533 0 2px 6px;font-family:sans-serif;padding:16px}.panel .panel-header{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:16px;min-height:40px}.panel .panel-header .left-side .title{font-size:18px;font-weight:400}.panel .panel-header .left-side counter{font-weight:700}.panel .panel-header .action{font-size:14px;font-weight:700;color:#f26d33}.new-game-panel{display:flex;flex-direction:column;padding:20px 0;border:1px solid #1C2F2F;font-weight:700;color:#2f4f4f;max-width:473px;gap:50px}.new-game-panel .header{text-align:center;font-size:24px;font-weight:600;margin-bottom:10px;border-bottom:1px solid #1C2F2F;width:100%}.new-game-panel .content{width:70%;align-self:center}.new-game-panel .container{margin:auto}.new-game-panel .container .loading{display:none;gap:8px}.new-game-panel .container .loading .loader{margin:auto;border:3px solid rgba(195,195,195,.7647058824);border-top:3px solid #F26D33;width:14px;height:14px}.new-game-panel .container .checkbox{display:none}.new-game-panel .container input:checked~.loading{display:flex}.new-game-panel .container input:checked~label{opacity:50%;width:75%;margin:20px auto auto;padding:0}\n"],encapsulation:2}),t})(),rD=(()=>{class t{constructor(n){this._httpClient=n,this._httpOptions={headers:new ei({"Content-Type":"application/json"})}}getAccounts(){return this._httpClient.get(`${yn.playerAccounTarget}/player_accounts`,this._httpOptions)}get(){return this._httpClient.get(`${yn.playerAccounTarget}/player_accounts`,this._httpOptions)}create(n){return this._httpClient.post(`${yn.playerAccounDomain+yn.resourceApiRoot}/player_accounts`,n,this._httpOptions)}update(n){return this._httpClient.put(`${yn.playerAccounTarget}/player_accounts`,n,this._httpOptions)}}return t.\u0275fac=function(n){return new(n||t)(Je(Pd))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function A4(t,e){1&t&&(tt(0,"div",15),Wt(1,"Sign Up"),Xe())}function I4(t,e){1&t&&(tt(0,"div",15),Wt(1,"Update Account"),Xe())}function F4(t,e){if(1&t){const n=La();tt(0,"div",16)(1,"atoms-button",17),mt("click",function(){return Ss(n),Cs(bo().onSignUpClick())}),Xe(),tt(2,"atoms-button",18),mt("click",function(){return Ss(n),Cs(bo().onSignInClick())}),Xe()()}}function T4(t,e){1&t&&tr(0,"atoms-button",19)}function M4(t,e){if(1&t){const n=La();tt(0,"atoms-button",20),mt("click",function(){return Ss(n),Cs(bo().onUpdateClick())}),Xe()}}let iD=(()=>{class t{constructor(){this.klasses=["panel","account-panel"],this.playerAccountValue={name:"",email:"",password:"",password_confirmation:""},this.isUpdateAccount=!1,this.onSignIn=new Rt,this.onSignUp=new Rt,this.onUpdate=new Rt}set playerAccount(n){!n||(this.playerAccountValue=n,this.playerAccountValue.password="",this.playerAccountValue.password_confirmation="",this.form.setValue(n))}ngOnInit(){this.generateForm()}onSignInClick(){this.onSignIn.emit()}generateForm(){this.form=new B8({name:new Oh("",{validators:[my.required]}),email:new Oh("",{validators:[my.required]}),password:new Oh("",{validators:this.passwordValidators()}),password_confirmation:new Oh("",{validators:this.passwordValidators()})},{updateOn:"blur"})}passwordValidators(){return this.isUpdateAccount?[]:[my.required]}getAccountAttrs(){const n=this.form.controls;for(const r in n)n[r].invalid&&console.log("Invalid ---\x3e",r);if(this.form.valid)return this.form.value}onSignUpClick(){const n=this.getAccountAttrs();n&&this.onSignUp.emit(n)}onUpdateClick(){const n=this.getAccountAttrs();n&&this.onUpdate.emit(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["organisms-account-panel"]],hostVars:2,hostBindings:function(n,r){2&n&&Ba(r.klasses)},inputs:{playerAccount:"playerAccount",isUpdateAccount:"isUpdateAccount"},outputs:{onSignIn:"onSignIn",onSignUp:"onSignUp",onUpdate:"onUpdate"},decls:16,vars:6,consts:[["class","header",4,"ngIf"],[1,"content",3,"formGroup"],["label","Name"],["placeholder","Please enter","formControlName","name",1,"text-input"],["label","Email"],["placeholder","Please enter","formControlName","email",1,"text-input"],["label","Password"],["type","password","placeholder","Please enter","formControlName","password",1,"text-input"],["label","Password Confrimation"],["type","password","placeholder","Please enter","formControlName","password_confirmation",1,"text-input"],["class","btn content",4,"ngIf"],[1,"saparator"],[1,"btn"],["label","Forgot Password",4,"ngIf"],["label","Update",3,"click",4,"ngIf"],[1,"header"],[1,"btn","content"],["label","Sign Up",3,"click"],["label","Sign In",3,"click"],["label","Forgot Password"],["label","Update",3,"click"]],template:function(n,r){1&n&&(gi(0,A4,2,0,"div",0),gi(1,I4,2,0,"div",0),tt(2,"form",1)(3,"atoms-field",2),tr(4,"input",3),Xe(),tt(5,"atoms-field",4),tr(6,"input",5),Xe(),tt(7,"atoms-field",6),tr(8,"input",7),Xe(),tt(9,"atoms-field",8),tr(10,"input",9),Xe()(),gi(11,F4,3,0,"div",10),tr(12,"div",11),tt(13,"div",12),gi(14,T4,1,0,"atoms-button",13),gi(15,M4,1,0,"atoms-button",14),Xe()),2&n&&(an("ngIf",!r.isUpdateAccount),kt(1),an("ngIf",r.isUpdateAccount),kt(1),an("formGroup",r.form),kt(9),an("ngIf",!r.isUpdateAccount),kt(3),an("ngIf",!r.isUpdateAccount),kt(1),an("ngIf",r.isUpdateAccount))},dependencies:[Wg,Lx,xh,_x,bx,Lh,ky,Eh,KE],styles:[".text-input{border:1px solid rgba(118,118,118,.2);border-radius:4px;height:44px;padding-left:10px;padding-right:10px;width:100%}.text-input::placeholder{opacity:.6}.account-panel{display:inline-flex;flex-direction:column;gap:30px;padding:20px 0;text-align:center;font-weight:700;border:1px solid #1C2F2F}.account-panel .header{font-size:24px;font-weight:600;margin-bottom:10px;border-bottom:1px solid #1C2F2F}.account-panel .content{display:grid;grid-template-columns:1fr 1fr;gap:12px;row-gap:20px;padding:0 15px;text-align:start}.account-panel .content .field label{font-size:13px}.account-panel .btn{margin:auto}.account-panel .saparator{border-top:1px solid #1C2F2F}\n"],encapsulation:2}),t})(),P4=(()=>{class t{constructor(n,r){this._authService=n,this._playerAccountService=r,this.klass=!0}ngOnInit(){}signIn(){this._authService.login()}signUp(n){this._playerAccountService.create(n).subscribe(()=>{console.log("Saved Player account!"),this._authService.login()})}}return t.\u0275fac=function(n){return new(n||t)(De(Mo),De(rD))},t.\u0275cmp=xn({type:t,selectors:[["pages-sign-up"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("body",r.klass)},decls:1,vars:0,consts:[[3,"onSignIn","onSignUp"]],template:function(n,r){1&n&&(tt(0,"organisms-account-panel",0),mt("onSignIn",function(){return r.signIn()})("onSignUp",function(o){return r.signUp(o)}),Xe())},dependencies:[iD],encapsulation:2}),t})();const jh=(t,e)=>{const n=pn(mn);return pn(Mo).isLoggedIn().then(o=>!!o||(n.navigate(["/sign-up"]),!1))},O4=[{path:"",redirectTo:"/lobby",pathMatch:"full"},{path:"signin-callback",component:(()=>{class t{constructor(n,r){this._authService=n,this._router=r}ngOnInit(){this._authService.completeLogin().then(n=>{this._router.navigate(["/"],{replaceUrl:!0})})}}return t.\u0275fac=function(n){return new(n||t)(De(Mo),De(mn))},t.\u0275cmp=xn({type:t,selectors:[["app-signin-callback"]],decls:1,vars:0,template:function(n,r){1&n&&tr(0,"div")},encapsulation:2}),t})()},{path:"signout-callback",component:(()=>{class t{constructor(n,r){this._authService=n,this._router=r}ngOnInit(){this._authService.completeLogout().then(n=>{this._router.navigate(["/"],{replaceUrl:!0})})}}return t.\u0275fac=function(n){return new(n||t)(De(Mo),De(mn))},t.\u0275cmp=xn({type:t,selectors:[["app-signout-callback"]],decls:1,vars:0,template:function(n,r){1&n&&tr(0,"div")},encapsulation:2}),t})()},{path:"lobby",component:S8,canActivate:[jh]},{path:"new-game",component:D4,canActivate:[jh]},{path:"board",component:v8,canActivate:[jh]},{path:"sign-up",component:P4},{path:"update-account",component:(()=>{class t{constructor(n,r){this._router=n,this._playerAccountService=r,this.klass=!0}ngOnInit(){this._playerAccountService.get().subscribe({next:r=>this.playerAccount=r,error:r=>console.error(r)})}update(n){this._playerAccountService.update(n).subscribe(()=>{console.log("Updated Player account!"),this._router.navigate(["/lobby"])})}}return t.\u0275fac=function(n){return new(n||t)(De(mn),De(rD))},t.\u0275cmp=xn({type:t,selectors:[["pages-update-account"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("body",r.klass)},decls:1,vars:2,consts:[[3,"playerAccount","isUpdateAccount","onUpdate"]],template:function(n,r){1&n&&(tt(0,"organisms-account-panel",0),mt("onUpdate",function(o){return r.update(o)}),Xe()),2&n&&an("playerAccount",r.playerAccount)("isUpdateAccount",!0)},dependencies:[iD],encapsulation:2}),t})(),canActivate:[jh]}];let L4=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({imports:[zC.forRoot(O4),zC]}),t})();function j4(t,e){if(1&t){const n=La();tt(0,"div",11),mt("click",function(){return Ss(n),Cs(bo().onLogoutClick())}),Wt(1,"Sign Out"),Xe()}}function B4(t,e){if(1&t){const n=La();tt(0,"div",11),mt("click",function(){return Ss(n),Cs(bo().onLoginClick())}),Wt(1,"Sign in"),Xe()}}function V4(t,e){1&t&&tr(0,"img",12)}function U4(t,e){if(1&t&&(tt(0,"div",13)(1,"div",14),Wt(2),Xe(),tr(3,"img",15),Xe()),2&t){const n=bo();kt(2),Hn(n.amount)}}let H4=(()=>{class t{constructor(){this.isLoggedIn=!1,this.onLogin=new Rt,this.klass=!0,this.amount=120}ngOnInit(){}onLoginClick(){this.onLogin.emit(!0)}onLogoutClick(){this.onLogin.emit(!1)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["atoms-header"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("menu-header",r.klass)},inputs:{isLoggedIn:"isLoggedIn"},outputs:{onLogin:"onLogin"},decls:19,vars:4,consts:[[1,"container","left-side"],[1,"dropdown"],["id","tic-tac-toe-img","src","../../assets/tic-tac-toe.png"],[1,"dropdown-content"],["id","separator"],[1,"title"],[1,"right-side"],[1,"tool-bar"],["class","sign-in-out",3,"click",4,"ngIf"],["class","user-icon","src","../../assets/user.png",4,"ngIf"],["class","winning-fund",4,"ngIf"],[1,"sign-in-out",3,"click"],["src","../../assets/user.png",1,"user-icon"],[1,"winning-fund"],[1,"amount"],["src","../../assets/coin-icon.png",1,"coin-icon"]],template:function(n,r){1&n&&(tt(0,"div",0)(1,"div",1),tr(2,"img",2),tt(3,"div",3)(4,"a"),Wt(5,"Lobby"),Xe(),tt(6,"a"),Wt(7,"Tournament"),Xe(),tt(8,"a"),Wt(9,"Tournament Schedules"),Xe()()(),tr(10,"div",4),tt(11,"div",5),Wt(12,"Tic Tac Toe"),Xe()(),tt(13,"div",6)(14,"div",7),gi(15,j4,2,0,"div",8),gi(16,B4,2,0,"div",8),Xe(),gi(17,V4,1,0,"img",9),gi(18,U4,4,1,"div",10),Xe()),2&n&&(kt(15),an("ngIf",r.isLoggedIn),kt(1),an("ngIf",!r.isLoggedIn),kt(1),an("ngIf",r.isLoggedIn),kt(1),an("ngIf",r.isLoggedIn))},dependencies:[Wg],styles:[".menu-header{display:flex;align-content:center;background-color:#2f4f4f;height:50px;justify-content:space-between;font-weight:600}.menu-header .dropdown #tic-tac-toe-img{width:40px;height:40px;margin:5px 0}.menu-header .dropdown .dropdown-content{display:none;flex-direction:column;background-color:#2f4f4f;box-shadow:0 8px 16px;width:500px;position:absolute;top:50px;font-weight:600;font-size:larger}.menu-header .dropdown .dropdown-content a{padding:15px;color:ivory}.menu-header .dropdown .dropdown-content a:hover{background-color:ivory;color:#2f4f4f}.menu-header .dropdown:hover .dropdown-content{display:flex}.menu-header #separator{border-right:5px solid #FCFCDD;padding-left:8px;margin-right:40px}.menu-header .left-side{display:flex}.menu-header .right-side{display:flex;padding-right:16px;gap:10px}.menu-header .tool-bar{background-color:#f26d33;display:flex}.menu-header .tool-bar .sign-in-out{align-self:center;padding:12px;color:ivory;cursor:pointer;font-size:14px}.menu-header .winning-fund{display:flex;gap:5px}.menu-header .user-icon{width:33px;height:33px;margin:9px 0}.menu-header .coin-icon{width:14px;height:14px;margin:18px 0}.menu-header .title{color:ivory;font-size:29px;margin:auto}.menu-header .amount{font-size:13px;color:#fff;margin:auto}@media (max-width: 414px){.menu-header #separator{margin-right:20px}.menu-header .title{font-size:24px}}\n"],encapsulation:2}),t})();const $4=["*"];let q4=(()=>{class t{constructor(n){this._authService=n,this.klass=!0,this.isLoggedIn=!1,this._authService.loginChanged.subscribe(r=>{this.isLoggedIn=r})}ngOnInit(){this._authService.isLoggedIn().then(n=>{this.isLoggedIn=n})}loginOrLogout(n){n?this._authService.login():this._authService.logout()}}return t.\u0275fac=function(n){return new(n||t)(De(Mo))},t.\u0275cmp=xn({type:t,selectors:[["templates-page-template"]],hostVars:2,hostBindings:function(n,r){2&n&&Or("page-template",r.klass)},ngContentSelectors:$4,decls:3,vars:1,consts:[[3,"isLoggedIn","onLogin"],[1,"footer"]],template:function(n,r){1&n&&(Kp(),tt(0,"atoms-header",0),mt("onLogin",function(o){return r.loginOrLogout(o)}),Xe(),Wp(1),tr(2,"div",1)),2&n&&an("isLoggedIn",r.isLoggedIn)},dependencies:[H4],styles:[".page-template{display:flex;flex-direction:column;background-image:url(background.cb6155ea1d1d9a4d.svg);background-repeat:no-repeat;background-size:250%;background-color:#f6f6f2;height:100vh}.page-template .menu-header{position:sticky;top:0}.page-template .body{display:flex;align-items:center;justify-content:center;height:100%}.page-template .footer{width:100%;height:52px;background-color:#2f4f4f}\n"],encapsulation:2}),t})(),G4=(()=>{class t{constructor(){this.title="Tic Tac Toe v3"}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=xn({type:t,selectors:[["app-root"]],decls:2,vars:0,consts:[["amount","200"]],template:function(n,r){1&n&&(tt(0,"templates-page-template",0),tr(1,"router-outlet"),Xe())},dependencies:[Rm,q4]}),t})(),K4=(()=>{class t{constructor(n,r){this._authService=n,this._jwtService=r}intercept(n,r){let i=n.url.startsWith(yn.tttApiTarget);return i=i||n.url.startsWith(yn.playerAccounTarget),i?un(this._authService.getTokens().then(o=>{if(o){const s=(new ei).set("Authorization",`Bearer ${o.accessToken}`);s.set("Content-Type","application/json");const a=this._jwtService.resourceDomains(o.accessToken);let l="";n.url.includes(yn.tttApiTarget)?l=yn.tttApiTarget:n.url.includes(yn.playerAccounTarget)&&(l=yn.playerAccounTarget);const h=a.find(C=>C.includes(l)),g=n.url.replace(l,h+yn.resourceApiRoot),m=n.clone({headers:s,url:g});return function z4(t,e){const n="object"==typeof e;return new Promise((r,i)=>{let s,o=!1;t.subscribe({next:a=>{s=a,o=!0},error:i,complete:()=>{o?r(s):n?r(e.defaultValue):i(new gc)}})})}(r.handle(m))}throw new lm({error:"Tokens invalid or expired!",headers:n.headers,status:419,statusText:"Error",url:n.url})})):r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(Je(Mo),Je(Ch))},t.\u0275prov=Ve({token:t,factory:t.\u0275fac}),t})(),W4=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t}),t.\u0275inj=Bt({providers:[Mo,Ch,{provide:hm,useClass:K4,multi:!0}]}),t})(),J4=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=qr({type:t,bootstrap:[G4]}),t.\u0275inj=Bt({imports:[eO,L4,CO,W4,w4]}),t})();(function pk(){bS=!1})(),XN().bootstrapModule(J4).catch(t=>console.error(t))},497:function(Si){Si.exports=function(Ge){var O={};function ne(Q){if(O[Q])return O[Q].exports;var x=O[Q]={i:Q,l:!1,exports:{}};return Ge[Q].call(x.exports,x,x.exports,ne),x.l=!0,x.exports}return ne.m=Ge,ne.c=O,ne.d=function(Q,x,Z){ne.o(Q,x)||Object.defineProperty(Q,x,{enumerable:!0,get:Z})},ne.r=function(Q){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},ne.t=function(Q,x){if(1&x&&(Q=ne(Q)),8&x||4&x&&"object"==typeof Q&&Q&&Q.__esModule)return Q;var Z=Object.create(null);if(ne.r(Z),Object.defineProperty(Z,"default",{enumerable:!0,value:Q}),2&x&&"string"!=typeof Q)for(var k in Q)ne.d(Z,k,function(_){return Q[_]}.bind(null,k));return Z},ne.n=function(Q){var x=Q&&Q.__esModule?function(){return Q.default}:function(){return Q};return ne.d(x,"a",x),x},ne.o=function(Q,x){return Object.prototype.hasOwnProperty.call(Q,x)},ne.p="",ne(ne.s=22)}([function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0});var Q=function(){function _(b,v){for(var T=0;T<v.length;T++){var z=v[T];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(b,z.key,z)}}return function(b,v,T){return v&&_(b.prototype,v),T&&_(b,T),b}}(),x={debug:function(){},info:function(){},warn:function(){},error:function(){}},Z=void 0,k=void 0;(O.Log=function(){function _(){!function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}(this,_)}return _.reset=function(){k=3,Z=x},_.debug=function(){if(k>=4){for(var v=arguments.length,T=Array(v),z=0;z<v;z++)T[z]=arguments[z];Z.debug.apply(Z,Array.from(T))}},_.info=function(){if(k>=3){for(var v=arguments.length,T=Array(v),z=0;z<v;z++)T[z]=arguments[z];Z.info.apply(Z,Array.from(T))}},_.warn=function(){if(k>=2){for(var v=arguments.length,T=Array(v),z=0;z<v;z++)T[z]=arguments[z];Z.warn.apply(Z,Array.from(T))}},_.error=function(){if(k>=1){for(var v=arguments.length,T=Array(v),z=0;z<v;z++)T[z]=arguments[z];Z.error.apply(Z,Array.from(T))}},Q(_,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return k},set:function(v){if(!(0<=v&&v<=4))throw new Error("Invalid log level");k=v}},{key:"logger",get:function(){return Z},set:function(v){if(!v.debug&&v.info&&(v.debug=v.info),!(v.debug&&v.info&&v.warn&&v.error))throw new Error("Invalid logger");Z=v}}]),_}()).reset()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0});var Q=function(){function _(b,v){for(var T=0;T<v.length;T++){var z=v[T];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(b,z.key,z)}}return function(b,v,T){return v&&_(b.prototype,v),T&&_(b,T),b}}(),x={setInterval:function(_){function b(v,T){return _.apply(this,arguments)}return b.toString=function(){return _.toString()},b}(function(_,b){return setInterval(_,b)}),clearInterval:function(_){function b(v){return _.apply(this,arguments)}return b.toString=function(){return _.toString()},b}(function(_){return clearInterval(_)})},Z=!1,k=null;O.Global=function(){function _(){!function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}(this,_)}return _._testing=function(){Z=!0},_.setXMLHttpRequest=function(v){k=v},Q(_,null,[{key:"location",get:function(){if(!Z)return location}},{key:"localStorage",get:function(){if(!Z&&typeof window<"u")return localStorage}},{key:"sessionStorage",get:function(){if(!Z&&typeof window<"u")return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!Z&&typeof window<"u")return k||XMLHttpRequest}},{key:"timer",get:function(){if(!Z)return x}}]),_}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.MetadataService=void 0;var Q=function(){function b(v,T){for(var z=0;z<T.length;z++){var U=T[z];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(v,U.key,U)}}return function(v,T,z){return T&&b(v.prototype,T),z&&b(v,z),v}}(),x=ne(0),Z=ne(7);function k(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}var _=".well-known/openid-configuration";O.MetadataService=function(){function b(v){var T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.JsonService;if(k(this,b),!v)throw x.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=v,this._jsonService=new T(["application/jwk-set+json"])}return b.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},b.prototype.getMetadata=function(){var T=this;return this._settings.metadata?(x.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(x.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then(function(z){return x.Log.debug("MetadataService.getMetadata: json received"),T._settings.metadata=Object.assign({},T._settings.metadataSeed||{},z),T._settings.metadata})):(x.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},b.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},b.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},b.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},b.prototype.getTokenEndpoint=function(){return this._getMetadataProperty("token_endpoint",!(arguments.length>0&&void 0!==arguments[0])||arguments[0])},b.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},b.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},b.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},b.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},b.prototype._getMetadataProperty=function(T){var z=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return x.Log.debug("MetadataService.getMetadataProperty for: "+T),this.getMetadata().then(function(U){if(x.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===U[T]){if(!0===z)return void x.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+T);throw x.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+T),new Error("Metadata does not contain property "+T)}return U[T]})},b.prototype.getSigningKeys=function(){var T=this;return this._settings.signingKeys?(x.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then(function(z){return x.Log.debug("MetadataService.getSigningKeys: jwks_uri received",z),T._jsonService.getJson(z).then(function(U){if(x.Log.debug("MetadataService.getSigningKeys: key set received",U),!U.keys)throw x.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return T._settings.signingKeys=U.keys,T._settings.signingKeys})})},Q(b,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(_)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=_))),this._metadataUrl}}]),b}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UrlUtility=void 0;var Q=ne(0),x=ne(1);O.UrlUtility=function(){function Z(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Z)}return Z.addQueryParam=function(_,b,v){return _.indexOf("?")<0&&(_+="?"),"?"!==_[_.length-1]&&(_+="&"),_+=encodeURIComponent(b),(_+="=")+encodeURIComponent(v)},Z.parseUrlFragment=function(_){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";"string"!=typeof _&&(_=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:x.Global).location.href);var T=_.lastIndexOf(b);T>=0&&(_=_.substr(T+1)),"?"===b&&(T=_.indexOf("#"))>=0&&(_=_.substr(0,T));for(var z,U={},se=/([^&=]+)=([^&]*)/g,J=0;z=se.exec(_);)if(U[decodeURIComponent(z[1])]=decodeURIComponent(z[2].replace(/\+/g," ")),J++>50)return Q.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",_),{error:"Response exceeded expected number of parameters"};for(var G in U)return U;return{}},Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.JoseUtil=void 0;var k,Q=ne(26),x=(k=ne(33))&&k.__esModule?k:{default:k};O.JoseUtil=(0,x.default)({jws:Q.jws,KeyUtil:Q.KeyUtil,X509:Q.X509,crypto:Q.crypto,hextob64u:Q.hextob64u,b64tohex:Q.b64tohex,AllowedSigningAlgs:Q.AllowedSigningAlgs})},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.OidcClientSettings=void 0;var Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(G){return typeof G}:function(G){return G&&"function"==typeof Symbol&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},x=function(){function G(H,re){for(var me=0;me<re.length;me++){var oe=re[me];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(H,oe.key,oe)}}return function(H,re,me){return re&&G(H.prototype,re),me&&G(H,me),H}}(),Z=ne(0),k=ne(23),_=ne(6),b=ne(24),v=ne(2);function T(G,H){if(!(G instanceof H))throw new TypeError("Cannot call a class as a function")}var z=".well-known/openid-configuration",U="id_token",J="client_secret_post";O.OidcClientSettings=function(){function G(){var H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},re=H.authority,me=H.metadataUrl,oe=H.metadata,le=H.signingKeys,ie=H.metadataSeed,Te=H.client_id,Pe=H.client_secret,Ue=H.response_type,ae=void 0===Ue?U:Ue,Qe=H.scope,Ht=void 0===Qe?"openid":Qe,Ot=H.redirect_uri,zn=H.post_logout_redirect_uri,en=H.client_authentication,It=void 0===en?J:en,dn=H.prompt,Et=H.display,xt=H.max_age,rn=H.ui_locales,$t=H.acr_values,Kn=H.resource,Zn=H.response_mode,Lt=H.filterProtocolClaims,qt=void 0===Lt||Lt,at=H.loadUserInfo,In=void 0===at||at,yr=H.staleStateAge,Wn=void 0===yr?900:yr,te=H.clockSkew,w=void 0===te?300:te,S=H.clockService,ee=void 0===S?new k.ClockService:S,ce=H.userInfoJwtIssuer,fe=void 0===ce?"OP":ce,Ee=H.mergeClaims,ze=void 0!==Ee&&Ee,lt=H.stateStore,jt=void 0===lt?new _.WebStorageStateStore:lt,At=H.ResponseValidatorCtor,hn=void 0===At?b.ResponseValidator:At,Qn=H.MetadataServiceCtor,bn=void 0===Qn?v.MetadataService:Qn,Hr=H.extraQueryParams,it=void 0===Hr?{}:Hr,on=H.extraTokenParams,Ft=void 0===on?{}:on;T(this,G),this._authority=re,this._metadataUrl=me,this._metadata=oe,this._metadataSeed=ie,this._signingKeys=le,this._client_id=Te,this._client_secret=Pe,this._response_type=ae,this._scope=Ht,this._redirect_uri=Ot,this._post_logout_redirect_uri=zn,this._client_authentication=It,this._prompt=dn,this._display=Et,this._max_age=xt,this._ui_locales=rn,this._acr_values=$t,this._resource=Kn,this._response_mode=Zn,this._filterProtocolClaims=!!qt,this._loadUserInfo=!!In,this._staleStateAge=Wn,this._clockSkew=w,this._clockService=ee,this._userInfoJwtIssuer=fe,this._mergeClaims=!!ze,this._stateStore=jt,this._validator=new hn(this),this._metadataService=new bn(this),this._extraQueryParams="object"===(void 0===it?"undefined":Q(it))?it:{},this._extraTokenParams="object"===(void 0===Ft?"undefined":Q(Ft))?Ft:{}}return G.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},x(G,[{key:"client_id",get:function(){return this._client_id},set:function(re){if(this._client_id)throw Z.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=re}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(re){if(this._authority)throw Z.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=re}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(z)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=z)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(re){this._metadata=re}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(re){this._metadataSeed=re}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(re){this._signingKeys=re}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(re){this._extraQueryParams="object"===(void 0===re?"undefined":Q(re))?re:{}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(re){this._extraTokenParams="object"===(void 0===re?"undefined":Q(re))?re:{}}}]),G}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.WebStorageStateStore=void 0;var Q=ne(0),x=ne(1);function Z(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}O.WebStorageStateStore=function(){function k(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=_.prefix,v=void 0===b?"oidc.":b,T=_.store,z=void 0===T?x.Global.localStorage:T;Z(this,k),this._store=z,this._prefix=v}return k.prototype.set=function(b,v){return Q.Log.debug("WebStorageStateStore.set",b),this._store.setItem(b=this._prefix+b,v),Promise.resolve()},k.prototype.get=function(b){Q.Log.debug("WebStorageStateStore.get",b);var v=this._store.getItem(b=this._prefix+b);return Promise.resolve(v)},k.prototype.remove=function(b){Q.Log.debug("WebStorageStateStore.remove",b);var v=this._store.getItem(b=this._prefix+b);return this._store.removeItem(b),Promise.resolve(v)},k.prototype.getAllKeys=function(){Q.Log.debug("WebStorageStateStore.getAllKeys");for(var b=[],v=0;v<this._store.length;v++){var T=this._store.key(v);0===T.indexOf(this._prefix)&&b.push(T.substr(this._prefix.length))}return Promise.resolve(b)},k}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.JsonService=void 0;var Q=ne(0),x=ne(1);function Z(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}O.JsonService=function(){function k(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.Global.XMLHttpRequest,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Z(this,k),this._contentTypes=_&&Array.isArray(_)?_.slice():[],this._contentTypes.push("application/json"),v&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=b,this._jwtHandler=v}return k.prototype.getJson=function(b,v){var T=this;if(!b)throw Q.Log.error("JsonService.getJson: No url passed"),new Error("url");return Q.Log.debug("JsonService.getJson, url: ",b),new Promise(function(z,U){var se=new T._XMLHttpRequest;se.open("GET",b);var J=T._contentTypes,G=T._jwtHandler;se.onload=function(){if(Q.Log.debug("JsonService.getJson: HTTP response received, status",se.status),200===se.status){var H=se.getResponseHeader("Content-Type");if(H){var re=J.find(function(me){if(H.startsWith(me))return!0});if("application/jwt"==re)return void G(se).then(z,U);if(re)try{return void z(JSON.parse(se.responseText))}catch(me){return Q.Log.error("JsonService.getJson: Error parsing JSON response",me.message),void U(me)}}U(Error("Invalid response Content-Type: "+H+", from URL: "+b))}else U(Error(se.statusText+" ("+se.status+")"))},se.onerror=function(){Q.Log.error("JsonService.getJson: network error"),U(Error("Network Error"))},v&&(Q.Log.debug("JsonService.getJson: token passed, setting Authorization header"),se.setRequestHeader("Authorization","Bearer "+v)),se.send()})},k.prototype.postForm=function(b,v,T){var z=this;if(!b)throw Q.Log.error("JsonService.postForm: No url passed"),new Error("url");return Q.Log.debug("JsonService.postForm, url: ",b),new Promise(function(U,se){var J=new z._XMLHttpRequest;J.open("POST",b);var G=z._contentTypes;J.onload=function(){if(Q.Log.debug("JsonService.postForm: HTTP response received, status",J.status),200!==J.status){if(400===J.status&&(le=J.getResponseHeader("Content-Type"))&&G.find(function(ie){if(le.startsWith(ie))return!0}))try{var oe=JSON.parse(J.responseText);if(oe&&oe.error)return Q.Log.error("JsonService.postForm: Error from server: ",oe.error),void se(new Error(oe.error))}catch(ie){return Q.Log.error("JsonService.postForm: Error parsing JSON response",ie.message),void se(ie)}se(Error(J.statusText+" ("+J.status+")"))}else{var le;if((le=J.getResponseHeader("Content-Type"))&&G.find(function(ie){if(le.startsWith(ie))return!0}))try{return void U(JSON.parse(J.responseText))}catch(ie){return Q.Log.error("JsonService.postForm: Error parsing JSON response",ie.message),void se(ie)}se(Error("Invalid response Content-Type: "+le+", from URL: "+b))}},J.onerror=function(){Q.Log.error("JsonService.postForm: network error"),se(Error("Network Error"))};var H="";for(var re in v){var me=v[re];me&&(H.length>0&&(H+="&"),H+=encodeURIComponent(re),H+="=",H+=encodeURIComponent(me))}J.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),void 0!==T&&J.setRequestHeader("Authorization","Basic "+btoa(T)),J.send(H)})},k}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SigninRequest=void 0;var Q=ne(0),x=ne(3),Z=ne(13);O.SigninRequest=function(){function k(_){var b=_.url,v=_.client_id,T=_.redirect_uri,z=_.response_type,U=_.scope,se=_.authority,J=_.data,G=_.prompt,H=_.display,re=_.max_age,me=_.ui_locales,oe=_.id_token_hint,le=_.login_hint,ie=_.acr_values,Te=_.resource,Pe=_.response_mode,Ue=_.request,ae=_.request_uri,Qe=_.extraQueryParams,Ht=_.request_type,Ot=_.client_secret,zn=_.extraTokenParams,en=_.skipUserInfo;if(function(Kn,Zn){if(!(Kn instanceof Zn))throw new TypeError("Cannot call a class as a function")}(this,k),!b)throw Q.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!v)throw Q.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!T)throw Q.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!z)throw Q.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!U)throw Q.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!se)throw Q.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var It=k.isOidc(z),dn=k.isCode(z);Pe||(Pe=k.isCode(z)?"query":null),this.state=new Z.SigninState({nonce:It,data:J,client_id:v,authority:se,redirect_uri:T,code_verifier:dn,request_type:Ht,response_mode:Pe,client_secret:Ot,scope:U,extraTokenParams:zn,skipUserInfo:en}),b=x.UrlUtility.addQueryParam(b,"client_id",v),b=x.UrlUtility.addQueryParam(b,"redirect_uri",T),b=x.UrlUtility.addQueryParam(b,"response_type",z),b=x.UrlUtility.addQueryParam(b,"scope",U),b=x.UrlUtility.addQueryParam(b,"state",this.state.id),It&&(b=x.UrlUtility.addQueryParam(b,"nonce",this.state.nonce)),dn&&(b=x.UrlUtility.addQueryParam(b,"code_challenge",this.state.code_challenge),b=x.UrlUtility.addQueryParam(b,"code_challenge_method","S256"));var Et={prompt:G,display:H,max_age:re,ui_locales:me,id_token_hint:oe,login_hint:le,acr_values:ie,resource:Te,request:Ue,request_uri:ae,response_mode:Pe};for(var xt in Et)Et[xt]&&(b=x.UrlUtility.addQueryParam(b,xt,Et[xt]));for(var rn in Qe)b=x.UrlUtility.addQueryParam(b,rn,Qe[rn]);this.url=b}return k.isOidc=function(b){return!!b.split(/\s+/g).filter(function(v){return"id_token"===v})[0]},k.isOAuth=function(b){return!!b.split(/\s+/g).filter(function(v){return"token"===v})[0]},k.isCode=function(b){return!!b.split(/\s+/g).filter(function(v){return"code"===v})[0]},k}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.State=void 0;var b,Q=function(){function _(b,v){for(var T=0;T<v.length;T++){var z=v[T];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(b,z.key,z)}}return function(b,v,T){return v&&_(b.prototype,v),T&&_(b,T),b}}(),x=ne(0),Z=(b=ne(14))&&b.__esModule?b:{default:b};function k(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}O.State=function(){function _(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},v=b.id,T=b.data,z=b.created,U=b.request_type;k(this,_),this._id=v||(0,Z.default)(),this._data=T,this._created="number"==typeof z&&z>0?z:parseInt(Date.now()/1e3),this._request_type=U}return _.prototype.toStorageString=function(){return x.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},_.fromStorageString=function(v){return x.Log.debug("State.fromStorageString"),new _(JSON.parse(v))},_.clearStaleState=function(v,T){var z=Date.now()/1e3-T;return v.getAllKeys().then(function(U){x.Log.debug("State.clearStaleState: got keys",U);for(var se=[],J=function(me){var oe=U[me];H=v.get(oe).then(function(le){var ie=!1;if(le)try{var Te=_.fromStorageString(le);x.Log.debug("State.clearStaleState: got item from key: ",oe,Te.created),Te.created<=z&&(ie=!0)}catch(Pe){x.Log.error("State.clearStaleState: Error parsing state for key",oe,Pe.message),ie=!0}else x.Log.debug("State.clearStaleState: no item in storage for key: ",oe),ie=!0;if(ie)return x.Log.debug("State.clearStaleState: removed item for key: ",oe),v.remove(oe)}),se.push(H)},G=0;G<U.length;G++){var H;J(G)}return x.Log.debug("State.clearStaleState: waiting on promise count:",se.length),Promise.all(se)})},Q(_,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),_}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.OidcClient=void 0;var Q=function(){function J(G,H){for(var re=0;re<H.length;re++){var me=H[re];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(G,me.key,me)}}return function(G,H,re){return H&&J(G.prototype,H),re&&J(G,re),G}}(),x=ne(0),Z=ne(5),k=ne(12),_=ne(8),b=ne(34),v=ne(35),T=ne(36),z=ne(13),U=ne(9);function se(J,G){if(!(J instanceof G))throw new TypeError("Cannot call a class as a function")}O.OidcClient=function(){function J(){var G=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};se(this,J),this._settings=G instanceof Z.OidcClientSettings?G:new Z.OidcClientSettings(G)}return J.prototype.createSigninRequest=function(){var H=this,re=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},me=re.response_type,oe=re.scope,le=re.redirect_uri,ie=re.data,Te=re.state,Pe=re.prompt,Ue=re.display,ae=re.max_age,Qe=re.ui_locales,Ht=re.id_token_hint,Ot=re.login_hint,zn=re.acr_values,en=re.resource,It=re.request,dn=re.request_uri,Et=re.response_mode,xt=re.extraQueryParams,rn=re.extraTokenParams,$t=re.request_type,Kn=re.skipUserInfo,Zn=arguments[1];x.Log.debug("OidcClient.createSigninRequest");var Lt=this._settings.client_id;oe=oe||this._settings.scope,le=le||this._settings.redirect_uri,Pe=Pe||this._settings.prompt,Ue=Ue||this._settings.display,ae=ae||this._settings.max_age,Qe=Qe||this._settings.ui_locales,zn=zn||this._settings.acr_values,en=en||this._settings.resource,Et=Et||this._settings.response_mode,xt=xt||this._settings.extraQueryParams,rn=rn||this._settings.extraTokenParams;var qt=this._settings.authority;return _.SigninRequest.isCode(me=me||this._settings.response_type)&&"code"!==me?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then(function(at){x.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",at);var In=new _.SigninRequest({url:at,client_id:Lt,redirect_uri:le,response_type:me,scope:oe,data:ie||Te,authority:qt,prompt:Pe,display:Ue,max_age:ae,ui_locales:Qe,id_token_hint:Ht,login_hint:Ot,acr_values:zn,resource:en,request:It,request_uri:dn,extraQueryParams:xt,extraTokenParams:rn,request_type:$t,response_mode:Et,client_secret:H._settings.client_secret,skipUserInfo:Kn}),yr=In.state;return(Zn=Zn||H._stateStore).set(yr.id,yr.toStorageString()).then(function(){return In})})},J.prototype.readSigninResponseState=function(H,re){var me=arguments.length>2&&void 0!==arguments[2]&&arguments[2];x.Log.debug("OidcClient.readSigninResponseState");var oe="query"===this._settings.response_mode||!this._settings.response_mode&&_.SigninRequest.isCode(this._settings.response_type),ie=new b.SigninResponse(H,oe?"?":"#");return ie.state?(re=re||this._stateStore,(me?re.remove.bind(re):re.get.bind(re))(ie.state).then(function(Pe){if(!Pe)throw x.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:z.SigninState.fromStorageString(Pe),response:ie}})):(x.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response")))},J.prototype.processSigninResponse=function(H,re){var me=this;return x.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(H,re,!0).then(function(oe){var le=oe.state,ie=oe.response;return x.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),me._validator.validateSigninResponse(le,ie)})},J.prototype.createSignoutRequest=function(){var H=this,re=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},me=re.id_token_hint,oe=re.data,le=re.state,ie=re.post_logout_redirect_uri,Te=re.extraQueryParams,Pe=re.request_type,Ue=arguments[1];return x.Log.debug("OidcClient.createSignoutRequest"),ie=ie||this._settings.post_logout_redirect_uri,Te=Te||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then(function(ae){if(!ae)throw x.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");x.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",ae);var Qe=new v.SignoutRequest({url:ae,id_token_hint:me,post_logout_redirect_uri:ie,data:oe||le,extraQueryParams:Te,request_type:Pe}),Ht=Qe.state;return Ht&&(x.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(Ue=Ue||H._stateStore).set(Ht.id,Ht.toStorageString())),Qe})},J.prototype.readSignoutResponseState=function(H,re){var me=arguments.length>2&&void 0!==arguments[2]&&arguments[2];x.Log.debug("OidcClient.readSignoutResponseState");var oe=new T.SignoutResponse(H);if(!oe.state)return x.Log.debug("OidcClient.readSignoutResponseState: No state in response"),oe.error?(x.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",oe.error),Promise.reject(new k.ErrorResponse(oe))):Promise.resolve({state:void 0,response:oe});var le=oe.state;return re=re||this._stateStore,(me?re.remove.bind(re):re.get.bind(re))(le).then(function(Te){if(!Te)throw x.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:U.State.fromStorageString(Te),response:oe}})},J.prototype.processSignoutResponse=function(H,re){var me=this;return x.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(H,re,!0).then(function(oe){var le=oe.state,ie=oe.response;return le?(x.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),me._validator.validateSignoutResponse(le,ie)):(x.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),ie)})},J.prototype.clearStaleState=function(H){return x.Log.debug("OidcClient.clearStaleState"),U.State.clearStaleState(H=H||this._stateStore,this.settings.staleStateAge)},Q(J,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),J}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.TokenClient=void 0;var Q=ne(7),x=ne(2),Z=ne(0);function k(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}O.TokenClient=function(){function _(b){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.JsonService,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x.MetadataService;if(k(this,_),!b)throw Z.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=b,this._jsonService=new v,this._metadataService=new T(this._settings)}return _.prototype.exchangeCode=function(){var v=this,T=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(T=Object.assign({},T)).grant_type=T.grant_type||"authorization_code",T.client_id=T.client_id||this._settings.client_id,T.client_secret=T.client_secret||this._settings.client_secret,T.redirect_uri=T.redirect_uri||this._settings.redirect_uri;var z=void 0,U=T._client_authentication||this._settings._client_authentication;return delete T._client_authentication,T.code?T.redirect_uri?T.code_verifier?T.client_id?T.client_secret||"client_secret_basic"!=U?("client_secret_basic"==U&&(z=T.client_id+":"+T.client_secret,delete T.client_id,delete T.client_secret),this._metadataService.getTokenEndpoint(!1).then(function(se){return Z.Log.debug("TokenClient.exchangeCode: Received token endpoint"),v._jsonService.postForm(se,T,z).then(function(J){return Z.Log.debug("TokenClient.exchangeCode: response received"),J})})):(Z.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(Z.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(Z.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(Z.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(Z.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},_.prototype.exchangeRefreshToken=function(){var v=this,T=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(T=Object.assign({},T)).grant_type=T.grant_type||"refresh_token",T.client_id=T.client_id||this._settings.client_id,T.client_secret=T.client_secret||this._settings.client_secret;var z=void 0,U=T._client_authentication||this._settings._client_authentication;return delete T._client_authentication,T.refresh_token?T.client_id?("client_secret_basic"==U&&(z=T.client_id+":"+T.client_secret,delete T.client_id,delete T.client_secret),this._metadataService.getTokenEndpoint(!1).then(function(se){return Z.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),v._jsonService.postForm(se,T,z).then(function(J){return Z.Log.debug("TokenClient.exchangeRefreshToken: response received"),J})})):(Z.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(Z.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},_}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.ErrorResponse=void 0;var Q=ne(0);function x(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}function Z(k,_){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!_||"object"!=typeof _&&"function"!=typeof _?k:_}O.ErrorResponse=function(k){function _(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},v=b.error,T=b.error_description,z=b.error_uri,U=b.state,se=b.session_state;if(x(this,_),!v)throw Q.Log.error("No error passed to ErrorResponse"),new Error("error");var J=Z(this,k.call(this,T||v));return J.name="ErrorResponse",J.error=v,J.error_description=T,J.error_uri=z,J.state=U,J.session_state=se,J}return function(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Super expression must either be null or a function, not "+typeof T);v.prototype=Object.create(T&&T.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(v,T):v.__proto__=T)}(_,k),_}(Error)},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SigninState=void 0;var z,Q=function(){function T(z,U){for(var se=0;se<U.length;se++){var J=U[se];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(z,J.key,J)}}return function(z,U,se){return U&&T(z.prototype,U),se&&T(z,se),z}}(),x=ne(0),Z=ne(9),k=ne(4),_=(z=ne(14))&&z.__esModule?z:{default:z};function b(T,z){if(!(T instanceof z))throw new TypeError("Cannot call a class as a function")}function v(T,z){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!z||"object"!=typeof z&&"function"!=typeof z?T:z}O.SigninState=function(T){function z(){var U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},se=U.nonce,J=U.authority,G=U.client_id,H=U.redirect_uri,re=U.code_verifier,me=U.response_mode,oe=U.client_secret,le=U.scope,ie=U.extraTokenParams,Te=U.skipUserInfo;b(this,z);var Pe=v(this,T.call(this,arguments[0]));if(!0===se?Pe._nonce=(0,_.default)():se&&(Pe._nonce=se),!0===re?Pe._code_verifier=(0,_.default)()+(0,_.default)()+(0,_.default)():re&&(Pe._code_verifier=re),Pe.code_verifier){var Ue=k.JoseUtil.hashString(Pe.code_verifier,"SHA256");Pe._code_challenge=k.JoseUtil.hexToBase64Url(Ue)}return Pe._redirect_uri=H,Pe._authority=J,Pe._client_id=G,Pe._response_mode=me,Pe._client_secret=oe,Pe._scope=le,Pe._extraTokenParams=ie,Pe._skipUserInfo=Te,Pe}return function(se,J){if("function"!=typeof J&&null!==J)throw new TypeError("Super expression must either be null or a function, not "+typeof J);se.prototype=Object.create(J&&J.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),J&&(Object.setPrototypeOf?Object.setPrototypeOf(se,J):se.__proto__=J)}(z,T),z.prototype.toStorageString=function(){return x.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},z.fromStorageString=function(se){return x.Log.debug("SigninState.fromStorageString"),new z(JSON.parse(se))},Q(z,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),z}(Z.State)},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(){return("undefined"!=Q&&null!==Q&&void 0!==Q.getRandomValues?x:Z)().replace(/-/g,"")};var Q=typeof window<"u"?window.crypto||window.msCrypto:null;function x(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(k){return(k^Q.getRandomValues(new Uint8Array(1))[0]&15>>k/4).toString(16)})}function Z(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(k){return(k^16*Math.random()>>k/4).toString(16)})}Ge.exports=O.default},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.User=void 0;var Q=function(){function Z(k,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}return function(k,_,b){return _&&Z(k.prototype,_),b&&Z(k,b),k}}(),x=ne(0);O.User=function(){function Z(k){var _=k.id_token,b=k.session_state,v=k.access_token,T=k.refresh_token,z=k.token_type,U=k.scope,se=k.profile,J=k.expires_at,G=k.state;(function(re,me){if(!(re instanceof me))throw new TypeError("Cannot call a class as a function")})(this,Z),this.id_token=_,this.session_state=b,this.access_token=v,this.refresh_token=T,this.token_type=z,this.scope=U,this.profile=se,this.expires_at=J,this.state=G}return Z.prototype.toStorageString=function(){return x.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},Z.fromStorageString=function(_){return x.Log.debug("User.fromStorageString"),new Z(JSON.parse(_))},Q(Z,[{key:"expires_in",get:function(){if(this.expires_at){var _=parseInt(Date.now()/1e3);return this.expires_at-_}},set:function(_){var b=parseInt(_);if("number"==typeof b&&b>0){var v=parseInt(Date.now()/1e3);this.expires_at=v+b}}},{key:"expired",get:function(){var _=this.expires_in;if(void 0!==_)return _<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.AccessTokenEvents=void 0;var Q=ne(0),x=ne(46);function Z(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}O.AccessTokenEvents=function(){function k(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=_.accessTokenExpiringNotificationTime,v=void 0===b?60:b,T=_.accessTokenExpiringTimer,z=void 0===T?new x.Timer("Access token expiring"):T,U=_.accessTokenExpiredTimer,se=void 0===U?new x.Timer("Access token expired"):U;Z(this,k),this._accessTokenExpiringNotificationTime=v,this._accessTokenExpiring=z,this._accessTokenExpired=se}return k.prototype.load=function(b){if(b.access_token&&void 0!==b.expires_in){var v=b.expires_in;if(Q.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",v),v>0){var T=v-this._accessTokenExpiringNotificationTime;T<=0&&(T=1),Q.Log.debug("AccessTokenEvents.load: registering expiring timer in:",T),this._accessTokenExpiring.init(T)}else Q.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var z=v+1;Q.Log.debug("AccessTokenEvents.load: registering expired timer in:",z),this._accessTokenExpired.init(z)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},k.prototype.unload=function(){Q.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},k.prototype.addAccessTokenExpiring=function(b){this._accessTokenExpiring.addHandler(b)},k.prototype.removeAccessTokenExpiring=function(b){this._accessTokenExpiring.removeHandler(b)},k.prototype.addAccessTokenExpired=function(b){this._accessTokenExpired.addHandler(b)},k.prototype.removeAccessTokenExpired=function(b){this._accessTokenExpired.removeHandler(b)},k}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Event=void 0;var Q=ne(0);O.Event=function(){function x(Z){(function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")})(this,x),this._name=Z,this._callbacks=[]}return x.prototype.addHandler=function(k){this._callbacks.push(k)},x.prototype.removeHandler=function(k){var _=this._callbacks.findIndex(function(b){return b===k});_>=0&&this._callbacks.splice(_,1)},x.prototype.raise=function(){Q.Log.debug("Event: Raising event: "+this._name);for(var k=0;k<this._callbacks.length;k++){var _;(_=this._callbacks)[k].apply(_,arguments)}},x}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SessionMonitor=void 0;var Q=function(){function b(v,T){for(var z=0;z<T.length;z++){var U=T[z];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(v,U.key,U)}}return function(v,T,z){return T&&b(v.prototype,T),z&&b(v,z),v}}(),x=ne(0),Z=ne(19),k=ne(1);function _(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}O.SessionMonitor=function(){function b(v){var T=this,z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.CheckSessionIFrame,U=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k.Global.timer;if(_(this,b),!v)throw x.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=v,this._CheckSessionIFrameCtor=z,this._timer=U,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then(function(se){se?T._start(se):T._settings.monitorAnonymousSession&&T._userManager.querySessionStatus().then(function(J){var G={session_state:J.session_state};J.sub&&J.sid&&(G.profile={sub:J.sub,sid:J.sid}),T._start(G)}).catch(function(J){x.Log.error("SessionMonitor ctor: error from querySessionStatus:",J.message)})}).catch(function(se){x.Log.error("SessionMonitor ctor: error from getUser:",se.message)}))}return b.prototype._start=function(T){var z=this,U=T.session_state;U&&(T.profile?(this._sub=T.profile.sub,this._sid=T.profile.sid,x.Log.debug("SessionMonitor._start: session_state:",U,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,x.Log.debug("SessionMonitor._start: session_state:",U,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(U):this._metadataService.getCheckSessionIframe().then(function(se){if(se){x.Log.debug("SessionMonitor._start: Initializing check session iframe");var J=z._client_id,G=z._checkSessionInterval,H=z._stopCheckSessionOnError;z._checkSessionIFrame=new z._CheckSessionIFrameCtor(z._callback.bind(z),J,se,G,H),z._checkSessionIFrame.load().then(function(){z._checkSessionIFrame.start(U)})}else x.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")}).catch(function(se){x.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",se.message)}))},b.prototype._stop=function(){var T=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(x.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var z=this._timer.setInterval(function(){T._timer.clearInterval(z),T._userManager.querySessionStatus().then(function(U){var se={session_state:U.session_state};U.sub&&U.sid&&(se.profile={sub:U.sub,sid:U.sid}),T._start(se)}).catch(function(U){x.Log.error("SessionMonitor: error from querySessionStatus:",U.message)})},1e3)},b.prototype._callback=function(){var T=this;this._userManager.querySessionStatus().then(function(z){var U=!0;z?z.sub===T._sub?(U=!1,T._checkSessionIFrame.start(z.session_state),z.sid===T._sid?x.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",z.session_state):(x.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",z.session_state),T._userManager.events._raiseUserSessionChanged())):x.Log.debug("SessionMonitor._callback: Different subject signed into OP:",z.sub):x.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),U&&(T._sub?(x.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),T._userManager.events._raiseUserSignedOut()):(x.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),T._userManager.events._raiseUserSignedIn()))}).catch(function(z){T._sub&&(x.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",z.message),T._userManager.events._raiseUserSignedOut())})},Q(b,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),b}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CheckSessionIFrame=void 0;var Q=ne(0);function x(Z,k){if(!(Z instanceof k))throw new TypeError("Cannot call a class as a function")}O.CheckSessionIFrame=function(){function Z(k,_,b,v){var T=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];x(this,Z),this._callback=k,this._client_id=_,this._url=b,this._interval=v||2e3,this._stopOnError=T;var z=b.indexOf("/",b.indexOf("//")+2);this._frame_origin=b.substr(0,z),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=b}return Z.prototype.load=function(){var _=this;return new Promise(function(b){_._frame.onload=function(){b()},window.document.body.appendChild(_._frame),_._boundMessageEvent=_._message.bind(_),window.addEventListener("message",_._boundMessageEvent,!1)})},Z.prototype._message=function(_){_.origin===this._frame_origin&&_.source===this._frame.contentWindow&&("error"===_.data?(Q.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===_.data?(Q.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):Q.Log.debug("CheckSessionIFrame: "+_.data+" message from check session op iframe"))},Z.prototype.start=function(_){var b=this;if(this._session_state!==_){Q.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=_;var v=function(){b._frame.contentWindow.postMessage(b._client_id+" "+b._session_state,b._frame_origin)};v(),this._timer=window.setInterval(v,this._interval)}},Z.prototype.stop=function(){this._session_state=null,this._timer&&(Q.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.TokenRevocationClient=void 0;var Q=ne(0),x=ne(2),Z=ne(1);function k(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}var _="access_token",b="refresh_token";O.TokenRevocationClient=function(){function v(T){var z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.Global.XMLHttpRequest,U=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x.MetadataService;if(k(this,v),!T)throw Q.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=T,this._XMLHttpRequestCtor=z,this._metadataService=new U(this._settings)}return v.prototype.revoke=function(z,U){var se=this,J=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"access_token";if(!z)throw Q.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(J!==_&&J!=b)throw Q.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then(function(G){if(G)return Q.Log.debug("TokenRevocationClient.revoke: Revoking "+J),se._revoke(G,se._settings.client_id,se._settings.client_secret,z,J);if(U)throw Q.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")})},v.prototype._revoke=function(z,U,se,J,G){var H=this;return new Promise(function(re,me){var oe=new H._XMLHttpRequestCtor;oe.open("POST",z),oe.onload=function(){Q.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",oe.status),200===oe.status?re():me(Error(oe.statusText+" ("+oe.status+")"))},oe.onerror=function(){Q.Log.debug("TokenRevocationClient.revoke: Network Error."),me("Network Error")};var le="client_id="+encodeURIComponent(U);se&&(le+="&client_secret="+encodeURIComponent(se)),le+="&token_type_hint="+encodeURIComponent(G),le+="&token="+encodeURIComponent(J),oe.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),oe.send(le)})},v}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CordovaPopupWindow=void 0;var Q=function(){function Z(k,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}return function(k,_,b){return _&&Z(k.prototype,_),b&&Z(k,b),k}}(),x=ne(0);O.CordovaPopupWindow=function(){function Z(k){var _=this;(function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")})(this,Z),this._promise=new Promise(function(b,v){_._resolve=b,_._reject=v}),this.features=k.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=k.popupWindowTarget||"_blank",this.redirect_uri=k.startUrl,x.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return Z.prototype._isInAppBrowserInstalled=function(_){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some(function(b){return _.hasOwnProperty(b)})},Z.prototype.navigate=function(_){if(_&&_.url){if(!window.cordova)return this._error("cordova is undefined");var b=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(b))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(_.url,this.target,this.features),this._popup?(x.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},Z.prototype._loadStartCallback=function(_){0===_.url.indexOf(this.redirect_uri)&&this._success({url:_.url})},Z.prototype._exitCallback=function(_){this._error(_)},Z.prototype._success=function(_){this._cleanup(),x.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(_)},Z.prototype._error=function(_){this._cleanup(),x.Log.error(_),this._reject(new Error(_))},Z.prototype.close=function(){this._cleanup()},Z.prototype._cleanup=function(){this._popup&&(x.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},Q(Z,[{key:"promise",get:function(){return this._promise}}]),Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0});var Q=ne(0),x=ne(10),Z=ne(5),k=ne(6),_=ne(37),b=ne(38),v=ne(16),T=ne(2),z=ne(48),U=ne(49),se=ne(19),J=ne(20),G=ne(18),H=ne(1),re=ne(15),me=ne(50);O.default={Version:me.Version,Log:Q.Log,OidcClient:x.OidcClient,OidcClientSettings:Z.OidcClientSettings,WebStorageStateStore:k.WebStorageStateStore,InMemoryWebStorage:_.InMemoryWebStorage,UserManager:b.UserManager,AccessTokenEvents:v.AccessTokenEvents,MetadataService:T.MetadataService,CordovaPopupNavigator:z.CordovaPopupNavigator,CordovaIFrameNavigator:U.CordovaIFrameNavigator,CheckSessionIFrame:se.CheckSessionIFrame,TokenRevocationClient:J.TokenRevocationClient,SessionMonitor:G.SessionMonitor,Global:H.Global,User:re.User},Ge.exports=O.default},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.ClockService=function(){function Q(){!function(Z,k){if(!(Z instanceof k))throw new TypeError("Cannot call a class as a function")}(this,Q)}return Q.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},Q}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.ResponseValidator=void 0;var Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(U){return typeof U}:function(U){return U&&"function"==typeof Symbol&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U},x=ne(0),Z=ne(2),k=ne(25),_=ne(11),b=ne(12),v=ne(4);function T(U,se){if(!(U instanceof se))throw new TypeError("Cannot call a class as a function")}var z=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];O.ResponseValidator=function(){function U(se){var J=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.MetadataService,G=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k.UserInfoService,H=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v.JoseUtil,re=arguments.length>4&&void 0!==arguments[4]?arguments[4]:_.TokenClient;if(T(this,U),!se)throw x.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=se,this._metadataService=new J(this._settings),this._userInfoService=new G(this._settings),this._joseUtil=H,this._tokenClient=new re(this._settings)}return U.prototype.validateSigninResponse=function(J,G){var H=this;return x.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(J,G).then(function(re){return x.Log.debug("ResponseValidator.validateSigninResponse: state processed"),H._validateTokens(J,re).then(function(me){return x.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),H._processClaims(J,me).then(function(oe){return x.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),oe})})})},U.prototype.validateSignoutResponse=function(J,G){return J.id!==G.state?(x.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(x.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),G.state=J.data,G.error?(x.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",G.error),Promise.reject(new b.ErrorResponse(G))):Promise.resolve(G))},U.prototype._processSigninParams=function(J,G){if(J.id!==G.state)return x.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!J.client_id)return x.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!J.authority)return x.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==J.authority)return x.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=J.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==J.client_id)return x.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=J.client_id;return x.Log.debug("ResponseValidator._processSigninParams: state validated"),G.state=J.data,G.error?(x.Log.warn("ResponseValidator._processSigninParams: Response was error",G.error),Promise.reject(new b.ErrorResponse(G))):J.nonce&&!G.id_token?(x.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!J.nonce&&G.id_token?(x.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):J.code_verifier&&!G.code?(x.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!J.code_verifier&&G.code?(x.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(G.scope||(G.scope=J.scope),Promise.resolve(G))},U.prototype._processClaims=function(J,G){var H=this;if(G.isOpenIdConnect){if(x.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),G.profile=this._filterProtocolClaims(G.profile),!0!==J.skipUserInfo&&this._settings.loadUserInfo&&G.access_token)return x.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(G.access_token).then(function(re){return x.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),re.sub!==G.profile.sub?(x.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(G.profile=H._mergeClaims(G.profile,re),x.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",G.profile),G)});x.Log.debug("ResponseValidator._processClaims: not loading user info")}else x.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(G)},U.prototype._mergeClaims=function(J,G){var H=Object.assign({},J);for(var re in G){var me=G[re];Array.isArray(me)||(me=[me]);for(var oe=0;oe<me.length;oe++){var le=me[oe];H[re]?Array.isArray(H[re])?H[re].indexOf(le)<0&&H[re].push(le):H[re]!==le&&(H[re]="object"===(void 0===le?"undefined":Q(le))&&this._settings.mergeClaims?this._mergeClaims(H[re],le):[H[re],le]):H[re]=le}}return H},U.prototype._filterProtocolClaims=function(J){x.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",J);var G=Object.assign({},J);return this._settings._filterProtocolClaims?(z.forEach(function(H){delete G[H]}),x.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",G)):x.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),G},U.prototype._validateTokens=function(J,G){return G.code?(x.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(J,G)):G.id_token?G.access_token?(x.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(J,G)):(x.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(J,G)):(x.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(G))},U.prototype._processCode=function(J,G){var H=this,re={client_id:J.client_id,client_secret:J.client_secret,code:G.code,redirect_uri:J.redirect_uri,code_verifier:J.code_verifier};return J.extraTokenParams&&"object"===Q(J.extraTokenParams)&&Object.assign(re,J.extraTokenParams),this._tokenClient.exchangeCode(re).then(function(me){for(var oe in me)G[oe]=me[oe];return G.id_token?(x.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),H._validateIdTokenAttributes(J,G)):(x.Log.debug("ResponseValidator._processCode: token response successful, returning response"),G)})},U.prototype._validateIdTokenAttributes=function(J,G){var H=this;return this._metadataService.getIssuer().then(function(re){var me=J.client_id,oe=H._settings.clockSkew;return x.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",oe),H._settings.getEpochTime().then(function(le){return H._joseUtil.validateJwtAttributes(G.id_token,re,me,oe,le).then(function(ie){return J.nonce&&J.nonce!==ie.nonce?(x.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):ie.sub?(G.profile=ie,G):(x.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})})},U.prototype._validateIdTokenAndAccessToken=function(J,G){var H=this;return this._validateIdToken(J,G).then(function(re){return H._validateAccessToken(re)})},U.prototype._getSigningKeyForJwt=function(J){var G=this;return this._metadataService.getSigningKeys().then(function(H){var re=J.header.kid;if(!H)return x.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));x.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var me=void 0;if(re)me=H.filter(function(oe){return oe.kid===re})[0];else{if((H=G._filterByAlg(H,J.header.alg)).length>1)return x.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));me=H[0]}return Promise.resolve(me)})},U.prototype._getSigningKeyForJwtWithSingleRetry=function(J){var G=this;return this._getSigningKeyForJwt(J).then(function(H){return H?Promise.resolve(H):(G._metadataService.resetSigningKeys(),G._getSigningKeyForJwt(J))})},U.prototype._validateIdToken=function(J,G){var H=this;if(!J.nonce)return x.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var re=this._joseUtil.parseJwt(G.id_token);return re&&re.header&&re.payload?J.nonce!==re.payload.nonce?(x.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then(function(me){return x.Log.debug("ResponseValidator._validateIdToken: Received issuer"),H._getSigningKeyForJwtWithSingleRetry(re).then(function(oe){if(!oe)return x.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var le=J.client_id,ie=H._settings.clockSkew;return x.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",ie),H._joseUtil.validateJwt(G.id_token,oe,me,le,ie).then(function(){return x.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),re.payload.sub?(G.profile=re.payload,G):(x.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})}):(x.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",re),Promise.reject(new Error("Failed to parse id_token")))},U.prototype._filterByAlg=function(J,G){var H=null;if(G.startsWith("RS"))H="RSA";else if(G.startsWith("PS"))H="PS";else{if(!G.startsWith("ES"))return x.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",G),[];H="EC"}return x.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",H),J=J.filter(function(re){return re.kty===H}),x.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",H,J.length),J},U.prototype._validateAccessToken=function(J){if(!J.profile)return x.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!J.profile.at_hash)return x.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!J.id_token)return x.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var G=this._joseUtil.parseJwt(J.id_token);if(!G||!G.header)return x.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",G),Promise.reject(new Error("Failed to parse id_token"));var H=G.header.alg;if(!H||5!==H.length)return x.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",H),Promise.reject(new Error("Unsupported alg: "+H));var re=H.substr(2,3);if(!re)return x.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",H,re),Promise.reject(new Error("Unsupported alg: "+H));if(256!==(re=parseInt(re))&&384!==re&&512!==re)return x.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",H,re),Promise.reject(new Error("Unsupported alg: "+H));var me="sha"+re,oe=this._joseUtil.hashString(J.access_token,me);if(!oe)return x.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",me),Promise.reject(new Error("Failed to validate at_hash"));var le=oe.substr(0,oe.length/2),ie=this._joseUtil.hexToBase64Url(le);return ie!==J.profile.at_hash?(x.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",ie,J.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(x.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(J))},U}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserInfoService=void 0;var Q=ne(7),x=ne(2),Z=ne(0),k=ne(4);function _(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}O.UserInfoService=function(){function b(v){var T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.JsonService,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x.MetadataService,U=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k.JoseUtil;if(_(this,b),!v)throw Z.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=v,this._jsonService=new T(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new z(this._settings),this._joseUtil=U}return b.prototype.getClaims=function(T){var z=this;return T?this._metadataService.getUserInfoEndpoint().then(function(U){return Z.Log.debug("UserInfoService.getClaims: received userinfo url",U),z._jsonService.getJson(U,T).then(function(se){return Z.Log.debug("UserInfoService.getClaims: claims received",se),se})}):(Z.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},b.prototype._getClaimsFromJwt=function(T){var z=this;try{var U=this._joseUtil.parseJwt(T.responseText);if(!U||!U.header||!U.payload)return Z.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",U),Promise.reject(new Error("Failed to parse id_token"));var se=U.header.kid,J=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":J=this._metadataService.getIssuer();break;case"ANY":J=Promise.resolve(U.payload.iss);break;default:J=Promise.resolve(this._settings.userInfoJwtIssuer)}return J.then(function(G){return Z.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+G),z._metadataService.getSigningKeys().then(function(H){if(!H)return Z.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));Z.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var re=void 0;if(se)re=H.filter(function(le){return le.kid===se})[0];else{if((H=z._filterByAlg(H,U.header.alg)).length>1)return Z.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));re=H[0]}if(!re)return Z.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var me=z._settings.client_id,oe=z._settings.clockSkew;return Z.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",oe),z._joseUtil.validateJwt(T.responseText,re,G,me,oe,void 0,!0).then(function(){return Z.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),U.payload})})})}catch(G){return Z.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",G.message),void reject(G)}},b.prototype._filterByAlg=function(T,z){var U=null;if(z.startsWith("RS"))U="RSA";else if(z.startsWith("PS"))U="PS";else{if(!z.startsWith("ES"))return Z.Log.debug("UserInfoService._filterByAlg: alg not supported: ",z),[];U="EC"}return Z.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",U),T=T.filter(function(se){return se.kty===U}),Z.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",U,T.length),T},b}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.AllowedSigningAlgs=O.b64tohex=O.hextob64u=O.crypto=O.X509=O.KeyUtil=O.jws=void 0;var Q=ne(27);O.jws=Q.jws,O.KeyUtil=Q.KEYUTIL,O.X509=Q.X509,O.crypto=Q.crypto,O.hextob64u=Q.hextob64u,O.b64tohex=Q.b64tohex,O.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(Ge,O,ne){"use strict";(function(Q){Object.defineProperty(O,"__esModule",{value:!0});var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Z={userAgent:!1},k={};if(void 0===_)var _={};_.lang={extend:function(u,d,f){if(!d||!u)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var p=function(){};if(p.prototype=d.prototype,u.prototype=new p,u.prototype.constructor=u,u.superclass=d.prototype,d.prototype.constructor==Object.prototype.constructor&&(d.prototype.constructor=d),f){var y;for(y in f)u.prototype[y]=f[y];var A=function(){},B=["toString","valueOf"];try{/MSIE/.test(Z.userAgent)&&(A=function(L,M){for(y=0;y<B.length;y+=1){var N=B[y],X=M[N];"function"==typeof X&&X!=Object.prototype[N]&&(L[N]=X)}})}catch{}A(u.prototype,f)}}};var b,v,T,z,U,se,J,G,H,re,me,u,d,f,p,oe=oe||(b=Math,T=(v={}).lib={},z=T.Base=function(){function c(){}return{extend:function(d){c.prototype=this;var f=new c;return d&&f.mixIn(d),f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var d=this.extend();return d.init.apply(d,arguments),d},init:function(){},mixIn:function(d){for(var f in d)d.hasOwnProperty(f)&&(this[f]=d[f]);d.hasOwnProperty("toString")&&(this.toString=d.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),U=T.WordArray=z.extend({init:function(u,d){u=this.words=u||[],this.sigBytes=d??4*u.length},toString:function(u){return(u||J).stringify(this)},concat:function(u){var d=this.words,f=u.words,p=this.sigBytes,y=u.sigBytes;if(this.clamp(),p%4)for(var A=0;A<y;A++)d[p+A>>>2]|=(f[A>>>2]>>>24-A%4*8&255)<<24-(p+A)%4*8;else for(A=0;A<y;A+=4)d[p+A>>>2]=f[A>>>2];return this.sigBytes+=y,this},clamp:function(){var u=this.words,d=this.sigBytes;u[d>>>2]&=4294967295<<32-d%4*8,u.length=b.ceil(d/4)},clone:function(){var u=z.clone.call(this);return u.words=this.words.slice(0),u},random:function(u){for(var d=[],f=0;f<u;f+=4)d.push(4294967296*b.random()|0);return new U.init(d,u)}}),se=v.enc={},J=se.Hex={stringify:function(u){for(var d=u.words,f=u.sigBytes,p=[],y=0;y<f;y++){var A=d[y>>>2]>>>24-y%4*8&255;p.push((A>>>4).toString(16)),p.push((15&A).toString(16))}return p.join("")},parse:function(u){for(var d=u.length,f=[],p=0;p<d;p+=2)f[p>>>3]|=parseInt(u.substr(p,2),16)<<24-p%8*4;return new U.init(f,d/2)}},G=se.Latin1={stringify:function(u){for(var d=u.words,f=u.sigBytes,p=[],y=0;y<f;y++)p.push(String.fromCharCode(d[y>>>2]>>>24-y%4*8&255));return p.join("")},parse:function(u){for(var d=u.length,f=[],p=0;p<d;p++)f[p>>>2]|=(255&u.charCodeAt(p))<<24-p%4*8;return new U.init(f,d)}},H=se.Utf8={stringify:function(u){try{return decodeURIComponent(escape(G.stringify(u)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(u){return G.parse(unescape(encodeURIComponent(u)))}},re=T.BufferedBlockAlgorithm=z.extend({reset:function(){this._data=new U.init,this._nDataBytes=0},_append:function(u){"string"==typeof u&&(u=H.parse(u)),this._data.concat(u),this._nDataBytes+=u.sigBytes},_process:function(u){var d=this._data,f=d.words,p=d.sigBytes,y=this.blockSize,A=p/(4*y),B=(A=u?b.ceil(A):b.max((0|A)-this._minBufferSize,0))*y,E=b.min(4*B,p);if(B){for(var L=0;L<B;L+=y)this._doProcessBlock(f,L);var M=f.splice(0,B);d.sigBytes-=E}return new U.init(M,E)},clone:function(){var u=z.clone.call(this);return u._data=this._data.clone(),u},_minBufferSize:0}),T.Hasher=re.extend({cfg:z.extend(),init:function(u){this.cfg=this.cfg.extend(u),this.reset()},reset:function(){re.reset.call(this),this._doReset()},update:function(u){return this._append(u),this._process(),this},finalize:function(u){return u&&this._append(u),this._doFinalize()},blockSize:16,_createHelper:function(u){return function(d,f){return new u.init(f).finalize(d)}},_createHmacHelper:function(u){return function(d,f){return new me.HMAC.init(u,f).finalize(d)}}}),me=v.algo={},v);d=(u=oe).lib,f=d.Base,p=d.WordArray,(u=u.x64={}).Word=f.extend({init:function(A,B){this.high=A,this.low=B}}),u.WordArray=f.extend({init:function(A,B){A=this.words=A||[],this.sigBytes=B??8*A.length},toX32:function(){for(var A=this.words,B=A.length,E=[],L=0;L<B;L++){var M=A[L];E.push(M.high),E.push(M.low)}return p.create(E,this.sigBytes)},clone:function(){for(var A=f.clone.call(this),B=A.words=this.words.slice(0),E=B.length,L=0;L<E;L++)B[L]=B[L].clone();return A}}),function(){var u=oe.lib.WordArray;oe.enc.Base64={stringify:function(f){var p=f.words,y=f.sigBytes,A=this._map;f.clamp(),f=[];for(var B=0;B<y;B+=3)for(var E=(p[B>>>2]>>>24-B%4*8&255)<<16|(p[B+1>>>2]>>>24-(B+1)%4*8&255)<<8|p[B+2>>>2]>>>24-(B+2)%4*8&255,L=0;4>L&&B+.75*L<y;L++)f.push(A.charAt(E>>>6*(3-L)&63));if(p=A.charAt(64))for(;f.length%4;)f.push(p);return f.join("")},parse:function(f){var p=f.length,y=this._map;(A=y.charAt(64))&&-1!=(A=f.indexOf(A))&&(p=A);for(var A=[],B=0,E=0;E<p;E++)if(E%4){var L=y.indexOf(f.charAt(E-1))<<E%4*2,M=y.indexOf(f.charAt(E))>>>6-E%4*2;A[B>>>2]|=(L|M)<<24-B%4*8,B++}return u.create(A,B)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(c){for(var u=oe,d=(p=u.lib).WordArray,f=p.Hasher,p=u.algo,y=[],A=[],B=function(_e){return 4294967296*(_e-(0|_e))|0},E=2,L=0;64>L;){var M;e:{for(var N=c.sqrt(M=E),X=2;X<=N;X++)if(!(M%X)){M=!1;break e}M=!0}M&&(8>L&&(y[L]=B(c.pow(E,.5))),A[L]=B(c.pow(E,1/3)),L++),E++}var ue=[];p=p.SHA256=f.extend({_doReset:function(){this._hash=new d.init(y.slice(0))},_doProcessBlock:function(_e,ve){for(var I=this._hash.words,$=I[0],Y=I[1],W=I[2],ye=I[3],we=I[4],Ke=I[5],ke=I[6],_t=I[7],qe=0;64>qe;qe++){if(16>qe)ue[qe]=0|_e[ve+qe];else{var et=ue[qe-15],Xt=ue[qe-2];ue[qe]=((et<<25|et>>>7)^(et<<14|et>>>18)^et>>>3)+ue[qe-7]+((Xt<<15|Xt>>>17)^(Xt<<13|Xt>>>19)^Xt>>>10)+ue[qe-16]}et=_t+((we<<26|we>>>6)^(we<<21|we>>>11)^(we<<7|we>>>25))+(we&Ke^~we&ke)+A[qe]+ue[qe],Xt=(($<<30|$>>>2)^($<<19|$>>>13)^($<<10|$>>>22))+($&Y^$&W^Y&W),_t=ke,ke=Ke,Ke=we,we=ye+et|0,ye=W,W=Y,Y=$,$=et+Xt|0}I[0]=I[0]+$|0,I[1]=I[1]+Y|0,I[2]=I[2]+W|0,I[3]=I[3]+ye|0,I[4]=I[4]+we|0,I[5]=I[5]+Ke|0,I[6]=I[6]+ke|0,I[7]=I[7]+_t|0},_doFinalize:function(){var _e=this._data,ve=_e.words,I=8*this._nDataBytes,$=8*_e.sigBytes;return ve[$>>>5]|=128<<24-$%32,ve[14+($+64>>>9<<4)]=c.floor(I/4294967296),ve[15+($+64>>>9<<4)]=I,_e.sigBytes=4*ve.length,this._process(),this._hash},clone:function(){var _e=f.clone.call(this);return _e._hash=this._hash.clone(),_e}}),u.SHA256=f._createHelper(p),u.HmacSHA256=f._createHmacHelper(p)}(Math),function(){function c(){return f.create.apply(f,arguments)}for(var u=oe,d=u.lib.Hasher,f=(y=u.x64).Word,p=y.WordArray,y=u.algo,A=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],B=[],E=0;80>E;E++)B[E]=c();y=y.SHA512=d.extend({_doReset:function(){this._hash=new p.init([new f.init(1779033703,4089235720),new f.init(3144134277,2227873595),new f.init(1013904242,4271175723),new f.init(2773480762,1595750129),new f.init(1359893119,2917565137),new f.init(2600822924,725511199),new f.init(528734635,4215389547),new f.init(1541459225,327033209)])},_doProcessBlock:function(M,N){for(var X=(Y=this._hash.words)[0],ue=Y[1],pe=Y[2],_e=Y[3],ve=Y[4],I=Y[5],$=Y[6],Y=Y[7],W=X.high,ye=X.low,we=ue.high,Ke=ue.low,ke=pe.high,_t=pe.low,qe=_e.high,et=_e.low,Xt=ve.high,St=ve.low,nt=I.high,_r=I.low,Xn=$.high,ir=$.low,Ve=Y.high,Pn=Y.low,Bt=W,kn=ye,ps=we,co=Ke,gs=ke,Lo=_t,ea=qe,zi=et,br=Xt,wr=St,ta=nt,rt=_r,jo=Xn,ms=ir,or=Ve,Bo=Pn,li=0;80>li;li++){var sr=B[li];if(16>li)var Fn=sr.high=0|M[N+2*li],sn=sr.low=0|M[N+2*li+1];else{Fn=((sn=(Fn=B[li-15]).high)>>>1|(Ki=Fn.low)<<31)^(sn>>>8|Ki<<24)^sn>>>7;var Ki=(Ki>>>1|sn<<31)^(Ki>>>8|sn<<24)^(Ki>>>7|sn<<25),er=((sn=(er=B[li-2]).high)>>>19|(ht=er.low)<<13)^(sn<<3|ht>>>29)^sn>>>6,ht=(ht>>>19|sn<<13)^(ht<<3|sn>>>29)^(ht>>>6|sn<<26),al=(sn=B[li-7]).high,Vo=(Pr=B[li-16]).high,Pr=Pr.low;Fn=(Fn=(Fn=Fn+al+((sn=Ki+sn.low)>>>0<Ki>>>0?1:0))+er+((sn+=ht)>>>0<ht>>>0?1:0))+Vo+((sn+=Pr)>>>0<Pr>>>0?1:0),sr.high=Fn,sr.low=sn}al=br&ta^~br&jo,Pr=wr&rt^~wr&ms,sr=Bt&ps^Bt&gs^ps&gs;var Nt=kn&co^kn&Lo^co&Lo,na=(Ki=(Bt>>>28|kn<<4)^(Bt<<30|kn>>>2)^(Bt<<25|kn>>>7),er=(kn>>>28|Bt<<4)^(kn<<30|Bt>>>2)^(kn<<25|Bt>>>7),(ht=A[li]).high),ra=ht.low;Vo=or+((br>>>14|wr<<18)^(br>>>18|wr<<14)^(br<<23|wr>>>9))+((ht=Bo+((wr>>>14|br<<18)^(wr>>>18|br<<14)^(wr<<23|br>>>9)))>>>0<Bo>>>0?1:0),or=jo,Bo=ms,jo=ta,ms=rt,ta=br,rt=wr,br=ea+(Vo=(Vo=(Vo=Vo+al+((ht+=Pr)>>>0<Pr>>>0?1:0))+na+((ht+=ra)>>>0<ra>>>0?1:0))+Fn+((ht+=sn)>>>0<sn>>>0?1:0))+((wr=zi+ht|0)>>>0<zi>>>0?1:0)|0,ea=gs,zi=Lo,gs=ps,Lo=co,ps=Bt,co=kn,Bt=Vo+(sr=Ki+sr+((sn=er+Nt)>>>0<er>>>0?1:0))+((kn=ht+sn|0)>>>0<ht>>>0?1:0)|0}ye=X.low=ye+kn,X.high=W+Bt+(ye>>>0<kn>>>0?1:0),Ke=ue.low=Ke+co,ue.high=we+ps+(Ke>>>0<co>>>0?1:0),_t=pe.low=_t+Lo,pe.high=ke+gs+(_t>>>0<Lo>>>0?1:0),et=_e.low=et+zi,_e.high=qe+ea+(et>>>0<zi>>>0?1:0),St=ve.low=St+wr,ve.high=Xt+br+(St>>>0<wr>>>0?1:0),_r=I.low=_r+rt,I.high=nt+ta+(_r>>>0<rt>>>0?1:0),ir=$.low=ir+ms,$.high=Xn+jo+(ir>>>0<ms>>>0?1:0),Pn=Y.low=Pn+Bo,Y.high=Ve+or+(Pn>>>0<Bo>>>0?1:0)},_doFinalize:function(){var M=this._data,N=M.words,X=8*this._nDataBytes,ue=8*M.sigBytes;return N[ue>>>5]|=128<<24-ue%32,N[30+(ue+128>>>10<<5)]=Math.floor(X/4294967296),N[31+(ue+128>>>10<<5)]=X,M.sigBytes=4*N.length,this._process(),this._hash.toX32()},clone:function(){var M=d.clone.call(this);return M._hash=this._hash.clone(),M},blockSize:32}),u.SHA512=d._createHelper(y),u.HmacSHA512=d._createHmacHelper(y)}(),function(){var c=oe,u=(p=c.x64).Word,d=p.WordArray,f=(p=c.algo).SHA512,p=p.SHA384=f.extend({_doReset:function(){this._hash=new d.init([new u.init(3418070365,3238371032),new u.init(1654270250,914150663),new u.init(2438529370,812702999),new u.init(355462360,4144912697),new u.init(1731405415,4290775857),new u.init(2394180231,1750603025),new u.init(3675008525,1694076839),new u.init(1203062813,3204075428)])},_doFinalize:function(){var A=f._doFinalize.call(this);return A.sigBytes-=16,A}});c.SHA384=f._createHelper(p),c.HmacSHA384=f._createHmacHelper(p)}();var le,ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Te(c){var u,d,f="";for(u=0;u+3<=c.length;u+=3)d=parseInt(c.substring(u,u+3),16),f+=ie.charAt(d>>6)+ie.charAt(63&d);for(u+1==c.length?(d=parseInt(c.substring(u,u+1),16),f+=ie.charAt(d<<2)):u+2==c.length&&(d=parseInt(c.substring(u,u+2),16),f+=ie.charAt(d>>2)+ie.charAt((3&d)<<4));(3&f.length)>0;)f+="=";return f}function Pe(c){var u,d,f,p="",y=0;for(u=0;u<c.length&&"="!=c.charAt(u);++u)(f=ie.indexOf(c.charAt(u)))<0||(0==y?(p+=en(f>>2),d=3&f,y=1):1==y?(p+=en(d<<2|f>>4),d=15&f,y=2):2==y?(p+=en(d),p+=en(f>>2),d=3&f,y=3):(p+=en(d<<2|f>>4),p+=en(15&f),y=0));return 1==y&&(p+=en(d<<2)),p}function Ue(c){var u,d=Pe(c),f=new Array;for(u=0;2*u<d.length;++u)f[u]=parseInt(d.substring(2*u,2*u+2),16);return f}function ae(c,u,d){null!=c&&("number"==typeof c?this.fromNumber(c,u,d):this.fromString(c,null==u&&"string"!=typeof c?256:u))}function Qe(){return new ae(null)}"Microsoft Internet Explorer"==Z.appName?(ae.prototype.am=function(u,d,f,p,y,A){for(var B=32767&d,E=d>>15;--A>=0;){var L=32767&this[u],M=this[u++]>>15,N=E*L+M*B;y=((L=B*L+((32767&N)<<15)+f[p]+(1073741823&y))>>>30)+(N>>>15)+E*M+(y>>>30),f[p++]=1073741823&L}return y},le=30):"Netscape"!=Z.appName?(ae.prototype.am=function(u,d,f,p,y,A){for(;--A>=0;){var B=d*this[u++]+f[p]+y;y=Math.floor(B/67108864),f[p++]=67108863&B}return y},le=26):(ae.prototype.am=function(u,d,f,p,y,A){for(var B=16383&d,E=d>>14;--A>=0;){var L=16383&this[u],M=this[u++]>>14,N=E*L+M*B;y=((L=B*L+((16383&N)<<14)+f[p]+y)>>28)+(N>>14)+E*M,f[p++]=268435455&L}return y},le=28),ae.prototype.DB=le,ae.prototype.DM=(1<<le)-1,ae.prototype.DV=1<<le,ae.prototype.FV=Math.pow(2,52),ae.prototype.F1=52-le,ae.prototype.F2=2*le-52;var Ht,Ot,zn=new Array;for(Ht="0".charCodeAt(0),Ot=0;Ot<=9;++Ot)zn[Ht++]=Ot;for(Ht="a".charCodeAt(0),Ot=10;Ot<36;++Ot)zn[Ht++]=Ot;for(Ht="A".charCodeAt(0),Ot=10;Ot<36;++Ot)zn[Ht++]=Ot;function en(c){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(c)}function It(c,u){return zn[c.charCodeAt(u)]??-1}function dn(c){var u=Qe();return u.fromInt(c),u}function Et(c){var u,d=1;return 0!=(u=c>>>16)&&(c=u,d+=16),0!=(u=c>>8)&&(c=u,d+=8),0!=(u=c>>4)&&(c=u,d+=4),0!=(u=c>>2)&&(c=u,d+=2),0!=(u=c>>1)&&(c=u,d+=1),d}function xt(c){this.m=c}function rn(c){this.m=c,this.mp=c.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<c.DB-15)-1,this.mt2=2*c.t}function $t(c,u){return c&u}function Kn(c,u){return c|u}function Zn(c,u){return c^u}function Lt(c,u){return c&~u}function qt(c){if(0==c)return-1;var u=0;return 0==(65535&c)&&(c>>=16,u+=16),0==(255&c)&&(c>>=8,u+=8),0==(15&c)&&(c>>=4,u+=4),0==(3&c)&&(c>>=2,u+=2),0==(1&c)&&++u,u}function at(c){for(var u=0;0!=c;)c&=c-1,++u;return u}function In(){}function yr(c){return c}function Wn(c){this.r2=Qe(),this.q3=Qe(),ae.ONE.dlShiftTo(2*c.t,this.r2),this.mu=this.r2.divide(c),this.m=c}xt.prototype.convert=function(u){return u.s<0||u.compareTo(this.m)>=0?u.mod(this.m):u},xt.prototype.revert=function(u){return u},xt.prototype.reduce=function(u){u.divRemTo(this.m,null,u)},xt.prototype.mulTo=function(u,d,f){u.multiplyTo(d,f),this.reduce(f)},xt.prototype.sqrTo=function(u,d){u.squareTo(d),this.reduce(d)},rn.prototype.convert=function(u){var d=Qe();return u.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),u.s<0&&d.compareTo(ae.ZERO)>0&&this.m.subTo(d,d),d},rn.prototype.revert=function(u){var d=Qe();return u.copyTo(d),this.reduce(d),d},rn.prototype.reduce=function(u){for(;u.t<=this.mt2;)u[u.t++]=0;for(var d=0;d<this.m.t;++d){var f=32767&u[d],p=f*this.mpl+((f*this.mph+(u[d]>>15)*this.mpl&this.um)<<15)&u.DM;for(u[f=d+this.m.t]+=this.m.am(0,p,u,d,0,this.m.t);u[f]>=u.DV;)u[f]-=u.DV,u[++f]++}u.clamp(),u.drShiftTo(this.m.t,u),u.compareTo(this.m)>=0&&u.subTo(this.m,u)},rn.prototype.mulTo=function(u,d,f){u.multiplyTo(d,f),this.reduce(f)},rn.prototype.sqrTo=function(u,d){u.squareTo(d),this.reduce(d)},ae.prototype.copyTo=function(u){for(var d=this.t-1;d>=0;--d)u[d]=this[d];u.t=this.t,u.s=this.s},ae.prototype.fromInt=function(u){this.t=1,this.s=u<0?-1:0,u>0?this[0]=u:u<-1?this[0]=u+this.DV:this.t=0},ae.prototype.fromString=function(u,d){var f;if(16==d)f=4;else if(8==d)f=3;else if(256==d)f=8;else if(2==d)f=1;else if(32==d)f=5;else{if(4!=d)return void this.fromRadix(u,d);f=2}this.t=0,this.s=0;for(var p=u.length,y=!1,A=0;--p>=0;){var B=8==f?255&u[p]:It(u,p);B<0?"-"==u.charAt(p)&&(y=!0):(y=!1,0==A?this[this.t++]=B:A+f>this.DB?(this[this.t-1]|=(B&(1<<this.DB-A)-1)<<A,this[this.t++]=B>>this.DB-A):this[this.t-1]|=B<<A,(A+=f)>=this.DB&&(A-=this.DB))}8==f&&0!=(128&u[0])&&(this.s=-1,A>0&&(this[this.t-1]|=(1<<this.DB-A)-1<<A)),this.clamp(),y&&ae.ZERO.subTo(this,this)},ae.prototype.clamp=function(){for(var u=this.s&this.DM;this.t>0&&this[this.t-1]==u;)--this.t},ae.prototype.dlShiftTo=function(u,d){var f;for(f=this.t-1;f>=0;--f)d[f+u]=this[f];for(f=u-1;f>=0;--f)d[f]=0;d.t=this.t+u,d.s=this.s},ae.prototype.drShiftTo=function(u,d){for(var f=u;f<this.t;++f)d[f-u]=this[f];d.t=Math.max(this.t-u,0),d.s=this.s},ae.prototype.lShiftTo=function(u,d){var f,p=u%this.DB,y=this.DB-p,A=(1<<y)-1,B=Math.floor(u/this.DB),E=this.s<<p&this.DM;for(f=this.t-1;f>=0;--f)d[f+B+1]=this[f]>>y|E,E=(this[f]&A)<<p;for(f=B-1;f>=0;--f)d[f]=0;d[B]=E,d.t=this.t+B+1,d.s=this.s,d.clamp()},ae.prototype.rShiftTo=function(u,d){d.s=this.s;var f=Math.floor(u/this.DB);if(f>=this.t)d.t=0;else{var p=u%this.DB,y=this.DB-p,A=(1<<p)-1;d[0]=this[f]>>p;for(var B=f+1;B<this.t;++B)d[B-f-1]|=(this[B]&A)<<y,d[B-f]=this[B]>>p;p>0&&(d[this.t-f-1]|=(this.s&A)<<y),d.t=this.t-f,d.clamp()}},ae.prototype.subTo=function(u,d){for(var f=0,p=0,y=Math.min(u.t,this.t);f<y;)p+=this[f]-u[f],d[f++]=p&this.DM,p>>=this.DB;if(u.t<this.t){for(p-=u.s;f<this.t;)p+=this[f],d[f++]=p&this.DM,p>>=this.DB;p+=this.s}else{for(p+=this.s;f<u.t;)p-=u[f],d[f++]=p&this.DM,p>>=this.DB;p-=u.s}d.s=p<0?-1:0,p<-1?d[f++]=this.DV+p:p>0&&(d[f++]=p),d.t=f,d.clamp()},ae.prototype.multiplyTo=function(u,d){var f=this.abs(),p=u.abs(),y=f.t;for(d.t=y+p.t;--y>=0;)d[y]=0;for(y=0;y<p.t;++y)d[y+f.t]=f.am(0,p[y],d,y,0,f.t);d.s=0,d.clamp(),this.s!=u.s&&ae.ZERO.subTo(d,d)},ae.prototype.squareTo=function(u){for(var d=this.abs(),f=u.t=2*d.t;--f>=0;)u[f]=0;for(f=0;f<d.t-1;++f){var p=d.am(f,d[f],u,2*f,0,1);(u[f+d.t]+=d.am(f+1,2*d[f],u,2*f+1,p,d.t-f-1))>=d.DV&&(u[f+d.t]-=d.DV,u[f+d.t+1]=1)}u.t>0&&(u[u.t-1]+=d.am(f,d[f],u,2*f,0,1)),u.s=0,u.clamp()},ae.prototype.divRemTo=function(u,d,f){var p=u.abs();if(!(p.t<=0)){var y=this.abs();if(y.t<p.t)return d?.fromInt(0),void(null!=f&&this.copyTo(f));null==f&&(f=Qe());var A=Qe(),B=this.s,E=u.s,L=this.DB-Et(p[p.t-1]);L>0?(p.lShiftTo(L,A),y.lShiftTo(L,f)):(p.copyTo(A),y.copyTo(f));var M=A.t,N=A[M-1];if(0!=N){var X=N*(1<<this.F1)+(M>1?A[M-2]>>this.F2:0),ue=this.FV/X,pe=(1<<this.F1)/X,_e=1<<this.F2,ve=f.t,I=ve-M,$=d??Qe();for(A.dlShiftTo(I,$),f.compareTo($)>=0&&(f[f.t++]=1,f.subTo($,f)),ae.ONE.dlShiftTo(M,$),$.subTo(A,A);A.t<M;)A[A.t++]=0;for(;--I>=0;){var Y=f[--ve]==N?this.DM:Math.floor(f[ve]*ue+(f[ve-1]+_e)*pe);if((f[ve]+=A.am(0,Y,f,I,0,M))<Y)for(A.dlShiftTo(I,$),f.subTo($,f);f[ve]<--Y;)f.subTo($,f)}null!=d&&(f.drShiftTo(M,d),B!=E&&ae.ZERO.subTo(d,d)),f.t=M,f.clamp(),L>0&&f.rShiftTo(L,f),B<0&&ae.ZERO.subTo(f,f)}}},ae.prototype.invDigit=function(){if(this.t<1)return 0;var u=this[0];if(0==(1&u))return 0;var d=3&u;return(d=(d=(d=(d=d*(2-(15&u)*d)&15)*(2-(255&u)*d)&255)*(2-((65535&u)*d&65535))&65535)*(2-u*d%this.DV)%this.DV)>0?this.DV-d:-d},ae.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},ae.prototype.exp=function(u,d){if(u>4294967295||u<1)return ae.ONE;var f=Qe(),p=Qe(),y=d.convert(this),A=Et(u)-1;for(y.copyTo(f);--A>=0;)if(d.sqrTo(f,p),(u&1<<A)>0)d.mulTo(p,y,f);else{var B=f;f=p,p=B}return d.revert(f)},ae.prototype.toString=function(u){if(this.s<0)return"-"+this.negate().toString(u);var d;if(16==u)d=4;else if(8==u)d=3;else if(2==u)d=1;else if(32==u)d=5;else{if(4!=u)return this.toRadix(u);d=2}var f,p=(1<<d)-1,y=!1,A="",B=this.t,E=this.DB-B*this.DB%d;if(B-- >0)for(E<this.DB&&(f=this[B]>>E)>0&&(y=!0,A=en(f));B>=0;)E<d?(f=(this[B]&(1<<E)-1)<<d-E,f|=this[--B]>>(E+=this.DB-d)):(f=this[B]>>(E-=d)&p,E<=0&&(E+=this.DB,--B)),f>0&&(y=!0),y&&(A+=en(f));return y?A:"0"},ae.prototype.negate=function(){var u=Qe();return ae.ZERO.subTo(this,u),u},ae.prototype.abs=function(){return this.s<0?this.negate():this},ae.prototype.compareTo=function(u){var d=this.s-u.s;if(0!=d)return d;var f=this.t;if(0!=(d=f-u.t))return this.s<0?-d:d;for(;--f>=0;)if(0!=(d=this[f]-u[f]))return d;return 0},ae.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Et(this[this.t-1]^this.s&this.DM)},ae.prototype.mod=function(u){var d=Qe();return this.abs().divRemTo(u,null,d),this.s<0&&d.compareTo(ae.ZERO)>0&&u.subTo(d,d),d},ae.prototype.modPowInt=function(u,d){var f;return f=u<256||d.isEven()?new xt(d):new rn(d),this.exp(u,f)},ae.ZERO=dn(0),ae.ONE=dn(1),In.prototype.convert=yr,In.prototype.revert=yr,In.prototype.mulTo=function(u,d,f){u.multiplyTo(d,f)},In.prototype.sqrTo=function(u,d){u.squareTo(d)},Wn.prototype.convert=function(u){if(u.s<0||u.t>2*this.m.t)return u.mod(this.m);if(u.compareTo(this.m)<0)return u;var d=Qe();return u.copyTo(d),this.reduce(d),d},Wn.prototype.revert=function(u){return u},Wn.prototype.reduce=function(u){for(u.drShiftTo(this.m.t-1,this.r2),u.t>this.m.t+1&&(u.t=this.m.t+1,u.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);u.compareTo(this.r2)<0;)u.dAddOffset(1,this.m.t+1);for(u.subTo(this.r2,u);u.compareTo(this.m)>=0;)u.subTo(this.m,u)},Wn.prototype.mulTo=function(u,d,f){u.multiplyTo(d,f),this.reduce(f)},Wn.prototype.sqrTo=function(u,d){u.squareTo(d),this.reduce(d)};var ee,ce,fe,te=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],w=(1<<26)/te[te.length-1];function S(){this.i=0,this.j=0,this.S=new Array}function Ee(){!function(u){ce[fe++]^=255&u,ce[fe++]^=u>>8&255,ce[fe++]^=u>>16&255,ce[fe++]^=u>>24&255,fe>=256&&(fe-=256)}((new Date).getTime())}if(ae.prototype.chunkSize=function(u){return Math.floor(Math.LN2*this.DB/Math.log(u))},ae.prototype.toRadix=function(u){if(null==u&&(u=10),0==this.signum()||u<2||u>36)return"0";var d=this.chunkSize(u),f=Math.pow(u,d),p=dn(f),y=Qe(),A=Qe(),B="";for(this.divRemTo(p,y,A);y.signum()>0;)B=(f+A.intValue()).toString(u).substr(1)+B,y.divRemTo(p,y,A);return A.intValue().toString(u)+B},ae.prototype.fromRadix=function(u,d){this.fromInt(0),null==d&&(d=10);for(var f=this.chunkSize(d),p=Math.pow(d,f),y=!1,A=0,B=0,E=0;E<u.length;++E){var L=It(u,E);L<0?"-"==u.charAt(E)&&0==this.signum()&&(y=!0):(B=d*B+L,++A>=f&&(this.dMultiply(p),this.dAddOffset(B,0),A=0,B=0))}A>0&&(this.dMultiply(Math.pow(d,A)),this.dAddOffset(B,0)),y&&ae.ZERO.subTo(this,this)},ae.prototype.fromNumber=function(u,d,f){if("number"==typeof d)if(u<2)this.fromInt(1);else for(this.fromNumber(u,f),this.testBit(u-1)||this.bitwiseTo(ae.ONE.shiftLeft(u-1),Kn,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(d);)this.dAddOffset(2,0),this.bitLength()>u&&this.subTo(ae.ONE.shiftLeft(u-1),this);else{var p=new Array,y=7&u;p.length=1+(u>>3),d.nextBytes(p),y>0?p[0]&=(1<<y)-1:p[0]=0,this.fromString(p,256)}},ae.prototype.bitwiseTo=function(u,d,f){var p,y,A=Math.min(u.t,this.t);for(p=0;p<A;++p)f[p]=d(this[p],u[p]);if(u.t<this.t){for(y=u.s&this.DM,p=A;p<this.t;++p)f[p]=d(this[p],y);f.t=this.t}else{for(y=this.s&this.DM,p=A;p<u.t;++p)f[p]=d(y,u[p]);f.t=u.t}f.s=d(this.s,u.s),f.clamp()},ae.prototype.changeBit=function(u,d){var f=ae.ONE.shiftLeft(u);return this.bitwiseTo(f,d,f),f},ae.prototype.addTo=function(u,d){for(var f=0,p=0,y=Math.min(u.t,this.t);f<y;)p+=this[f]+u[f],d[f++]=p&this.DM,p>>=this.DB;if(u.t<this.t){for(p+=u.s;f<this.t;)p+=this[f],d[f++]=p&this.DM,p>>=this.DB;p+=this.s}else{for(p+=this.s;f<u.t;)p+=u[f],d[f++]=p&this.DM,p>>=this.DB;p+=u.s}d.s=p<0?-1:0,p>0?d[f++]=p:p<-1&&(d[f++]=this.DV+p),d.t=f,d.clamp()},ae.prototype.dMultiply=function(u){this[this.t]=this.am(0,u-1,this,0,0,this.t),++this.t,this.clamp()},ae.prototype.dAddOffset=function(u,d){if(0!=u){for(;this.t<=d;)this[this.t++]=0;for(this[d]+=u;this[d]>=this.DV;)this[d]-=this.DV,++d>=this.t&&(this[this.t++]=0),++this[d]}},ae.prototype.multiplyLowerTo=function(u,d,f){var p,y=Math.min(this.t+u.t,d);for(f.s=0,f.t=y;y>0;)f[--y]=0;for(p=f.t-this.t;y<p;++y)f[y+this.t]=this.am(0,u[y],f,y,0,this.t);for(p=Math.min(u.t,d);y<p;++y)this.am(0,u[y],f,y,0,d-y);f.clamp()},ae.prototype.multiplyUpperTo=function(u,d,f){--d;var p=f.t=this.t+u.t-d;for(f.s=0;--p>=0;)f[p]=0;for(p=Math.max(d-this.t,0);p<u.t;++p)f[this.t+p-d]=this.am(d-p,u[p],f,0,0,this.t+p-d);f.clamp(),f.drShiftTo(1,f)},ae.prototype.modInt=function(u){if(u<=0)return 0;var d=this.DV%u,f=this.s<0?u-1:0;if(this.t>0)if(0==d)f=this[0]%u;else for(var p=this.t-1;p>=0;--p)f=(d*f+this[p])%u;return f},ae.prototype.millerRabin=function(u){var d=this.subtract(ae.ONE),f=d.getLowestSetBit();if(f<=0)return!1;var p=d.shiftRight(f);(u=u+1>>1)>te.length&&(u=te.length);for(var y=Qe(),A=0;A<u;++A){y.fromInt(te[Math.floor(Math.random()*te.length)]);var B=y.modPow(p,this);if(0!=B.compareTo(ae.ONE)&&0!=B.compareTo(d)){for(var E=1;E++<f&&0!=B.compareTo(d);)if(0==(B=B.modPowInt(2,this)).compareTo(ae.ONE))return!1;if(0!=B.compareTo(d))return!1}}return!0},ae.prototype.clone=function(){var u=Qe();return this.copyTo(u),u},ae.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},ae.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},ae.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},ae.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},ae.prototype.toByteArray=function(){var u=this.t,d=new Array;d[0]=this.s;var f,p=this.DB-u*this.DB%8,y=0;if(u-- >0)for(p<this.DB&&(f=this[u]>>p)!=(this.s&this.DM)>>p&&(d[y++]=f|this.s<<this.DB-p);u>=0;)p<8?(f=(this[u]&(1<<p)-1)<<8-p,f|=this[--u]>>(p+=this.DB-8)):(f=this[u]>>(p-=8)&255,p<=0&&(p+=this.DB,--u)),0!=(128&f)&&(f|=-256),0==y&&(128&this.s)!=(128&f)&&++y,(y>0||f!=this.s)&&(d[y++]=f);return d},ae.prototype.equals=function(u){return 0==this.compareTo(u)},ae.prototype.min=function(u){return this.compareTo(u)<0?this:u},ae.prototype.max=function(u){return this.compareTo(u)>0?this:u},ae.prototype.and=function(u){var d=Qe();return this.bitwiseTo(u,$t,d),d},ae.prototype.or=function(u){var d=Qe();return this.bitwiseTo(u,Kn,d),d},ae.prototype.xor=function(u){var d=Qe();return this.bitwiseTo(u,Zn,d),d},ae.prototype.andNot=function(u){var d=Qe();return this.bitwiseTo(u,Lt,d),d},ae.prototype.not=function(){for(var u=Qe(),d=0;d<this.t;++d)u[d]=this.DM&~this[d];return u.t=this.t,u.s=~this.s,u},ae.prototype.shiftLeft=function(u){var d=Qe();return u<0?this.rShiftTo(-u,d):this.lShiftTo(u,d),d},ae.prototype.shiftRight=function(u){var d=Qe();return u<0?this.lShiftTo(-u,d):this.rShiftTo(u,d),d},ae.prototype.getLowestSetBit=function(){for(var u=0;u<this.t;++u)if(0!=this[u])return u*this.DB+qt(this[u]);return this.s<0?this.t*this.DB:-1},ae.prototype.bitCount=function(){for(var u=0,d=this.s&this.DM,f=0;f<this.t;++f)u+=at(this[f]^d);return u},ae.prototype.testBit=function(u){var d=Math.floor(u/this.DB);return d>=this.t?0!=this.s:0!=(this[d]&1<<u%this.DB)},ae.prototype.setBit=function(u){return this.changeBit(u,Kn)},ae.prototype.clearBit=function(u){return this.changeBit(u,Lt)},ae.prototype.flipBit=function(u){return this.changeBit(u,Zn)},ae.prototype.add=function(u){var d=Qe();return this.addTo(u,d),d},ae.prototype.subtract=function(u){var d=Qe();return this.subTo(u,d),d},ae.prototype.multiply=function(u){var d=Qe();return this.multiplyTo(u,d),d},ae.prototype.divide=function(u){var d=Qe();return this.divRemTo(u,d,null),d},ae.prototype.remainder=function(u){var d=Qe();return this.divRemTo(u,null,d),d},ae.prototype.divideAndRemainder=function(u){var d=Qe(),f=Qe();return this.divRemTo(u,d,f),new Array(d,f)},ae.prototype.modPow=function(u,d){var f,p,y=u.bitLength(),A=dn(1);if(y<=0)return A;f=y<18?1:y<48?3:y<144?4:y<768?5:6,p=y<8?new xt(d):d.isEven()?new Wn(d):new rn(d);var B=new Array,E=3,L=f-1,M=(1<<f)-1;if(B[1]=p.convert(this),f>1){var N=Qe();for(p.sqrTo(B[1],N);E<=M;)B[E]=Qe(),p.mulTo(N,B[E-2],B[E]),E+=2}var X,ue,pe=u.t-1,_e=!0,ve=Qe();for(y=Et(u[pe])-1;pe>=0;){for(y>=L?X=u[pe]>>y-L&M:(X=(u[pe]&(1<<y+1)-1)<<L-y,pe>0&&(X|=u[pe-1]>>this.DB+y-L)),E=f;0==(1&X);)X>>=1,--E;if((y-=E)<0&&(y+=this.DB,--pe),_e)B[X].copyTo(A),_e=!1;else{for(;E>1;)p.sqrTo(A,ve),p.sqrTo(ve,A),E-=2;E>0?p.sqrTo(A,ve):(ue=A,A=ve,ve=ue),p.mulTo(ve,B[X],A)}for(;pe>=0&&0==(u[pe]&1<<y);)p.sqrTo(A,ve),ue=A,A=ve,ve=ue,--y<0&&(y=this.DB-1,--pe)}return p.revert(A)},ae.prototype.modInverse=function(u){var d=u.isEven();if(this.isEven()&&d||0==u.signum())return ae.ZERO;for(var f=u.clone(),p=this.clone(),y=dn(1),A=dn(0),B=dn(0),E=dn(1);0!=f.signum();){for(;f.isEven();)f.rShiftTo(1,f),d?(y.isEven()&&A.isEven()||(y.addTo(this,y),A.subTo(u,A)),y.rShiftTo(1,y)):A.isEven()||A.subTo(u,A),A.rShiftTo(1,A);for(;p.isEven();)p.rShiftTo(1,p),d?(B.isEven()&&E.isEven()||(B.addTo(this,B),E.subTo(u,E)),B.rShiftTo(1,B)):E.isEven()||E.subTo(u,E),E.rShiftTo(1,E);f.compareTo(p)>=0?(f.subTo(p,f),d&&y.subTo(B,y),A.subTo(E,A)):(p.subTo(f,p),d&&B.subTo(y,B),E.subTo(A,E))}return 0!=p.compareTo(ae.ONE)?ae.ZERO:E.compareTo(u)>=0?E.subtract(u):E.signum()<0?(E.addTo(u,E),E.signum()<0?E.add(u):E):E},ae.prototype.pow=function(u){return this.exp(u,new In)},ae.prototype.gcd=function(u){var d=this.s<0?this.negate():this.clone(),f=u.s<0?u.negate():u.clone();if(d.compareTo(f)<0){var p=d;d=f,f=p}var y=d.getLowestSetBit(),A=f.getLowestSetBit();if(A<0)return d;for(y<A&&(A=y),A>0&&(d.rShiftTo(A,d),f.rShiftTo(A,f));d.signum()>0;)(y=d.getLowestSetBit())>0&&d.rShiftTo(y,d),(y=f.getLowestSetBit())>0&&f.rShiftTo(y,f),d.compareTo(f)>=0?(d.subTo(f,d),d.rShiftTo(1,d)):(f.subTo(d,f),f.rShiftTo(1,f));return A>0&&f.lShiftTo(A,f),f},ae.prototype.isProbablePrime=function(u){var d,f=this.abs();if(1==f.t&&f[0]<=te[te.length-1]){for(d=0;d<te.length;++d)if(f[0]==te[d])return!0;return!1}if(f.isEven())return!1;for(d=1;d<te.length;){for(var p=te[d],y=d+1;y<te.length&&p<w;)p*=te[y++];for(p=f.modInt(p);d<y;)if(p%te[d++]==0)return!1}return f.millerRabin(u)},ae.prototype.square=function(){var u=Qe();return this.squareTo(u),u},S.prototype.init=function(u){var d,f,p;for(d=0;d<256;++d)this.S[d]=d;for(f=0,d=0;d<256;++d)p=this.S[d],this.S[d]=this.S[f=f+this.S[d]+u[d%u.length]&255],this.S[f]=p;this.i=0,this.j=0},S.prototype.next=function(){var u;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,u=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=u,this.S[u+this.S[this.i]&255]},null==ce){var ze;if(ce=new Array,fe=0,void 0!==k&&(void 0!==k.crypto||void 0!==k.msCrypto)){var lt=k.crypto||k.msCrypto;if(lt.getRandomValues){var jt=new Uint8Array(32);for(lt.getRandomValues(jt),ze=0;ze<32;++ze)ce[fe++]=jt[ze]}else if("Netscape"==Z.appName&&Z.appVersion<"5"){var At=k.crypto.random(32);for(ze=0;ze<At.length;++ze)ce[fe++]=255&At.charCodeAt(ze)}}for(;fe<256;)ze=Math.floor(65536*Math.random()),ce[fe++]=ze>>>8,ce[fe++]=255&ze;fe=0,Ee()}function hn(){if(null==ee){for(Ee(),(ee=new S).init(ce),fe=0;fe<ce.length;++fe)ce[fe]=0;fe=0}return ee.next()}function Qn(){}function bn(c,u){return new ae(c,u)}function Hr(c,u,d){for(var f="",p=0;f.length<u;)f+=d(String.fromCharCode.apply(String,c.concat([(4278190080&p)>>24,(16711680&p)>>16,(65280&p)>>8,255&p]))),p+=1;return f}function it(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function on(c,u){this.x=u,this.q=c}function Ft(c,u,d,f){this.curve=c,this.x=u,this.y=d,this.z=f??ae.ONE,this.zinv=null}function Gi(c,u,d){this.q=c,this.a=this.fromBigInteger(u),this.b=this.fromBigInteger(d),this.infinity=new Ft(this,null,null)}Qn.prototype.nextBytes=function(u){var d;for(d=0;d<u.length;++d)u[d]=hn()},it.prototype.doPublic=function(u){return u.modPowInt(this.e,this.n)},it.prototype.setPublic=function(u,d){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof u)this.n=u,this.e=d;else{if(!(null!=u&&null!=d&&u.length>0&&d.length>0))throw"Invalid RSA public key";this.n=bn(u,16),this.e=parseInt(d,16)}},it.prototype.encrypt=function(u){var d=function(A,B){if(B<A.length+11)throw"Message too long for RSA";for(var E=new Array,L=A.length-1;L>=0&&B>0;){var M=A.charCodeAt(L--);M<128?E[--B]=M:M>127&&M<2048?(E[--B]=63&M|128,E[--B]=M>>6|192):(E[--B]=63&M|128,E[--B]=M>>6&63|128,E[--B]=M>>12|224)}E[--B]=0;for(var N=new Qn,X=new Array;B>2;){for(X[0]=0;0==X[0];)N.nextBytes(X);E[--B]=X[0]}return E[--B]=2,E[--B]=0,new ae(E)}(u,this.n.bitLength()+7>>3);if(null==d)return null;var f=this.doPublic(d);if(null==f)return null;var p=f.toString(16);return 0==(1&p.length)?p:"0"+p},it.prototype.encryptOAEP=function(u,d,f){var p=function(E,L,M,N){var X=P.crypto.MessageDigest,ue=P.crypto.Util,pe=null;if(M||(M="sha1"),"string"==typeof M&&(pe=X.getCanonicalAlgName(M),N=X.getHashLength(pe),M=function(ke){return vr(ue.hashHex(ai(ke),pe))}),E.length+2*N+2>L)throw"Message too long for RSA";var _e,ve="";for(_e=0;_e<L-E.length-2*N-2;_e+=1)ve+="\0";var I=M("")+ve+"\x01"+E,$=new Array(N);(new Qn).nextBytes($);var Y=Hr($,I.length,M),W=[];for(_e=0;_e<I.length;_e+=1)W[_e]=I.charCodeAt(_e)^Y.charCodeAt(_e);var ye=Hr(W,$.length,M),we=[0];for(_e=0;_e<$.length;_e+=1)we[_e+1]=$[_e]^ye.charCodeAt(_e);return new ae(we.concat(W))}(u,this.n.bitLength()+7>>3,d,f);if(null==p)return null;var y=this.doPublic(p);if(null==y)return null;var A=y.toString(16);return 0==(1&A.length)?A:"0"+A},it.prototype.type="RSA",on.prototype.equals=function(u){return u==this||this.q.equals(u.q)&&this.x.equals(u.x)},on.prototype.toBigInteger=function(){return this.x},on.prototype.negate=function(){return new on(this.q,this.x.negate().mod(this.q))},on.prototype.add=function(u){return new on(this.q,this.x.add(u.toBigInteger()).mod(this.q))},on.prototype.subtract=function(u){return new on(this.q,this.x.subtract(u.toBigInteger()).mod(this.q))},on.prototype.multiply=function(u){return new on(this.q,this.x.multiply(u.toBigInteger()).mod(this.q))},on.prototype.square=function(){return new on(this.q,this.x.square().mod(this.q))},on.prototype.divide=function(u){return new on(this.q,this.x.multiply(u.toBigInteger().modInverse(this.q)).mod(this.q))},Ft.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},Ft.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},Ft.prototype.equals=function(u){return u==this||(this.isInfinity()?u.isInfinity():u.isInfinity()?this.isInfinity():!!u.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(u.z)).mod(this.curve.q).equals(ae.ZERO)&&u.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(u.z)).mod(this.curve.q).equals(ae.ZERO))},Ft.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(ae.ZERO)&&!this.y.toBigInteger().equals(ae.ZERO)},Ft.prototype.negate=function(){return new Ft(this.curve,this.x,this.y.negate(),this.z)},Ft.prototype.add=function(u){if(this.isInfinity())return u;if(u.isInfinity())return this;var d=u.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(u.z)).mod(this.curve.q),f=u.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(u.z)).mod(this.curve.q);if(ae.ZERO.equals(f))return ae.ZERO.equals(d)?this.twice():this.curve.getInfinity();var p=new ae("3"),y=this.x.toBigInteger(),A=this.y.toBigInteger(),B=(u.x.toBigInteger(),u.y.toBigInteger(),f.square()),E=B.multiply(f),L=y.multiply(B),M=d.square().multiply(this.z),N=M.subtract(L.shiftLeft(1)).multiply(u.z).subtract(E).multiply(f).mod(this.curve.q),X=L.multiply(p).multiply(d).subtract(A.multiply(E)).subtract(M.multiply(d)).multiply(u.z).add(d.multiply(E)).mod(this.curve.q),ue=E.multiply(this.z).multiply(u.z).mod(this.curve.q);return new Ft(this.curve,this.curve.fromBigInteger(N),this.curve.fromBigInteger(X),ue)},Ft.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var u=new ae("3"),d=this.x.toBigInteger(),f=this.y.toBigInteger(),p=f.multiply(this.z),y=p.multiply(f).mod(this.curve.q),A=this.curve.a.toBigInteger(),B=d.square().multiply(u);ae.ZERO.equals(A)||(B=B.add(this.z.square().multiply(A)));var E=(B=B.mod(this.curve.q)).square().subtract(d.shiftLeft(3).multiply(y)).shiftLeft(1).multiply(p).mod(this.curve.q),L=B.multiply(u).multiply(d).subtract(y.shiftLeft(1)).shiftLeft(2).multiply(y).subtract(B.square().multiply(B)).mod(this.curve.q),M=p.square().multiply(p).shiftLeft(3).mod(this.curve.q);return new Ft(this.curve,this.curve.fromBigInteger(E),this.curve.fromBigInteger(L),M)},Ft.prototype.multiply=function(u){if(this.isInfinity())return this;if(0==u.signum())return this.curve.getInfinity();var d,f=u,p=f.multiply(new ae("3")),y=this.negate(),A=this,B=this.curve.q.subtract(u),E=B.multiply(new ae("3")),L=new Ft(this.curve,this.x,this.y),M=L.negate();for(d=p.bitLength()-2;d>0;--d){A=A.twice();var N=p.testBit(d);N!=f.testBit(d)&&(A=A.add(N?this:y))}for(d=E.bitLength()-2;d>0;--d){L=L.twice();var X=E.testBit(d);X!=B.testBit(d)&&(L=L.add(X?L:M))}return A},Ft.prototype.multiplyTwo=function(u,d,f){var p;p=u.bitLength()>f.bitLength()?u.bitLength()-1:f.bitLength()-1;for(var y=this.curve.getInfinity(),A=this.add(d);p>=0;)y=y.twice(),u.testBit(p)?y=f.testBit(p)?y.add(A):y.add(this):f.testBit(p)&&(y=y.add(d)),--p;return y},Gi.prototype.getQ=function(){return this.q},Gi.prototype.getA=function(){return this.a},Gi.prototype.getB=function(){return this.b},Gi.prototype.equals=function(u){return u==this||this.q.equals(u.q)&&this.a.equals(u.a)&&this.b.equals(u.b)},Gi.prototype.getInfinity=function(){return this.infinity},Gi.prototype.fromBigInteger=function(u){return new on(this.q,u)},Gi.prototype.decodePointHex=function(u){switch(parseInt(u.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:default:return null;case 4:case 6:case 7:var d=(u.length-2)/2,f=u.substr(2,d),p=u.substr(d+2,d);return new Ft(this,this.fromBigInteger(new ae(f,16)),this.fromBigInteger(new ae(p,16)))}},on.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},Ft.prototype.getEncoded=function(c){var u=function(A,B){var E=A.toByteArrayUnsigned();if(B<E.length)E=E.slice(E.length-B);else for(;B>E.length;)E.unshift(0);return E},d=this.getX().toBigInteger(),f=this.getY().toBigInteger(),p=u(d,32);return c?f.isEven()?p.unshift(2):p.unshift(3):(p.unshift(4),p=p.concat(u(f,32))),p},Ft.decodeFrom=function(c,u){var d=u.length-1,f=u.slice(1,1+d/2),p=u.slice(1+d/2,1+d);f.unshift(0),p.unshift(0);var y=new ae(f),A=new ae(p);return new Ft(c,c.fromBigInteger(y),c.fromBigInteger(A))},Ft.decodeFromHex=function(c,u){u.substr(0,2);var d=u.length-2,f=u.substr(2,d/2),p=u.substr(2+d/2,d/2),y=new ae(f,16),A=new ae(p,16);return new Ft(c,c.fromBigInteger(y),c.fromBigInteger(A))},Ft.prototype.add2D=function(c){if(this.isInfinity())return c;if(c.isInfinity())return this;if(this.x.equals(c.x))return this.y.equals(c.y)?this.twice():this.curve.getInfinity();var u=c.x.subtract(this.x),d=c.y.subtract(this.y).divide(u),f=d.square().subtract(this.x).subtract(c.x),p=d.multiply(this.x.subtract(f)).subtract(this.y);return new Ft(this.curve,f,p)},Ft.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var c=this.curve.fromBigInteger(ae.valueOf(2)),u=this.curve.fromBigInteger(ae.valueOf(3)),d=this.x.square().multiply(u).add(this.curve.a).divide(this.y.multiply(c)),f=d.square().subtract(this.x.multiply(c)),p=d.multiply(this.x.subtract(f)).subtract(this.y);return new Ft(this.curve,f,p)},Ft.prototype.multiply2D=function(c){if(this.isInfinity())return this;if(0==c.signum())return this.curve.getInfinity();var u,d=c,f=d.multiply(new ae("3")),p=this.negate(),y=this;for(u=f.bitLength()-2;u>0;--u){y=y.twice();var A=f.testBit(u);A!=d.testBit(u)&&(y=y.add2D(A?this:p))}return y},Ft.prototype.isOnCurve=function(){var c=this.getX().toBigInteger(),u=this.getY().toBigInteger(),d=this.curve.getA().toBigInteger(),f=this.curve.getB().toBigInteger(),p=this.curve.getQ(),y=u.multiply(u).mod(p),A=c.multiply(c).multiply(c).add(d.multiply(c)).add(f).mod(p);return y.equals(A)},Ft.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},Ft.prototype.validate=function(){var c=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var u=this.getX().toBigInteger(),d=this.getY().toBigInteger();if(u.compareTo(ae.ONE)<0||u.compareTo(c.subtract(ae.ONE))>0)throw new Error("x coordinate out of bounds");if(d.compareTo(ae.ONE)<0||d.compareTo(c.subtract(ae.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(c).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Wh=function(){var c=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),u=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),d={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function f(A,B,E){return B?d[B]:String.fromCharCode(parseInt(E,16))}var p=new String(""),y=Object.hasOwnProperty;return function(A,B){var E,L,M=A.match(c),N=M[0],X=!1;"{"===N?E={}:"["===N?E=[]:(E=[],X=!0);for(var ue=[E],pe=1-X,_e=M.length;pe<_e;++pe){var ve;switch((N=M[pe]).charCodeAt(0)){default:(ve=ue[0])[L||ve.length]=+N,L=void 0;break;case 34:if(-1!==(N=N.substring(1,N.length-1)).indexOf("\\")&&(N=N.replace(u,f)),ve=ue[0],!L){if(!(ve instanceof Array)){L=N||p;break}L=ve.length}ve[L]=N,L=void 0;break;case 91:ue.unshift((ve=ue[0])[L||ve.length]=[]),L=void 0;break;case 93:case 125:ue.shift();break;case 102:(ve=ue[0])[L||ve.length]=!1,L=void 0;break;case 110:(ve=ue[0])[L||ve.length]=null,L=void 0;break;case 116:(ve=ue[0])[L||ve.length]=!0,L=void 0;break;case 123:ue.unshift((ve=ue[0])[L||ve.length]={}),L=void 0}}if(X){if(1!==ue.length)throw new Error;E=E[0]}else if(ue.length)throw new Error;return B&&(E=function I($,Y){var W=$[Y];if(W&&"object"===(void 0===W?"undefined":x(W))){var ye=null;for(var we in W)if(y.call(W,we)&&W!==$){var Ke=I(W,we);void 0!==Ke?W[we]=Ke:(ye||(ye=[]),ye.push(we))}if(ye)for(var ke=ye.length;--ke>=0;)delete W[ye[ke]]}return B.call($,Y,W)}({"":E},"")),E}}();void 0!==P&&P||(O.KJUR=P={}),void 0!==P.asn1&&P.asn1||(P.asn1={}),P.asn1.ASN1Util=new function(){this.integerToByteHex=function(c){var u=c.toString(16);return u.length%2==1&&(u="0"+u),u},this.bigIntToMinTwosComplementsHex=function(c){var u=c.toString(16);if("-"!=u.substr(0,1))u.length%2==1?u="0"+u:u.match(/^[0-7]/)||(u="00"+u);else{var d=u.substr(1).length;d%2==1?d+=1:u.match(/^[0-7]/)||(d+=2);for(var f="",p=0;p<d;p++)f+="f";u=new ae(f,16).xor(c).add(ae.ONE).toString(16).replace(/^-/,"")}return u},this.getPEMStringFromHex=function(c,u){return rr(c,u)},this.newObject=function(c){var u=P.asn1,d=u.ASN1Object,f=u.DERBoolean,p=u.DERInteger,y=u.DERBitString,A=u.DEROctetString,B=u.DERNull,E=u.DERObjectIdentifier,L=u.DEREnumerated,M=u.DERUTF8String,N=u.DERNumericString,X=u.DERPrintableString,ue=u.DERTeletexString,pe=u.DERIA5String,_e=u.DERUTCTime,ve=u.DERGeneralizedTime,I=u.DERVisibleString,$=u.DERBMPString,Y=u.DERSequence,W=u.DERSet,ye=u.DERTaggedObject,we=u.ASN1Util.newObject;if(c instanceof u.ASN1Object)return c;var Ke=Object.keys(c);if(1!=Ke.length)throw new Error("key of param shall be only one.");var ke=Ke[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+ke+":"))throw new Error("undefined key: "+ke);if("bool"==ke)return new f(c[ke]);if("int"==ke)return new p(c[ke]);if("bitstr"==ke)return new y(c[ke]);if("octstr"==ke)return new A(c[ke]);if("null"==ke)return new B(c[ke]);if("oid"==ke)return new E(c[ke]);if("enum"==ke)return new L(c[ke]);if("utf8str"==ke)return new M(c[ke]);if("numstr"==ke)return new N(c[ke]);if("prnstr"==ke)return new X(c[ke]);if("telstr"==ke)return new ue(c[ke]);if("ia5str"==ke)return new pe(c[ke]);if("utctime"==ke)return new _e(c[ke]);if("gentime"==ke)return new ve(c[ke]);if("visstr"==ke)return new I(c[ke]);if("bmpstr"==ke)return new $(c[ke]);if("asn1"==ke)return new d(c[ke]);if("seq"==ke){for(var _t=c[ke],qe=[],et=0;et<_t.length;et++){var Xt=we(_t[et]);qe.push(Xt)}return new Y({array:qe})}if("set"==ke){for(_t=c[ke],qe=[],et=0;et<_t.length;et++)Xt=we(_t[et]),qe.push(Xt);return new W({array:qe})}if("tag"==ke){var St=c[ke];if("[object Array]"===Object.prototype.toString.call(St)&&3==St.length){var nt=we(St[2]);return new ye({tag:St[0],explicit:St[1],obj:nt})}return new ye(St)}},this.jsonToASN1HEX=function(c){return this.newObject(c).getEncodedHex()}},P.asn1.ASN1Util.oidHexToInt=function(c){for(var u="",d=parseInt(c.substr(0,2),16),f=(u=Math.floor(d/40)+"."+d%40,""),p=2;p<c.length;p+=2){var y=("00000000"+parseInt(c.substr(p,2),16).toString(2)).slice(-8);f+=y.substr(1,7),"0"==y.substr(0,1)&&(u=u+"."+new ae(f,2).toString(10),f="")}return u},P.asn1.ASN1Util.oidIntToHex=function(c){var u=function(E){var L=E.toString(16);return 1==L.length&&(L="0"+L),L},d=function(E){var L="",M=new ae(E,10).toString(2),N=7-M.length%7;7==N&&(N=0);for(var X="",ue=0;ue<N;ue++)X+="0";for(M=X+M,ue=0;ue<M.length-1;ue+=7){var pe=M.substr(ue,7);ue!=M.length-7&&(pe="1"+pe),L+=u(parseInt(pe,2))}return L};if(!c.match(/^[0-9.]+$/))throw"malformed oid string: "+c;var f="",p=c.split("."),y=40*parseInt(p[0])+parseInt(p[1]);f+=u(y),p.splice(0,2);for(var A=0;A<p.length;A++)f+=d(p[A]);return f},P.asn1.ASN1Object=function(c){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var u=this.hV.length/2,d=u.toString(16);if(d.length%2==1&&(d="0"+d),u<128)return d;var f=d.length/2;if(f>15)throw"ASN.1 length too long to represent by 8x: n = "+u.toString(16);return(128+f).toString(16)+d},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(u){this.params=u},null!=c&&null!=c.tlv&&(this.hTLV=c.tlv,this.isModified=!1)},P.asn1.DERAbstractString=function(c){P.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.s=u,this.hV=Ys(this.s).toLowerCase()},this.setStringHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.getFreshValueHex=function(){return this.hV},void 0!==c&&("string"==typeof c?this.setString(c):void 0!==c.str?this.setString(c.str):void 0!==c.hex&&this.setStringHex(c.hex))},_.lang.extend(P.asn1.DERAbstractString,P.asn1.ASN1Object),P.asn1.DERAbstractTime=function(c){P.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(u){var d=u.getTime()+6e4*u.getTimezoneOffset();return new Date(d)},this.formatDate=function(u,d,f){var p=this.zeroPadding,y=this.localDateToUTC(u),A=String(y.getFullYear());"utc"==d&&(A=A.substr(2,2));var B=A+p(String(y.getMonth()+1),2)+p(String(y.getDate()),2)+p(String(y.getHours()),2)+p(String(y.getMinutes()),2)+p(String(y.getSeconds()),2);if(!0===f){var E=y.getMilliseconds();if(0!=E){var L=p(String(E),3);B=B+"."+(L=L.replace(/[0]+$/,""))}}return B+"Z"},this.zeroPadding=function(u,d){return u.length>=d?u:new Array(d-u.length+1).join("0")+u},this.getString=function(){return this.s},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.s=u,this.hV=si(u)},this.setByDateValue=function(u,d,f,p,y,A){var B=new Date(Date.UTC(u,d-1,f,p,y,A,0));this.setByDate(B)},this.getFreshValueHex=function(){return this.hV}},_.lang.extend(P.asn1.DERAbstractTime,P.asn1.ASN1Object),P.asn1.DERAbstractStructured=function(c){P.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array=u},this.appendASN1Object=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array.push(u)},this.asn1Array=new Array,void 0!==c&&void 0!==c.array&&(this.asn1Array=c.array)},_.lang.extend(P.asn1.DERAbstractStructured,P.asn1.ASN1Object),P.asn1.DERBoolean=function(c){P.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==c?"010100":"0101ff"},_.lang.extend(P.asn1.DERBoolean,P.asn1.ASN1Object),P.asn1.DERInteger=function(c){P.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(u){this.hTLV=null,this.isModified=!0,this.hV=P.asn1.ASN1Util.bigIntToMinTwosComplementsHex(u)},this.setByInteger=function(u){var d=new ae(String(u),10);this.setByBigInteger(d)},this.setValueHex=function(u){this.hV=u},this.getFreshValueHex=function(){return this.hV},void 0!==c&&(void 0!==c.bigint?this.setByBigInteger(c.bigint):void 0!==c.int?this.setByInteger(c.int):"number"==typeof c?this.setByInteger(c):void 0!==c.hex&&this.setValueHex(c.hex))},_.lang.extend(P.asn1.DERInteger,P.asn1.ASN1Object),P.asn1.DERBitString=function(c){if(void 0!==c&&void 0!==c.obj){var u=P.asn1.ASN1Util.newObject(c.obj);c.hex="00"+u.getEncodedHex()}P.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(d){this.hTLV=null,this.isModified=!0,this.hV=d},this.setUnusedBitsAndHexValue=function(d,f){if(d<0||7<d)throw"unused bits shall be from 0 to 7: u = "+d;var p="0"+d;this.hTLV=null,this.isModified=!0,this.hV=p+f},this.setByBinaryString=function(d){var f=8-(d=d.replace(/0+$/,"")).length%8;8==f&&(f=0);for(var p=0;p<=f;p++)d+="0";var y="";for(p=0;p<d.length-1;p+=8){var A=d.substr(p,8),B=parseInt(A,2).toString(16);1==B.length&&(B="0"+B),y+=B}this.hTLV=null,this.isModified=!0,this.hV="0"+f+y},this.setByBooleanArray=function(d){for(var f="",p=0;p<d.length;p++)f+=1==d[p]?"1":"0";this.setByBinaryString(f)},this.newFalseArray=function(d){for(var f=new Array(d),p=0;p<d;p++)f[p]=!1;return f},this.getFreshValueHex=function(){return this.hV},void 0!==c&&("string"==typeof c&&c.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(c):void 0!==c.hex?this.setHexValueIncludingUnusedBits(c.hex):void 0!==c.bin?this.setByBinaryString(c.bin):void 0!==c.array&&this.setByBooleanArray(c.array))},_.lang.extend(P.asn1.DERBitString,P.asn1.ASN1Object),P.asn1.DEROctetString=function(c){if(void 0!==c&&void 0!==c.obj){var u=P.asn1.ASN1Util.newObject(c.obj);c.hex=u.getEncodedHex()}P.asn1.DEROctetString.superclass.constructor.call(this,c),this.hT="04"},_.lang.extend(P.asn1.DEROctetString,P.asn1.DERAbstractString),P.asn1.DERNull=function(){P.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},_.lang.extend(P.asn1.DERNull,P.asn1.ASN1Object),P.asn1.DERObjectIdentifier=function(c){P.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.setValueOidString=function(u){var d=function(p){var y=function(X){var ue=X.toString(16);return 1==ue.length&&(ue="0"+ue),ue},A=function(X){var ue="",pe=parseInt(X,10).toString(2),_e=7-pe.length%7;7==_e&&(_e=0);for(var ve="",I=0;I<_e;I++)ve+="0";for(pe=ve+pe,I=0;I<pe.length-1;I+=7){var $=pe.substr(I,7);I!=pe.length-7&&($="1"+$),ue+=y(parseInt($,2))}return ue};try{if(!p.match(/^[0-9.]+$/))return null;var B="",E=p.split("."),L=40*parseInt(E[0],10)+parseInt(E[1],10);B+=y(L),E.splice(0,2);for(var M=0;M<E.length;M++)B+=A(E[M]);return B}catch{return null}}(u);if(null==d)throw new Error("malformed oid string: "+u);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=d},this.setValueName=function(u){var d=P.asn1.x509.OID.name2oid(u);if(""===d)throw new Error("DERObjectIdentifier oidName undefined: "+u);this.setValueOidString(d)},this.setValueNameOrOid=function(u){u.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(u):this.setValueName(u)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(u){"string"==typeof u?this.setValueNameOrOid(u):void 0!==u.oid?this.setValueNameOrOid(u.oid):void 0!==u.name?this.setValueNameOrOid(u.name):void 0!==u.hex&&this.setValueHex(u.hex)},void 0!==c&&this.setByParam(c)},_.lang.extend(P.asn1.DERObjectIdentifier,P.asn1.ASN1Object),P.asn1.DEREnumerated=function(c){P.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(u){this.hTLV=null,this.isModified=!0,this.hV=P.asn1.ASN1Util.bigIntToMinTwosComplementsHex(u)},this.setByInteger=function(u){var d=new ae(String(u),10);this.setByBigInteger(d)},this.setValueHex=function(u){this.hV=u},this.getFreshValueHex=function(){return this.hV},void 0!==c&&(void 0!==c.int?this.setByInteger(c.int):"number"==typeof c?this.setByInteger(c):void 0!==c.hex&&this.setValueHex(c.hex))},_.lang.extend(P.asn1.DEREnumerated,P.asn1.ASN1Object),P.asn1.DERUTF8String=function(c){P.asn1.DERUTF8String.superclass.constructor.call(this,c),this.hT="0c"},_.lang.extend(P.asn1.DERUTF8String,P.asn1.DERAbstractString),P.asn1.DERNumericString=function(c){P.asn1.DERNumericString.superclass.constructor.call(this,c),this.hT="12"},_.lang.extend(P.asn1.DERNumericString,P.asn1.DERAbstractString),P.asn1.DERPrintableString=function(c){P.asn1.DERPrintableString.superclass.constructor.call(this,c),this.hT="13"},_.lang.extend(P.asn1.DERPrintableString,P.asn1.DERAbstractString),P.asn1.DERTeletexString=function(c){P.asn1.DERTeletexString.superclass.constructor.call(this,c),this.hT="14"},_.lang.extend(P.asn1.DERTeletexString,P.asn1.DERAbstractString),P.asn1.DERIA5String=function(c){P.asn1.DERIA5String.superclass.constructor.call(this,c),this.hT="16"},_.lang.extend(P.asn1.DERIA5String,P.asn1.DERAbstractString),P.asn1.DERVisibleString=function(c){P.asn1.DERIA5String.superclass.constructor.call(this,c),this.hT="1a"},_.lang.extend(P.asn1.DERVisibleString,P.asn1.DERAbstractString),P.asn1.DERBMPString=function(c){P.asn1.DERBMPString.superclass.constructor.call(this,c),this.hT="1e"},_.lang.extend(P.asn1.DERBMPString,P.asn1.DERAbstractString),P.asn1.DERUTCTime=function(c){P.asn1.DERUTCTime.superclass.constructor.call(this,c),this.hT="17",this.setByDate=function(u){this.hTLV=null,this.isModified=!0,this.date=u,this.s=this.formatDate(this.date,"utc"),this.hV=si(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=si(this.s)),this.hV},void 0!==c&&(void 0!==c.str?this.setString(c.str):"string"==typeof c&&c.match(/^[0-9]{12}Z$/)?this.setString(c):void 0!==c.hex?this.setStringHex(c.hex):void 0!==c.date&&this.setByDate(c.date))},_.lang.extend(P.asn1.DERUTCTime,P.asn1.DERAbstractTime),P.asn1.DERGeneralizedTime=function(c){P.asn1.DERGeneralizedTime.superclass.constructor.call(this,c),this.hT="18",this.withMillis=!1,this.setByDate=function(u){this.hTLV=null,this.isModified=!0,this.date=u,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=si(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=si(this.s)),this.hV},void 0!==c&&(void 0!==c.str?this.setString(c.str):"string"==typeof c&&c.match(/^[0-9]{14}Z$/)?this.setString(c):void 0!==c.hex?this.setStringHex(c.hex):void 0!==c.date&&this.setByDate(c.date),!0===c.millis&&(this.withMillis=!0))},_.lang.extend(P.asn1.DERGeneralizedTime,P.asn1.DERAbstractTime),P.asn1.DERSequence=function(c){P.asn1.DERSequence.superclass.constructor.call(this,c),this.hT="30",this.getFreshValueHex=function(){for(var u="",d=0;d<this.asn1Array.length;d++)u+=this.asn1Array[d].getEncodedHex();return this.hV=u,this.hV}},_.lang.extend(P.asn1.DERSequence,P.asn1.DERAbstractStructured),P.asn1.DERSet=function(c){P.asn1.DERSet.superclass.constructor.call(this,c),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var u=new Array,d=0;d<this.asn1Array.length;d++)u.push(this.asn1Array[d].getEncodedHex());return 1==this.sortFlag&&u.sort(),this.hV=u.join(""),this.hV},void 0!==c&&void 0!==c.sortflag&&0==c.sortflag&&(this.sortFlag=!1)},_.lang.extend(P.asn1.DERSet,P.asn1.DERAbstractStructured),P.asn1.DERTaggedObject=function(c){P.asn1.DERTaggedObject.superclass.constructor.call(this);var u=P.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(d,f,p){this.hT=f,this.isExplicit=d,this.asn1Object=p,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=p.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,f),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(d){null!=d.tag&&(this.hT=d.tag),null!=d.explicit&&(this.isExplicit=d.explicit),null!=d.tage&&(this.hT=d.tage,this.isExplicit=!0),null!=d.tagi&&(this.hT=d.tagi,this.isExplicit=!1),null!=d.obj&&(d.obj instanceof u.ASN1Object?(this.asn1Object=d.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):"object"==x(d.obj)&&(this.asn1Object=u.ASN1Util.newObject(d.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},null!=c&&this.setByParam(c)},_.lang.extend(P.asn1.DERTaggedObject,P.asn1.ASN1Object);var P,Ws,oi,Le=new function(){};function lu(c){for(var u=new Array,d=0;d<c.length;d++)u[d]=c.charCodeAt(d);return u}function du(c){for(var u="",d=0;d<c.length;d++)u+=String.fromCharCode(c[d]);return u}function fs(c){for(var u="",d=0;d<c.length;d++){var f=c[d].toString(16);1==f.length&&(f="0"+f),u+=f}return u}function si(c){return fs(lu(c))}function Js(c){return(c=(c=c.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function Ro(c){return c.length%4==2?c+="==":c.length%4==3&&(c+="="),(c=c.replace(/-/g,"+")).replace(/_/g,"/")}function wn(c){return c.length%2==1&&(c="0"+c),Js(Te(c))}function Yt(c){return Pe(Ro(c))}function Ys(c){return Sn(Zs(c))}function Zt(c){return decodeURIComponent(Ci(c))}function vr(c){for(var u="",d=0;d<c.length-1;d+=2)u+=String.fromCharCode(parseInt(c.substr(d,2),16));return u}function ai(c){for(var u="",d=0;d<c.length;d++)u+=("0"+c.charCodeAt(d).toString(16)).slice(-2);return u}function el(c){return Te(c)}function tl(c){return el(c).replace(/(.{64})/g,"$1\r\n").replace(/\r\n$/,"")}function hu(c){return Pe(c.replace(/[^0-9A-Za-z\/+=]*/g,""))}function rr(c,u){return"-----BEGIN "+u+"-----\r\n"+tl(c)+"\r\n-----END "+u+"-----\r\n"}function ui(c,u){if(-1==c.indexOf("-----BEGIN "))throw"can't find PEM header: "+u;return hu(c=void 0!==u?(c=c.replace(new RegExp("^[^]*-----BEGIN "+u+"-----"),"")).replace(new RegExp("-----END "+u+"-----[^]*$"),""):(c=c.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function $r(c){var u,d,f,p,y,A,B,E,L,M,N;if(N=c.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return E=N[1],u=parseInt(E),2===E.length&&(50<=u&&u<100?u=1900+u:0<=u&&u<50&&(u=2e3+u)),d=parseInt(N[2])-1,f=parseInt(N[3]),p=parseInt(N[4]),y=parseInt(N[5]),A=parseInt(N[6]),B=0,""!==(L=N[7])&&(M=(L.substr(1)+"00").substr(0,3),B=parseInt(M)),Date.UTC(u,d,f,p,y,A,B);throw"unsupported zulu format: "+c}function nl(c){return~~($r(c)/1e3)}function Sn(c){return c.replace(/%/g,"")}function Ci(c){return c.replace(/(..)/g,"%$1")}function ci(c){var u="malformed IPv6 address";if(!c.match(/^[0-9A-Fa-f:]+$/))throw u;var d=(c=c.toLowerCase()).split(":").length-1;if(d<2)throw u;var f=":".repeat(7-d+2),p=(c=c.replace("::",f)).split(":");if(8!=p.length)throw u;for(var y=0;y<8;y++)p[y]=("0000"+p[y]).slice(-4);return p.join("")}function Jh(c){if(!c.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var u=(c=c.toLowerCase()).match(/.{1,4}/g),d=0;d<8;d++)u[d]=u[d].replace(/^0+/,""),""==u[d]&&(u[d]="0");var f=(c=":"+u.join(":")+":").match(/:(0:){2,}/g);if(null===f)return c.slice(1,-1);var p="";for(d=0;d<f.length;d++)f[d].length>p.length&&(p=f[d]);return(c=c.replace(p,"::")).slice(1,-1)}function fu(c){var u="malformed hex value";if(!c.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw u;if(8!=c.length)return 32==c.length?Jh(c):c;try{return parseInt(c.substr(0,2),16)+"."+parseInt(c.substr(2,2),16)+"."+parseInt(c.substr(4,2),16)+"."+parseInt(c.substr(6,2),16)}catch{throw u}}function Zs(c){for(var u=encodeURIComponent(c),d="",f=0;f<u.length;f++)"%"==u[f]?(d+=u.substr(f,3),f+=2):d=d+"%"+si(u[f]);return d}function Qs(c){return!(c.length%2!=0||!c.match(/^[0-9a-f]+$/)&&!c.match(/^[0-9A-F]+$/))}function Xs(c){return c.length%2==1?"0"+c:c.substr(0,1)>"7"?"00"+c:c}Le.getLblen=function(c,u){if("8"!=c.substr(u+2,1))return 1;var d=parseInt(c.substr(u+3,1));return 0==d?-1:0<d&&d<10?d+1:-2},Le.getL=function(c,u){var d=Le.getLblen(c,u);return d<1?"":c.substr(u+2,2*d)},Le.getVblen=function(c,u){var d;return""==(d=Le.getL(c,u))?-1:("8"===d.substr(0,1)?new ae(d.substr(2),16):new ae(d,16)).intValue()},Le.getVidx=function(c,u){var d=Le.getLblen(c,u);return d<0?d:u+2*(d+1)},Le.getV=function(c,u){var d=Le.getVidx(c,u),f=Le.getVblen(c,u);return c.substr(d,2*f)},Le.getTLV=function(c,u){return c.substr(u,2)+Le.getL(c,u)+Le.getV(c,u)},Le.getTLVblen=function(c,u){return 2+2*Le.getLblen(c,u)+2*Le.getVblen(c,u)},Le.getNextSiblingIdx=function(c,u){return Le.getVidx(c,u)+2*Le.getVblen(c,u)},Le.getChildIdx=function(c,u){var d,f,p,y=Le,A=[];d=y.getVidx(c,u),f=2*y.getVblen(c,u),"03"==c.substr(u,2)&&(d+=2,f-=2),p=0;for(var B=d;p<=f;){var E=y.getTLVblen(c,B);if((p+=E)<=f&&A.push(B),B+=E,p>=f)break}return A},Le.getNthChildIdx=function(c,u,d){return Le.getChildIdx(c,u)[d]},Le.getIdxbyList=function(c,u,d,f){var p,y,A=Le;return 0==d.length?void 0!==f&&c.substr(u,2)!==f?-1:u:(p=d.shift())>=(y=A.getChildIdx(c,u)).length?-1:A.getIdxbyList(c,y[p],d,f)},Le.getIdxbyListEx=function(c,u,d,f){var p,y,A=Le;if(0==d.length)return void 0!==f&&c.substr(u,2)!==f?-1:u;p=d.shift(),y=A.getChildIdx(c,u);for(var B=0,E=0;E<y.length;E++){var L=c.substr(y[E],2);if("number"==typeof p&&!A.isContextTag(L)&&B==p||"string"==typeof p&&A.isContextTag(L,p))return A.getIdxbyListEx(c,y[E],d,f);A.isContextTag(L)||B++}return-1},Le.getTLVbyList=function(c,u,d,f){var p=Le,y=p.getIdxbyList(c,u,d,f);return-1==y||y>=c.length?null:p.getTLV(c,y)},Le.getTLVbyListEx=function(c,u,d,f){var p=Le,y=p.getIdxbyListEx(c,u,d,f);return-1==y?null:p.getTLV(c,y)},Le.getVbyList=function(c,u,d,f,p){var y,A,B=Le;return-1==(y=B.getIdxbyList(c,u,d,f))||y>=c.length?null:(A=B.getV(c,y),!0===p&&(A=A.substr(2)),A)},Le.getVbyListEx=function(c,u,d,f,p){var y,A,B=Le;return-1==(y=B.getIdxbyListEx(c,u,d,f))?null:(A=B.getV(c,y),"03"==c.substr(y,2)&&!1!==p&&(A=A.substr(2)),A)},Le.getInt=function(c,u,d){null==d&&(d=-1);try{var f=c.substr(u,2);if("02"!=f&&"03"!=f)return d;var p=Le.getV(c,u);return"02"==f?parseInt(p,16):function(A){try{var B=A.substr(0,2);if("00"==B)return parseInt(A.substr(2),16);var E=parseInt(B,16),L=A.substr(2),M=parseInt(L,16).toString(2);return"0"==M&&(M="00000000"),M=M.slice(0,0-E),parseInt(M,2)}catch{return-1}}(p)}catch{return d}},Le.getOID=function(c,u,d){null==d&&(d=null);try{return"06"!=c.substr(u,2)?d:function(p){if(!Qs(p))return null;try{var y=[],A=p.substr(0,2),B=parseInt(A,16);y[0]=new String(Math.floor(B/40)),y[1]=new String(B%40);for(var E=p.substr(2),L=[],M=0;M<E.length/2;M++)L.push(parseInt(E.substr(2*M,2),16));var N=[],X="";for(M=0;M<L.length;M++)128&L[M]?X+=No((127&L[M]).toString(2),7):(X+=No((127&L[M]).toString(2),7),N.push(new String(parseInt(X,2))),X="");var ue=y.join(".");return N.length>0&&(ue=ue+"."+N.join(".")),ue}catch{return null}}(Le.getV(c,u))}catch{return d}},Le.getOIDName=function(c,u,d){null==d&&(d=null);try{var f=Le.getOID(c,u,d);if(f==d)return d;var p=P.asn1.x509.OID.oid2name(f);return""==p?f:p}catch{return d}},Le.getString=function(c,u,d){null==d&&(d=null);try{return vr(Le.getV(c,u))}catch{return d}},Le.hextooidstr=function(c){var u=function(X,ue){return X.length>=ue?X:new Array(ue-X.length+1).join("0")+X},d=[],f=c.substr(0,2),p=parseInt(f,16);d[0]=new String(Math.floor(p/40)),d[1]=new String(p%40);for(var y=c.substr(2),A=[],B=0;B<y.length/2;B++)A.push(parseInt(y.substr(2*B,2),16));var E=[],L="";for(B=0;B<A.length;B++)128&A[B]?L+=u((127&A[B]).toString(2),7):(L+=u((127&A[B]).toString(2),7),E.push(new String(parseInt(L,2))),L="");var M=d.join(".");return E.length>0&&(M=M+"."+E.join(".")),M},Le.dump=function(c,u,d,f){var p=Le,y=p.getV,A=p.dump,B=p.getChildIdx,E=c;c instanceof P.asn1.ASN1Object&&(E=c.getEncodedHex());var L=function(ke,_t){return ke.length<=2*_t?ke:ke.substr(0,_t)+"..(total "+ke.length/2+"bytes).."+ke.substr(ke.length-_t,_t)};void 0===u&&(u={ommit_long_octet:32}),void 0===d&&(d=0),void 0===f&&(f="");var M,N=u.ommit_long_octet;if("01"==(M=E.substr(d,2)))return"00"==(X=y(E,d))?f+"BOOLEAN FALSE\n":f+"BOOLEAN TRUE\n";if("02"==M)return f+"INTEGER "+L(X=y(E,d),N)+"\n";if("03"==M){var X=y(E,d);return p.isASN1HEX(X.substr(2))?(ue=f+"BITSTRING, encapsulates\n")+A(X.substr(2),u,0,f+"  "):f+"BITSTRING "+L(X,N)+"\n"}if("04"==M)return X=y(E,d),p.isASN1HEX(X)?(ue=f+"OCTETSTRING, encapsulates\n",ue+=A(X,u,0,f+"  ")):f+"OCTETSTRING "+L(X,N)+"\n";if("05"==M)return f+"NULL\n";if("06"==M){var pe=y(E,d),_e=P.asn1.ASN1Util.oidHexToInt(pe),ve=P.asn1.x509.OID.oid2name(_e),I=_e.replace(/\./g," ");return""!=ve?f+"ObjectIdentifier "+ve+" ("+I+")\n":f+"ObjectIdentifier ("+I+")\n"}if("0a"==M)return f+"ENUMERATED "+parseInt(y(E,d))+"\n";if("0c"==M)return f+"UTF8String '"+Zt(y(E,d))+"'\n";if("13"==M)return f+"PrintableString '"+Zt(y(E,d))+"'\n";if("14"==M)return f+"TeletexString '"+Zt(y(E,d))+"'\n";if("16"==M)return f+"IA5String '"+Zt(y(E,d))+"'\n";if("17"==M)return f+"UTCTime "+Zt(y(E,d))+"\n";if("18"==M)return f+"GeneralizedTime "+Zt(y(E,d))+"\n";if("1a"==M)return f+"VisualString '"+Zt(y(E,d))+"'\n";if("1e"==M)return f+"BMPString '"+Zt(y(E,d))+"'\n";if("30"==M){if("3000"==E.substr(d,4))return f+"SEQUENCE {}\n";ue=f+"SEQUENCE\n";var $=u;if((2==(ye=B(E,d)).length||3==ye.length)&&"06"==E.substr(ye[0],2)&&"04"==E.substr(ye[ye.length-1],2)){ve=p.oidname(y(E,ye[0]));var Y=JSON.parse(JSON.stringify(u));Y.x509ExtName=ve,$=Y}for(var W=0;W<ye.length;W++)ue+=A(E,$,ye[W],f+"  ");return ue}if("31"==M){ue=f+"SET\n";var ye=B(E,d);for(W=0;W<ye.length;W++)ue+=A(E,u,ye[W],f+"  ");return ue}if(0!=(128&(M=parseInt(M,16)))){var ue,we=31&M;if(0!=(32&M)){for(ue=f+"["+we+"]\n",ye=B(E,d),W=0;W<ye.length;W++)ue+=A(E,u,ye[W],f+"  ");return ue}return X=y(E,d),Le.isASN1HEX(X)?(ue=f+"["+we+"]\n")+A(X,u,0,f+"  "):(("68747470"==X.substr(0,8)||"subjectAltName"===u.x509ExtName&&2==we)&&(X=Zt(X)),f+"["+we+"] "+X+"\n")}return f+"UNKNOWN("+M+") "+y(E,d)+"\n"},Le.isContextTag=function(c,u){var d,f;c=c.toLowerCase();try{d=parseInt(c,16)}catch{return-1}if(void 0===u)return 128==(192&d);try{return null!=u.match(/^\[[0-9]+\]$/)&&!((f=parseInt(u.substr(1,u.length-1),10))>31)&&128==(192&d)&&(31&d)==f}catch{return!1}},Le.isASN1HEX=function(c){var u=Le;if(c.length%2==1)return!1;var d=u.getVblen(c,0),f=c.substr(0,2),p=u.getL(c,0);return c.length-f.length-p.length==2*d},Le.checkStrictDER=function(c,u,d,f,p){var y=Le;if(void 0===d){if("string"!=typeof c)throw new Error("not hex string");if(c=c.toLowerCase(),!P.lang.String.isHex(c))throw new Error("not hex string");d=c.length,p=(f=c.length/2)<128?1:Math.ceil(f.toString(16))+1}if(y.getL(c,u).length>2*p)throw new Error("L of TLV too long: idx="+u);var A=y.getVblen(c,u);if(A>f)throw new Error("value of L too long than hex: idx="+u);var B=y.getTLV(c,u),E=B.length-2-y.getL(c,u).length;if(E!==2*A)throw new Error("V string length and L's value not the same:"+E+"/"+2*A);if(0===u&&c.length!=B.length)throw new Error("total length and TLV length unmatch:"+c.length+"!="+B.length);var L=c.substr(u,2);if("02"===L){var M=y.getVidx(c,u);if("00"==c.substr(M,2)&&c.charCodeAt(M+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(L,16)){for(var N=y.getVblen(c,u),X=0,ue=y.getChildIdx(c,u),pe=0;pe<ue.length;pe++)X+=y.getTLV(c,ue[pe]).length,y.checkStrictDER(c,ue[pe],d,f,p);if(2*N!=X)throw new Error("sum of children's TLV length and L unmatch: "+2*N+"!="+X)}},Le.oidname=function(c){var u=P.asn1;P.lang.String.isHex(c)&&(c=u.ASN1Util.oidHexToInt(c));var d=u.x509.OID.oid2name(c);return""===d&&(d=c),d},void 0!==P&&P||(O.KJUR=P={}),void 0!==P.lang&&P.lang||(P.lang={}),P.lang.String=function(){},"function"==typeof Q?(O.utf8tob64u=Ws=function(u){return Js(Q.from(u,"utf8").toString("base64"))},O.b64utoutf8=oi=function(u){return Q.from(Ro(u),"base64").toString("utf8")}):(O.utf8tob64u=Ws=function(u){return wn(Sn(Zs(u)))},O.b64utoutf8=oi=function(u){return decodeURIComponent(Ci(Yt(u)))}),P.lang.String.isInteger=function(c){return!!c.match(/^[0-9]+$/)||!!c.match(/^-[0-9]+$/)},P.lang.String.isHex=function(c){return Qs(c)},P.lang.String.isBase64=function(c){return!(!(c=c.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||c.length%4!=0)},P.lang.String.isBase64URL=function(c){return!c.match(/[+/=]/)&&(c=Ro(c),P.lang.String.isBase64(c))},P.lang.String.isIntegerArray=function(c){return!!(c=c.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},P.lang.String.isPrintable=function(c){return null!==c.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},P.lang.String.isIA5=function(c){return null!==c.match(/^[\x20-\x21\x23-\x7f]*$/)},P.lang.String.isMail=function(c){return null!==c.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var No=function(u,d,f){return null==f&&(f="0"),u.length>=d?u:new Array(d-u.length+1).join(f)+u};void 0!==P&&P||(O.KJUR=P={}),void 0!==P.crypto&&P.crypto||(P.crypto={}),P.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:oe.algo.MD5,sha1:oe.algo.SHA1,sha224:oe.algo.SHA224,sha256:oe.algo.SHA256,sha384:oe.algo.SHA384,sha512:oe.algo.SHA512,ripemd160:oe.algo.RIPEMD160},this.getDigestInfoHex=function(c,u){if(void 0===this.DIGESTINFOHEAD[u])throw"alg not supported in Util.DIGESTINFOHEAD: "+u;return this.DIGESTINFOHEAD[u]+c},this.getPaddedDigestInfoHex=function(c,u,d){var f=this.getDigestInfoHex(c,u),p=d/4;if(f.length+22>p)throw"key is too short for SigAlg: keylen="+d+","+u;for(var y="0001",A="00"+f,B="",E=p-y.length-A.length,L=0;L<E;L+=2)B+="ff";return y+B+A},this.hashString=function(c,u){return new P.crypto.MessageDigest({alg:u}).digestString(c)},this.hashHex=function(c,u){return new P.crypto.MessageDigest({alg:u}).digestHex(c)},this.sha1=function(c){return this.hashString(c,"sha1")},this.sha256=function(c){return this.hashString(c,"sha256")},this.sha256Hex=function(c){return this.hashHex(c,"sha256")},this.sha512=function(c){return this.hashString(c,"sha512")},this.sha512Hex=function(c){return this.hashHex(c,"sha512")},this.isKey=function(c){return c instanceof it||c instanceof P.crypto.DSA||c instanceof P.crypto.ECDSA}},P.crypto.Util.md5=function(c){return new P.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(c)},P.crypto.Util.ripemd160=function(c){return new P.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(c)},P.crypto.Util.SECURERANDOMGEN=new Qn,P.crypto.Util.getRandomHexOfNbytes=function(c){var u=new Array(c);return P.crypto.Util.SECURERANDOMGEN.nextBytes(u),fs(u)},P.crypto.Util.getRandomBigIntegerOfNbytes=function(c){return new ae(P.crypto.Util.getRandomHexOfNbytes(c),16)},P.crypto.Util.getRandomHexOfNbits=function(c){var u=c%8,d=new Array((c-u)/8+1);return P.crypto.Util.SECURERANDOMGEN.nextBytes(d),d[0]=(255<<u&255^255)&d[0],fs(d)},P.crypto.Util.getRandomBigIntegerOfNbits=function(c){return new ae(P.crypto.Util.getRandomHexOfNbits(c),16)},P.crypto.Util.getRandomBigIntegerZeroToMax=function(c){for(var u=c.bitLength();;){var d=P.crypto.Util.getRandomBigIntegerOfNbits(u);if(-1!=c.compareTo(d))return d}},P.crypto.Util.getRandomBigIntegerMinToMax=function(c,u){var d=c.compareTo(u);if(1==d)throw"biMin is greater than biMax";if(0==d)return c;var f=u.subtract(c);return P.crypto.Util.getRandomBigIntegerZeroToMax(f).add(c)},P.crypto.MessageDigest=function(c){this.setAlgAndProvider=function(u,d){if(null!==(u=P.crypto.MessageDigest.getCanonicalAlgName(u))&&void 0===d&&(d=P.crypto.Util.DEFAULTPROVIDER[u]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(u)&&"cryptojs"==d){try{this.md=P.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[u].create()}catch(f){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+f}this.updateString=function(f){this.md.update(f)},this.updateHex=function(f){var p=oe.enc.Hex.parse(f);this.md.update(p)},this.digest=function(){return this.md.finalize().toString(oe.enc.Hex)},this.digestString=function(f){return this.updateString(f),this.digest()},this.digestHex=function(f){return this.updateHex(f),this.digest()}}if(-1!=":sha256:".indexOf(u)&&"sjcl"==d){try{this.md=new sjcl.hash.sha256}catch(f){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+f}this.updateString=function(f){this.md.update(f)},this.updateHex=function(f){var p=sjcl.codec.hex.toBits(f);this.md.update(p)},this.digest=function(){var f=this.md.finalize();return sjcl.codec.hex.fromBits(f)},this.digestString=function(f){return this.updateString(f),this.digest()},this.digestHex=function(f){return this.updateHex(f),this.digest()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==c&&void 0!==c.alg&&(this.algName=c.alg,void 0===c.prov&&(this.provName=P.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},P.crypto.MessageDigest.getCanonicalAlgName=function(c){return"string"==typeof c&&(c=(c=c.toLowerCase()).replace(/-/,"")),c},P.crypto.MessageDigest.getHashLength=function(c){var u=P.crypto.MessageDigest,d=u.getCanonicalAlgName(c);if(void 0===u.HASHLENGTH[d])throw"not supported algorithm: "+c;return u.HASHLENGTH[d]},P.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},P.crypto.Mac=function(c){this.setAlgAndProvider=function(u,d){if(null==(u=u.toLowerCase())&&(u="hmacsha1"),"hmac"!=(u=u.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+u;void 0===d&&(d=P.crypto.Util.DEFAULTPROVIDER[u]),this.algProv=u+"/"+d;var f=u.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(f)&&"cryptojs"==d){try{this.mac=oe.algo.HMAC.create(P.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[f],this.pass)}catch(y){throw"setAlgAndProvider hash alg set fail hashAlg="+f+"/"+y}this.updateString=function(y){this.mac.update(y)},this.updateHex=function(y){var A=oe.enc.Hex.parse(y);this.mac.update(A)},this.doFinal=function(){return this.mac.finalize().toString(oe.enc.Hex)},this.doFinalString=function(y){return this.updateString(y),this.doFinal()},this.doFinalHex=function(y){return this.updateHex(y),this.doFinal()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(u){if("string"==typeof u){var d=u;return u.length%2!=1&&u.match(/^[0-9A-Fa-f]+$/)||(d=ai(u)),void(this.pass=oe.enc.Hex.parse(d))}if("object"!=(void 0===u?"undefined":x(u)))throw"KJUR.crypto.Mac unsupported password type: "+u;if(d=null,void 0!==u.hex){if(u.hex.length%2!=0||!u.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+u.hex;d=u.hex}if(void 0!==u.utf8&&(d=Ys(u.utf8)),void 0!==u.rstr&&(d=ai(u.rstr)),void 0!==u.b64&&(d=Pe(u.b64)),void 0!==u.b64u&&(d=Yt(u.b64u)),null==d)throw"KJUR.crypto.Mac unsupported password type: "+u;this.pass=oe.enc.Hex.parse(d)},void 0!==c&&(void 0!==c.pass&&this.setPassword(c.pass),void 0!==c.alg&&(this.algName=c.alg,void 0===c.prov&&(this.provName=P.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},P.crypto.Signature=function(c){var u=null;if(this._setAlgNames=function(){var d=this.algName.match(/^(.+)with(.+)$/);d&&(this.mdAlgName=d[1].toLowerCase(),this.pubkeyAlgName=d[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(d,f){for(var p="",y=f/4-d.length,A=0;A<y;A++)p+="0";return p+d},this.setAlgAndProvider=function(d,f){if(this._setAlgNames(),"cryptojs/jsrsa"!=f)throw new Error("provider not supported: "+f);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new P.crypto.MessageDigest({alg:this.mdAlgName})}catch(p){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+p)}this.init=function(p,y){var A=null;try{A=void 0===y?Cn.getKey(p):Cn.getKey(p,y)}catch(B){throw"init failed:"+B}if(!0===A.isPrivate)this.prvKey=A,this.state="SIGN";else{if(!0!==A.isPublic)throw"init failed.:"+A;this.pubKey=A,this.state="VERIFY"}},this.updateString=function(p){this.md.updateString(p)},this.updateHex=function(p){this.md.updateHex(p)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==P.crypto.ECDSA&&(this.prvKey=new P.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof it&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof it&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof P.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof P.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(p){return this.updateString(p),this.sign()},this.signHex=function(p){return this.updateHex(p),this.sign()},this.verify=function(p){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==P.crypto.ECDSA&&(this.pubKey=new P.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof it&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,p,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof it&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,p);if(void 0!==P.crypto.ECDSA&&this.pubKey instanceof P.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,p);if(void 0!==P.crypto.DSA&&this.pubKey instanceof P.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,p);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(d,f){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(d){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(d){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(d){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(d){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(d){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=c,void 0!==c&&(void 0!==c.alg&&(this.algName=c.alg,this.provName=void 0===c.prov?P.crypto.Util.DEFAULTPROVIDER[this.algName]:c.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==c.psssaltlen&&(this.pssSaltLen=c.psssaltlen),void 0!==c.prvkeypem)){if(void 0!==c.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{u=Cn.getKey(c.prvkeypem),this.init(u)}catch(d){throw"fatal error to load pem private key: "+d}}},P.crypto.Cipher=function(c){},P.crypto.Cipher.encrypt=function(c,u,d){if(u instanceof it&&u.isPublic){var f=P.crypto.Cipher.getAlgByKeyAndName(u,d);if("RSA"===f)return u.encrypt(c);if("RSAOAEP"===f)return u.encryptOAEP(c,"sha1");var p=f.match(/^RSAOAEP(\d+)$/);if(null!==p)return u.encryptOAEP(c,"sha"+p[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+d}throw"Cipher.encrypt: unsupported key or algorithm"},P.crypto.Cipher.decrypt=function(c,u,d){if(u instanceof it&&u.isPrivate){var f=P.crypto.Cipher.getAlgByKeyAndName(u,d);if("RSA"===f)return u.decrypt(c);if("RSAOAEP"===f)return u.decryptOAEP(c,"sha1");var p=f.match(/^RSAOAEP(\d+)$/);if(null!==p)return u.decryptOAEP(c,"sha"+p[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+d}throw"Cipher.decrypt: unsupported key or algorithm"},P.crypto.Cipher.getAlgByKeyAndName=function(c,u){if(c instanceof it){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(u))return u;if(null==u)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+u}throw"getAlgByKeyAndName: not supported algorithm name: "+u},P.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==P&&P||(O.KJUR=P={}),void 0!==P.crypto&&P.crypto||(P.crypto={}),P.crypto.ECDSA=function(c){var u=Error,d=ae,f=Ft,p=P.crypto.ECDSA,y=P.crypto.ECParameterDB,A=p.getName,E=Le.getVbyListEx,L=Le.isASN1HEX,M=new Qn;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(N){return new d(N.bitLength(),M).mod(N.subtract(d.ONE)).add(d.ONE)},this.setNamedCurve=function(N){this.ecparams=y.getByName(N),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=N},this.setPrivateKeyHex=function(N){this.isPrivate=!0,this.prvKeyHex=N},this.setPublicKeyHex=function(N){this.isPublic=!0,this.pubKeyHex=N},this.getPublicKeyXYHex=function(){var N=this.pubKeyHex;if("04"!==N.substr(0,2))throw"this method supports uncompressed format(04) only";var X=this.ecparams.keylen/4;if(N.length!==2+2*X)throw"malformed public key hex length";var ue={};return ue.x=N.substr(2,X),ue.y=N.substr(2+X),ue},this.getShortNISTPCurveName=function(){var N=this.curveName;return"secp256r1"===N||"NIST P-256"===N||"P-256"===N||"prime256v1"===N?"P-256":"secp384r1"===N||"NIST P-384"===N||"P-384"===N?"P-384":null},this.generateKeyPairHex=function(){var X=this.getBigRandom(this.ecparams.n),ue=this.ecparams.G.multiply(X),pe=ue.getX().toBigInteger(),_e=ue.getY().toBigInteger(),ve=this.ecparams.keylen/4,I=("0000000000"+X.toString(16)).slice(-ve),$="04"+("0000000000"+pe.toString(16)).slice(-ve)+("0000000000"+_e.toString(16)).slice(-ve);return this.setPrivateKeyHex(I),this.setPublicKeyHex($),{ecprvhex:I,ecpubhex:$}},this.signWithMessageHash=function(N){return this.signHex(N,this.prvKeyHex)},this.signHex=function(N,X){var ue=new d(X,16),pe=this.ecparams.n,_e=new d(N.substring(0,this.ecparams.keylen/4),16);do{var ve=this.getBigRandom(pe),I=this.ecparams.G.multiply(ve).getX().toBigInteger().mod(pe)}while(I.compareTo(d.ZERO)<=0);var $=ve.modInverse(pe).multiply(_e.add(ue.multiply(I))).mod(pe);return p.biRSSigToASN1Sig(I,$)},this.sign=function(N,X){var ue=X,pe=this.ecparams.n,_e=d.fromByteArrayUnsigned(N);do{var ve=this.getBigRandom(pe),I=this.ecparams.G.multiply(ve).getX().toBigInteger().mod(pe)}while(I.compareTo(ae.ZERO)<=0);var $=ve.modInverse(pe).multiply(_e.add(ue.multiply(I))).mod(pe);return this.serializeSig(I,$)},this.verifyWithMessageHash=function(N,X){return this.verifyHex(N,X,this.pubKeyHex)},this.verifyHex=function(N,X,ue){try{var pe,_e,ve=p.parseSigHex(X);pe=ve.r,_e=ve.s;var I=f.decodeFromHex(this.ecparams.curve,ue),$=new d(N.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw($,pe,_e,I)}catch{return!1}},this.verify=function(N,X,ue){var pe,_e,ve;if(Bitcoin.Util.isArray(X)){var I=this.parseSig(X);pe=I.r,_e=I.s}else{if("object"!==(void 0===X?"undefined":x(X))||!X.r||!X.s)throw"Invalid value for signature";pe=X.r,_e=X.s}if(ue instanceof Ft)ve=ue;else{if(!Bitcoin.Util.isArray(ue))throw"Invalid format for pubkey value, must be byte array or ECPointFp";ve=f.decodeFrom(this.ecparams.curve,ue)}var $=d.fromByteArrayUnsigned(N);return this.verifyRaw($,pe,_e,ve)},this.verifyRaw=function(N,X,ue,pe){var _e=this.ecparams.n,ve=this.ecparams.G;if(X.compareTo(d.ONE)<0||X.compareTo(_e)>=0||ue.compareTo(d.ONE)<0||ue.compareTo(_e)>=0)return!1;var I=ue.modInverse(_e),$=N.multiply(I).mod(_e),Y=X.multiply(I).mod(_e);return ve.multiply($).add(pe.multiply(Y)).getX().toBigInteger().mod(_e).equals(X)},this.serializeSig=function(N,X){var ue=N.toByteArraySigned(),pe=X.toByteArraySigned(),_e=[];return _e.push(2),_e.push(ue.length),(_e=_e.concat(ue)).push(2),_e.push(pe.length),(_e=_e.concat(pe)).unshift(_e.length),_e.unshift(48),_e},this.parseSig=function(N){var X;if(48!=N[0])throw new Error("Signature not a valid DERSequence");if(2!=N[X=2])throw new Error("First element in signature must be a DERInteger");var ue=N.slice(X+2,X+2+N[X+1]);if(2!=N[X+=2+N[X+1]])throw new Error("Second element in signature must be a DERInteger");var pe=N.slice(X+2,X+2+N[X+1]);return X+=2+N[X+1],{r:d.fromByteArrayUnsigned(ue),s:d.fromByteArrayUnsigned(pe)}},this.parseSigCompact=function(N){if(65!==N.length)throw"Signature has the wrong length";var X=N[0]-27;if(X<0||X>7)throw"Invalid signature type";var ue=this.ecparams.n;return{r:d.fromByteArrayUnsigned(N.slice(1,33)).mod(ue),s:d.fromByteArrayUnsigned(N.slice(33,65)).mod(ue),i:X}},this.readPKCS5PrvKeyHex=function(N){if(!1===L(N))throw new Error("not ASN.1 hex string");var X,ue,pe;try{X=E(N,0,["[0]",0],"06"),ue=E(N,0,[1],"04");try{pe=E(N,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=A(X),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(pe),this.setPrivateKeyHex(ue),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(N){if(!1===L(N))throw new u("not ASN.1 hex string");var X,ue,pe;try{E(N,0,[1,0],"06"),X=E(N,0,[1,1],"06"),ue=E(N,0,[2,0,1],"04");try{pe=E(N,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new u("malformed PKCS#8 plain ECC private key")}if(this.curveName=A(X),void 0===this.curveName)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(pe),this.setPrivateKeyHex(ue),this.isPublic=!1},this.readPKCS8PubKeyHex=function(N){if(!1===L(N))throw new u("not ASN.1 hex string");var X,ue;try{E(N,0,[0,0],"06"),X=E(N,0,[0,1],"06"),ue=E(N,0,[1],"03")}catch{throw new u("malformed PKCS#8 ECC public key")}if(this.curveName=A(X),null===this.curveName)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(ue)},this.readCertPubKeyHex=function(N,X){if(!1===L(N))throw new u("not ASN.1 hex string");var ue,pe;try{ue=E(N,0,[0,5,0,1],"06"),pe=E(N,0,[0,5,1],"03")}catch{throw new u("malformed X.509 certificate ECC public key")}if(this.curveName=A(ue),null===this.curveName)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(pe)},void 0!==c&&void 0!==c.curve&&(this.curveName=c.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==c&&(void 0!==c.prv&&this.setPrivateKeyHex(c.prv),void 0!==c.pub&&this.setPublicKeyHex(c.pub))},P.crypto.ECDSA.parseSigHex=function(c){var u=P.crypto.ECDSA.parseSigHexInHexRS(c);return{r:new ae(u.r,16),s:new ae(u.s,16)}},P.crypto.ECDSA.parseSigHexInHexRS=function(c){var d=Le.getChildIdx,f=Le.getV;if(Le.checkStrictDER(c,0),"30"!=c.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var p=d(c,0);if(2!=p.length)throw new Error("signature shall have two elements");var y=p[0],A=p[1];if("02"!=c.substr(y,2))throw new Error("1st item not ASN.1 integer");if("02"!=c.substr(A,2))throw new Error("2nd item not ASN.1 integer");return{r:f(c,y),s:f(c,A)}},P.crypto.ECDSA.asn1SigToConcatSig=function(c){var u=P.crypto.ECDSA.parseSigHexInHexRS(c),d=u.r,f=u.s;if("00"==d.substr(0,2)&&d.length%32==2&&(d=d.substr(2)),"00"==f.substr(0,2)&&f.length%32==2&&(f=f.substr(2)),d.length%32==30&&(d="00"+d),f.length%32==30&&(f="00"+f),d.length%32!=0)throw"unknown ECDSA sig r length error";if(f.length%32!=0)throw"unknown ECDSA sig s length error";return d+f},P.crypto.ECDSA.concatSigToASN1Sig=function(c){if(c.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var u=c.substr(0,c.length/2),d=c.substr(c.length/2);return P.crypto.ECDSA.hexRSSigToASN1Sig(u,d)},P.crypto.ECDSA.hexRSSigToASN1Sig=function(c,u){var d=new ae(c,16),f=new ae(u,16);return P.crypto.ECDSA.biRSSigToASN1Sig(d,f)},P.crypto.ECDSA.biRSSigToASN1Sig=function(c,u){var d=P.asn1,f=new d.DERInteger({bigint:c}),p=new d.DERInteger({bigint:u});return new d.DERSequence({array:[f,p]}).getEncodedHex()},P.crypto.ECDSA.getName=function(c){return"2b8104001f"===c?"secp192k1":"2a8648ce3d030107"===c?"secp256r1":"2b8104000a"===c?"secp256k1":"2b81040021"===c?"secp224r1":"2b81040022"===c?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(c)?"secp256r1":-1!=="|secp256k1|".indexOf(c)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(c)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(c)?"secp384r1":null},void 0!==P&&P||(O.KJUR=P={}),void 0!==P.crypto&&P.crypto||(P.crypto={}),P.crypto.ECParameterDB=new function(){var c={},u={};function d(f){return new ae(f,16)}this.getByName=function(f){var p=f;if(void 0!==u[p]&&(p=u[f]),void 0!==c[p])return c[p];throw"unregistered EC curve name: "+p},this.regist=function(f,p,y,A,B,E,L,M,N,X,ue,pe){c[f]={};var _e=d(y),ve=d(A),I=d(B),$=d(E),Y=d(L),W=new Gi(_e,ve,I),ye=W.decodePointHex("04"+M+N);c[f].name=f,c[f].keylen=p,c[f].curve=W,c[f].G=ye,c[f].n=$,c[f].h=Y,c[f].oid=ue,c[f].info=pe;for(var we=0;we<X.length;we++)u[X[we]]=f}},P.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),P.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),P.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),P.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),P.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),P.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),P.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),P.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),P.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),P.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var Cn=function(){var c=function(L,M,N){return u(oe.AES,L,M,N)},u=function(L,M,N,X){var ue=oe.enc.Hex.parse(M),pe=oe.enc.Hex.parse(N),_e=oe.enc.Hex.parse(X),ve={};ve.key=pe,ve.iv=_e,ve.ciphertext=ue;var I=L.decrypt(ve,pe,{iv:_e});return oe.enc.Hex.stringify(I)},d=function(L,M,N){return f(oe.AES,L,M,N)},f=function(L,M,N,X){var ue=oe.enc.Hex.parse(M),pe=oe.enc.Hex.parse(N),_e=oe.enc.Hex.parse(X),ve=L.encrypt(ue,pe,{iv:_e}),I=oe.enc.Hex.parse(ve.toString());return oe.enc.Base64.stringify(I)},p={"AES-256-CBC":{proc:c,eproc:d,keylen:32,ivlen:16},"AES-192-CBC":{proc:c,eproc:d,keylen:24,ivlen:16},"AES-128-CBC":{proc:c,eproc:d,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(L,M,N){return u(oe.TripleDES,L,M,N)},eproc:function(L,M,N){return f(oe.TripleDES,L,M,N)},keylen:24,ivlen:8},"DES-CBC":{proc:function(L,M,N){return u(oe.DES,L,M,N)},eproc:function(L,M,N){return f(oe.DES,L,M,N)},keylen:8,ivlen:8}},y=function(L){var M={},N=L.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));N&&(M.cipher=N[1],M.ivsalt=N[2]);var X=L.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));X&&(M.type=X[1]);var ue=-1,pe=0;-1!=L.indexOf("\r\n\r\n")&&(ue=L.indexOf("\r\n\r\n"),pe=2),-1!=L.indexOf("\n\n")&&(ue=L.indexOf("\n\n"),pe=1);var _e=L.indexOf("-----END");if(-1!=ue&&-1!=_e){var ve=L.substring(ue+2*pe,_e-pe);ve=ve.replace(/\s+/g,""),M.data=ve}return M},A=function(L,M,N){for(var X=N.substring(0,16),ue=oe.enc.Hex.parse(X),pe=oe.enc.Utf8.parse(M),_e=p[L].keylen+p[L].ivlen,ve="",I=null;;){var $=oe.algo.MD5.create();if(null!=I&&$.update(I),$.update(pe),$.update(ue),I=$.finalize(),(ve+=oe.enc.Hex.stringify(I)).length>=2*_e)break}var Y={};return Y.keyhex=ve.substr(0,2*p[L].keylen),Y.ivhex=ve.substr(2*p[L].keylen,2*p[L].ivlen),Y},B=function(L,M,N,X){var ue=oe.enc.Base64.parse(L),pe=oe.enc.Hex.stringify(ue);return(0,p[M].proc)(pe,N,X)};return{version:"1.0.0",parsePKCS5PEM:function(L){return y(L)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(L,M,N){return A(L,M,N)},decryptKeyB64:function(L,M,N,X){return B(L,M,N,X)},getDecryptedKeyHex:function(L,M){var N=y(L),X=N.cipher,ue=N.ivsalt,pe=N.data,_e=A(X,M,ue).keyhex;return B(pe,X,_e,ue)},getEncryptedPKCS5PEMFromPrvKeyHex:function(L,M,N,X,ue){var I,$,pe="";if(void 0!==X&&null!=X||(X="AES-256-CBC"),void 0===p[X])throw"KEYUTIL unsupported algorithm: "+X;void 0!==ue&&null!=ue||(ue=(I=p[X].ivlen,$=oe.lib.WordArray.random(I),oe.enc.Hex.stringify($)).toUpperCase());var _e=function(I,$,Y,W){return(0,p[$].eproc)(I,Y,W)}(M,X,A(X,N,ue).keyhex,ue);return pe="-----BEGIN "+L+" PRIVATE KEY-----\r\n",pe+="Proc-Type: 4,ENCRYPTED\r\n",pe+="DEK-Info: "+X+","+ue+"\r\n",pe+="\r\n",(pe+=_e.replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+L+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(L){var N=Le.getChildIdx,X=Le.getV,ue={},pe=N(L,0);if(2!=pe.length)throw"malformed format: SEQUENCE(0).items != 2: "+pe.length;ue.ciphertext=X(L,pe[1]);var _e=N(L,pe[0]);if(2!=_e.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+_e.length;if("2a864886f70d01050d"!=X(L,_e[0]))throw"this only supports pkcs5PBES2";var ve=N(L,_e[1]);if(2!=_e.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+ve.length;var I=N(L,ve[1]);if(2!=I.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+I.length;if("2a864886f70d0307"!=X(L,I[0]))throw"this only supports TripleDES";ue.encryptionSchemeAlg="TripleDES",ue.encryptionSchemeIV=X(L,I[1]);var $=N(L,ve[0]);if(2!=$.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+$.length;if("2a864886f70d01050c"!=X(L,$[0]))throw"this only supports pkcs5PBKDF2";var Y=N(L,$[1]);if(Y.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+Y.length;ue.pbkdf2Salt=X(L,Y[0]);var W=X(L,Y[1]);try{ue.pbkdf2Iter=parseInt(W,16)}catch{throw"malformed format pbkdf2Iter: "+W}return ue},getPBKDF2KeyHexFromParam:function(L,M){var N=oe.enc.Hex.parse(L.pbkdf2Salt),ue=oe.PBKDF2(M,N,{keySize:6,iterations:L.pbkdf2Iter});return oe.enc.Hex.stringify(ue)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(L,M){var N=ui(L,"ENCRYPTED PRIVATE KEY"),X=this.parseHexOfEncryptedPKCS8(N),ue=Cn.getPBKDF2KeyHexFromParam(X,M),pe={};pe.ciphertext=oe.enc.Hex.parse(X.ciphertext);var _e=oe.enc.Hex.parse(ue),ve=oe.enc.Hex.parse(X.encryptionSchemeIV),I=oe.TripleDES.decrypt(pe,_e,{iv:ve});return oe.enc.Hex.stringify(I)},getKeyFromEncryptedPKCS8PEM:function(L,M){var N=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(L,M);return this.getKeyFromPlainPrivatePKCS8Hex(N)},parsePlainPrivatePKCS8Hex:function(L){var M=Le,N=M.getChildIdx,X=M.getV,ue={algparam:null};if("30"!=L.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var pe=N(L,0);if(3!=pe.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=L.substr(pe[1],2))throw"malformed PKCS8 private key(code:003)";var _e=N(L,pe[1]);if(2!=_e.length)throw"malformed PKCS8 private key(code:004)";if("06"!=L.substr(_e[0],2))throw"malformed PKCS8 private key(code:005)";if(ue.algoid=X(L,_e[0]),"06"==L.substr(_e[1],2)&&(ue.algparam=X(L,_e[1])),"04"!=L.substr(pe[2],2))throw"malformed PKCS8 private key(code:006)";return ue.keyidx=M.getVidx(L,pe[2]),ue},getKeyFromPlainPrivatePKCS8PEM:function(L){var M=ui(L,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(M)},getKeyFromPlainPrivatePKCS8Hex:function(L){var M,N=this.parsePlainPrivatePKCS8Hex(L);if("2a864886f70d010101"==N.algoid)M=new it;else if("2a8648ce380401"==N.algoid)M=new P.crypto.DSA;else{if("2a8648ce3d0201"!=N.algoid)throw"unsupported private key algorithm";M=new P.crypto.ECDSA}return M.readPKCS8PrvKeyHex(L),M},_getKeyFromPublicPKCS8Hex:function(L){var M,N=Le.getVbyList(L,0,[0,0],"06");if("2a864886f70d010101"===N)M=new it;else if("2a8648ce380401"===N)M=new P.crypto.DSA;else{if("2a8648ce3d0201"!==N)throw"unsupported PKCS#8 public key hex";M=new P.crypto.ECDSA}return M.readPKCS8PubKeyHex(L),M},parsePublicRawRSAKeyHex:function(L){var N=Le.getChildIdx,X=Le.getV,ue={};if("30"!=L.substr(0,2))throw"malformed RSA key(code:001)";var pe=N(L,0);if(2!=pe.length)throw"malformed RSA key(code:002)";if("02"!=L.substr(pe[0],2))throw"malformed RSA key(code:003)";if(ue.n=X(L,pe[0]),"02"!=L.substr(pe[1],2))throw"malformed RSA key(code:004)";return ue.e=X(L,pe[1]),ue},parsePublicPKCS8Hex:function(L){var M=Le,N=M.getChildIdx,X=M.getV,ue={algparam:null},pe=N(L,0);if(2!=pe.length)throw"outer DERSequence shall have 2 elements: "+pe.length;var _e=pe[0];if("30"!=L.substr(_e,2))throw"malformed PKCS8 public key(code:001)";var ve=N(L,_e);if(2!=ve.length)throw"malformed PKCS8 public key(code:002)";if("06"!=L.substr(ve[0],2))throw"malformed PKCS8 public key(code:003)";if(ue.algoid=X(L,ve[0]),"06"==L.substr(ve[1],2)?ue.algparam=X(L,ve[1]):"30"==L.substr(ve[1],2)&&(ue.algparam={},ue.algparam.p=M.getVbyList(L,ve[1],[0],"02"),ue.algparam.q=M.getVbyList(L,ve[1],[1],"02"),ue.algparam.g=M.getVbyList(L,ve[1],[2],"02")),"03"!=L.substr(pe[1],2))throw"malformed PKCS8 public key(code:004)";return ue.key=X(L,pe[1]).substr(2),ue}}}();Cn.getKey=function(c,u,d){var nt,f=(ve=Le).getChildIdx,p=ve.getVbyList,y=P.crypto,A=y.ECDSA,B=y.DSA,E=it,L=ui,M=Cn;if(void 0!==E&&c instanceof E||void 0!==A&&c instanceof A||void 0!==B&&c instanceof B)return c;if(void 0!==c.curve&&void 0!==c.xy&&void 0===c.d)return new A({pub:c.xy,curve:c.curve});if(void 0!==c.curve&&void 0!==c.d)return new A({prv:c.d,curve:c.curve});if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0===c.d)return(et=new E).setPublic(c.n,c.e),et;if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0!==c.p&&void 0!==c.q&&void 0!==c.dp&&void 0!==c.dq&&void 0!==c.co&&void 0===c.qi)return(et=new E).setPrivateEx(c.n,c.e,c.d,c.p,c.q,c.dp,c.dq,c.co),et;if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0===c.p)return(et=new E).setPrivate(c.n,c.e,c.d),et;if(void 0!==c.p&&void 0!==c.q&&void 0!==c.g&&void 0!==c.y&&void 0===c.x)return(et=new B).setPublic(c.p,c.q,c.g,c.y),et;if(void 0!==c.p&&void 0!==c.q&&void 0!==c.g&&void 0!==c.y&&void 0!==c.x)return(et=new B).setPrivate(c.p,c.q,c.g,c.y,c.x),et;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0===c.d)return(et=new E).setPublic(Yt(c.n),Yt(c.e)),et;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0!==c.p&&void 0!==c.q&&void 0!==c.dp&&void 0!==c.dq&&void 0!==c.qi)return(et=new E).setPrivateEx(Yt(c.n),Yt(c.e),Yt(c.d),Yt(c.p),Yt(c.q),Yt(c.dp),Yt(c.dq),Yt(c.qi)),et;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d)return(et=new E).setPrivate(Yt(c.n),Yt(c.e),Yt(c.d)),et;if("EC"===c.kty&&void 0!==c.crv&&void 0!==c.x&&void 0!==c.y&&void 0===c.d){var N=(qe=new A({curve:c.crv})).ecparams.keylen/4,X="04"+("0000000000"+Yt(c.x)).slice(-N)+("0000000000"+Yt(c.y)).slice(-N);return qe.setPublicKeyHex(X),qe}if("EC"===c.kty&&void 0!==c.crv&&void 0!==c.x&&void 0!==c.y&&void 0!==c.d){N=(qe=new A({curve:c.crv})).ecparams.keylen/4,X="04"+("0000000000"+Yt(c.x)).slice(-N)+("0000000000"+Yt(c.y)).slice(-N);var ue=("0000000000"+Yt(c.d)).slice(-N);return qe.setPublicKeyHex(X),qe.setPrivateKeyHex(ue),qe}if("pkcs5prv"===d){var pe,_e=c,ve=Le;if(9===(pe=f(_e,0)).length)(et=new E).readPKCS5PrvKeyHex(_e);else if(6===pe.length)(et=new B).readPKCS5PrvKeyHex(_e);else{if(!(pe.length>2&&"04"===_e.substr(pe[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(et=new A).readPKCS5PrvKeyHex(_e)}return et}if("pkcs8prv"===d)return M.getKeyFromPlainPrivatePKCS8Hex(c);if("pkcs8pub"===d)return M._getKeyFromPublicPKCS8Hex(c);if("x509pub"===d)return En.getPublicKeyFromCertHex(c);if(-1!=c.indexOf("-END CERTIFICATE-",0)||-1!=c.indexOf("-END X509 CERTIFICATE-",0)||-1!=c.indexOf("-END TRUSTED CERTIFICATE-",0))return En.getPublicKeyFromCertPEM(c);if(-1!=c.indexOf("-END PUBLIC KEY-")){var I=ui(c,"PUBLIC KEY");return M._getKeyFromPublicPKCS8Hex(I)}if(-1!=c.indexOf("-END RSA PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED")){var $=L(c,"RSA PRIVATE KEY");return M.getKey($,null,"pkcs5prv")}if(-1!=c.indexOf("-END DSA PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED")){var Y=p(nt=L(c,"DSA PRIVATE KEY"),0,[1],"02"),W=p(nt,0,[2],"02"),ye=p(nt,0,[3],"02"),we=p(nt,0,[4],"02"),Ke=p(nt,0,[5],"02");return(et=new B).setPrivate(new ae(Y,16),new ae(W,16),new ae(ye,16),new ae(we,16),new ae(Ke,16)),et}if(-1!=c.indexOf("-END EC PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED"))return $=L(c,"EC PRIVATE KEY"),M.getKey($,null,"pkcs5prv");if(-1!=c.indexOf("-END PRIVATE KEY-"))return M.getKeyFromPlainPrivatePKCS8PEM(c);if(-1!=c.indexOf("-END RSA PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED")){var ke=M.getDecryptedKeyHex(c,u),_t=new it;return _t.readPKCS5PrvKeyHex(ke),_t}if(-1!=c.indexOf("-END EC PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED")){var qe,et=p(nt=M.getDecryptedKeyHex(c,u),0,[1],"04"),Xt=p(nt,0,[2,0],"06"),St=p(nt,0,[3,0],"03").substr(2);if(void 0===P.crypto.OID.oidhex2name[Xt])throw"undefined OID(hex) in KJUR.crypto.OID: "+Xt;return(qe=new A({curve:P.crypto.OID.oidhex2name[Xt]})).setPublicKeyHex(St),qe.setPrivateKeyHex(et),qe.isPublic=!1,qe}if(-1!=c.indexOf("-END DSA PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED"))return Y=p(nt=M.getDecryptedKeyHex(c,u),0,[1],"02"),W=p(nt,0,[2],"02"),ye=p(nt,0,[3],"02"),we=p(nt,0,[4],"02"),Ke=p(nt,0,[5],"02"),(et=new B).setPrivate(new ae(Y,16),new ae(W,16),new ae(ye,16),new ae(we,16),new ae(Ke,16)),et;if(-1!=c.indexOf("-END ENCRYPTED PRIVATE KEY-"))return M.getKeyFromEncryptedPKCS8PEM(c,u);throw new Error("not supported argument")},Cn.generateKeypair=function(c,u){if("RSA"==c){var d=u;(A=new it).generate(d,"10001"),A.isPrivate=!0,A.isPublic=!0;var f=new it,p=A.n.toString(16),y=A.e.toString(16);return f.setPublic(p,y),f.isPrivate=!1,f.isPublic=!0,(B={}).prvKeyObj=A,B.pubKeyObj=f,B}if("EC"==c){var A,B,E=u,L=new P.crypto.ECDSA({curve:E}).generateKeyPairHex();return(A=new P.crypto.ECDSA({curve:E})).setPublicKeyHex(L.ecpubhex),A.setPrivateKeyHex(L.ecprvhex),A.isPrivate=!0,A.isPublic=!1,(f=new P.crypto.ECDSA({curve:E})).setPublicKeyHex(L.ecpubhex),f.isPrivate=!1,f.isPublic=!0,(B={}).prvKeyObj=A,B.pubKeyObj=f,B}throw"unknown algorithm: "+c},Cn.getPEM=function(c,u,d,f,p,y){var B=P.asn1,E=B.DERObjectIdentifier,L=B.DERInteger,M=B.ASN1Util.newObject,X=P.crypto,ue=X.DSA,pe=X.ECDSA,_e=it;function ve(qe){return M({seq:[{int:0},{int:{bigint:qe.n}},{int:qe.e},{int:{bigint:qe.d}},{int:{bigint:qe.p}},{int:{bigint:qe.q}},{int:{bigint:qe.dmp1}},{int:{bigint:qe.dmq1}},{int:{bigint:qe.coeff}}]})}function I(qe){return M({seq:[{int:1},{octstr:{hex:qe.prvKeyHex}},{tag:["a0",!0,{oid:{name:qe.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+qe.pubKeyHex}}]}]})}function $(qe){return M({seq:[{int:0},{int:{bigint:qe.p}},{int:{bigint:qe.q}},{int:{bigint:qe.g}},{int:{bigint:qe.y}},{int:{bigint:qe.x}}]})}if((void 0!==_e&&c instanceof _e||void 0!==ue&&c instanceof ue||void 0!==pe&&c instanceof pe)&&1==c.isPublic&&(void 0===u||"PKCS8PUB"==u))return rr(we=new(0,B.x509.SubjectPublicKeyInfo)(c).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==u&&void 0!==_e&&c instanceof _e&&(void 0===d||null==d)&&1==c.isPrivate)return rr(we=ve(c).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==u&&void 0!==pe&&c instanceof pe&&(void 0===d||null==d)&&1==c.isPrivate){var Y=new E({name:c.curveName}).getEncodedHex(),W=I(c).getEncodedHex(),ye="";return(ye+=rr(Y,"EC PARAMETERS"))+rr(W,"EC PRIVATE KEY")}if("PKCS1PRV"==u&&void 0!==ue&&c instanceof ue&&(void 0===d||null==d)&&1==c.isPrivate)return rr(we=$(c).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==u&&void 0!==_e&&c instanceof _e&&void 0!==d&&null!=d&&1==c.isPrivate){var we=ve(c).getEncodedHex();return void 0===f&&(f="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",we,d,f,y)}if("PKCS5PRV"==u&&void 0!==pe&&c instanceof pe&&void 0!==d&&null!=d&&1==c.isPrivate)return we=I(c).getEncodedHex(),void 0===f&&(f="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",we,d,f,y);if("PKCS5PRV"==u&&void 0!==ue&&c instanceof ue&&void 0!==d&&null!=d&&1==c.isPrivate)return we=$(c).getEncodedHex(),void 0===f&&(f="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",we,d,f,y);var Ke=function(et,Xt){var St=ke(et,Xt);return new M({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:St.pbkdf2Salt}},{int:St.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:St.encryptionSchemeIV}}]}]}]},{octstr:{hex:St.ciphertext}}]}).getEncodedHex()},ke=function(et,Xt){var St=oe.lib.WordArray.random(8),nt=oe.lib.WordArray.random(8),_r=oe.PBKDF2(Xt,St,{keySize:6,iterations:100}),Xn=oe.enc.Hex.parse(et),ir=oe.TripleDES.encrypt(Xn,_r,{iv:nt})+"",Ve={};return Ve.ciphertext=ir,Ve.pbkdf2Salt=oe.enc.Hex.stringify(St),Ve.pbkdf2Iter=100,Ve.encryptionSchemeAlg="DES-EDE3-CBC",Ve.encryptionSchemeIV=oe.enc.Hex.stringify(nt),Ve};if("PKCS8PRV"==u&&null!=_e&&c instanceof _e&&1==c.isPrivate){var _t=ve(c).getEncodedHex();return we=M({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:_t}}]}).getEncodedHex(),void 0===d||null==d?rr(we,"PRIVATE KEY"):rr(W=Ke(we,d),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==u&&void 0!==pe&&c instanceof pe&&1==c.isPrivate)return _t=new M({seq:[{int:1},{octstr:{hex:c.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+c.pubKeyHex}}]}]}).getEncodedHex(),we=M({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:c.curveName}}]},{octstr:{hex:_t}}]}).getEncodedHex(),void 0===d||null==d?rr(we,"PRIVATE KEY"):rr(W=Ke(we,d),"ENCRYPTED PRIVATE KEY");if("PKCS8PRV"==u&&void 0!==ue&&c instanceof ue&&1==c.isPrivate)return _t=new L({bigint:c.x}).getEncodedHex(),we=M({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:c.p}},{int:{bigint:c.q}},{int:{bigint:c.g}}]}]},{octstr:{hex:_t}}]}).getEncodedHex(),void 0===d||null==d?rr(we,"PRIVATE KEY"):rr(W=Ke(we,d),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},Cn.getKeyFromCSRPEM=function(c){var u=ui(c,"CERTIFICATE REQUEST");return Cn.getKeyFromCSRHex(u)},Cn.getKeyFromCSRHex=function(c){var u=Cn.parseCSRHex(c);return Cn.getKey(u.p8pubkeyhex,null,"pkcs8pub")},Cn.parseCSRHex=function(c){var d=Le.getChildIdx,f=Le.getTLV,p={},y=c;if("30"!=y.substr(0,2))throw"malformed CSR(code:001)";var A=d(y,0);if(A.length<1)throw"malformed CSR(code:002)";if("30"!=y.substr(A[0],2))throw"malformed CSR(code:003)";var B=d(y,A[0]);if(B.length<3)throw"malformed CSR(code:004)";return p.p8pubkeyhex=f(y,B[2]),p},Cn.getKeyID=function(c){var u=Cn,d=Le;"string"==typeof c&&-1!=c.indexOf("BEGIN ")&&(c=u.getKey(c));var f=ui(u.getPEM(c)),p=d.getIdxbyList(f,0,[1]),y=d.getV(f,p).substring(2);return P.crypto.Util.hashHex(y,"sha1")},Cn.getJWKFromKey=function(c){var u={};if(c instanceof it&&c.isPrivate)return u.kty="RSA",u.n=wn(c.n.toString(16)),u.e=wn(c.e.toString(16)),u.d=wn(c.d.toString(16)),u.p=wn(c.p.toString(16)),u.q=wn(c.q.toString(16)),u.dp=wn(c.dmp1.toString(16)),u.dq=wn(c.dmq1.toString(16)),u.qi=wn(c.coeff.toString(16)),u;if(c instanceof it&&c.isPublic)return u.kty="RSA",u.n=wn(c.n.toString(16)),u.e=wn(c.e.toString(16)),u;if(c instanceof P.crypto.ECDSA&&c.isPrivate){if("P-256"!==(f=c.getShortNISTPCurveName())&&"P-384"!==f)throw"unsupported curve name for JWT: "+f;var d=c.getPublicKeyXYHex();return u.kty="EC",u.crv=f,u.x=wn(d.x),u.y=wn(d.y),u.d=wn(c.prvKeyHex),u}if(c instanceof P.crypto.ECDSA&&c.isPublic){var f;if("P-256"!==(f=c.getShortNISTPCurveName())&&"P-384"!==f)throw"unsupported curve name for JWT: "+f;return d=c.getPublicKeyXYHex(),u.kty="EC",u.crv=f,u.x=wn(d.x),u.y=wn(d.y),u}throw"not supported key object"},it.getPosArrayOfChildrenFromHex=function(c){return Le.getChildIdx(c,0)},it.getHexValueArrayOfChildrenFromHex=function(c){var u,d=Le.getV,f=d(c,(u=it.getPosArrayOfChildrenFromHex(c))[0]),p=d(c,u[1]),y=d(c,u[2]),A=d(c,u[3]),B=d(c,u[4]),E=d(c,u[5]),L=d(c,u[6]),M=d(c,u[7]),N=d(c,u[8]);return(u=new Array).push(f,p,y,A,B,E,L,M,N),u},it.prototype.readPrivateKeyFromPEMString=function(c){var u=ui(c),d=it.getHexValueArrayOfChildrenFromHex(u);this.setPrivateEx(d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},it.prototype.readPKCS5PrvKeyHex=function(c){var u=it.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8])},it.prototype.readPKCS8PrvKeyHex=function(c){var u,d,f,p,y,A,B,E,M=Le.getVbyListEx;if(!1===Le.isASN1HEX(c))throw new Error("not ASN.1 hex string");try{u=M(c,0,[2,0,1],"02"),d=M(c,0,[2,0,2],"02"),f=M(c,0,[2,0,3],"02"),p=M(c,0,[2,0,4],"02"),y=M(c,0,[2,0,5],"02"),A=M(c,0,[2,0,6],"02"),B=M(c,0,[2,0,7],"02"),E=M(c,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(u,d,f,p,y,A,B,E)},it.prototype.readPKCS5PubKeyHex=function(c){var u=Le,d=u.getV;if(!1===u.isASN1HEX(c))throw new Error("keyHex is not ASN.1 hex string");var f=u.getChildIdx(c,0);if(2!==f.length||"02"!==c.substr(f[0],2)||"02"!==c.substr(f[1],2))throw new Error("wrong hex for PKCS#5 public key");var p=d(c,f[0]),y=d(c,f[1]);this.setPublic(p,y)},it.prototype.readPKCS8PubKeyHex=function(c){var u=Le;if(!1===u.isASN1HEX(c))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==u.getTLVbyListEx(c,0,[0,0]))throw new Error("not PKCS8 RSA public key");var d=u.getTLVbyListEx(c,0,[1,0]);this.readPKCS5PubKeyHex(d)},it.prototype.readCertPubKeyHex=function(c,u){var d,f;(d=new En).readCertHex(c),f=d.getPublicKeyHex(),this.readPKCS8PubKeyHex(f)};var rl=new RegExp("[^0-9a-f]","gi");function pu(c,u){for(var d="",f=u/4-c.length,p=0;p<f;p++)d+="0";return d+c}function il(c,u,d){for(var f="",p=0;f.length<u;)f+=vr(d(ai(c+String.fromCharCode.apply(String,[(4278190080&p)>>24,(16711680&p)>>16,(65280&p)>>8,255&p])))),p+=1;return f}function ol(c){for(var u in P.crypto.Util.DIGESTINFOHEAD){var d=P.crypto.Util.DIGESTINFOHEAD[u],f=d.length;if(c.substring(0,f)==d)return[u,c.substring(f)]}return[]}function En(c){var u,d=Le,f=d.getChildIdx,p=d.getV,y=d.getTLV,A=d.getVbyList,B=d.getVbyListEx,E=d.getTLVbyList,L=d.getTLVbyListEx,M=d.getIdxbyList,N=d.getIdxbyListEx,X=d.getVidx,ue=d.oidname,pe=d.hextooidstr,_e=En,ve=ui;try{u=P.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==E(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return B(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var I=L(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(I)},this.getAlgorithmIdentifierName=function(I){for(var $ in u)if(I===u[$])return $;return ue(B(I,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return E(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return _e.hex2dn(this.getIssuerHex())},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return E(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return _e.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var I=A(this.hex,0,[0,4+this.foffset,0]);return I=I.replace(/(..)/g,"%$1"),decodeURIComponent(I)},this.getNotAfter=function(){var I=A(this.hex,0,[0,4+this.foffset,1]);return I=I.replace(/(..)/g,"%$1"),decodeURIComponent(I)},this.getPublicKeyHex=function(){return d.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return M(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var I=this.getPublicKeyIdx();return M(this.hex,I,[1,0],"30")},this.getPublicKey=function(){return Cn.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var I=E(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(I)},this.getSignatureValueHex=function(){return A(this.hex,0,[2],"03",!0)},this.verifySignature=function(I){var $=this.getSignatureAlgorithmField(),Y=this.getSignatureValueHex(),W=E(this.hex,0,[0],"30"),ye=new P.crypto.Signature({alg:$});return ye.init(I),ye.updateHex(W),ye.verify(Y)},this.parseExt=function(I){var $,Y,W;if(void 0===I){if(3!==this.version)return-1;$=M(W=this.hex,0,[0,7,0],"30"),Y=f(W,$)}else{W=ui(I);var ye=M(W,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=p(W,ye))return void(this.aExtInfo=new Array);$=M(W,0,[0,3,0,1,0],"30"),Y=f(W,$),this.hex=W}this.aExtInfo=new Array;for(var we=0;we<Y.length;we++){var Ke={critical:!1},ke=0;3===f(W,Y[we]).length&&(Ke.critical=!0,ke=1),Ke.oid=d.hextooidstr(A(W,Y[we],[0],"06"));var _t=M(W,Y[we],[1+ke]);Ke.vidx=X(W,_t),this.aExtInfo.push(Ke)}},this.getExtInfo=function(I){var $=this.aExtInfo,Y=I;if(I.match(/^[0-9.]+$/)||(Y=P.asn1.x509.OID.name2oid(I)),""!==Y)for(var W=0;W<$.length;W++)if($[W].oid===Y)return $[W]},this.getExtBasicConstraints=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("basicConstraints");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"basicConstraints"};if($&&(W.critical=!0),"3000"===I)return W;if("30030101ff"===I)return W.cA=!0,W;if("30060101ff02"===I.substr(0,12)){var ye=p(I,10),we=parseInt(ye,16);return W.cA=!0,W.pathLen=we,W}throw new Error("hExtV parse error: "+I)},this.getExtKeyUsage=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("keyUsage");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"keyUsage"};return $&&(W.critical=!0),W.names=this.getExtKeyUsageString(I).split(","),W},this.getExtKeyUsageBin=function(I){if(void 0===I){var $=this.getExtInfo("keyUsage");if(void 0===$)return"";I=y(this.hex,$.vidx)}if(8!=I.length&&10!=I.length)throw new Error("malformed key usage value: "+I);var Y="000000000000000"+parseInt(I.substr(6),16).toString(2);return 8==I.length&&(Y=Y.slice(-8)),10==I.length&&(Y=Y.slice(-16)),""==(Y=Y.replace(/0+$/,""))&&(Y="0"),Y},this.getExtKeyUsageString=function(I){for(var $=this.getExtKeyUsageBin(I),Y=new Array,W=0;W<$.length;W++)"1"==$.substr(W,1)&&Y.push(En.KEYUSAGE_NAME[W]);return Y.join(",")},this.getExtSubjectKeyIdentifier=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("subjectKeyIdentifier");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"subjectKeyIdentifier"};$&&(W.critical=!0);var ye=p(I,0);return W.kid={hex:ye},W},this.getExtAuthorityKeyIdentifier=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("authorityKeyIdentifier");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"authorityKeyIdentifier"};$&&(W.critical=!0);for(var ye=f(I,0),we=0;we<ye.length;we++){var Ke=I.substr(ye[we],2);if("80"===Ke&&(W.kid={hex:p(I,ye[we])}),"a1"===Ke){var ke=y(I,ye[we]),_t=this.getGeneralNames(ke);W.issuer=_t[0].dn}"82"===Ke&&(W.sn={hex:p(I,ye[we])})}return W},this.getExtExtKeyUsage=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("extKeyUsage");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"extKeyUsage",array:[]};$&&(W.critical=!0);for(var ye=f(I,0),we=0;we<ye.length;we++)W.array.push(ue(p(I,ye[we])));return W},this.getExtExtKeyUsageName=function(){var I=this.getExtInfo("extKeyUsage");if(void 0===I)return I;var $=new Array,Y=y(this.hex,I.vidx);if(""===Y)return $;for(var W=f(Y,0),ye=0;ye<W.length;ye++)$.push(ue(p(Y,W[ye])));return $},this.getExtSubjectAltName=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("subjectAltName");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"subjectAltName",array:[]};return $&&(W.critical=!0),W.array=this.getGeneralNames(I),W},this.getExtIssuerAltName=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("issuerAltName");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"issuerAltName",array:[]};return $&&(W.critical=!0),W.array=this.getGeneralNames(I),W},this.getGeneralNames=function(I){for(var $=f(I,0),Y=[],W=0;W<$.length;W++){var ye=this.getGeneralName(y(I,$[W]));void 0!==ye&&Y.push(ye)}return Y},this.getGeneralName=function(I){var $=I.substr(0,2),Y=p(I,0),W=vr(Y);return"81"==$?{rfc822:W}:"82"==$?{dns:W}:"86"==$?{uri:W}:"87"==$?{ip:fu(Y)}:"a4"==$?{dn:this.getX500Name(Y)}:void 0},this.getExtSubjectAltName2=function(){var I,$,Y,W=this.getExtInfo("subjectAltName");if(void 0===W)return W;for(var ye=new Array,we=y(this.hex,W.vidx),Ke=f(we,0),ke=0;ke<Ke.length;ke++)Y=we.substr(Ke[ke],2),I=p(we,Ke[ke]),"81"===Y&&($=Zt(I),ye.push(["MAIL",$])),"82"===Y&&($=Zt(I),ye.push(["DNS",$])),"84"===Y&&($=En.hex2dn(I,0),ye.push(["DN",$])),"86"===Y&&($=Zt(I),ye.push(["URI",$])),"87"===Y&&($=fu(I),ye.push(["IP",$]));return ye},this.getExtCRLDistributionPoints=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("cRLDistributionPoints");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"cRLDistributionPoints",array:[]};$&&(W.critical=!0);for(var ye=f(I,0),we=0;we<ye.length;we++){var Ke=y(I,ye[we]);W.array.push(this.getDistributionPoint(Ke))}return W},this.getDistributionPoint=function(I){for(var $={},Y=f(I,0),W=0;W<Y.length;W++){var ye=I.substr(Y[W],2),we=y(I,Y[W]);"a0"==ye&&($.dpname=this.getDistributionPointName(we))}return $},this.getDistributionPointName=function(I){for(var $={},Y=f(I,0),W=0;W<Y.length;W++){var ye=I.substr(Y[W],2),we=y(I,Y[W]);"a0"==ye&&($.full=this.getGeneralNames(we))}return $},this.getExtCRLDistributionPointsURI=function(){var I=this.getExtInfo("cRLDistributionPoints");if(void 0===I)return I;for(var $=new Array,Y=f(this.hex,I.vidx),W=0;W<Y.length;W++)try{var ye=Zt(A(this.hex,Y[W],[0,0,0],"86"));$.push(ye)}catch{}return $},this.getExtAIAInfo=function(){var I=this.getExtInfo("authorityInfoAccess");if(void 0===I)return I;for(var $={ocsp:[],caissuer:[]},Y=f(this.hex,I.vidx),W=0;W<Y.length;W++){var ye=A(this.hex,Y[W],[0],"06"),we=A(this.hex,Y[W],[1],"86");"2b06010505073001"===ye&&$.ocsp.push(Zt(we)),"2b06010505073002"===ye&&$.caissuer.push(Zt(we))}return $},this.getExtAuthorityInfoAccess=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("authorityInfoAccess");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"authorityInfoAccess",array:[]};$&&(W.critical=!0);for(var ye=f(I,0),we=0;we<ye.length;we++){var Ke=B(I,ye[we],[0],"06"),ke=Zt(A(I,ye[we],[1],"86"));if("2b06010505073001"==Ke)W.array.push({ocsp:ke});else{if("2b06010505073002"!=Ke)throw new Error("unknown method: "+Ke);W.array.push({caissuer:ke})}}return W},this.getExtCertificatePolicies=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("certificatePolicies");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"certificatePolicies",array:[]};$&&(W.critical=!0);for(var ye=f(I,0),we=0;we<ye.length;we++){var Ke=y(I,ye[we]),ke=this.getPolicyInformation(Ke);W.array.push(ke)}return W},this.getPolicyInformation=function(I){var $={},Y=A(I,0,[0],"06");$.policyoid=ue(Y);var W=N(I,0,[1],"30");if(-1!=W){$.array=[];for(var ye=f(I,W),we=0;we<ye.length;we++){var Ke=y(I,ye[we]),ke=this.getPolicyQualifierInfo(Ke);$.array.push(ke)}}return $},this.getPolicyQualifierInfo=function(I){var $={},Y=A(I,0,[0],"06");if("2b06010505070201"===Y){var W=B(I,0,[1],"16");$.cps=vr(W)}else if("2b06010505070202"===Y){var ye=E(I,0,[1],"30");$.unotice=this.getUserNotice(ye)}return $},this.getUserNotice=function(I){for(var $={},Y=f(I,0),W=0;W<Y.length;W++){var ye=y(I,Y[W]);"30"!=ye.substr(0,2)&&($.exptext=this.getDisplayText(ye))}return $},this.getDisplayText=function(I){var $={};return $.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[I.substr(0,2)],$.str=vr(p(I,0)),$},this.getExtCRLNumber=function(I,$){var Y={extname:"cRLNumber"};if($&&(Y.critical=!0),"02"==I.substr(0,2))return Y.num={hex:p(I,0)},Y;throw new Error("hExtV parse error: "+I)},this.getExtCRLReason=function(I,$){var Y={extname:"cRLReason"};if($&&(Y.critical=!0),"0a"==I.substr(0,2))return Y.code=parseInt(p(I,0),16),Y;throw new Error("hExtV parse error: "+I)},this.getExtOcspNonce=function(I,$){var Y={extname:"ocspNonce"};$&&(Y.critical=!0);var W=p(I,0);return Y.hex=W,Y},this.getExtOcspNoCheck=function(I,$){var Y={extname:"ocspNoCheck"};return $&&(Y.critical=!0),Y},this.getExtAdobeTimeStamp=function(I,$){if(void 0===I&&void 0===$){var Y=this.getExtInfo("adobeTimeStamp");if(void 0===Y)return;I=y(this.hex,Y.vidx),$=Y.critical}var W={extname:"adobeTimeStamp"};$&&(W.critical=!0);var ye=f(I,0);if(ye.length>1){var we=y(I,ye[1]),Ke=this.getGeneralName(we);null!=Ke.uri&&(W.uri=Ke.uri)}if(ye.length>2){var ke=y(I,ye[2]);"0101ff"==ke&&(W.reqauth=!0),"010100"==ke&&(W.reqauth=!1)}return W},this.getX500NameRule=function(I){for(var $=null,Y=[],W=0;W<I.length;W++)for(var ye=I[W],we=0;we<ye.length;we++)Y.push(ye[we]);for(W=0;W<Y.length;W++){var Ke=Y[W],ke=Ke.ds,qe=Ke.type;if("prn"!=ke&&"utf8"!=ke&&"ia5"!=ke)return"mixed";if("ia5"==ke){if("CN"!=qe)return"mixed";if(P.lang.String.isMail(Ke.value))continue;return"mixed"}if("C"==qe){if("prn"==ke)continue;return"mixed"}if(null==$)$=ke;else if($!==ke)return"mixed"}return $??"prn"},this.getX500Name=function(I){var $=this.getX500NameArray(I);return{array:$,str:this.dnarraytostr($)}},this.getX500NameArray=function(I){for(var $=[],Y=f(I,0),W=0;W<Y.length;W++)$.push(this.getRDN(y(I,Y[W])));return $},this.getRDN=function(I){for(var $=[],Y=f(I,0),W=0;W<Y.length;W++)$.push(this.getAttrTypeAndValue(y(I,Y[W])));return $},this.getAttrTypeAndValue=function(I){var $={type:null,value:null,ds:null},Y=f(I,0),W=A(I,Y[0],[],"06"),ye=A(I,Y[1],[]),we=P.asn1.ASN1Util.oidHexToInt(W);return $.type=P.asn1.x509.OID.oid2atype(we),$.value=vr(ye),$.ds=this.HEX2STAG[I.substr(Y[1],2)],$},this.readCertPEM=function(I){this.readCertHex(ve(I))},this.readCertHex=function(I){this.hex=I,this.getVersion();try{M(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(){var I={};return I.version=this.getVersion(),I.serial={hex:this.getSerialNumberHex()},I.sigalg=this.getSignatureAlgorithmField(),I.issuer=this.getIssuer(),I.notbefore=this.getNotBefore(),I.notafter=this.getNotAfter(),I.subject=this.getSubject(),I.sbjpubkey=rr(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(I.ext=this.getExtParamArray()),I.sighex=this.getSignatureValueHex(),I},this.getExtParamArray=function(I){null==I&&-1!=N(this.hex,0,[0,"[3]"])&&(I=L(this.hex,0,[0,"[3]",0],"30"));for(var $=[],Y=f(I,0),W=0;W<Y.length;W++){var ye=y(I,Y[W]),we=this.getExtParam(ye);null!=we&&$.push(we)}return $},this.getExtParam=function(I){var $=f(I,0).length;if(2!=$&&3!=$)throw new Error("wrong number elements in Extension: "+$+" "+I);var Y=pe(A(I,0,[0],"06")),W=!1;3==$&&"0101ff"==E(I,0,[1])&&(W=!0);var ye=E(I,0,[$-1,0]),we=void 0;if("2.5.29.14"==Y?we=this.getExtSubjectKeyIdentifier(ye,W):"2.5.29.15"==Y?we=this.getExtKeyUsage(ye,W):"2.5.29.17"==Y?we=this.getExtSubjectAltName(ye,W):"2.5.29.18"==Y?we=this.getExtIssuerAltName(ye,W):"2.5.29.19"==Y?we=this.getExtBasicConstraints(ye,W):"2.5.29.31"==Y?we=this.getExtCRLDistributionPoints(ye,W):"2.5.29.32"==Y?we=this.getExtCertificatePolicies(ye,W):"2.5.29.35"==Y?we=this.getExtAuthorityKeyIdentifier(ye,W):"2.5.29.37"==Y?we=this.getExtExtKeyUsage(ye,W):"1.3.6.1.5.5.7.1.1"==Y?we=this.getExtAuthorityInfoAccess(ye,W):"2.5.29.20"==Y?we=this.getExtCRLNumber(ye,W):"2.5.29.21"==Y?we=this.getExtCRLReason(ye,W):"1.3.6.1.5.5.7.48.1.2"==Y?we=this.getExtOcspNonce(ye,W):"1.3.6.1.5.5.7.48.1.5"==Y?we=this.getExtOcspNoCheck(ye,W):"1.2.840.113583.1.1.9.1"==Y&&(we=this.getExtAdobeTimeStamp(ye,W)),null!=we)return we;var Ke={extname:Y,extn:ye};return W&&(Ke.critical=!0),Ke},this.findExt=function(I,$){for(var Y=0;Y<I.length;Y++)if(I[Y].extname==$)return I[Y];return null},this.updateExtCDPFullURI=function(I,$){var Y=this.findExt(I,"cRLDistributionPoints");if(null!=Y&&null!=Y.array)for(var W=Y.array,ye=0;ye<W.length;ye++)if(null!=W[ye].dpname&&null!=W[ye].dpname.full)for(var we=W[ye].dpname.full,Ke=0;Ke<we.length;Ke++){var ke=we[ye];null!=ke.uri&&(ke.uri=$)}},this.updateExtAIAOCSP=function(I,$){var Y=this.findExt(I,"authorityInfoAccess");if(null!=Y&&null!=Y.array)for(var W=Y.array,ye=0;ye<W.length;ye++)null!=W[ye].ocsp&&(W[ye].ocsp=$)},this.updateExtAIACAIssuer=function(I,$){var Y=this.findExt(I,"authorityInfoAccess");if(null!=Y&&null!=Y.array)for(var W=Y.array,ye=0;ye<W.length;ye++)null!=W[ye].caissuer&&(W[ye].caissuer=$)},this.dnarraytostr=function(I){return"/"+I.map(function($){return $.map(function(ye){return(Ke=ye).type+"="+Ke.value;var Ke}).join("+")}).join("/")},this.getInfo=function(){var I,$,Y,_r,ye=function(_r){for(var Xn="",ir=_r.array,Ve=0;Ve<ir.length;Ve++){var Pn=ir[Ve];if(Xn+="    policy oid: "+Pn.policyoid+"\n",void 0!==Pn.array)for(var Bt=0;Bt<Pn.array.length;Bt++){var kn=Pn.array[Bt];void 0!==kn.cps&&(Xn+="    cps: "+kn.cps+"\n")}}return Xn},we=function(_r){for(var Xn="",ir=_r.array,Ve=0;Ve<ir.length;Ve++){var Pn=ir[Ve];try{void 0!==Pn.dpname.full[0].uri&&(Xn+="    "+Pn.dpname.full[0].uri+"\n")}catch{}try{void 0!==Pn.dname.full[0].dn.hex&&(Xn+="    "+En.hex2dn(Pn.dpname.full[0].dn.hex)+"\n")}catch{}}return Xn},Ke=function(_r){for(var Xn="",ir=_r.array,Ve=0;Ve<ir.length;Ve++){var Pn=ir[Ve];void 0!==Pn.caissuer&&(Xn+="    caissuer: "+Pn.caissuer+"\n"),void 0!==Pn.ocsp&&(Xn+="    ocsp: "+Pn.ocsp+"\n")}return Xn};if(I="Basic Fields\n",I+="  serial number: "+this.getSerialNumberHex()+"\n",I+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",I+="  issuer: "+this.getIssuerString()+"\n",I+="  notBefore: "+this.getNotBefore()+"\n",I+="  notAfter: "+this.getNotAfter()+"\n",I+="  subject: "+this.getSubjectString()+"\n",I+="  subject public key info: \n",I+="    key algorithm: "+($=this.getPublicKey()).type+"\n","RSA"===$.type&&(I+="    n="+Xs($.n.toString(16)).substr(0,16)+"...\n",I+="    e="+Xs($.e.toString(16))+"\n"),null!=(Y=this.aExtInfo)){I+="X509v3 Extensions:\n";for(var ke=0;ke<Y.length;ke++){var _t=Y[ke],qe=P.asn1.x509.OID.oid2name(_t.oid);""===qe&&(qe=_t.oid);var et="";if(!0===_t.critical&&(et="CRITICAL"),I+="  "+qe+" "+et+":\n","basicConstraints"===qe){var Xt=this.getExtBasicConstraints();void 0===Xt.cA?I+="    {}\n":(I+="    cA=true",void 0!==Xt.pathLen&&(I+=", pathLen="+Xt.pathLen),I+="\n")}else if("keyUsage"===qe)I+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===qe)I+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"===qe){var St=this.getExtAuthorityKeyIdentifier();void 0!==St.kid&&(I+="    kid="+St.kid.hex+"\n")}else"extKeyUsage"===qe?I+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"===qe?I+="    "+(_r=this.getExtSubjectAltName(),JSON.stringify(_r.array).replace(/[\[\]\{\}\"]/g,"")+"\n"):"cRLDistributionPoints"===qe?I+=we(this.getExtCRLDistributionPoints()):"authorityInfoAccess"===qe?I+=Ke(this.getExtAuthorityInfoAccess()):"certificatePolicies"===qe&&(I+=ye(this.getExtCertificatePolicies()))}}return(I+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof c&&(-1!=c.indexOf("-----BEGIN")?this.readCertPEM(c):P.lang.String.isHex(c)&&this.readCertHex(c))}it.prototype.sign=function(c,u){var d=function(p){return P.crypto.Util.hashString(p,u)}(c);return this.signWithMessageHash(d,u)},it.prototype.signWithMessageHash=function(c,u){var d=bn(P.crypto.Util.getPaddedDigestInfoHex(c,u,this.n.bitLength()),16);return pu(this.doPrivate(d).toString(16),this.n.bitLength())},it.prototype.signPSS=function(c,u,d){var y,f=(y=ai(c),P.crypto.Util.hashHex(y,u));return void 0===d&&(d=-1),this.signWithMessageHashPSS(f,u,d)},it.prototype.signWithMessageHashPSS=function(c,u,d){var f,p=vr(c),y=p.length,A=this.n.bitLength()-1,B=Math.ceil(A/8),E=function(I){return P.crypto.Util.hashHex(I,u)};if(-1===d||void 0===d)d=y;else if(-2===d)d=B-y-2;else if(d<-2)throw new Error("invalid salt length");if(B<y+d+2)throw new Error("data too long");var L="";d>0&&(L=new Array(d),(new Qn).nextBytes(L),L=String.fromCharCode.apply(String,L));var M=vr(E(ai("\0\0\0\0\0\0\0\0"+p+L))),N=[];for(f=0;f<B-d-y-2;f+=1)N[f]=0;var X=String.fromCharCode.apply(String,N)+"\x01"+L,ue=il(M,X.length,E),pe=[];for(f=0;f<X.length;f+=1)pe[f]=X.charCodeAt(f)^ue.charCodeAt(f);for(pe[0]&=~(65280>>8*B-A&255),f=0;f<y;f++)pe.push(M.charCodeAt(f));return pe.push(188),pu(this.doPrivate(new ae(pe)).toString(16),this.n.bitLength())},it.prototype.verify=function(c,u){var d=bn(u=(u=u.replace(rl,"")).replace(/[ \n]+/g,""),16);if(d.bitLength()>this.n.bitLength())return 0;var f=ol(this.doPublic(d).toString(16).replace(/^1f+00/,""));return 0!=f.length&&f[1]==P.crypto.Util.hashString(c,f[0])},it.prototype.verifyWithMessageHash=function(c,u){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var d=bn(u,16);if(d.bitLength()>this.n.bitLength())return 0;var f=ol(this.doPublic(d).toString(16).replace(/^1f+00/,""));return 0!=f.length&&f[1]==c},it.prototype.verifyPSS=function(c,u,d,f){var A,p=(A=ai(c),P.crypto.Util.hashHex(A,d));return void 0===f&&(f=-1),this.verifyWithMessageHashPSS(p,u,d,f)},it.prototype.verifyWithMessageHashPSS=function(c,u,d,f){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var p,y=new ae(u,16),A=function(Y){return P.crypto.Util.hashHex(Y,d)},B=vr(c),E=B.length,L=this.n.bitLength()-1,M=Math.ceil(L/8);if(-1===f||void 0===f)f=E;else if(-2===f)f=M-E-2;else if(f<-2)throw new Error("invalid salt length");if(M<E+f+2)throw new Error("data too long");var N=this.doPublic(y).toByteArray();for(p=0;p<N.length;p+=1)N[p]&=255;for(;N.length<M;)N.unshift(0);if(188!==N[M-1])throw new Error("encoded message does not end in 0xbc");var X=(N=String.fromCharCode.apply(String,N)).substr(0,M-E-1),ue=N.substr(X.length,E),pe=65280>>8*M-L&255;if(0!=(X.charCodeAt(0)&pe))throw new Error("bits beyond keysize not zero");var _e=il(ue,X.length,A),ve=[];for(p=0;p<X.length;p+=1)ve[p]=X.charCodeAt(p)^_e.charCodeAt(p);ve[0]&=~pe;var I=M-E-f-2;for(p=0;p<I;p+=1)if(0!==ve[p])throw new Error("leftmost octets not zero");if(1!==ve[I])throw new Error("0x01 marker not found");return ue===vr(A(ai("\0\0\0\0\0\0\0\0"+B+String.fromCharCode.apply(String,ve.slice(-f)))))},it.SALT_LEN_HLEN=-1,it.SALT_LEN_MAX=-2,it.SALT_LEN_RECOVER=-2,En.hex2dn=function(c,u){if(void 0===u&&(u=0),"30"!==c.substr(u,2))throw new Error("malformed DN");for(var d=new Array,f=Le.getChildIdx(c,u),p=0;p<f.length;p++)d.push(En.hex2rdn(c,f[p]));return"/"+(d=d.map(function(y){return y.replace("/","\\/")})).join("/")},En.hex2rdn=function(c,u){if(void 0===u&&(u=0),"31"!==c.substr(u,2))throw new Error("malformed RDN");for(var d=new Array,f=Le.getChildIdx(c,u),p=0;p<f.length;p++)d.push(En.hex2attrTypeValue(c,f[p]));return(d=d.map(function(y){return y.replace("+","\\+")})).join("+")},En.hex2attrTypeValue=function(c,u){var d=Le,f=d.getV;if(void 0===u&&(u=0),"30"!==c.substr(u,2))throw new Error("malformed attribute type and value");var p=d.getChildIdx(c,u);2!==p.length||c.substr(p[0],2);var y=f(c,p[0]),A=P.asn1.ASN1Util.oidHexToInt(y);return P.asn1.x509.OID.oid2atype(A)+"="+vr(f(c,p[1]))},En.getPublicKeyFromCertHex=function(c){var u=new En;return u.readCertHex(c),u.getPublicKey()},En.getPublicKeyFromCertPEM=function(c){var u=new En;return u.readCertPEM(c),u.getPublicKey()},En.getPublicKeyInfoPropOfCertPEM=function(c){var u,d,f=Le.getVbyList,p={algparam:null};return(u=new En).readCertPEM(c),d=u.getPublicKeyHex(),p.keyhex=f(d,0,[1],"03").substr(2),p.algoid=f(d,0,[0,0],"06"),"2a8648ce3d0201"===p.algoid&&(p.algparam=f(d,0,[0,1],"06")),p},En.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==P&&P||(O.KJUR=P={}),void 0!==P.jws&&P.jws||(P.jws={}),P.jws.JWS=function(){var c=P.jws.JWS.isSafeJSONString;this.parseJWS=function(u,d){if(void 0===this.parsedJWS||!d&&void 0===this.parsedJWS.sigvalH){var f=u.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==f)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var p=f[1],y=f[2],A=f[3],B=p+"."+y;if(this.parsedJWS={},this.parsedJWS.headB64U=p,this.parsedJWS.payloadB64U=y,this.parsedJWS.sigvalB64U=A,this.parsedJWS.si=B,!d){var E=Yt(A),L=bn(E,16);this.parsedJWS.sigvalH=E,this.parsedJWS.sigvalBI=L}var M=oi(p),N=oi(y);if(this.parsedJWS.headS=M,this.parsedJWS.payloadS=N,!c(M,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+M}}},P.jws.JWS.sign=function(c,u,d,f,p){var y,A,B,L=P.jws.JWS,M=L.readSafeJSONString,N=L.isSafeJSONString,X=P.crypto,ue=X.Mac,pe=X.Signature,_e=JSON;if("string"!=typeof u&&"object"!=(void 0===u?"undefined":x(u)))throw"spHeader must be JSON string or object: "+u;if("object"==(void 0===u?"undefined":x(u))&&(y=_e.stringify(A=u)),"string"==typeof u){if(!N(y=u))throw"JWS Head is not safe JSON string: "+y;A=M(y)}if(B=d,"object"==(void 0===d?"undefined":x(d))&&(B=_e.stringify(d)),""!=c&&null!=c||void 0===A.alg||(c=A.alg),""!=c&&null!=c&&void 0===A.alg&&(A.alg=c,y=_e.stringify(A)),c!==A.alg)throw"alg and sHeader.alg doesn't match: "+c+"!="+A.alg;var ve=null;if(void 0===L.jwsalg2sigalg[c])throw"unsupported alg name: "+c;ve=L.jwsalg2sigalg[c];var I=Ws(y)+"."+Ws(B),$="";if("Hmac"==ve.substr(0,4)){if(void 0===f)throw"mac key shall be specified for HS* alg";var Y=new ue({alg:ve,prov:"cryptojs",pass:f});Y.updateString(I),$=Y.doFinal()}else if(-1!=ve.indexOf("withECDSA")){(ye=new pe({alg:ve})).init(f,p),ye.updateString(I);var W=ye.sign();$=P.crypto.ECDSA.asn1SigToConcatSig(W)}else{var ye;"none"!=ve&&((ye=new pe({alg:ve})).init(f,p),ye.updateString(I),$=ye.sign())}return I+"."+wn($)},P.jws.JWS.verify=function(c,u,d){var f,y=P.jws.JWS,A=y.readSafeJSONString,B=P.crypto,E=B.ECDSA,L=B.Mac,M=B.Signature;void 0!==x(it)&&(f=it);var N=c.split(".");if(3!==N.length)return!1;var ve,X=N[0]+"."+N[1],ue=Yt(N[2]),pe=A(oi(N[0])),_e=null;if(void 0===pe.alg)throw"algorithm not specified in header";if(ve=(_e=pe.alg).substr(0,2),null!=d&&"[object Array]"===Object.prototype.toString.call(d)&&d.length>0&&-1==(":"+d.join(":")+":").indexOf(":"+_e+":"))throw"algorithm '"+_e+"' not accepted in the list";if("none"!=_e&&null===u)throw"key shall be specified to verify.";if("string"==typeof u&&-1!=u.indexOf("-----BEGIN ")&&(u=Cn.getKey(u)),!("RS"!=ve&&"PS"!=ve||u instanceof f))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==ve&&!(u instanceof E))throw"key shall be a ECDSA obj for ES* algs";var I=null;if(void 0===y.jwsalg2sigalg[pe.alg])throw"unsupported alg name: "+_e;if("none"==(I=y.jwsalg2sigalg[_e]))throw"not supported";if("Hmac"==I.substr(0,4)){if(void 0===u)throw"hexadecimal key shall be specified for HMAC";var $=new L({alg:I,pass:u});return $.updateString(X),ue==$.doFinal()}if(-1!=I.indexOf("withECDSA")){var Y,W=null;try{W=E.concatSigToASN1Sig(ue)}catch{return!1}return(Y=new M({alg:I})).init(u),Y.updateString(X),Y.verify(W)}return(Y=new M({alg:I})).init(u),Y.updateString(X),Y.verify(ue)},P.jws.JWS.parse=function(c){var d,f,p=c.split("."),y={};if(2!=p.length&&3!=p.length)throw"malformed sJWS: wrong number of '.' splitted elements";return d=p[1],3==p.length&&(f=p[2]),y.headerObj=P.jws.JWS.readSafeJSONString(oi(p[0])),y.payloadObj=P.jws.JWS.readSafeJSONString(oi(d)),y.headerPP=JSON.stringify(y.headerObj,null,"  "),y.payloadPP=null==y.payloadObj?oi(d):JSON.stringify(y.payloadObj,null,"  "),void 0!==f&&(y.sigHex=Yt(f)),y},P.jws.JWS.verifyJWT=function(c,u,d){var f=P.jws,p=f.JWS,y=p.readSafeJSONString,A=p.inArray,B=p.includedArray,E=c.split("."),L=E[0],M=E[1],N=(Yt(E[2]),y(oi(L))),X=y(oi(M));if(void 0===N.alg)return!1;if(void 0===d.alg)throw"acceptField.alg shall be specified";if(!A(N.alg,d.alg)||void 0!==X.iss&&"object"===x(d.iss)&&!A(X.iss,d.iss)||void 0!==X.sub&&"object"===x(d.sub)&&!A(X.sub,d.sub))return!1;if(void 0!==X.aud&&"object"===x(d.aud))if("string"==typeof X.aud){if(!A(X.aud,d.aud))return!1}else if("object"==x(X.aud)&&!B(X.aud,d.aud))return!1;var ue=f.IntDate.getNow();return void 0!==d.verifyAt&&"number"==typeof d.verifyAt&&(ue=d.verifyAt),void 0!==d.gracePeriod&&"number"==typeof d.gracePeriod||(d.gracePeriod=0),!(void 0!==X.exp&&"number"==typeof X.exp&&X.exp+d.gracePeriod<ue||void 0!==X.nbf&&"number"==typeof X.nbf&&ue<X.nbf-d.gracePeriod||void 0!==X.iat&&"number"==typeof X.iat&&ue<X.iat-d.gracePeriod||void 0!==X.jti&&void 0!==d.jti&&X.jti!==d.jti||!p.verify(c,u,d.alg))},P.jws.JWS.includedArray=function(c,u){var d=P.jws.JWS.inArray;if(null===c||"object"!==(void 0===c?"undefined":x(c))||"number"!=typeof c.length)return!1;for(var f=0;f<c.length;f++)if(!d(c[f],u))return!1;return!0},P.jws.JWS.inArray=function(c,u){if(null===u||"object"!==(void 0===u?"undefined":x(u))||"number"!=typeof u.length)return!1;for(var d=0;d<u.length;d++)if(u[d]==c)return!0;return!1},P.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},P.jws.JWS.isSafeJSONString=function(c,u,d){var f=null;try{return"object"!=(void 0===(f=Wh(c))?"undefined":x(f))||f.constructor===Array?0:(u&&(u[d]=f),1)}catch{return 0}},P.jws.JWS.readSafeJSONString=function(c){var u=null;try{return"object"!=(void 0===(u=Wh(c))?"undefined":x(u))||u.constructor===Array?null:u}catch{return null}},P.jws.JWS.getEncodedSignatureValueFromJWS=function(c){var u=c.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==u)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return u[1]},P.jws.JWS.getJWKthumbprint=function(c){if("RSA"!==c.kty&&"EC"!==c.kty&&"oct"!==c.kty)throw"unsupported algorithm for JWK Thumprint";var u="{";if("RSA"===c.kty){if("string"!=typeof c.n||"string"!=typeof c.e)throw"wrong n and e value for RSA key";u+='"e":"'+c.e+'",',u+='"kty":"'+c.kty+'",',u+='"n":"'+c.n+'"}'}else if("EC"===c.kty){if("string"!=typeof c.crv||"string"!=typeof c.x||"string"!=typeof c.y)throw"wrong crv, x and y value for EC key";u+='"crv":"'+c.crv+'",',u+='"kty":"'+c.kty+'",',u+='"x":"'+c.x+'",',u+='"y":"'+c.y+'"}'}else if("oct"===c.kty){if("string"!=typeof c.k)throw"wrong k value for oct(symmetric) key";u+='"kty":"'+c.kty+'",',u+='"k":"'+c.k+'"}'}var d=ai(u);return wn(P.crypto.Util.hashHex(d,"sha256"))},P.jws.IntDate={},P.jws.IntDate.get=function(c){var u=P.jws.IntDate,d=u.getNow,f=u.getZulu;if("now"==c)return d();if("now + 1hour"==c)return d()+3600;if("now + 1day"==c)return d()+86400;if("now + 1month"==c)return d()+2592e3;if("now + 1year"==c)return d()+31536e3;if(c.match(/Z$/))return f(c);if(c.match(/^[0-9]+$/))return parseInt(c);throw"unsupported format: "+c},P.jws.IntDate.getZulu=function(c){return nl(c)},P.jws.IntDate.getNow=function(){return~~(new Date/1e3)},P.jws.IntDate.intDate2UTCString=function(c){return new Date(1e3*c).toUTCString()},P.jws.IntDate.intDate2Zulu=function(c){var u=new Date(1e3*c);return("0000"+u.getUTCFullYear()).slice(-4)+("00"+(u.getUTCMonth()+1)).slice(-2)+("00"+u.getUTCDate()).slice(-2)+("00"+u.getUTCHours()).slice(-2)+("00"+u.getUTCMinutes()).slice(-2)+("00"+u.getUTCSeconds()).slice(-2)+"Z"},O.SecureRandom=Qn,O.rng_seed_time=Ee,O.BigInteger=ae,O.RSAKey=it,O.EDSA=P.crypto.EDSA,O.DSA=P.crypto.DSA,O.Signature=P.crypto.Signature,O.MessageDigest=P.crypto.MessageDigest,O.Mac=P.crypto.Mac,O.Cipher=P.crypto.Cipher,O.KEYUTIL=Cn,O.ASN1HEX=Le,O.X509=En,O.CryptoJS=oe,O.b64tohex=Pe,O.b64toBA=Ue,O.stoBA=lu,O.BAtos=du,O.BAtohex=fs,O.stohex=si,O.stob64=function(u){return Te(si(u))},O.stob64u=function(u){return Js(Te(si(u)))},O.b64utos=function(u){return du(Ue(Ro(u)))},O.b64tob64u=Js,O.b64utob64=Ro,O.hex2b64=Te,O.hextob64u=wn,O.b64utohex=Yt,O.utf8tob64u=Ws,O.b64utoutf8=oi,O.utf8tob64=function(u){return Te(Sn(Zs(u)))},O.b64toutf8=function(u){return decodeURIComponent(Ci(Pe(u)))},O.utf8tohex=Ys,O.hextoutf8=Zt,O.hextorstr=vr,O.rstrtohex=ai,O.hextob64=el,O.hextob64nl=tl,O.b64nltohex=hu,O.hextopem=rr,O.pemtohex=ui,O.hextoArrayBuffer=function(u){if(u.length%2!=0)throw"input is not even length";if(null==u.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var d=new ArrayBuffer(u.length/2),f=new DataView(d),p=0;p<u.length/2;p++)f.setUint8(p,parseInt(u.substr(2*p,2),16));return d},O.ArrayBuffertohex=function(u){for(var d="",f=new DataView(u),p=0;p<u.byteLength;p++)d+=("00"+f.getUint8(p).toString(16)).slice(-2);return d},O.zulutomsec=$r,O.zulutosec=nl,O.zulutodate=function(u){return new Date($r(u))},O.datetozulu=function(u,d,f){var p,y=u.getUTCFullYear();if(d){if(y<1950||2049<y)throw"not proper year for UTCTime: "+y;p=(""+y).slice(-2)}else p=("000"+y).slice(-4);if(p+=("0"+(u.getUTCMonth()+1)).slice(-2),p+=("0"+u.getUTCDate()).slice(-2),p+=("0"+u.getUTCHours()).slice(-2),p+=("0"+u.getUTCMinutes()).slice(-2),p+=("0"+u.getUTCSeconds()).slice(-2),f){var A=u.getUTCMilliseconds();0!==A&&(p+="."+(A=(A=("00"+A).slice(-3)).replace(/0+$/g,"")))}return p+"Z"},O.uricmptohex=Sn,O.hextouricmp=Ci,O.ipv6tohex=ci,O.hextoipv6=Jh,O.hextoip=fu,O.iptohex=function(u){var d="malformed IP address";if(!(u=u.toLowerCase(u)).match(/^[0-9.]+$/)){if(u.match(/^[0-9a-f:]+$/)&&-1!==u.indexOf(":"))return ci(u);throw d}var f=u.split(".");if(4!==f.length)throw d;var p="";try{for(var y=0;y<4;y++)p+=("0"+parseInt(f[y]).toString(16)).slice(-2);return p}catch{throw d}},O.encodeURIComponentAll=Zs,O.newline_toUnix=function(u){return u.replace(/\r\n/gm,"\n")},O.newline_toDos=function(u){return(u=u.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},O.hextoposhex=Xs,O.intarystrtohex=function(u){u=(u=(u=u.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return u.split(/,/).map(function(d,f,p){var y=parseInt(d);if(y<0||255<y)throw"integer not in range 0-255";return("00"+y.toString(16)).slice(-2)}).join("")}catch(d){throw"malformed integer array string: "+d}},O.strdiffidx=function(u,d){var f=u.length;u.length>d.length&&(f=d.length);for(var p=0;p<f;p++)if(u.charCodeAt(p)!=d.charCodeAt(p))return p;return u.length!=d.length?f:-1},O.KJUR=P,O.crypto=P.crypto,O.asn1=P.asn1,O.jws=P.jws,O.lang=P.lang}).call(this,ne(28).Buffer)},function(Ge,O,ne){"use strict";(function(Q){var x=ne(30),Z=ne(31),k=ne(32);function _(){return v.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function b(te,w){if(_()<w)throw new RangeError("Invalid typed array length");return v.TYPED_ARRAY_SUPPORT?(te=new Uint8Array(w)).__proto__=v.prototype:(null===te&&(te=new v(w)),te.length=w),te}function v(te,w,S){if(!(v.TYPED_ARRAY_SUPPORT||this instanceof v))return new v(te,w,S);if("number"==typeof te){if("string"==typeof w)throw new Error("If encoding is specified then the first argument must be a string");return U(this,te)}return T(this,te,w,S)}function T(te,w,S,ee){if("number"==typeof w)throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&w instanceof ArrayBuffer?function(fe,Ee,ze,lt){if(ze<0||Ee.byteLength<ze)throw new RangeError("'offset' is out of bounds");if(Ee.byteLength<ze+(lt||0))throw new RangeError("'length' is out of bounds");return Ee=void 0===ze&&void 0===lt?new Uint8Array(Ee):void 0===lt?new Uint8Array(Ee,ze):new Uint8Array(Ee,ze,lt),v.TYPED_ARRAY_SUPPORT?(fe=Ee).__proto__=v.prototype:fe=se(fe,Ee),fe}(te,w,S,ee):"string"==typeof w?function(fe,Ee,ze){if("string"==typeof ze&&""!==ze||(ze="utf8"),!v.isEncoding(ze))throw new TypeError('"encoding" must be a valid string encoding');var lt=0|G(Ee,ze),jt=(fe=b(fe,lt)).write(Ee,ze);return jt!==lt&&(fe=fe.slice(0,jt)),fe}(te,w,S):function(fe,Ee){if(v.isBuffer(Ee)){var ze=0|J(Ee.length);return 0===(fe=b(fe,ze)).length||Ee.copy(fe,0,0,ze),fe}if(Ee){if(typeof ArrayBuffer<"u"&&Ee.buffer instanceof ArrayBuffer||"length"in Ee)return"number"!=typeof Ee.length||(jt=Ee.length)!=jt?b(fe,0):se(fe,Ee);if("Buffer"===Ee.type&&k(Ee.data))return se(fe,Ee.data)}var jt;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(te,w)}function z(te){if("number"!=typeof te)throw new TypeError('"size" argument must be a number');if(te<0)throw new RangeError('"size" argument must not be negative')}function U(te,w){if(z(w),te=b(te,w<0?0:0|J(w)),!v.TYPED_ARRAY_SUPPORT)for(var S=0;S<w;++S)te[S]=0;return te}function se(te,w){var S=w.length<0?0:0|J(w.length);te=b(te,S);for(var ee=0;ee<S;ee+=1)te[ee]=255&w[ee];return te}function J(te){if(te>=_())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_().toString(16)+" bytes");return 0|te}function G(te,w){if(v.isBuffer(te))return te.length;if(typeof ArrayBuffer<"u"&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(te)||te instanceof ArrayBuffer))return te.byteLength;"string"!=typeof te&&(te=""+te);var S=te.length;if(0===S)return 0;for(var ee=!1;;)switch(w){case"ascii":case"latin1":case"binary":return S;case"utf8":case"utf-8":case void 0:return In(te).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*S;case"hex":return S>>>1;case"base64":return yr(te).length;default:if(ee)return In(te).length;w=(""+w).toLowerCase(),ee=!0}}function H(te,w,S){var ee=!1;if((void 0===w||w<0)&&(w=0),w>this.length||((void 0===S||S>this.length)&&(S=this.length),S<=0)||(S>>>=0)<=(w>>>=0))return"";for(te||(te="utf8");;)switch(te){case"hex":return It(this,w,S);case"utf8":case"utf-8":return Ht(this,w,S);case"ascii":return zn(this,w,S);case"latin1":case"binary":return en(this,w,S);case"base64":return Qe(this,w,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dn(this,w,S);default:if(ee)throw new TypeError("Unknown encoding: "+te);te=(te+"").toLowerCase(),ee=!0}}function re(te,w,S){var ee=te[w];te[w]=te[S],te[S]=ee}function me(te,w,S,ee,ce){if(0===te.length)return-1;if("string"==typeof S?(ee=S,S=0):S>2147483647?S=2147483647:S<-2147483648&&(S=-2147483648),S=+S,isNaN(S)&&(S=ce?0:te.length-1),S<0&&(S=te.length+S),S>=te.length){if(ce)return-1;S=te.length-1}else if(S<0){if(!ce)return-1;S=0}if("string"==typeof w&&(w=v.from(w,ee)),v.isBuffer(w))return 0===w.length?-1:oe(te,w,S,ee,ce);if("number"==typeof w)return w&=255,v.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?ce?Uint8Array.prototype.indexOf.call(te,w,S):Uint8Array.prototype.lastIndexOf.call(te,w,S):oe(te,[w],S,ee,ce);throw new TypeError("val must be string, number or Buffer")}function oe(te,w,S,ee,ce){var fe,Ee=1,ze=te.length,lt=w.length;if(void 0!==ee&&("ucs2"===(ee=String(ee).toLowerCase())||"ucs-2"===ee||"utf16le"===ee||"utf-16le"===ee)){if(te.length<2||w.length<2)return-1;Ee=2,ze/=2,lt/=2,S/=2}function jt(bn,Hr){return 1===Ee?bn[Hr]:bn.readUInt16BE(Hr*Ee)}if(ce){var At=-1;for(fe=S;fe<ze;fe++)if(jt(te,fe)===jt(w,-1===At?0:fe-At)){if(-1===At&&(At=fe),fe-At+1===lt)return At*Ee}else-1!==At&&(fe-=fe-At),At=-1}else for(S+lt>ze&&(S=ze-lt),fe=S;fe>=0;fe--){for(var hn=!0,Qn=0;Qn<lt;Qn++)if(jt(te,fe+Qn)!==jt(w,Qn)){hn=!1;break}if(hn)return fe}return-1}function le(te,w,S,ee){S=Number(S)||0;var ce=te.length-S;ee?(ee=Number(ee))>ce&&(ee=ce):ee=ce;var fe=w.length;if(fe%2!=0)throw new TypeError("Invalid hex string");ee>fe/2&&(ee=fe/2);for(var Ee=0;Ee<ee;++Ee){var ze=parseInt(w.substr(2*Ee,2),16);if(isNaN(ze))return Ee;te[S+Ee]=ze}return Ee}function ie(te,w,S,ee){return Wn(In(w,te.length-S),te,S,ee)}function Te(te,w,S,ee){return Wn(function(fe){for(var Ee=[],ze=0;ze<fe.length;++ze)Ee.push(255&fe.charCodeAt(ze));return Ee}(w),te,S,ee)}function Pe(te,w,S,ee){return Te(te,w,S,ee)}function Ue(te,w,S,ee){return Wn(yr(w),te,S,ee)}function ae(te,w,S,ee){return Wn(function(fe,Ee){for(var ze,lt,At=[],hn=0;hn<fe.length&&!((Ee-=2)<0);++hn)lt=(ze=fe.charCodeAt(hn))>>8,At.push(ze%256),At.push(lt);return At}(w,te.length-S),te,S,ee)}function Qe(te,w,S){return x.fromByteArray(0===w&&S===te.length?te:te.slice(w,S))}function Ht(te,w,S){S=Math.min(te.length,S);for(var ee=[],ce=w;ce<S;){var fe,Ee,ze,lt,jt=te[ce],At=null,hn=jt>239?4:jt>223?3:jt>191?2:1;if(ce+hn<=S)switch(hn){case 1:jt<128&&(At=jt);break;case 2:128==(192&(fe=te[ce+1]))&&(lt=(31&jt)<<6|63&fe)>127&&(At=lt);break;case 3:Ee=te[ce+2],128==(192&(fe=te[ce+1]))&&128==(192&Ee)&&(lt=(15&jt)<<12|(63&fe)<<6|63&Ee)>2047&&(lt<55296||lt>57343)&&(At=lt);break;case 4:Ee=te[ce+2],ze=te[ce+3],128==(192&(fe=te[ce+1]))&&128==(192&Ee)&&128==(192&ze)&&(lt=(15&jt)<<18|(63&fe)<<12|(63&Ee)<<6|63&ze)>65535&&lt<1114112&&(At=lt)}null===At?(At=65533,hn=1):At>65535&&(ee.push((At-=65536)>>>10&1023|55296),At=56320|1023&At),ee.push(At),ce+=hn}return function(bn){var Hr=bn.length;if(Hr<=Ot)return String.fromCharCode.apply(String,bn);for(var it="",on=0;on<Hr;)it+=String.fromCharCode.apply(String,bn.slice(on,on+=Ot));return it}(ee)}O.Buffer=v,O.SlowBuffer=function(w){return+w!=w&&(w=0),v.alloc(+w)},O.INSPECT_MAX_BYTES=50,v.TYPED_ARRAY_SUPPORT=void 0!==Q.TYPED_ARRAY_SUPPORT?Q.TYPED_ARRAY_SUPPORT:function(){try{var w=new Uint8Array(1);return w.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===w.foo()&&"function"==typeof w.subarray&&0===w.subarray(1,1).byteLength}catch{return!1}}(),O.kMaxLength=_(),v.poolSize=8192,v._augment=function(te){return te.__proto__=v.prototype,te},v.from=function(te,w,S){return T(null,te,w,S)},v.TYPED_ARRAY_SUPPORT&&(v.prototype.__proto__=Uint8Array.prototype,v.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&v[Symbol.species]===v&&Object.defineProperty(v,Symbol.species,{value:null,configurable:!0})),v.alloc=function(te,w,S){return null,Ee=w,ze=S,z(fe=te),fe<=0?b(null,fe):void 0!==Ee?"string"==typeof ze?b(null,fe).fill(Ee,ze):b(null,fe).fill(Ee):b(null,fe);var fe,Ee,ze},v.allocUnsafe=function(te){return U(null,te)},v.allocUnsafeSlow=function(te){return U(null,te)},v.isBuffer=function(w){return!(null==w||!w._isBuffer)},v.compare=function(w,S){if(!v.isBuffer(w)||!v.isBuffer(S))throw new TypeError("Arguments must be Buffers");if(w===S)return 0;for(var ee=w.length,ce=S.length,fe=0,Ee=Math.min(ee,ce);fe<Ee;++fe)if(w[fe]!==S[fe]){ee=w[fe],ce=S[fe];break}return ee<ce?-1:ce<ee?1:0},v.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(w,S){if(!k(w))throw new TypeError('"list" argument must be an Array of Buffers');if(0===w.length)return v.alloc(0);var ee;if(void 0===S)for(S=0,ee=0;ee<w.length;++ee)S+=w[ee].length;var ce=v.allocUnsafe(S),fe=0;for(ee=0;ee<w.length;++ee){var Ee=w[ee];if(!v.isBuffer(Ee))throw new TypeError('"list" argument must be an Array of Buffers');Ee.copy(ce,fe),fe+=Ee.length}return ce},v.byteLength=G,v.prototype._isBuffer=!0,v.prototype.swap16=function(){var w=this.length;if(w%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var S=0;S<w;S+=2)re(this,S,S+1);return this},v.prototype.swap32=function(){var w=this.length;if(w%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var S=0;S<w;S+=4)re(this,S,S+3),re(this,S+1,S+2);return this},v.prototype.swap64=function(){var w=this.length;if(w%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var S=0;S<w;S+=8)re(this,S,S+7),re(this,S+1,S+6),re(this,S+2,S+5),re(this,S+3,S+4);return this},v.prototype.toString=function(){var w=0|this.length;return 0===w?"":0===arguments.length?Ht(this,0,w):H.apply(this,arguments)},v.prototype.equals=function(w){if(!v.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w||0===v.compare(this,w)},v.prototype.inspect=function(){var w="",S=O.INSPECT_MAX_BYTES;return this.length>0&&(w=this.toString("hex",0,S).match(/.{2}/g).join(" "),this.length>S&&(w+=" ... ")),"<Buffer "+w+">"},v.prototype.compare=function(w,S,ee,ce,fe){if(!v.isBuffer(w))throw new TypeError("Argument must be a Buffer");if(void 0===S&&(S=0),void 0===ee&&(ee=w?w.length:0),void 0===ce&&(ce=0),void 0===fe&&(fe=this.length),S<0||ee>w.length||ce<0||fe>this.length)throw new RangeError("out of range index");if(ce>=fe&&S>=ee)return 0;if(ce>=fe)return-1;if(S>=ee)return 1;if(this===w)return 0;for(var Ee=(fe>>>=0)-(ce>>>=0),ze=(ee>>>=0)-(S>>>=0),lt=Math.min(Ee,ze),jt=this.slice(ce,fe),At=w.slice(S,ee),hn=0;hn<lt;++hn)if(jt[hn]!==At[hn]){Ee=jt[hn],ze=At[hn];break}return Ee<ze?-1:ze<Ee?1:0},v.prototype.includes=function(w,S,ee){return-1!==this.indexOf(w,S,ee)},v.prototype.indexOf=function(w,S,ee){return me(this,w,S,ee,!0)},v.prototype.lastIndexOf=function(w,S,ee){return me(this,w,S,ee,!1)},v.prototype.write=function(w,S,ee,ce){if(void 0===S)ce="utf8",ee=this.length,S=0;else if(void 0===ee&&"string"==typeof S)ce=S,ee=this.length,S=0;else{if(!isFinite(S))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");S|=0,isFinite(ee)?(ee|=0,void 0===ce&&(ce="utf8")):(ce=ee,ee=void 0)}var fe=this.length-S;if((void 0===ee||ee>fe)&&(ee=fe),w.length>0&&(ee<0||S<0)||S>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");for(var Ee=!1;;)switch(ce){case"hex":return le(this,w,S,ee);case"utf8":case"utf-8":return ie(this,w,S,ee);case"ascii":return Te(this,w,S,ee);case"latin1":case"binary":return Pe(this,w,S,ee);case"base64":return Ue(this,w,S,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,w,S,ee);default:if(Ee)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),Ee=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ot=4096;function zn(te,w,S){var ee="";S=Math.min(te.length,S);for(var ce=w;ce<S;++ce)ee+=String.fromCharCode(127&te[ce]);return ee}function en(te,w,S){var ee="";S=Math.min(te.length,S);for(var ce=w;ce<S;++ce)ee+=String.fromCharCode(te[ce]);return ee}function It(te,w,S){var ee=te.length;(!w||w<0)&&(w=0),(!S||S<0||S>ee)&&(S=ee);for(var ce="",fe=w;fe<S;++fe)ce+=at(te[fe]);return ce}function dn(te,w,S){for(var ee=te.slice(w,S),ce="",fe=0;fe<ee.length;fe+=2)ce+=String.fromCharCode(ee[fe]+256*ee[fe+1]);return ce}function Et(te,w,S){if(te%1!=0||te<0)throw new RangeError("offset is not uint");if(te+w>S)throw new RangeError("Trying to access beyond buffer length")}function xt(te,w,S,ee,ce,fe){if(!v.isBuffer(te))throw new TypeError('"buffer" argument must be a Buffer instance');if(w>ce||w<fe)throw new RangeError('"value" argument is out of bounds');if(S+ee>te.length)throw new RangeError("Index out of range")}function rn(te,w,S,ee){w<0&&(w=65535+w+1);for(var ce=0,fe=Math.min(te.length-S,2);ce<fe;++ce)te[S+ce]=(w&255<<8*(ee?ce:1-ce))>>>8*(ee?ce:1-ce)}function $t(te,w,S,ee){w<0&&(w=4294967295+w+1);for(var ce=0,fe=Math.min(te.length-S,4);ce<fe;++ce)te[S+ce]=w>>>8*(ee?ce:3-ce)&255}function Kn(te,w,S,ee,ce,fe){if(S+ee>te.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("Index out of range")}function Zn(te,w,S,ee,ce){return ce||Kn(te,0,S,4),Z.write(te,w,S,ee,23,4),S+4}function Lt(te,w,S,ee,ce){return ce||Kn(te,0,S,8),Z.write(te,w,S,ee,52,8),S+8}v.prototype.slice=function(w,S){var ee,ce=this.length;if((w=~~w)<0?(w+=ce)<0&&(w=0):w>ce&&(w=ce),(S=void 0===S?ce:~~S)<0?(S+=ce)<0&&(S=0):S>ce&&(S=ce),S<w&&(S=w),v.TYPED_ARRAY_SUPPORT)(ee=this.subarray(w,S)).__proto__=v.prototype;else{var fe=S-w;ee=new v(fe,void 0);for(var Ee=0;Ee<fe;++Ee)ee[Ee]=this[Ee+w]}return ee},v.prototype.readUIntLE=function(w,S,ee){w|=0,S|=0,ee||Et(w,S,this.length);for(var ce=this[w],fe=1,Ee=0;++Ee<S&&(fe*=256);)ce+=this[w+Ee]*fe;return ce},v.prototype.readUIntBE=function(w,S,ee){w|=0,S|=0,ee||Et(w,S,this.length);for(var ce=this[w+--S],fe=1;S>0&&(fe*=256);)ce+=this[w+--S]*fe;return ce},v.prototype.readUInt8=function(w,S){return S||Et(w,1,this.length),this[w]},v.prototype.readUInt16LE=function(w,S){return S||Et(w,2,this.length),this[w]|this[w+1]<<8},v.prototype.readUInt16BE=function(w,S){return S||Et(w,2,this.length),this[w]<<8|this[w+1]},v.prototype.readUInt32LE=function(w,S){return S||Et(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+16777216*this[w+3]},v.prototype.readUInt32BE=function(w,S){return S||Et(w,4,this.length),16777216*this[w]+(this[w+1]<<16|this[w+2]<<8|this[w+3])},v.prototype.readIntLE=function(w,S,ee){w|=0,S|=0,ee||Et(w,S,this.length);for(var ce=this[w],fe=1,Ee=0;++Ee<S&&(fe*=256);)ce+=this[w+Ee]*fe;return ce>=(fe*=128)&&(ce-=Math.pow(2,8*S)),ce},v.prototype.readIntBE=function(w,S,ee){w|=0,S|=0,ee||Et(w,S,this.length);for(var ce=S,fe=1,Ee=this[w+--ce];ce>0&&(fe*=256);)Ee+=this[w+--ce]*fe;return Ee>=(fe*=128)&&(Ee-=Math.pow(2,8*S)),Ee},v.prototype.readInt8=function(w,S){return S||Et(w,1,this.length),128&this[w]?-1*(255-this[w]+1):this[w]},v.prototype.readInt16LE=function(w,S){S||Et(w,2,this.length);var ee=this[w]|this[w+1]<<8;return 32768&ee?4294901760|ee:ee},v.prototype.readInt16BE=function(w,S){S||Et(w,2,this.length);var ee=this[w+1]|this[w]<<8;return 32768&ee?4294901760|ee:ee},v.prototype.readInt32LE=function(w,S){return S||Et(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},v.prototype.readInt32BE=function(w,S){return S||Et(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},v.prototype.readFloatLE=function(w,S){return S||Et(w,4,this.length),Z.read(this,w,!0,23,4)},v.prototype.readFloatBE=function(w,S){return S||Et(w,4,this.length),Z.read(this,w,!1,23,4)},v.prototype.readDoubleLE=function(w,S){return S||Et(w,8,this.length),Z.read(this,w,!0,52,8)},v.prototype.readDoubleBE=function(w,S){return S||Et(w,8,this.length),Z.read(this,w,!1,52,8)},v.prototype.writeUIntLE=function(w,S,ee,ce){w=+w,S|=0,ee|=0,ce||xt(this,w,S,ee,Math.pow(2,8*ee)-1,0);var fe=1,Ee=0;for(this[S]=255&w;++Ee<ee&&(fe*=256);)this[S+Ee]=w/fe&255;return S+ee},v.prototype.writeUIntBE=function(w,S,ee,ce){w=+w,S|=0,ee|=0,ce||xt(this,w,S,ee,Math.pow(2,8*ee)-1,0);var fe=ee-1,Ee=1;for(this[S+fe]=255&w;--fe>=0&&(Ee*=256);)this[S+fe]=w/Ee&255;return S+ee},v.prototype.writeUInt8=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,1,255,0),v.TYPED_ARRAY_SUPPORT||(w=Math.floor(w)),this[S]=255&w,S+1},v.prototype.writeUInt16LE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[S]=255&w,this[S+1]=w>>>8):rn(this,w,S,!0),S+2},v.prototype.writeUInt16BE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>8,this[S+1]=255&w):rn(this,w,S,!1),S+2},v.prototype.writeUInt32LE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[S+3]=w>>>24,this[S+2]=w>>>16,this[S+1]=w>>>8,this[S]=255&w):$t(this,w,S,!0),S+4},v.prototype.writeUInt32BE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>24,this[S+1]=w>>>16,this[S+2]=w>>>8,this[S+3]=255&w):$t(this,w,S,!1),S+4},v.prototype.writeIntLE=function(w,S,ee,ce){if(w=+w,S|=0,!ce){var fe=Math.pow(2,8*ee-1);xt(this,w,S,ee,fe-1,-fe)}var Ee=0,ze=1,lt=0;for(this[S]=255&w;++Ee<ee&&(ze*=256);)w<0&&0===lt&&0!==this[S+Ee-1]&&(lt=1),this[S+Ee]=(w/ze>>0)-lt&255;return S+ee},v.prototype.writeIntBE=function(w,S,ee,ce){if(w=+w,S|=0,!ce){var fe=Math.pow(2,8*ee-1);xt(this,w,S,ee,fe-1,-fe)}var Ee=ee-1,ze=1,lt=0;for(this[S+Ee]=255&w;--Ee>=0&&(ze*=256);)w<0&&0===lt&&0!==this[S+Ee+1]&&(lt=1),this[S+Ee]=(w/ze>>0)-lt&255;return S+ee},v.prototype.writeInt8=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,1,127,-128),v.TYPED_ARRAY_SUPPORT||(w=Math.floor(w)),w<0&&(w=255+w+1),this[S]=255&w,S+1},v.prototype.writeInt16LE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[S]=255&w,this[S+1]=w>>>8):rn(this,w,S,!0),S+2},v.prototype.writeInt16BE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>8,this[S+1]=255&w):rn(this,w,S,!1),S+2},v.prototype.writeInt32LE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,4,2147483647,-2147483648),v.TYPED_ARRAY_SUPPORT?(this[S]=255&w,this[S+1]=w>>>8,this[S+2]=w>>>16,this[S+3]=w>>>24):$t(this,w,S,!0),S+4},v.prototype.writeInt32BE=function(w,S,ee){return w=+w,S|=0,ee||xt(this,w,S,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),v.TYPED_ARRAY_SUPPORT?(this[S]=w>>>24,this[S+1]=w>>>16,this[S+2]=w>>>8,this[S+3]=255&w):$t(this,w,S,!1),S+4},v.prototype.writeFloatLE=function(w,S,ee){return Zn(this,w,S,!0,ee)},v.prototype.writeFloatBE=function(w,S,ee){return Zn(this,w,S,!1,ee)},v.prototype.writeDoubleLE=function(w,S,ee){return Lt(this,w,S,!0,ee)},v.prototype.writeDoubleBE=function(w,S,ee){return Lt(this,w,S,!1,ee)},v.prototype.copy=function(w,S,ee,ce){if(ee||(ee=0),ce||0===ce||(ce=this.length),S>=w.length&&(S=w.length),S||(S=0),ce>0&&ce<ee&&(ce=ee),ce===ee||0===w.length||0===this.length)return 0;if(S<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("sourceStart out of bounds");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),w.length-S<ce-ee&&(ce=w.length-S+ee);var fe,Ee=ce-ee;if(this===w&&ee<S&&S<ce)for(fe=Ee-1;fe>=0;--fe)w[fe+S]=this[fe+ee];else if(Ee<1e3||!v.TYPED_ARRAY_SUPPORT)for(fe=0;fe<Ee;++fe)w[fe+S]=this[fe+ee];else Uint8Array.prototype.set.call(w,this.subarray(ee,ee+Ee),S);return Ee},v.prototype.fill=function(w,S,ee,ce){if("string"==typeof w){if("string"==typeof S?(ce=S,S=0,ee=this.length):"string"==typeof ee&&(ce=ee,ee=this.length),1===w.length){var fe=w.charCodeAt(0);fe<256&&(w=fe)}if(void 0!==ce&&"string"!=typeof ce)throw new TypeError("encoding must be a string");if("string"==typeof ce&&!v.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce)}else"number"==typeof w&&(w&=255);if(S<0||this.length<S||this.length<ee)throw new RangeError("Out of range index");if(ee<=S)return this;var Ee;if(S>>>=0,ee=void 0===ee?this.length:ee>>>0,w||(w=0),"number"==typeof w)for(Ee=S;Ee<ee;++Ee)this[Ee]=w;else{var ze=v.isBuffer(w)?w:In(new v(w,ce).toString()),lt=ze.length;for(Ee=0;Ee<ee-S;++Ee)this[Ee+S]=ze[Ee%lt]}return this};var qt=/[^+\/0-9A-Za-z-_]/g;function at(te){return te<16?"0"+te.toString(16):te.toString(16)}function In(te,w){var S;w=w||1/0;for(var ee=te.length,ce=null,fe=[],Ee=0;Ee<ee;++Ee){if((S=te.charCodeAt(Ee))>55295&&S<57344){if(!ce){if(S>56319){(w-=3)>-1&&fe.push(239,191,189);continue}if(Ee+1===ee){(w-=3)>-1&&fe.push(239,191,189);continue}ce=S;continue}if(S<56320){(w-=3)>-1&&fe.push(239,191,189),ce=S;continue}S=65536+(ce-55296<<10|S-56320)}else ce&&(w-=3)>-1&&fe.push(239,191,189);if(ce=null,S<128){if((w-=1)<0)break;fe.push(S)}else if(S<2048){if((w-=2)<0)break;fe.push(S>>6|192,63&S|128)}else if(S<65536){if((w-=3)<0)break;fe.push(S>>12|224,S>>6&63|128,63&S|128)}else{if(!(S<1114112))throw new Error("Invalid code point");if((w-=4)<0)break;fe.push(S>>18|240,S>>12&63|128,S>>6&63|128,63&S|128)}}return fe}function yr(te){return x.toByteArray(function(S){if((S=(ce=S,ce.trim?ce.trim():ce.replace(/^\s+|\s+$/g,"")).replace(qt,"")).length<2)return"";for(var ce;S.length%4!=0;)S+="=";return S}(te))}function Wn(te,w,S,ee){for(var ce=0;ce<ee&&!(ce+S>=w.length||ce>=te.length);++ce)w[ce+S]=te[ce];return ce}}).call(this,ne(29))},function(Ge,O){var ne;ne=function(){return this}();try{ne=ne||new Function("return this")()}catch{"object"==typeof window&&(ne=window)}Ge.exports=ne},function(Ge,O,ne){"use strict";O.byteLength=function(U){var se=v(U),G=se[1];return 3*(se[0]+G)/4-G},O.toByteArray=function(U){var se,J,Ue,G=v(U),H=G[0],re=G[1],me=new Z(3*(H+(Ue=re))/4-Ue),oe=0,le=re>0?H-4:H;for(J=0;J<le;J+=4)se=x[U.charCodeAt(J)]<<18|x[U.charCodeAt(J+1)]<<12|x[U.charCodeAt(J+2)]<<6|x[U.charCodeAt(J+3)],me[oe++]=se>>16&255,me[oe++]=se>>8&255,me[oe++]=255&se;return 2===re&&(se=x[U.charCodeAt(J)]<<2|x[U.charCodeAt(J+1)]>>4,me[oe++]=255&se),1===re&&(se=x[U.charCodeAt(J)]<<10|x[U.charCodeAt(J+1)]<<4|x[U.charCodeAt(J+2)]>>2,me[oe++]=se>>8&255,me[oe++]=255&se),me},O.fromByteArray=function(U){for(var se,J=U.length,G=J%3,H=[],me=0,oe=J-G;me<oe;me+=16383)H.push(T(U,me,me+16383>oe?oe:me+16383));return 1===G?H.push(Q[(se=U[J-1])>>2]+Q[se<<4&63]+"=="):2===G&&H.push(Q[(se=(U[J-2]<<8)+U[J-1])>>10]+Q[se>>4&63]+Q[se<<2&63]+"="),H.join("")};for(var Q=[],x=[],Z=typeof Uint8Array<"u"?Uint8Array:Array,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_=0,b=k.length;_<b;++_)Q[_]=k[_],x[k.charCodeAt(_)]=_;function v(z){var U=z.length;if(U%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var se=z.indexOf("=");return-1===se&&(se=U),[se,se===U?0:4-se%4]}function T(z,U,se){for(var G,H=[],re=U;re<se;re+=3)H.push(Q[(G=(z[re]<<16&16711680)+(z[re+1]<<8&65280)+(255&z[re+2]))>>18&63]+Q[G>>12&63]+Q[G>>6&63]+Q[63&G]);return H.join("")}x["-".charCodeAt(0)]=62,x["_".charCodeAt(0)]=63},function(Ge,O){O.read=function(ne,Q,x,Z,k){var _,b,v=8*k-Z-1,T=(1<<v)-1,z=T>>1,U=-7,se=x?k-1:0,J=x?-1:1,G=ne[Q+se];for(se+=J,_=G&(1<<-U)-1,G>>=-U,U+=v;U>0;_=256*_+ne[Q+se],se+=J,U-=8);for(b=_&(1<<-U)-1,_>>=-U,U+=Z;U>0;b=256*b+ne[Q+se],se+=J,U-=8);if(0===_)_=1-z;else{if(_===T)return b?NaN:1/0*(G?-1:1);b+=Math.pow(2,Z),_-=z}return(G?-1:1)*b*Math.pow(2,_-Z)},O.write=function(ne,Q,x,Z,k,_){var b,v,T,z=8*_-k-1,U=(1<<z)-1,se=U>>1,J=23===k?Math.pow(2,-24)-Math.pow(2,-77):0,G=Z?0:_-1,H=Z?1:-1,re=Q<0||0===Q&&1/Q<0?1:0;for(Q=Math.abs(Q),isNaN(Q)||Q===1/0?(v=isNaN(Q)?1:0,b=U):(b=Math.floor(Math.log(Q)/Math.LN2),Q*(T=Math.pow(2,-b))<1&&(b--,T*=2),(Q+=b+se>=1?J/T:J*Math.pow(2,1-se))*T>=2&&(b++,T/=2),b+se>=U?(v=0,b=U):b+se>=1?(v=(Q*T-1)*Math.pow(2,k),b+=se):(v=Q*Math.pow(2,se-1)*Math.pow(2,k),b=0));k>=8;ne[x+G]=255&v,G+=H,v/=256,k-=8);for(b=b<<k|v,z+=k;z>0;ne[x+G]=255&b,G+=H,b/=256,z-=8);ne[x+G-H]|=128*re}},function(Ge,O){var ne={}.toString;Ge.exports=Array.isArray||function(Q){return"[object Array]"==ne.call(Q)}},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(Z){var k=Z.jws,_=Z.KeyUtil,b=Z.X509,v=Z.crypto,T=Z.hextob64u,z=Z.b64tohex,U=Z.AllowedSigningAlgs;return function(){function se(){!function(G,H){if(!(G instanceof H))throw new TypeError("Cannot call a class as a function")}(this,se)}return se.parseJwt=function(G){Q.Log.debug("JoseUtil.parseJwt");try{var H=k.JWS.parse(G);return{header:H.headerObj,payload:H.payloadObj}}catch(re){Q.Log.error(re)}},se.validateJwt=function(G,H,re,me,oe,le,ie){Q.Log.debug("JoseUtil.validateJwt");try{if("RSA"===H.kty)if(H.e&&H.n)H=_.getKey(H);else{if(!H.x5c||!H.x5c.length)return Q.Log.error("JoseUtil.validateJwt: RSA key missing key material",H),Promise.reject(new Error("RSA key missing key material"));var Te=z(H.x5c[0]);H=b.getPublicKeyFromCertHex(Te)}else{if("EC"!==H.kty)return Q.Log.error("JoseUtil.validateJwt: Unsupported key type",H&&H.kty),Promise.reject(new Error(H.kty));if(!(H.crv&&H.x&&H.y))return Q.Log.error("JoseUtil.validateJwt: EC key missing key material",H),Promise.reject(new Error("EC key missing key material"));H=_.getKey(H)}return se._validateJwt(G,H,re,me,oe,le,ie)}catch(Pe){return Q.Log.error(Pe&&Pe.message||Pe),Promise.reject("JWT validation failed")}},se.validateJwtAttributes=function(G,H,re,me,oe,le){me||(me=0),oe||(oe=parseInt(Date.now()/1e3));var ie=se.parseJwt(G).payload;if(!ie.iss)return Q.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(ie.iss!==H)return Q.Log.error("JoseUtil._validateJwt: Invalid issuer in token",ie.iss),Promise.reject(new Error("Invalid issuer in token: "+ie.iss));if(!ie.aud)return Q.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(ie.aud===re||Array.isArray(ie.aud)&&ie.aud.indexOf(re)>=0))return Q.Log.error("JoseUtil._validateJwt: Invalid audience in token",ie.aud),Promise.reject(new Error("Invalid audience in token: "+ie.aud));if(ie.azp&&ie.azp!==re)return Q.Log.error("JoseUtil._validateJwt: Invalid azp in token",ie.azp),Promise.reject(new Error("Invalid azp in token: "+ie.azp));if(!le){var Te=oe+me,Pe=oe-me;if(!ie.iat)return Q.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(Te<ie.iat)return Q.Log.error("JoseUtil._validateJwt: iat is in the future",ie.iat),Promise.reject(new Error("iat is in the future: "+ie.iat));if(ie.nbf&&Te<ie.nbf)return Q.Log.error("JoseUtil._validateJwt: nbf is in the future",ie.nbf),Promise.reject(new Error("nbf is in the future: "+ie.nbf));if(!ie.exp)return Q.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(ie.exp<Pe)return Q.Log.error("JoseUtil._validateJwt: exp is in the past",ie.exp),Promise.reject(new Error("exp is in the past:"+ie.exp))}return Promise.resolve(ie)},se._validateJwt=function(G,H,re,me,oe,le,ie){return se.validateJwtAttributes(G,re,me,oe,le,ie).then(function(Te){try{return k.JWS.verify(G,H,U)?Te:(Q.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(Pe){return Q.Log.error(Pe&&Pe.message||Pe),Promise.reject(new Error("signature validation failed"))}})},se.hashString=function(G,H){try{return v.Util.hashString(G,H)}catch(re){Q.Log.error(re)}},se.hexToBase64Url=function(G){try{return T(G)}catch(H){Q.Log.error(H)}},se}()};var Q=ne(0);Ge.exports=O.default},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SigninResponse=void 0;var Q=function(){function k(_,b){for(var v=0;v<b.length;v++){var T=b[v];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(_,T.key,T)}}return function(_,b,v){return b&&k(_.prototype,b),v&&k(_,v),_}}(),x=ne(3);function Z(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}O.SigninResponse=function(){function k(_){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";Z(this,k);var v=x.UrlUtility.parseUrlFragment(_,b);this.error=v.error,this.error_description=v.error_description,this.error_uri=v.error_uri,this.code=v.code,this.state=v.state,this.id_token=v.id_token,this.session_state=v.session_state,this.access_token=v.access_token,this.token_type=v.token_type,this.scope=v.scope,this.profile=void 0,this.expires_in=v.expires_in}return Q(k,[{key:"expires_in",get:function(){if(this.expires_at){var b=parseInt(Date.now()/1e3);return this.expires_at-b}},set:function(b){var v=parseInt(b);if("number"==typeof v&&v>0){var T=parseInt(Date.now()/1e3);this.expires_at=T+v}}},{key:"expired",get:function(){var b=this.expires_in;if(void 0!==b)return b<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),k}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SignoutRequest=void 0;var Q=ne(0),x=ne(3),Z=ne(9);O.SignoutRequest=function k(_){var b=_.url,v=_.id_token_hint,T=_.post_logout_redirect_uri,z=_.data,U=_.extraQueryParams,se=_.request_type;if(function(H,re){if(!(H instanceof re))throw new TypeError("Cannot call a class as a function")}(this,k),!b)throw Q.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var J in v&&(b=x.UrlUtility.addQueryParam(b,"id_token_hint",v)),T&&(b=x.UrlUtility.addQueryParam(b,"post_logout_redirect_uri",T),z&&(this.state=new Z.State({data:z,request_type:se}),b=x.UrlUtility.addQueryParam(b,"state",this.state.id))),U)b=x.UrlUtility.addQueryParam(b,J,U[J]);this.url=b}},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SignoutResponse=void 0;var Q=ne(3);O.SignoutResponse=function x(Z){!function(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}(this,x);var k=Q.UrlUtility.parseUrlFragment(Z,"?");this.error=k.error,this.error_description=k.error_description,this.error_uri=k.error_uri,this.state=k.state}},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.InMemoryWebStorage=void 0;var Q=function(){function Z(k,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}return function(k,_,b){return _&&Z(k.prototype,_),b&&Z(k,b),k}}(),x=ne(0);O.InMemoryWebStorage=function(){function Z(){(function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")})(this,Z),this._data={}}return Z.prototype.getItem=function(_){return x.Log.debug("InMemoryWebStorage.getItem",_),this._data[_]},Z.prototype.setItem=function(_,b){x.Log.debug("InMemoryWebStorage.setItem",_),this._data[_]=b},Z.prototype.removeItem=function(_){x.Log.debug("InMemoryWebStorage.removeItem",_),delete this._data[_]},Z.prototype.key=function(_){return Object.getOwnPropertyNames(this._data)[_]},Q(Z,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserManager=void 0;var Q=function(){function re(me,oe){for(var le=0;le<oe.length;le++){var ie=oe[le];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(me,ie.key,ie)}}return function(me,oe,le){return oe&&re(me.prototype,oe),le&&re(me,le),me}}(),x=ne(0),Z=ne(10),k=ne(39),_=ne(15),b=ne(45),v=ne(47),T=ne(18),z=ne(8),U=ne(20),se=ne(11),J=ne(4);function G(re,me){if(!(re instanceof me))throw new TypeError("Cannot call a class as a function")}function H(re,me){if(!re)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!me||"object"!=typeof me&&"function"!=typeof me?re:me}O.UserManager=function(re){function me(){var oe=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},le=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.SilentRenewService,ie=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T.SessionMonitor,Te=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U.TokenRevocationClient,Pe=arguments.length>4&&void 0!==arguments[4]?arguments[4]:se.TokenClient,Ue=arguments.length>5&&void 0!==arguments[5]?arguments[5]:J.JoseUtil;G(this,me),oe instanceof k.UserManagerSettings||(oe=new k.UserManagerSettings(oe));var ae=H(this,re.call(this,oe));return ae._events=new b.UserManagerEvents(oe),ae._silentRenewService=new le(ae),ae.settings.automaticSilentRenew&&(x.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),ae.startSilentRenew()),ae.settings.monitorSession&&(x.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),ae._sessionMonitor=new ie(ae)),ae._tokenRevocationClient=new Te(ae._settings),ae._tokenClient=new Pe(ae._settings),ae._joseUtil=Ue,ae}return function(le,ie){if("function"!=typeof ie&&null!==ie)throw new TypeError("Super expression must either be null or a function, not "+typeof ie);le.prototype=Object.create(ie&&ie.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),ie&&(Object.setPrototypeOf?Object.setPrototypeOf(le,ie):le.__proto__=ie)}(me,re),me.prototype.getUser=function(){var le=this;return this._loadUser().then(function(ie){return ie?(x.Log.info("UserManager.getUser: user loaded"),le._events.load(ie,!1),ie):(x.Log.info("UserManager.getUser: user not found in storage"),null)})},me.prototype.removeUser=function(){var le=this;return this.storeUser(null).then(function(){x.Log.info("UserManager.removeUser: user removed from storage"),le._events.unload()})},me.prototype.signinRedirect=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(le=Object.assign({},le)).request_type="si:r",this._signinStart(le,this._redirectNavigator,{useReplaceToNavigate:le.useReplaceToNavigate}).then(function(){x.Log.info("UserManager.signinRedirect: successful")})},me.prototype.signinRedirectCallback=function(le){return this._signinEnd(le||this._redirectNavigator.url).then(function(ie){return ie.profile&&ie.profile.sub?x.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",ie.profile.sub):x.Log.info("UserManager.signinRedirectCallback: no sub"),ie})},me.prototype.signinPopup=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(le=Object.assign({},le)).request_type="si:p";var ie=le.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return ie?(le.redirect_uri=ie,le.display="popup",this._signin(le,this._popupNavigator,{startUrl:ie,popupWindowFeatures:le.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:le.popupWindowTarget||this.settings.popupWindowTarget}).then(function(Te){return Te&&(Te.profile&&Te.profile.sub?x.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",Te.profile.sub):x.Log.info("UserManager.signinPopup: no sub")),Te})):(x.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},me.prototype.signinPopupCallback=function(le){return this._signinCallback(le,this._popupNavigator).then(function(ie){return ie&&(ie.profile&&ie.profile.sub?x.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",ie.profile.sub):x.Log.info("UserManager.signinPopupCallback: no sub")),ie}).catch(function(ie){x.Log.error(ie.message)})},me.prototype.signinSilent=function(){var le=this,ie=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ie=Object.assign({},ie),this._loadUser().then(function(Te){return Te&&Te.refresh_token?(ie.refresh_token=Te.refresh_token,le._useRefreshToken(ie)):(ie.request_type="si:s",ie.id_token_hint=ie.id_token_hint||le.settings.includeIdTokenInSilentRenew&&Te&&Te.id_token,Te&&le._settings.validateSubOnSilentRenew&&(x.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",Te.profile.sub),ie.current_sub=Te.profile.sub),le._signinSilentIframe(ie))})},me.prototype._useRefreshToken=function(){var le=this;return this._tokenClient.exchangeRefreshToken(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).then(function(Te){return Te?Te.access_token?le._loadUser().then(function(Pe){if(Pe){var Ue=Promise.resolve();return Te.id_token&&(Ue=le._validateIdTokenFromTokenRefreshToken(Pe.profile,Te.id_token)),Ue.then(function(){return x.Log.debug("UserManager._useRefreshToken: refresh token response success"),Pe.id_token=Te.id_token||Pe.id_token,Pe.access_token=Te.access_token,Pe.refresh_token=Te.refresh_token||Pe.refresh_token,Pe.expires_in=Te.expires_in,le.storeUser(Pe).then(function(){return le._events.load(Pe),Pe})})}return null}):(x.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(x.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))})},me.prototype._validateIdTokenFromTokenRefreshToken=function(le,ie){var Te=this;return this._metadataService.getIssuer().then(function(Pe){return Te.settings.getEpochTime().then(function(Ue){return Te._joseUtil.validateJwtAttributes(ie,Pe,Te._settings.client_id,Te._settings.clockSkew,Ue).then(function(ae){return ae?ae.sub!==le.sub?(x.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):ae.auth_time&&ae.auth_time!==le.auth_time?(x.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):ae.azp&&ae.azp!==le.azp?(x.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!ae.azp&&le.azp?(x.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(x.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))})})})},me.prototype._signinSilentIframe=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ie=le.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return ie?(le.redirect_uri=ie,le.prompt=le.prompt||"none",this._signin(le,this._iframeNavigator,{startUrl:ie,silentRequestTimeout:le.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(Te){return Te&&(Te.profile&&Te.profile.sub?x.Log.info("UserManager.signinSilent: successful, signed in sub: ",Te.profile.sub):x.Log.info("UserManager.signinSilent: no sub")),Te})):(x.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},me.prototype.signinSilentCallback=function(le){return this._signinCallback(le,this._iframeNavigator).then(function(ie){return ie&&(ie.profile&&ie.profile.sub?x.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",ie.profile.sub):x.Log.info("UserManager.signinSilentCallback: no sub")),ie})},me.prototype.signinCallback=function(le){var ie=this;return this.readSigninResponseState(le).then(function(Te){var Pe=Te.state;return"si:r"===Pe.request_type?ie.signinRedirectCallback(le):"si:p"===Pe.request_type?ie.signinPopupCallback(le):"si:s"===Pe.request_type?ie.signinSilentCallback(le):Promise.reject(new Error("invalid response_type in state"))})},me.prototype.signoutCallback=function(le,ie){var Te=this;return this.readSignoutResponseState(le).then(function(Pe){var Ue=Pe.state,ae=Pe.response;return Ue?"so:r"===Ue.request_type?Te.signoutRedirectCallback(le):"so:p"===Ue.request_type?Te.signoutPopupCallback(le,ie):Promise.reject(new Error("invalid response_type in state")):ae})},me.prototype.querySessionStatus=function(){var le=this,ie=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(ie=Object.assign({},ie)).request_type="si:s";var Te=ie.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return Te?(ie.redirect_uri=Te,ie.prompt="none",ie.response_type=ie.response_type||this.settings.query_status_response_type,ie.scope=ie.scope||"openid",ie.skipUserInfo=!0,this._signinStart(ie,this._iframeNavigator,{startUrl:Te,silentRequestTimeout:ie.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(Pe){return le.processSigninResponse(Pe.url).then(function(Ue){if(x.Log.debug("UserManager.querySessionStatus: got signin response"),Ue.session_state&&Ue.profile.sub)return x.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",Ue.profile.sub),{session_state:Ue.session_state,sub:Ue.profile.sub,sid:Ue.profile.sid};x.Log.info("querySessionStatus successful, user not authenticated")}).catch(function(Ue){if(Ue.session_state&&le.settings.monitorAnonymousSession&&("login_required"==Ue.message||"consent_required"==Ue.message||"interaction_required"==Ue.message||"account_selection_required"==Ue.message))return x.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:Ue.session_state};throw Ue})})):(x.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},me.prototype._signin=function(le,ie){var Te=this;return this._signinStart(le,ie,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).then(function(Ue){return Te._signinEnd(Ue.url,le)})},me.prototype._signinStart=function(le,ie){var Te=this,Pe=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ie.prepare(Pe).then(function(Ue){return x.Log.debug("UserManager._signinStart: got navigator window handle"),Te.createSigninRequest(le).then(function(ae){return x.Log.debug("UserManager._signinStart: got signin request"),Pe.url=ae.url,Pe.id=ae.state.id,Ue.navigate(Pe)}).catch(function(ae){throw Ue.close&&(x.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),Ue.close()),ae})})},me.prototype._signinEnd=function(le){var ie=this,Te=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processSigninResponse(le).then(function(Pe){x.Log.debug("UserManager._signinEnd: got signin response");var Ue=new _.User(Pe);if(Te.current_sub){if(Te.current_sub!==Ue.profile.sub)return x.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",Ue.profile.sub),Promise.reject(new Error("login_required"));x.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return ie.storeUser(Ue).then(function(){return x.Log.debug("UserManager._signinEnd: user stored"),ie._events.load(Ue),Ue})})},me.prototype._signinCallback=function(le,ie){x.Log.debug("UserManager._signinCallback");var Te="query"===this._settings.response_mode||!this._settings.response_mode&&z.SigninRequest.isCode(this._settings.response_type)?"?":"#";return ie.callback(le,void 0,Te)},me.prototype.signoutRedirect=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(le=Object.assign({},le)).request_type="so:r";var ie=le.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return ie&&(le.post_logout_redirect_uri=ie),this._signoutStart(le,this._redirectNavigator,{useReplaceToNavigate:le.useReplaceToNavigate}).then(function(){x.Log.info("UserManager.signoutRedirect: successful")})},me.prototype.signoutRedirectCallback=function(le){return this._signoutEnd(le||this._redirectNavigator.url).then(function(ie){return x.Log.info("UserManager.signoutRedirectCallback: successful"),ie})},me.prototype.signoutPopup=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(le=Object.assign({},le)).request_type="so:p";var ie=le.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return le.post_logout_redirect_uri=ie,le.display="popup",le.post_logout_redirect_uri&&(le.state=le.state||{}),this._signout(le,this._popupNavigator,{startUrl:ie,popupWindowFeatures:le.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:le.popupWindowTarget||this.settings.popupWindowTarget}).then(function(){x.Log.info("UserManager.signoutPopup: successful")})},me.prototype.signoutPopupCallback=function(le,ie){return void 0===ie&&"boolean"==typeof le&&(ie=le,le=null),this._popupNavigator.callback(le,ie,"?").then(function(){x.Log.info("UserManager.signoutPopupCallback: successful")})},me.prototype._signout=function(le,ie){var Te=this;return this._signoutStart(le,ie,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).then(function(Ue){return Te._signoutEnd(Ue.url)})},me.prototype._signoutStart=function(){var le=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ie=this,Pe=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return arguments[1].prepare(Pe).then(function(Ue){return x.Log.debug("UserManager._signoutStart: got navigator window handle"),ie._loadUser().then(function(ae){return x.Log.debug("UserManager._signoutStart: loaded current user from storage"),(ie._settings.revokeAccessTokenOnSignout?ie._revokeInternal(ae):Promise.resolve()).then(function(){var Qe=le.id_token_hint||ae&&ae.id_token;return Qe&&(x.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),le.id_token_hint=Qe),ie.removeUser().then(function(){return x.Log.debug("UserManager._signoutStart: user removed, creating signout request"),ie.createSignoutRequest(le).then(function(Ht){return x.Log.debug("UserManager._signoutStart: got signout request"),Pe.url=Ht.url,Ht.state&&(Pe.id=Ht.state.id),Ue.navigate(Pe)})})})}).catch(function(ae){throw Ue.close&&(x.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),Ue.close()),ae})})},me.prototype._signoutEnd=function(le){return this.processSignoutResponse(le).then(function(ie){return x.Log.debug("UserManager._signoutEnd: got signout response"),ie})},me.prototype.revokeAccessToken=function(){var le=this;return this._loadUser().then(function(ie){return le._revokeInternal(ie,!0).then(function(Te){if(Te)return x.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),ie.access_token=null,ie.refresh_token=null,ie.expires_at=null,ie.token_type=null,le.storeUser(ie).then(function(){x.Log.debug("UserManager.revokeAccessToken: user stored"),le._events.load(ie)})})}).then(function(){x.Log.info("UserManager.revokeAccessToken: access token revoked successfully")})},me.prototype._revokeInternal=function(le,ie){var Te=this;if(le){var Ue=le.refresh_token;return this._revokeAccessTokenInternal(le.access_token,ie).then(function(ae){return Te._revokeRefreshTokenInternal(Ue,ie).then(function(Qe){return ae||Qe||x.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),ae||Qe})})}return Promise.resolve(!1)},me.prototype._revokeAccessTokenInternal=function(le,ie){return!le||le.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(le,ie).then(function(){return!0})},me.prototype._revokeRefreshTokenInternal=function(le,ie){return le?this._tokenRevocationClient.revoke(le,ie,"refresh_token").then(function(){return!0}):Promise.resolve(!1)},me.prototype.startSilentRenew=function(){this._silentRenewService.start()},me.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},me.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then(function(le){return le?(x.Log.debug("UserManager._loadUser: user storageString loaded"),_.User.fromStorageString(le)):(x.Log.debug("UserManager._loadUser: no user storageString"),null)})},me.prototype.storeUser=function(le){if(le){x.Log.debug("UserManager.storeUser: storing user");var ie=le.toStorageString();return this._userStore.set(this._userStoreKey,ie)}return x.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},Q(me,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),me}(Z.OidcClient)},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserManagerSettings=void 0;var Q=function(){function se(J,G){for(var H=0;H<G.length;H++){var re=G[H];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(J,re.key,re)}}return function(J,G,H){return G&&se(J.prototype,G),H&&se(J,H),J}}(),x=(ne(0),ne(5)),Z=ne(40),k=ne(41),_=ne(43),b=ne(6),v=ne(1),T=ne(8);function z(se,J){if(!(se instanceof J))throw new TypeError("Cannot call a class as a function")}function U(se,J){if(!se)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!J||"object"!=typeof J&&"function"!=typeof J?se:J}O.UserManagerSettings=function(se){function J(){var G=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},H=G.popup_redirect_uri,re=G.popup_post_logout_redirect_uri,me=G.popupWindowFeatures,oe=G.popupWindowTarget,le=G.silent_redirect_uri,ie=G.silentRequestTimeout,Te=G.automaticSilentRenew,Pe=void 0!==Te&&Te,Ue=G.validateSubOnSilentRenew,ae=void 0!==Ue&&Ue,Qe=G.includeIdTokenInSilentRenew,Ht=void 0===Qe||Qe,Ot=G.monitorSession,zn=void 0===Ot||Ot,en=G.monitorAnonymousSession,It=void 0!==en&&en,dn=G.checkSessionInterval,Et=void 0===dn?2e3:dn,xt=G.stopCheckSessionOnError,rn=void 0===xt||xt,$t=G.query_status_response_type,Kn=G.revokeAccessTokenOnSignout,Zn=void 0!==Kn&&Kn,Lt=G.accessTokenExpiringNotificationTime,qt=void 0===Lt?60:Lt,at=G.redirectNavigator,In=void 0===at?new Z.RedirectNavigator:at,yr=G.popupNavigator,Wn=void 0===yr?new k.PopupNavigator:yr,te=G.iframeNavigator,w=void 0===te?new _.IFrameNavigator:te,S=G.userStore,ee=void 0===S?new b.WebStorageStateStore({store:v.Global.sessionStorage}):S;z(this,J);var ce=U(this,se.call(this,arguments[0]));return ce._popup_redirect_uri=H,ce._popup_post_logout_redirect_uri=re,ce._popupWindowFeatures=me,ce._popupWindowTarget=oe,ce._silent_redirect_uri=le,ce._silentRequestTimeout=ie,ce._automaticSilentRenew=Pe,ce._validateSubOnSilentRenew=ae,ce._includeIdTokenInSilentRenew=Ht,ce._accessTokenExpiringNotificationTime=qt,ce._monitorSession=zn,ce._monitorAnonymousSession=It,ce._checkSessionInterval=Et,ce._stopCheckSessionOnError=rn,ce._query_status_response_type=$t||(arguments[0]&&arguments[0].response_type?T.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":"id_token"),ce._revokeAccessTokenOnSignout=Zn,ce._redirectNavigator=In,ce._popupNavigator=Wn,ce._iframeNavigator=w,ce._userStore=ee,ce}return function(H,re){if("function"!=typeof re&&null!==re)throw new TypeError("Super expression must either be null or a function, not "+typeof re);H.prototype=Object.create(re&&re.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}),re&&(Object.setPrototypeOf?Object.setPrototypeOf(H,re):H.__proto__=re)}(J,se),Q(J,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),J}(x.OidcClientSettings)},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.RedirectNavigator=void 0;var Q=function(){function Z(k,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}return function(k,_,b){return _&&Z(k.prototype,_),b&&Z(k,b),k}}(),x=ne(0);O.RedirectNavigator=function(){function Z(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Z)}return Z.prototype.prepare=function(){return Promise.resolve(this)},Z.prototype.navigate=function(_){return _&&_.url?(_.useReplaceToNavigate?window.location.replace(_.url):window.location=_.url,Promise.resolve()):(x.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},Q(Z,[{key:"url",get:function(){return window.location.href}}]),Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.PopupNavigator=void 0;var Q=ne(0),x=ne(42);O.PopupNavigator=function(){function Z(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Z)}return Z.prototype.prepare=function(_){var b=new x.PopupWindow(_);return Promise.resolve(b)},Z.prototype.callback=function(_,b,v){Q.Log.debug("PopupNavigator.callback");try{return x.PopupWindow.notifyOpener(_,b,v),Promise.resolve()}catch(T){return Promise.reject(T)}},Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.PopupWindow=void 0;var Q=function(){function k(_,b){for(var v=0;v<b.length;v++){var T=b[v];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(_,T.key,T)}}return function(_,b,v){return b&&k(_.prototype,b),v&&k(_,v),_}}(),x=ne(0),Z=ne(3);O.PopupWindow=function(){function k(_){var b=this;(function(U,se){if(!(U instanceof se))throw new TypeError("Cannot call a class as a function")})(this,k),this._promise=new Promise(function(z,U){b._resolve=z,b._reject=U}),this._popup=window.open("",_.popupWindowTarget||"_blank",_.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;"),this._popup&&(x.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return k.prototype.navigate=function(b){return this._popup?b&&b.url?(x.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=b.id,this._id&&(window["popupCallback_"+b.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=b.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},k.prototype._success=function(b){x.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(b)},k.prototype._error=function(b){x.Log.error("PopupWindow.error: ",b),this._cleanup(),this._reject(new Error(b))},k.prototype.close=function(){this._cleanup(!1)},k.prototype._cleanup=function(b){x.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!b&&this._popup.close(),this._popup=null},k.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},k.prototype._callback=function(b,v){this._cleanup(v),b?(x.Log.debug("PopupWindow.callback success"),this._success({url:b})):(x.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},k.notifyOpener=function(b,v,T){if(window.opener){if(b=b||window.location.href){var z=Z.UrlUtility.parseUrlFragment(b,T);if(z.state){var se=window.opener["popupCallback_"+z.state];se?(x.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),se(b,v)):x.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else x.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else x.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},Q(k,[{key:"promise",get:function(){return this._promise}}]),k}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.IFrameNavigator=void 0;var Q=ne(0),x=ne(44);O.IFrameNavigator=function(){function Z(){!function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}(this,Z)}return Z.prototype.prepare=function(_){var b=new x.IFrameWindow(_);return Promise.resolve(b)},Z.prototype.callback=function(_){Q.Log.debug("IFrameNavigator.callback");try{return x.IFrameWindow.notifyParent(_),Promise.resolve()}catch(b){return Promise.reject(b)}},Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.IFrameWindow=void 0;var Q=function(){function Z(k,_){for(var b=0;b<_.length;b++){var v=_[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}return function(k,_,b){return _&&Z(k.prototype,_),b&&Z(k,b),k}}(),x=ne(0);O.IFrameWindow=function(){function Z(k){var _=this;(function(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")})(this,Z),this._promise=new Promise(function(b,v){_._resolve=b,_._reject=v}),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return Z.prototype.navigate=function(_){if(_&&_.url){var b=_.silentRequestTimeout||1e4;x.Log.debug("IFrameWindow.navigate: Using timeout of:",b),this._timer=window.setTimeout(this._timeout.bind(this),b),this._frame.src=_.url}else this._error("No url provided");return this.promise},Z.prototype._success=function(_){this._cleanup(),x.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(_)},Z.prototype._error=function(_){this._cleanup(),x.Log.error(_),this._reject(new Error(_))},Z.prototype.close=function(){this._cleanup()},Z.prototype._cleanup=function(){this._frame&&(x.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},Z.prototype._timeout=function(){x.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},Z.prototype._message=function(_){if(x.Log.debug("IFrameWindow.message"),this._timer&&_.origin===this._origin&&_.source===this._frame.contentWindow&&"string"==typeof _.data&&(_.data.startsWith("http://")||_.data.startsWith("https://"))){var b=_.data;b?this._success({url:b}):this._error("Invalid response from frame")}},Z.notifyParent=function(_){x.Log.debug("IFrameWindow.notifyParent"),(_=_||window.location.href)&&(x.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(_,location.protocol+"//"+location.host))},Q(Z,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),Z}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.UserManagerEvents=void 0;var Q=ne(0),x=ne(16),Z=ne(17);O.UserManagerEvents=function(k){function _(b){!function(z,U){if(!(z instanceof U))throw new TypeError("Cannot call a class as a function")}(this,_);var v=function(z,U){if(!z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!U||"object"!=typeof U&&"function"!=typeof U?z:U}(this,k.call(this,b));return v._userLoaded=new Z.Event("User loaded"),v._userUnloaded=new Z.Event("User unloaded"),v._silentRenewError=new Z.Event("Silent renew error"),v._userSignedIn=new Z.Event("User signed in"),v._userSignedOut=new Z.Event("User signed out"),v._userSessionChanged=new Z.Event("User session changed"),v}return function(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Super expression must either be null or a function, not "+typeof T);v.prototype=Object.create(T&&T.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(v,T):v.__proto__=T)}(_,k),_.prototype.load=function(v){var T=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Q.Log.debug("UserManagerEvents.load"),k.prototype.load.call(this,v),T&&this._userLoaded.raise(v)},_.prototype.unload=function(){Q.Log.debug("UserManagerEvents.unload"),k.prototype.unload.call(this),this._userUnloaded.raise()},_.prototype.addUserLoaded=function(v){this._userLoaded.addHandler(v)},_.prototype.removeUserLoaded=function(v){this._userLoaded.removeHandler(v)},_.prototype.addUserUnloaded=function(v){this._userUnloaded.addHandler(v)},_.prototype.removeUserUnloaded=function(v){this._userUnloaded.removeHandler(v)},_.prototype.addSilentRenewError=function(v){this._silentRenewError.addHandler(v)},_.prototype.removeSilentRenewError=function(v){this._silentRenewError.removeHandler(v)},_.prototype._raiseSilentRenewError=function(v){Q.Log.debug("UserManagerEvents._raiseSilentRenewError",v.message),this._silentRenewError.raise(v)},_.prototype.addUserSignedIn=function(v){this._userSignedIn.addHandler(v)},_.prototype.removeUserSignedIn=function(v){this._userSignedIn.removeHandler(v)},_.prototype._raiseUserSignedIn=function(){Q.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},_.prototype.addUserSignedOut=function(v){this._userSignedOut.addHandler(v)},_.prototype.removeUserSignedOut=function(v){this._userSignedOut.removeHandler(v)},_.prototype._raiseUserSignedOut=function(){Q.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},_.prototype.addUserSessionChanged=function(v){this._userSessionChanged.addHandler(v)},_.prototype.removeUserSessionChanged=function(v){this._userSessionChanged.removeHandler(v)},_.prototype._raiseUserSessionChanged=function(){Q.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},_}(x.AccessTokenEvents)},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Timer=void 0;var Q=function(){function v(T,z){for(var U=0;U<z.length;U++){var se=z[U];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(T,se.key,se)}}return function(T,z,U){return z&&v(T.prototype,z),U&&v(T,U),T}}(),x=ne(0),Z=ne(1),k=ne(17);function _(v,T){if(!(v instanceof T))throw new TypeError("Cannot call a class as a function")}function b(v,T){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!T||"object"!=typeof T&&"function"!=typeof T?v:T}O.Timer=function(v){function T(z){var U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.Global.timer,se=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;_(this,T);var J=b(this,v.call(this,z));return J._timer=U,J._nowFunc=se||function(){return Date.now()/1e3},J}return function(U,se){if("function"!=typeof se&&null!==se)throw new TypeError("Super expression must either be null or a function, not "+typeof se);U.prototype=Object.create(se&&se.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),se&&(Object.setPrototypeOf?Object.setPrototypeOf(U,se):U.__proto__=se)}(T,v),T.prototype.init=function(U){U<=0&&(U=1),U=parseInt(U);var se=this.now+U;if(this.expiration===se&&this._timerHandle)x.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),x.Log.debug("Timer.init timer "+this._name+" for duration:",U),this._expiration=se;var J=5;U<J&&(J=U),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*J)}},T.prototype.cancel=function(){this._timerHandle&&(x.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},T.prototype._callback=function(){x.Log.debug("Timer.callback; "+this._name+" timer expires in:",this._expiration-this.now),this._expiration<=this.now&&(this.cancel(),v.prototype.raise.call(this))},Q(T,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),T}(k.Event)},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.SilentRenewService=void 0;var Q=ne(0);O.SilentRenewService=function(){function x(Z){(function(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")})(this,x),this._userManager=Z}return x.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then(function(k){}).catch(function(k){Q.Log.error("SilentRenewService.start: Error from getUser:",k.message)}))},x.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},x.prototype._tokenExpiring=function(){var k=this;this._userManager.signinSilent().then(function(_){Q.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")},function(_){Q.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",_.message),k._userManager.events._raiseSilentRenewError(_)})},x}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CordovaPopupNavigator=void 0;var Q=ne(21);O.CordovaPopupNavigator=function(){function x(){!function(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}(this,x)}return x.prototype.prepare=function(k){var _=new Q.CordovaPopupWindow(k);return Promise.resolve(_)},x}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.CordovaIFrameNavigator=void 0;var Q=ne(21);O.CordovaIFrameNavigator=function(){function x(){!function(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}(this,x)}return x.prototype.prepare=function(k){k.popupWindowFeatures="hidden=yes";var _=new Q.CordovaPopupWindow(k);return Promise.resolve(_)},x}()},function(Ge,O,ne){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Version="1.11.5"}])}},Si=>{Si(Si.s=784)}]);