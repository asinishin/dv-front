(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"03Ts":function(t,n,e){},"3W34":function(t,n){t.exports='<div class="ff-grid gutter-v-half gutter-h-half fp-grid"> <ff-panel flex="0 1 auto" class="ff-flex-start" style="z-index:1" ngf-drop="$ctrl.upload($ctrl.plan, $files, $invalidFiles)" ngf-pattern="\'image/png,image/jpeg\'" ngf-drag-over-class="dragover"> <div class="ff-relative" flex="none" ng-click="$ctrl.onPlanClick($event)" ff-dim="!$ctrl.plan.$$imageLoaded"> <ff-img ff-src="{{$ctrl.plan.image}}" ff-img-loaded="$ctrl.plan.$$imageLoaded" class="fp-image" ff-alt="Floor Plan"></ff-img> <div class="fp-points" dnd-list dnd-drop="callback({ list: $ctrl.plan.points, targetIndex: index, event: event })"> <div ng-repeat="point in $ctrl.plan.points" dnd-draggable="null" dnd-callback="$ctrl.dropPoint(list, $index, event)" ng-click="$ctrl.onPointClick(point, $event)" class="fp-point ff-tip-trigger" ng-class="{ available: $ctrl.isAvailable(point.$$unit), selected: $ctrl.point === point, invalid: !point.$$unit }" ng-style="{ top: point.y + \'%\', left: point.x + \'%\' }"> <ng-transclude ng-transclude-slot="hoverTip"></ng-transclude> </div> </div> </div> </ff-panel> <div flex="{md: \'0 1 352px\'}" ng-if="$ctrl.point"> <div ng-transclude="focusContent"></div> </div> <div flex="{md: \'0 1 352px\'}" ng-if="!$ctrl.point" class="ff-flex-start"> <div ng-transclude="noFocusContent"></div> </div> </div> '},"4tyb":function(t,n,e){},BQyx:function(t,n){t.exports='<div class="floor-plans"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <div class="ff-grid gutter-v-half gutter-h-half"> <ff-panel flex="{md: \'0 0 40%\'}" class="ff-flex-start"> <ff-panel-header><span translate="FLOOR_PLANS.SELECT_A_PLAN"></span></ff-panel-header> <ff-row ff-dim="!$ctrl.plans"> <ff-select name="floorPlan" ff-model="$ctrl.plan" class="ff-read-only-ignore" ff-options="p.name || \'-\' for p in $ctrl.plans"></ff-select> <ff-btn-group class="buttons-row" flex="none"> <ff-btn sense="add" size="xs" ff-click="$ctrl.addPlan()"></ff-btn> </ff-btn-group> </ff-row> <ng-transclude ng-transclude-slot="selectorExtra" class="hide-empty"></ng-transclude> </ff-panel> <ng-transclude ng-transclude-slot="planSettings" flex="{md: \'0 0 60%\'}" class="hide-empty"></ng-transclude> <floor-plan ng-if="$ctrl.plan.image" class="animate-collapse" plan="$ctrl.plan" save="$ctrl.save()" point="$ctrl.point" is-available="$ctrl.isAvailable"> <hover-tip> <ng-transclude ng-transclude-slot="hoverTip"></ng-transclude> </hover-tip> <focus-content> <ng-transclude ng-transclude-slot="focusContent"></ng-transclude> </focus-content> <no-focus-content> <ng-transclude ng-transclude-slot="noFocusContent"></ng-transclude> </no-focus-content> </floor-plan> <ng-transclude ng-transclude-slot="bottomExtra" class="hide-empty"></ng-transclude> </div> </div> '},BRh7:function(t,n){t.exports='<floor-plans plans="$ctrl.plans" plan="$ctrl.plan" point="$ctrl.point" is-available="$ctrl.isAvailable" ff-bulk-read-only="true"> <hover-tip ng-init="point = $parent.$parent.point"> <ff-tip ng-if="point.$$unit" tip-type="white"> <ff-header>{{point.$$unit.name}}</ff-header> <ff-row> <ff-label flex="0 1 60px"><span translate="FLOOR_PLANS.POINT.STATUS"></span></ff-label> <ff-static><span translate="{{\'FLOOR_PLANS.POINT.STATUS.\' + (point.$$unit.availableFullTime ? \'AVAILABLE\' : \'NOT_AVAILABLE\')}}"></span></ff-static> </ff-row> <ff-row ng-if="point.$$unit.attachedUserName && !point.$$unit.$$user"> <ff-label flex="0 1 60px"><span translate="FLOOR_PLANS.POINT.MEMBER"></span></ff-label> <ff-static>{{point.$$unit.attachedUserName}}</ff-static> </ff-row> <ff-static ng-if="point.$$unit.$$user" class="ff-no-frame"> <ff-img flex="0 0 60px" class="fp-avatar" ff-src="{{point.$$unit.$$user.photo}}" ng-if="point.$$unit.$$user.photo" ff-alt="{{point.$$unit.$$user.name}}"></ff-img> <ff-col flex="auto"> <ff-col flex="auto" class="fp-user-container"> <div class="fp-user-name">{{point.$$unit.$$user.name}}</div> <div class="fp-user-company">{{point.$$unit.$$user.company}}</div> </ff-col> <ff-btn flex="none" sense="userSelect" size="sm" class="fp-btn-more" ff-click="$ctrl.more(point)"> <span translate="FLOOR_PLANS.POINT.BTN_MORE"></span> </ff-btn> </ff-col> </ff-static> </ff-tip> </hover-tip> </floor-plans> '},DLcK:function(t,n,e){"use strict";e.r(n);e("03Ts");var a=e("3W34"),r=e.n(a),l=e("tUjE"),i=e("JVmQ"),o=e("I5Zy");n.default=angular.module("deskworks.floorPlanDirective",[o.a.name,l.default.name,i.default.name]).directive("floorPlan",(function(){return{template:r.a,restrict:"E",scope:!0,controller:"FloorPlanDirectiveCtrl as $ctrl",transclude:{hoverTip:"?hoverTip",focusContent:"?focusContent",noFocusContent:"?noFocusContent"},bindToController:{plan:"<",point:"=?",save:"&",isAvailable:"<?"}}})).controller("FloorPlanDirectiveCtrl",["$element","$scope","$window","state","dwAlerts","helper",function(t,n,e,a,r,l){var i=this;i.$onInit=function(){},i.onPointClick=function(t,n){i.point=t,n&&n.stopPropagation()},i.onPlanClick=function(e){if(n.ffBlock.editMode){var a=t[0].querySelector(".fp-image"),r={x:l.round(100*e.offsetX/a.offsetWidth),y:l.round(100*e.offsetY/a.offsetHeight)};i.plan.points.push(r),i.onPointClick(r)}},i.dropPoint=function(e,a,r){if(n.ffBlock.editMode){var o=e[a],f=t[0].querySelector(".fp-image");return o.x=l.round(100*r.offsetX/f.offsetWidth),o.y=l.round(100*r.offsetY/f.offsetHeight),i.save(i.plan),!0}}}])},EFlW:function(t,n){t.exports='<ff-panel> <div class="ff-col"> <div> <ff-header><span translate="FLOOR_PLANS.POINT.HEADER"></span></ff-header> <ff-select name="reservationCategory" ff-model="$ctrl.point.$$category" ff-required="true" ff-validate-alert="{{\'FLOOR_PLANS.CATEGORY\' | translate}}" ff-options="opt.name for opt in $ctrl.categories | filter: $ctrl.filterCategory"></ff-select> <ff-select name="reservationUnit" ff-model="$ctrl.point.$$unit" ff-change="$ctrl.save()" ff-required="true" ff-validate-alert="{{\'FLOOR_PLANS.UNIT\' | translate}}" ff-options="opt.name for opt in $ctrl.units | filter: $ctrl.filterUnit"></ff-select> </div> <ff-static ng-if="!$ctrl.point.$$category || !$ctrl.point.$$unit" class="ff-no-frame"> <span ng-if="!$ctrl.point.$$category"><ff-icon sense="info"></ff-icon> <span translate="FLOOR_PLANS.CATEGORY.HINT"></span></span> <span ng-if="$ctrl.point.$$category && !$ctrl.point.$$unit"><ff-icon sense="info"></ff-icon> <span translate="FLOOR_PLANS.UNIT.HINT"></span></span> </ff-static> <ff-btn-group style="margin-top:.5rem"> <ff-btn sense="delete" size="sm" ff-click="$ctrl.deletePoint()"><span translate="FLOOR_PLANS.POINT.BTN_DELETE"></span></ff-btn> </ff-btn-group> </div> </ff-panel> '},F4bp:function(t,n,e){"use strict";e.r(n);e("4tyb");var a=e("BQyx"),r=e.n(a);n.default=angular.module("deskworks.floorPlansDirective",[]).directive("floorPlans",(function(){return{template:r.a,restrict:"E",scope:!0,controller:"FloorPlansDirectiveCtrl as $ctrl",transclude:{hoverTip:"?hoverTip",focusContent:"?focusContent",noFocusContent:"?noFocusContent",selectorExtra:"?selectorExtra",planSettings:"?planSettings",bottomExtra:"?bottomExtra"},bindToController:{plans:"<",plan:"=?",point:"=?",save:"&",isAvailable:"<?"}}})).controller("FloorPlansDirectiveCtrl",["$scope","FloorPlan",function(t,n){var e=this;e.$onInit=function(){},e.$onChanges=function(){e.plans&&!e.plan&&(e.plan=e.plans[0])},e.addPlan=function(){e.plan=n.new(),e.plans.push(e.plan)}}])},Gn9L:function(t,n,e){},JVmQ:function(t,n,e){"use strict";e.r(n);var a=e("0zKI"),r=e.n(a),l=e("EFlW"),i=e.n(l);n.default=angular.module("deskworks.floorPlanPointSettingsDirective",[]).directive("floorPlanPointSettings",(function(){return{template:i.a,restrict:"E",scope:!0,controller:"FloorPlanPointSettingsDirectiveCtrl as $ctrl",bindToController:{plan:"<",point:"=",categories:"<",units:"<",save:"&"}}})).controller("FloorPlanPointSettingsDirectiveCtrl",["$scope",function(t){var n=this;n.deletePoint=function(){var t;if(n.point)return r()(t=n.plan.points).call(t,n.plan.points.indexOf(n.point),1),n.point=null,n.save(n.plan)},n.filterCategory=function(t){return t.$$hasUnits||n.point&&t===n.point.$$category},n.filterUnit=function(t){return t.reservationTypeId===(n.point&&n.point.$$category&&n.point.$$category.id)&&(!t.$$hasPoint||n.point.$$unit===t)}}])},JZQZ:function(t,n,e){"use strict";e.r(n);var a=e("03wM"),r=e.n(a),l=e("Ekwr"),i=e.n(l),o=e("lvz6"),f=e.n(o),s=e("yKah"),c=e.n(s),u=e("fzuT"),p=e.n(u),d=(e("3dw1"),e("yCd9")),$=e.n(d),m=e("6RpP"),v=e.n(m),g=e("nbuU"),h=e.n(g),b=e("hsT8"),P=e.n(b),O=e("Sh1H"),L=e("F4bp"),I=e("2/1H"),T=e("ZNCF");function x(t,n){var e=r()(t);if(i.a){var a=i()(t);n&&(a=P()(a).call(a,(function(n){return f()(t,n).enumerable}))),e.push.apply(e,a)}return e}function A(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?x(Object(e),!0).forEach((function(n){p()(t,n,e[n])})):c.a?Object.defineProperties(t,c()(e)):x(Object(e)).forEach((function(n){Object.defineProperty(t,n,f()(e,n))}))}return t}n.default=angular.module("deskworks.FloorPlansReservationCtrl",["deskworks.reservationCategory.service","deskworks.calendarService",O.default.name,L.default.name,I.a.name,T.a.name]).controller("FloorPlansReservationCtrl",["$scope","$translate","$filter","$q","$window","$timeout","session","dwAlerts","state","helper","FloorPlan","ReservationUnit","calendarService","OurMembers",function(t,n,e,a,r,l,i,o,f,s,c,u,p,d){var m=this;f.setPageTitle(n.instant("FLOOR_PLANS.PAGE_TITLE")),m.onInit=function(){l((function(){m.fetch().then((function(t){t.plans;var n,e=t.categories,a=t.units,r=t.members;m.categories=$()(e).call(e,(function(t){return s.pick(t,["id","name"])})),e.forEach((function(t){t.reservationUnits.forEach((function(n){n.reservationTypeId=t.id}))})),m.units=$()(n=e.reduce((function(t,n){return v()(t).call(t,n.reservationUnits)}),[])).call(n,(function(t){var n,e=h()(a).call(a,(function(n){return n.id===t.id}))||{},l=s.pick(A(A({},e),t),["id","name","description","area","capacity","thumbnail","photo","whoCanReserve","reservations","availabilities","attachedUserId","attachedUserName","availableFullTime","reservationTypeId"]),i=h()(n=t.reservations).call(n,(function(t){return t.from.isSameOrBefore(moment())&&t.to.isSameOrAfter(moment())}))||{};return(l.attachedUserId||i.userId)&&(l.$$user=h()(r).call(r,(function(t){return t.id===(l.attachedUserId||i.userId)}))),l})),m.plan=m.plans[0],m.plans.forEach((function(t){var n;t.points.forEach((function(t){var n,e;t.$$unit=h()(n=m.units).call(n,(function(n){return n.id===t.reservationUnitId})),t.$$category=t.$$unit&&h()(e=m.categories).call(e,(function(n){return n.id===t.$$unit.reservationTypeId}))})),t.points=P()(n=t.points).call(n,(function(t){return!!t.$$unit}))}))}))}))},m.isAvailable=function(t){return!!t&&"notAvailable"!==t.whoCanReserve&&"staffOnly"!==t.whoCanReserve&&t.availabilities.length>0},m.isReservable=function(t){return i.isAdmin()||!!t&&"notAvailable"!==t.whoCanReserve&&t.availabilities.length>0},m.reserve=function(){return f.setParam("unit",m.point.$$unit.id),f.setPath(f.getPath()+"/reservation")},m.fetchPlans=function(){return c.query(f.getCurrentCenterId()).catch((function(t){return o.error(t,"Failed to query floor plans.")})).then((function(t){m.plans=t}))},m.fetch=function(){var t={};return t.plans=m.fetchPlans(),t.units=u.query(f.getCurrentCenterId()).catch((function(t){return o.error(t,"Failed to query reservation units.")})),t.categories=p.query(f.getCurrentCenterId(),moment(),moment()).catch((function(t){return o.error(t,"Failed to query calendar.")})),t.members=d.query({centerId:f.getCurrentCenterId(),limit:1e4}).catch((function(t){return o.error(t,"Failed to query our members.")})),a.all(t)},m.onInit()}])},Sh1H:function(t,n,e){"use strict";e.r(n),n.default=angular.module("deskworks.FloorPlan",["ngResource","ngFileUpload","deskworks.config"]).factory("FloorPlan",["$resource","$timeout","Upload","deskworksConfig",function(t,n,e,a){var r=t(a.getApiAbsUrl("/floor-plans/:id"),{},{update:{method:"PUT"}});return{new:function(){return{enabled:!0,pricingEnabled:!0,areaEnabled:!0,points:[]}},query:function(t){return r.query({centerId:t}).$promise},save:function(t,n){return n.id?r.update({id:n.id,centerId:t},n).$promise:r.save({centerId:t},n).$promise.then((function(t){return n.id=t.id,t}))},delete:function(t){return r.delete({id:t}).$promise},uploadImage:function(t,n){return e.upload({url:a.getApiAbsUrl("/floor-plans/".concat(t)),method:"PUT",withCredentials:!0,data:{image:n}})}}}])},"SjL+":function(t,n,e){"use strict";e.r(n);e("8cZI");var a=e("hBaI"),r=e.n(a);n.default=angular.module("deskworks.floorPlanEmbeddingDirective",["deskworks.config"]).directive("floorPlanEmbedding",(function(){return{template:r.a,restrict:"E",scope:!0,controller:"FloorPlanEmbeddingDirectiveCtrl as $ctrl",bindToController:{floorPlan:"<"}}})).controller("FloorPlanEmbeddingDirectiveCtrl",["$scope","state","helper","deskworksConfig",function(t,n,e,a){var r=this;r.$onInit=function(){var t=a.getApiOrigin(),l=n.getCurrentCenterId();r.maxWidth="100%",r.maxHeight="600px",r.getCode=function(n){return e.join(["<script dw-floor-plans",'dw-center-id="'.concat(l,'"'),r.all?null:'dw-floor-plan-id="'.concat(r.floorPlan.id,'"'),'dw-origin="'.concat(t,'"'),'src="'.concat(t,'/floor-plans.js"'),'max-width="'.concat(r.maxWidth?r.maxWidth:"none",'"'),'max-height="'.concat(r.maxHeight?r.maxHeight:"none",'"'),'class="dw-spin"><\/script>']," ")}}}])},ZNCF:function(t,n,e){"use strict";var a=e("fzuT"),r=e.n(a),l=e("yCd9"),i=e.n(l),o=e("6RpP"),f=e.n(o),s=e("hsT8"),c=e.n(s),u=e("03wM"),p=e.n(u),d=e("Ekwr"),$=e.n(d),m=e("lvz6"),v=e.n(m),g=e("yKah"),h=e.n(g),b=(e("3dw1"),e("z3Z1")),P=e.n(b);e("Gn9L");function O(t,n){var e=p()(t);if($.a){var a=$()(t);n&&(a=c()(a).call(a,(function(n){return v()(t,n).enumerable}))),e.push.apply(e,a)}return e}function L(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?O(Object(e),!0).forEach((function(n){r()(t,n,e[n])})):h.a?Object.defineProperties(t,h()(e)):O(Object(e)).forEach((function(n){Object.defineProperty(t,n,v()(e,n))}))}return t}n.a=angular.module("deskworks.resBar",[]).component("resBar",{template:P.a,controller:"ResBarCtrl",bindings:{unit:"<",availabilities:"=?"}}).controller("ResBarCtrl",["$scope","$filter",function(t,n){var e=this;e.$onInit=function(){t.$watchCollection("$ctrl.unit.availabilities",(function(){if(e.unit){var t=[];e.unit.availabilities.forEach((function(n){t.push(moment.range(n.from,n.to))})),e.unit.reservations.forEach((function(n){var e=moment.range(n.from,n.to);t=i()(t).call(t,(function(t){return t.subtract(e)})).reduce((function(t,n){return f()(t).call(t,n)}),[])})),t=c()(t).call(t,(function(t){return(t.end-t.start)/36e5>=(e.unit.limitMin||0)})),e.availabilities=function(t){if(!t||!t.length)return[];var n=t[0].from,e=t[t.length-1].to;return i()(t).call(t,(function(t){return L(L({},t),{},{x1:a(t.from),x2:a(t.to)})}));function a(t){return 100*(t-n)/(e-n)}}(i()(t).call(t,(function(t){return{from:t.start,to:t.end}})))}}))}}])},aGPx:function(t,n,e){},cfxb:function(t,n){t.exports='<ff-panel> <div ng-if="$ctrl.view === \'public\'"> <ff-header>{{$ctrl.point.$$unit.name}}</ff-header> <ff-img class="fp-unit-photo" ng-if="$ctrl.point.$$unit.photo" ff-alt="{{$ctrl.point.$$unit.name}}" ff-src="{{$ctrl.point.$$unit.thumbnail}}" ff-src-hq="{{$ctrl.point.$$unit.photo}}"></ff-img> <ff-static class="fp-descr" ng-if="$ctrl.point.$$unit.description">{{$ctrl.point.$$unit.description}}</ff-static> <ff-row ng-if="$ctrl.point.$$unit.capacity"> <ff-static><span translate="GLOBAL.UNIT_CAPACITY" translate-values="{ capacity: $ctrl.point.$$unit.capacity }"></span></ff-static> </ff-row> <ff-row> <ff-label flex="0 0 52px"><span translate="FLOOR_PLANS.POINT.STATUS"></span></ff-label> <ff-static> <span translate="{{\'FLOOR_PLANS.POINT.STATUS.\' + ($ctrl.point.$$unit.availableFullTime ? \'AVAILABLE\' : \'NOT_AVAILABLE\')}}"></span> </ff-static> </ff-row> <ff-row ng-if="$ctrl.pricingEnabled && $ctrl.point.$$unit.fullTimePrice"> <ff-label flex="0 0 52px"><span translate="FLOOR_PLANS.POINT.PRICE"></span></ff-label> <ff-static>{{$ctrl.point.$$unit.fullTimePrice | ncurrency}}</ff-static> </ff-row> <ff-row ng-if="$ctrl.areaEnabled && $ctrl.point.$$unit.area"> <ff-label flex="0 0 52px"><span translate="FLOOR_PLANS.POINT.AREA"></span></ff-label> <ff-static>{{$ctrl.point.$$unit.area}} {{$ctrl.areaUnit}}</ff-static> </ff-row> </div> <div ng-if="$ctrl.view === \'community\'"> <ff-header>{{$ctrl.point.$$unit.name}}</ff-header> <div> <ff-row> <ff-label flex="0 1 80px"><span translate="FLOOR_PLANS.POINT.STATUS"></span></ff-label> <ff-static> <span translate="{{\'FLOOR_PLANS.POINT.STATUS.\' + ($ctrl.point.$$unit.availableFullTime ? \'AVAILABLE\' : \'NOT_AVAILABLE\')}}"></span> </ff-static> </ff-row> <ff-row ng-if="$ctrl.point.$$unit.attachedUserName && !$ctrl.point.$$unit.$$user"> <ff-label flex="0 1 80px"><span translate="FLOOR_PLANS.POINT.MEMBER"></span></ff-label> <ff-static>{{$ctrl.point.$$unit.attachedUserName}}</ff-static> </ff-row> <ff-row ng-if="$ctrl.point.$$unit.$$user"> <ff-static> <ff-img flex="0 0 60px" class="fp-avatar" ff-src="{{$ctrl.point.$$unit.$$user.photo}}" ng-if="$ctrl.point.$$unit.$$user.photo" ff-alt="{{$ctrl.point.$$unit.$$user.name}}"></ff-img> <ff-col style="margin-right:.5rem;padding:.5rem 0"> <span class="fp-user-name">{{$ctrl.point.$$unit.$$user.name}}</span> <span class="fp-user-company">{{$ctrl.point.$$unit.$$user.company}}</span> </ff-col> <ff-btn flex="none" sense="userSelect" size="sm" class="fp-btn-more" ff-click="$ctrl.more()"> <span translate="FLOOR_PLANS.POINT.BTN_MORE"></span> </ff-btn> </ff-static> </ff-row> <ff-row ng-if="$ctrl.point.$$unit.fullTimeProductId && ffBlock.editMode"> <ff-label flex="0 1 80px"><span translate="FLOOR_PLANS.POINT.PRODUCT"></span></ff-label> <ff-static>{{$ctrl.point.$$unit.fullTimeProductName}}</ff-static> </ff-row> <ff-row ng-if="$ctrl.point.$$unit.fullTimeProductId && ffBlock.editMode"> <ff-label flex="0 1 80px"><span translate="FLOOR_PLANS.POINT.PRICE"></span></ff-label> <ff-static>{{$ctrl.point.$$unit.fullTimePrice | ncurrency}}</ff-static> </ff-row> <ff-row ng-if="$ctrl.point.$$unit.fullTimeProductId && ffBlock.editMode"> <ff-label flex="0 1 80px"><span translate="FLOOR_PLANS.POINT.NET"></span></ff-label> <ff-static>{{$ctrl.point.$$unit.fullTimeNet | ncurrency}}</ff-static> </ff-row> <ff-row ng-if="$ctrl.point.$$unit.fullTimeProductId && ffBlock.editMode"> <ff-label flex="0 1 80px"><span translate="FLOOR_PLANS.POINT.DISCOUNT"></span></ff-label> <ff-static>{{$ctrl.point.$$unit.fullTimeDiscount | ncurrency}}</ff-static> </ff-row> </div> </div> </ff-panel> '},e32L:function(t,n,e){"use strict";e.r(n);var a=e("wOy2"),r=e.n(a);n.default=angular.module("deskworks.floorPlanSettingsDirective",[]).directive("floorPlanSettings",(function(){return{template:r.a,restrict:"E",scope:!0,controller:"FloorPlanSettingsDirectiveCtrl as $ctrl",bindToController:{plan:"<",upload:"<",save:"&",delete:"&"}}})).controller("FloorPlanSettingsDirectiveCtrl",["$scope",function(t){}])},eL8s:function(t,n,e){"use strict";e.r(n);e("3dw1"),e("Muwe"),e("y89P");var a=e("yCd9"),r=e.n(a),l=e("lRNC"),i=e.n(l),o=e("BZ5f"),f=["$injector",function(t){var n,a,l=(n=e("xlK/"),r()(a=i()(n).call(n)).call(a,n));t.loadNewModules(r()(l).call(l,(function(t){return t.default.name}))),t.loadNewModules([o.a.name]),t.invoke(["$templateCache",function(t){var n=e("zB24");i()(n).call(n).forEach((function(e){return t.put(e.replace(/^\.\//,""),n(e))}))}])}];n.default=f},h2Ow:function(t,n,e){"use strict";e.r(n);e("3dw1");var a=e("yCd9"),r=e.n(a),l=e("nbuU"),i=e.n(l),o=e("hsT8"),f=e.n(o),s=(e("jUNa"),e("Sh1H")),c=e("F4bp"),u=e("2/1H"),p=e("iAzO");n.default=angular.module("deskworks.FloorPlansCommunityCtrl",["deskworks.reservationCategory.service",s.default.name,c.default.name,u.a.name,p.a.name]).controller("FloorPlansCommunityCtrl",["$scope","$translate","$filter","$q","$window","$timeout","dwModal","session","dwAlerts","state","helper","FloorPlan","ReservationUnit","reservationCategoryService","OurMembers",function(t,n,e,a,l,o,s,c,u,p,d,$,m,v,g){var h=this;p.setPageTitle(n.instant("FLOOR_PLANS.PAGE_TITLE")),h.onInit=function(){o((function(){h.fetch().then((function(t){t.plans;var n=t.reservationCategories,e=t.reservationUnits,a=t.members;h.categories=r()(n).call(n,(function(t){return d.pick(t,["id","name"])})),h.units=r()(e).call(e,(function(t){var n=d.pick(t,["id","name","description","area","capacity","thumbnail","photo","attachedUserId","attachedUserName","availableFullTime","fullTimeProductId","fullTimeProductName","fullTimePrice","fullTimeNet","fullTimeDiscount","reservationTypeId"]);return n.attachedUserId&&(n.$$user=i()(a).call(a,(function(t){return t.id===n.attachedUserId}))),n})),h.plan=h.plans[0],h.plans.forEach((function(t){var n;t.points.forEach((function(t){var n,e;t.$$unit=i()(n=h.units).call(n,(function(n){return n.id===t.reservationUnitId})),t.$$category=t.$$unit&&i()(e=h.categories).call(e,(function(n){return n.id===t.$$unit.reservationTypeId}))})),t.points=f()(n=t.points).call(n,(function(t){return!!t.$$unit}))}))}))}))},h.isAvailable=function(t){return!!t&&t.availableFullTime},h.more=function(n){s.show({scope:t,templateUrl:"members/our-members/our-member-modal.tpl.html",controller:"OurMemberModalCtrl",inputs:{member:n.$$unit.$$user}})},h.fetchPlans=function(){return $.query(p.getCurrentCenterId()).catch((function(t){return u.error(t,"Failed to query floor plans.")})).then((function(t){h.plans=t}))},h.fetch=function(){var t={};return t.plans=h.fetchPlans(),t.reservationCategories=v.query(p.getCurrentCenterId()).catch((function(t){return u.error(t,"Failed to query reservation categories.")})),t.reservationUnits=m.query(p.getCurrentCenterId()).catch((function(t){return u.error(t,"Failed to query reservation units.")})),t.members=g.query({centerId:p.getCurrentCenterId(),limit:1e4}).catch((function(t){return u.error(t,"Failed to query our members.")})),a.all(t)},h.onInit()}])},hBaI:function(t,n){t.exports='<ff-panel> <ff-panel-header><span translate="FLOOR_PLANS.EMBEDDING.HEADER"></span></ff-panel-header> <div class="ff-grid"> <ff-static flex="{md: \'0 0 50%\'}"> <label><ff-checkbox ff-model="$ctrl.all"><span translate="FLOOR_PLANS.EMBEDDING.ALL"></span></ff-checkbox></label> &nbsp; <ff-hint><span translate="FLOOR_PLANS.EMBEDDING.ALL.HINT"></span></ff-hint> </ff-static> <div class="ff-row" flex="{md: \'0 0 50%\'}"> <label class="ff-row" flex="0 0 150px"> <ff-label>Max width</ff-label> <ff-text flex="0 0 60px" placeholder="none" ff-model="$ctrl.maxWidth"></ff-text> </label> <label class="ff-row" flex="0 0 150px"> <ff-label>Max height</ff-label> <ff-text flex="0 0 60px" placeholder="none" ff-model="$ctrl.maxHeight"></ff-text> </label> <ff-static flex="auto"></ff-static> </div> </div> <ff-static><span translate="FLOOR_PLANS.EMBEDDING.HINT"></span></ff-static> <ff-static ff-style="{\'white-space\': \'pre-wrap\', \'font-family\': \'monospace\', \'font-size\': \'.85em\', \'line-height\': \'1.25\'}">{{$ctrl.getCode()}}</ff-static> </ff-panel> '},hfBW:function(t,n,e){"use strict";e.r(n);e("3dw1"),e("JBxO"),e("FdtR");var a=e("yCd9"),r=e.n(a),l=e("nbuU"),i=e.n(l),o=e("hsT8"),f=e.n(o),s=e("0zKI"),c=e.n(s),u=(e("aGPx"),e("Sh1H")),p=e("DLcK"),d=e("e32L"),$=e("SjL+"),m=e("2/1H");n.default=angular.module("deskworks.FloorPlansCtrl",["autoSave","deskworks.reservationCategory.service",u.default.name,p.default.name,d.default.name,$.default.name,m.a.name,"deskworks.OurMembers"]).controller("FloorPlansCtrl",["$scope","$translate","$filter","$q","$window","$timeout","session","dwAlerts","state","helper","autoSave","FloorPlan","ReservationUnit","reservationCategoryService","OurMembers",function(t,n,e,a,l,o,s,u,p,d,$,m,v,g,h){var b=this;p.setPageTitle(n.instant("FLOOR_PLANS.PAGE_TITLE")),b.onInit=function(){o((function(){b.view="community",b.fetch().then((function(n){n.plans;var e=n.reservationCategories,a=n.reservationUnits,l=n.members;b.categories=r()(e).call(e,(function(t){return d.pick(t,["id","name"])})),b.units=r()(a).call(a,(function(t){var n=d.pick(t,["id","name","description","area","capacity","thumbnail","photo","attachedUserId","attachedUserName","availableFullTime","fullTimeProductId","fullTimeProductName","fullTimePrice","fullTimeNet","fullTimeDiscount","reservationTypeId"]);return n.attachedUserId&&(n.$$user=i()(l).call(l,(function(t){return t.id===n.attachedUserId}))),n})),b.plan=b.plans[0],b.plans.forEach((function(t){t.points.forEach((function(t){var n,e;t.$$unit=i()(n=b.units).call(n,(function(n){return n.id===t.reservationUnitId})),t.$$category=t.$$unit&&i()(e=b.categories).call(e,(function(n){return n.id===t.$$unit.reservationTypeId}))}))})),t.$watchCollection((function(){var t;return b.plan?r()(t=b.plan.points).call(t,(function(t){return(t.$$unit||{}).id})):[]}),(function(){b.units.forEach((function(t){var n;t.$$hasPoint=!!i()(n=b.plan.points).call(n,(function(n){return n.$$unit===t}))})),b.categories.forEach((function(t){var n;t.$$hasUnits=!!i()(n=b.units).call(n,(function(n){return!n.$$hasPoint&&n.reservationTypeId===t.id}))}))}))})),t.$watch("$ctrl.plan",(function(){b.point=null}))}))},b.isAvailable=function(t){return!!t&&t.availableFullTime},b.fetchPlans=function(){return m.query(p.getCurrentCenterId()).catch((function(t){return u.error(t,"Failed to query floor plans.")})).then((function(t){b.plans=t}))},b.fetch=function(){var t={};return t.plans=b.fetchPlans(),t.reservationCategories=g.query(p.getCurrentCenterId()).catch((function(t){return u.error(t,"Failed to query reservation categories.")})),t.reservationUnits=v.query(p.getCurrentCenterId()).catch((function(t){return u.error(t,"Failed to query reservation units.")})),t.members=h.query({centerId:p.getCurrentCenterId(),limit:1e4}).catch((function(t){return u.error(t,"Failed to query our members.")})),a.all(t)},b.save=$.wrap((function(){var t;if(d.pointFirstInvalid("floor-plan-settings"))return;var n=d.pick(b.plan,["id","name","enabled","pricingEnabled","areaEnabled","points"]);return n.points=f()(t=n.points).call(t,(function(t){return!(!t.$$unit||!(t.reservationUnitId=t.$$unit.id))})),m.save(p.getCurrentCenterId(),n).catch((function(t){return u.error(t,"Failed to save floor plan")})).then((function(t){b.plan.id=t.id}))})),b.deletePlan=function(t){if(!t.id||l.confirm(n.instant("FLOOR_PLANS.CONFIRM_DELETE")))return(t.id?m.delete(t.id):a.when()).catch((function(t){return u.error(t,"Failed to delete floor plan.")})).then((function(){var n;c()(n=b.plans).call(n,b.plans.indexOf(t),1),t===b.plan&&(b.plan=b.plans[0])}))},b.uploadPlanImage=function(t,e,a){if(!d.pointFirstInvalid("floor-plan-settings")){if(a&&a.length>0)return u.error(n.instant("FLOOR_PLANS.IMAGE.INVALID_FORMAT"));if(t&&t.id&&e&&e.length)return t.$$spinUpload=!0,m.uploadImage(t.id,e[0]).catch((function(t){return u.error(t,"Failed to upload floor plan image.")})).finally((function(){t.$$spinUpload=!1})).then((function(n){t.thumbnail=n.data.thumbnail+"?"+Date.now(),t.image=n.data.image+"?"+Date.now()}))}},b.onInit()}])},jUNa:function(t,n,e){},mCRw:function(t,n){t.exports='<floor-plans plans="$ctrl.plans" plan="$ctrl.plan" point="$ctrl.point" is-available="$ctrl.isAvailable" ff-bulk-read-only="true"> <hover-tip ng-init="point = $parent.$parent.point"> <ff-tip ng-if="point.$$unit" tip-type="white" style="padding:5px;min-width:160px;width:160px"> <span>{{point.$$unit.name}}</span> </ff-tip> </hover-tip> <focus-content> <ff-panel> <div> <ff-header>{{$ctrl.point.$$unit.name}}</ff-header> <div class="ff-col"> <ff-img class="fp-unit-photo" ng-if="$ctrl.point.$$unit.photo" ff-alt="{{$ctrl.point.$$unit.name}}" ff-src="{{$ctrl.point.$$unit.photo}}" ff-src-hq="{{$ctrl.point.$$unit.photo}}"></ff-img> <ff-static class="fp-descr" ng-if="$ctrl.point.$$unit.description">{{$ctrl.point.$$unit.description}}</ff-static> <ff-row ng-if="$ctrl.point.$$unit.capacity"> <ff-static><span translate="GLOBAL.UNIT_CAPACITY" translate-values="{ capacity: $ctrl.point.$$unit.capacity }"></span></ff-static> </ff-row> <ff-static ng-if="$ctrl.point.$$unit.$$user" class="ff-no-frame" style="text-transform:uppercase;font-weight:700;margin-bottom:-.75rem;display:block"> <span translate="FLOOR_PLANS.POINT.WHO_IS_THERE"></span> </ff-static> <ff-row ng-if="$ctrl.point.$$unit.$$user"> <ff-static> <ff-img flex="0 0 60px" class="fp-avatar" ff-src="{{$ctrl.point.$$unit.$$user.photo}}" ng-if="$ctrl.point.$$unit.$$user.photo" ff-alt="{{$ctrl.point.$$unit.$$user.name}}"></ff-img> <ff-col style="margin-right:.5rem;padding:.5rem 0"> <span class="fp-user-name">{{$ctrl.point.$$unit.$$user.name}}</span> </ff-col> <ff-btn flex="none" sense="userSelect" size="sm" class="fp-btn-more" ff-click="$ctrl.more()"> <span translate="FLOOR_PLANS.POINT.BTN_MORE"></span> </ff-btn> </ff-static> </ff-row> <div class="ff-row fp-legend gutter-h-half"> <div flex="auto" translate="FLOOR_PLANS.POINT.AVAILABILITY_TODAY"></div> <div flex="none" style="display:block;margin:-8px 0"> <div class="available" translate="FLOOR_PLANS.POINT.AVAILABILITY_TODAY.AVAILABLE"></div> <div class="unavailable" translate="FLOOR_PLANS.POINT.AVAILABILITY_TODAY.UNAVAILABLE"></div> </div> </div> <res-bar unit="$ctrl.point.$$unit"></res-bar> <div ng-if="$ctrl.point.$$unit.reservations.length" style="margin:.6rem 0 0 0;font-size:.95rem"> <div ng-repeat="res in $ctrl.point.$$unit.reservations" ng-if="res.userName" style="margin-top:.4rem"> <span nice-time="res.from"></span> - <span nice-time="res.to"></span> - <span>{{res.userName}}</span> </div> </div> <ff-btn-group class="ff-tmargin" ng-if="$ctrl.isReservable($ctrl.point.$$unit)"> <ff-btn sense="ok" size="sm" class="ff-btn-full" ff-click="$ctrl.reserve()"> <span translate="FLOOR_PLANS.POINT.BTN_RESERVE"></span> </ff-btn> </ff-btn-group> </div> </div> </ff-panel> </focus-content> </floor-plans> '},"s8F+":function(t,n){t.exports='<floor-plans plans="$ctrl.plans" plan="$ctrl.plan" point="$ctrl.point" save="$ctrl.save()" is-available="$ctrl.isAvailable" ff-bulk-read-only> <focus-content> <div class="ff-grid gutter-v-half"> <floor-plan-point-settings ng-if="$parent.ffBlock.editMode" class="ff-flex-start" point="$ctrl.point" categories="$ctrl.categories" units="$ctrl.units" plan="$ctrl.plan" save="$ctrl.save($ctrl.plan)"></floor-plan-point-settings> <floor-plan-point-details ng-if="$ctrl.point.$$unit" point="$ctrl.point" view="$ctrl.view" pricing-enabled="$ctrl.plan.pricingEnabled" area-enabled="$ctrl.plan.areaEnabled"></floor-plan-point-details> </div> </focus-content> <no-focus-content> <ff-panel ng-if="$parent.ffBlock.editMode" class="ff-flex-start"> <div><ff-icon sense="info"></ff-icon> <span translate="FLOOR_PLANS.POINT.HINT.SELECT"></span></div> <div><ff-icon sense="info"></ff-icon> <span translate="FLOOR_PLANS.POINT.HINT.CREATE"></span></div> <div><ff-icon sense="info"></ff-icon> <span translate="FLOOR_PLANS.POINT.HINT.DRAG"></span></div> </ff-panel> </no-focus-content> <selector-extra> <div class="ff-grid gutter-h-half ff-read-only-ignore" style="justify-content:flex-start"> <label flex="none"> <ff-radio ff-model="$ctrl.view" ff-value="\'public\'"><span translate="FLOOR_PLANS.VIEW.PUBLIC"></span></ff-radio> </label> <label flex="none"> <ff-radio ff-model="$ctrl.view" ff-value="\'community\'"><span translate="FLOOR_PLANS.VIEW.COMMUNITY"></span></ff-radio> </label> </div> </selector-extra> <plan-settings> <floor-plan-settings ng-if="$parent.ffBlock.editMode && $ctrl.plan" class="animate-collapse" plan="$ctrl.plan" delete="$ctrl.deletePlan($ctrl.plan)" save="$ctrl.save($ctrl.plan)" upload="$ctrl.uploadPlanImage"></floor-plan-settings> </plan-settings> <bottom-extra> <floor-plan-embedding ng-if="$parent.ffBlock.editMode && $ctrl.plan.image" floor-plan="$ctrl.plan" class="animate-collapse" style="display:block"></floor-plan-embedding> </bottom-extra> </floor-plans> '},tUjE:function(t,n,e){"use strict";e.r(n);var a=e("nbuU"),r=e.n(a),l=e("cfxb"),i=e.n(l),o=e("iAzO");n.default=angular.module("deskworks.floorPlanPointDetailsDirective",[o.a.name]).directive("floorPlanPointDetails",(function(){return{template:i.a,restrict:"E",scope:!0,controller:"FloorPlanPointDetailsDirectiveCtrl as $ctrl",bindToController:{point:"<",pricingEnabled:"<",areaEnabled:"<",view:"<"}}})).controller("FloorPlanPointDetailsDirectiveCtrl",["$scope","dwModal",function(t,n){var e,a=this;a.areaUnit=(r()(e=window.dwLocales).call(e,(function(n){return n.id===t.currentLocale}))||{}).area||"ftÂ²",a.more=function(){n.show({scope:t,templateUrl:"members/our-members/our-member-modal.tpl.html",controller:"OurMemberModalCtrl",inputs:{member:a.point.$$unit.$$user}})}}])},wOy2:function(t,n){t.exports='<ff-panel ngf-drop="$ctrl.upload($ctrl.plan, $files, $invalidFiles)" ngf-pattern="\'image/png,image/jpeg\'" ngf-drag-over-class="dragover"> <ff-panel-header> <span translate="FLOOR_PLANS.SETTINGS.HEADER"></span> <ff-hint><span translate="FLOOR_PLANS.IMAGE.HINT"></span></ff-hint> </ff-panel-header> <ff-spin ng-if="$ctrl.plan.$$autoSaving"></ff-spin> <div class="ff-grid" style="justify-content:flex-start"> <label class="ff-row" flex="0 1 240px"> <ff-label flex="0 1 60px"><req translate="FLOOR_PLANS.NAME"></req></ff-label> <ff-text name="floorPlanName" ff-model="$ctrl.plan.name" ff-change="$ctrl.save()" ff-required="true" ff-validate-alert="{{\'FLOOR_PLANS.NAME\' | translate}}"></ff-text> </label> <ff-static class="ff-no-frame" flex="auto"> <div class="ff-grid gutter-h-half"> <label flex="none"> <ff-checkbox name="enabled" ff-model="$ctrl.plan.enabled" ff-change="$ctrl.save()"> <span translate="FLOOR_PLANS.ENABLED"></span> </ff-checkbox> </label> <label flex="none"> <ff-checkbox name="pricingEnabled" ff-model="$ctrl.plan.pricingEnabled" ff-change="$ctrl.save()"> <span translate="FLOOR_PLANS.PRICING_VISIBLE"></span> </ff-checkbox> </label> <label flex="none"> <ff-checkbox name="areaEnabled" ff-model="$ctrl.plan.areaEnabled" ff-change="$ctrl.save()"> <span translate="FLOOR_PLANS.AREA_VISIBLE"></span> </ff-checkbox> </label> </div> </ff-static> </div> <ff-btn-group style="margin-top:.5rem"> <ff-btn sense="upload" size="sm" ff-spin="$ctrl.plan.$$spinUpload" ngf-select="$ctrl.upload($ctrl.plan, $files, $invalidFiles)" ngf-pattern="\'image/png,image/jpeg\'" accept="image/png,image/jpeg"> <span translate="FLOOR_PLANS.IMAGE.BTN_UPLOAD"></span> </ff-btn> <ff-btn sense="delete" size="sm" ff-click="$ctrl.delete()"><span translate="FLOOR_PLANS.BTN_DELETE"></span></ff-btn> </ff-btn-group> </ff-panel> '},"xlK/":function(t,n,e){var a={"./directives/floor-plan-embedding.directive.js":"SjL+","./directives/floor-plan-point-details.directive.js":"tUjE","./directives/floor-plan-point-settings.directive.js":"JVmQ","./directives/floor-plan-settings.directive.js":"e32L","./directives/floor-plan.directive.js":"DLcK","./directives/floor-plans.directive.js":"F4bp","./floor-plans-community/floor-plans-community.controller.js":"h2Ow","./floor-plans-reservation/floor-plans-reservation.controller.js":"JZQZ","./floor-plans/floor-plans.controller.js":"hfBW","./services/floor-plan.service.js":"Sh1H"};function r(t){var n=l(t);return e(n)}function l(t){if(!e.o(a,t)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=l,t.exports=r,r.id="xlK/"},z3Z1:function(t,n){t.exports='<div ng-repeat="av in $ctrl.availabilities" ng-style="{ left: av.x1 + \'%\', right: 100 - av.x2 + \'%\' }" class="availability"> <span nice-time="av.from" nice-format="shortHours" class="from"></span> <span nice-time="av.to" nice-format="shortHours" class="to"></span> </div> '},zB24:function(t,n,e){var a={"./directives/floor-plan-embedding.tpl.html":"hBaI","./directives/floor-plan-point-details.tpl.html":"cfxb","./directives/floor-plan-point-settings.tpl.html":"EFlW","./directives/floor-plan-settings.tpl.html":"wOy2","./directives/floor-plan.tpl.html":"3W34","./directives/floor-plans.tpl.html":"BQyx","./floor-plans-community/floor-plans-community.tpl.html":"BRh7","./floor-plans-reservation/floor-plans-reservation.tpl.html":"mCRw","./floor-plans/floor-plans.tpl.html":"s8F+"};function r(t){var n=l(t);return e(n)}function l(t){if(!e.o(a,t)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=l,t.exports=r,r.id="zB24"}}]);