(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"+vx3":function(e,t,r){"use strict";r.r(t);r("3dw1");var n=r("nbuU"),i=r.n(n),o=r("a8hB"),s=r.n(o),a=r("ipr/"),c=r.n(a);t.default=angular.module("deskworks.importDetectSubgroups",["deskworks.helper"]).factory("importDetectSubgroups",["helper",function(e){return function(t,r,n){var o=n.reduce((function(e,t){var r=i()(e).call(e,(function(e){return e.id===(t.subgroup||"nosubgroup")}));return r||(r={id:t.subgroup,fields:[]},e.push(r)),r.fields.push(t),e}),[{id:"nosubgroup",fields:[]}]);r.data.forEach((function(t,i){var a=r.rowsMeta[i];if(!a.empty&&!a.headRow&&(o.forEach((function(n){n.nonEmptyCount=n.fields.reduce((function(n,i){return s()(e).call(e,t[r.mapping.indexOf(i.id)])?++n:n}),0)})),!o[0].nonEmptyCount&&o.length>1)){var l=c()(o).call(o,1,o.length).reduce((function(e,t){return!e||t.nonEmptyCount>e.nonEmptyCount?t:e}));a.subgroup=l.id;var d=e.findIndexByKeyValue(n,"subgroupKey",!0);d>=0&&!t[d]&&angular.isUndefined(a.ignore)&&(a.ignore=!0)}}))}}])},"/Qjn":function(e,t){e.exports='<div id="setupImport"> <h1 class="page-title">{{state.getPageTitle()}}</h1> <import-step-init ng-if="$ctrl.steps[$ls.step].id === \'init\'" step="$ls.step" sheets="$ls.sheets" purge="$ctrl.purge"></import-step-init> <import-step-import ng-if="$ctrl.steps[$ls.step].id !== \'init\' && $ctrl.steps[$ls.step].id !== \'complete\'" step="$ls.step" sheets="$ls.sheets" purge="$ctrl.purge"></import-step-import> <import-step-complete ng-if="$ctrl.steps[$ls.step].id === \'complete\'" step="$ls.step" sheets="$ls.sheets" purge="$ctrl.purge"></import-step-complete> </div> '},14:function(e,t){},15:function(e,t){},16:function(e,t){},"2dNM":function(e,t,r){"use strict";r.r(t);r("JBxO"),r("FdtR");var n=r("hsT8"),i=r.n(n),o=r("5xSF"),s=r.n(o);t.default=angular.module("deskworks.importStepImport",["deskworks.dwAlerts","deskworks.handsontable","deskworks.importHandsontable","deskworks.importSheetDetector","deskworks.importSteps","deskworks.importInitMetaData","deskworks.importDetectSubgroups","deskworks.importWireData","deskworks.importValidateData","deskworks.importCollectStats"]).component("importStepImport",{templateUrl:"step-components/step-import.tpl.html",controller:"ImportStepImportCtrl",bindings:{step:"=",sheets:"<",purge:"<"}}).controller("ImportStepImportCtrl",["$scope","$q","$timeout","dwAlerts","state","helper","importSheetDetector","importSteps","importInitMetaData","importDetectSubgroups","importWireData","importValidateData","importCollectStats",function(e,t,r,n,o,a,c,l,d,u,p,f,m){var h=this;h.steps=l,e.$watch("$ctrl.step",(function(){if(h.step){var e=h.steps[h.step];h.fields=e.fields,h.sheet=null,t.when(e.hooks&&e.hooks.init&&e.hooks.init(h)).then((function(){h.sheet=c.detect(h.sheets,h.step)}))}})),h.back=function(){h.step--},h.validateData=function(){var t;d(h.sheet),i()(t=h.fields).call(t,(function(e){return h.sheet.mapping.indexOf(e.id)<0})).length||(u(h,h.sheet,h.fields),p(h,h.sheet,h.fields,h.steps[h.step].hooks.wireRow),h.invalidCount=f(h.sheet,h.fields,e),h.stats=m(h.sheet.rowsMeta)),e.$broadcast("ht:render")},h.import=function(){if(h.unMappedFields.length)return n.error("Some columns unmapped. Please check red UNKNOWN markers and map them to appropriate fields.");if(h.invalidCount)return n.error(h.invalidCount+" invalid values found. Please fix them manually to proceed to the next step.");var e=h.steps[h.step],i=0,o=new s.a((function(){for(;i<h.sheet.data.length&&(h.sheet.rowsMeta[i].ignore||h.sheet.rowsMeta[i].subgroup||h.sheet.rowsMeta[i].headRow||h.sheet.rowsMeta[i].empty);)i++;if(i>=h.sheet.data.length)return null;var t=h.sheet.rowsMeta[i];return t.spin=!0,e.hooks.importRow(h,h.sheet.data[i++],t,h.sheet.mapping,h.fields).then((function(e){t.id=e.id||t.id,t.error=null})).catch((function(e){t.error=e.data&&e.data.error||e.status+" "+e.statusText})).finally((function(){h.stats=m(h.sheet.rowsMeta),t.spin=!1,t.ignore=!0}))}),5,{promise:t});return h.spin=!0,t.when(e.hooks&&e.hooks.preImport&&e.hooks.preImport(h,h.sheet,h.fields)).then((function(){return o.start()})).then((function(){return h.validateData(),r((function(){h.spin=!1,h.step++}),1e3)}))},h.next=function(){h.step++}}])},"4D44":function(e,t,r){"use strict";r.r(t);r("3dw1");var n=r("yCd9"),i=r.n(n),o=r("ipr/"),s=r.n(o),a=r("hsT8"),c=r.n(a),l=r("nbuU"),d=r.n(l),u=r("6RpP"),p=r.n(u),f=r("0zKI"),m=r.n(f);r("Yew0");t.default=angular.module("deskworks.importHandsontable",["deskworks.helper","deskworks.dwAlerts","deskworks.importStripDataComments","deskworks.importDetectHeadRowIdx","deskworks.importAutoMapColumns"]).directive("importHandsontable",(function(){return{restrict:"E",scope:!0,templateUrl:"handsontable/import-handsontable.tpl.html",controller:"ImportHandsontableCtrl as $ctrl",bindToController:{step:"<",sheet:"<",fields:"<",onValidate:"&",unMappedFields:"="}}})).controller("ImportHandsontableCtrl",["$scope","$window","$timeout","dwAlerts","helper","importStripDataComments","importDetectHeadRowIdx","importAutoMapColumns",function(e,t,r,n,o,a,l,u){var f=this;function h(e){return i()(e).call(e,(function(e){var t;return{cellsMeta:i()(t=Array.apply(null,Array(e.length))).call(t,(function(){return{}}))}}))}e.$watch("$ctrl.sheet",(function(){var t,n;f.sheet&&(f.sheet.mappedToStep||(a(f.sheet.data),f.sheet.headRowIdx=l(f.sheet.data,f.fields),f.sheet.mapping=u(f.sheet.data,f.fields,f.sheet.headRowIdx),f.sheet.headRowIdx>=0?(f.sheet.mappedToStep=f.step,f.sheet.rowsMeta=h(f.sheet.data),(t=f.sheet).headRowIdx<0||(s()(n=t.rowsMeta).call(n,0,t.headRowIdx).forEach((function(e){e.ignore=!0})),t.rowsMeta[t.headRowIdx].headRow=!0)):f.sheet.rowsMeta=f.sheet.rowsMeta||h(f.sheet.data)),r((function(){e.$broadcast("ht:render")})))})),e.$watch("$ctrl.sheet.mapping",(function(e){var t;e&&(f.unMappedFields=c()(t=f.fields).call(t,(function(t){return e.indexOf(t.id)<0})),f.availableFields=i()(e).call(e,(function(t){var r;return c()(r=f.fields).call(r,(function(r){return r.id===t||e.indexOf(r.id)<0}))})),f.mappingFields=i()(e).call(e,(function(e){var t;return d()(t=f.fields).call(t,(function(t){return t.id===e}))})),f.onValidate())}),!0),e.$on("ht:afterCreateRow",(function(e,t,r){var n,o,a,c;e.stopPropagation(),f.sheet.headRowIdx>=t&&(f.sheet.headRowIdx+=r);var l=s()(n=f.sheet.rowsMeta).call(n,0,t),d=i()(o=Array.apply(null,Array(r))).call(o,(function(){var e;return{cellsMeta:i()(e=Array.apply(null,Array(f.sheet.data[0].length))).call(e,(function(){return{}}))}})),u=s()(a=f.sheet.rowsMeta).call(a,t);f.sheet.rowsMeta=p()(c=p()(l).call(l,d)).call(c,u),f.onValidate()})),e.$on("ht:afterRemoveRow",(function(e,t,r){var n;e.stopPropagation(),f.sheet.headRowIdx>=t+r?f.sheet.headRowIdx-=r:f.sheet.headRowIdx>=t&&(f.sheet.headRowIdx=-1),m()(n=f.sheet.rowsMeta).call(n,t,r),f.onValidate()})),e.$on("ht:afterChange",(function(e){e.stopPropagation(),f.onValidate()})),f.cellRenderer=function(e,t,r,n,i,o,s){if(t.innerHTML=o,t=angular.element(t),f.sheet.rowsMeta&&f.sheet.rowsMeta[r]&&f.sheet.rowsMeta[r].cellsMeta&&f.sheet.rowsMeta[r].cellsMeta[n])return f.sheet.rowsMeta[r].cellsMeta[n].invalid&&(t.addClass("ht-invalid"),t[0].innerHTML+='<span class="fa fa-exclamation-triangle"></span>'),f.sheet.rowsMeta[r].headRow&&t.addClass("ht-head-row"),f.sheet.rowsMeta[r].ignore&&t.addClass("ht-ignore"),t.attr("rc",r+"x"+n),t[0]},f.onClickRowIcon=function(e){var t=f.sheet.rowsMeta[e];t.headRow||(t.ignore=!t.ignore,f.onValidate())},f.onSelectValidData=function(t,r,n){if(f.sheet.data.reduce((function(e,t,i){return f.sheet.rowsMeta[i].invalid&&(t[n]||"")===(f.sheet.data[r][n]||"")?++e:e}),0)>1){var i,o='"'+d()(i=f.fields).call(i,(function(e){return e.id===f.sheet.mapping[n]})).name+'" column contains more "'+(f.sheet.data[r][n]||"empty")+'" occurrences. Fix them all to "'+t+'" automatically?';if(confirm(o))for(var s=0;s<f.sheet.data.length;s++)s!==r&&f.sheet.rowsMeta[s].invalid&&(f.sheet.data[s][n]||"")===(f.sheet.data[r][n]||"")&&(f.sheet.data[s][n]=t)}f.sheet.data[r][n]=t,e.$broadcast("ht:commitValue",t),f.onValidate()}}])},"52bj":function(e,t,r){"use strict";r.r(t);var n=r("03wM"),i=r.n(n),o=r("0zKI"),s=r.n(o);r("3dw1"),r("Muwe"),r("w13K");t.default=angular.module("deskworks.SetupImportCtrl",["ngStorage","deskworks.state","deskworks.importSteps","deskworks.importStepInit","deskworks.importStepImport","deskworks.importStepComplete","deskworks.purge.service"]).controller("SetupImportCtrl",["$scope","$localStorage","dwAlerts","state","importSteps","purgeService",function(e,t,r,n,o,a){var c=this;t.import=t.import||{};var l=t.import;i()(l).forEach((function(e){var t=e.match(/^v(\d+)$/i);(!t||t&&1!=+t[1])&&delete l[e]}));var d=l.v1=l.v1||{},u=e.$ls=d[n.getCurrentCenterId()]=d[n.getCurrentCenterId()]||{};u.step=u.step||0,u.sheets=u.sheets||[],c.steps=o,e.$watch("$ls.step",(function(){n.setPageTitle("Import "+c.steps[u.step].name)})),c.purge=function(){if(window.confirm("It will purge all data. Are you sure?"))return a.purgeMembers().catch((function(e){return r.error(e,"Failed to purge members.")})).then((function(){return a.purgeProducts().catch((function(e){return r.error(e,"Failed to purge products.")}))})).then((function(){return a.purgePriceLists(n.getCurrentCenterId()).catch((function(e){return r.error(e,"Failed to purge price lists.")}))})).then((function(){return a.purgeMembershipTypes().catch((function(e){return r.error(e,"Failed to purge membership categories.")}))})).then((function(){return a.purgeReservationCategories().catch((function(e){return r.error(e,"Failed to purge reservation categories.")}))})).then((function(){i()(d).forEach((function(e){var t;d[e].step=0,s()(t=d[e].sheets).call(t,0,d[e].sheets.length)}))}))}}])},"6Efl":function(e,t,r){"use strict";r.r(t);var n=r("Ehlk"),i=r.n(n);r("Pkjd");t.default=angular.module("deskworks.handsontable",["deskworks.handsontable.htHeaderExtra","deskworks.handsontable.htRowExtra","deskworks.handsontable.htBodyExtra"]).directive("handsontable",(function(){return window.Handsontable=i.a,{restrict:"E",scope:!0,controller:"HandsontableCtrl as ht",bindToController:{data:"<htData",renderer:"<htRenderer",manualColumnWidths:"<htManualColumnWidths"},compile:function(){return function(e,t,r,n){if(!window.Handsontable)return console.error("Handsontable component is not found.");e.$watch("ht.data",(function(r){angular.isArray(r)&&angular.isArray(r[0])&&(n.settings.data=r,n.instance?n.instance.updateSettings(n.settings):n.instance=new i.a(t[0],n.settings),e.$broadcast("ht:dataChange",n.settings.data))})),e.$on("$destroy",(function(){n.instance&&(n.instance.destroy(),delete n.instance)}))}}}})).controller("HandsontableCtrl",["$scope","$element","$attrs","$timeout",function(e,t,r,n){var i=arguments,o=this,s=document.getElementById("htImport"),a=s.addEventListener;s.addEventListener=function(e){if("wheel"!==e)return a.apply(s,i)},o.settings={data:o.data,rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,autoWrapRow:!0,autoWrapCol:!0,autoInsertRow:!1,autoRowSize:!0,autoColumnSize:!0,allowInsertColumn:!1,enterBeginsEditing:!1,cells:function(){return{renderer:o.renderer}},contextMenu:["row_above","row_below","remove_row"],afterSelectionEnd:function(t,r){e.$apply((function(){e.$emit("ht:afterSelection",t,r)}))},afterDeselect:function(){e.$apply((function(){e.$emit("ht:afterDeselect")}))},afterChange:function(){e.$root.$$phase||e.$apply((function(){e.$emit("ht:afterChange")}))},afterRender:function(){if(e.$root.$$phase)return n((function(){e.$emit("ht:afterRender")}));e.$apply((function(){e.$emit("ht:afterRender")}))},afterCreateRow:function(t,r){e.$apply((function(){e.$emit("ht:afterCreateRow",t,r)}))},afterRemoveRow:function(t,r){e.$apply((function(){e.$emit("ht:afterRemoveRow",t,r)}))},init:function(){this.getPlugin("manualColumnResize").manualColumnWidths=o.manualColumnWidths||[]},afterUpdateSettings:function(){this.getPlugin("manualColumnResize").manualColumnWidths=o.manualColumnWidths||[],this.getPlugin("autoRowSize").recalculateAllRowsHeight()},afterGetColHeader:function(e,t){e>=0&&t.setAttribute("htcol",e)},afterGetRowHeader:function(e,t){e>=0&&t.setAttribute("htrow",e)}},e.$on("ht:commitValue",(function(e,t){var r=o.instance.getActiveEditor();r&&r._opened&&(r.setValue(t),r.focus(),r.close())})),e.$on("ht:render",(function(){o.instance&&o.instance.render()}))}])},"6yKF":function(e,t,r){"use strict";r.r(t);r("3dw1"),r("Muwe"),r("w13K");var n=r("ipr/"),i=r.n(n),o=r("yCd9"),s=r.n(o),a=r("a8hB"),c=r.n(a),l=r("0zKI"),d=r.n(l);t.default=angular.module("deskworks.importDetectHeadRowIdx",[]).factory("importDetectHeadRowIdx",["helper",function(e){return function(t,r){var n;if(angular.isArray(r)&&angular.isArray(t)){var o=i()(r).call(r),a=s()(n=i()(t).call(t,0,5)).call(n,(function(t){var r=0;return t.forEach((function(t){for(var n=0;n<o.length;n++)if(c()(e).call(e,t).match(o[n].pattern)){d()(o).call(o,n,1),r++;break}})),r})),l=a.indexOf(Math.max.apply(Math,a));return a[l]>=r.length/1.5?l:-1}}}])},"7A+6":function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsMembershipProducts",[]).factory("importFieldsMembershipProducts",(function(){return[{id:"name",name:"Product Name",pattern:/Product\s+Name/i,required:!0,unique:!0},{id:"membershipCategory",name:"Membership Category",pattern:/Membership\s+Category/i,required:!0},{id:"isCreditable",name:"Has Reservation Credit?",pattern:/Has\s+Reservation\s+Credit/i,type:"bool"},{id:"hasPasses",name:"Has Passes?",pattern:/Has\s+Passes/i,type:"bool"},{id:"passProduct",name:"Product to use for pass",pattern:/Product.+for.+pass/i,type:{options:"$ctrl.productsRental"}},{id:"showInSelfRegistration",name:"Show for Self-Registration",pattern:/Show.+Self.*Regis/i,type:"bool"},{id:"productCategoryCode",name:"Product Category Code",pattern:/Product\s+Category\s+Code/i,required:!0},{id:"productCategoryName",name:"Product Category Name",pattern:/Product\s+Category\s+Name/i},{id:"productNumber",name:"Part Number Code",pattern:/Part\s+Number\s+Code/i,required:!0,type:"uint"},{id:"price",name:"Price",pattern:/^Price/i,required:!0,type:"currency"},{id:"reservationCredit",name:"Reservation Credit",pattern:/^Reservation\s+Credit/i,type:"currency"},{id:"passQty",name:"Passes",pattern:/^Passes/i,type:"uint"},{id:"description",name:"Description",pattern:/Description/i}]}))},"9AYr":function(e,t){e.exports='<handsontable id="htImport" class="ht-import" ht-data="$ctrl.sheet.data" ht-rows-meta="$ctrl.sheet.rowsMeta" ht-renderer="$ctrl.cellRenderer" ht-manual-column-widths="$ctrl.sheet.manualColumnWidths"> <ht-header-extra ht-fields="$ctrl.fields" ht-available-fields="$ctrl.availableFields" ht-mapping="$ctrl.sheet.mapping"></ht-header-extra> <ht-row-extra> <div class="ht-row-extra" ng-init="rowMeta = $ctrl.sheet.rowsMeta[$row]" ng-show="!$ctrl.unMappedFields.length"> <ff-icon sense="error" ng-if="rowMeta.error && rowMeta.ignore" ng-click="$ctrl.onClickRowIcon($row)" title="{{rowMeta.error}}"> </ff-icon> <ff-icon sense="warning" ng-if="rowMeta.invalid && !rowMeta.ignore" ng-click="$ctrl.onClickRowIcon($row)" title="This row contains invalid values. Fix them or click this icon to ignore this row."></ff-icon> <ff-icon sense="check" ng-if="rowMeta.id && !rowMeta.invalid && rowMeta.ignore && !rowMeta.error" ng-click="$ctrl.onClickRowIcon($row)" title="Existing data, this row will not be imported."></ff-icon> <ff-icon sense="refresh" ng-if="rowMeta.id && !rowMeta.invalid && !rowMeta.ignore" ng-click="$ctrl.onClickRowIcon($row)" ng-class="{ rotate: rowMeta.spin }" title="Existing data, this row will be updated."></ff-icon> <ff-icon sense="plus" ng-if="!rowMeta.id && !rowMeta.ignore && !rowMeta.headRow && !rowMeta.empty && !rowMeta.invalid" ng-click="$ctrl.onClickRowIcon($row)" ng-class="{ rotate: rowMeta.spin }" title="This row is new and will be imported."></ff-icon> <ff-icon sense="ignore" ng-if="!rowMeta.id && rowMeta.ignore && !rowMeta.error" ng-click="$ctrl.onClickRowIcon($row)" title="This row is ignored. Click this icon to stop ignoring this row."></ff-icon> <ff-icon sense="header" ng-if="rowMeta.headRow" ng-click="$ctrl.onClickRowIcon($row)" title="This row is recognized as header."></ff-icon> <ff-icon sense="membership" ng-if="rowMeta.master" title="{{rowMeta.master}} company"></ff-icon> <ff-icon sense="user" ng-if="rowMeta.masterIdx >= 0" title="{{rowMeta.masterName}} co-member"></ff-icon> </div> </ht-row-extra> <ht-body-extra> <div class="itooltip ht-body-tooltip" ng-show="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid"> <span ng-if="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isString" ng-bind-html="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid"></span> <ff-select ff-model="newVal" ff-options="opt.name as opt.name for opt in $ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid" ff-change="$ctrl.onSelectValidData(newVal, $row, $col)" ng-if="$ctrl.sheet.rowsMeta[$row].cellsMeta[$col].invalid | isArray"> <option value="">please select</option> </ff-select> </div> </ht-body-extra> </handsontable> '},BGsA:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsMembers",["deskworks.userProfile.optsCountry","deskworks.userProfile.optsState","deskworks.userProfile.optsMembershipStatus","deskworks.userProfile.optsBillingMethod","deskworks.billing.optsRenewalNoticePeriod"]).factory("importFieldsMembers",["optsCountry","optsState","optsMembershipStatus","optsBillingMethod","optsRenewalNoticePeriod",function(e,t,r,n,i){return[{id:"firstName",name:"First Name",pattern:/First\s+Name/i,required:!0},{id:"lastName",name:"Last Name",pattern:/Last\s+Name/i,required:!0,type:{pattern:/^[^\\<>\/&]*$/,msg:"Last Name should not contain special characters"}},{id:"email",name:"Email",pattern:/Email/i,required:!0,unique:!0,type:"email"},{id:"company",name:"Company",pattern:/Company/i},{id:"login",name:"Login",pattern:/Login/i,required:!0,unique:!0,minLength:3,type:{pattern:/^\w[\w\.\-_@]+$/,msg:"Login should have only letters, numbers, and .-_@"}},{id:"password",name:"Password",pattern:/Password/i,required:!0,minLength:6},{id:"addressStreet",name:"Street",pattern:/Street/i,required:!0},{id:"addressCity",name:"City",pattern:/City/i,required:!0},{id:"addressCountry",name:"Country",pattern:/Country/i,required:!0,type:{options:e}},{id:"addressState",name:"State/Province",pattern:/State\s*\/\s*Province/i,required:!0,type:{options:"$ctrl.optsState.$id",ref:"addressCountry"}},{id:"addressZip",name:"Zip/Postal",pattern:/Zip\s*\/\s*Post/i,required:!0},{id:"phoneNumber",name:"Phone Number",pattern:/Number/i,required:!0,type:{pattern:/^((\+\d{1,3}[-. ]?\(?\d\)?[-. ]?\d{1,5})|(\(?\d{2,6}\)?))[-. ]?(\d{3,4})[-. ]?(\d{4})$/,msg:"Phone number examples: 888-379-2865, +1-888-379-2865, 888 379 2865, 888.379.2865"}},{id:"mailboxNumber",name:"Mailbox #",pattern:/Mailbox #/i},{id:"printerCode",name:"Printer Code",pattern:/Printer\s+Code/i},{id:"accessCode",name:"Access Code",pattern:/Access\s+Code/i},{id:"leadSource",name:"Lead Source",pattern:/Lead\s+Source/i,required:!0,type:{options:"$ctrl.leadSources"}},{id:"comments",name:"Comments",pattern:/Comments/i},{id:"billingMethod",name:"Billing Method",pattern:/Bill\s+By/i,required:!0,type:{options:n}},{id:"recurringProduct",name:"Recurring Billing",pattern:/Recurring\s+Billing/i,type:{options:"$ctrl.products"},subgroup:"recurring",subgroupKey:!0},{id:"recurringDescription",name:"Description",pattern:/^Description/i,subgroup:"recurring"},{id:"recurringQuantity",name:"Qty",pattern:/Qty/i,type:"ufloat",subgroup:"recurring"},{id:"recurringDiscount",name:"Discount",pattern:/^Discount/i,type:"currency",subgroup:"recurring"},{id:"recurringMonthsOfDiscount",name:"Months of Discount",pattern:/Months\s+of\s+Discount/i,type:"uint",subgroup:"recurring"},{id:"recurringDiscountStartDate",name:"Discount Start Date",pattern:/Discount\s+Start\s+Date/i,type:"date",subgroup:"recurring"},{id:"recurringAttachedReservationUnit",name:"Attached Reservation Unit",pattern:/Make\s+Matching\s+Reservation\s+Unit\s+Unavailable/i,unique:!0,type:{options:"$ctrl.reservationUnits"},subgroup:"recurring"},{id:"recurringStartDate",name:"Start Date",pattern:/Start\s+Date/i,type:"date",subgroup:"recurring"},{id:"recurringNextBillDate",name:"Next Bill Date",pattern:/Next\s+Bill\s+Date/i,type:"date",subgroup:"recurring"},{id:"recurringRenewalDate",name:"Renewal Date",pattern:/Renewal\s+Date/i,type:"date",subgroup:"recurring"}]}])},BaSU:function(e,t,r){"use strict";r.r(t);var n=r("4BZO"),i=r.n(n),o=r("yCd9"),s=r.n(o),a=r("6RpP"),c=r.n(a),l=r("hsT8"),d=r.n(l);r("Ehlk");t.default=angular.module("deskworks.handsontable.htHeaderExtra",[]).directive("htHeaderExtra",["$timeout",function(e){return{scope:!0,restrict:"E",require:["htHeaderExtra","^handsontable"],controller:function(){},bindToController:{fields:"<htFields",availableFields:"<htAvailableFields",mapping:"<htMapping"},compile:function(t,r){return t.remove(),function(t,r,n,o){var a=i()(o,2),l=a[0],u=a[1],p=r.parent();u.settings.colHeaders=function(e){var t,r,n,i,o=s()(t=c()(r=[{name:"UNKNOWN"}]).call(r,l.availableFields[e])).call(t,(function(t){var r,n;return c()(r=c()(n='<option value="'.concat(t.id||"",'" ')).call(n,l.mapping[e]===t.id?"selected":"",">")).call(r,t.name,"</option>")})),a=d()(n=l.fields).call(n,(function(e){return l.mapping.indexOf(e.id)<0})).length,u=!l.mapping[e]&&a?"ng-invalid":"";return c()(i='<select class="ht-mapping-select form-control ff-select ff-control '.concat(u,'">')).call(i,o,"</select>")},e((function(){var e=p[0].querySelector(".ht_clone_top .htCore");e.addEventListener("mousedown",(function(e){"SELECT"!==e.target.nodeName||e.target.className.indexOf("ht-mapping-select")<0||e.stopPropagation()})),e.addEventListener("mouseup",(function(e){"SELECT"!==e.target.nodeName||e.target.className.indexOf("ht-mapping-select")<0||e.stopPropagation()})),e.addEventListener("change",(function(e){"SELECT"!==e.target.nodeName||e.target.className.indexOf("ht-mapping-select")<0||(e.stopPropagation(),t.$apply((function(){var t=e.target,r=+t.parentNode.parentNode.parentNode.getAttribute("htcol");l.mapping[r]=t.value})))}))}))}}}}])},Bn1Q:function(e,t,r){"use strict";r.r(t);r("3dw1"),r("iPZ8"),r("kypl");var n=r("hsT8"),i=r.n(n),o=r("nbuU"),s=r.n(o),a=r("a8hB"),c=r.n(a),l=r("jd5N");t.default=angular.module("deskworks.importHooksMembershipProducts",[l.a.name,"deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.inventory.membershipCategory.service","deskworks.ProductCategory"]).factory("importHooksMembershipProducts",["$q","dwAlerts","helper","state","importParsers","keese","ProductCategory","productService","priceListService","membershipCategoryService",function(e,t,r,n,o,a,l,d,u,p){return{init:function(r){return e.all([d.getProducts().catch((function(e){return t.error(e,"Failed to get products.")})).then((function(e){r.products=i()(e).call(e,(function(e){return"membership"===e.type})),r.productsRental=i()(e).call(e,(function(e){return"rental"===e.type}))})),function(e){var r={name:"Monthly Plans",visibleForVisitors:!0,useFor:"members"};return u.getPricelists(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to get price lists.")})).then((function(e){return s()(e).call(e,(function(e){return e.name===r.name}))||u.save(n.getCurrentCenterId(),r).catch((function(e){return t.error(e,'Failed to create "'+r.name+'" price list.')})).then((function(){return r}))})).then((function(e){return u.getPricelist(n.getCurrentCenterId(),e.id).catch((function(r){return t.error(r,"Failed to get price list "+e.name+".")}))})).then((function(t){e.monthlyPriceList=t}))}(r),p.query().catch((function(e){return t.error(e,"Failed to get membership categories.")})).then((function(e){r.membershipCategories=angular.copy(e)})),l.query().catch((function(e){return t.error(e,"Failed to query product categories.")})).then((function(e){r.productCategories=angular.copy(e)}))])},preImport:function(n,i,d){var u=[];return i.data.forEach((function(e,d){var f=i.rowsMeta[d];if(!(f.ignore||f.headRow||f.empty)){var m=c()(r).call(r,e[i.mapping.indexOf("membershipCategory")]),h=o.options(m,n.membershipCategories);h||(h={name:m,order:a.generate(n.membershipCategories.length&&n.membershipCategories[n.membershipCategories.length-1].order),note:c()(r).call(r,e[i.mapping.indexOf("description")])},n.membershipCategories.push(h),u.push(p.save(h).catch((function(e){return t.error(e,"Failed to create membership category.")})))),m=c()(r).call(r,e[i.mapping.indexOf("productCategoryCode")]);var g=s()(r).call(r,n.productCategories,{code:m});g||(g={code:m,name:c()(r).call(r,e[i.mapping.indexOf("productCategoryName")])},n.productCategories.push(g),u.push(l.save(g).catch((function(e){return t.error(e,"Failed to create product category.")}))))}})),e.all(u)},importRow:function(e,t,n,i,a){var l=d.new();return l.id=n.id||void 0,l.name=c()(r).call(r,t[i.indexOf("name")]),l.membershipType=o.options(t[i.indexOf("membershipCategory")],e.membershipCategories),l.isCreditable=o.bool(t[i.indexOf("isCreditable")]),l.hasPasses=o.bool(t[i.indexOf("hasPasses")]),l.passProduct=o.options(t[i.indexOf("passProduct")],e.productsRental),l.showInSelfRegistration=o.bool(t[i.indexOf("showInSelfRegistration")]),l.productCategoryId=s()(r).call(r,e.productCategories,{code:c()(r).call(r,t[i.indexOf("productCategoryCode")])}).id,l.productNumber=o.uint(t[i.indexOf("productNumber")]),l.description=c()(r).call(r,t[i.indexOf("description")]),d.save(l).then((function(t){!n.id&&t.id&&e.products.push(l)})).then((function(){var r,n={id:(s()(r=e.monthlyPriceList.products).call(r,(function(e){return e.productId===l.id}))||{}).id,priceListId:e.monthlyPriceList.id,price:o.currency(t[i.indexOf("price")]),reservationCredit:l.isCreditable?o.currency(t[i.indexOf("reservationCredit")]):void 0,passQty:l.hasPasses?o.uint(t[i.indexOf("passQty")]):void 0};return d.savePriceItem(l.id,n).then((function(){var t;s()(t=e.monthlyPriceList.products).call(t,(function(e){return e.productId===l.id}))||e.monthlyPriceList.products.push(n)}))})).then((function(){return l}))},wireRow:function(e,t,r){var n;if(r.id=(s()(n=e.products).call(n,(function(e){return e.name===t.name}))||{}).id||null,r.id){var i;(s()(i=e.monthlyPriceList.products).call(i,(function(e){return e.productId===r.id}))||{}).price!=o.currency(t.price)&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},DEya:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),i=r.n(n);r("Muwe"),r("w13K");t.default=angular.module("deskworks.importSheetDetector",["deskworks.importSteps"]).service("importSheetDetector",["helper","importSteps",function(e,t){this.detect=function(r,n){if(angular.isArray(r)&&t[n].sheetPattern)for(var o=0;o<r.length;o++)if(i()(e).call(e,r[o].name).match(t[n].sheetPattern))return r[o];return(r||[])[0]}}])},Ec5X:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");t.default=angular.module("deskworks.handsontable.htBodyExtra",[]).directive("htBodyExtra",["$compile",function(e){return{restrict:"E",require:"^handsontable",compile:function(t,r){var n=t.html();return t.remove(),function(t,r,i,o){var s=r.parent()[0];o.bodyExtraElement||(o.bodyExtraElement=e(n.replace(/\$row/g,"ht.erow").replace(/\$col/g,"ht.ecol"))(t).addClass("ht-body-extra")),t.$on("ht:afterRender",(function(e){e.stopPropagation();var t=angular.element(s.querySelector(".ht_master .wtSpreader"));t[0].querySelector(".ht-body-extra")||t.append(o.bodyExtraElement),o.repositionBodyExtra()})),o.repositionBodyExtra=function(){if(o.erow>=0&&o.ecol>=0){var e=s.querySelector('td[rc="'+o.erow+"x"+o.ecol+'"]');e&&(o.bodyExtraElement.css("top",e.offsetTop+"px"),o.bodyExtraElement.css("left",Math.floor(e.offsetLeft+e.offsetWidth/2)+"px"))}},t.$on("ht:afterSelection",(function(e,t,r){e.stopPropagation(),o.erow=t,o.ecol=r,o.repositionBodyExtra()})),t.$on("ht:afterDeselect",(function(e,t,r){e.stopPropagation(),o.erow=-1,o.ecol=-1}))}}}}])},Jrqs:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("w13K");var n=r("yCd9"),i=r.n(n),o=r("ipr/"),s=r.n(o),a=r("a8hB"),c=r.n(a),l=r("0zKI"),d=r.n(l);t.default=angular.module("deskworks.importAutoMapColumns",[]).factory("importAutoMapColumns",["helper",function(e){return function(t,r,n){var o,a;if(angular.isArray(r)&&angular.isArray(t)){if(n<0)return i()(o=Array.apply(null,Array(t[0].length))).call(o,(function(){return null}));var l=s()(r).call(r);return i()(a=t[n]).call(a,(function(t){for(var r=0;r<l.length;r++)if(c()(e).call(e,t).match(l[r].pattern))return d()(l).call(l,r,1)[0].id}))}}}])},KvHs:function(e,t,r){"use strict";r.r(t);r("3dw1");t.default=angular.module("deskworks.importWireData",["deskworks.helper","deskworks.importSteps"]).factory("importWireData",["helper",function(e){return function(e,t,r,n){t.data.forEach((function(r,i){var o=t.rowsMeta[i];if(!o.empty&&!o.headRow){var s=t.mapping.reduce((function(e,t,n){return e[t]=r[n],e}),{});o.id=n(e,s,o,t.rowsMeta),o.id&&angular.isUndefined(o.ignore)&&(o.ignore=!0)}}))}}])},Pkjd:function(e,t,r){},R2MD:function(e,t){e.exports='<div> <p>Congratulations! You have completed the import. You can manage imported data through sidebar:</p> <p><a href="#/reservation-types" ng-click="$ctrl.navSidebar($event)">Inventory <ff-icon sense="breadcrumb"></ff-icon> Reservation Categories</a></p> <p><a href="#/reservation-units" ng-click="$ctrl.navSidebar($event)">Inventory <ff-icon sense="breadcrumb"></ff-icon> Reservation Units</a></p> <p><a href="#/products" ng-click="$ctrl.navSidebar($event)">Inventory <ff-icon sense="breadcrumb"></ff-icon> Products</a></p> <p><a href="#/user-search" ng-click="$ctrl.navSidebar($event)">Members <ff-icon sense="breadcrumb"></ff-icon> View/Edit Profile</a></p> </div> <ff-btn-group class="buttons-bottom"> <ff-btn sense="back" ff-click="$ctrl.back()">Back To Step {{$ctrl.step - 1}}</ff-btn> <ff-btn sense="home" ff-click="$ctrl.home()">Go To Dashboard</ff-btn> <ff-btn sense="remove" ff-click="$ctrl.purge()">Purge & Start From Scratch</ff-btn> </ff-btn-group> '},RAZO:function(e,t,r){"use strict";r.r(t);r("3dw1"),r("Muwe"),r("y89P");var n=r("yCd9"),i=r.n(n),o=r("lRNC"),s=r.n(o),a=["$injector",function(e){var t,n,o=(t=r("rQ7g"),i()(n=s()(t).call(t)).call(n,t));e.loadNewModules(i()(o).call(o,(function(e){return e.default.name}))),e.invoke(["$templateCache",function(e){var t=r("gnFY");s()(t).call(t).forEach((function(r){return e.put(r.replace(/^\.\//,""),t(r))}))}])}];t.default=a},SXLm:function(e,t){e.exports='<div class="ff-grid gutter-h gutter-v"> <div style1="margin-bottom: .25rem" ng-if="$ctrl.steps[$ls.step].id !== \'complete\'"> <span class="em">Step {{$ctrl.step}} of {{$ctrl.steps.length - 2}}</span> &nbsp; This step allows you to import <b ng-bind="$ctrl.steps[$ctrl.step].name"></b>. Please select correct Excel sheet, check & fix columns mapping, fix invalid values, then import. </div> <div flex="{lg: \'0 0 400px\'}" class="ff-grid" ng-include="\'step-components/import-sheet-selector.tpl.html\'"></div> <div flex="{lg: \'1 1 360px\'}" class="ff-grid" ng-include="\'step-components/import-dashboard.tpl.html\'"></div> <ff-btn-group> <ff-btn sense="next" ff-click="$ctrl.import()">Import</ff-btn> <ff-btn sense="back" ff-click="$ctrl.back()">Back To Step {{$ctrl.step - 1}}</ff-btn> <ff-btn sense="next" ff-click="$ctrl.next()">Skip To Step {{$ctrl.step + 1}}</ff-btn> <ff-btn sense="remove" ff-click="$ctrl.purge()">Purge & Start From Scratch</ff-btn> </ff-btn-group> <ff-panel class="ht-panel" ng-if="$ctrl.sheet" ff-dim="$ctrl.spin"> <import-handsontable step="$ctrl.step" sheet="$ctrl.sheet" fields="$ctrl.fields" on-validate="$ctrl.validateData()" un-mapped-fields="$ctrl.unMappedFields"></import-handsontable> </ff-panel> </div> '},"V1x+":function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P"),r("3dw1");var n=r("yCd9"),i=r.n(n);t.default=angular.module("deskworks.handsontable.htRowExtra",[]).directive("htRowExtra",["$compile",function(e){return{restrict:"E",require:"^handsontable",compile:function(t,r){var n=t.html();return t.remove(),function(t,r,o,s){var a=r.parent()[0];function c(e,t){var r=a.querySelector(".ht_clone_left .wtSpreader");s.rowExtraScopes&&(angular.element(r.querySelectorAll(".ht-row-extra")).remove(),angular.forEach(s.rowExtraScopes,(function(e){e.$destroy()})),delete s.rowExtraScopes)}t.$on("ht:afterRender",(function(r){var o,c=angular.element(a.querySelector(".ht_clone_left .wtSpreader"));s.rowExtraScopes||angular.isArray(s.settings.data)&&angular.isArray(s.settings.data[0])&&(s.rowExtraScopes=i()(o=s.settings.data).call(o,(function(r,i){var o=t.$new();return c.append(e(n.replace(/\$row/g,i))(o).addClass("ht-row-extra")),o})));angular.forEach(c[0].querySelectorAll(".ht-row-extra"),(function(e){e.style.display="none"})),angular.forEach(a.querySelectorAll(".ht_clone_left th[htrow]"),(function(e){var t=c[0].querySelectorAll(".ht-row-extra")[e.getAttribute("htrow")];t.style.left=e.offsetLeft+"px",t.style.top=e.offsetTop+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.display=""}))})),t.$on("ht:afterCreateRow",c),t.$on("ht:afterRemoveRow",c),t.$on("ht:dataChange",c)}}}}])},VixM:function(e,t,r){"use strict";r.r(t);var n=r("hsT8"),i=r.n(n);t.default=angular.module("deskworks.importFieldsOtherProducts",["deskworks.inventory.optsProductType"]).factory("importFieldsOtherProducts",["optsProductType",function(e){return[{id:"name",name:"Product Name",pattern:/Product\s+Name/i,required:!0,unique:!0},{id:"type",name:"Product Type",pattern:/Product\s+Type/i,required:!0,type:{options:i()(e).call(e,(function(e){return"membership"!==e.id}))}},{id:"allowReservationCredits",name:"Can use Reservation Credits",pattern:/Can\s+use\s+Reservation\s+Credit/i,type:"bool"},{id:"passSize",name:"Pass Size",pattern:/Pass\s+Size/i,type:"uint"},{id:"reservationCategory",name:"Reservation Category",pattern:/Reservation\s+Category/i,type:{options:"$ctrl.reservationCategories"}},{id:"productCategoryCode",name:"Product Category Code",pattern:/Product\s+Category\s+Code/i,required:!0},{id:"productCategoryName",name:"Product Category Name",pattern:/Product\s+Category\s+Name/i},{id:"productNumber",name:"Part Number Code",pattern:/Part\s+Number\s+Code/i,required:!0,type:"uint"},{id:"monthlyPrice",name:"Monthly Members Price List",pattern:/Monthly\s+Members\s+Price\s?list/i,type:"currency"},{id:"walkinPrice",name:"Walkin Price List",pattern:/Walkin\s+Price\s?list/i,type:"currency"},{id:"description",name:"Product Description",pattern:/^Product\s+Description/i}]}])},WfNc:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),i=r.n(n),o=r("nbuU"),s=r.n(o),a=r("2/1H");t.default=angular.module("deskworks.importHooksReservationUnits",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.reservationRules.service","deskworks.reservationCategory.service","deskworks.inventory.product.service","deskworks.reservationRules.optsWhoCanReserve",a.a.name]).factory("importHooksReservationUnits",["$q","dwAlerts","helper","state","importParsers","ReservationRules","reservationCategoryService","ReservationUnit","productService","optsWhoCanReserve",function(e,t,r,n,o,a,c,l,d,u){return{init:function(r){return e.all([c.query(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load reservation categories.")})).then((function(e){r.reservationCategories=e})),l.query(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load reservation units.")})).then((function(e){r.reservationUnits=e})),d.getMembershipProducts(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load membership products.")})).then((function(e){r.productsMembership=e}))])},importRow:function(e,t,c,d,p){var f={id:c.id||void 0,name:i()(r).call(r,t[d.indexOf("name")]),description:i()(r).call(r,t[d.indexOf("description")]),reservationTypeId:(o.options(t[d.indexOf("reservationCategory")],e.reservationCategories)||{}).id,fullTimeProductId:(o.options(t[d.indexOf("fullTimeProduct")],e.productsMembership)||{}).id,area:o.uint(t[d.indexOf("area")])||null,capacity:o.uint(t[d.indexOf("capacity")])||null};return l.save(n.getCurrentCenterId(),f).then((function(t){return!c.id&&t.id&&e.reservationUnits.push({id:t.id,name:f.name}),t})).then((function(e){return a.query({centerId:n.getCurrentCenterId(),reservationUnitId:f.id}).then((function(e){var r=s()(e).call(e,(function(e){return"whoCanReserve"===e.uid}));return r.value=(o.options(t[d.indexOf("whoCanReserve")],u)||{}).id,a.save({centerId:n.getCurrentCenterId(),reservationUnitId:f.id},r)})).then((function(){return e}))}))},wireRow:function(e,t){var r;return(s()(r=e.reservationUnits).call(r,(function(e){return e.name===t.name}))||{}).id||null}}}])},Wid6:function(e,t,r){"use strict";r.r(t);var n=r.p+"./assets/new-center-startup-workbook.xlsx?_rev=209a4acbc8768913d47433d6b180020a";t.default=angular.module("deskworks.importStepInit",["ngFileUpload","deskworks.dwAlerts","deskworks.excel"]).component("importStepInit",{templateUrl:"step-components/step-init.tpl.html",controller:"ImportStepInitCtrl",bindings:{step:"=",sheets:"=",purge:"<"}}).controller("ImportStepInitCtrl",["dwAlerts","excel",function(e,t){var r=this;r.$onInit=function(){r.xlsTemplateUrl=n},r.upload=function(n,i){return i&&i.length>0?e.error("Please use .xls or .xlsx files."):window.FileReader?void(n&&n.length&&t.read(n[0]).then((function(e){r.sheets=e,r.step++}))):e.error("FileReader is not supported by your web browser.")},r.next=function(){r.step++}}])},Y5xL:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importSteps",["deskworks.importFieldsReservationCategories","deskworks.importHooksReservationCategories","deskworks.importFieldsReservationUnits","deskworks.importHooksReservationUnits","deskworks.importFieldsOtherProducts","deskworks.importHooksOtherProducts","deskworks.importFieldsMembershipProducts","deskworks.importHooksMembershipProducts","deskworks.importFieldsMembers","deskworks.importHooksMembers"]).factory("importSteps",["importFieldsReservationCategories","importHooksReservationCategories","importFieldsReservationUnits","importHooksReservationUnits","importFieldsOtherProducts","importHooksOtherProducts","importFieldsMembershipProducts","importHooksMembershipProducts","importFieldsMembers","importHooksMembers",function(e,t,r,n,i,o,s,a,c,l){return[{id:"init",name:"Wizard"},{id:"reservationCategories",name:"Reservation Categories",sheetPattern:/Reservation\s+Categories/i,fields:e,hooks:t},{id:"otherProducts",name:"Other Products",sheetPattern:/Products.+Prices$/i,fields:i,hooks:o},{id:"membershipProducts",name:"Membership Products",sheetPattern:/Membership.+Products.+Prices/i,fields:s,hooks:a},{id:"reservationUnits",name:"Reservation Units",sheetPattern:/Reservation\s+Units/i,fields:r,hooks:n},{id:"members",name:"Members",sheetPattern:/Members.+Recurring.+Billing/i,fields:c,hooks:l},{id:"complete",name:"Complete"}]}])},Y6HC:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),i=r.n(n),o=r("nbuU"),s=r.n(o);t.default=angular.module("deskworks.importHooksReservationCategories",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.reservationCategory.service"]).factory("importHooksReservationCategories",["dwAlerts","helper","state","reservationCategoryService",function(e,t,r,n){return{init:function(t){return n.query(r.getCurrentCenterId()).catch((function(t){return e.error(t,"Failed to load reservation categories.")})).then((function(e){t.reservationCategories=e}))},importRow:function(e,o,s,a){var c={id:s.id||void 0,name:i()(t).call(t,o[a.indexOf("name")]),description:i()(t).call(t,o[a.indexOf("description")])};return n.save(r.getCurrentCenterId(),c).then((function(t){return!s.id&&t.id&&e.reservationCategories.push({id:t.id,name:c.name}),t}))},wireRow:function(e,t){var r;return(s()(r=e.reservationCategories).call(r,(function(e){return e.name===t.name}))||{}).id||null}}}])},Yew0:function(e,t,r){},anLb:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsReservationUnits",["deskworks.reservationRules.optsWhoCanReserve"]).factory("importFieldsReservationUnits",["optsWhoCanReserve",function(e){return[{id:"name",name:"Reservation Unit",pattern:/^Reservation\s+Unit$/i,required:!0,unique:!0},{id:"reservationCategory",name:"Reservation Category",pattern:/^Reservation\s+Category$/i,required:!0,type:{options:"$ctrl.reservationCategories"}},{id:"description",name:"Description",pattern:/^Description/i},{id:"whoCanReserve",name:"Who can reserve?",pattern:/^Who\s+can\s+reserve/i,required:!0,type:{options:e}},{id:"fullTimeProduct",name:"Full-time Product",pattern:/^Full-time\s+Product/i,type:{options:"$ctrl.productsMembership"}},{id:"area",name:"Area",pattern:/^Area/i},{id:"capacity",name:"Capacity",pattern:/^Capacity/i}]}])},atK1:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P"),r("w13K");var n=r("nbuU"),i=r.n(n),o=r("a8hB"),s=r.n(o),a=r("hsT8"),c=r.n(a);t.default=angular.module("deskworks.importValidateCell",["deskworks.helper"]).factory("importValidateCell",["helper",function(e){return function(t,r,n,o,a,l,d){var u=i()(a).call(a,(function(e){return e.id===l[n]}));if(u){var p=s()(e).call(e,t[r][n]);if(angular.isObject(u.type)&&u.type.options&&(u.required||""!==p)){var f;if(u.type.ref){var m=t[r][l.indexOf(u.type.ref)],h=i()(a).call(a,(function(e){return e.id===u.type.ref}));m=e.searchSoft(h.type.options,["id","name","import"],m),f=d.$eval(u.type.options.replace(/\$id/g,(m||{}).id))}else f=angular.isArray(u.type.options)?u.type.options:d.$eval(u.type.options);if(angular.isArray(f)&&!e.searchSoft(f,["name","id","import"],p))return f}if(u.required){if(""===p)return u.name+" is required."}else if(""===p)return;if("uint"===u.type&&!p.match(/^\d*,?\d+$/i))return u.name+" should be a positive integer number, e.g. 100 or 0";if("int"===u.type&&!p.match(/^-?\d*,?\d+$/i))return u.name+" should be an integer number, e.g. -10 or 50";if("ufloat"===u.type&&!p.match(/^[\d,]*\.?\d+$/i))return u.name+" should be a positive number, e.g. 10 or 10.50";if("float"===u.type&&!p.match(/^-?[\d,]*\.?\d+$/i))return u.name+" should be a number, e.g. 100 or -20 or 5.5";if("bool"===u.type&&!p.match(/^Yes|No|Y|N|true|false$/i))return u.name+" should be Yes/No, Y/N, true/false";if("currency"===u.type&&!p.match(/^\$?[\d,]*\.?\d+$/i))return u.name+" should be currency, e.g. $10 or $10.50 or 12.00";if("email"===u.type&&!p.match(/^[\w\.%\+\-]+@(?:[A-Z0-9\-]+\.)+(?:[A-Z]+)$/i))return u.name+" should be valid";if("date"===u.type){var g;if(p.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(p=p.replace(/\s|-|\.|\//g," "),g="DD MMM YYYY"):p.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(p=p.replace(/\s|-|\./g,"/"),g="MM/DD/YYYY"):p.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)&&(p=p.replace(/\s|-|\./g,"-"),g="YYYY-MM-DD"),g&&moment(p,g).isValid())return;return u.name+" format is 06/22/2015 or 22&nbsp;Jun&nbsp;2015"}if(u.minLength&&p.length<u.minLength)return u.name+" min length is "+u.minLength;if(u.unique)if(c()(t).call(t,(function(e,t){return!o[t].empty&&!o[t].ignore&&!o[t].headRow})).reduce((function(t,r){return s()(e).call(e,r[n]||"").toLowerCase()===(p||"").toLowerCase()?++t:t}),0)>1)return u.name+" contains duplicate values. Must be unique.";return angular.isObject(u.type)&&u.type.pattern&&!p.match(u.type.pattern)?u.type.msg:void 0}}}])},biy8:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.purge.service",["ngResource","deskworks.config"]).factory("purgeService",["$resource","deskworksConfig",function(e,t){var r=e(t.getApiAbsUrl("/purge/:entity")),n=e(t.getApiAbsUrl("/purge/centers/:centerId/:entity"));return{purgeProducts:function(e){return r.delete({entity:"products",productTypes:e}).$promise},purgePriceLists:function(e){return n.delete({centerId:e,entity:"price-lists"}).$promise},purgeMembershipTypes:function(){return r.delete({entity:"membership-types"}).$promise},purgeReservationCategories:function(){return r.delete({entity:"reservation-types"}).$promise},purgeReservationUnits:function(e){return n.delete({centerId:e,entity:"reservation-units"}).$promise},purgeMembers:function(){return r.delete({entity:"members"}).$promise}}}])},f4JS:function(e,t,r){"use strict";r.r(t);r("3dw1"),r("iPZ8"),r("kypl");var n=r("hsT8"),i=r.n(n),o=r("yCd9"),s=r.n(o),a=r("nbuU"),c=r.n(a),l=r("a8hB"),d=r.n(l);t.default=angular.module("deskworks.importHooksOtherProducts",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.reservationCategory.service","deskworks.ProductCategory"]).factory("importHooksOtherProducts",["$q","dwAlerts","helper","state","importParsers","ProductCategory","productService","priceListService","reservationCategoryService",function(e,t,r,n,o,a,l,u,p){return{init:function(r){return e.all([l.getProducts().catch((function(e){return t.error(e,"Failed to get products.")})).then((function(e){r.products=i()(e).call(e,(function(e){return"membership"!==e.type}))})),function(r){var i=[{name:"Monthly Plans",visibleForVisitors:!0,useFor:"members"},{name:"Walkin",visibleForVisitors:!0,useFor:"nonMembers"}];return u.getPricelists(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to get price lists.")})).then((function(r){return e.all(s()(i).call(i,(function(e){return c()(r).call(r,(function(t){return t.name===e.name}))||u.save(n.getCurrentCenterId(),e).catch((function(r){return t.error(r,'Failed to create "'+e.name+'" price list.')})).then((function(){return e}))})))})).then((function(r){return e.all(s()(r).call(r,(function(e,r){return u.getPricelist(n.getCurrentCenterId(),e.id).catch((function(r){return t.error(r,"Failed to get price list "+e.name+".")}))})))})).then((function(e){r.monthlyPriceList=e[0],r.walkinPriceList=e[1]}))}(r),p.query(n.getCurrentCenterId()).catch((function(e){return t.error(e,"Failed to load reservation categories.")})).then((function(e){r.reservationCategories=e})),a.query().catch((function(e){return t.error(e,"Failed to query product categories.")})).then((function(e){r.productCategories=angular.copy(e)}))])},preImport:function(n,i,o){var s=[];return i.data.forEach((function(e,o){var l=i.rowsMeta[o];if(!(l.ignore||l.headRow||l.empty)){var u=d()(r).call(r,e[i.mapping.indexOf("productCategoryCode")]),p=c()(r).call(r,n.productCategories,{code:u});p||(p={code:u,name:d()(r).call(r,e[i.mapping.indexOf("productCategoryName")])},n.productCategories.push(p),s.push(a.save(p).catch((function(e){return t.error(e,"Failed to create product category.")}))))}})),e.all(s)},importRow:function(t,n,a,u,p){var f=l.new();return f.id=a.id||void 0,f.name=d()(r).call(r,n[u.indexOf("name")]),f.type=o.options(n[u.indexOf("type")],c()(p).call(p,(function(e){return"type"===e.id})).type.options),f.allowReservationCredits=o.bool(n[u.indexOf("allowReservationCredits")]),f.passSize=o.uint(n[u.indexOf("passSize")]),f.productCategoryId=c()(r).call(r,t.productCategories,{code:d()(r).call(r,n[u.indexOf("productCategoryCode")])}).id,f.productNumber=o.uint(n[u.indexOf("productNumber")]),f.description=d()(r).call(r,n[u.indexOf("description")]),f.reservationTypeId=(o.options(n[u.indexOf("reservationCategory")],t.reservationCategories)||{}).id,l.save(f).then((function(e){return!a.id&&e.id&&t.products.push(f),e})).then((function(){var r,a,d,p,m={id:(c()(r=t.monthlyPriceList.products).call(r,(function(e){return e.productId===f.id}))||{}).id,priceList:t.monthlyPriceList,priceListId:t.monthlyPriceList.id,price:o.currency(n[u.indexOf("monthlyPrice")])},h={id:(c()(a=t.walkinPriceList.products).call(a,(function(e){return e.productId===f.id}))||{}).id,priceList:t.walkinPriceList,priceListId:t.walkinPriceList.id,price:o.currency(n[u.indexOf("walkinPrice")])};return e.all(s()(d=i()(p=[m,h]).call(p,(function(e){return e.price||0==e.price}))).call(d,(function(e){var t=e.priceList;return delete e.priceList,l.savePriceItem(f.id,e).then((function(){var r;c()(r=t.products).call(r,(function(e){return e.productId===f.id}))||t.products.push(e)}))}))).then((function(){return f}))}))},wireRow:function(e,t,r){var n;if(r.id=(c()(n=e.products).call(n,(function(e){return e.name===t.name}))||{}).id||null,r.id){var i,s;(c()(i=e.monthlyPriceList.products).call(i,(function(e){return e.productId===r.id}))||{}).price!=o.currency(t.monthlyPrice)&&angular.isUndefined(r.ignore)&&(r.ignore=!1),(c()(s=e.monthlyPriceList.products).call(s,(function(e){return e.productId===r.id}))||{}).price!=o.currency(t.walkinPrice)&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return r.id}}}])},gSLu:function(e,t,r){"use strict";r.r(t),t.default=angular.module("deskworks.importFieldsReservationCategories",[]).factory("importFieldsReservationCategories",(function(){return[{id:"name",name:"Reservation Category",pattern:/^Reservation\s+Category/i,required:!0,unique:!0},{id:"description",name:"Description",pattern:/^Description/i}]}))},ghTx:function(e,t,r){"use strict";r.r(t);r("3dw1");t.default=angular.module("deskworks.importCollectStats",[]).factory("importCollectStats",(function(){return function(e){var t={create:0,update:0,existing:0,ignore:0,invalid:0,error:0};return angular.forEach(e,(function(e){!e.ignore||e.headRow||e.id||t.ignore++,e.id||e.ignore||e.headRow||e.empty||e.invalid||t.create++,!e.id||e.ignore||e.invalid||t.update++,e.id&&e.ignore&&t.existing++,e.invalid&&t.invalid++,e.error&&e.ignore&&t.error++})),t}}))},gnFY:function(e,t,r){var n={"./handsontable/import-handsontable.tpl.html":"9AYr","./step-components/import-dashboard.tpl.html":"iAI1","./step-components/import-sheet-selector.tpl.html":"r6Yw","./step-components/step-complete.tpl.html":"R2MD","./step-components/step-import.tpl.html":"SXLm","./step-components/step-init.tpl.html":"ojsW","./wizard/import.tpl.html":"/Qjn"};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id="gnFY"},iAI1:function(e,t){e.exports='<ff-panel ng-if="$ctrl.sheet && $ctrl.sheet.mappedToStep === $ctrl.step"> <div class="ff-grid gutter-v-half gutter-h-half import-dashboard"> <div flex="0 0 320px" class="import-stats" ng-if="!$ctrl.unMappedFields.length"> <div class="text-brand"> <span class="counter">{{$ctrl.stats.create}}</span> <ff-icon sense="plus"></ff-icon> <span class="text">Create</span> </div> <div class="text-brand"> <span class="counter">{{$ctrl.stats.update}}</span> <ff-icon sense="refresh"></ff-icon> <span class="text">Update</span> </div> <div class="text-text"> <span class="counter">{{$ctrl.stats.existing}}</span> <ff-icon sense="check"></ff-icon> <span class="text">Existing</span> </div> <div class="text-text"> <span class="counter">{{$ctrl.stats.ignore}}</span> <ff-icon sense="ignore"></ff-icon> <span class="text">Ignore</span> </div> <div class="text-danger" ng-if="!$ctrl.stats.invalid"> <span class="counter">{{$ctrl.stats.error}}</span> <ff-icon sense="error"></ff-icon> <span class="text">Error</span> </div> <div class="text-danger" ng-if="$ctrl.stats.invalid"> <span class="counter">{{$ctrl.stats.invalid}}</span> <ff-icon sense="warning"></ff-icon> <span class="text">Invalid</span> </div> </div> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && $ctrl.unMappedFields.length" class="text-danger"> Some columns are unmapped. Please map them manually. Check <b><u>UNKNOWN</u></b> markers and select correct field mapping from the drop-down. </span> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && $ctrl.invalidCount" class="text-danger"> Invalid values detected. Please fix them manually to proceed to the next step. Look for cells with <ff-icon sense="warning"></ff-icon> icon and fix their values. You can also ignore some rows by clicking <ff-icon sense="warning"></ff-icon> icons near the row indexes at left. </span> <span ng-if="$ctrl.sheet.mappedToStep === $ctrl.step && !$ctrl.unMappedFields.length && !$ctrl.invalidCount"> Click Next to proceed to the next step. </span> </div> </ff-panel> '},jd5N:function(e,t,r){"use strict";var n=r("gQJ2"),i=r.n(n);t.a=angular.module("keese",[]).factory("keese",(function(){var e="0123456789?@ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t=e.length,r=function(){for(var t={},r=0;r<e.length;r++)t[e[r]]=r;return t}();return{generate:function(e,t,r){return r?o(e,t,r):n(e,t)}};function n(e,t){return e?t?s(e,t):((r=c(e)).digits=r.digits.substr(0,r.order_length+1),a(r,c("1"))):t?s("0",t):"1";var r}function o(e,t,r){var i=new Array(r);if(r>0)if(t)!function e(t,r,o,s){var a=Math.floor((o+s)/2),c=n(t,r);i[a]=c,o<a&&e(t,c,o,a);a+1<s&&e(c,r,a+1,s)}(e,t,0,r);else for(var o=0;o<r;o++){var s=keese(e,null);i[o]=s,e=s}return i}function s(n,o){if(n>o)throw new Error("assertion failed: "+i()(n)+" < "+i()(o));var s=c(n),u=c(o);d(s,u);for(var p=0,f=Math.max(s.digits.length,u.digits.length),m=0;m<f||p>0;m++){var h=r[s.digits[m]]||0,g=p+(r[u.digits[m]]||0);if(h!==g){if(h!==g-1){for(var v=Math.floor((g-h)/2),w="",y=0;y<m;y++)w+="0";w+=e[v];var b=c(l(s.order_length,w));return s.digits=s.digits.substr(0,m+1),a(s,b)}p=t}}throw new Error}function a(n,i){d(n,i);for(var o="",s=n.order_length,a=0,c=Math.max(n.digits.length,i.digits.length)-1;c>=0;c--)a+=r[n.digits[c]]||0,a+=r[i.digits[c]]||0,o=e[a%t]+o,a=Math.floor(a/t);for(;a>0;)o=e[a%t]+o,a=Math.floor(a/t),s++;return l(s,o)}function c(e){var t=e.lastIndexOf("~")+1;return{order_length:t,digits:e.substr(t)}}function l(e,t){for(;e>0&&"0"==t.charAt(0);)t=t.substr(1),e--;for(var r="",n=0;n<e;n++)r+="~";return r+t}function d(e,t){u(e,t.order_length),u(t,e.order_length)}function u(e,t){for(;e.order_length<t;)e.digits="0"+e.digits,e.order_length++}}))},ojsW:function(e,t){e.exports='<div class="gutter-v"> <ff-panel> <div class="em"><ff-icon sense="info"></ff-icon>&nbsp;&nbsp;This wizard will guide you through the following import steps:</div> <ff-label> <span>Reservation Categories</span><ff-icon sense="breadcrumb"></ff-icon> <span>Other Products</span><ff-icon sense="breadcrumb"></ff-icon> <span>Membership Products</span><ff-icon sense="breadcrumb"></ff-icon> <span>Reservation Units</span><ff-icon sense="breadcrumb"></ff-icon> <span>Members</span> </ff-label> <div class="em"><ff-icon sense="info"></ff-icon>&nbsp;&nbsp;The workflow for each step is:</div> <ff-label> <span>Select sheet in Excel file</span><ff-icon sense="breadcrumb"></ff-icon> <span>Map fields</span><ff-icon sense="breadcrumb"></ff-icon> <span>Fix invalid data</span><ff-icon sense="breadcrumb"></ff-icon> <span>Import</span><ff-icon sense="breadcrumb"></ff-icon> <span>Move to next step</span> </ff-label> <p><ff-icon sense="info"></ff-icon>&nbsp;&nbsp;Please download import template, open it in Excel (Numbers on Mac), replace sample data with your real data, then start import by selecting the file you\'ve made.</p> <p><ff-icon sense="warning"></ff-icon>&nbsp;&nbsp;Don\'t add/remove columns in the template, but you may add/remove rows.</p> </ff-panel> <ff-btn-group> <ff-btn sense="next" ff-click="$ctrl.next()" ng-if="$ctrl.sheets">Skip To Step {{$ctrl.step + 1}}</ff-btn> <ff-btn sense="upload" ngf-select="$ctrl.upload($files, $invalidFiles)" ngf-pattern="\'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\'" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"> Select Excel File to Import </ff-btn> <a ng-href="{{$ctrl.xlsTemplateUrl}}" target="_blank" rel="noopener" download> <ff-btn sense="download">Download Import Template</ff-btn> </a> </ff-btn-group> </div> '},pfW1:function(e,t,r){"use strict";r.r(t);r("Muwe"),r("y89P");t.default=angular.module("deskworks.importStepComplete",["deskworks.state"]).component("importStepComplete",{templateUrl:"step-components/step-complete.tpl.html",controller:"ImportStepCompleteCtrl",bindings:{step:"=",purge:"<"}}).controller("ImportStepCompleteCtrl",["state",function(e){var t=this;t.navSidebar=function(t){return t.preventDefault(),t.stopPropagation(),e.setPath(t.target.hash.replace("#",""))},t.home=function(){return e.setPath("/dashboard")},t.back=function(){t.step--}}])},qJvt:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),i=r.n(n),o=(r("3dw1"),r("Isj4")),s=r.n(o);t.default=angular.module("deskworks.excel",[]).service("excel",["$q","helper",function(e,t){this.read=function(r){return e((function(e){var n=new FileReader;n.onload=function(r){var n=[],o=s.a.read(r.target.result,{type:"binary"}),a=document.createElement("textarea");angular.forEach(o.SheetNames,(function(e){for(var r=o.Sheets[e],c=function(e){for(var t=s.a.utils.decode_range(e["!ref"]||"A1:Z1000"),r=0,n=0,i=t.e.r;i>=t.s.r;i--){for(var o=-1,a=t.e.c;a>=t.s.c;a--){var c=e[s.a.utils.encode_cell({r:i,c:a})];if(c&&angular.isDefined(c.v)&&null!==c.v&&""!==c.v&&o<0){o=a;break}}r=r>o?r:o,o>=0&&!n&&(n=i)}return{s:{r:t.s.r,c:t.s.c},e:{r:n,c:r}}}(r),l=[],d=c.s.r;d<=c.e.r;d++){for(var u=[],p=c.s.c;p<=c.e.c;p++){var f=r[s.a.utils.encode_cell({r:d,c:p})];u.push(i()(t).call(t,(f||{}).w||""))}a.innerHTML=e,l.push(u)}n.push({name:a.value,data:l})})),e(n)},n.readAsBinaryString(r)}))}}])},r6Yw:function(e,t){e.exports='<ff-panel ff-dim="$ctrl.spin || !$ctrl.sheet"> <div class="ff-grid gutter-v-half"> <label class="ff-row ff-no-frame"> <ff-label flex="0 0 120px" ff-required="true">Select Sheet</ff-label> <ff-select ff-model="$ctrl.sheet" ff-options="sheet.name for sheet in $ctrl.sheets" ff-required="true" ff-valdate-alert="Sheet"></ff-select> </label> <div ng-if="$ctrl.sheet && !$ctrl.sheet.mappedToStep" class="text-danger"> <ff-icon sense="info"></ff-icon> This sheet seems to misfit to current import step. Please select another sheet or map all columns manually. </div> <div ng-if="$ctrl.sheet && $ctrl.sheet.mappedToStep && $ctrl.sheet.mappedToStep !== $ctrl.step" class="text-danger"> <ff-icon sense="info"></ff-icon> This sheet is already mapped to "{{$ctrl.steps[$ctrl.sheet.mappedToStep].name}}" step, please select another sheet or <ff-btn sense="remove" size="sm" ff-click="$ctrl.remapFields()">Remap Fields</ff-btn> </div> </div> </ff-panel> '},rQ7g:function(e,t,r){var n={"./handsontable/handsontable.directive.js":"6Efl","./handsontable/ht-body-extra.directive.js":"Ec5X","./handsontable/ht-header-extra.directive.js":"BaSU","./handsontable/ht-row-extra.directive.js":"V1x+","./handsontable/import-handsontable.directive.js":"4D44","./services/auto-map-columns.service.js":"Jrqs","./services/collect-stats.service.js":"ghTx","./services/detect-head-row-idx.service.js":"6yKF","./services/detect-subgroups.service.js":"+vx3","./services/excel.service.js":"qJvt","./services/init-meta-data.service.js":"rwVl","./services/parsers.service.js":"z+6Y","./services/purge.service.js":"biy8","./services/sheet-detector.service.js":"DEya","./services/srip-data-comments.service.js":"zTxK","./services/validate-cell.service.js":"atK1","./services/validate-data.service.js":"sCVh","./services/wire-data.service.js":"KvHs","./step-components/step-complete.component.js":"pfW1","./step-components/step-import.component.js":"2dNM","./step-components/step-init.component.js":"Wid6","./step-fields/fields-members.service.js":"BGsA","./step-fields/fields-membership-products.service.js":"7A+6","./step-fields/fields-other-products.service.js":"VixM","./step-fields/fields-reservation-categories.service.js":"gSLu","./step-fields/fields-reservation-units.service.js":"anLb","./step-hooks/hooks-members.service.js":"z32g","./step-hooks/hooks-membership-products.service.js":"Bn1Q","./step-hooks/hooks-other-products.service.js":"f4JS","./step-hooks/hooks-reservation-categories.service.js":"Y6HC","./step-hooks/hooks-reservation-units.service.js":"WfNc","./wizard/import.controller.js":"52bj","./wizard/steps.service.js":"Y5xL"};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id="rQ7g"},rwVl:function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),i=r.n(n);r("3dw1");t.default=angular.module("deskworks.importInitMetaData",["deskworks.helper"]).factory("importInitMetaData",["helper",function(e){return function(t){t.rowsMeta.forEach((function(r,n){r.invalid=!1,r.empty=!0,r.id=null,r.subgroup=null,r.spin=null,r.cellsMeta.forEach((function(o,s){o.invalid=!1,r.empty=r.empty&&!i()(e).call(e,t.data[n][s])})),r.master=!1,r.masterIdx=-1,r.masterName=null}))}}])},sCVh:function(e,t,r){"use strict";r.r(t);var n=r("hsT8"),i=r.n(n);r("3dw1");t.default=angular.module("deskworks.importValidateData",["deskworks.helper","deskworks.importValidateCell"]).factory("importValidateData",["helper","importValidateCell",function(e,t){return function(e,r,n){var o=0,s=["email","login","password","phoneNumber","leadSource","billingMethod","addressStreet","addressCity","addressCountry","addressState","addressZip"];return e.data.forEach((function(a,c){var l=e.rowsMeta[c],d=r;l.subgroup&&(d=i()(r).call(r,(function(e){return e.subgroup===l.subgroup}))),l.invalid=d.reduce((function(i,a){var d=e.mapping.indexOf(a.id),u=l.cellsMeta[d];if(l.empty||l.headRow||l.ignore)return u.invalid=!1,i;var p=r;return l.masterIdx&&(p=angular.copy(r)).forEach((function(e){s.indexOf(e.id)>=0&&(e.required=!1)})),u.invalid=t(e.data,c,d,e.rowsMeta,p,e.mapping,n),u.invalid&&o++,i||u.invalid}),!1)})),o}}])},"z+6Y":function(e,t,r){"use strict";r.r(t);var n=r("a8hB"),i=r.n(n);r("Muwe"),r("w13K"),r("y89P");t.default=angular.module("deskworks.importParsers",["deskworks.helper"]).service("importParsers",["helper",function(e){this.options=function(t,r){return e.searchSoft(r,["name","id","import"],t)},this.bool=function(t){return!!i()(e).call(e,t).match(/^Yes|Y|true$/i)},this.int=function(t){return(t=i()(e).call(e,t).replace(/,/g,"")).length?parseInt(t):void 0},this.uint=this.int,this.float=function(t){return(t=i()(e).call(e,t).replace(/,/g,"")).length?parseFloat(t):void 0},this.currency=function(t){return(t=i()(e).call(e,t).replace(/[,\$]/g,"")).length?parseFloat(t):void 0},this.ufloat=this.float,this.date=function(t){var r;if((t=i()(e).call(e,t)).match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(t=t.replace(/\s|-|\.|\//g," "),r="DD MMM YYYY"):t.match(/(?:^(?:\s*)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{4})(?:\s*)$)/i)?(t=t.replace(/\s|-|\./g,"/"),r="MM/DD/YYYY"):t.match(/(?:^(?:\s*)(?:\d{4})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s|-|\.|\/)(?:\d{1,2})(?:\s*)$)/i)&&(t=t.replace(/\s|-|\./g,"-"),r="YYYY-MM-DD"),r){var n=moment(t,r);if(n.isValid())return n}}}])},z32g:function(e,t,r){"use strict";r.r(t);var n=r("ayF/"),i=r.n(n),o=(r("iPZ8"),r("kypl"),r("8cZI"),r("hsT8")),s=r.n(o),a=r("nbuU"),c=r.n(a),l=r("a8hB"),d=r.n(l),u=r("pnvM"),p=r.n(u),f=r("yCd9"),m=r.n(f),h=r("NOor"),g=r.n(h),v=r("2/1H");t.default=angular.module("deskworks.importHooksMembers",["deskworks.dwAlerts","deskworks.helper","deskworks.state","deskworks.importParsers","deskworks.inventory.product.service","deskworks.inventory.priceList.service","deskworks.inventory.membershipCategory.service","deskworks.system.service","deskworks.userProfile.service","deskworks.recurringCharge.service","deskworks.userProfile.optsMembershipStatus","deskworks.userProfile.optsState","deskworks.billing.optsDiscountType",v.a.name]).factory("importHooksMembers",["$q","$timeout","$filter","dwAlerts","helper","state","importParsers","productService","priceListService","membershipCategoryService","systemService","userProfileService","recurringChargeService","ReservationUnit","optsMembershipStatus","optsState","optsDiscountType",function(e,t,r,n,o,a,l,u,f,h,v,w,y,b,k,C,x){return{init:function(t){return e.all([u.getProducts().catch((function(e){return n.error(e,"Failed to query products.")})).then((function(e){t.products=s()(e).call(e,(function(e){return"membership"===e.type||"services"===e.type}))})),v.getLeadSources().catch((function(e){return n.error(e,"Failed to query lead sources.")})).then((function(e){t.leadSources=e})),w.query(0,{activeMembers:!0,inactiveMembers:!0,activeCoMembers:!0,inactiveCoMembers:!0,nonMembers:!0}).catch((function(e){return n.error(e,"Failed to query all users.")})).then((function(e){t.users=e})),w.query(a.getCurrentCenterId(),{activeMembers:!0}).catch((function(e){return n.error(e,"Failed to query members.")})).then((function(e){t.members=e})),f.getPricelists(a.getCurrentCenterId()).catch((function(e){return n.error(e,"Failed to query price lists.")})).then((function(e){return t.monthlyPriceList=c()(e).call(e,(function(e){return"Monthly Plans"===e.name})),f.getPricelist(a.getCurrentCenterId(),t.monthlyPriceList.id).then((function(e){t.monthlyPriceList=e}))})),b.query(a.getCurrentCenterId()).catch((function(e){return n.error(e,"Failed to query reservation units")})).then((function(e){t.reservationUnits=e}))]).then((function(){var e;t.products=s()(e=t.products).call(e,(function(e){var r;return c()(r=t.monthlyPriceList.products).call(r,(function(t){return t.productId===e.id}))}))}))},importRow:function(n,s,u,f,h){var g=c()(h).call(h,(function(e){return"billingMethod"===e.id})).type.options,b=c()(h).call(h,(function(e){return"addressCountry"===e.id})).type.options,$=f.indexOf("recurringProduct"),M={id:u.id||void 0,firstName:d()(o).call(o,s[f.indexOf("firstName")]),lastName:d()(o).call(o,s[f.indexOf("lastName")]),company:d()(o).call(o,s[f.indexOf("company")]),login:d()(o).call(o,s[f.indexOf("login")]),password:d()(o).call(o,s[f.indexOf("password")]),passwordConfirmation:d()(o).call(o,s[f.indexOf("password")]),email:d()(o).call(o,s[f.indexOf("email")]),comments:d()(o).call(o,s[f.indexOf("comments")]),leadSource:l.options(s[f.indexOf("leadSource")],n.leadSources),membershipStatus:c()(k).call(k,(function(e){return"nonMember"===e.id})),billingMethod:l.options(s[f.indexOf("billingMethod")],g)},P=[],S=n.sheet.data.indexOf(s),R=S;for(;R<n.sheet.data.length&&(n.sheet.rowsMeta[R].subgroup||R===S||n.sheet.rowsMeta[R].headRow||n.sheet.rowsMeta[R].empty);){var I=n.sheet.rowsMeta[R],D=n.sheet.data[R];if(!I.ignore&&!I.headRow&&!I.empty&&d()(o).call(o,D[$])){var O=function(t){var r=y.new();r.priceListProduct={};var i=l.options(D[$],n.products)||{};if(r.priceListProduct.id=(c()(t=n.monthlyPriceList.products).call(t,(function(e){return e.productId===i.id}))||{}).id,!r.priceListProduct.id)return{v:e.reject({data:{error:"No price for "+i.name+" product."}})};r.priceListProduct.productId=i.id,r.priceListProduct.priceListId=n.monthlyPriceList.id,r.name=i.name,r.description=d()(o).call(o,D[f.indexOf("recurringDescription")]),r.nextBillDate=l.date(D[f.indexOf("recurringNextBillDate")])||moment(),r.quantity=l.ufloat(D[f.indexOf("recurringQuantity")])||1,r.discountValue=l.currency(D[f.indexOf("recurringDiscount")]),r.discountValue&&(r.discountType=x[1],r.discountTrialOccurrences={id:l.uint(D[f.indexOf("recurringMonthsOfDiscount")])||1},r.discountStartDate=l.date(D[f.indexOf("recurringDiscountStartDate")])),r.attachedReservationUnitId=(l.options(D[f.indexOf("recurringAttachedReservationUnit")],n.reservationUnits)||{}).id,r.startDate=l.date(D[f.indexOf("recurringStartDate")]),r.renewalDate=l.date(D[f.indexOf("recurringRenewalDate")]),P.push(r)}();if("object"===i()(O))return O.v}R++}P.length&&(M.membershipProduct=l.options(P[0].name,n.products),M.membershipStatus=c()(k).call(k,(function(e){return"active"===e.id})),M.membershipType={id:M.membershipProduct.membershipTypeId},M.membershipPriceList=n.monthlyPriceList);var E=w.address.new();E.street=d()(o).call(o,s[f.indexOf("addressStreet")]),E.city=d()(o).call(o,s[f.indexOf("addressCity")]),E.country=l.options(s[f.indexOf("addressCountry")],b),E.state=E.country&&C[E.country.id]?l.options(s[f.indexOf("addressState")],C[E.country.id]):d()(o).call(o,s[f.indexOf("addressState")]),E.zip=d()(o).call(o,s[f.indexOf("addressZip")]);var F=w.phone.new();F.number=d()(o).call(o,s[f.indexOf("phoneNumber")]);var N=w.printerCode.new();N.code=d()(o).call(o,s[f.indexOf("printerCode")]);var L=w.mailbox.new();L.number=d()(o).call(o,s[f.indexOf("mailboxNumber")]);var A={number:d()(o).call(o,s[f.indexOf("accessCode")]),effectiveDate:r("date")(moment(),"yyyy-MM-dd")},q=e.when();q=u.masterIdx>=0?new p.a((function(e){!function r(){n.sheet.rowsMeta[u.masterIdx].spin?t(r,10):e()}()})).then((function(){var t=n.sheet.rowsMeta[u.masterIdx].id;return t?u.id?w.get(a.getCurrentCenterId(),t).then((function(e){var t;return c()(t=e.coMembers).call(t,(function(e){return e.userId===u.id}))||w.coMember.new()})):w.coMember.new():e.reject({data:{error:"Master member error: "+n.sheet.rowsMeta[u.masterIdx].error}})})).then((function(e){var t=n.sheet.rowsMeta[u.masterIdx].id;return e.existingUserId=u.id,e.fullName=o.join([M.firstName,M.lastName]," "),M.email&&(e.email=M.email),M.login&&(e.login=M.login),M.password&&(e.password=M.password),M.comments&&(e.notes=M.comments),w.coMember.save(a.getCurrentCenterId(),t,e).then((function(e){M.id=e.userId}))})):w.save(a.getCurrentCenterId(),M);return q.then((function(){if(u.id)return M.membershipProduct?y.query(a.getCurrentCenterId(),M.id).then((function(t){return e.all(m()(P).call(P,(function(e){return e.id=(c()(t).call(t,(function(t){return t.productName===e.name}))||{}).id||e.id,y.save(a.getCurrentCenterId(),M.id,e)}))).then((function(){return M}))})):M;var t=[];return E.street&&E.zip&&t.push(w.address.save(a.getCurrentCenterId(),M.id,E)),F.number&&t.push(w.phone.save(a.getCurrentCenterId(),M.id,F)),""!==N.code&&t.push(w.printerCode.save(a.getCurrentCenterId(),M.id,N)),""!==L.number&&t.push(w.mailbox.save(a.getCurrentCenterId(),M.id,L)),""!==A.number&&(A.userId=M.id,t.push(v.createAccessCard(a.getCurrentCenterId(),A))),P.forEach((function(e){t.push(y.save(a.getCurrentCenterId(),M.id,e))})),e.all(t).then((function(){return M}))}))},wireRow:function(e,t,r,n){var i;if("recurring"===r.subgroup){for(var o=n.indexOf(r)-1;o>=0&&(n[o].empty||n[o].headRow||n[o].subgroup);)o--;return r.ignore=r.ignore||n[o].ignore,r.id=n[o].id,r.id}var s=(t.firstName+" "+t.lastName).toLowerCase(),a=function(e){return(e.fullName||"").toLowerCase()===s};(t.login||t.email)&&(a=function(e){return(e.login||"").toLowerCase()===(t.login||"").toLowerCase()||(e.email||"").toLowerCase()===(t.email||"").toLowerCase()});if(r.id=(c()(i=e.users).call(i,(function(e){return a(e)}))||{}).id||null,r.id){var l;!!!c()(l=e.members).call(l,(function(e){return a(e)}))&&t.recurringProduct&&angular.isUndefined(r.ignore)&&(r.ignore=!1)}return $(e.sheet,{currentIdx:n.indexOf(r)}),r.id}};function $(e,t){var r=e.rowsMeta,n=e.data,i=e.mapping,s=t.currentIdx,a=g()(i).call(i,(function(e){return"company"===e})),c=d()(o).call(o,n[s][a]).toLowerCase(),l=g()(r).call(r,(function(e,t){return!e.empty&&!e.headRow&&t<s&&c&&d()(o).call(o,n[t][a]).toLowerCase()===c}));r[s].masterIdx=l,l>=0&&(r[s].masterName=d()(o).call(o,n[l][a]),r[l].master=d()(o).call(o,n[s][a]))}}])},zTxK:function(e,t,r){"use strict";r.r(t);var n=r("ipr/"),i=r.n(n);r("3dw1"),r("Muwe"),r("y89P");t.default=angular.module("deskworks.importStripDataComments",[]).factory("importStripDataComments",(function(){return function(e){angular.isArray(e)&&i()(e).call(e,0,5).forEach((function(e){e.forEach((function(t,r){e[r]=t.replace(/\(?PLEASE CHANGE SAMPLE DATA AS NEEDED\)?/i,"")}))}))}}))}}]);